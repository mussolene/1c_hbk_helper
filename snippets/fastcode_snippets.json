[
  {
    "title": "табдок",
    "description": "табдок",
    "code_snippet": "&НаСервере\r\nПроцедура Читать<?\"Введите название коллекции\">НаСервере()\r\n\tТабДок = Новый ТабличныйДокумент;\r\n\tПопытка\r\n\t\tТабДок.Прочитать(Объект.ПутьКФайлу);\r\n\tИсключение\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \"Не удалось прочитать файл по причине: \" + ОписаниеОшибки();\r\n\t\tСообщение.Сообщить();                                                        \r\n\t\tВозврат;\r\n\tКонецПопытки;\r\n\tКоличествоСтрок = ТабДок.ВысотаТаблицы;\r\n\tКоличествоКолонок = ТабДок.ШиринаТаблицы;\r\n\tДля НомерСтроки = 2 По КоличествоСтрок Цикл\r\n\t\tСтрока = <?\"Введите название коллекции\">.Добавить();\r\n\t\t//Строка. = ТабДок.Область(НомерСтроки, 1).Текст;\r\n\tКонецЦикла;\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура Читать<?\"Введите название коллекции\">НаСервере()\r\n\tТабДок = Новый ТабличныйДокумент;\r\n\tПопытка\r\n\t\tТабДок.Прочитать(Объект.ПутьКФайлу);\r\n\tИсключение\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \"Не удалось прочитать файл по причине: \" + ОписаниеОшибки();\r\n\t\tСообщение.Сообщить();                                                        \r\n\t\tВозврат;\r\n\tКонецПопытки;\r\n\tКоличествоСтрок = ТабДок.ВысотаТаблицы;\r\n\tКоличествоКолонок = ТабДок.ШиринаТаблицы;\r\n\tДля НомерСтроки = 2 По КоличествоСтрок Цикл\r\n\t\tСтрока = <?\"Введите название коллекции\">.Добавить();\r\n\t\t//Строка. = ТабДок.Область(НомерСтроки, 1).Текст;\r\n\tКонецЦикла;\r\nКонецПроцедуры"
  },
  {
    "title": "Универсальные сведения о внешней обработке",
    "description": "Универсальные сведения о внешней обработке",
    "code_snippet": "// Пример использования в доп.обработке:\nФункция СведенияОВнешнейОбработке() Экспорт\n   СведенияОВнешнейОбработке(ВнешняяОбработкаОбъект, \"ИмяСерверногоМетода\");\nКонецФункции;\nФункция ВыполнитьКоманду(Идентификатор, Параметры = Неопределено) Экспорт\n   Если Идентификатор = \"ИмяСерверногоМетода\" Тогда\n      // ваш код серверного метода\n   КонецЕсли;\nКонецФункции; \n\n//Пример использования в доп.отчете:\nФункция СведенияОВнешнейОбработке() Экспорт\n   СведенияОВнешнейОбработке(ВнешнийОтчетОбъект);\nКонецФункции;\n\n// см. ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(СтандартныеПодсистемыСервер.ВерсияБиблиотеки()) \n//\n// Параметры: \n// ОбработкаНаименование - ОбработкаОбъект.<ИмяОбработки>, Строка - Имя обработки, или Обработка.Метаданные().Синоним, если не определено  \n// Команды \t\t- Неопределено, ТаблицаЗначений, Булево, Строка - \n//\t\t\t\t  Если Неопределено, то команды не заполняются\n//\t\t\t\t  Если Истина, то создается ТЗ с 2 командами: \n//\t\t\t\t\t1) Идентификатор=\"ВызовСерверногоМетода\" и Использование=\"ВызовСерверногоМетода\"\n//\t\t\t\t\t2) Идентификатор=\"ОткрытьОбработку\"      и Использование=\"ОткрытиеФормы\"   \n//\t\t\t\t  Если Строка, то создается единственная команда Использование=\"ВызовСерверногоМетода\"  \n// Вид \t\t\t- ПеречислениеСсылка.ВидыДополнительныхОтчетовИОбработок, Строка - Вид отчет/обработка\n// Версия \t\t- Неопределено, Строка - 10 символов. Если неопределено, то берется текущая дата, в формате yyyy.MM.dd (напр. 2022.12.31)  \n// Назначение\t- Массив - Массив строк формата \"<Тип>.<Вид>\" (напр. \"Справочник.Номенклатура\" или \"Документ.*\" - для всех документов)\n// Информация   - Строка - Обработка.Метаданные().Комментарий, если не определено \n// Разрешения \t- Булево, ОбъектXDTO, Массив - Если не булево, то устанавливает БезопасныйРежим=Истина и пытается добавить разрешения\n//\n// Возвращаемое значение:\n//\t\tТаблицаЗначений\nФункция СведенияОВнешнейОбработке(ОбработкаНаименование, Команды = Неопределено, Версия = Неопределено, Вид = \"ДополнительнаяОбработка \", Назначение = Неопределено, Информация = Неопределено, Разрешения = Ложь) Экспорт        \n\tСведенияОВнешнейОбработке \t= ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(СтандартныеПодсистемыСервер.ВерсияБиблиотеки());\n\tПереданаОбработка \t\t\t= ТипЗнч(ОбработкаНаименование) <> Тип(\"Строка\");\n\tОбработкаМД\t\t\t\t\t= ?(ПереданаОбработка, ОбработкаНаименование.Метаданные(), Неопределено); \n\tНаименование\t\t\t\t= ?(ПереданаОбработка, МетаданныеИмя(ОбработкаНаименование, \"Синоним\"), ОбработкаНаименование); \n\tИмя\t\t\t\t\t\t\t= ?(ПереданаОбработка, МетаданныеИмя(ОбработкаНаименование, \"Имя\"), \tОбработкаНаименование);\n\tЕсли ТипЗнч(Вид) = Тип(\"Строка\") Тогда\n\t\tЕсли ПереданаОбработка И СтрНачинаетсяС(Строка(ОбработкаНаименование.ЭтотОбъект), \"ВнешнийОтчет\") И Вид = \"ДополнительнаяОбработка \" Тогда\n\t\t\tВид\t\t\t\t\t= \"ДополнительныйОтчет\"; // Если передан Доп.отчет и не передан Вид\n\t\tКонецЕсли;\n\t\tВид\t\t\t\t\t\t= Метаданные.Перечисления.ВидыДополнительныхОтчетовИОбработок.ЗначенияПеречисления.Найти(СтрЗаменить(Вид, \" \", \"\"));\n\t\tЕсли Вид = Неопределено Тогда\n\t\t\tВызватьИсключение \"СведенияОВнешнейОбработке: не удалось определить Вид обработки: \"+Вид;\n\t\tИначе\n\t\t\tВид \t\t\t\t= Вид.Имя;  \n\t\tКонецЕсли;   \n\tИначеЕсли ТипЗнч(Вид) \t\t= Тип(\"ПеречислениеСсылка.ВидыДополнительныхОтчетовИОбработок\") Тогда \n\t\tВид = ДополнительныеОтчетыИОбработки.ВидВСтроку(Вид);\n\tИначеЕсли ТипЗнч(Вид) \t\t= Тип(\"ОбъектМетаданных\") Тогда\n\t\tВид = Вид.Имя;\n\tКонецЕсли;\t\n\t\n\t\n\tЕсли Версия = Неопределено Тогда \n\t\tВерсия = Формат(ТекущаяДата(), \"ДФ=yyyy.MM.dd\");\n\tКонецЕсли;\n\t// заполняет команду по умолчанию\n\tЕсли Команды = Истина Тогда // заполняются 2 команды (см. Описание этой ф-ии)\n\t\tДобавитьКоманду(СведенияОВнешнейОбработке.Команды, \"Вызов серверного метода\", \"ВызовСерверногоМетода\", \"ВызовСерверногоМетода\"); \n\tИначеЕсли ТипЗнч(Команды) = Тип(\"Строка\") Тогда Для Каждого Комадна Из СтрРазделить(Команды, \",\", Ложь) Цикл // передан идентификатор единственной команды или команд через запятую с Использование=\"ВызовСерверногоМетода\"\n\t\tДобавитьКоманду(СведенияОВнешнейОбработке.Команды, \"Команда \" + СтрКэмелКейсВЗаголовок(СокрЛП(Комадна)), СокрЛП(Комадна), \"ВызовСерверногоМетода\"); // СтрКэмелКейсВЗаголовок(Комадна)\n\tКонецЦикла ИначеЕсли ТипЗнч(Команды) = Тип(\"ТаблицаЗначений\") ИЛИ ТипЗнч(Команды) = Тип(\"Массив\") Тогда Для Каждого СтрКоманда Из Команды Цикл\t\n\t\tДобавитьКоманду(СведенияОВнешнейОбработке.Команды, СтрКоманда);\t\n\tКонецЦикла КонецЕсли;  \n\t// добавляет команду открытия основной формы, если не добавлена ранее, и форма задана\n\tЕсли ПереданаОбработка И Не ОбработкаМД.ОсновнаяФорма = Неопределено И СведенияОВнешнейОбработке.Команды.НайтиСтроки(Новый Структура(\"Использование,Идентификатор\", \"ОткрытиеФормы,ОткрытьОбработку\")).Количество()=0 И СведенияОВнешнейОбработке.Команды.Найти(Перечисления.СпособыВызоваДополнительныхОбработок.ОткрытиеФормы, \"Использование\") = Неопределено Тогда\n\t\tДобавитьКоманду(СведенияОВнешнейОбработке.Команды, ОбработкаМД.ОсновнаяФорма.Синоним, ОбработкаМД.ОсновнаяФорма.Имя, \"ОткрытиеФормы\"); СкрытьОткрытиеФормы = ОбработкаМД.ОсновнаяФорма.Имя;\n\tКонецЕсли;      \n\t// обрабатывает Вид доп.обработки/отчета\n\tЕсли нрег(вид) = нрег(\"ПечатнаяФорма\") ИЛИ нрег(вид) = нрег(\"ЗаполнениеОбъекта\") Тогда \n\t\tЕсли Назначение = Неопределено Тогда\n\t\t\tНазначение = Новый Массив;\n\t\t\tНазначение.Добавить(\"Документ.*\");\n\t\t\tНазначение.Добавить(\"Справочник.*\");\n\t\tИначеЕсли ТипЗнч(Назначение) = Тип(\"Строка\") Тогда\n\t\t\tНазначение = СтрРазделить(Назначение, \",\", Ложь);\n\t\tКонецЕсли;\n\t\tЕсли нрег(вид) = нрег(\"ПечатнаяФорма\") Тогда Для Каждого СтрКоманда Из СведенияОВнешнейОбработке.Команды.НайтиСтроки(Новый Структура(\"Использование,Модификатор\", \"ВызовСерверногоМетода\", \"\")) Цикл\n\t\t\tСтрКоманда.Модификатор \t\t= \"ПечатьMXL\";                                         \n\t\t\tСтрКоманда.ПоказыватьОповещение = Истина;\n\t\t\tСтрКоманда.Представление    = СтрЗаменить(СтрКоманда.Представление, \"Команда \", \"\");\n\t\tКонецЦикла ИначеЕсли ВРЕГ(вид)=ВРЕГ(\"ЗаполнениеОбъекта\") И СкрытьОткрытиеФормы<>Неопределено И Команды<>Неопределено Тогда \n\t\t\tСведенияОВнешнейОбработке.Команды.Найти(СкрытьОткрытиеФормы, \"Идентификатор\").Скрыть = Истина; // скроем команду открытия формы, т.к. она лишняя (Команды уже переданы)\n\t\tКонецЕсли;        \n\t\t// если нет ф-ии модуля объекта ВыполнитьКоманду(), но команд(ы) передан(ы), значит Использование = \"ВызовКлиентскогоМетода\"\n\t\tЕсли ВРЕГ(вид)=ВРЕГ(\"ЗаполнениеОбъекта\") И ТипЗнч(ОбработкаНаименование)<>Тип(\"Строка\") И СведенияОВнешнейОбработке.Команды.Найти(\"ВызовСерверногоМетода\", \"Использование\")<>Неопределено Тогда\n\t\t\tПопытка\n\t\t\t\tОбработкаНаименование.ВыполнитьКоманду(Новый УникальныйИдентификатор); // ничего страшного случиться не должно, т.к. заполнение объекта подразумевает объект, а он не передан, т.е. нечего заполнять\n\t\t\tИсключение Для Каждого СтрКоманда ИЗ СведенияОВнешнейОбработке.Команды.НайтиСтроки(Новый Структура(\"Использование\", \"ВызовСерверногоМетода\")) Цикл\n\t\t\t\tСтрКоманда.Использование = \"ВызовКлиентскогоМетода\";\n\t\t\tКонецЦикла КонецПопытки;\n\t\tКонецЕсли;\n\tИначеЕсли нрег(вид) = нрег(\"ДополнительныйОтчет\") Тогда\n\t\tЕсли СведенияОВнешнейОбработке.Команды.Найти(\"ОткрытиеФормы\", \"Использование\") = Неопределено Тогда\n\t\t\tДобавитьКоманду(СведенияОВнешнейОбработке.Команды, Наименование, Имя, \"ОткрытиеФормы\");\n\t\tКонецЕсли;\n\tКонецЕсли;\n\tЕсли Информация = Неопределено И ПереданаОбработка Тогда\n\t\tИнформация = ОбработкаМД.Комментарий;\n\tКонецЕсли;\n\t\n\tСведенияОВнешнейОбработке.Наименование \t= Наименование;\n\tСведенияОВнешнейОбработке.Вид\t\t\t= Вид;\n\tСведенияОВнешнейОбработке.Версия\t\t= Версия;\n\t//Если Не Команды = Неопределено Тогда Для Каждого СтрТЗ Из Команды Цикл\n\t//\tЗаполнитьЗначенияСвойств(СведенияОВнешнейОбработке.Команды.Добавить(), СтрТЗ)\n\t//КонецЦикла КонецЕсли; \n\tСведенияОВнешнейОбработке.Назначение\t= Назначение;\n\tСведенияОВнешнейОбработке.Информация\t= Информация;   \n\tБезопасныйРежим \t\t\t\t\t\t= ?(ТипЗнч(Разрешения) = Тип(\"Булево\"), Разрешения, Истина);\n\tСведенияОВнешнейОбработке.БезопасныйРежим = БезопасныйРежим; \n\tЕсли ТипЗнч(Разрешения) = Тип(\"Строка\") Тогда\n\t\tРазрешенияМассив = СтрРазделить(Разрешения, Символы.ПС, Ложь);\n\tИначеЕсли Не ТипЗнч(Разрешения) = Тип(\"Массив\") Тогда\n\t\tРазрешенияМассив = Новый Массив;\n\t\tРазрешенияМассив.Добавить(Разрешения);\n\tИначе\n\t\tРазрешенияМассив = Разрешения;\n\tКонецЕсли;\n\tДля Каждого Разрешение Из РазрешенияМассив Цикл //https://sstud.ru/выполнение-обработок-1с-в-безопасном-р/\n\t\tЕсли Не БезопасныйРежим Тогда\n\t\t\tПрервать;\n\t\tИначе\n\t\t\t_Разрешения = СведенияОВнешнейОбработке.Разрешения;\n\t\tКонецЕсли;\n\t\tТипЗнчРазрешения = ТипЗнч(Разрешение);\n\t\tЕсли ТипЗнчРазрешения = Тип(\"Булево\") Тогда\n\t\t\tПрервать; \n\t\tИначеЕсли ТипЗнчРазрешения = Тип(\"ОбъектXDTO\") Тогда  \n\t\t\t_Разрешения.Добавить(Разрешение);\t\n\t\tИначеЕсли ТипЗнчРазрешения = Тип(\"Строка\") Тогда  \n\t\t\tЕсли СтрНайти(ВРЕГ(Разрешение), \"HTTP\") Тогда \n\t\t\t\tСтрКомментарийС = СтрНайти(Разрешение, \" \");\n\t\t\t\tЕсли СтрКомментарийС Тогда\n\t\t\t\t\tКомментарий = Прав(Разрешение, СтрДлина(Разрешение) - СтрКомментарийС);\n\t\t\t\t\tРазрешение = Лев(Разрешение, СтрКомментарийС - 1);  \n\t\t\t\tИначе Комментарий = \"\" КонецЕсли; // не может быть Неопределено\n\t\t\t\tСтруктураURI = ОбщегоНазначенияКлиентСервер.СтруктураURI(Разрешение);\n\t\t\t\t_Разрешения.Добавить(РаботаВБезопасномРежиме.РазрешениеНаИспользованиеИнтернетРесурса(СтруктураURI.Схема, СтруктураURI.Хост, СтруктураURI.Порт, Комментарий));\n\t\t\tИначеЕсли СтрНайти(ВРЕГ(Разрешение), \"КАТАЛОГВРЕМЕННЫХФАЙЛОВ\") Тогда\n\t\t\t\t_Разрешения.Добавить(РаботаВБезопасномРежиме.РазрешениеНаИспользованиеКаталогаВременныхФайлов(СтрНайти(ВРЕГ(Разрешение), \"ЧТЕНИЕ\") ИЛИ Не СтрНайти(ВРЕГ(Разрешение), \"ЗАПИСЬ\"), СтрНайти(ВРЕГ(Разрешение), \"ЗАПИСЬ\"), Разрешение));\n\t\t\tИначеЕсли СтрНайти(Разрешение, \":/\") ИЛИ СтрНайти(Разрешение, \"\\\\\") Тогда\n\t\t\t\t_Разрешение = ?(СтрЗаканчиваетсяНа(ВРЕГ(Разрешение), \"ЧТЕНИЕ\") ИЛИ СтрЗаканчиваетсяНа(ВРЕГ(Разрешение), \"ЗАПИСЬ\"), СокрЛП(Лев(Разрешение, СтрДлина(Разрешение)-6)), Разрешение); \n\t\t\t\t_Разрешения.Добавить(РаботаВБезопасномРежиме.РазрешениеНаИспользованиеКаталогаФайловойСистемы(_Разрешение, СтрНайти(ВРЕГ(Разрешение), \"ЧТЕНИЕ\") ИЛИ Не СтрНайти(ВРЕГ(Разрешение), \"ЗАПИСЬ\"), СтрНайти(ВРЕГ(Разрешение), \"ЗАПИСЬ\"), Разрешение)); \n\t\t\tИначеЕсли СтрНачинаетсяС(ВРЕГ(Разрешение), \"COM \") ИЛИ СтрНайти(Разрешение, \"COM\") Тогда // Учитывается только ProgID\n\t\t\t\tРазрешение = ?(Не СтрНачинаетсяС(ВРЕГ(Разрешение), \"COM \"), Разрешение, Сред(Разрешение, 5, СтрДлина(Разрешение)));\n\t\t\t\t_Разрешения.Добавить(РаботаВБезопасномРежиме.РазрешениеНаСозданиеCOMКласса(СтрРазделить(Разрешение, \" \",Ложь)[0], , , ?(СтрРазделить(Разрешение, \" \",Ложь).Количество()>1, СтрРазделить(Разрешение, \" \",Ложь)[1], \"\")));\n\t\t\tИначеЕсли СтрРазделить(Разрешение, \".\").Количество() > 1 Тогда \n\t\t\t\tРазрешенияМассив = СтрРазделить(Разрешение, \".\"); \n\t\t\t\tЕсли СтроковыеФункцииКлиентСервер.ТолькоЛатиницаВСтроке(РазрешенияМассив[0]+РазрешенияМассив[1]) И РазрешенияМассив.Количество()>2 Тогда   \n\t\t\t\t\t_Разрешения.Добавить(РаботаВБезопасномРежиме.РазрешениеНаСозданиеCOMКласса(РазрешенияМассив[0]+\".\"+РазрешенияМассив[1], РазрешенияМассив[2]));\n\t\t\t\tИначе\n\t\t\t\t\t_Разрешения.Добавить(РаботаВБезопасномРежиме.РазрешениеНаИспользованиеВнешнейКомпоненты(РазрешенияМассив[0]+\".\"+РазрешенияМассив[1], ?(РазрешенияМассив.Количество()>2, РазрешенияМассив[2], \"\")));\n\t\t\t\tКонецЕсли; \n\t\t\tИначе\n\t\t\t\t_Разрешения.Добавить(РаботаВБезопасномРежиме.РазрешениеНаИспользованиеПривилегированногоРежима(Разрешение));\n\t\t\tКонецЕсли;                                 \n\t\tКонецЕсли;\n\tКонецЦикла;\n\t\n\tВозврат СведенияОВнешнейОбработке\nКонецФункции"
  },
  {
    "title": "Синтакс-помощник БСП с нейросетевым ассистентомНаш выбор",
    "description": "Синтакс-помощник БСП - cправочник по библиотеке стандартных подсистем. В состав справочника входит описание экспортных процедур и функций, размещенных в областях кода ПрограммныйИнтерфейс БСП. В справчоник добавлены ассистенты на базе нейросетевых моделей ИИ.",
    "code_snippet": ""
  },
  {
    "title": "Проверка модифицированности в модуле объекта",
    "description": "Проверка модифицированности в модуле объекта",
    "code_snippet": "// модуль объекта в событии ПередЗаписью\r\nХешОбъектаДоИзменения = ОбщегоНазначения.КонтрольнаяСуммаСтрокой(ЭтотОбъект.Ссылка.ПолучитьОбъект());\r\nХешОбъектаТекущий = ОбщегоНазначения.КонтрольнаяСуммаСтрокой(ЭтотОбъект);\r\nМодифицированность = ХешОбъектаДоИзменения <> ХешОбъектаТекущий;\n\n// модуль объекта в событии ПередЗаписью\r\nХешОбъектаДоИзменения = ОбщегоНазначения.КонтрольнаяСуммаСтрокой(ЭтотОбъект.Ссылка.ПолучитьОбъект());\r\nХешОбъектаТекущий = ОбщегоНазначения.КонтрольнаяСуммаСтрокой(ЭтотОбъект);\r\nМодифицированность = ХешОбъектаДоИзменения <> ХешОбъектаТекущий;\n\nОрфографическая ошибка в модифицированности: модифицированности"
  },
  {
    "title": "Изменение параметров команд формы из конфигурации без снятия с поддержки",
    "description": "Изменение параметров команд формы из конфигурации без снятия с поддержки",
    "code_snippet": "&НаСервере\nПроцедура риа_ПриСозданииНаСервереПосле(Отказ, СтандартнаяОбработка)\n\t\n\tАдресНастроек = ЭтаФорма.ПараметрыПодключаемыхКоманд.АдресТаблицыКоманд;\n\tРанееДобавленныеКоманды = ПолучитьИзВременногоХранилища(АдресНастроек);\n\tКомандаОтчетаТ9 = РанееДобавленныеКоманды.Найти(\"ПФ_MXL_Т9\", \"Идентификатор\");\n\t\n\tЕсли КомандаОтчетаТ9 <> Неопределено Тогда\n\t\tКомандаОтчетаТ9.РежимЗаписи = \"ЗаписыватьТолькоНовые\";\n\t\tЭтаФорма.ПараметрыПодключаемыхКоманд.АдресТаблицыКоманд = ПоместитьВоВременноеХранилище(РанееДобавленныеКоманды, ЭтаФорма.УникальныйИдентификатор);\n\tКонецЕсли;\n\t\nКонецПроцедуры"
  },
  {
    "title": "ПолучитьНомерПоследнейСФ",
    "description": "ПолучитьНомерПоследнейСФ",
    "code_snippet": "Функция ПолучитьНомерПоследнейСФ()  \r\n\t\r\n\tЗапрос = Новый Запрос();\r\n\tЗапрос.Текст = \r\n\t\"ВЫБРАТЬ\r\n\t|\tМАКСИМУМ(СчетФактура.Номер) КАК Номер\r\n\t|ИЗ\r\n\t|\tДокумент.СчетФактура КАК СчетФактура\r\n\t|ГДЕ\r\n\t|\tСчетФактура.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийСчетФактура.Продажа)\";\r\n\t\r\n\tРезультат = Запрос.Выполнить().Выбрать();\r\n\t\r\n    Если Результат.Следующий() Тогда\r\n        ПоследнийНомер = Число(Сред(Результат.Номер, Найти(Результат.Номер, \"-\") + 1)) + 1;\r\n    Иначе\r\n        ПоследнийНомер = 1;\r\n\tКонецЕсли;\r\n\t\r\n\tПрефикс = \"00НФ-\";  \r\n\t\r\n  \tНовыйНомер = Строка(Префикс) + СтроковыеФункцииКлиентСервер.ДополнитьСтроку(ПоследнийНомер, 6, \"0\", \"Слева\");\r\n\r\n    Возврат НовыйНомер;\r\n\r\nКонецФункции\n\nФункция ПолучитьНомерПоследнейСФ()  \r\n\t\r\n\tЗапрос = Новый Запрос();\r\n\tЗапрос.Текст = \r\n\t\"ВЫБРАТЬ\r\n\t|\tМАКСИМУМ(СчетФактура.Номер) КАК Номер\r\n\t|ИЗ\r\n\t|\tДокумент.СчетФактура КАК СчетФактура\r\n\t|ГДЕ\r\n\t|\tСчетФактура.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийСчетФактура.Продажа)\";\r\n\t\r\n\tРезультат = Запрос.Выполнить().Выбрать();\r\n\t\r\n    Если Результат.Следующий() Тогда\r\n        ПоследнийНомер = Число(Сред(Результат.Номер, Найти(Результат.Номер, \"-\") + 1)) + 1;\r\n    Иначе\r\n        ПоследнийНомер = 1;\r\n\tКонецЕсли;\r\n\t\r\n\tПрефикс = \"00НФ-\";  \r\n\t\r\n  \tНовыйНомер = Строка(Префикс) + СтроковыеФункцииКлиентСервер.ДополнитьСтроку(ПоследнийНомер, 6, \"0\", \"Слева\");\r\n\r\n    Возврат НовыйНомер;\r\n\r\nКонецФункции\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "Скрипт для комментариев по Ctrl [+ Shift] + /",
    "description": "Скрипт реализует вставку комментария в коде по Ctrl + / (не Num/)  и удаление комментария по Ctrl + Shift + / (не Num/)",
    "code_snippet": ""
  },
  {
    "title": "Строка в Дату в Запросе",
    "description": "Строка в Дату в Запросе",
    "code_snippet": "ВЫБРАТЬ\r\n    01                КАК  НомерСтроки,\r\n    \"20260105170929\"  КАК  Строка,\r\n    \"20221231235959\"  КАК  Строка1\r\nПОМЕСТИТЬ Дано\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    02                КАК  НомерСтроки,\r\n    \"20260827140942\"  КАК  Строка,\r\n    \"20221201000000\"  КАК  Строка1\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    03                КАК  НомерСтроки,\r\n    \"20250626010517\"  КАК  Строка,\r\n    \"20230318122825\"  КАК  Строка1\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    04                КАК  НомерСтроки,\r\n    \"20251105201511\"  КАК  Строка,\r\n    \"20230105155243\"  КАК  Строка1\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    0     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    1000  КАК  Г\r\nПОМЕСТИТЬ Формат\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    1     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    100   КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    2     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    10    КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    3     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    1     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    4     КАК  Х,\r\n    0     КАК  Д,\r\n    10    КАК  М,\r\n    0     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    5     КАК  Х,\r\n    0     КАК  Д,\r\n    1     КАК  М,\r\n    0     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    6     КАК  Х,\r\n    10    КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    7     КАК  Х,\r\n    1     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    8     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    9     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки                        КАК  НомерСтроки,\r\n    ДОБАВИТЬКДАТЕ(\r\n        ДОБАВИТЬКДАТЕ(\r\n            ДОБАВИТЬКДАТЕ(\r\n                ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),\r\n                ДЕНЬ,\r\n                СУММА(А.Д * Б.Х) - 1\r\n            ),\r\n            МЕСЯЦ,\r\n            СУММА(А.М * Б.Х) - 1\r\n        ),\r\n        ГОД,\r\n        СУММА(А.Г * Б.Х) - 1\r\n    )                                       КАК  Ответ\r\nПОМЕСТИТЬ ВТ_Ответ\r\nИЗ\r\n    Дано    КАК  Дано,\r\n    Формат  КАК  А,\r\n    Формат  КАК  Б\r\n\r\nГДЕ ИСТИНА\r\n    И А.Х < 9\r\n    И Б.Х < 10\r\n    И ПОДСТРОКА(Дано.Строка,  А.Х + 1, 1) =\r\n      ПОДСТРОКА(\"0123456789\", Б.Х + 1, 1)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.НомерСтроки\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки                        КАК  НомерСтроки,\r\n    ДОБАВИТЬКДАТЕ(\r\n        ДОБАВИТЬКДАТЕ(\r\n            ДОБАВИТЬКДАТЕ(\r\n                ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),\r\n                ДЕНЬ,\r\n                СУММА(А.Д * Б.Х) - 1\r\n            ),\r\n            МЕСЯЦ,\r\n            СУММА(А.М * Б.Х) - 1\r\n        ),\r\n        ГОД,\r\n        СУММА(А.Г * Б.Х) - 1\r\n    )                                       КАК  Ответ1\r\nПОМЕСТИТЬ ВТ_Ответ1\r\nИЗ\r\n    Дано    КАК  Дано,\r\n    Формат  КАК  А,\r\n    Формат  КАК  Б\r\n\r\nГДЕ ИСТИНА\r\n    И А.Х < 9\r\n    И Б.Х < 10\r\n    И ПОДСТРОКА(Дано.Строка1, А.Х + 1, 1) =\r\n      ПОДСТРОКА(\"0123456789\", Б.Х + 1, 1)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.НомерСтроки\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    тОтвет.НомерСтроки,\r\n    тОтвет.Ответ,\r\n    тОтвет1.Ответ1\r\nИЗ\r\n    ВТ_Ответ  КАК  тОтвет\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ\r\n            ВТ_Ответ1  КАК  тОтвет1\r\n                ПО тОтвет.НомерСтроки = тОтвет1.НомерСтроки\n\nВЫБРАТЬ\r\n    01                КАК  НомерСтроки,\r\n    \"20260105170929\"  КАК  Строка,\r\n    \"20221231235959\"  КАК  Строка1\r\nПОМЕСТИТЬ Дано\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    02                КАК  НомерСтроки,\r\n    \"20260827140942\"  КАК  Строка,\r\n    \"20221201000000\"  КАК  Строка1\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    03                КАК  НомерСтроки,\r\n    \"20250626010517\"  КАК  Строка,\r\n    \"20230318122825\"  КАК  Строка1\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    04                КАК  НомерСтроки,\r\n    \"20251105201511\"  КАК  Строка,\r\n    \"20230105155243\"  КАК  Строка1\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    0     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    1000  КАК  Г\r\nПОМЕСТИТЬ Формат\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    1     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    100   КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    2     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    10    КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    3     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    1     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    4     КАК  Х,\r\n    0     КАК  Д,\r\n    10    КАК  М,\r\n    0     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    5     КАК  Х,\r\n    0     КАК  Д,\r\n    1     КАК  М,\r\n    0     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    6     КАК  Х,\r\n    10    КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    7     КАК  Х,\r\n    1     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    8     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    9     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки                        КАК  НомерСтроки,\r\n    ДОБАВИТЬКДАТЕ(\r\n        ДОБАВИТЬКДАТЕ(\r\n            ДОБАВИТЬКДАТЕ(\r\n                ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),\r\n                ДЕНЬ,\r\n                СУММА(А.Д * Б.Х) - 1\r\n            ),\r\n            МЕСЯЦ,\r\n            СУММА(А.М * Б.Х) - 1\r\n        ),\r\n        ГОД,\r\n        СУММА(А.Г * Б.Х) - 1\r\n    )                                       КАК  Ответ\r\nПОМЕСТИТЬ ВТ_Ответ\r\nИЗ\r\n    Дано    КАК  Дано,\r\n    Формат  КАК  А,\r\n    Формат  КАК  Б\r\n\r\nГДЕ ИСТИНА\r\n    И А.Х < 9\r\n    И Б.Х < 10\r\n    И ПОДСТРОКА(Дано.Строка,  А.Х + 1, 1) =\r\n      ПОДСТРОКА(\"0123456789\", Б.Х + 1, 1)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.НомерСтроки\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки                        КАК  НомерСтроки,\r\n    ДОБАВИТЬКДАТЕ(\r\n        ДОБАВИТЬКДАТЕ(\r\n            ДОБАВИТЬКДАТЕ(\r\n                ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),\r\n                ДЕНЬ,\r\n                СУММА(А.Д * Б.Х) - 1\r\n            ),\r\n            МЕСЯЦ,\r\n            СУММА(А.М * Б.Х) - 1\r\n        ),\r\n        ГОД,\r\n        СУММА(А.Г * Б.Х) - 1\r\n    )                                       КАК  Ответ1\r\nПОМЕСТИТЬ ВТ_Ответ1\r\nИЗ\r\n    Дано    КАК  Дано,\r\n    Формат  КАК  А,\r\n    Формат  КАК  Б\r\n\r\nГДЕ ИСТИНА\r\n    И А.Х < 9\r\n    И Б.Х < 10\r\n    И ПОДСТРОКА(Дано.Строка1, А.Х + 1, 1) =\r\n      ПОДСТРОКА(\"0123456789\", Б.Х + 1, 1)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.НомерСтроки\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    тОтвет.НомерСтроки,\r\n    тОтвет.Ответ,\r\n    тОтвет1.Ответ1\r\nИЗ\r\n    ВТ_Ответ  КАК  тОтвет\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ\r\n            ВТ_Ответ1  КАК  тОтвет1\r\n                ПО тОтвет.НомерСтроки = тОтвет1.НомерСтроки\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Строка в ДатуВремя в Запросе",
    "description": "Строка в ДатуВремя в Запросе",
    "code_snippet": "////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    01                КАК  НомерСтроки,\r\n    \"20260105170929\"  КАК  Строка,\r\n    \"20221231235959\"  КАК  Строка1\r\nПОМЕСТИТЬ Дано\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    02                КАК  НомерСтроки,\r\n    \"20260827140942\"  КАК  Строка,\r\n    \"20221201000000\"  КАК  Строка1\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    03                КАК  НомерСтроки,\r\n    \"20250626010517\"  КАК  Строка,\r\n    \"20230318122825\"  КАК  Строка1\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    04                КАК  НомерСтроки,\r\n    \"20251105201511\"  КАК  Строка,\r\n    \"20230105155243\"  КАК  Строка1\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    0     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    1000  КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\nПОМЕСТИТЬ Формат\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    1     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    100   КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    2     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    10    КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    3     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    1     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    4     КАК  Х,\r\n    0     КАК  Д,\r\n    10    КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    5     КАК  Х,\r\n    0     КАК  Д,\r\n    1     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    6     КАК  Х,\r\n    10    КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    7     КАК  Х,\r\n    1     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    8     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    10    КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    9     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    1     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    10    КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    10    КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    11    КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    1     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    12    КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    10    КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    13    КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    1     КАК  С\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    ДОБАВИТЬКДАТЕ(\r\n        ДОБАВИТЬКДАТЕ(\r\n            ДОБАВИТЬКДАТЕ(\r\n                ДОБАВИТЬКДАТЕ(\r\n                    ДОБАВИТЬКДАТЕ(\r\n                        ДОБАВИТЬКДАТЕ(\r\n                            ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),\r\n                            СЕКУНДА,\r\n                            СУММА(А.С * Б.Х)\r\n                        ),\r\n                        МИНУТА,\r\n                        СУММА(А.Н * Б.Х)\r\n                    ),\r\n                    ЧАС,\r\n                    СУММА(А.Ч * Б.Х)\r\n                ),\r\n                ДЕНЬ,\r\n                СУММА(А.Д * Б.Х) - 1\r\n            ),\r\n            МЕСЯЦ,\r\n            СУММА(А.М * Б.Х) - 1\r\n        ),\r\n        ГОД,\r\n        СУММА(А.Г * Б.Х) - 1\r\n    )                                                   КАК  Ответ\r\nПОМЕСТИТЬ ВТ_Ответ\r\nИЗ\r\n    Дано    КАК  Дано,\r\n    Формат  КАК  А,\r\n    Формат  КАК  Б\r\n\r\nГДЕ ИСТИНА\r\n    И А.Х < 14\r\n    И Б.Х < 10\r\n    И ПОДСТРОКА(Дано.Строка,  А.Х + 1, 1) =\r\n      ПОДСТРОКА(\"0123456789\", Б.Х + 1, 1)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.НомерСтроки\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    ДОБАВИТЬКДАТЕ(\r\n        ДОБАВИТЬКДАТЕ(\r\n            ДОБАВИТЬКДАТЕ(\r\n                ДОБАВИТЬКДАТЕ(\r\n                    ДОБАВИТЬКДАТЕ(\r\n                        ДОБАВИТЬКДАТЕ(\r\n                            ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),\r\n                            СЕКУНДА,\r\n                            СУММА(А.С * Б.Х)\r\n                        ),\r\n                        МИНУТА,\r\n                        СУММА(А.Н * Б.Х)\r\n                    ),\r\n                    ЧАС,\r\n                    СУММА(А.Ч * Б.Х)\r\n                ),\r\n                ДЕНЬ,\r\n                СУММА(А.Д * Б.Х) - 1\r\n            ),\r\n            МЕСЯЦ,\r\n            СУММА(А.М * Б.Х) - 1\r\n        ),\r\n        ГОД,\r\n        СУММА(А.Г * Б.Х) - 1\r\n    )                                                   КАК  Ответ1\r\nПОМЕСТИТЬ ВТ_Ответ1\r\nИЗ\r\n    Дано    КАК  Дано,\r\n    Формат  КАК  А,\r\n    Формат  КАК  Б\r\n\r\nГДЕ ИСТИНА\r\n    И А.Х < 14\r\n    И Б.Х < 10\r\n    И ПОДСТРОКА(Дано.Строка1, А.Х + 1, 1) =\r\n      ПОДСТРОКА(\"0123456789\", Б.Х + 1, 1)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.НомерСтроки\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    тОтвет.НомерСтроки,\r\n    тОтвет.Ответ,\r\n    тОтвет1.Ответ1\r\nИЗ\r\n    ВТ_Ответ  КАК  тОтвет\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ\r\n            ВТ_Ответ1  КАК  тОтвет1\r\n                ПО тОтвет.НомерСтроки = тОтвет1.НомерСтроки\n\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    01                КАК  НомерСтроки,\r\n    \"20260105170929\"  КАК  Строка,\r\n    \"20221231235959\"  КАК  Строка1\r\nПОМЕСТИТЬ Дано\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    02                КАК  НомерСтроки,\r\n    \"20260827140942\"  КАК  Строка,\r\n    \"20221201000000\"  КАК  Строка1\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    03                КАК  НомерСтроки,\r\n    \"20250626010517\"  КАК  Строка,\r\n    \"20230318122825\"  КАК  Строка1\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n    //\r\n\r\nВЫБРАТЬ\r\n    04                КАК  НомерСтроки,\r\n    \"20251105201511\"  КАК  Строка,\r\n    \"20230105155243\"  КАК  Строка1\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    0     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    1000  КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\nПОМЕСТИТЬ Формат\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    1     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    100   КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    2     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    10    КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    3     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    1     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    4     КАК  Х,\r\n    0     КАК  Д,\r\n    10    КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    5     КАК  Х,\r\n    0     КАК  Д,\r\n    1     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    6     КАК  Х,\r\n    10    КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    7     КАК  Х,\r\n    1     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    8     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    10    КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    9     КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    1     КАК  Ч,\r\n    0     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    10    КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    10    КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    11    КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    1     КАК  Н,\r\n    0     КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    12    КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    10    КАК  С\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    13    КАК  Х,\r\n    0     КАК  Д,\r\n    0     КАК  М,\r\n    0     КАК  Г,\r\n    0     КАК  Ч,\r\n    0     КАК  Н,\r\n    1     КАК  С\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    ДОБАВИТЬКДАТЕ(\r\n        ДОБАВИТЬКДАТЕ(\r\n            ДОБАВИТЬКДАТЕ(\r\n                ДОБАВИТЬКДАТЕ(\r\n                    ДОБАВИТЬКДАТЕ(\r\n                        ДОБАВИТЬКДАТЕ(\r\n                            ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),\r\n                            СЕКУНДА,\r\n                            СУММА(А.С * Б.Х)\r\n                        ),\r\n                        МИНУТА,\r\n                        СУММА(А.Н * Б.Х)\r\n                    ),\r\n                    ЧАС,\r\n                    СУММА(А.Ч * Б.Х)\r\n                ),\r\n                ДЕНЬ,\r\n                СУММА(А.Д * Б.Х) - 1\r\n            ),\r\n            МЕСЯЦ,\r\n            СУММА(А.М * Б.Х) - 1\r\n        ),\r\n        ГОД,\r\n        СУММА(А.Г * Б.Х) - 1\r\n    )                                                   КАК  Ответ\r\nПОМЕСТИТЬ ВТ_Ответ\r\nИЗ\r\n    Дано    КАК  Дано,\r\n    Формат  КАК  А,\r\n    Формат  КАК  Б\r\n\r\nГДЕ ИСТИНА\r\n    И А.Х < 14\r\n    И Б.Х < 10\r\n    И ПОДСТРОКА(Дано.Строка,  А.Х + 1, 1) =\r\n      ПОДСТРОКА(\"0123456789\", Б.Х + 1, 1)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.НомерСтроки\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    ДОБАВИТЬКДАТЕ(\r\n        ДОБАВИТЬКДАТЕ(\r\n            ДОБАВИТЬКДАТЕ(\r\n                ДОБАВИТЬКДАТЕ(\r\n                    ДОБАВИТЬКДАТЕ(\r\n                        ДОБАВИТЬКДАТЕ(\r\n                            ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),\r\n                            СЕКУНДА,\r\n                            СУММА(А.С * Б.Х)\r\n                        ),\r\n                        МИНУТА,\r\n                        СУММА(А.Н * Б.Х)\r\n                    ),\r\n                    ЧАС,\r\n                    СУММА(А.Ч * Б.Х)\r\n                ),\r\n                ДЕНЬ,\r\n                СУММА(А.Д * Б.Х) - 1\r\n            ),\r\n            МЕСЯЦ,\r\n            СУММА(А.М * Б.Х) - 1\r\n        ),\r\n        ГОД,\r\n        СУММА(А.Г * Б.Х) - 1\r\n    )                                                   КАК  Ответ1\r\nПОМЕСТИТЬ ВТ_Ответ1\r\nИЗ\r\n    Дано    КАК  Дано,\r\n    Формат  КАК  А,\r\n    Формат  КАК  Б\r\n\r\nГДЕ ИСТИНА\r\n    И А.Х < 14\r\n    И Б.Х < 10\r\n    И ПОДСТРОКА(Дано.Строка1, А.Х + 1, 1) =\r\n      ПОДСТРОКА(\"0123456789\", Б.Х + 1, 1)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.НомерСтроки\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    тОтвет.НомерСтроки,\r\n    тОтвет.Ответ,\r\n    тОтвет1.Ответ1\r\nИЗ\r\n    ВТ_Ответ  КАК  тОтвет\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ\r\n            ВТ_Ответ1  КАК  тОтвет1\r\n                ПО тОтвет.НомерСтроки = тОтвет1.НомерСтроки\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Вывод дополнительного реквизита в произвольном месте формы",
    "description": "Вывод дополнительного реквизита в произвольном месте формы",
    "code_snippet": "#Область ОбработчикиСобытийФормы\n\n&НаСервере\nПроцедура ИМПС_ПриСозданииНаСервереПосле(Отказ, СтандартнаяОбработка)  \n\t\n\tМассивРеквизитов = ПолучитьРеквизиты(\"Свойства_ОписаниеДополнительныхРеквизитов\");\n\t\n\tЕсли МассивРеквизитов.Количество() > 0 Тогда\n\t\t\n\t\t// здесь указать имя доп.реквизита указанное при создании\n\t\tСвойство_ШтукВУпаковке = \n\t\t\tПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоРеквизиту(\"Имя\", \"ШтукВУпаковке\");\n\t\t\t\n\t\tЕсли ЗначениеЗаполнено(Свойство_ШтукВУпаковке) Тогда\n\t\t\t\n\t\t\tПараметрыОтбора = Новый Структура(\"Свойство\", Свойство_ШтукВУпаковке); \n\t\t\tМассивСтрок = ЭтотОбъект.Свойства_ОписаниеДополнительныхРеквизитов.НайтиСтроки(ПараметрыОтбора);\n\t\t\t\n\t\t\tЕсли МассивСтрок.Количество() = 1 Тогда\n\t\t\t\t\n\t\t\t\tПутьКДанным = МассивСтрок[0].ИмяРеквизитаЗначение;\n\t\t\t\t// Элементы.ГруппаЕдиница заменить на свое\n\t\t\t\tНовыйЭлемент = Элементы.Добавить(\"ИМПС_ШтукВУпаковке\", Тип(\"ПолеФормы\"), Элементы.ГруппаЕдиница);\n\t\t\t\tНовыйЭлемент.Вид = ВидПоляФормы.ПолеВвода;\t\n\t\t\t\tНовыйЭлемент.ПутьКДанным = ПутьКДанным;\n\t\t\t\t\n\t\t\t\t\n\t\t\tКонецЕсли;\n\t\t\t\n\t\tКонецЕсли;\n\t\n\tКонецЕсли;\n\nКонецПроцедуры  \n\n#КонецОбласти"
  },
  {
    "title": "ИР Найти фрагмент в истории Гита",
    "description": "ИР Найти фрагмент в истории ГитаTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Найти последнюю правку в Гите",
    "description": "ИР Найти последнюю правку в ГитеTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Проверка на принадлежность ссылки иерархии",
    "description": "Проверка на принадлежность ссылки иерархии",
    "code_snippet": "Запрос = Новый Запрос;\nТекстЗапроса = \"ВЫБРАТЬ\n|\tТаблицаИсточник.Ссылка КАК Ссылка\n|ИЗ\n|\t&ИмяСправочника КАК ТаблицаИсточник\n|ГДЕ\n|\tТаблицаИсточник.Ссылка В ИЕРАРХИИ(&Родитель)\n|\tИ ТаблицаИсточник.Ссылка = &Ссылка\";\n\nТекстЗапроса = СтрЗаменить(ТекстЗапроса, \"&ИмяСправочника\",ОбщегоНазначения.ИмяТаблицыПоСсылке(Ссылка));\n\nЗапрос.Текст = ТекстЗапроса;\nЗапрос.УстановитьПараметр(\"Родитель\",Родитель);\nЗапрос.УстановитьПараметр(\"Ссылка\",Ссылка);\n\nРезультат = Запрос.Выполнить();\n\nВозврат Не Результат.Пустой();"
  },
  {
    "title": "Получение данных маркировки ЗаказаСервиса УОТ 1.7.6",
    "description": "Получение данных маркировки ЗаказаСервиса УОТ 1.7.6",
    "code_snippet": "Функция ПодготовитьМаркировочныеЛистыССериями(ДокументСсылка,Порядок=0) Экспорт\r\n\r\n\tТекстЗапроса =\r\n\t\"ВЫБРАТЬ\r\n\t|\tЗаказКлиентаТовары.Ссылка КАК ЗаказСсылка,\r\n\t|\tЗаказКлиентаТовары.Серия КАК Серия,\r\n\t|\tЗаказКлиентаТовары.КодСтроки КАК КодСтроки,\r\n\t|\tЗаказКлиентаТовары.Номенклатура КАК Номенклатура,\r\n\t|\tЗаказКлиентаТовары.КоличествоУпаковок КАК КоличествоУпаковок,\r\n\t|\tЗаказКлиентаТовары.Количество КАК Количество\r\n\t|ПОМЕСТИТЬ ТоварыЗаказа\r\n\t|ИЗ\r\n\t|\tДокумент.ЗаказКлиента.Товары КАК ЗаказКлиентаТовары\r\n\t|ГДЕ\r\n\t|\tЗаказКлиентаТовары.Ссылка = &ДокументСсылка\r\n\t|;\r\n\t|ВЫБРАТЬ\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.НомерЗаказа КАК НомерЗаказа,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.НомерОтправления КАК НомерОтправления,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.Артикул КАК Артикул,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.Товар КАК Товар,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.УчетнаяЗапись КАК УчетнаяЗапись,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.ЗаказКлиентаСервиса КАК ЗаказКлиентаСервиса,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.ЗаказКлиента КАК ЗаказКлиента,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.КодСтроки КАК КодСтроки,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.Отменено КАК Отменено,\r\n\t|\tCG_Online_IWS_НоменклатураСервисов.Номенклатура КАК Номенклатура,\r\n\t|\tCG_Online_IWS_НоменклатураСервисов.Упаковка КАК Упаковка,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.Количество КАК Количество,\r\n\t|\tCG_Online_IWS_НоменклатураСервисов.Характеристика КАК Характеристика,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.Количество КАК КоличествоУпаковок\r\n\t|ПОМЕСТИТЬ СписокЗаказов\r\n\t|ИЗ\r\n\t|\tРегистрСведений.CG_Online_ЗаказыКлиентовСервисовТовары КАК CG_Online_ЗаказыКлиентовСервисовТовары\r\n\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ Справочник.CG_Online_IWS_НоменклатураСервисов КАК CG_Online_IWS_НоменклатураСервисов\r\n\t|\t\tПО CG_Online_ЗаказыКлиентовСервисовТовары.Товар = CG_Online_IWS_НоменклатураСервисов.Ссылка\r\n\t|ГДЕ\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.ЗаказКлиента = &ДокументСсылка\r\n\t|;\r\n\t|\r\n\t|ВЫБРАТЬ\r\n\t|\tСписокЗаказов.НомерЗаказа КАК НомерЗаказа,\r\n\t|\tСписокЗаказов.НомерОтправления КАК НомерОтправления,\r\n\t|\tСписокЗаказов.Товар КАК Товар,\r\n\t|\tСписокЗаказов.Артикул КАК Артикул,\r\n\t|\tСписокЗаказов.УчетнаяЗапись КАК УчетнаяЗапись,\r\n\t|\tСписокЗаказов.ЗаказКлиентаСервиса КАК ЗаказКлиентаСервиса,\r\n\t|\tСписокЗаказов.ЗаказКлиента КАК ЗаказКлиента,\r\n\t|\tСписокЗаказов.КодСтроки КАК КодСтроки,\r\n\t|\tСписокЗаказов.Отменено КАК Отменено,\r\n\t|\tЗаказКлиентаТовары.Серия КАК Серия,\r\n\t|\tСписокЗаказов.Номенклатура КАК Номенклатура,\r\n\t|\tСписокЗаказов.Упаковка КАК Упаковка,\r\n\t|\tСписокЗаказов.Характеристика КАК Характеристика,\r\n\t|\tСписокЗаказов.Количество КАК КоличествоУпаковок,\r\n\t|\tЗаказКлиентаТовары.Количество КАК Количество\r\n\t|ПОМЕСТИТЬ СписокЗаказовССериями\r\n\t|ИЗ\r\n\t|\tСписокЗаказов КАК СписокЗаказов\r\n\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ ТоварыЗаказа КАК ЗаказКлиентаТовары\r\n\t|\t\tПО СписокЗаказов.ЗаказКлиента = ЗаказКлиентаТовары.ЗаказСсылка\r\n\t|\t\tИ СписокЗаказов.КодСтроки = ЗаказКлиентаТовары.КодСтроки\r\n\t|\t\tИ СписокЗаказов.Номенклатура = ЗаказКлиентаТовары.Номенклатура\r\n\t|;\r\n\t|\r\n\t|////////////////////////////////////////////////////////////////////////////////\r\n\t|ВЫБРАТЬ\r\n\t|\tСписокЗаказов.УчетнаяЗапись КАК УчетнаяЗапись,\r\n\t|\tСписокЗаказов.ЗаказКлиента КАК ЗаказКлиента,\r\n\t|\tСписокЗаказов.ЗаказКлиентаСервиса КАК ЗаказКлиентаСервиса,\r\n\t|\tЗаказыКлиентовСервисовМаркировкаТоваров.МаркировочныйЛист КАК МаркировочныйЛист,\r\n\t|\tЗаказыКлиентовСервисовМаркировкаТоваров.СтикерЧастьА КАК СтикерЧастьА,\r\n\t|\tЗаказыКлиентовСервисовМаркировкаТоваров.СтикерЧастьВ КАК СтикерЧастьВ,\r\n\t|\tЗаказыКлиентовСервисовМаркировкаТоваров.СтикерЗначение КАК СтикерЗначение,\r\n\t|\tСписокЗаказов.Артикул КАК Артикул,\r\n\t|\tСписокЗаказов.Товар КАК Товар,\r\n\t|\tСписокЗаказов.НомерЗаказа КАК НомерЗаказа,\r\n\t|\tСписокЗаказов.НомерОтправления КАК НомерОтправления,\r\n\t|\tСписокЗаказов.Количество КАК Количество,\r\n\t|\tСписокЗаказов.КодСтроки КАК КодСтроки,\r\n\t|\tСписокЗаказов.Отменено КАК Отменено,\r\n\t|\tСписокЗаказов.Серия КАК Серия,\r\n\t|\tСписокЗаказов.Номенклатура КАК Номенклатура,\r\n\t|\tСписокЗаказов.Упаковка КАК Упаковка,\r\n\t|\tСписокЗаказов.Характеристика КАК Характеристика,\r\n\t|\tСписокЗаказов.КоличествоУпаковок КАК КоличествоУпаковок\r\n\t|ИЗ\r\n\t|\tСписокЗаказовССериями КАК СписокЗаказов\r\n\t|\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.CG_Online_ЗаказыКлиентовСервисовМаркировкаТоваров КАК ЗаказыКлиентовСервисовМаркировкаТоваров\r\n\t|\t\tПО СписокЗаказов.НомерЗаказа = ЗаказыКлиентовСервисовМаркировкаТоваров.НомерЗаказа\r\n\t|\t\t\tИ СписокЗаказов.НомерОтправления = ЗаказыКлиентовСервисовМаркировкаТоваров.НомерОтправления\r\n\t|\t\t\tИ СписокЗаказов.Товар = ЗаказыКлиентовСервисовМаркировкаТоваров.Товар\r\n\t|\r\n\t|ГДЕ\r\n\t|\tне СписокЗаказов.Отменено\r\n\t|УПОРЯДОЧИТЬ ПО\r\n\t|\tТовар,\r\n\t|\tСерия,\r\n\t|\tАртикул,\r\n\t|\tНомерЗаказа,\r\n\t|\tНомерОтправления\";\n\nФункция ПодготовитьМаркировочныеЛистыССериями(ДокументСсылка,Порядок=0) Экспорт\r\n\r\n\tТекстЗапроса =\r\n\t\"ВЫБРАТЬ\r\n\t|\tЗаказКлиентаТовары.Ссылка КАК ЗаказСсылка,\r\n\t|\tЗаказКлиентаТовары.Серия КАК Серия,\r\n\t|\tЗаказКлиентаТовары.КодСтроки КАК КодСтроки,\r\n\t|\tЗаказКлиентаТовары.Номенклатура КАК Номенклатура,\r\n\t|\tЗаказКлиентаТовары.КоличествоУпаковок КАК КоличествоУпаковок,\r\n\t|\tЗаказКлиентаТовары.Количество КАК Количество\r\n\t|ПОМЕСТИТЬ ТоварыЗаказа\r\n\t|ИЗ\r\n\t|\tДокумент.ЗаказКлиента.Товары КАК ЗаказКлиентаТовары\r\n\t|ГДЕ\r\n\t|\tЗаказКлиентаТовары.Ссылка = &ДокументСсылка\r\n\t|;\r\n\t|ВЫБРАТЬ\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.НомерЗаказа КАК НомерЗаказа,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.НомерОтправления КАК НомерОтправления,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.Артикул КАК Артикул,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.Товар КАК Товар,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.УчетнаяЗапись КАК УчетнаяЗапись,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.ЗаказКлиентаСервиса КАК ЗаказКлиентаСервиса,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.ЗаказКлиента КАК ЗаказКлиента,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.КодСтроки КАК КодСтроки,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.Отменено КАК Отменено,\r\n\t|\tCG_Online_IWS_НоменклатураСервисов.Номенклатура КАК Номенклатура,\r\n\t|\tCG_Online_IWS_НоменклатураСервисов.Упаковка КАК Упаковка,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.Количество КАК Количество,\r\n\t|\tCG_Online_IWS_НоменклатураСервисов.Характеристика КАК Характеристика,\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.Количество КАК КоличествоУпаковок\r\n\t|ПОМЕСТИТЬ СписокЗаказов\r\n\t|ИЗ\r\n\t|\tРегистрСведений.CG_Online_ЗаказыКлиентовСервисовТовары КАК CG_Online_ЗаказыКлиентовСервисовТовары\r\n\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ Справочник.CG_Online_IWS_НоменклатураСервисов КАК CG_Online_IWS_НоменклатураСервисов\r\n\t|\t\tПО CG_Online_ЗаказыКлиентовСервисовТовары.Товар = CG_Online_IWS_НоменклатураСервисов.Ссылка\r\n\t|ГДЕ\r\n\t|\tCG_Online_ЗаказыКлиентовСервисовТовары.ЗаказКлиента = &ДокументСсылка\r\n\t|;\r\n\t|\r\n\t|ВЫБРАТЬ\r\n\t|\tСписокЗаказов.НомерЗаказа КАК НомерЗаказа,\r\n\t|\tСписокЗаказов.НомерОтправления КАК НомерОтправления,\r\n\t|\tСписокЗаказов.Товар КАК Товар,\r\n\t|\tСписокЗаказов.Артикул КАК Артикул,\r\n\t|\tСписокЗаказов.УчетнаяЗапись КАК УчетнаяЗапись,\r\n\t|\tСписокЗаказов.ЗаказКлиентаСервиса КАК ЗаказКлиентаСервиса,\r\n\t|\tСписокЗаказов.ЗаказКлиента КАК ЗаказКлиента,\r\n\t|\tСписокЗаказов.КодСтроки КАК КодСтроки,\r\n\t|\tСписокЗаказов.Отменено КАК Отменено,\r\n\t|\tЗаказКлиентаТовары.Серия КАК Серия,\r\n\t|\tСписокЗаказов.Номенклатура КАК Номенклатура,\r\n\t|\tСписокЗаказов.Упаковка КАК Упаковка,\r\n\t|\tСписокЗаказов.Характеристика КАК Характеристика,\r\n\t|\tСписокЗаказов.Количество КАК КоличествоУпаковок,\r\n\t|\tЗаказКлиентаТовары.Количество КАК Количество\r\n\t|ПОМЕСТИТЬ СписокЗаказовССериями\r\n\t|ИЗ\r\n\t|\tСписокЗаказов КАК СписокЗаказов\r\n\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ ТоварыЗаказа КАК ЗаказКлиентаТовары\r\n\t|\t\tПО СписокЗаказов.ЗаказКлиента = ЗаказКлиентаТовары.ЗаказСсылка\r\n\t|\t\tИ СписокЗаказов.КодСтроки = ЗаказКлиентаТовары.КодСтроки\r\n\t|\t\tИ СписокЗаказов.Номенклатура = ЗаказКлиентаТовары.Номенклатура\r\n\t|;\r\n\t|\r\n\t|////////////////////////////////////////////////////////////////////////////////\r\n\t|ВЫБРАТЬ\r\n\t|\tСписокЗаказов.УчетнаяЗапись КАК УчетнаяЗапись,\r\n\t|\tСписокЗаказов.ЗаказКлиента КАК ЗаказКлиента,\r\n\t|\tСписокЗаказов.ЗаказКлиентаСервиса КАК ЗаказКлиентаСервиса,\r\n\t|\tЗаказыКлиентовСервисовМаркировкаТоваров.МаркировочныйЛист КАК МаркировочныйЛист,\r\n\t|\tЗаказыКлиентовСервисовМаркировкаТоваров.СтикерЧастьА КАК СтикерЧастьА,\r\n\t|\tЗаказыКлиентовСервисовМаркировкаТоваров.СтикерЧастьВ КАК СтикерЧастьВ,\r\n\t|\tЗаказыКлиентовСервисовМаркировкаТоваров.СтикерЗначение КАК СтикерЗначение,\r\n\t|\tСписокЗаказов.Артикул КАК Артикул,\r\n\t|\tСписокЗаказов.Товар КАК Товар,\r\n\t|\tСписокЗаказов.НомерЗаказа КАК НомерЗаказа,\r\n\t|\tСписокЗаказов.НомерОтправления КАК НомерОтправления,\r\n\t|\tСписокЗаказов.Количество КАК Количество,\r\n\t|\tСписокЗаказов.КодСтроки КАК КодСтроки,\r\n\t|\tСписокЗаказов.Отменено КАК Отменено,\r\n\t|\tСписокЗаказов.Серия КАК Серия,\r\n\t|\tСписокЗаказов.Номенклатура КАК Номенклатура,\r\n\t|\tСписокЗаказов.Упаковка КАК Упаковка,\r\n\t|\tСписокЗаказов.Характеристика КАК Характеристика,\r\n\t|\tСписокЗаказов.КоличествоУпаковок КАК КоличествоУпаковок\r\n\t|ИЗ\r\n\t|\tСписокЗаказовССериями КАК СписокЗаказов\r\n\t|\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.CG_Online_ЗаказыКлиентовСервисовМаркировкаТоваров КАК ЗаказыКлиентовСервисовМаркировкаТоваров\r\n\t|\t\tПО СписокЗаказов.НомерЗаказа = ЗаказыКлиентовСервисовМаркировкаТоваров.НомерЗаказа\r\n\t|\t\t\tИ СписокЗаказов.НомерОтправления = ЗаказыКлиентовСервисовМаркировкаТоваров.НомерОтправления\r\n\t|\t\t\tИ СписокЗаказов.Товар = ЗаказыКлиентовСервисовМаркировкаТоваров.Товар\r\n\t|\r\n\t|ГДЕ\r\n\t|\tне СписокЗаказов.Отменено\r\n\t|УПОРЯДОЧИТЬ ПО\r\n\t|\tТовар,\r\n\t|\tСерия,\r\n\t|\tАртикул,\r\n\t|\tНомерЗаказа,\r\n\t|\tНомерОтправления\";\n\n{101} Ожидается EndFunction"
  },
  {
    "title": "ИР Кнопка \"Поиск\" в окне \"Параметры\"",
    "description": "ИР Кнопка \"Поиск\" в окне \"Параметры\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Вычислить выражения строки",
    "description": "ИР Вычислить выражения строкиTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Подсчет количества уникальных значений колонки в тз",
    "description": "Подсчет количества уникальных значений колонки в тз",
    "code_snippet": "Запрос = Новый Запрос;\n\t\tЗапрос.Текст = \"ВЫБРАТЬ *\n\t\t|ПОМЕСТИТЬ ВТ_ТЗ\n\t\t|ИЗ\n\t\t|\t&ТЗ КАК ТЗ\n\t\t|;\n\t\t|\n\t\t|////////////////////////////////////////////////////////////////////////////////\n\t\t|ВЫБРАТЬ РАЗЛИЧНЫЕ ВТ_ТЗ.(Колонка)\n\t\t|ИЗ\n\t\t|\tВТ_ТЗ КАК ВТ_ТЗ\n\t\t|\";\n\t\tЗапрос.УстановитьПараметр(\"ТЗ\", ТЗ);\n\t\t\n\t\tРезультатЗапроса = Запрос.Выполнить();\n\t\tТаблицаЗапроса = РезультатЗапроса.Выгрузить(); \n\t\tУникальныеТЗ = ТаблицаЗапроса.Количество();"
  },
  {
    "title": "Линейка - панель с номерами строк",
    "description": "Включает/отключает в окнах текстовых документов панель с отображением номеров строк",
    "code_snippet": ""
  },
  {
    "title": "Преобразование JSON в структуру и обратно",
    "description": "Преобразование JSON в структуру и обратно",
    "code_snippet": "Функция JSONВСтруктуру(СтрокаJSON, ПрочитатьВСоответствие=Ложь) Экспорт\n\tЕсли ПустаяСтрока(СтрокаJSON) Тогда\n\t\tВозврат Новый Структура;\t\n\tКонецЕсли;\n\tЧтениеJSON = Новый ЧтениеJSON;\n\tЧтениеJSON.УстановитьСтроку(СтрокаJSON);\n\tСтруктура = ПрочитатьJSON(ЧтениеJSON,ПрочитатьВСоответствие);\n\tЧтениеJSON.Закрыть();\n\tВозврат Структура;\nКонецФункции\n\nФункция СтруктураВJSON(Структура, ПутьКФайлу=\"\") Экспорт\n\tЗаписьJSON = Новый ЗаписьJSON;\n\tЕсли Не ПустаяСтрока(ПутьКФайлу) Тогда\n\t\tЗаписьJSON.ОткрытьФайл(ПутьКФайлу);\n\tИначе\t\t\n\t\tЗаписьJSON.УстановитьСтроку();\n\tКонецЕсли;\n\tЗаписатьJSON(ЗаписьJSON, Структура);\n\tЗначение = ЗаписьJSON.Закрыть();\n\tВозврат Значение;\nКонецФункции"
  },
  {
    "title": "Конвертация даты в UNIX и обратно",
    "description": "Конвертация даты в UNIX и обратно",
    "code_snippet": "Функция ДатаВUNIX(Дата) Экспорт\n\tРезультат = Число((Дата - '19700101') * 1000);\n\tРезультат = Формат(Результат, \"ЧГ=\");\n\tВозврат Результат;\nКонецФункции\n\nФункция UNIXВДату(Unix) Экспорт\n\tЕсли ПустаяСтрока(Unix) Тогда\n\t\tВозврат Дата('00010101');\n\tКонецЕсли;\n\tРезультат = Формат(Unix,\"ЧГ=\");\n\tРезультат = Дата(1970,1,1,1,0,0) + Число(Лев(Результат,10));\n\tВозврат Результат;\nКонецФункции\n\nФункция ДатаВUNIX(Дата) Экспорт\n\tРезультат = Число((Дата - МестноеВремя(Дата(1970,1,1,0,0,0), ЧасовойПоясСеанса())));\n\tРезультат = Формат(Результат, \"ЧГ=\");\n\tВозврат Результат;\nКонецФункции\n\nФункция UNIXВДату(Unix) Экспорт\n\tЕсли ПустаяСтрока(Unix) Тогда\n\t\tВозврат Дата('00010101');\n\tКонецЕсли;\n\tРезультат = Формат(Unix,\"ЧГ=\");\n\tРезультат = МестноеВремя(Дата(1970,1,1,0,0,0), ЧасовойПоясСеанса()) + Число(Лев(Результат,10));\n\tВозврат Результат;\nКонецФункции"
  },
  {
    "title": "Удаление пустых строк",
    "description": "Удаление пустых строк в коде",
    "code_snippet": ""
  },
  {
    "title": "Шаблоны кода 1С",
    "description": "Шаблоны кода 1С",
    "code_snippet": ""
  },
  {
    "title": "Секреты TurboConf",
    "description": "Секреты TurboConf",
    "code_snippet": ""
  },
  {
    "title": "TurboConf ИР",
    "description": "TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Нейросети и AI",
    "description": "Нейросети и AI",
    "code_snippet": ""
  },
  {
    "title": "Лайфхаки 1С",
    "description": "Лайфхаки 1С",
    "code_snippet": ""
  },
  {
    "title": "Бубен админа",
    "description": "Бубен админа",
    "code_snippet": ""
  },
  {
    "title": "1С не всерьез",
    "description": "1С не всерьез",
    "code_snippet": ""
  },
  {
    "title": "ИР Вставить со сравнением",
    "description": "ИР Вставить со сравнениемTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Вызов метода API",
    "description": "Вызов метода API",
    "code_snippet": "Функция ПримерВызоваМетодаAPI()\r\n\t\r\n\tСоединение = Новый HTTPСоединение(\"https://<адрес API>\",,,,,5,Новый ЗащищенноеСоединениеOpenSSL);\r\n\r\n\tЗапрос = Новый HTTPЗапрос();\r\n\t\r\n\tЗапрос.АдресРесурса = \"/api/v1/echo\";\r\n\tЗапрос.Заголовки.Вставить(\"Authorization\", \"Ключ сервиса\");\r\n\tЗапрос.Заголовки.Вставить(\"Content-Type\", \"application/json\");\r\n\t\r\n\tДанныеДляПередачи = Новый Структура(\"data\");\r\n\t\r\n\tЗаписьJSON = Новый ЗаписьJSON;\r\n\tПараметрыЗаписиJSON = Новый ПараметрыЗаписиJSON(, Символы.Таб);\r\n\tЗаписьJSON.УстановитьСтроку(ПараметрыЗаписиJSON);\r\n\tЗаписатьJSON(ЗаписьJSON, ДанныеДляПередачи);\r\n\tТелоЗапросаСтрока = ЗаписьJSON.Закрыть();\r\n\t\r\n\tЗапрос.УстановитьТелоИзСтроки(ТелоЗапросаСтрока);\r\n\t\r\n\tОтветHTTP = Соединение.ВызватьHTTPМетод(\"POST\", Запрос);\r\n\t\r\n\tКодСостояния = ОтветHTTP.КодСостояния;\r\n\t\r\n\tЕсли КодСостояния < 200 Или КодСостояния >= 300 Тогда\r\n\t\tСообщить(\"Ошибка \" + КодСостояния + \" подключения к сервису \" + ОтветHTTP.ПолучитьТелоКакСтроку());\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\tСтрокаJSON = ОтветHTTP.ПолучитьТелоКакСтроку();\t\r\n\t\r\n\tВозврат СтрокаJSON;\r\n\t\r\nКонецФункции\n\nФункция ПримерВызоваМетодаAPI()\r\n\t\r\n\tСоединение = Новый HTTPСоединение(\"https://<адрес API>\",,,,,5,Новый ЗащищенноеСоединениеOpenSSL);\r\n\r\n\tЗапрос = Новый HTTPЗапрос();\r\n\t\r\n\tЗапрос.АдресРесурса = \"/api/v1/echo\";\r\n\tЗапрос.Заголовки.Вставить(\"Authorization\", \"Ключ сервиса\");\r\n\tЗапрос.Заголовки.Вставить(\"Content-Type\", \"application/json\");\r\n\t\r\n\tДанныеДляПередачи = Новый Структура(\"data\");\r\n\t\r\n\tЗаписьJSON = Новый ЗаписьJSON;\r\n\tПараметрыЗаписиJSON = Новый ПараметрыЗаписиJSON(, Символы.Таб);\r\n\tЗаписьJSON.УстановитьСтроку(ПараметрыЗаписиJSON);\r\n\tЗаписатьJSON(ЗаписьJSON, ДанныеДляПередачи);\r\n\tТелоЗапросаСтрока = ЗаписьJSON.Закрыть();\r\n\t\r\n\tЗапрос.УстановитьТелоИзСтроки(ТелоЗапросаСтрока);\r\n\t\r\n\tОтветHTTP = Соединение.ВызватьHTTPМетод(\"POST\", Запрос);\r\n\t\r\n\tКодСостояния = ОтветHTTP.КодСостояния;\r\n\t\r\n\tЕсли КодСостояния < 200 Или КодСостояния >= 300 Тогда\r\n\t\tСообщить(\"Ошибка \" + КодСостояния + \" подключения к сервису \" + ОтветHTTP.ПолучитьТелоКакСтроку());\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\tСтрокаJSON = ОтветHTTP.ПолучитьТелоКакСтроку();\t\r\n\t\r\n\tВозврат СтрокаJSON;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Поиск всех вхождений регулярного выражения в исходной строке",
    "description": "Поиск всех вхождений регулярного выражения в исходной строке",
    "code_snippet": "// определим количество закрывающих тегов блоков \"item\"\nКоличествоСтрок = СтрНайтиВсеПоРегулярномуВыражению(ТекстПакета,  \"</.*_item>\", Истина).Количество();"
  },
  {
    "title": "FastCode AI (ИИ помощник в Конфигураторе 1С)",
    "description": "Добавляет возможности использования ИИ в Конфигураторе 1С с TurboConf.",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"В json-конструктор\" в окне \"Выражение\"",
    "description": "ИР Кнопка \"В json-конструктор\" в окне \"Выражение\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Високосный ли год?",
    "description": "Високосный ли год?",
    "code_snippet": "method Leap(year:Number):Boolean\n\t\n    case True \n    when year % 400 == 0\n\t\t    return True\n\t\t\n    when year % 100 == 0\n\t\t    return False\n\t\t\n    when year % 4 == 0\n\t\t    return True\n    else\n\t\t    return False\n    ; \n;\n\n// пример использования\nmethod Script()\n    \n    for y = 1900 to 2100\n        if Leap(y)\n            Console.Write(y)\n        ;\n    ;    \n;\n\nметод Скрипт()\n\n    пер Результат = ЭтотГодВисокосный_1(Год = 2023)  // Ложь    \n    \n    Консоль.Записать(\"$Результат\")\n\t\t\n\n    Результат = ЭтотГодВисокосный_2(Год = 2024)  // Истина    \n    \n    Консоль.Записать(\"$Результат\")\n;\n\n//////////////////////////////////////////////////////////\nметод ЭтотГодВисокосный_1(Год: Число): Булево\n    \n    знч ПоследнийДеньФевраля = новый Дата(Год, 2, 1).КонецМесяца()\n\t\t                                            .День\n    возврат ПоследнийДеньФевраля == 29\n;\n\n//////////////////////////////////////////////////////////\nметод ЭтотГодВисокосный_2(Год: Число): Булево\n    \n    знч ПоследнийДеньГода = новый Дата(Год, 12, 31).ДеньГода()\n    возврат ПоследнийДеньГода == 366\n;"
  },
  {
    "title": "Синоним из идентификатора",
    "description": "Синоним из идентификатора",
    "code_snippet": "Функция СинонимИзИдентификатора(Идентификатор)\n\tВозврат СокрЛП(ВРЕГ(Лев(Идентификатор,1)) + нрег(СтрЗаменитьПоРегулярномуВыражению(Сред(Идентификатор,2),\"([А-ЯЁA-Z][^А-ЯЁA-z]*)\",\" $1\")));\nКонецФункции"
  },
  {
    "title": "Проверить расположен ли один элемент управляемой формы внутри другого",
    "description": "Проверить расположен ли один элемент управляемой формы внутри другого",
    "code_snippet": "// Проверить расположен ли элемент управляемой формы ПроверяемыйЭлемент внутри элемента Родитель.\r\n// Параметры:\r\n//   Родитель - ГруппаФормы, ТаблицаФормы, ФормаКлиентскогоПриложения - \r\n//   ПроверяемыйЭлемент - ПолеФормы, ГруппаФормы, ТаблицаФормы, КнопкаФормы, ДекорацияФормы - \r\n// Возвращаемое значение:\r\n//   Булево - \r\nФункция ЛиВнутриРодителяФормыЛкс(Знач Родитель, Знач ПроверяемыйЭлемент) Экспорт\r\n\tТекущийРодитель = ПроверяемыйЭлемент;\r\n\tПока Истина Цикл\r\n\t\tЕсли ТекущийРодитель = Родитель Тогда\r\n\t\t\tВозврат Истина;\r\n\t\tКонецЕсли;\r\n\t\tЕсли ТипЗнч(ТекущийРодитель) = Тип(\"ФормаКлиентскогоПриложения\") Тогда\r\n\t\t\tВозврат Ложь;\r\n\t\tКонецЕсли;\r\n\t\tТекущийРодитель = ТекущийРодитель.Родитель;\r\n\tКонецЦикла; \r\nКонецФункции\n\n// Проверить расположен ли элемент управляемой формы ПроверяемыйЭлемент внутри элемента Родитель.\r\n// Параметры:\r\n//   Родитель - ГруппаФормы, ТаблицаФормы, ФормаКлиентскогоПриложения - \r\n//   ПроверяемыйЭлемент - ПолеФормы, ГруппаФормы, ТаблицаФормы, КнопкаФормы, ДекорацияФормы - \r\n// Возвращаемое значение:\r\n//   Булево - \r\nФункция ЛиВнутриРодителяФормыЛкс(Знач Родитель, Знач ПроверяемыйЭлемент) Экспорт\r\n\tТекущийРодитель = ПроверяемыйЭлемент;\r\n\tПока Истина Цикл\r\n\t\tЕсли ТекущийРодитель = Родитель Тогда\r\n\t\t\tВозврат Истина;\r\n\t\tКонецЕсли;\r\n\t\tЕсли ТипЗнч(ТекущийРодитель) = Тип(\"ФормаКлиентскогоПриложения\") Тогда\r\n\t\t\tВозврат Ложь;\r\n\t\tКонецЕсли;\r\n\t\tТекущийРодитель = ТекущийРодитель.Родитель;\r\n\tКонецЦикла; \r\nКонецФункции\n\n{7} Не все части функции возвращают значение"
  },
  {
    "title": "ИР Проверить модуль (CTRL+F7)",
    "description": "ИР Проверить модуль (CTRL+F7)TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Аналоги функций ДобавитьКДате и РазностьДат языка запросов",
    "description": "Аналоги функций ДобавитьКДате и РазностьДат языка запросов",
    "code_snippet": "//.\r\n// Возвращаемое значение:\r\n//   Структура - значения положительны для месячных типов и отрицательны для секундных\r\nФункция МножителиТиповПериодов() Экспорт\r\n\tСутки = 24*60*60;\r\n\tМножители = Новый Структура(\"Год, Полугодие, Квартал, Месяц,    Декада,   Неделя,     День,    Час, Минута, Секунда\",\r\n\t\t\t                     12,          6,       3,     1, -10*Сутки, -7*Сутки, -1*Сутки, -60*60,    -60,      -1);\r\n\tВозврат Множители;\r\nКонецФункции \r\n\r\n// Аналог функции ДобавитьКДате языка запросов.\r\n// Параметры:\r\n//   ИсходнаяДата - Дата - \r\n//   ТипПериода - Строка - имя типа периода аналогично языку запросов, регистр букв не важен\r\n//   Количество - Число - допускается отрицательное\r\n// Возвращаемое значение:\r\n//   Дата - \r\nФункция ДобавитьКДате(Знач ИсходнаяДата, Знач ТипПериода, Знач Количество = -1) Экспорт\r\n\tТипПериода = ВРег(ТипПериода);\r\n\tЕсли Найти(\"ГОД;КВАРТАЛ;ПОЛУГОДИЕ;МЕСЯЦ;\", ТипПериода + \";\") > 0 Тогда\r\n\t\tЕсли Цел(Количество) <> Количество Тогда\r\n\t\t\tВызватьИсключение \"Количество должно быть целым числом для типа периода \" + ТипПериода;\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\tМножители = МножителиТиповПериодов();\r\n\tЕсли Не Множители.Свойство(ТипПериода) Тогда\r\n\t\tВызватьИсключение \"Неподдерживаемый тип периода: \" + ТипПериода;\r\n\tКонецЕсли;\r\n\tЕсли Множители[ТипПериода] > 0 Тогда\r\n\t\tВозврат ДобавитьМесяц(ИсходнаяДата, Количество * Множители[ТипПериода]);\r\n\tИначе\r\n\t\tВозврат ИсходнаяДата - Количество * Множители[ТипПериода];\r\n\tКонецЕсли;\r\nКонецФункции \r\n\r\n// Аналог функции РазностьДат языка запросов.\r\n// Параметры:\r\n//   ВычитаемаяДата - Дата - которую вычитаем\r\n//   ИсходнаяДата - Дата - из которой вычитаем\r\n//   ТипПериода - Строка - имя типа периода аналогично языку запросов, регистр букв не важен\r\n// Возвращаемое значение:\r\n//   Число - ИсходнаяДата-ВычитаемаяДата\r\nФункция РазностьДат(Знач ВычитаемаяДата, Знач ИсходнаяДата, Знач ТипПериода) Экспорт\r\n\tМножители = МножителиТиповПериодов();\r\n\tЕсли Не Множители.Свойство(ТипПериода) Тогда\r\n\t\tВызватьИсключение \"Неподдерживаемый тип периода: \" + ТипПериода;\r\n\tКонецЕсли;\r\n\tЕсли Множители[ТипПериода] > 0 Тогда\r\n\t\tВозврат Цел((Год(ИсходнаяДата)   * 12 + Месяц(ИсходнаяДата)   - 1) / Множители[ТипПериода])\r\n\t\t\t  - Цел((Год(ВычитаемаяДата) * 12 + Месяц(ВычитаемаяДата) - 1) / Множители[ТипПериода])\r\n\tИначе\r\n\t\tВозврат Цел((Дата(1,1,1) - ИсходнаяДата)   / Множители[ТипПериода])\r\n\t\t\t  - Цел((Дата(1,1,1) - ВычитаемаяДата) / Множители[ТипПериода])\r\n\tКонецЕсли;\r\nКонецФункции\n\n//.\r\n// Возвращаемое значение:\r\n//   Структура - значения положительны для месячных типов и отрицательны для секундных\r\nФункция МножителиТиповПериодов() Экспорт\r\n\tСутки = 24*60*60;\r\n\tМножители = Новый Структура(\"Год, Полугодие, Квартал, Месяц,    Декада,   Неделя,     День,    Час, Минута, Секунда\",\r\n\t\t\t                     12,          6,       3,     1, -10*Сутки, -7*Сутки, -1*Сутки, -60*60,    -60,      -1);\r\n\tВозврат Множители;\r\nКонецФункции \r\n\r\n// Аналог функции ДобавитьКДате языка запросов.\r\n// Параметры:\r\n//   ИсходнаяДата - Дата - \r\n//   ТипПериода - Строка - имя типа периода аналогично языку запросов, регистр букв не важен\r\n//   Количество - Число - допускается отрицательное\r\n// Возвращаемое значение:\r\n//   Дата - \r\nФункция ДобавитьКДате(Знач ИсходнаяДата, Знач ТипПериода, Знач Количество = -1) Экспорт\r\n\tТипПериода = ВРег(ТипПериода);\r\n\tЕсли Найти(\"ГОД;КВАРТАЛ;ПОЛУГОДИЕ;МЕСЯЦ;\", ТипПериода + \";\") > 0 Тогда\r\n\t\tЕсли Цел(Количество) <> Количество Тогда\r\n\t\t\tВызватьИсключение \"Количество должно быть целым числом для типа периода \" + ТипПериода;\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\tМножители = МножителиТиповПериодов();\r\n\tЕсли Не Множители.Свойство(ТипПериода) Тогда\r\n\t\tВызватьИсключение \"Неподдерживаемый тип периода: \" + ТипПериода;\r\n\tКонецЕсли;\r\n\tЕсли Множители[ТипПериода] > 0 Тогда\r\n\t\tВозврат ДобавитьМесяц(ИсходнаяДата, Количество * Множители[ТипПериода]);\r\n\tИначе\r\n\t\tВозврат ИсходнаяДата - Количество * Множители[ТипПериода];\r\n\tКонецЕсли;\r\nКонецФункции \r\n\r\n// Аналог функции РазностьДат языка запросов.\r\n// Параметры:\r\n//   ВычитаемаяДата - Дата - которую вычитаем\r\n//   ИсходнаяДата - Дата - из которой вычитаем\r\n//   ТипПериода - Строка - имя типа периода аналогично языку запросов, регистр букв не важен\r\n// Возвращаемое значение:\r\n//   Число - ИсходнаяДата-ВычитаемаяДата\r\nФункция РазностьДат(Знач ВычитаемаяДата, Знач ИсходнаяДата, Знач ТипПериода) Экспорт\r\n\tМножители = МножителиТиповПериодов();\r\n\tЕсли Не Множители.Свойство(ТипПериода) Тогда\r\n\t\tВызватьИсключение \"Неподдерживаемый тип периода: \" + ТипПериода;\r\n\tКонецЕсли;\r\n\tЕсли Множители[ТипПериода] > 0 Тогда\r\n\t\tВозврат Цел((Год(ИсходнаяДата)   * 12 + Месяц(ИсходнаяДата)   - 1) / Множители[ТипПериода])\r\n\t\t\t  - Цел((Год(ВычитаемаяДата) * 12 + Месяц(ВычитаемаяДата) - 1) / Множители[ТипПериода])\r\n\tИначе\r\n\t\tВозврат Цел((Дата(1,1,1) - ИсходнаяДата)   / Множители[ТипПериода])\r\n\t\t\t  - Цел((Дата(1,1,1) - ВычитаемаяДата) / Множители[ТипПериода])\r\n\tКонецЕсли;\r\nКонецФункции"
  },
  {
    "title": "Форматирование строки JSON",
    "description": "Форматирование строки JSON",
    "code_snippet": "Функция ФорматироватьСтрокуJSON(СтрокаJSON, ПереносСтрокJSON, СимволыОтступа = \" \", ИспользоватьДвойныеКавычки = Истина, ЭкранированиеСимволов = Неопределено) \t\r\n\t\r\n\tЧтениеJSON = Новый ЧтениеJSON;\r\n\tЧтениеJSON.УстановитьСтроку(СтрокаJSON);\r\n\tСтруктура = ПрочитатьJSON(ЧтениеJSON, Ложь);\r\n\t\r\n\tЗаписьJSON = Новый ЗаписьJSON;\r\n\tПараметрыJSON = Новый ПараметрыЗаписиJSON(ПереносСтрокJSON, СимволыОтступа, ИспользоватьДвойныеКавычки, ЭкранированиеСимволов);\r\n\tЗаписьJSON.УстановитьСтроку(ПараметрыJSON);\r\n\t\r\n\tЗаписатьJSON(ЗаписьJSON, Структура);\r\n\t\r\n\tСтрокаJSON = ЗаписьJSON.Закрыть();\r\n\r\n\tВозврат СтрокаJSON;\r\n\t\r\nКонецФункции\n\nФункция ФорматироватьСтрокуJSON(СтрокаJSON, ПереносСтрокJSON, СимволыОтступа = \" \", ИспользоватьДвойныеКавычки = Истина, ЭкранированиеСимволов = Неопределено) \t\r\n\t\r\n\tЧтениеJSON = Новый ЧтениеJSON;\r\n\tЧтениеJSON.УстановитьСтроку(СтрокаJSON);\r\n\tСтруктура = ПрочитатьJSON(ЧтениеJSON, Ложь);\r\n\t\r\n\tЗаписьJSON = Новый ЗаписьJSON;\r\n\tПараметрыJSON = Новый ПараметрыЗаписиJSON(ПереносСтрокJSON, СимволыОтступа, ИспользоватьДвойныеКавычки, ЭкранированиеСимволов);\r\n\tЗаписьJSON.УстановитьСтроку(ПараметрыJSON);\r\n\t\r\n\tЗаписатьJSON(ЗаписьJSON, Структура);\r\n\t\r\n\tСтрокаJSON = ЗаписьJSON.Закрыть();\r\n\r\n\tВозврат СтрокаJSON;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Преобразование Строки в строку Base64",
    "description": "Преобразование Строки в строку Base64",
    "code_snippet": "Функция СтрокаBase64(Стр, Кодировка = Неопределено, ЗаписатьBOM = Ложь) Экспорт\r\n\t\r\n\tЕсли НЕ ЗначениеЗаполнено(Кодировка) Тогда\r\n\t\tКодировка = КодировкаТекста.UTF8;\r\n\tКонецЕСли;\r\n\t\r\n\tДвоичныеДанныеСтроки = ПолучитьДвоичныеДанныеИзСтроки(Стр, Кодировка, ЗаписатьBOM);\r\n\tРезультат = Base64Строка(ДвоичныеДанныеСтроки);\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nФункция СтрокаBase64(Стр, Кодировка = Неопределено, ЗаписатьBOM = Ложь) Экспорт\r\n\t\r\n\tЕсли НЕ ЗначениеЗаполнено(Кодировка) Тогда\r\n\t\tКодировка = КодировкаТекста.UTF8;\r\n\tКонецЕСли;\r\n\t\r\n\tДвоичныеДанныеСтроки = ПолучитьДвоичныеДанныеИзСтроки(Стр, Кодировка, ЗаписатьBOM);\r\n\tРезультат = Base64Строка(ДвоичныеДанныеСтроки);\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "ИР Кнопка \"ОК\" в окне \"Тип вызова\" для расширения метода",
    "description": "ИР Кнопка \"ОК\" в окне \"Тип вызова\" для расширения методаВсе",
    "code_snippet": ""
  },
  {
    "title": "Преобразовать Структуру в Таблицу значений (одну строку)",
    "description": "Преобразовать Структуру в Таблицу значений (одну строку)",
    "code_snippet": "// Преобразовать Структуру в Таблицу значений (одну строку)\n// Каждое значение станет колонкой в таблице значений,\n// тип значения в колонке будет определён по содержащемуся в поле значению\n//\n// Параметры:\n//  Данные - Структура - Исходные данные\n// \n// Возвращаемое значение:\n//  ТаблицаЗначений - Таблица значений с одной строкой, содержащей значения исходной структуры\n//\nФункция ДанныеСтруктурыВТаблицуЗначений(Знач Данные) Экспорт\n\t\n\tРезультат = Новый ТаблицаЗначений;\n\t\n\tДля Каждого ТекЗначение Из Данные Цикл\n\t\tТипы = Новый Массив;\n\t\tТипы.Добавить(ТипЗнч(ТекЗначение.Значение));\n\t\tРезультат.Колонки.Добавить(ТекЗначение.Ключ, Новый ОписаниеТипов(Типы));\n\tКонецЦикла;\n\t\n\tНС = Результат.Добавить();\n\tЗаполнитьЗначенияСвойств(НС, Данные);\n\t\n\tВозврат Результат;\n\t\nКонецФункции"
  },
  {
    "title": "ИР Измененные модули",
    "description": "ИР Измененные модулиTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Проверка пересечения периодов (интервалов дат) в запросе",
    "description": "Проверка пересечения периодов (интервалов дат) в запросе",
    "code_snippet": "//Истина - есть пересечения\r\n//Ложь - пересечений нет.\r\nФункция ЕстьПересечениеДат(НачалоПериода, КонецПериода)\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tВашДокумент.Ссылка\r\n\t\t|ИЗ\r\n\t\t|\tДокумент.ВашДокумент КАК ВашДокумент\r\n\t\t|ГДЕ\r\n\t\t|\tПлановыйГрафикРаботы.Проведен\r\n\t\t|\tИ &НачалоПериода < ВашДокумент.КонецПериода\r\n\t\t|\t\t\tИ &КонецПериода > ВашДокумент.НачалоПериода\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"НачалоПериода\", НачалоПериода);\r\n\tЗапрос.УстановитьПараметр(\"КонецПериода\", КонецПериода);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();  \t\r\n\tВозврат Не РезультатЗапроса.Пустой();\r\n\r\nКонецФункции\n\n//Истина - есть пересечения\r\n//Ложь - пересечений нет.\r\nФункция ЕстьПересечениеДат(НачалоПериода, КонецПериода)\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tВашДокумент.Ссылка\r\n\t\t|ИЗ\r\n\t\t|\tДокумент.ВашДокумент КАК ВашДокумент\r\n\t\t|ГДЕ\r\n\t\t|\tПлановыйГрафикРаботы.Проведен\r\n\t\t|\tИ &НачалоПериода < ВашДокумент.КонецПериода\r\n\t\t|\t\t\tИ &КонецПериода > ВашДокумент.НачалоПериода\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"НачалоПериода\", НачалоПериода);\r\n\tЗапрос.УстановитьПараметр(\"КонецПериода\", КонецПериода);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();  \t\r\n\tВозврат Не РезультатЗапроса.Пустой();\r\n\r\nКонецФункции"
  },
  {
    "title": "Просклонять число лет",
    "description": "Просклонять число лет",
    "code_snippet": "Функция ПросклонятьЧислоЛет(Знач ЧислоЛет)\r\n   а = ПолучитьСклоненияСтрокиПоЧислу(\"год\", ЧислоЛет, \"\",  \"ЧС=Количественное\", \"ПД=Именительный\")[0];\r\n   Возврат СтрЗаменить(а,\"годов\",\"лет\");\r\nКонецФункции\n\nФункция ПросклонятьЧислоЛет(Знач ЧислоЛет)\r\n   а = ПолучитьСклоненияСтрокиПоЧислу(\"год\", ЧислоЛет, \"\",  \"ЧС=Количественное\", \"ПД=Именительный\")[0];\r\n   Возврат СтрЗаменить(а,\"годов\",\"лет\");\r\nКонецФункции"
  },
  {
    "title": "Шаблон метода для заполнения Таблицы формы данными из СКД по макету",
    "description": "Шаблон метода для заполнения Таблицы формы данными из СКД по макету",
    "code_snippet": "&НаСервере\nПроцедура ОбновитьДанныеТаблицы(Вариант = \"СворачиваниеНулевыхОстатков\")\n\t\n\tОбъектОбработки = РеквизитФормыВЗначение(\"Объект\");\n\t\n\tСхемаКомпоновкиДанных = ОбъектОбработки.ПолучитьМакет(Вариант);\n\t\n\t// ТекстЗапроса = СхемаКомпоновкиДанных.НаборыДанных.НаборДанных1.Запрос;\n\tТекстЗапроса = ТекстЗапросаДляСхемы(СхемаКомпоновкиДанных, Вариант);\n\t\n\tЕсли КоличествоВыдаваемыхПозиций = 0 Тогда\n\t\tТекстЗапроса = СтрЗаменить(ТекстЗапроса, \" ПЕРВЫЕ 100\", \"\");\n\tИначе\n\t\tТекстЗапроса = СтрЗаменить(ТекстЗапроса, \" ПЕРВЫЕ 100\", \" ПЕРВЫЕ \" + КоличествоВыдаваемыхПозиций);\n\tКонецЕсли;\n\t\n\tСхемаКомпоновкиДанных.НаборыДанных.НаборДанных1.Запрос = ТекстЗапроса;\n\t\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\n\tКомпоновщикНастроек = Новый КомпоновщикНастроекКомпоновкиДанных;\n\tКомпоновщикНастроек.Инициализировать(Новый ИсточникДоступныхНастроекКомпоновкиДанных(СхемаКомпоновкиДанных));\n\tКомпоновщикНастроек.ЗагрузитьНастройки(СхемаКомпоновкиДанных.НастройкиПоУмолчанию);\n\t\n\tТекПараметр = Новый ПараметрКомпоновкиДанных(\"ДатаОтчета\");\n\tТекЗначение = КонецДня(ДатаОтчета);\n\tКомпоновщикНастроек.Настройки.ПараметрыДанных.УстановитьЗначениеПараметра(ТекПараметр, ТекЗначение);\n\t\n\tМакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных,\n\t                                                    КомпоновщикНастроек.ПолучитьНастройки(),\n\t                                                    ,\n\t                                                    ,\n\t                                                    Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\n\t\n\tПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;\n\tПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновкиДанных);\n\t\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\n\t\n\tДанныеОстатков_ = Новый ДеревоЗначений;\n\tПроцессорВывода.УстановитьОбъект(ДанныеОстатков_);\n\tПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);\n\t\n\tЗначениеВРеквизитФормы(ДанныеОстатков_, \"ДанныеОстатков\");\n\t\nКонецПроцедуры"
  },
  {
    "title": "ИР Кнопка \"Ловить изменение\" в окне \"Выражение\"",
    "description": "ИР Кнопка \"Ловить изменение\" в окне \"Выражение\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Получить уровень вложенности дерева значений",
    "description": "Получить уровень вложенности дерева значений",
    "code_snippet": "Функция ПолучитьМаксГлубинуДерева(ДеревоЗначений) Экспорт\r\n\r\n   МаксГлубина = 0;\r\n   Для Каждого Строка Из ДеревоЗначений.Строки Цикл\r\n       МаксГлубина = Макс(МаксГлубина, РекурсивныйОбходДерева(Строка, 1));\r\n   КонецЦикла;\r\n\r\n   Возврат МаксГлубина;\r\n\r\nКонецФункции\r\n\r\nФункция РекурсивныйОбходДерева(Строка, ТекущаяГлубина)\r\n\r\n   МаксГлубина = ТекущаяГлубина;\r\n   Для Каждого ПодчиненнаяСтрока Из Строка.Строки Цикл\r\n       МаксГлубина = Макс(МаксГлубина, РекурсивныйОбходДерева(ПодчиненнаяСтрока, ТекущаяГлубина + 1));\r\n   КонецЦикла;\r\n\r\n   Возврат МаксГлубина;\r\n\r\nКонецФункции\r\n\r\n// МаксГлубинаДерева = ПолучитьМаксГлубинуДерева(ДеревоЗначений);\n\nФункция ПолучитьМаксГлубинуДерева(ДеревоЗначений) Экспорт\r\n\r\n   МаксГлубина = 0;\r\n   Для Каждого Строка Из ДеревоЗначений.Строки Цикл\r\n       МаксГлубина = Макс(МаксГлубина, РекурсивныйОбходДерева(Строка, 1));\r\n   КонецЦикла;\r\n\r\n   Возврат МаксГлубина;\r\n\r\nКонецФункции\r\n\r\nФункция РекурсивныйОбходДерева(Строка, ТекущаяГлубина)\r\n\r\n   МаксГлубина = ТекущаяГлубина;\r\n   Для Каждого ПодчиненнаяСтрока Из Строка.Строки Цикл\r\n       МаксГлубина = Макс(МаксГлубина, РекурсивныйОбходДерева(ПодчиненнаяСтрока, ТекущаяГлубина + 1));\r\n   КонецЦикла;\r\n\r\n   Возврат МаксГлубина;\r\n\r\nКонецФункции\r\n\r\n// МаксГлубинаДерева = ПолучитьМаксГлубинуДерева(ДеревоЗначений);"
  },
  {
    "title": "ИР Кнопка \"Сравнить\" в окне \"Отчет сравнения метаданных\"",
    "description": "ИР Кнопка \"Сравнить\" в окне \"Отчет сравнения метаданных\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Процедура Изобразить сканер штрих-кода",
    "description": "Процедура Изобразить сканер штрих-кода",
    "code_snippet": "// Команда формы для вызова\r\n&НаКлиенте\r\nПроцедура ИзобразитьСканерШК(Команда)\r\n\t\r\n\tИзобразитьСканерШКДанныеВОсновных(\"68331545384715610814882357176103939876\");\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ИзобразитьСканерШКДанныеВОсновных(Данные)\r\n\t\r\n\tИмяСобытия = \"ScanData\";\r\n\tИсточник = \"ПодключаемоеОборудование\";\r\n\tПараметр = Новый Массив;\r\n\tПараметр.Добавить(Данные);\r\n\tПараметр.Добавить(Неопределено);\r\n\t\r\n\tглПодключаемоеОборудованиеСобытиеОбработано = Ложь;\r\n\t\r\n\tОповестить(ИмяСобытия, Параметр, Источник);\r\n\t\r\nКонецПроцедуры\n\n// Команда формы для вызова\r\n&НаКлиенте\r\nПроцедура ИзобразитьСканерШК(Команда)\r\n\t\r\n\tИзобразитьСканерШКДанныеВОсновных(\"68331545384715610814882357176103939876\");\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ИзобразитьСканерШКДанныеВОсновных(Данные)\r\n\t\r\n\tИмяСобытия = \"ScanData\";\r\n\tИсточник = \"ПодключаемоеОборудование\";\r\n\tПараметр = Новый Массив;\r\n\tПараметр.Добавить(Данные);\r\n\tПараметр.Добавить(Неопределено);\r\n\t\r\n\tглПодключаемоеОборудованиеСобытиеОбработано = Ложь;\r\n\t\r\n\tОповестить(ИмяСобытия, Параметр, Источник);\r\n\t\r\nКонецПроцедуры\n\n{18} Переменной глПодключаемоеОборудованиеСобытиеОбработано присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Обновлятор-1С: групповое (пакетное) обновление и обслуживание всех баз за один разНаш выбор",
    "description": "Быстрое и надежное обновление файловых и серверных баз, защита от шифровальщиков, автоматическое обновление доработанных конфигураций  и расширений, а также многое другое.",
    "code_snippet": ""
  },
  {
    "title": "ИР Найти использование",
    "description": "ИР Найти использованиеTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"В табло\" в окне \"Выражение\"",
    "description": "ИР Кнопка \"В табло\" в окне \"Выражение\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Перейти в последние методы",
    "description": "ИР Перейти в последние методыTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Найти следующий (выделенный)",
    "description": "ИР Найти следующий (выделенный)TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Создание команды",
    "description": "Создание команды",
    "code_snippet": "//Создание команды\r\n\tНоваяКоманда = ЭтаФорма.Команды.Добавить(\"ОбщаяКоманда\");\r\n\tНоваяКоманда.Заголовок = \"Общая команда\";\r\n\tНоваяКоманда.Действие = \"ОбщееДействие\"; //указываем имя процедуры\n\n//Создание команды\r\n\tНоваяКоманда = ЭтаФорма.Команды.Добавить(\"ОбщаяКоманда\");\r\n\tНоваяКоманда.Заголовок = \"Общая команда\";\r\n\tНоваяКоманда.Действие = \"ОбщееДействие\"; //указываем имя процедуры"
  },
  {
    "title": "Создание декорации картинки",
    "description": "Создание декорации картинки",
    "code_snippet": "НовыйЭлемент = ЭтаФорма.Элементы.Добавить(\"КартинкаТовара\", Тип(\"ДекорацияФормы\"),СтраницаТовары);\r\n\tНовыйЭлемент.Вид = ВидДекорацииФормы.Картинка;\r\n\tНовыйЭлемент.Картинка = БиблиотекаКартинок.ГеографическаяСхема;\r\n\tНовыйЭлемент.РазмерКартинки = РазмерКартинки.Растянуть;\r\n\tНовыйЭлемент.Ширина = 20;\r\n\tНовыйЭлемент.Высота = 8;\n\nНовыйЭлемент = ЭтаФорма.Элементы.Добавить(\"КартинкаТовара\", Тип(\"ДекорацияФормы\"),СтраницаТовары);\r\n\tНовыйЭлемент.Вид = ВидДекорацииФормы.Картинка;\r\n\tНовыйЭлемент.Картинка = БиблиотекаКартинок.ГеографическаяСхема;\r\n\tНовыйЭлемент.РазмерКартинки = РазмерКартинки.Растянуть;\r\n\tНовыйЭлемент.Ширина = 20;\r\n\tНовыйЭлемент.Высота = 8;"
  },
  {
    "title": "Создание декорации надпись",
    "description": "Создание декорации надпись",
    "code_snippet": "НовыйЭлемент = ЭтаФорма.Элементы.Добавить(\"ИмяДекорации\", Тип(\"ДекорацияФормы\"),СтраницаТовары);\r\n\tНовыйЭлемент.Вид = ВидДекорацииФормы.Надпись;\r\n\tНовыйЭлемент.Заголовок = \"ЗаголовокДляОтображения\";\n\nНовыйЭлемент = ЭтаФорма.Элементы.Добавить(\"ИмяДекорации\", Тип(\"ДекорацияФормы\"),СтраницаТовары);\r\n\tНовыйЭлемент.Вид = ВидДекорацииФормы.Надпись;\r\n\tНовыйЭлемент.Заголовок = \"ЗаголовокДляОтображения\";"
  },
  {
    "title": "Создать группу формы",
    "description": "Создать группу формы",
    "code_snippet": "//Группы\r\n\t\r\n\t//Пример создания обычной группы без отображения\r\n\tГруппаДатаНомер = ЭтаФорма.Элементы.Добавить(\"ГруппаОбычная\", Тип(\"ГруппаФормы\"),ЭтаФорма);\r\n\tГруппаДатаНомер.Вид = ВидГруппыФормы.ОбычнаяГруппа;\r\n\tГруппаДатаНомер.Отображение = ОтображениеОбычнойГруппы.Нет;\r\n\tГруппаДатаНомер.ОтображатьЗаголовок = ЛОЖЬ; \r\n\tГруппаДатаНомер.Группировка = ГруппировкаПодчиненныхЭлементовФормы.ГоризонтальнаяВсегда;\r\n\t\r\n\t//Пример создания обычной группы\r\n\tГруппаШапка = ЭтаФорма.Элементы.Добавить(\"ГруппаШапка\", Тип(\"ГруппаФормы\"),ЭтаФорма);\r\n\tГруппаШапка.Вид = ВидГруппыФормы.ОбычнаяГруппа;\r\n\tГруппаШапка.Заголовок = \"Основные реквизиты\";\r\n\tГруппаШапка.Отображение = ОтображениеОбычнойГруппы.ОбычноеВыделение;\r\n\tГруппаШапка.ОтображатьЗаголовок = ИСТИНА; \r\n\tГруппаШапка.Группировка = ГруппировкаПодчиненныхЭлементовФормы.Вертикальная;\r\n\tГруппаШапка.РастягиватьПоГоризонтали = ИСТИНА;\r\n\t\r\n\t//Пример создания группы страниц\r\n\tГруппаСтраниц = ЭтаФорма.Элементы.Добавить(\"ГруппаСтраницы\", Тип(\"ГруппаФормы\"),ЭтаФорма);\r\n\tГруппаСтраниц.Вид = ВидГруппыФормы.Страницы;\r\n\tГруппаСтраниц.ОтображениеСтраниц = ОтображениеСтраницФормы.ЗакладкиСверху;\r\n\tГруппаСтраниц.РастягиватьПоГоризонтали = ИСТИНА;\r\n\t\r\n\t//Пример создания страниц\r\n\t\r\n\tСтраницаТовары = ЭтаФорма.Элементы.Добавить(\"СтраницаТовары\", Тип(\"ГруппаФормы\"),ГруппаСтраниц);\r\n\tСтраницаТовары.Вид = ВидГруппыФормы.Страница;\r\n\tСтраницаТовары.Заголовок = \"Товары\";\r\n\t\r\n\tСтраницаДополнительно = ЭтаФорма.Элементы.Добавить(\"СтраницаДополнительно\", Тип(\"ГруппаФормы\"),ГруппаСтраниц);\r\n\tСтраницаДополнительно.Вид = ВидГруппыФормы.Страница;\r\n\tСтраницаДополнительно.Заголовок = \"Дополнительно\";\n\n//Группы\r\n\t\r\n\t//Пример создания обычной группы без отображения\r\n\tГруппаДатаНомер = ЭтаФорма.Элементы.Добавить(\"ГруппаОбычная\", Тип(\"ГруппаФормы\"),ЭтаФорма);\r\n\tГруппаДатаНомер.Вид = ВидГруппыФормы.ОбычнаяГруппа;\r\n\tГруппаДатаНомер.Отображение = ОтображениеОбычнойГруппы.Нет;\r\n\tГруппаДатаНомер.ОтображатьЗаголовок = ЛОЖЬ; \r\n\tГруппаДатаНомер.Группировка = ГруппировкаПодчиненныхЭлементовФормы.ГоризонтальнаяВсегда;\r\n\t\r\n\t//Пример создания обычной группы\r\n\tГруппаШапка = ЭтаФорма.Элементы.Добавить(\"ГруппаШапка\", Тип(\"ГруппаФормы\"),ЭтаФорма);\r\n\tГруппаШапка.Вид = ВидГруппыФормы.ОбычнаяГруппа;\r\n\tГруппаШапка.Заголовок = \"Основные реквизиты\";\r\n\tГруппаШапка.Отображение = ОтображениеОбычнойГруппы.ОбычноеВыделение;\r\n\tГруппаШапка.ОтображатьЗаголовок = ИСТИНА; \r\n\tГруппаШапка.Группировка = ГруппировкаПодчиненныхЭлементовФормы.Вертикальная;\r\n\tГруппаШапка.РастягиватьПоГоризонтали = ИСТИНА;\r\n\t\r\n\t//Пример создания группы страниц\r\n\tГруппаСтраниц = ЭтаФорма.Элементы.Добавить(\"ГруппаСтраницы\", Тип(\"ГруппаФормы\"),ЭтаФорма);\r\n\tГруппаСтраниц.Вид = ВидГруппыФормы.Страницы;\r\n\tГруппаСтраниц.ОтображениеСтраниц = ОтображениеСтраницФормы.ЗакладкиСверху;\r\n\tГруппаСтраниц.РастягиватьПоГоризонтали = ИСТИНА;\r\n\t\r\n\t//Пример создания страниц\r\n\t\r\n\tСтраницаТовары = ЭтаФорма.Элементы.Добавить(\"СтраницаТовары\", Тип(\"ГруппаФормы\"),ГруппаСтраниц);\r\n\tСтраницаТовары.Вид = ВидГруппыФормы.Страница;\r\n\tСтраницаТовары.Заголовок = \"Товары\";\r\n\t\r\n\tСтраницаДополнительно = ЭтаФорма.Элементы.Добавить(\"СтраницаДополнительно\", Тип(\"ГруппаФормы\"),ГруппаСтраниц);\r\n\tСтраницаДополнительно.Вид = ВидГруппыФормы.Страница;\r\n\tСтраницаДополнительно.Заголовок = \"Дополнительно\";"
  },
  {
    "title": "Программно создать новый реквизит",
    "description": "Программно создать новый реквизит",
    "code_snippet": "ДобавляемыеРеквизиты = Новый Массив; //Определяем массив добавляемых реквизитов\r\n\r\nРеквизитКомментарий = Новый РеквизитФормы(\"Комментарий\",Новый ОписаниеТипов(\"Строка\",,Новый КвалификаторыСтроки(500))); \r\nДобавляемыеРеквизиты.Добавить(РеквизитКомментарий ); \r\nНомерРеквизит = Новый РеквизитФормы(\"Номер\",Новый ОписаниеТипов(\"Число\",Новый КвалификаторыЧисла(10,0))); \r\nДобавляемыеРеквизиты.Добавить(НомерРеквизит);\r\nДатаРеквизит = Новый РеквизитФормы(\"Дата\",Новый ОписаниеТипов(\"Дата\",,,Новый КвалификаторыДаты(ЧастиДаты.ДатаВремя))); \r\nДобавляемыеРеквизиты.Добавить(ДатаРеквизит);\r\nНаименованиеРеквизит = Новый РеквизитФормы(\"Наименование\",Новый ОписаниеТипов(\"Строка\",,Новый КвалификаторыСтроки(150))); \r\nДобавляемыеРеквизиты.Добавить(НаименованиеРеквизит);\r\n\r\nЭтаФорма.ИзменитьРеквизиты(ДобавляемыеРеквизиты); //Применяем реквизиты\n\nДобавляемыеРеквизиты = Новый Массив; //Определяем массив добавляемых реквизитов\r\n\r\nРеквизитКомментарий = Новый РеквизитФормы(\"Комментарий\",Новый ОписаниеТипов(\"Строка\",,Новый КвалификаторыСтроки(500))); \r\nДобавляемыеРеквизиты.Добавить(РеквизитКомментарий ); \r\nНомерРеквизит = Новый РеквизитФормы(\"Номер\",Новый ОписаниеТипов(\"Число\",Новый КвалификаторыЧисла(10,0))); \r\nДобавляемыеРеквизиты.Добавить(НомерРеквизит);\r\nДатаРеквизит = Новый РеквизитФормы(\"Дата\",Новый ОписаниеТипов(\"Дата\",,,Новый КвалификаторыДаты(ЧастиДаты.ДатаВремя))); \r\nДобавляемыеРеквизиты.Добавить(ДатаРеквизит);\r\nНаименованиеРеквизит = Новый РеквизитФормы(\"Наименование\",Новый ОписаниеТипов(\"Строка\",,Новый КвалификаторыСтроки(150))); \r\nДобавляемыеРеквизиты.Добавить(НаименованиеРеквизит);\r\n\r\nЭтаФорма.ИзменитьРеквизиты(ДобавляемыеРеквизиты); //Применяем реквизиты"
  },
  {
    "title": "Загрузка данных копипастом",
    "description": "Загрузка данных копипастом",
    "code_snippet": "Построитель = Новый ПостроительЗапроса;\r\nПостроитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабДок.Область());  \t\r\n\t\r\nТабДанные = Построитель.Результат.Выгрузить();\n\nПостроитель = Новый ПостроительЗапроса;\r\nПостроитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабДок.Область());  \t\r\n\t\r\nТабДанные = Построитель.Результат.Выгрузить();\n\n{4} Переменной ТабДанные присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в копипастом: копипастом\r\nОрфографическая ошибка в скопипастить: скопипастить"
  },
  {
    "title": "Отбор при начале выбора Групп и элементов (УФ)",
    "description": "Отбор при начале выбора Групп и элементов (УФ)",
    "code_snippet": "Процедура ОсновнаяТЗГруппаЦенНачалоВыбора(Элемент, ДанныеВыбора, ВыборДобавлением, СтандартнаяОбработка)\r\n\tСтандартнаяОбработка = Ложь;\r\n\tПараметрыФормы = Новый Структура;\r\n    ПараметрыФормы.Вставить(\"РежимВыбора\",Истина);\r\n    ПараметрыФормы.Вставить(\"МножественныйВыбор\",Ложь);\r\n    ПараметрыФормы.Вставить(\"ЗакрыватьПриВыборе\",Истина);\r\n    ПараметрыФормы.Вставить(\"ВыборГруппИЭлементов\",ИспользованиеГруппИЭлементов.Группы);\r\n\t\r\n\tОО = Новый ОписаниеОповещения(\"ПослеВыбораГруппыСкидок\",ЭтаФорма);\r\n\t\r\n    ОткрытьФорму(\"Справочник.СкидкиНаценки.ФормаВыбораГруппы\",ПараметрыФормы,ЭтаФорма,,,,ОО);\r\nКонецПроцедуры\n\nПроцедура ОсновнаяТЗГруппаЦенНачалоВыбора(Элемент, ДанныеВыбора, ВыборДобавлением, СтандартнаяОбработка)\r\n\tСтандартнаяОбработка = Ложь;\r\n\tПараметрыФормы = Новый Структура;\r\n    ПараметрыФормы.Вставить(\"РежимВыбора\",Истина);\r\n    ПараметрыФормы.Вставить(\"МножественныйВыбор\",Ложь);\r\n    ПараметрыФормы.Вставить(\"ЗакрыватьПриВыборе\",Истина);\r\n    ПараметрыФормы.Вставить(\"ВыборГруппИЭлементов\",ИспользованиеГруппИЭлементов.Группы);\r\n\t\r\n\tОО = Новый ОписаниеОповещения(\"ПослеВыбораГруппыСкидок\",ЭтаФорма);\r\n\t\r\n    ОткрытьФорму(\"Справочник.СкидкиНаценки.ФормаВыбораГруппы\",ПараметрыФормы,ЭтаФорма,,,,ОО);\r\nКонецПроцедуры"
  },
  {
    "title": "Получение данных из буфера обмена",
    "description": "Получение данных из буфера обмена",
    "code_snippet": "Функция ПолучениеДанныхИзБуфера()\r\nТекстДанных = “”;\r\nОбъектВставки = Новый ComОбъект(“HTMLFILE”);\r\nТекстДанных = ОбъектВставки.ParentWindow.ClipboardData.GetData(“Text”);\r\nВозврат ТекстДанных;\r\nКонецФункции\n\nФункция ПолучениеДанныхИзБуфера()\r\nТекстДанных = “”;\r\nОбъектВставки = Новый ComОбъект(“HTMLFILE”);\r\nТекстДанных = ОбъектВставки.ParentWindow.ClipboardData.GetData(“Text”);\r\nВозврат ТекстДанных;\r\nКонецФункции\n\n{2}Неопознанный оператор\r\n\tТекстДанных = “”;"
  },
  {
    "title": "Схема компоновки данных из запроса",
    "description": "Схема компоновки данных из запроса",
    "code_snippet": "// Схема компоновки данных из запроса.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/160\r\n// \r\n// Параметры:\r\n//  ТекстЗапроса - Строка\r\n//  ПараметрыЗапроса - Структура\r\n// \r\n// Возвращаемое значение:\r\n//  СхемаКомпоновкиДанных\r\n//\r\n// Пример:\r\n//  СКД = СхемаКомпоновкиДанныхИзЗапроса(\"ВЫБРАТЬ * ИЗ Справочник.Валюты\");\r\n//\r\nФункция СхемаКомпоновкиДанныхИзЗапроса(ТекстЗапроса, ПараметрыЗапроса = Неопределено) Экспорт\r\n\t\r\n\tСхемаКомпоновкиДанных = Новый СхемаКомпоновкиДанных();\r\n\t\r\n\tИсточникДанных = СхемаКомпоновкиДанных.ИсточникиДанных.Добавить();\r\n\tИсточникДанных.Имя = \"ЛокальнаяБаза\";\r\n\tИсточникДанных.СтрокаСоединения = \"\";\r\n\tИсточникДанных.ТипИсточникаДанных = \"Local\";\r\n\t\r\n\tНаборДанных = СхемаКомпоновкиДанных.НаборыДанных.Добавить(Тип(\"НаборДанныхЗапросСхемыКомпоновкиДанных\"));\r\n\tНаборДанных.АвтоЗаполнениеДоступныхПолей = Истина;\r\n\tНаборДанных.Запрос = ТекстЗапроса;\r\n\tНаборДанных.Имя = \"Запрос\";\r\n\tНаборДанных.ИсточникДанных = ИсточникДанных.Имя;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ПараметрыЗапроса) Тогда\r\n\t\tДля Каждого КлючИЗначение Из ПараметрыЗапроса Цикл\r\n\t\t\tПараметрЗапроса = СхемаКомпоновкиДанных.Параметры.Добавить();\r\n\t\t\tПараметрЗапроса.Имя = КлючИЗначение.Ключ;\r\n\t\t\tПараметрЗапроса.Значение = КлючИЗначение.Значение;\r\n\t\t\tПараметрЗапроса.ОграничениеИспользования = Истина;\r\n\t\t\tПараметрЗапроса.Использование = ИспользованиеПараметраКомпоновкиДанных.Всегда;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\tКомпоновщикНастроек = Новый КомпоновщикНастроекКомпоновкиДанных();\r\n\tКомпоновщикНастроек.Инициализировать(Новый ИсточникДоступныхНастроекКомпоновкиДанных(СхемаКомпоновкиДанных));\r\n    \r\n    КоллекцияВыбранныхПолей = СхемаКомпоновкиДанных.НастройкиПоУмолчанию.Выбор.Элементы;\r\n\tДля Каждого ДоступноеПоле Из КомпоновщикНастроек.Настройки.ДоступныеПоляВыбора.Элементы Цикл\r\n\t\tЕсли НЕ ДоступноеПоле.Папка Тогда\r\n\t\t\tВыбранноеПоле = КоллекцияВыбранныхПолей.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\t\tЗаполнитьЗначенияСвойств(ВыбранноеПоле, ДоступноеПоле, \"Поле,Заголовок\");\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого Параметр Из КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы Цикл\r\n\t\tИмяПараметра = Строка(Параметр.Параметр);\r\n\t\tЕсли СхемаКомпоновкиДанных.Параметры.Найти(ИмяПараметра) = Неопределено Тогда\r\n\t\t\tПараметрСКД = СхемаКомпоновкиДанных.Параметры.Добавить();\r\n\t\t\tПараметрСКД.Имя = ИмяПараметра;\r\n\t\t\tПараметрСКД.Использование = ИспользованиеПараметраКомпоновкиДанных.Авто;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДетальныеЗаписи = СхемаКомпоновкиДанных.НастройкиПоУмолчанию.Структура.Добавить(Тип(\"ГруппировкаКомпоновкиДанных\"));\r\n\tДетальныеЗаписи.Выбор.Элементы.Добавить(Тип(\"АвтоВыбранноеПолеКомпоновкиДанных\"));\r\n\t\r\n\tВозврат СхемаКомпоновкиДанных;\r\n\t\r\nКонецФункции\n\n// Схема компоновки данных из запроса.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/160\r\n// \r\n// Параметры:\r\n//  ТекстЗапроса - Строка\r\n//  ПараметрыЗапроса - Структура\r\n// \r\n// Возвращаемое значение:\r\n//  СхемаКомпоновкиДанных\r\n//\r\n// Пример:\r\n//  СКД = СхемаКомпоновкиДанныхИзЗапроса(\"ВЫБРАТЬ * ИЗ Справочник.Валюты\");\r\n//\r\nФункция СхемаКомпоновкиДанныхИзЗапроса(ТекстЗапроса, ПараметрыЗапроса = Неопределено) Экспорт\r\n\t\r\n\tСхемаКомпоновкиДанных = Новый СхемаКомпоновкиДанных();\r\n\t\r\n\tИсточникДанных = СхемаКомпоновкиДанных.ИсточникиДанных.Добавить();\r\n\tИсточникДанных.Имя = \"ЛокальнаяБаза\";\r\n\tИсточникДанных.СтрокаСоединения = \"\";\r\n\tИсточникДанных.ТипИсточникаДанных = \"Local\";\r\n\t\r\n\tНаборДанных = СхемаКомпоновкиДанных.НаборыДанных.Добавить(Тип(\"НаборДанныхЗапросСхемыКомпоновкиДанных\"));\r\n\tНаборДанных.АвтоЗаполнениеДоступныхПолей = Истина;\r\n\tНаборДанных.Запрос = ТекстЗапроса;\r\n\tНаборДанных.Имя = \"Запрос\";\r\n\tНаборДанных.ИсточникДанных = ИсточникДанных.Имя;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ПараметрыЗапроса) Тогда\r\n\t\tДля Каждого КлючИЗначение Из ПараметрыЗапроса Цикл\r\n\t\t\tПараметрЗапроса = СхемаКомпоновкиДанных.Параметры.Добавить();\r\n\t\t\tПараметрЗапроса.Имя = КлючИЗначение.Ключ;\r\n\t\t\tПараметрЗапроса.Значение = КлючИЗначение.Значение;\r\n\t\t\tПараметрЗапроса.ОграничениеИспользования = Истина;\r\n\t\t\tПараметрЗапроса.Использование = ИспользованиеПараметраКомпоновкиДанных.Всегда;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\tКомпоновщикНастроек = Новый КомпоновщикНастроекКомпоновкиДанных();\r\n\tКомпоновщикНастроек.Инициализировать(Новый ИсточникДоступныхНастроекКомпоновкиДанных(СхемаКомпоновкиДанных));\r\n    \r\n    КоллекцияВыбранныхПолей = СхемаКомпоновкиДанных.НастройкиПоУмолчанию.Выбор.Элементы;\r\n\tДля Каждого ДоступноеПоле Из КомпоновщикНастроек.Настройки.ДоступныеПоляВыбора.Элементы Цикл\r\n\t\tЕсли НЕ ДоступноеПоле.Папка Тогда\r\n\t\t\tВыбранноеПоле = КоллекцияВыбранныхПолей.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\t\tЗаполнитьЗначенияСвойств(ВыбранноеПоле, ДоступноеПоле, \"Поле,Заголовок\");\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого Параметр Из КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы Цикл\r\n\t\tИмяПараметра = Строка(Параметр.Параметр);\r\n\t\tЕсли СхемаКомпоновкиДанных.Параметры.Найти(ИмяПараметра) = Неопределено Тогда\r\n\t\t\tПараметрСКД = СхемаКомпоновкиДанных.Параметры.Добавить();\r\n\t\t\tПараметрСКД.Имя = ИмяПараметра;\r\n\t\t\tПараметрСКД.Использование = ИспользованиеПараметраКомпоновкиДанных.Авто;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДетальныеЗаписи = СхемаКомпоновкиДанных.НастройкиПоУмолчанию.Структура.Добавить(Тип(\"ГруппировкаКомпоновкиДанных\"));\r\n\tДетальныеЗаписи.Выбор.Элементы.Добавить(Тип(\"АвтоВыбранноеПолеКомпоновкиДанных\"));\r\n\t\r\n\tВозврат СхемаКомпоновкиДанных;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Шаблон внешней печатной формы на БСП с назначением",
    "description": "Шаблон внешней печатной формы на БСП с назначением",
    "code_snippet": "#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда\n\n#Область ПрограммныйИнтерфейс  \n\nФункция СведенияОВнешнейОбработке() Экспорт\n    \n    ПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(\"3.1.9.144\"); \n    ПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиПечатнаяФорма();\n    ПараметрыРегистрации.Версия = \"1.1.1.1\"; \n    \n    ПараметрыРегистрации.Назначение.Добавить(\"Документ.СчетНаОплатуПокупателю\"); \n\n    НоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\n    НоваяКоманда.Представление = НСтр(\"ru = 'Договор (внешняя печатная форма)'\");\n    НоваяКоманда.Идентификатор = \"ДоговорСПокупателем\";\n    НоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\n    НоваяКоманда.Модификатор = \"ПечатьMXL\";\n    Возврат ПараметрыРегистрации;\n    \nКонецФункции \n\n#КонецОбласти\n\n#Область СлужебныйПрограммныйИнтерфейс \n\nПроцедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\n    \n    ПечатнаяФорма = УправлениеПечатью.СведенияОПечатнойФорме(КоллекцияПечатныхФорм, \"ДоговорСПокупателем\");\n    Если ПечатнаяФорма <> Неопределено Тогда\n        ПечатнаяФорма.ТабличныйДокумент = СформироватьДоговорСПокупателем(МассивОбъектов, ОбъектыПечати);\n        ПечатнаяФорма.СинонимМакета = НСтр(\"ru = 'Договор (внешняя печатная форма)'\");\n    КонецЕсли;\n    \nКонецПроцедуры \n\n#КонецОбласти\n\n#Область СлужебныеПроцедурыИФункции\n\nФункция СформироватьДоговорСПокупателем(МассивОбъектов, ОбъектыПечати) \n\t\n\tУстановитьПривилегированныйРежим(Истина); \n\t\n\tТабличныйДокумент = Новый ТабличныйДокумент;\n\tТабличныйДокумент.АвтоМасштаб = Истина;\n\tТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;\n\tТабличныйДокумент.КлючПараметровПечати = \"ПАРАМЕТРЫ_ПЕЧАТИ_ДоговорСПокупателем\"; \n\t\n\tМакет = ПолучитьМакет(\"ПФ_MXL_ДоговорСПокупателем\");\n\t\n\tЗапрос = Новый Запрос();\n\tЗапрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\n\t\n\tЗапрос.УстановитьПараметр(\"МассивОбъектов\",  МассивОбъектов);\n\t\n\tЗапрос.Текст = ТекстЗапросаДляПечати();\t\n\tРезультат = Запрос.ВыполнитьПакет();\n\tШапка = Результат[0].Выбрать();\n\t\n\tПервыйДокумент = Истина;\n\t\n\tПока Шапка.Следующий() Цикл\n\t\t\n\t\tЕсли НЕ ПервыйДокумент Тогда\n\t\t\tТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();\n\t\tКонецЕсли;\n\t\t\n\t\tПервыйДокумент    = Ложь;\n\t\t// Запомним номер строки, с которой начали выводить текущий документ.\n\t\tНомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;\n\t\t\n\t\tСтруктураПараметров = ПараметрыОбластей(Шапка);\t\n\t\t\n\t\tОбластьШапка = Макет.ПолучитьОбласть(\"Шапка\");\n\t\tОбластьШапка.Параметры.Заполнить(СтруктураПараметров);\n\t\tТабличныйДокумент.Вывести(ОбластьШапка); \t\n\t\t\n\t\tВывестиСтрокиДокумента(ТабличныйДокумент, Макет, Шапка.Ссылка, Результат[1].Выбрать());\n\t\t\n\t\tОбластьШапка = Макет.ПолучитьОбласть(\"Подвал\");\n\t\tОбластьШапка.Параметры.Заполнить(СтруктураПараметров);\n\t\tТабличныйДокумент.Вывести(ОбластьШапка);\n\t\t\t\t\n\t\t// В табличном документе зададим имя области, в которую был\n\t\t// выведен объект. Нужно для возможности печати по-комплектно \n\t\tУправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент,\n\t\t\tНомерСтрокиНачало, ОбъектыПечати, Шапка.Ссылка);\n\t\t\n\tКонецЦикла;\n\n\tВозврат ТабличныйДокумент; \n\t\nКонецФункции\n\n#КонецОбласти   \n\n#Иначе\nВызватьИсключение НСтр(\"ru = 'Недопустимый вызов объекта на клиенте.'\");\n#КонецЕсли"
  },
  {
    "title": "Это ошибка существования метода.",
    "description": "Это ошибка существования метода.",
    "code_snippet": "// Это ошибка существования метода.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/158\r\n// \r\n// Параметры:\r\n//  ИнформацияОбОшибке - ИнформацияОбОшибке \r\n//  ИмяМетода - Строка\r\n//  ПроверятьНаНеобъектныйТип - Булево - Если Истина, то ошибка \"Значение не является объектного типа\" тоже считается за ошибку отстуствия типа \r\n// \r\n// Возвращаемое значение:\r\n//  Булево\r\n//\r\n// Пример:\r\n// \r\n//  Попытка\r\n//      Объект.НеобязательныйМетод();\r\n//  Исключение\r\n//      Если НЕ ЭтоОшибкаСуществованияМетода(ИнформацияОбОшибке(), \"НеобязательныйМетод\") Тогда\r\n//          ВызватьИсключение;\r\n//      КонецЕсли;\r\n//  КонецПопытки;\r\n//\r\nФункция ЭтоОшибкаСуществованияМетода(ИнформацияОбОшибке, \r\n\tИмяМетода, ПроверятьНаНеобъектныйТип = Истина) Экспорт\r\n\t\r\n\tОписаниеОшибки = ИнформацияОбОшибке.Описание;\r\n\t\r\n\tВременныеОбъекты = Новый Массив; //Массив из Неопределено\r\n\tВременныеОбъекты.Добавить(Новый Структура);\r\n\t\r\n\tЕсли ПроверятьНаНеобъектныйТип Тогда\r\n\t\tВременныеОбъекты.Добавить();\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого ВременныйОбъект Из ВременныеОбъекты Цикл\r\n\t\t\r\n\t\tПопытка\r\n\t\t\tВременныйОбъект.СуперПуперМетод(); //@skip-check dynamic-access-method-not-found\r\n\t\tИсключение\r\n\t\t\tВременноеОписание = СтрЗаменить(ИнформацияОбОшибке().Описание, \"СуперПуперМетод\", ИмяМетода);\r\n\t\t\tЕсли ОписаниеОшибки = ВременноеОписание Тогда\r\n\t\t\t\tВозврат Истина;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецПопытки;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Ложь;\r\n\t\r\nКонецФункции\n\n// Это ошибка существования метода.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/158\r\n// \r\n// Параметры:\r\n//  ИнформацияОбОшибке - ИнформацияОбОшибке \r\n//  ИмяМетода - Строка\r\n//  ПроверятьНаНеобъектныйТип - Булево - Если Истина, то ошибка \"Значение не является объектного типа\" тоже считается за ошибку отстуствия типа \r\n// \r\n// Возвращаемое значение:\r\n//  Булево\r\n//\r\n// Пример:\r\n// \r\n//  Попытка\r\n//      Объект.НеобязательныйМетод();\r\n//  Исключение\r\n//      Если НЕ ЭтоОшибкаСуществованияМетода(ИнформацияОбОшибке(), \"НеобязательныйМетод\") Тогда\r\n//          ВызватьИсключение;\r\n//      КонецЕсли;\r\n//  КонецПопытки;\r\n//\r\nФункция ЭтоОшибкаСуществованияМетода(ИнформацияОбОшибке, \r\n\tИмяМетода, ПроверятьНаНеобъектныйТип = Истина) Экспорт\r\n\t\r\n\tОписаниеОшибки = ИнформацияОбОшибке.Описание;\r\n\t\r\n\tВременныеОбъекты = Новый Массив; //Массив из Неопределено\r\n\tВременныеОбъекты.Добавить(Новый Структура);\r\n\t\r\n\tЕсли ПроверятьНаНеобъектныйТип Тогда\r\n\t\tВременныеОбъекты.Добавить();\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого ВременныйОбъект Из ВременныеОбъекты Цикл\r\n\t\t\r\n\t\tПопытка\r\n\t\t\tВременныйОбъект.СуперПуперМетод(); //@skip-check dynamic-access-method-not-found\r\n\t\tИсключение\r\n\t\t\tВременноеОписание = СтрЗаменить(ИнформацияОбОшибке().Описание, \"СуперПуперМетод\", ИмяМетода);\r\n\t\t\tЕсли ОписаниеОшибки = ВременноеОписание Тогда\r\n\t\t\t\tВозврат Истина;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецПопытки;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Ложь;\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в отстуствия: отстуствия"
  },
  {
    "title": "Определние ПустаяСсылка в Запросе",
    "description": "Определние ПустаяСсылка в Запросе",
    "code_snippet": "//\tВидМаркированнойПродукции = Перечисление.ВидыМаркируемойПродукции\r\n//      Выбираем элементы справочника Номенклатура \r\n//      Где заполнен реквизит \"ВидМаркированнойПродукции\"\r\n\r\nЗапрос = Новый Запрос;\r\n\t\r\n\tТекстЗапроса = \"\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tСпр.Ссылка,\r\n\t\t|\tСпр.ВидМаркированнойПродукции\t\t\r\n\t\t|ИЗ\r\n\t\t|\tСправочник.Номенклатура КАК Спр\r\n\t\t|\t\r\n\t\t|ГДЕ \r\n\t\t|\tНЕ Спр.ВидМаркированнойПродукции.ССылка is NULL\r\n\t\t|\";\r\n\t\r\n\tЗапрос.Текст = ТекстЗапроса;\r\n\t\r\n\tВыборка = Запрос.Выполнить().Выбрать();\n\n//\tВидМаркированнойПродукции = Перечисление.ВидыМаркируемойПродукции\r\n//      Выбираем элементы справочника Номенклатура \r\n//      Где заполнен реквизит \"ВидМаркированнойПродукции\"\r\n\r\nЗапрос = Новый Запрос;\r\n\t\r\n\tТекстЗапроса = \"\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tСпр.Ссылка,\r\n\t\t|\tСпр.ВидМаркированнойПродукции\t\t\r\n\t\t|ИЗ\r\n\t\t|\tСправочник.Номенклатура КАК Спр\r\n\t\t|\t\r\n\t\t|ГДЕ \r\n\t\t|\tНЕ Спр.ВидМаркированнойПродукции.ССылка is NULL\r\n\t\t|\";\r\n\t\r\n\tЗапрос.Текст = ТекстЗапроса;\r\n\t\r\n\tВыборка = Запрос.Выполнить().Выбрать();\n\n{20} Переменной Выборка присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в Определние: Определние\r\nОрфографическая ошибка в ССылка: Сылка"
  },
  {
    "title": "Меню обработки дополнительной расшифровки в табличном документе (не СКД)",
    "description": "Меню обработки дополнительной расшифровки в табличном документе (не СКД)",
    "code_snippet": "#Область ОбработчикиСобытийФормы  \n\n// В этой процедуре выводим макет и указываем расшифровку для строки\n&НаСервере\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\n\t\n\tОбъектОбработки = РеквизитФормыВЗначение(\"Объект\");\n\tМакетДок = ОбъектОбработки.ПолучитьМакет(\"Макет\");\n\t\n\tОбластьШапка = МакетДок.ПолучитьОбласть(\"Шапка\");\n\tТабДок.Вывести(ОбластьШапка);\n\t\n\tСотрудники = Справочники.Пользователи.Выбрать();\n\tПока Сотрудники.Следующий() Цикл\n\t\tОбластьДанные = МакетДок.ПолучитьОбласть(\"Данные\");\t\n\t\tОбластьДанные.Параметры.Сотрудник = Сотрудники.Ссылка; \n\t\t// В качестве расшифровки можно передать необходимые данные\n\t\t// для примера я передаю ссылку\n\t\tОбластьДанные.Параметры.СотрудникРасшифровка = Сотрудники.Ссылка;\n\t\tТабДок.Вывести(ОбластьДанные);\n\tКонецЦикла;\n\t\nКонецПроцедуры \n\n#КонецОбласти\n\n#Область ОбработчикиСобытийЭлементовТабличногоДокумента   \n\n// Сюда мы попадаем при двойном клике левой кнопки мыши\n&НаКлиенте\nПроцедура ТабДокОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка, ДополнительныеПараметры)  \n\tСтандартнаяОбработка = Ложь; \n\t// Далее код обработки расшифровки, значение которой находится в переменной Расшифровка\nКонецПроцедуры  \n\n// Сюда попадаем при клике правой кнопки мыши (контекстное меню)\n&НаКлиенте\nПроцедура ТабДокОбработкаДополнительнойРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка, ДополнительныеПараметры)\n\t\n\tСтандартнаяОбработка = Ложь;    \n\t\n\t// Создаем список действий для контекстного меню\n\tДействия_ = Новый СписокЗначений;\n\tДействия_.Добавить(\"Открыть\", , , БиблиотекаКартинок.ОткрытьФайл); \n\tДействия_.Добавить(\"Добавить\", , , БиблиотекаКартинок.ДобавитьЭлементСписка); \n\tДействия_.Добавить(\"Удалить\", , , БиблиотекаКартинок.УдалитьЭлементСписка);\n\t\n\tОписаниеОповещенияОЗакрытии = Новый ОписаниеОповещения(\"ОписаниеОповещенияОЗакрытии\", ЭтотОбъект, Расшифровка);\n\t\n\tПоказатьВыборИзМеню(ОписаниеОповещенияОЗакрытии, Действия_, Элемент);\n\t\nКонецПроцедуры \n\n#КонецОбласти\n\n#Область СлужебныеПроцедурыИФункции  \n\n&НаКлиенте\nПроцедура ОписаниеОповещенияОЗакрытии(ВыбранныйЭлемент, ДополнительныеПараметры) Экспорт   \n\n\t// ВыбранныйЭлемент примет значение списка значений\n\t// Открыть, Добавить, Удалить, которые мы задали ранее\n\t// или Неопределено в случае отказа от выбора   \n\t\n\t// ДополнительныеПараметры сюда выше переданы данные расшифровки\n\t\nКонецПроцедуры\n\n#КонецОбласти"
  },
  {
    "title": "Свернуть таблицу значений на клиенте (ДанныеФормыЗначение)",
    "description": "Свернуть таблицу значений на клиенте (ДанныеФормыЗначение)",
    "code_snippet": "// Сворачивает ДанныеФормыКоллекция по указанным колонкам группировки. Элементы коллекции, указанной в первом параметре,\n// у которых совпадают значения в колонках, указанных во втором параметре, сворачиваются в один элемент. Значения этих\n// элементов, хранящиеся в колонках, указанных в третьем параметре, сворачиваются. Важно! Значения колонок, не вошедших\n// ни в один из списков принимают значения первого элемента коллекции.\n//\n// Параметры:\n//  Коллекция - ДанныеФормыКоллекция - коллекция, которую необходимо свернуть.\n//  КолонкиГруппировок - Строка - имена колонок, разделенные запятыми, по которым необходимо группировать элементы\n//                                коллекции.\n//  КолонкиСуммирования - Строка - имена колонок, разделенные запятыми, по которым необходимо суммировать значения в\n//                                 элементах коллекции.\n//\n&НаКлиенте\nПроцедура СвернутьДанныеФормыКоллекция(Коллекция, КолонкиГруппировок, КолонкиСуммирования)\n\tСтруктураКолонокСуммирования = Новый Структура(КолонкиСуммирования);\n\tОтбор = Новый Структура(КолонкиГруппировок);\n\tСвернутыеСтроки = Новый Соответствие;\n\t\n\tДля каждого ЭлементКоллекции Из Коллекция Цикл\n\t\tЕсли СвернутыеСтроки[ЭлементКоллекции] <> Неопределено Тогда\n\t\t\tПродолжить;\n\t\tКонецЕсли;\n\t\t\n\t\tЗаполнитьЗначенияСвойств(Отбор, ЭлементКоллекции, КолонкиГруппировок);\n\t\tСтрокиПоОтбору = Коллекция.НайтиСтроки(Отбор);\n\t\t\n\t\tДля Индекс = 1 По СтрокиПоОтбору.ВГраница() Цикл\n\t\t\tДля каждого ОписаниеКолонки Из СтруктураКолонокСуммирования Цикл\n\t\t\t\tЭлементКоллекции[ОписаниеКолонки.Ключ] = ЭлементКоллекции[ОписаниеКолонки.Ключ]\n\t\t\t\t\t+ СтрокиПоОтбору[Индекс][ОписаниеКолонки.Ключ];\n\t\t\t\tСвернутыеСтроки.Вставить(СтрокиПоОтбору[Индекс], Истина);\n\t\t\tКонецЦикла;\n\t\tКонецЦикла;\n\tКонецЦикла;\n\t\n\tДля каждого СвернутаяСтрока Из СвернутыеСтроки Цикл\n\t\tКоллекция.Удалить(СвернутаяСтрока.Ключ);\n\tКонецЦикла;\nКонецПроцедуры"
  },
  {
    "title": "Преобразование Хранилище Значения в Двоичные данные и обратно",
    "description": "Преобразование Хранилище Значения в Двоичные данные и обратно",
    "code_snippet": "Процедура КнопкаТестироватьХранилищеЗначенияНажатие(Элемент)\r\n\t\t\r\n\tСтрокаJSON = \"Строка для преобразования\";\r\n\t\r\n\t//Преобразуем Строку в Хранилище значения со сжатием.\r\n\tСжатиеДанных = Новый СжатиеДанных(9);\r\n\tХранилищеЗначения = Новый ХранилищеЗначения(СтрокаJSON,СжатиеДанных);\r\n\r\n\t//Преобразуем Хранилище Значения в Двоичные данные\r\n\tСтрBase64 = XMLСтрока(ХранилищеЗначения);\t\t\t\t\t\r\n\tДвоичныеДанные = ПолучитьДвоичныеДанныеИзСтроки(СтрBase64,\"UTF-8\", Ложь);\r\n\t\r\n\t\r\n\t//Преобразуем Двоичные данные в Хранилище значений\r\n\tРезультатСтрBase64 = ПолучитьСтрокуИзДвоичныхДанных(ДвоичныеДанные,\"UTF-8\");\r\n\tРезультатХранилище = XMLЗначение(Тип(\"ХранилищеЗначения\"), РезультатСтрBase64);\t\r\n\t\r\n\t//Получим строку из Хранилища\r\n\tСтрокаJSONизХранилища = РезультатХранилище.Получить();\r\n\t\r\n\t\r\nКонецПроцедуры\n\nПроцедура КнопкаТестироватьХранилищеЗначенияНажатие(Элемент)\r\n\t\t\r\n\tСтрокаJSON = \"Строка для преобразования\";\r\n\t\r\n\t//Преобразуем Строку в Хранилище значения со сжатием.\r\n\tСжатиеДанных = Новый СжатиеДанных(9);\r\n\tХранилищеЗначения = Новый ХранилищеЗначения(СтрокаJSON,СжатиеДанных);\r\n\r\n\t//Преобразуем Хранилище Значения в Двоичные данные\r\n\tСтрBase64 = XMLСтрока(ХранилищеЗначения);\t\t\t\t\t\r\n\tДвоичныеДанные = ПолучитьДвоичныеДанныеИзСтроки(СтрBase64,\"UTF-8\", Ложь);\r\n\t\r\n\t\r\n\t//Преобразуем Двоичные данные в Хранилище значений\r\n\tРезультатСтрBase64 = ПолучитьСтрокуИзДвоичныхДанных(ДвоичныеДанные,\"UTF-8\");\r\n\tРезультатХранилище = XMLЗначение(Тип(\"ХранилищеЗначения\"), РезультатСтрBase64);\t\r\n\t\r\n\t//Получим строку из Хранилища\r\n\tСтрокаJSONизХранилища = РезультатХранилище.Получить();\r\n\t\r\n\t\r\nКонецПроцедуры\n\n{19} Переменной СтрокаJSONизХранилища присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Создание дополнительного реквизита в наборе",
    "description": "Создание дополнительного реквизита в наборе",
    "code_snippet": "// Создает в базе дополнительный реквизит в наборе, по значению переданных на вход параметров.\r\n// При отсутствии создает набор по имени\r\n// ИмяСвойства \t\t\t\t\t- (Строка) Для поиска (создания при отсутствии) свойства.\r\n// ТипЗначения \t\t\t\t\t- (Описание типов) Для создания нового свойства, при отсутствии.\r\n// НаименованиеНабора \t\t\t- (Строка) Для поиска (создания при отсутствии) набора свойств\r\n//\t\t\t\t\t\t\t\t\tи для включения дополнительного реквизита в набор.\r\n// ИмяПредопределенногоНабора \t- Для проявления вновь созданного набора в списке.\r\n// \t\t\t\t\t\t\t\t\tДля полноценного использования (видимости в форме)\r\n//\t\t\t\t\t\t\t\t\tего придется сделать предопределенным.\r\n// МассивЗначений \t\t\t\t- Массив строковых значений, если хотим сделать перечисление\r\n//\t\t\t\t\t\t\t\t\tна основе справочника \"ЗначенияСвойствОбъектов\".\r\n// НаименованиеСвойства \t\t- (Строка) (если хотим, чтобы наименование и заголовок реквизита отличались от имени)\r\nПроцедура СоздатьДопРеквизит(ИмяСвойства, ТипЗначения, НаименованиеНабора, ИмяПредопределенногоНабора = \"\",\r\n\t\t\t\t\t\t\t МассивЗначений = Неопределено, НаименованиеСвойства = \"\") Экспорт\r\n\r\n\tНабор = Справочники.НаборыДополнительныхРеквизитовИСведений.НайтиПоНаименованию(НаименованиеНабора);\r\n\tЕсли Не ЗначениеЗаполнено(Набор) Тогда\r\n\t\tНаборОбъект = Справочники.НаборыДополнительныхРеквизитовИСведений.СоздатьЭлемент();\r\n\t\tНаборОбъект.Наименование = НаименованиеНабора;\r\n\t\tНаборОбъект.ИмяПредопределенногоНабора = ИмяПредопределенногоНабора;\r\n\t\tНаборОбъект.Используется = Истина;\r\n\t\tНаборОбъект.Записать();\r\n\t\tНабор = НаборОбъект.Ссылка;\r\n\tКонецЕсли;\r\n\r\n\tЕсли ЗначениеЗаполнено(ИмяПредопределенногоНабора) И Не Набор.ИмяПредопределенногоНабора = ИмяПредопределенногоНабора Тогда\r\n\t    НаборДополнительныхРеквизитов = Набор.ПолучитьОбъект();\r\n\t\tНаборДополнительныхРеквизитов.ИмяПредопределенногоНабора = ИмяПредопределенногоНабора;\r\n\t\tНаборДополнительныхРеквизитов.Записать();\r\n\tКонецЕсли;\r\n\r\n\tСвойство = ПолучитьСоздатьСвойство(ИмяСвойства, ТипЗначения, , Ложь, Набор, НаименованиеСвойства);\r\n\r\n\tЕсли Не Свойство = Неопределено И Не МассивЗначений = Неопределено Тогда\r\n\r\n\t\t\tТаблицаНужныхЗначений = Новый ТаблицаЗначений();\r\n\t\t    ТаблицаНужныхЗначений.Колонки.Добавить(\"Наименование\", Новый ОписаниеТипов(\"Строка\", , , , Новый КвалификаторыСтроки(100)));\r\n\t\t\tДля Сч = 1 По МассивЗначений.Количество() Цикл\r\n\t\t\t    ТаблицаНужныхЗначений.Добавить();\r\n\t\t\tКонецЦикла;\r\n\t\t    ТаблицаНужныхЗначений.ЗагрузитьКолонку(МассивЗначений, \"Наименование\");\r\n\r\n\t\t\tЗапросЗначения = Новый Запрос();\r\n\t\t\tЗапросЗначения.УстановитьПараметр(\"Владелец\", Свойство);\r\n\t\t\tЗапросЗначения.УстановитьПараметр(\"ТаблицаНужныхЗначений\", ТаблицаНужныхЗначений);\r\n\t\t\tЗапросЗначения.Текст = \"ВЫБРАТЬ\r\n\t\t\t                       |\tТаблицаНужныхЗначений.Наименование КАК Наименование\r\n\t\t\t                       |ПОМЕСТИТЬ ТаблицаНужныхЗначений\r\n\t\t\t                       |ИЗ\r\n\t\t\t                       |\t&ТаблицаНужныхЗначений КАК ТаблицаНужныхЗначений\r\n\t\t\t                       |;\r\n\t\t\t                       |\r\n\t\t\t                       |////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t                       |ВЫБРАТЬ\r\n\t\t\t                       |\tТаблицаНужныхЗначений.Наименование КАК Наименование\r\n\t\t\t                       |ИЗ\r\n\t\t\t                       |\tТаблицаНужныхЗначений КАК ТаблицаНужныхЗначений\r\n\t\t\t                       |\t\tЛЕВОЕ СОЕДИНЕНИЕ Справочник.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов\r\n\t\t\t                       |\t\tПО ТаблицаНужныхЗначений.Наименование = ЗначенияСвойствОбъектов.Наименование\r\n\t\t\t                       |\t\t\tИ (ЗначенияСвойствОбъектов.Владелец = &Владелец)\r\n\t\t\t                       |ГДЕ\r\n\t\t\t                       |\tЗначенияСвойствОбъектов.Наименование ЕСТЬ NULL\";\r\n\r\n\t\t\tРезультат = ЗапросЗначения.Выполнить();\r\n\t\t\tЕсли Не Результат.Пустой() Тогда\r\n\t\t\t\tВыборка = Результат.Выбрать();\r\n\t\t\t\tПока Выборка.Следующий() Цикл\r\n\t\t\t\t\tНовоеЗначение = Справочники.ЗначенияСвойствОбъектов.СоздатьЭлемент();\r\n\t\t\t\t\tНовоеЗначение.Владелец = Свойство;\r\n\t\t\t\t\tНовоеЗначение.Наименование = Выборка.Наименование;\r\n\t\t\t\t\tНовоеЗначение.Записать();\r\n\t\t\t\tКонецЦикла;\r\n\t\t\tКонецЕсли;\r\n\r\n\tКонецЕсли;\r\n\r\nКонецПроцедуры\n\n// Создает в базе дополнительный реквизит в наборе, по значению переданных на вход параметров.\r\n// При отсутствии создает набор по имени\r\n// ИмяСвойства \t\t\t\t\t- (Строка) Для поиска (создания при отсутствии) свойства.\r\n// ТипЗначения \t\t\t\t\t- (Описание типов) Для создания нового свойства, при отсутствии.\r\n// НаименованиеНабора \t\t\t- (Строка) Для поиска (создания при отсутствии) набора свойств\r\n//\t\t\t\t\t\t\t\t\tи для включения дополнительного реквизита в набор.\r\n// ИмяПредопределенногоНабора \t- Для проявления вновь созданного набора в списке.\r\n// \t\t\t\t\t\t\t\t\tДля полноценного использования (видимости в форме)\r\n//\t\t\t\t\t\t\t\t\tего придется сделать предопределенным.\r\n// МассивЗначений \t\t\t\t- Массив строковых значений, если хотим сделать перечисление\r\n//\t\t\t\t\t\t\t\t\tна основе справочника \"ЗначенияСвойствОбъектов\".\r\n// НаименованиеСвойства \t\t- (Строка) (если хотим, чтобы наименование и заголовок реквизита отличались от имени)\r\nПроцедура СоздатьДопРеквизит(ИмяСвойства, ТипЗначения, НаименованиеНабора, ИмяПредопределенногоНабора = \"\",\r\n\t\t\t\t\t\t\t МассивЗначений = Неопределено, НаименованиеСвойства = \"\") Экспорт\r\n\r\n\tНабор = Справочники.НаборыДополнительныхРеквизитовИСведений.НайтиПоНаименованию(НаименованиеНабора);\r\n\tЕсли Не ЗначениеЗаполнено(Набор) Тогда\r\n\t\tНаборОбъект = Справочники.НаборыДополнительныхРеквизитовИСведений.СоздатьЭлемент();\r\n\t\tНаборОбъект.Наименование = НаименованиеНабора;\r\n\t\tНаборОбъект.ИмяПредопределенногоНабора = ИмяПредопределенногоНабора;\r\n\t\tНаборОбъект.Используется = Истина;\r\n\t\tНаборОбъект.Записать();\r\n\t\tНабор = НаборОбъект.Ссылка;\r\n\tКонецЕсли;\r\n\r\n\tЕсли ЗначениеЗаполнено(ИмяПредопределенногоНабора) И Не Набор.ИмяПредопределенногоНабора = ИмяПредопределенногоНабора Тогда\r\n\t    НаборДополнительныхРеквизитов = Набор.ПолучитьОбъект();\r\n\t\tНаборДополнительныхРеквизитов.ИмяПредопределенногоНабора = ИмяПредопределенногоНабора;\r\n\t\tНаборДополнительныхРеквизитов.Записать();\r\n\tКонецЕсли;\r\n\r\n\tСвойство = ПолучитьСоздатьСвойство(ИмяСвойства, ТипЗначения, , Ложь, Набор, НаименованиеСвойства);\r\n\r\n\tЕсли Не Свойство = Неопределено И Не МассивЗначений = Неопределено Тогда\r\n\r\n\t\t\tТаблицаНужныхЗначений = Новый ТаблицаЗначений();\r\n\t\t    ТаблицаНужныхЗначений.Колонки.Добавить(\"Наименование\", Новый ОписаниеТипов(\"Строка\", , , , Новый КвалификаторыСтроки(100)));\r\n\t\t\tДля Сч = 1 По МассивЗначений.Количество() Цикл\r\n\t\t\t    ТаблицаНужныхЗначений.Добавить();\r\n\t\t\tКонецЦикла;\r\n\t\t    ТаблицаНужныхЗначений.ЗагрузитьКолонку(МассивЗначений, \"Наименование\");\r\n\r\n\t\t\tЗапросЗначения = Новый Запрос();\r\n\t\t\tЗапросЗначения.УстановитьПараметр(\"Владелец\", Свойство);\r\n\t\t\tЗапросЗначения.УстановитьПараметр(\"ТаблицаНужныхЗначений\", ТаблицаНужныхЗначений);\r\n\t\t\tЗапросЗначения.Текст = \"ВЫБРАТЬ\r\n\t\t\t                       |\tТаблицаНужныхЗначений.Наименование КАК Наименование\r\n\t\t\t                       |ПОМЕСТИТЬ ТаблицаНужныхЗначений\r\n\t\t\t                       |ИЗ\r\n\t\t\t                       |\t&ТаблицаНужныхЗначений КАК ТаблицаНужныхЗначений\r\n\t\t\t                       |;\r\n\t\t\t                       |\r\n\t\t\t                       |////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t                       |ВЫБРАТЬ\r\n\t\t\t                       |\tТаблицаНужныхЗначений.Наименование КАК Наименование\r\n\t\t\t                       |ИЗ\r\n\t\t\t                       |\tТаблицаНужныхЗначений КАК ТаблицаНужныхЗначений\r\n\t\t\t                       |\t\tЛЕВОЕ СОЕДИНЕНИЕ Справочник.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов\r\n\t\t\t                       |\t\tПО ТаблицаНужныхЗначений.Наименование = ЗначенияСвойствОбъектов.Наименование\r\n\t\t\t                       |\t\t\tИ (ЗначенияСвойствОбъектов.Владелец = &Владелец)\r\n\t\t\t                       |ГДЕ\r\n\t\t\t                       |\tЗначенияСвойствОбъектов.Наименование ЕСТЬ NULL\";\r\n\r\n\t\t\tРезультат = ЗапросЗначения.Выполнить();\r\n\t\t\tЕсли Не Результат.Пустой() Тогда\r\n\t\t\t\tВыборка = Результат.Выбрать();\r\n\t\t\t\tПока Выборка.Следующий() Цикл\r\n\t\t\t\t\tНовоеЗначение = Справочники.ЗначенияСвойствОбъектов.СоздатьЭлемент();\r\n\t\t\t\t\tНовоеЗначение.Владелец = Свойство;\r\n\t\t\t\t\tНовоеЗначение.Наименование = Выборка.Наименование;\r\n\t\t\t\t\tНовоеЗначение.Записать();\r\n\t\t\t\tКонецЦикла;\r\n\t\t\tКонецЕсли;\r\n\r\n\tКонецЕсли;\r\n\r\nКонецПроцедуры"
  },
  {
    "title": "Локализация объекта по уникальному значению свойства",
    "description": "Локализация объекта по уникальному значению свойства",
    "code_snippet": "&НаСервере\r\nПроцедура ПримерПолученияОбъекта(УИД) Экспорт\r\n\tНужныйОбъект = ПолучитьОбъектПоЗначениюСвойства(\"УИД_НашегоДокумента\", УИД, \"Документ.ЗаказКлиента\");\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\n// Универсальная функция. Получает объект определенного типа по уникальному значению свойства.\r\n// Свойство - Либо свойство (ПланВидовХарактеристик.ДополнительныеРеквизитыИСведения), либо Имя (строка)\r\n// ЗначениеСвойства - значение, передаваемое для поиска объекта.\r\n// ИмяМетаданные - Имя метаданных (\"Документ.ЗаказКлиента\"). Сильно ускоряет запрос.\r\nФункция ПолучитьОбъектПоЗначениюСвойства(Свойство_Или_Имя, ЗначениеСвойства, ИмяМетаданные) Экспорт\r\n\r\n\tОтвет = Неопределено;\r\n\r\n\tЕсли ТипЗнч(Свойство_Или_Имя) = Тип(\"Строка\") Тогда\r\n\t\tСвойство = ПолучитьСоздатьСвойство(Свойство_Или_Имя);\r\n\tИначе\r\n\t\tСвойство = Свойство_Или_Имя;\r\n\tКонецЕсли;\r\n\r\n\tЕсли Не Свойство = Неопределено Тогда\r\n\r\n\t\tЗапрос = Новый Запрос();\r\n\t\tЗапрос.Текст =\r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tДополнительныеСведения.Объект КАК Объект,\r\n\t\t|\tДополнительныеСведения.Свойство КАК Свойство,\r\n\t\t|\tДополнительныеСведения.Значение КАК Значение\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ДополнительныеСведения КАК ДополнительныеСведения\r\n\t\t|ГДЕ\r\n\t\t|\tДополнительныеСведения.Значение = &ЗначениеСвойства\r\n\t\t|\tИ ДополнительныеСведения.Свойство = &Свойство\r\n\t\t|\tИ ДополнительныеСведения.Объект ССЫЛКА Справочник.Номенклатура\";\r\n\r\n\r\n\t\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"Справочник.Номенклатура\", ИмяМетаданные);\r\n\r\n\t\tЗапрос.УстановитьПараметр(\"Свойство\", Свойство);\r\n\t\tЗапрос.УстановитьПараметр(\"ЗначениеСвойства\", ЗначениеСвойства);\r\n\t\tВыборка = Запрос.Выполнить().Выбрать();\r\n\t\tЕсли Выборка.Следующий() Тогда\r\n\t\t\tОтвет = Выборка.Объект;\r\n\t\tКонецЕсли;\r\n\r\n\tКонецЕсли;\r\n\r\n\tВозврат Ответ;\r\n\r\nКонецФункции\n\n&НаСервере\r\nПроцедура ПримерПолученияОбъекта(УИД) Экспорт\r\n\tНужныйОбъект = ПолучитьОбъектПоЗначениюСвойства(\"УИД_НашегоДокумента\", УИД, \"Документ.ЗаказКлиента\");\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\n// Универсальная функция. Получает объект определенного типа по уникальному значению свойства.\r\n// Свойство - Либо свойство (ПланВидовХарактеристик.ДополнительныеРеквизитыИСведения), либо Имя (строка)\r\n// ЗначениеСвойства - значение, передаваемое для поиска объекта.\r\n// ИмяМетаданные - Имя метаданных (\"Документ.ЗаказКлиента\"). Сильно ускоряет запрос.\r\nФункция ПолучитьОбъектПоЗначениюСвойства(Свойство_Или_Имя, ЗначениеСвойства, ИмяМетаданные) Экспорт\r\n\r\n\tОтвет = Неопределено;\r\n\r\n\tЕсли ТипЗнч(Свойство_Или_Имя) = Тип(\"Строка\") Тогда\r\n\t\tСвойство = ПолучитьСоздатьСвойство(Свойство_Или_Имя);\r\n\tИначе\r\n\t\tСвойство = Свойство_Или_Имя;\r\n\tКонецЕсли;\r\n\r\n\tЕсли Не Свойство = Неопределено Тогда\r\n\r\n\t\tЗапрос = Новый Запрос();\r\n\t\tЗапрос.Текст =\r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tДополнительныеСведения.Объект КАК Объект,\r\n\t\t|\tДополнительныеСведения.Свойство КАК Свойство,\r\n\t\t|\tДополнительныеСведения.Значение КАК Значение\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ДополнительныеСведения КАК ДополнительныеСведения\r\n\t\t|ГДЕ\r\n\t\t|\tДополнительныеСведения.Значение = &ЗначениеСвойства\r\n\t\t|\tИ ДополнительныеСведения.Свойство = &Свойство\r\n\t\t|\tИ ДополнительныеСведения.Объект ССЫЛКА Справочник.Номенклатура\";\r\n\r\n\r\n\t\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"Справочник.Номенклатура\", ИмяМетаданные);\r\n\r\n\t\tЗапрос.УстановитьПараметр(\"Свойство\", Свойство);\r\n\t\tЗапрос.УстановитьПараметр(\"ЗначениеСвойства\", ЗначениеСвойства);\r\n\t\tВыборка = Запрос.Выполнить().Выбрать();\r\n\t\tЕсли Выборка.Следующий() Тогда\r\n\t\t\tОтвет = Выборка.Объект;\r\n\t\tКонецЕсли;\r\n\r\n\tКонецЕсли;\r\n\r\n\tВозврат Ответ;\r\n\r\nКонецФункции\n\n{3} Переменной НужныйОбъект присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Работа со значением свойства",
    "description": "Работа со значением свойства",
    "code_snippet": "&НаСервере\r\nПроцедура ПримерыВызова(ТаблицаОбъектов) Экспорт\r\n\r\n\t//Для пакетной обработки или создания свойства\r\n\tСвойство = ПолучитьСоздатьСвойство(\"УИД_НашегоДокумента\", Новый ОписаниеТипов(\"Строка\", , , , Новый КвалификаторыСтроки(36)));\r\n\tДля Каждого СтрокаТЗ Из ТаблицаОбъектов Цикл\r\n\t\tУИД = ПолучитьУстановитьЗначениеСвойства(Свойство, СтрокаТЗ.СсылкаНаОбъект);\r\n\t\tНовыйУИД = СтрЗаменить(УИД, \"1\", \"2\");\r\n\t\tРезультат = ПолучитьУстановитьЗначениеСвойства(Свойство, СтрокаТЗ.СсылкаНаОбъект, НовыйУИД);\r\n\tКонецЦикла;\r\n\r\n\t//Для разового вызова\r\n\tЕсли ТаблицаОбъектов.Количество() > 0 Тогда\r\n\t\tУИД = ПолучитьУстановитьЗначениеСвойства(\"УИД_НашегоДокумента\", ТаблицаОбъектов[0].СсылкаНаОбъект);\r\n\t\tНовыйУИД = СтрЗаменить(УИД, \"1\", \"2\");\r\n\t\tРезультат = ПолучитьУстановитьЗначениеСвойства(\"УИД_НашегоДокумента\", ТаблицаОбъектов[0].СсылкаНаОбъект, НовыйУИД);\r\n\tКонецЕсли;\r\n\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\n// Универсальная функция. Получает значение свойства. При заполненном параметре ЗначениеСвойства может свойство установить.\r\n// Свойство - Либо свойство (ПланВидовХарактеристик.ДополнительныеРеквизитыИСведения), либо Имя (строка)\r\n// СсылкаНаОбъект - Объект в регистре сведений \"ДополнительныеСведения\"\r\n// ЗначениеСвойства - Значение, передаваемое для установки.\r\nФункция ПолучитьУстановитьЗначениеСвойства(Свойство_Или_Имя, СсылкаНаОбъект, ЗначениеСвойства = Неопределено) Экспорт\r\n\r\n\tОтвет = Неопределено;\r\n\r\n\tЕсли ТипЗнч(Свойство_Или_Имя) = Тип(\"Строка\") Тогда\r\n\t\tСвойство = ПолучитьСоздатьСвойство(Свойство_Или_Имя);\r\n\tИначе\r\n\t\tСвойство = Свойство_Или_Имя;\r\n\tКонецЕсли;\r\n\r\n\tЕсли Не Свойство = Неопределено Тогда\r\n\t\tПопытка\r\n\t\t\tМЗ = РегистрыСведений.ДополнительныеСведения.СоздатьМенеджерЗаписи();\r\n\t\t\tМЗ.Объект = СсылкаНаОбъект;\r\n\t\t\tМЗ.Свойство = Свойство;\r\n\t\t\tМЗ.Прочитать();\r\n\t\t\tЕсли Не МЗ.Выбран() Или (Не ЗначениеСвойства = Неопределено И Не МЗ.Значение = ЗначениеСвойства) Тогда\r\n\t\t\t\tЕсли Не ЗначениеСвойства = Неопределено Тогда\r\n\t\t\t\t\tМЗ.Объект = СсылкаНаОбъект;\r\n\t\t\t\t\tМЗ.Свойство = Свойство;\r\n\t\t\t\t\tМЗ.Значение = ЗначениеСвойства;\r\n\t\t\t\t\tМЗ.Записать();\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ЗначениеЗаполнено(МЗ.Значение) Тогда\r\n\t\t\t\tОтвет = МЗ.Значение;\r\n\t\t\tКонецЕсли;\r\n\t\tИсключение\r\n\t\tКонецПопытки;\r\n\tКонецЕсли;\r\n\r\n\tВозврат Ответ;\r\n\r\nКонецФункции\r\n\r\n\r\n&НаСервере\r\nПроцедура ПримерВызова2() Экспорт\r\n\r\n\tТипЗначения = Новый ОписаниеТипов(\"Строка\", , , , Новый КвалификаторыСтроки(36));\r\n\tПолучитьСоздатьСвойство(\"СДЭК_КодПВЗ\", ТипЗначения, , , , \"Код ПВЗ СДЭК\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_КодТарифа\", ТипЗначения, , , , \"Код тарифа СДЭК\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_УИД\", ТипЗначения, , , , \"УИД от СДЭК\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_УИД_ШК\", ТипЗначения, , , , \"УИД ШК от СДЭК\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_ИД\", ТипЗначения, , , , \"Account\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_ApiKey\", ТипЗначения, , , , \"Secure password\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Сайт\", ТипЗначения, , , , \"Сайт\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_ВерсияAPI\", ТипЗначения, , , , \"Версия\");\r\n\r\n\tТипЗначения = Новый ОписаниеТипов(\"Строка\", , , , Новый КвалификаторыСтроки(500));\r\n\tПолучитьСоздатьСвойство(\"СДЭК_ОшибкиЗапроса\", ТипЗначения, , , , \"Сообщение СДЭК\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_URL_ШК\", ТипЗначения, , , , \"URL ШК СДЭК\");\r\n\r\n\tТипЗначения = Новый ОписаниеТипов(\"Булево\");\r\n\tПолучитьСоздатьСвойство(\"Это_СДЭК\", ТипЗначения, , , , \"Признак СДЭК\");\r\n\r\n\tТипЗначения = Новый ОписаниеТипов(\"Число\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Порт\", ТипЗначения, , , , \"Порт\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Вес\", ТипЗначения, , , , \"Вес\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Глубина\", ТипЗначения, , , , \"Глубина\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Ширина\", ТипЗначения, , , , \"Ширина\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Высота\", ТипЗначения, , , , \"Высота\");\r\n\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ПримерыВызова(ТаблицаОбъектов) Экспорт\r\n\r\n\t//Для пакетной обработки или создания свойства\r\n\tСвойство = ПолучитьСоздатьСвойство(\"УИД_НашегоДокумента\", Новый ОписаниеТипов(\"Строка\", , , , Новый КвалификаторыСтроки(36)));\r\n\tДля Каждого СтрокаТЗ Из ТаблицаОбъектов Цикл\r\n\t\tУИД = ПолучитьУстановитьЗначениеСвойства(Свойство, СтрокаТЗ.СсылкаНаОбъект);\r\n\t\tНовыйУИД = СтрЗаменить(УИД, \"1\", \"2\");\r\n\t\tРезультат = ПолучитьУстановитьЗначениеСвойства(Свойство, СтрокаТЗ.СсылкаНаОбъект, НовыйУИД);\r\n\tКонецЦикла;\r\n\r\n\t//Для разового вызова\r\n\tЕсли ТаблицаОбъектов.Количество() > 0 Тогда\r\n\t\tУИД = ПолучитьУстановитьЗначениеСвойства(\"УИД_НашегоДокумента\", ТаблицаОбъектов[0].СсылкаНаОбъект);\r\n\t\tНовыйУИД = СтрЗаменить(УИД, \"1\", \"2\");\r\n\t\tРезультат = ПолучитьУстановитьЗначениеСвойства(\"УИД_НашегоДокумента\", ТаблицаОбъектов[0].СсылкаНаОбъект, НовыйУИД);\r\n\tКонецЕсли;\r\n\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\n// Универсальная функция. Получает значение свойства. При заполненном параметре ЗначениеСвойства может свойство установить.\r\n// Свойство - Либо свойство (ПланВидовХарактеристик.ДополнительныеРеквизитыИСведения), либо Имя (строка)\r\n// СсылкаНаОбъект - Объект в регистре сведений \"ДополнительныеСведения\"\r\n// ЗначениеСвойства - Значение, передаваемое для установки.\r\nФункция ПолучитьУстановитьЗначениеСвойства(Свойство_Или_Имя, СсылкаНаОбъект, ЗначениеСвойства = Неопределено) Экспорт\r\n\r\n\tОтвет = Неопределено;\r\n\r\n\tЕсли ТипЗнч(Свойство_Или_Имя) = Тип(\"Строка\") Тогда\r\n\t\tСвойство = ПолучитьСоздатьСвойство(Свойство_Или_Имя);\r\n\tИначе\r\n\t\tСвойство = Свойство_Или_Имя;\r\n\tКонецЕсли;\r\n\r\n\tЕсли Не Свойство = Неопределено Тогда\r\n\t\tПопытка\r\n\t\t\tМЗ = РегистрыСведений.ДополнительныеСведения.СоздатьМенеджерЗаписи();\r\n\t\t\tМЗ.Объект = СсылкаНаОбъект;\r\n\t\t\tМЗ.Свойство = Свойство;\r\n\t\t\tМЗ.Прочитать();\r\n\t\t\tЕсли Не МЗ.Выбран() Или (Не ЗначениеСвойства = Неопределено И Не МЗ.Значение = ЗначениеСвойства) Тогда\r\n\t\t\t\tЕсли Не ЗначениеСвойства = Неопределено Тогда\r\n\t\t\t\t\tМЗ.Объект = СсылкаНаОбъект;\r\n\t\t\t\t\tМЗ.Свойство = Свойство;\r\n\t\t\t\t\tМЗ.Значение = ЗначениеСвойства;\r\n\t\t\t\t\tМЗ.Записать();\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ЗначениеЗаполнено(МЗ.Значение) Тогда\r\n\t\t\t\tОтвет = МЗ.Значение;\r\n\t\t\tКонецЕсли;\r\n\t\tИсключение\r\n\t\tКонецПопытки;\r\n\tКонецЕсли;\r\n\r\n\tВозврат Ответ;\r\n\r\nКонецФункции\r\n\r\n\r\n&НаСервере\r\nПроцедура ПримерВызова2() Экспорт\r\n\r\n\tТипЗначения = Новый ОписаниеТипов(\"Строка\", , , , Новый КвалификаторыСтроки(36));\r\n\tПолучитьСоздатьСвойство(\"СДЭК_КодПВЗ\", ТипЗначения, , , , \"Код ПВЗ СДЭК\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_КодТарифа\", ТипЗначения, , , , \"Код тарифа СДЭК\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_УИД\", ТипЗначения, , , , \"УИД от СДЭК\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_УИД_ШК\", ТипЗначения, , , , \"УИД ШК от СДЭК\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_ИД\", ТипЗначения, , , , \"Account\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_ApiKey\", ТипЗначения, , , , \"Secure password\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Сайт\", ТипЗначения, , , , \"Сайт\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_ВерсияAPI\", ТипЗначения, , , , \"Версия\");\r\n\r\n\tТипЗначения = Новый ОписаниеТипов(\"Строка\", , , , Новый КвалификаторыСтроки(500));\r\n\tПолучитьСоздатьСвойство(\"СДЭК_ОшибкиЗапроса\", ТипЗначения, , , , \"Сообщение СДЭК\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_URL_ШК\", ТипЗначения, , , , \"URL ШК СДЭК\");\r\n\r\n\tТипЗначения = Новый ОписаниеТипов(\"Булево\");\r\n\tПолучитьСоздатьСвойство(\"Это_СДЭК\", ТипЗначения, , , , \"Признак СДЭК\");\r\n\r\n\tТипЗначения = Новый ОписаниеТипов(\"Число\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Порт\", ТипЗначения, , , , \"Порт\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Вес\", ТипЗначения, , , , \"Вес\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Глубина\", ТипЗначения, , , , \"Глубина\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Ширина\", ТипЗначения, , , , \"Ширина\");\r\n\tПолучитьСоздатьСвойство(\"СДЭК_Высота\", ТипЗначения, , , , \"Высота\");\r\n\r\nКонецПроцедуры\n\n{16} Переменной Результат присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Получить свойство по имени, создать его при отсутствии",
    "description": "Получить свойство по имени, создать его при отсутствии",
    "code_snippet": "// Универсальная функция. Получает ссылку на свойство по имени. В случае отсутствия, если задан тип, создает свойство.\r\n// ИмяСвойства \t\t\t- (Строка) Для поиска и создания, при отсутствии.\r\n// ТипЗначения \t\t\t- (Описание типов) Для создания нового свойства, при отсутствии.\r\n// НаборСвойств \t\t- (СправочникСсылка.НаборыДополнительныхРеквизитовИСведений) Для включения в набор.\r\n// НаименованиеСвойства - (Строка) Для назначения или изменения наименования и заголовка.\r\nФункция ПолучитьСоздатьСвойство(ИмяСвойства, ТипЗначения = Неопределено, Комментарий = \"\", ЭтоДополнительноеСведение = Истина,\r\n\t\t\t\t\t\t\t\tНаборСвойств = Неопределено, НаименованиеСвойства = \"\") Экспорт\r\n\r\n\tСвойство = Неопределено;\r\n\r\n\tСоздатьСвойство = Ложь;\r\n\r\n\tЗапрос = Новый Запрос();\r\n\tЗапрос.УстановитьПараметр(\"ИмяСвойства\", ИмяСвойства);\r\n\tЗапрос.Текст =\r\n\t\"ВЫБРАТЬ\r\n\t|\tДополнительныеРеквизитыИСведения.Ссылка КАК Ссылка\r\n\t|ИЗ\r\n\t|\tПланВидовХарактеристик.ДополнительныеРеквизитыИСведения КАК ДополнительныеРеквизитыИСведения\r\n\t|ГДЕ\r\n\t|\tДополнительныеРеквизитыИСведения.Имя = &ИмяСвойства\r\n\t|\tИ НЕ ДополнительныеРеквизитыИСведения.ПометкаУдаления\";\r\n\r\n\tВыборка = Запрос.Выполнить().Выбрать();\r\n\tЕсли Выборка.Следующий() Тогда\r\n\t\tСвойство = Выборка.Ссылка;\r\n\tИначе\r\n\t\tЕсли Не ТипЗначения = Неопределено Тогда\r\n\t\t\tСоздатьСвойство = Истина;\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\r\n\tЕсли СоздатьСвойство Или ЗначениеЗаполнено(НаименованиеСвойства) И Не Свойство.Наименование = НаименованиеСвойства Тогда\r\n\t\tПопытка\r\n\t\t\tЕсли СоздатьСвойство Тогда\r\n\t\t\t\tСвойствоОбъект = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.СоздатьЭлемент();\r\n\t\t\tИначе\r\n\t\t\t\tСвойствоОбъект = Свойство.ПолучитьОбъект();\r\n\t\t\tКонецЕсли;\r\n\t\t\tСвойствоОбъект.Наименование = ?(ЗначениеЗаполнено(НаименованиеСвойства), НаименованиеСвойства, ИмяСвойства);\r\n\t\t\tСвойствоОбъект.Имя = ИмяСвойства;\r\n\t\t\tСвойствоОбъект.Доступен = Истина;\r\n\t\t\tСвойствоОбъект.ТипЗначения = ТипЗначения;\r\n\t\t\tСвойствоОбъект.ЭтоДополнительноеСведение = ЭтоДополнительноеСведение;\r\n\t\t\tСвойствоОбъект.Комментарий = Комментарий;\r\n\t\t\tСвойствоОбъект.Заголовок = СвойствоОбъект.Наименование;\r\n\t\t\tСвойствоОбъект.ДополнительныеЗначенияИспользуются = Истина;\r\n\t\t\tСвойствоОбъект.Виден = Истина;\r\n\t\t\tСвойствоОбъект.НаборСвойств = НаборСвойств;\r\n\t\t\tСвойствоОбъект.Записать();\r\n\t\t\tСвойство = СвойствоОбъект.Ссылка;\r\n\t\t\tЕсли СоздатьСвойство И ЗначениеЗаполнено(НаборСвойств) Тогда\r\n\t\t\t\tИмяТабчасти = ?(ЭтоДополнительноеСведение, \"ДополнительныеСведения\", \"ДополнительныеРеквизиты\");\r\n\t\t\t\tИмяРеквизитаКоличества = ?(ЭтоДополнительноеСведение, \"КоличествоСведений\", \"КоличествоРеквизитов\");\r\n\t\t\t\tЕсли НаборСвойств[ИмяТабчасти].Найти(Свойство, \"Свойство\") = Неопределено Тогда\r\n\t\t\t\t\tНаборОбъект = НаборСвойств.ПолучитьОбъект();\r\n\t\t\t\t\tТабЧасть = НаборОбъект[ИмяТабчасти];\r\n\t\t\t\t\tНоваяСтрока = ТабЧасть.Добавить();\r\n\t\t\t\t\tНоваяСтрока.Свойство = Свойство;\r\n\t\t\t\t\tНаборОбъект[ИмяРеквизитаКоличества] = ТабЧасть.Количество();\r\n\t\t\t\t\tНаборОбъект.Записать();\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\tИсключение\r\n\t\tКонецПопытки;\r\n\tКонецЕсли;\r\n\r\n\tВозврат Свойство;\r\n\r\nКонецФункции\n\n// Универсальная функция. Получает ссылку на свойство по имени. В случае отсутствия, если задан тип, создает свойство.\r\n// ИмяСвойства \t\t\t- (Строка) Для поиска и создания, при отсутствии.\r\n// ТипЗначения \t\t\t- (Описание типов) Для создания нового свойства, при отсутствии.\r\n// НаборСвойств \t\t- (СправочникСсылка.НаборыДополнительныхРеквизитовИСведений) Для включения в набор.\r\n// НаименованиеСвойства - (Строка) Для назначения или изменения наименования и заголовка.\r\nФункция ПолучитьСоздатьСвойство(ИмяСвойства, ТипЗначения = Неопределено, Комментарий = \"\", ЭтоДополнительноеСведение = Истина,\r\n\t\t\t\t\t\t\t\tНаборСвойств = Неопределено, НаименованиеСвойства = \"\") Экспорт\r\n\r\n\tСвойство = Неопределено;\r\n\r\n\tСоздатьСвойство = Ложь;\r\n\r\n\tЗапрос = Новый Запрос();\r\n\tЗапрос.УстановитьПараметр(\"ИмяСвойства\", ИмяСвойства);\r\n\tЗапрос.Текст =\r\n\t\"ВЫБРАТЬ\r\n\t|\tДополнительныеРеквизитыИСведения.Ссылка КАК Ссылка\r\n\t|ИЗ\r\n\t|\tПланВидовХарактеристик.ДополнительныеРеквизитыИСведения КАК ДополнительныеРеквизитыИСведения\r\n\t|ГДЕ\r\n\t|\tДополнительныеРеквизитыИСведения.Имя = &ИмяСвойства\r\n\t|\tИ НЕ ДополнительныеРеквизитыИСведения.ПометкаУдаления\";\r\n\r\n\tВыборка = Запрос.Выполнить().Выбрать();\r\n\tЕсли Выборка.Следующий() Тогда\r\n\t\tСвойство = Выборка.Ссылка;\r\n\tИначе\r\n\t\tЕсли Не ТипЗначения = Неопределено Тогда\r\n\t\t\tСоздатьСвойство = Истина;\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\r\n\tЕсли СоздатьСвойство Или ЗначениеЗаполнено(НаименованиеСвойства) И Не Свойство.Наименование = НаименованиеСвойства Тогда\r\n\t\tПопытка\r\n\t\t\tЕсли СоздатьСвойство Тогда\r\n\t\t\t\tСвойствоОбъект = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.СоздатьЭлемент();\r\n\t\t\tИначе\r\n\t\t\t\tСвойствоОбъект = Свойство.ПолучитьОбъект();\r\n\t\t\tКонецЕсли;\r\n\t\t\tСвойствоОбъект.Наименование = ?(ЗначениеЗаполнено(НаименованиеСвойства), НаименованиеСвойства, ИмяСвойства);\r\n\t\t\tСвойствоОбъект.Имя = ИмяСвойства;\r\n\t\t\tСвойствоОбъект.Доступен = Истина;\r\n\t\t\tСвойствоОбъект.ТипЗначения = ТипЗначения;\r\n\t\t\tСвойствоОбъект.ЭтоДополнительноеСведение = ЭтоДополнительноеСведение;\r\n\t\t\tСвойствоОбъект.Комментарий = Комментарий;\r\n\t\t\tСвойствоОбъект.Заголовок = СвойствоОбъект.Наименование;\r\n\t\t\tСвойствоОбъект.ДополнительныеЗначенияИспользуются = Истина;\r\n\t\t\tСвойствоОбъект.Виден = Истина;\r\n\t\t\tСвойствоОбъект.НаборСвойств = НаборСвойств;\r\n\t\t\tСвойствоОбъект.Записать();\r\n\t\t\tСвойство = СвойствоОбъект.Ссылка;\r\n\t\t\tЕсли СоздатьСвойство И ЗначениеЗаполнено(НаборСвойств) Тогда\r\n\t\t\t\tИмяТабчасти = ?(ЭтоДополнительноеСведение, \"ДополнительныеСведения\", \"ДополнительныеРеквизиты\");\r\n\t\t\t\tИмяРеквизитаКоличества = ?(ЭтоДополнительноеСведение, \"КоличествоСведений\", \"КоличествоРеквизитов\");\r\n\t\t\t\tЕсли НаборСвойств[ИмяТабчасти].Найти(Свойство, \"Свойство\") = Неопределено Тогда\r\n\t\t\t\t\tНаборОбъект = НаборСвойств.ПолучитьОбъект();\r\n\t\t\t\t\tТабЧасть = НаборОбъект[ИмяТабчасти];\r\n\t\t\t\t\tНоваяСтрока = ТабЧасть.Добавить();\r\n\t\t\t\t\tНоваяСтрока.Свойство = Свойство;\r\n\t\t\t\t\tНаборОбъект[ИмяРеквизитаКоличества] = ТабЧасть.Количество();\r\n\t\t\t\t\tНаборОбъект.Записать();\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\tИсключение\r\n\t\tКонецПопытки;\r\n\tКонецЕсли;\r\n\r\n\tВозврат Свойство;\r\n\r\nКонецФункции\n\nОрфографическая ошибка в ИмяТабчасти (найдено 3): Табчасти"
  },
  {
    "title": "Найти объект в базе по GUID",
    "description": "Найти объект в базе по GUID",
    "code_snippet": "Функция ПолучитьОбъектПоУИД(УИДОбъекта)  \r\n\r\n    СсылкаНаОбъект = Неопределено;\r\n    \r\n    // все объекты по которым можно получить ссылку \r\n    СписокОбъектовМетаданных = Новый Массив;\r\n    СписокОбъектовМетаданных.Добавить(Справочники);\r\n    СписокОбъектовМетаданных.Добавить(Документы);\r\n    СписокОбъектовМетаданных.Добавить(ПланыВидовХарактеристик);\r\n    СписокОбъектовМетаданных.Добавить(ПланыСчетов);\r\n    СписокОбъектовМетаданных.Добавить(ПланыОбмена);\r\n    СписокОбъектовМетаданных.Добавить(БизнесПроцессы);\r\n    СписокОбъектовМетаданных.Добавить(Задачи);\r\n    \r\n    Для Каждого текСтрМетаданных Из СписокОбъектовМетаданных Цикл   \r\n        Для Каждого текСтрМенеджер Из текСтрМетаданных Цикл \r\n            СсылкаНаОбъект = текСтрМенеджер.ПолучитьСсылку(УИДОбъекта);\r\n            Если СсылкаНаОбъект.ПолучитьОбъект() <> Неопределено Тогда          \r\n                Возврат СсылкаНаОбъект //нашли\r\n            КонецЕсли;      \r\n        КонецЦикла;\r\n    КонецЦикла;\r\n    \r\n    Возврат СсылкаНаОбъект //не нашли\r\n    \r\nКонецФункции\n\nФункция ПолучитьОбъектПоУИД(УИДОбъекта)  \r\n\r\n    СсылкаНаОбъект = Неопределено;\r\n    \r\n    // все объекты по которым можно получить ссылку \r\n    СписокОбъектовМетаданных = Новый Массив;\r\n    СписокОбъектовМетаданных.Добавить(Справочники);\r\n    СписокОбъектовМетаданных.Добавить(Документы);\r\n    СписокОбъектовМетаданных.Добавить(ПланыВидовХарактеристик);\r\n    СписокОбъектовМетаданных.Добавить(ПланыСчетов);\r\n    СписокОбъектовМетаданных.Добавить(ПланыОбмена);\r\n    СписокОбъектовМетаданных.Добавить(БизнесПроцессы);\r\n    СписокОбъектовМетаданных.Добавить(Задачи);\r\n    \r\n    Для Каждого текСтрМетаданных Из СписокОбъектовМетаданных Цикл   \r\n        Для Каждого текСтрМенеджер Из текСтрМетаданных Цикл \r\n            СсылкаНаОбъект = текСтрМенеджер.ПолучитьСсылку(УИДОбъекта);\r\n            Если СсылкаНаОбъект.ПолучитьОбъект() <> Неопределено Тогда          \r\n                Возврат СсылкаНаОбъект //нашли\r\n            КонецЕсли;      \r\n        КонецЦикла;\r\n    КонецЦикла;\r\n    \r\n    Возврат СсылкаНаОбъект //не нашли\r\n    \r\nКонецФункции\n\nФункция ПолучитьСсылкуПоУИДу(УИД) Экспорт\n\n    // Проверяем, что УИД передан\n    Если ПустаяСтрока(УИД) Тогда\n        Возврат Неопределено;\n    КонецЕсли;\n\n    // Преобразуем УИД в уникальный идентификатор\n    УникальныйИдентификатор = Новый УникальныйИдентификатор(УИД);\n\n    // Создаем массив типов объектов для поиска\n    ТипыОбъектов = Новый Массив;\n    ТипыОбъектов.Добавить(Метаданные.Справочники);\n    ТипыОбъектов.Добавить(Метаданные.Документы);\n    ТипыОбъектов.Добавить(Метаданные.ПланыВидовХарактеристик);\n    ТипыОбъектов.Добавить(Метаданные.ПланыСчетов);\n    ТипыОбъектов.Добавить(Метаданные.ПланыОбмена);\n    ТипыОбъектов.Добавить(Метаданные.БизнесПроцессы);\n    // Добавь другие типы, если нужно\n\n    // Перебираем все типы объектов\n    Для каждого ТипОбъекта Из ТипыОбъектов Цикл\n        Для каждого КонкретныйТип Из ТипОбъекта Цикл\n            Попытка\n                СсылкаНаОбъект = КонкретныйТип.Менеджер.НайтиПоУникальномуИдентификатору(УникальныйИдентификатор);\n                Если СсылкаНаОбъект <> Неопределено Тогда\n                    Возврат СсылкаНаОбъект;\n                КонецЕсли;\n            Исключение\n                // Продолжаем поиск в других типах\n            КонецПопытки;\n        КонецЦикла;\n    КонецЦикла;\n\n    // Если объект не найден, возвращаем Неопределено\n    Возврат Неопределено;\n\nКонецФункции\n\nУИД = \"550e8400-e29b-41d4-a716-446655440000\"; // Пример УИД\n\nСсылкаНаОбъект = ПолучитьСсылкуПоУИДу(УИД);\n\nЕсли СсылкаНаОбъект = Неопределено Тогда\n    Сообщить(\"Объект не найден!\");\nИначе\n    Сообщить(\"Найден объект: \" + СсылкаНаОбъект.Ссылка);\nКонецЕсли;\n\n// Возвращает ссылку на объект ссылочного типа по уникальному идентификатору. Если объект не найден, то будет возвращено\n// Неопределено.\n//\n// Параметры:\n//  Идентификатор - УникальныйИдентификатор - идентификатор объекта.\n// \n// Возвращаемое значение:\n//  ЛюбаяСсылка - ссылка на объект ссылочного типа. Если объект не найден, то будет возвращено Неопределено.\n//\nФункция СсылкаПоУникальномуИдентификатору(Идентификатор)\n\tМенеджерыОбъектовМетаданных = Новый Массив;\n\tМенеджерыОбъектовМетаданных.Добавить(Справочники);\n\tМенеджерыОбъектовМетаданных.Добавить(Документы);\n\tМенеджерыОбъектовМетаданных.Добавить(ПланыВидовХарактеристик);\n\tМенеджерыОбъектовМетаданных.Добавить(ПланыСчетов);\n\tМенеджерыОбъектовМетаданных.Добавить(ПланыОбмена);\n\tМенеджерыОбъектовМетаданных.Добавить(БизнесПроцессы);\n\tМенеджерыОбъектовМетаданных.Добавить(Задачи);\n\t\n\tСсылки = Новый Массив;\n\tТекстыЗапроса = Новый Массив;\n\t\n\tДля каждого МенеджерыОбъектов Из МенеджерыОбъектовМетаданных Цикл\n\t\tДля каждого Менеджер Из МенеджерыОбъектов Цикл\n\t\t\tСсылка = Менеджер.ПолучитьСсылку(Идентификатор);\n\t\t\tСсылки.Добавить(Ссылка);\n\t\t\t\n\t\t\tТекстЗапроса =\n\t\t\t\"ВЫБРАТЬ\n\t\t\t|\tТаблица.Ссылка КАК Ссылка\n\t\t\t|ИЗ\n\t\t\t|\t&МетаданныеСсылкиПолноеИмя КАК Таблица\n\t\t\t|ГДЕ\n\t\t\t|\tСсылка В (&Ссылки)\";\n\t\t\tТекстЗапроса = СтрЗаменить(ТекстЗапроса, \"&МетаданныеСсылкиПолноеИмя\", Ссылка.Метаданные().ПолноеИмя());\n\t\t\tТекстыЗапроса.Добавить(ТекстЗапроса);\n\t\tКонецЦикла;\n\tКонецЦикла;\n\t\n\tСтрокаОбъединенияЗапроса = \"\n\t|ОБЪЕДИНИТЬ ВСЕ\n\t|\";\n\t\n\tТекстЗапроса = СтрСоединить(ТекстыЗапроса, СтрокаОбъединенияЗапроса);\n\t\n\tЗапрос = Новый Запрос(ТекстЗапроса);\n\tЗапрос.УстановитьПараметр(\"Ссылки\", Ссылки);\n\t\n\tВыборка = Запрос.Выполнить().Выбрать();\n\tВозврат ?(Выборка.Следующий(), Выборка.Ссылка, Неопределено);\nКонецФункции"
  },
  {
    "title": "ИР Кнопка \"Сравнить\" в окне \"Выражение\"",
    "description": "ИР Кнопка \"Сравнить\" в окне \"Выражение\"Все",
    "code_snippet": ""
  },
  {
    "title": "ИР Редактировать таблицу",
    "description": "ИР Редактировать таблицуВсе",
    "code_snippet": ""
  },
  {
    "title": "ИР Найти в окнах",
    "description": "ИР Найти в окнахВсе",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Условие останова\" в окне \"Выражение\"",
    "description": "ИР Кнопка \"Условие останова\" в окне \"Выражение\"Все",
    "code_snippet": ""
  },
  {
    "title": "ИР кнопки \"Вертикаль\" и \"Горизонталь\" окна \"Тип элемента\" редактора формы",
    "description": "ИР кнопки \"Вертикаль\" и \"Горизонталь\" окна \"Тип элемента\" редактора формыВсе",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Список\" в окне <Коллекция>",
    "description": "ИР Кнопка \"Список\" в окне <Коллекция>Все",
    "code_snippet": ""
  },
  {
    "title": "Шаблон модуля внешней обработки",
    "description": "Шаблон модуля внешней обработки",
    "code_snippet": "#Область ПрограммныйИнтерфейс\r\nФункция СведенияОВнешнейОбработке() Экспорт\r\n    \r\n    МетаданныеОбработки = ЭтотОбъект.Метаданные();\r\n    ИмяОтчета     = МетаданныеОбработки.Имя; \r\n    Синоним     = МетаданныеОбработки.Синоним; \r\n    Синоним     = ?(ЗначениеЗаполнено(Синоним), Синоним, ИмяОтчета);         \r\n    Комментарий = МетаданныеОбработки.Комментарий;\r\n    \r\n    РегистрационныеДанные = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(СтандартныеПодсистемыСервер.ВерсияБиблиотеки());\r\n    РегистрационныеДанные.Вид                 = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка();\r\n    РегистрационныеДанные.Наименование         = Синоним;     \r\n    РегистрационныеДанные.Версия             = \"1.0\";\r\n    РегистрационныеДанные.БезопасныйРежим     = Истина;\r\n    РегистрационныеДанные.Информация         = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка() + \" \" + Синоним;\r\n    \r\n    // Добавим команду\r\n    Команда = РегистрационныеДанные.Команды.Добавить();\r\n    Команда.Идентификатор  = \"ЗагрузкаДанных\";\r\n    Команда.Представление  = Синоним + ?(ЗначениеЗаполнено(Комментарий),\" \" + Комментарий,\"\");\r\n    Команда.Использование  = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\r\n    Команда.ПоказыватьОповещение  = Истина;\r\n    \r\n    // Добавим Разрешения\r\n    МассивРазрешений = РегистрационныеДанные.Разрешения;\r\n    МассивРазрешений.Добавить(РаботаВБезопасномРежиме.РазрешениеНаСозданиеCOMКласса(\"Excel.Application\", \"{00024500-0000-0000-C000-000000000046}\"));\r\n    \r\n    Возврат РегистрационныеДанные;\r\n                                       \r\nКонецФункции\r\n\r\nПроцедура ВыполнитьКоманду(ИдентификаторКоманды, ПараметрыВыполненияКоманды) Экспорт\r\n    \r\n  // Реализация логики команды\r\n  Если ИдентификаторКоманды = \"ЗагрузкаДанных\" Тогда\r\n    \r\n  КонецЕсли;\r\n    \r\n КонецПроцедуры\r\n  \r\n#КонецОбласти\n\n#Область ПрограммныйИнтерфейс\r\nФункция СведенияОВнешнейОбработке() Экспорт\r\n    \r\n    МетаданныеОбработки = ЭтотОбъект.Метаданные();\r\n    ИмяОтчета     = МетаданныеОбработки.Имя; \r\n    Синоним     = МетаданныеОбработки.Синоним; \r\n    Синоним     = ?(ЗначениеЗаполнено(Синоним), Синоним, ИмяОтчета);         \r\n    Комментарий = МетаданныеОбработки.Комментарий;\r\n    \r\n    РегистрационныеДанные = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(СтандартныеПодсистемыСервер.ВерсияБиблиотеки());\r\n    РегистрационныеДанные.Вид                 = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка();\r\n    РегистрационныеДанные.Наименование         = Синоним;     \r\n    РегистрационныеДанные.Версия             = \"1.0\";\r\n    РегистрационныеДанные.БезопасныйРежим     = Истина;\r\n    РегистрационныеДанные.Информация         = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка() + \" \" + Синоним;\r\n    \r\n    // Добавим команду\r\n    Команда = РегистрационныеДанные.Команды.Добавить();\r\n    Команда.Идентификатор  = \"ЗагрузкаДанных\";\r\n    Команда.Представление  = Синоним + ?(ЗначениеЗаполнено(Комментарий),\" \" + Комментарий,\"\");\r\n    Команда.Использование  = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\r\n    Команда.ПоказыватьОповещение  = Истина;\r\n    \r\n    // Добавим Разрешения\r\n    МассивРазрешений = РегистрационныеДанные.Разрешения;\r\n    МассивРазрешений.Добавить(РаботаВБезопасномРежиме.РазрешениеНаСозданиеCOMКласса(\"Excel.Application\", \"{00024500-0000-0000-C000-000000000046}\"));\r\n    \r\n    Возврат РегистрационныеДанные;\r\n                                       \r\nКонецФункции\r\n\r\nПроцедура ВыполнитьКоманду(ИдентификаторКоманды, ПараметрыВыполненияКоманды) Экспорт\r\n    \r\n  // Реализация логики команды\r\n  Если ИдентификаторКоманды = \"ЗагрузкаДанных\" Тогда\r\n    \r\n  КонецЕсли;\r\n    \r\n КонецПроцедуры\r\n  \r\n#КонецОбласти"
  },
  {
    "title": "ИР Кнопка \"Перейти\" в окне \"Событие\"",
    "description": "ИР Кнопка \"Перейти\" в окне \"Событие\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Редактировать компоновку",
    "description": "ИР Редактировать компоновкуВсе",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Из результатов поиска\" в окне \"Точки останова\"",
    "description": "ИР Кнопка \"Из результатов поиска\" в окне \"Точки останова\"Все",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Изменить\" в окне \"Пользователь\"",
    "description": "ИР Кнопка \"Изменить\" в окне \"Пользователь\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Список\" в окне \"Выбор картинки\"",
    "description": "ИР Кнопка \"Список\" в окне \"Выбор картинки\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Сравнить\" в окне \"Различие между\"",
    "description": "ИР Кнопка \"Сравнить\" в окне \"Различие между\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Сравнить\" в окне \"Сравнение модулей\"",
    "description": "ИР Кнопка \"Сравнить\" в окне \"Сравнение модулей\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Установить тип\" в окне \"Редактирование параметров выбора\"",
    "description": "ИР Кнопка \"Установить тип\" в окне \"Редактирование параметров выбора\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Помеченные\" в окне \"Редактирование типа данных\"",
    "description": "ИР Кнопка \"Помеченные\" в окне \"Редактирование типа данных\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Список\" в окне \"Отбор по подсистемам\"",
    "description": "ИР Кнопка \"Список\" в окне \"Отбор по подсистемам\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Список\" в окнах \"Точки останова\" и \"Закладки\"",
    "description": "ИР Кнопка \"Список\" в окнах \"Точки останова\" и \"Закладки\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Список\" в окне \"Предметы отладки\"",
    "description": "ИР Кнопка \"Список\" в окне \"Предметы отладки\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Прервать\" в окне \"Выражение\"",
    "description": "ИР Кнопка \"Прервать\" в окне \"Выражение\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Вставить\" в окне \"Остановка по ошибке\"",
    "description": "ИР Кнопка \"Вставить\" в окне \"Остановка по ошибке\"TurboConf ИР",
    "code_snippet": "Ошибка при вызове метода контекста (НайтиПараметры)\n{ВнешняяОбработка.ирОбщий.МодульОбъекта(11018)}:    ОписанияПараметров = Запрос.НайтиПараметры(); // Здесь могут быть ложные ошибки синтаксического контроля\n{ВнешняяОбработка.ирОбщий.МодульОбъекта(11078)}:    ЗаполнитьПараметрыСхемыПоЗапросуЛкс(СхемаКомпоновкиДанных, Запрос);\nпо причине:\n{(52, 48)}: Поле не найдено \"Т.ОбластьДанныхОсновныеДанные\""
  },
  {
    "title": "ИР Кнопка \"Выполнить код\" в окне \"Выражение\"",
    "description": "ИР Кнопка \"Выполнить код\" в окне \"Выражение\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Авто\" в окне \"Редактирование типа данных\"",
    "description": "ИР Кнопка \"Авто\" в окне \"Редактирование типа данных\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Кнопка \"Вставить из табло\" в окне \"Параметры точки останова\"",
    "description": "ИР Кнопка \"Вставить из табло\" в окне \"Параметры точки останова\"TurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Получить имя базы 1С",
    "description": "Получить имя базы 1С",
    "code_snippet": "ИмяБазы = Макс(НСтр(СтрокаСоединенияИнформационнойБазы(),\"Ref\"),НСтр(СтрокаСоединенияИнформационнойБазы(),\"File\"));\n\nИмяБазы = Макс(НСтр(СтрокаСоединенияИнформационнойБазы(),\"Ref\"),НСтр(СтрокаСоединенияИнформационнойБазы(),\"File\"));\n\n{1} Переменной ИмяБазы присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Запись текста в кодировке UTF-8 без BOM средствами платформы 1С",
    "description": "Запись текста в кодировке UTF-8 без BOM средствами платформы 1С",
    "code_snippet": "ЗТ = Новый ЗаписьТекста(ИмяФайла, КодировкаТекста.ANSI);\r\nЗТ.Закрыть();\r\nЗТ = Новый ЗаписьТекста(ИмяФайла,,, Истина, Символы.ПС);\r\nЗТ.Записать(Данные);\r\nЗТ.Закрыть();\r\n\r\n//--------------------\r\n\r\nЗТ = Новый ЗаписьТекста(ИмяФайла, КодировкаТекста.CESU-8);\r\nЗТ.Записать(Данные);\r\nЗТ.Закрыть();\n\nЗТ = Новый ЗаписьТекста(ИмяФайла, КодировкаТекста.ANSI);\r\nЗТ.Закрыть();\r\nЗТ = Новый ЗаписьТекста(ИмяФайла,,, Истина, Символы.ПС);\r\nЗТ.Записать(Данные);\r\nЗТ.Закрыть();\r\n\r\n//--------------------\r\n\r\nЗТ = Новый ЗаписьТекста(ИмяФайла, КодировкаТекста.CESU-8);\r\nЗТ.Записать(Данные);\r\nЗТ.Закрыть();"
  },
  {
    "title": "Live template в стиле PHPStorm",
    "description": "Позволяет управлять последовательностью перехода  к местам вставки при применении шаблона",
    "code_snippet": ""
  },
  {
    "title": "Открыть форму списка с отбором по доп.свойству / доп.реквизиту",
    "description": "Открыть форму списка с отбором по доп.свойству / доп.реквизиту",
    "code_snippet": "&НаКлиенте\r\nПроцедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)\r\n\t\r\n\tФиксированныеНастройки = Новый НастройкиКомпоновкиДанных;\r\n\tЭлементОтбора = ФиксированныеНастройки.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\")); \r\n\tЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"Ссылка.[Это приложение (Договоры)]\");\r\n\tЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно;\r\n\tЭлементОтбора.Использование = Истина;\r\n\tЭлементОтбора.ПравоеЗначение = Истина;\r\n\t\r\n\tФиксированныеНастройки = Новый Структура(\"ФиксированныеНастройки\", ФиксированныеНастройки);\r\n\t\r\n\tОткрытьФорму(\"Справочник.ДоговорыКонтрагентов.ФормаСписка\", ФиксированныеНастройки, ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность, ПараметрыВыполненияКоманды.Окно, ПараметрыВыполненияКоманды.НавигационнаяСсылка);\r\n\t\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)\r\n\t\r\n\tФиксированныеНастройки = Новый НастройкиКомпоновкиДанных;\r\n\tЭлементОтбора = ФиксированныеНастройки.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\")); \r\n\tЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"Ссылка.[Это приложение (Договоры)]\");\r\n\tЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно;\r\n\tЭлементОтбора.Использование = Истина;\r\n\tЭлементОтбора.ПравоеЗначение = Истина;\r\n\t\r\n\tФиксированныеНастройки = Новый Структура(\"ФиксированныеНастройки\", ФиксированныеНастройки);\r\n\t\r\n\tОткрытьФорму(\"Справочник.ДоговорыКонтрагентов.ФормаСписка\", ФиксированныеНастройки, ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность, ПараметрыВыполненияКоманды.Окно, ПараметрыВыполненияКоманды.НавигационнаяСсылка);\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Синтакс-помощник БСП с нейросетевым ассистентом",
    "description": "Синтакс-помощник БСП - cправочник по библиотеке стандартных подсистем. В состав справочника входит описание экспортных процедур и функций, размещенных в областях кода ПрограммныйИнтерфейс БСП. В справчоник добавлены ассистенты на базе нейросетевых моделей ...",
    "code_snippet": ""
  },
  {
    "title": "Загрузить картинку из интернета асинхронно",
    "description": "Загрузить картинку из интернета асинхронно",
    "code_snippet": "&НаКлиенте\nАсинх Процедура ЗагрузитьКартинку(Команда) \n\tURL = \"\"; // здесь надо задать URL-адрес картинки \n\tВремФайл = ПолучитьИмяВременногоФайла();\n\t\n\tЖдать КопироватьФайлАсинх(URL,ВремФайл); \n\tОписаниеФайла = Ждать ПоместитьФайлНаСерверАсинх(,,,ВремФайл);\n\t\n\tКартинкаНаФормеТипаСтрока = ОписаниеФайла.Адрес;\n\tЭтаФорма.ОбновитьОтображениеДанных();\nКонецПроцедуры\n\nМойФайл = Новый Файл(\"Путь\\до\\моего\\файла\\с\\расширением\");"
  },
  {
    "title": "Функция ВремяГода(мес)",
    "description": "Функция ВремяГода(мес)",
    "code_snippet": "Функция ВремяГода(мес) \n\t\n\tЕсли мес = 12 ИЛИ мес <= 2 Тогда\n\t    Возврат \"Зима\";\n\tИначеЕсли мес <= 5 Тогда \n\t\tВозврат \"Весна\";\n\tИначеЕсли мес  <= 8 Тогда \n\t\tВозврат \"Лето\";\n\tИначе \n\t\tВозврат \"Осень\";\n\tКонецЕсли;\n\t\nКонецФункции"
  },
  {
    "title": "кнПерезапустить_Нажатие",
    "description": "кнПерезапустить_Нажатие",
    "code_snippet": "Процедура кнПерезапустить_Нажатие(Кнопка)\r\n    Для каждого МетаФорма Из ЭтаФорма.Метаданные().Формы Цикл\r\n        ТекФорма = ПолучитьФорму(МетаФорма);\r\n        Если ТекФорма.Открыта() Тогда\r\n            ТекФорма.Закрыть();\r\n            Если ТекФорма = ЭтаФорма Тогда\r\n                Если Найти(Строка(ТипЗнч(ЭтотОбъект)), \"Внешняя обработка объект:\") = 1 Тогда\r\n                    ВнешниеОбработки.Создать(ЭтотОбъект.ИспользуемоеИмяФайла).ПолучитьФорму(МетаФорма.Имя).Открыть();\r\n                Иначе\r\n                    ВнешниеОтчеты.Создать(ЭтотОбъект.ИспользуемоеИмяФайла).ПолучитьФорму(МетаФорма.Имя).Открыть();\r\n                КонецЕсли;\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n    КонецЦикла;\r\nКонецПроцедуры\n\nПроцедура кнПерезапустить_Нажатие(Кнопка)\r\n    Для каждого МетаФорма Из ЭтаФорма.Метаданные().Формы Цикл\r\n        ТекФорма = ПолучитьФорму(МетаФорма);\r\n        Если ТекФорма.Открыта() Тогда\r\n            ТекФорма.Закрыть();\r\n            Если ТекФорма = ЭтаФорма Тогда\r\n                Если Найти(Строка(ТипЗнч(ЭтотОбъект)), \"Внешняя обработка объект:\") = 1 Тогда\r\n                    ВнешниеОбработки.Создать(ЭтотОбъект.ИспользуемоеИмяФайла).ПолучитьФорму(МетаФорма.Имя).Открыть();\r\n                Иначе\r\n                    ВнешниеОтчеты.Создать(ЭтотОбъект.ИспользуемоеИмяФайла).ПолучитьФорму(МетаФорма.Имя).Открыть();\r\n                КонецЕсли;\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n    КонецЦикла;\r\nКонецПроцедуры\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "Шаблон юнит-теста",
    "description": "Шаблон юнит-теста",
    "code_snippet": "#Область ОписаниеПеременных\r\n\r\nПерем КонтекстЯдра;              // Фреймворк тестирования\r\nПерем Утверждения;               // Ассерты\r\nПерем Данные;                    // Плагин данных\r\nПерем УтвержденияПроверкаТаблиц; // Плагин проверки таблиц\r\n\r\n#КонецОбласти\r\n\r\n#Область СлужебныйПрограммныйИнтерфейс\r\n\r\n#Область СобытияФреймворкаТестирования\r\n\r\nПроцедура Инициализация(КонтекстЯдраПараметр) Экспорт\r\n\t\r\n\tКонтекстЯдра              = КонтекстЯдраПараметр;\r\n\tУтверждения               = КонтекстЯдра.Плагин(\"БазовыеУтверждения\");\r\n\tДанные                    = КонтекстЯдра.Плагин(\"Данные\");\r\n\tУтвержденияПроверкаТаблиц = КонтекстЯдра.Плагин(\"УтвержденияПроверкаТаблиц\");\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ЗаполнитьНаборТестов(НаборТестов, КонтекстЯдраПараметр) Экспорт\r\n\t\r\n\tКонтекстЯдра = КонтекстЯдраПараметр;\r\n\t\r\n\tНаборТестов.Добавить(\"Тест_ДолженПроверить\");\r\n\t\r\nКонецПроцедуры\r\n\r\n// BSLLS:PairingBrokenTransaction-OFF\r\n// BSLLS:BeginTransactionBeforeTryCatch-OFF\r\n// BSLLS:WrongUseOfRollbackTransactionMethod-OFF\r\n\r\nПроцедура ПередЗапускомТеста() Экспорт\r\n\tНачатьТранзакцию();\r\nКонецПроцедуры\r\n\r\nПроцедура ПослеЗапускаТеста() Экспорт\r\n\tЕсли ТранзакцияАктивна() Тогда\r\n\t\tОтменитьТранзакцию();\r\n\tКонецЕсли;\r\nКонецПроцедуры\r\n\r\n// BSLLS:PairingBrokenTransaction-ON\r\n// BSLLS:BeginTransactionBeforeTryCatch-ON\r\n// BSLLS:WrongUseOfRollbackTransactionMethod-ON\r\n\r\n#КонецОбласти\r\n\r\n#Область Тесты\r\n\r\nПроцедура Тест_ДолженПроверить() Экспорт\r\n\t\r\n\t// Дано\r\n\t\r\n\t// Когда\r\n\t\r\n\t// Тогда\r\n\t\r\nКонецПроцедуры\r\n\r\n#КонецОбласти\r\n\r\n#КонецОбласти\n\n#Область ОписаниеПеременных\r\n\r\nПерем КонтекстЯдра;              // Фреймворк тестирования\r\nПерем Утверждения;               // Ассерты\r\nПерем Данные;                    // Плагин данных\r\nПерем УтвержденияПроверкаТаблиц; // Плагин проверки таблиц\r\n\r\n#КонецОбласти\r\n\r\n#Область СлужебныйПрограммныйИнтерфейс\r\n\r\n#Область СобытияФреймворкаТестирования\r\n\r\nПроцедура Инициализация(КонтекстЯдраПараметр) Экспорт\r\n\t\r\n\tКонтекстЯдра              = КонтекстЯдраПараметр;\r\n\tУтверждения               = КонтекстЯдра.Плагин(\"БазовыеУтверждения\");\r\n\tДанные                    = КонтекстЯдра.Плагин(\"Данные\");\r\n\tУтвержденияПроверкаТаблиц = КонтекстЯдра.Плагин(\"УтвержденияПроверкаТаблиц\");\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ЗаполнитьНаборТестов(НаборТестов, КонтекстЯдраПараметр) Экспорт\r\n\t\r\n\tКонтекстЯдра = КонтекстЯдраПараметр;\r\n\t\r\n\tНаборТестов.Добавить(\"Тест_ДолженПроверить\");\r\n\t\r\nКонецПроцедуры\r\n\r\n// BSLLS:PairingBrokenTransaction-OFF\r\n// BSLLS:BeginTransactionBeforeTryCatch-OFF\r\n// BSLLS:WrongUseOfRollbackTransactionMethod-OFF\r\n\r\nПроцедура ПередЗапускомТеста() Экспорт\r\n\tНачатьТранзакцию();\r\nКонецПроцедуры\r\n\r\nПроцедура ПослеЗапускаТеста() Экспорт\r\n\tЕсли ТранзакцияАктивна() Тогда\r\n\t\tОтменитьТранзакцию();\r\n\tКонецЕсли;\r\nКонецПроцедуры\r\n\r\n// BSLLS:PairingBrokenTransaction-ON\r\n// BSLLS:BeginTransactionBeforeTryCatch-ON\r\n// BSLLS:WrongUseOfRollbackTransactionMethod-ON\r\n\r\n#КонецОбласти\r\n\r\n#Область Тесты\r\n\r\nПроцедура Тест_ДолженПроверить() Экспорт\r\n\t\r\n\t// Дано\r\n\t\r\n\t// Когда\r\n\t\r\n\t// Тогда\r\n\t\r\nКонецПроцедуры\r\n\r\n#КонецОбласти\r\n\r\n#КонецОбласти\n\nОрфографическая ошибка в Фреймворк: Фреймворк\r\nОрфографическая ошибка в Ассерты: Ассерты\r\nОрфографическая ошибка в СобытияФреймворкаТестирования: Фреймворка"
  },
  {
    "title": "Шаблон http-сервиса",
    "description": "Шаблон http-сервиса",
    "code_snippet": "#Область ОбработчикиСобытий\r\n\r\nФункция ЛицензииДоступны(Запрос)\r\n\t\r\n\tОтвет = Новый HTTPСервисОтвет(200);\r\n\tДобавитьЗаголовкиДанных(Ответ);\r\n\tРезультат = Результат();\r\n\tОтвет.КодСостояния = Результат.КодСостояния;\r\n\tОтвет.УстановитьТелоИзСтроки(Результат.ТекстСостояния);\r\n\tВозврат Ответ;\r\n\t\r\nКонецФункции\r\n\r\n#КонецОбласти\r\n\r\n#Область СлужебныеПроцедурыИФункции\r\n\r\nПроцедура ДобавитьЗаголовкиДанных(Ответ) Экспорт\r\n\t\r\n\tЗаголовки = Ответ.Заголовки;\r\n\t\r\n\tЗаголовки.Вставить(\"Accept\", \"application/json\");\r\n\tЗаголовки.Вставить(\"Accept-Charset\", \"utf-8\");\r\n\tЗаголовки.Вставить(\"Content-Type\", \"application/json; charset=utf-8\");\t\r\n\tЗаголовки.Вставить(\"Cache-Control\", \"no-cache\");\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция Результат()\r\n\t\r\n\tПопытка\r\n\t\tТекстСостояния = НаличиеЛицензийТекст();\r\n\t\tКодСостояния = 200;\r\n\tИсключение\r\n\t\tТекстСостояния = \"\";\r\n\t\tКодСостояния = 500;\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат Новый Структура(\"ТекстСостояния, КодСостояния\", ТекстСостояния, КодСостояния);\r\nКонецФункции\r\n\r\nФункция НаличиеЛицензийТекст()\r\n\t\r\n\tУстановитьПривилегированныйРежим(Истина);\r\n\tЗакрытьПрограмму = Ложь;\r\n    торо_СЛКСервер.ПроверитьЛицензииПередНачаломРаботыСистемы(ЗакрытьПрограмму);\r\n    \r\n\tСтруктура = Новый Структура;\r\n\tСтруктура.Вставить(\"LicenseAvailable \", Формат(НЕ ЗакрытьПрограмму, \"БЛ=false; БИ=true\"));\r\n\t\r\n\tЗаписьJSON = Новый ЗаписьJSON;\r\n\tЗаписьJSON.УстановитьСтроку();\r\n\tЗаписатьJSON(ЗаписьJSON, Структура);\r\n\tТекст =  ЗаписьJSON.Закрыть();\r\n\t\r\n\tВозврат Текст;\r\nКонецФункции\r\n\r\n#КонецОбласти\n\n#Область ОбработчикиСобытий\r\n\r\nФункция ЛицензииДоступны(Запрос)\r\n\t\r\n\tОтвет = Новый HTTPСервисОтвет(200);\r\n\tДобавитьЗаголовкиДанных(Ответ);\r\n\tРезультат = Результат();\r\n\tОтвет.КодСостояния = Результат.КодСостояния;\r\n\tОтвет.УстановитьТелоИзСтроки(Результат.ТекстСостояния);\r\n\tВозврат Ответ;\r\n\t\r\nКонецФункции\r\n\r\n#КонецОбласти\r\n\r\n#Область СлужебныеПроцедурыИФункции\r\n\r\nПроцедура ДобавитьЗаголовкиДанных(Ответ) Экспорт\r\n\t\r\n\tЗаголовки = Ответ.Заголовки;\r\n\t\r\n\tЗаголовки.Вставить(\"Accept\", \"application/json\");\r\n\tЗаголовки.Вставить(\"Accept-Charset\", \"utf-8\");\r\n\tЗаголовки.Вставить(\"Content-Type\", \"application/json; charset=utf-8\");\t\r\n\tЗаголовки.Вставить(\"Cache-Control\", \"no-cache\");\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция Результат()\r\n\t\r\n\tПопытка\r\n\t\tТекстСостояния = НаличиеЛицензийТекст();\r\n\t\tКодСостояния = 200;\r\n\tИсключение\r\n\t\tТекстСостояния = \"\";\r\n\t\tКодСостояния = 500;\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат Новый Структура(\"ТекстСостояния, КодСостояния\", ТекстСостояния, КодСостояния);\r\nКонецФункции\r\n\r\nФункция НаличиеЛицензийТекст()\r\n\t\r\n\tУстановитьПривилегированныйРежим(Истина);\r\n\tЗакрытьПрограмму = Ложь;\r\n    торо_СЛКСервер.ПроверитьЛицензииПередНачаломРаботыСистемы(ЗакрытьПрограмму);\r\n    \r\n\tСтруктура = Новый Структура;\r\n\tСтруктура.Вставить(\"LicenseAvailable \", Формат(НЕ ЗакрытьПрограмму, \"БЛ=false; БИ=true\"));\r\n\t\r\n\tЗаписьJSON = Новый ЗаписьJSON;\r\n\tЗаписьJSON.УстановитьСтроку();\r\n\tЗаписатьJSON(ЗаписьJSON, Структура);\r\n\tТекст =  ЗаписьJSON.Закрыть();\r\n\t\r\n\tВозврат Текст;\r\nКонецФункции\r\n\r\n#КонецОбласти\n\nОрфографическая ошибка в Charset: Charset\r\nОрфографическая ошибка в charset: charset"
  },
  {
    "title": "Использование в Мобильном Приложении  (Андроид) сканера ШтрихКодов с компонентой Драйвер1СУстройствоВводаNative от 1С",
    "description": "Использование в Мобильном Приложении  (Андроид) сканера ШтрихКодов с компонентой Драйвер1СУстройствоВводаNative от 1СВсе",
    "code_snippet": "//\n//=========  Модуль Приложения =======================\n//\nПерем глСканер Экспорт;\t\n\nПроцедура ПриНачалеРаботыСистемы()\n\tПодключитьСканерМобильноеПриложение();\nКонецПроцедуры\n\nПроцедура ПодключитьСканерМобильноеПриложение()\n\n\t\tИмяДрайвера \t= \"Драйвер1ССканерШтрихкода\";\n\t\tИмяМакета \t\t= \"ОбщийМакет.\" + ИмяДрайвера;\n\t\t\t\n\t\tОписаниеОшибки = \"\";\n\t\tПопытка\n\t\t\tРезультат = ПодключитьВнешнююКомпоненту( ИмяМакета , \"InputDevice\", ТипВнешнейКомпоненты.Native);\n\t\tИсключение\n\t\t\tРезультат = Ложь;\n\t\t\tОписаниеОшибки = ОписаниеОшибки();\n\t\t\t\n\t\t\tТекст = \"Ошибка подключения внешней компоненты \"\"\"+ИмяМакета+\"\"\"!!!\"+\"\n\t\t\t\t|\" + ОписаниеОшибки;\n\t\t\tСообщить(Текст, СтатусСообщения.Важное);\t\t\t\n\t\t\tВозврат;\n\t\tКонецПопытки;\n\t\t\n\t\tПопытка\n\t\t\tглСканер = Новый (\"AddIn.InputDevice.InputDevice\");\n\t\tИсключение\n\t\t\tглСканер = Неопределено;\n\t\t\tОписаниеОшибки = ОписаниеОшибки();\n\t\t\t\n\t\t\tТекст = \"Ошибка создания компоненты \"\"\"+ИмяДрайвера+\"\"\"!\n\t\t\t\t|\"+ОписаниеОшибки;\n\t\t\tСообщить(Текст, СтатусСообщения.Важное);\t\t\t\n\t\t\tВозврат;\n\t\tКонецПопытки;\n\t\t\n\t\t// ====  Установка параметров Компоненты\t\t\n\t\tглСканер.УстановитьПараметр(\"EquipmentType\"\t\t, \"УстройствоВвода\"); \t// В параметрах драйвера этого нет, поэтому может быть не работает \t\t\n\t\tглСканер.УстановитьПараметр(\"EventName\"\t\t\t, \"Штрихкод\");\t\t\t//Вероятнее всего это не используется.\n\t\t\n\t\tглСканер.УстановитьПараметр(\"BluetoothDevice\"\t, \"BROADCAST\");\t\t\t// Broadcаst сообщения Android\n\t\tглСканер.УстановитьПараметр(\"Prefix\"\t\t\t, -1);\t\t\t\t\t// NONE\n\t\tглСканер.УстановитьПараметр(\"Suffix\"\t\t\t, 3338);\t\t\t\t// CRLF\n\t\t\n\t\tглСканер.УстановитьПараметр(\"GSSymbolKey\"\t\t, 7);\t\t\t\t\t// F8, заменяем GS на F8 \n\t\t\n\t\t// BROADCAST\n\t\tИнтент \t\t\t= \"android.intent.ACTION_DECODE_DATA\";\t\t\t\t\t//Указано в настройках Сканера\n\t\tИнтентДанные \t= \"barcode_string\";\t\t\t\t\t\t\t\t\t\t//Указано в настройках Сканера\n\t\t\n\t\tглСканер.УстановитьПараметр(\"Action\"\t\t, Интент);\t\t\n\t\tглСканер.УстановитьПараметр(\"Extra\"\t\t, ИнтентДанные);\n\t\tглСканер.УстановитьПараметр(\"ExtraType\"\t, \"String\");   \t\t\n\t\t\t\t\n\t\tглСканер.УстановитьПараметр(\"OutputDataType\"\t, 0);\t\t\t\t\t// Строка\t\t\n\t\tглСканер.УстановитьПараметр(\"LogType\"\t\t\t, -1); \t\t\t\t\t// NONE  \n\t\tглСканер.УстановитьПараметр(\"LogFilePath\"\t\t, \"\");  \n\t\t\t\t\t\t\n\t\t//====  Подключаем компоненту ======\n\t\tIDParametr = \"\";\t\t\t\t\t\t\t\t//Идентификатор устройства после подключения InputDevice#123213498554\t\n\t\tРезультат = глСканер.Подключить(IDParametr); \t// подключаем компоненту \n\t\t\t\t\n\t\tНомерВерсии = глСканер.ПолучитьНомерВерсии();\n\t\t\n\t\tОписаниеУстройства = \"\";\n\t\tглСканер.ПолучитьОписание(ОписаниеУстройства);\n\t\t\n\t\tПараметрыКомпонентыXML = \"\";\t\t\t\t\t\t// Получаем XML документ описывающий возможные параметры Компоненты \n\t\tглСканер.ПолучитьПараметры(ПараметрыКомпонентыXML);  \n\t\t\n\t\tТекст = \"Драйвер сканера ШтрихКодов \"\"\"+ ИмяДрайвера+\"\"\"\n\t\t\t|Успешно подключен!\";\n\t\tСообщить(Текст);\nКонецПроцедуры\n\nПроцедура ОбработкаВнешнегоСобытия(Источник, Событие, Данные)\t\n\tЕсли Событие = \"Штрихкод\" Или Событие = \"Barcode\" Тогда\t\t\n\t\tСобытие \t= \"ШтрихКод\";\n\t\tИсточник \t= \"Scaner\";\t\t\t\t\t\t\t\t\n\tКонецЕсли;\t\n\t\n\tОповестить(Событие, Данные, Источник);\nКонецПроцедуры\n\n//\n// =====================  Форма Сканирования ===================\n//\n&НаКлиенте\nПроцедура ОбработкаОповещения(ИмяСобытия, Данные, Источник)\n\t\n\tЕсли ИмяСобытия = \"ШтрихКод\" И ВводДоступен() Тогда\t\t\n\t\tШтрихКод = Данные;\t\t\n\t\tСообщить(\"Источник: \"+Источник + \" ИмяСобытия: \"+ ИмяСобытия + \" Данные: \"+Данные);\n\t\tКонецЕСли;\t\t\n\tКонецЕсли;\nКонецПроцедуры"
  },
  {
    "title": "Передача параметров и отбора в общую форму отчета",
    "description": "Передача параметров и отбора в общую форму отчета",
    "code_snippet": "&НаКлиенте\nПроцедура ОписьНаСтройку(Команда)\n\n\tКомпоновщикНастроек = ПолучитьКомпоновщикНастроек();\n\tНастройки = КомпоновщикНастроек.Настройки;\n\n\tКомпоновкаДанныхКлиентСервер.УстановитьПараметр(Настройки, \"ДатаКонца\", ТекущаяДата());\n\n\tПараметрыОткрытия = Новый Структура();\n\tПараметрыОткрытия.Вставить(\"СформироватьПриОткрытии\", Истина);\n\tПараметрыОткрытия.Вставить(\"Вариант\", Настройки);\n\tПараметрыОткрытия.Вставить(\"ПользовательскиеНастройки\", КомпоновщикНастроек.ПользовательскиеНастройки);\n\t\n\tОткрытьФорму(\"Отчет.ит_ОписьАктовПП.Форма\", ПараметрыОткрытия, ЭтаФорма);\t\n\t\nКонецПроцедуры\n\n&НаСервере\nФункция ПолучитьКомпоновщикНастроек()\n\tВозврат Отчеты.ит_ОписьАктовПП.Создать().КомпоновщикНастроек;\nКонецФункции\n\nКомпоновкаДанныхКлиентСервер.УстановитьПараметр(Настройки, \"ДатаКонца\", ТекущаяДата());\n\nЭлементНастройки = Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(\"ДатаКонца\"));\n\tЭлементНастройки.Значение = ТекущаяДата();\n\tЭлементНастройки.Использование = Истина;\n\nКомпоновкаДанныхКлиентСервер.ДобавитьОтбор(Настройки, \"ИмяРеквизита\", ЗначениеРеквизита, ВидСравненияКомпоновкиДанных.Равно);"
  },
  {
    "title": "Показать подтверждение закрытия Формы",
    "description": "Показать подтверждение закрытия ФормыВсе",
    "code_snippet": "&НаКлиенте\nПроцедура ПередЗакрытием(Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка)\n\tТекстПредупреждения = \"Закрыть форму?\";\n\tОповещение = Новый ОписаниеОповещения(\"ВыбратьИЗакрыть\", ЭтотОбъект);\n\tОбщегоНазначенияКлиент.ПоказатьПодтверждениеЗакрытияПроизвольнойФормы(ЭтотОбъект, Отказ, ЗавершениеРаботы, ТекстПредупреждения, \"ЗакрытьФормуБезПодтверждения\", Оповещение);\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ВыбратьИЗакрыть(Результат = Неопределено, ДополнительныеПараметры = Неопределено) Экспорт\n   ЗакрытьФормуБезПодтверждения = Истина;\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ПередЗакрытием(Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка)\n   Оповещение = Новый ОписаниеОповещения(\"ВыбратьИЗакрыть\", ЭтотОбъект);\n   ОбщегоНазначенияКлиент.ПоказатьПодтверждениеЗакрытияФормы(Оповещение, Отказ, ЗавершениеРаботы);\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ВыбратьИЗакрыть(Результат = Неопределено, ДополнительныеПараметры = Неопределено) Экспорт\n   // записываем данные формы.\n   // ...\n   Модифицированность = Ложь; // не выводить подтверждение о закрытии формы еще раз.\n   Закрыть();\nКонецПроцедуры"
  },
  {
    "title": "Конвертировать объект в структуру",
    "description": "Конвертировать объект в структуру",
    "code_snippet": "// Возвращает структуру реквизитов объекта или ссылки, включая стандартные реквизиты и реквизиты табличной части.\r\n// Можно использовать, если необходимо, например, эмулировать вызов метода, использующего объект формы.\r\n//\r\n// Параметры:\r\n//  ВходящийОбъект - ЛюбаяСсылка или ЛюбойОбъект\r\n// \r\n// Возвращаемое значение:\r\n//  Структура\r\n//\r\nФункция КонвертироватьОбъектВСтруктуру(ВходящийОбъект)\r\n\r\n   СтруктураОбъекта = Новый Структура;\r\n\r\n   СтандартныеРеквизитыОбъекта = ВходящийОбъект.Метаданные().СтандартныеРеквизиты;\r\n   Для Каждого СтандартныйРеквизит Из СтандартныеРеквизитыОбъекта Цикл\r\n       СтруктураОбъекта.Вставить(СтандартныйРеквизит.Имя, ВходящийОбъект[СтандартныйРеквизит.Имя]);\r\n   КонецЦикла;\r\n\r\n   РеквизитыОбъекта = ВходящийОбъект.Метаданные().Реквизиты;\r\n   Для Каждого Реквизит Из РеквизитыОбъекта Цикл\r\n       СтруктураОбъекта.Вставить(Реквизит.Имя, ВходящийОбъект[Реквизит.Имя]);\r\n   КонецЦикла;\r\n\r\n   ТЧ = ВходящийОбъект.Метаданные().ТабличныеЧасти;\r\n   Для Каждого ТаблЧасть Из ТЧ Цикл\r\n       ТЗ = ВходящийОбъект[ТаблЧасть.Имя].Выгрузить();\r\n       Массив = ОбщегоНазначения.ТаблицаЗначенийВМассив(ТЗ);\r\n       СтруктураОбъекта.Вставить(ТаблЧасть.Имя, Массив);\r\n   КонецЦикла;\r\n\r\n   Возврат СтруктураОбъекта;\r\n\r\nКонецФункции\n\n// Возвращает структуру реквизитов объекта или ссылки, включая стандартные реквизиты и реквизиты табличной части.\r\n// Можно использовать, если необходимо, например, эмулировать вызов метода, использующего объект формы.\r\n//\r\n// Параметры:\r\n//  ВходящийОбъект - ЛюбаяСсылка или ЛюбойОбъект\r\n// \r\n// Возвращаемое значение:\r\n//  Структура\r\n//\r\nФункция КонвертироватьОбъектВСтруктуру(ВходящийОбъект)\r\n\r\n   СтруктураОбъекта = Новый Структура;\r\n\r\n   СтандартныеРеквизитыОбъекта = ВходящийОбъект.Метаданные().СтандартныеРеквизиты;\r\n   Для Каждого СтандартныйРеквизит Из СтандартныеРеквизитыОбъекта Цикл\r\n       СтруктураОбъекта.Вставить(СтандартныйРеквизит.Имя, ВходящийОбъект[СтандартныйРеквизит.Имя]);\r\n   КонецЦикла;\r\n\r\n   РеквизитыОбъекта = ВходящийОбъект.Метаданные().Реквизиты;\r\n   Для Каждого Реквизит Из РеквизитыОбъекта Цикл\r\n       СтруктураОбъекта.Вставить(Реквизит.Имя, ВходящийОбъект[Реквизит.Имя]);\r\n   КонецЦикла;\r\n\r\n   ТЧ = ВходящийОбъект.Метаданные().ТабличныеЧасти;\r\n   Для Каждого ТаблЧасть Из ТЧ Цикл\r\n       ТЗ = ВходящийОбъект[ТаблЧасть.Имя].Выгрузить();\r\n       Массив = ОбщегоНазначения.ТаблицаЗначенийВМассив(ТЗ);\r\n       СтруктураОбъекта.Вставить(ТаблЧасть.Имя, Массив);\r\n   КонецЦикла;\r\n\r\n   Возврат СтруктураОбъекта;\r\n\r\nКонецФункции"
  },
  {
    "title": "Отправка писем с приложением эксель для БП",
    "description": "Отправка писем с приложением эксель для БП",
    "code_snippet": "Процедура СформироатьТабДок()\r\n\tТабДок = Новый ТабличныйДокумент;  \r\n\tОблШапка = Макет.ПолучитьОбласть(\"Шапка\");\r\n\tТабДок.Вывести(ОблШапка);\r\n\tПотокВПамяти = Новый ПотокВПамяти();\r\n\tТабДок.Записать(ПотокВПамяти, ТипФайлаТабличногоДокумента.XLSX); \r\n\tДвоичныеДанные = ПотокВПамяти.ЗакрытьИПолучитьДвоичныеДанные();\r\n\tТема = \"Тема от: \"+Строка(Формат(ТекущаяДата()-86400, \"ДФ=dd.MM.yyyy\"));\r\n\tТекстПисьма = \"\";\r\n\tОтправитьEmail(\"Адрес отправки\", , Тема, ТекстПисьма, ДвоичныеДанные, \"Имя отправителя\");\r\nКонецПроцедуры   \r\n\r\n&НаСервере\r\nПроцедура ОтправитьEmail(АдресПочты, Копия = Неопределено, Тема, ТекстПисьма, Вложение = Неопределено, ИмяОтправителя) \r\n\tПрофиль  = Новый ИнтернетПочтовыйПрофиль;\r\n\tПрофиль.АдресСервераIMAP = \"imap.mail.ru\";\r\n\tПрофиль.АдресСервераSMTP = \"smtp.mail.ru\";\r\n\tПрофиль.ПортSMTP = 465;\r\n\tПрофиль.ПортIMAP = 993;\r\n\tСообщение = Новый ИнтернетПочтовоеСообщение;\r\n\tПрофиль.Пользователь = \"Пользователь\";\r\n\tПрофиль.Пароль = \"Пароль\";\r\n\tПрофиль.ПользовательSMTP = \"ПользовательSMTP\";\r\n\tПрофиль.ПарольSMTP = \"ПарольSMTP\";\r\n\tСообщение.Отправитель.Адрес = \"Адрес\";\r\n\tСообщение.ИмяОтправителя = ИмяОтправителя;\r\n\tПрофиль.ИспользоватьSSLSMTP = Истина;\r\n\tСообщение.Получатели.Добавить(АдресПочты);\r\n\tСообщение.Тема = Тема;\r\n\tСообщение.Тексты.Добавить(ТекстПисьма, ТипТекстаПочтовогоСообщения.ПростойТекст); \r\n\tЕсли Вложение <> Неопределено тогда                           \r\n\t\tТема = Тема+\".xlsx\";\r\n\t\tСообщение.Вложения.Добавить(Вложение,Тема);\r\n\tКонецЕсли;\r\n\tПочта = Новый ИнтернетПочта;\r\n\tПопытка\r\n\t\tПочта.Подключиться(Профиль); \r\n\t\tПочта.Послать(Сообщение);\r\n\t\tПочта.Отключиться();\r\n\tИсключение\r\n\t\tСообщить(ОписаниеОшибки());\r\n\tКонецПопытки;\r\nКонецПроцедуры\n\nПроцедура СформироатьТабДок()\r\n\tТабДок = Новый ТабличныйДокумент;  \r\n\tОблШапка = Макет.ПолучитьОбласть(\"Шапка\");\r\n\tТабДок.Вывести(ОблШапка);\r\n\tПотокВПамяти = Новый ПотокВПамяти();\r\n\tТабДок.Записать(ПотокВПамяти, ТипФайлаТабличногоДокумента.XLSX); \r\n\tДвоичныеДанные = ПотокВПамяти.ЗакрытьИПолучитьДвоичныеДанные();\r\n\tТема = \"Тема от: \"+Строка(Формат(ТекущаяДата()-86400, \"ДФ=dd.MM.yyyy\"));\r\n\tТекстПисьма = \"\";\r\n\tОтправитьEmail(\"Адрес отправки\", , Тема, ТекстПисьма, ДвоичныеДанные, \"Имя отправителя\");\r\nКонецПроцедуры   \r\n\r\n&НаСервере\r\nПроцедура ОтправитьEmail(АдресПочты, Копия = Неопределено, Тема, ТекстПисьма, Вложение = Неопределено, ИмяОтправителя) \r\n\tПрофиль  = Новый ИнтернетПочтовыйПрофиль;\r\n\tПрофиль.АдресСервераIMAP = \"imap.mail.ru\";\r\n\tПрофиль.АдресСервераSMTP = \"smtp.mail.ru\";\r\n\tПрофиль.ПортSMTP = 465;\r\n\tПрофиль.ПортIMAP = 993;\r\n\tСообщение = Новый ИнтернетПочтовоеСообщение;\r\n\tПрофиль.Пользователь = \"Пользователь\";\r\n\tПрофиль.Пароль = \"Пароль\";\r\n\tПрофиль.ПользовательSMTP = \"ПользовательSMTP\";\r\n\tПрофиль.ПарольSMTP = \"ПарольSMTP\";\r\n\tСообщение.Отправитель.Адрес = \"Адрес\";\r\n\tСообщение.ИмяОтправителя = ИмяОтправителя;\r\n\tПрофиль.ИспользоватьSSLSMTP = Истина;\r\n\tСообщение.Получатели.Добавить(АдресПочты);\r\n\tСообщение.Тема = Тема;\r\n\tСообщение.Тексты.Добавить(ТекстПисьма, ТипТекстаПочтовогоСообщения.ПростойТекст); \r\n\tЕсли Вложение <> Неопределено тогда                           \r\n\t\tТема = Тема+\".xlsx\";\r\n\t\tСообщение.Вложения.Добавить(Вложение,Тема);\r\n\tКонецЕсли;\r\n\tПочта = Новый ИнтернетПочта;\r\n\tПопытка\r\n\t\tПочта.Подключиться(Профиль); \r\n\t\tПочта.Послать(Сообщение);\r\n\t\tПочта.Отключиться();\r\n\tИсключение\r\n\t\tСообщить(ОписаниеОшибки());\r\n\tКонецПопытки;\r\nКонецПроцедуры\n\nОрфографическая ошибка в эксель (найдено 2): эксель\r\nОрфографическая ошибка в СформироатьТабДок: Сформироать\r\nОрфографическая ошибка в smtp: smtp"
  },
  {
    "title": "Сколько процентов число от числа",
    "description": "Сколько процентов число от числа",
    "code_snippet": "// Сколько процентов число от числа\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/151\r\n// \r\n// Параметры:\r\n//  Число - Число\r\n//  ОтЧисла - Число\r\n//  ОкруглятьДо - Число - Количество знаков округления, 0 - не требуется\r\n// \r\n// Возвращаемое значение:\r\n//  Число\r\n//\r\n// Пример:\r\n//  Процент = СколькоПроцентовЧислоОтЧисла(10, 100);  // 10\r\n//  Процент = СколькоПроцентовЧислоОтЧисла(9, 69, 2); // 13.04\r\n//\r\nФункция СколькоПроцентовЧислоОтЧисла(\r\n\tЗнач Число, Знач ОтЧисла, Знач ОкруглятьДо = 0) Экспорт\r\n\t\r\n\tЕсли ОтЧисла = 0 Тогда\r\n\t\tВозврат 0;\r\n\tКонецЕсли;\r\n\t\r\n\tРезультат = (Число / ОтЧисла) * 100;\r\n\t\r\n\tЕсли ОкруглятьДо > 0 Тогда\r\n\t\tРезультат = Окр(Результат, ОкруглятьДо);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\n// Сколько процентов число от числа\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/151\r\n// \r\n// Параметры:\r\n//  Число - Число\r\n//  ОтЧисла - Число\r\n//  ОкруглятьДо - Число - Количество знаков округления, 0 - не требуется\r\n// \r\n// Возвращаемое значение:\r\n//  Число\r\n//\r\n// Пример:\r\n//  Процент = СколькоПроцентовЧислоОтЧисла(10, 100);  // 10\r\n//  Процент = СколькоПроцентовЧислоОтЧисла(9, 69, 2); // 13.04\r\n//\r\nФункция СколькоПроцентовЧислоОтЧисла(\r\n\tЗнач Число, Знач ОтЧисла, Знач ОкруглятьДо = 0) Экспорт\r\n\t\r\n\tЕсли ОтЧисла = 0 Тогда\r\n\t\tВозврат 0;\r\n\tКонецЕсли;\r\n\t\r\n\tРезультат = (Число / ОтЧисла) * 100;\r\n\t\r\n\tЕсли ОкруглятьДо > 0 Тогда\r\n\t\tРезультат = Окр(Результат, ОкруглятьДо);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nФункция СколькоПроцентовЧислоОтЧисла(\n\tЗнач Число, Знач ОтЧисла, Знач ОкруглятьДо = Неопределено) Экспорт\n\t\n\tЕсли ОтЧисла = 0 Тогда\n\t\tВозврат 0;\n\tКонецЕсли;\n\t\n\tРезультат = (Число / ОтЧисла) * 100;\n\t\n\tЕсли ОкруглятьДо <> Неопределено Тогда\n\t\tРезультат = Окр(Результат, ОкруглятьДо);\n\tКонецЕсли;\n\t\n\tВозврат Результат;\n\t\nКонецФункции"
  },
  {
    "title": "Копия массива",
    "description": "Копия массива",
    "code_snippet": "// Возвращает копию массива с указанием числа элементов и начального индекса\r\n// Внутри есть определение метода копирования\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/150\r\n// \r\n// Параметры:\r\n//  Массив - Массив из Произвольный\r\n//  НачальныйЭлемент - Число - Индекс начального элемента\r\n//  ЧислоЭлементов - Число - Число выбираемых элементов, 0 - все оставшиеся\r\n//  МетодКопирования - Число - 0 - определять автоматически, 1 - наполнение циклом, 2 - удаление лишних\r\n// \r\n// Возвращаемое значение:\r\n//  Массив из Произвольный\r\n//\r\n// Примеры:\r\n//  ИсходныйМассив = СтрРазделить(\"1,2,3,4,5\", \",\");\r\n//  Результат = КопияМассива(ИсходныйМассив, 1, 3); //\"2,3,4\"     - Три элемента с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 1);    //\"2,3,4,5\"   - Все элементы с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 0, 2); //\"1,2\"       - Первые 2 элемента\r\n//  Результат = КопияМассива(ИсходныйМассив);       //\"1,2,3,4,5\" - Полная копия массива\r\n//  \r\nФункция КопияМассива(Знач Массив, Знач НачальныйЭлемент = 0, Знач ЧислоЭлементов = 0, Знач МетодКопирования = 0) Экспорт\r\n\t\r\n\tВсегоЭлементов = Массив.Количество();\r\n\t\r\n\tЕсли МетодКопирования = 0 Тогда\r\n\t\r\n\t\t//Если массив меньше, то нет принципиально разницы в скорости\r\n\t\t//TODO: Определить экспериментально идеальное значение\r\n\t\tМинимальнаяДлинаМассиваДляПоискаМетода = 10;\r\n\t\tЕсли ВсегоЭлементов > МинимальнаяДлинаМассиваДляПоискаМетода Тогда\r\n\t\t\r\n\t\t\tЕсли ЧислоЭлементов = 0 Тогда\r\n\t\t\t\tЧислоЭлементов = ВсегоЭлементов - (НачальныйЭлемент + 1);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tЕсли ЧислоЭлементов = 0 Тогда\r\n\t\t\t\tВозврат Новый Массив;\r\n\t\t\tИначе\r\n\t\t\t\tПроцентНужных = (ЧислоЭлементов / ВсегоЭлементов) * 100;\r\n\t\t\t\tЕсли ПроцентНужных > 90 Тогда\r\n\t\t\t\t\tМетодКопирования = 2; //Легче скопировать весь большой массив и удалить лишние элементы\r\n\t\t\t\tИначе\r\n\t\t\t\t\tМетодКопирования = 1; //Легче взять нужные элементы из большого массива\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\r\n\t\tИначе\r\n\t\t\t\r\n\t\t\tМетодКопирования = 1; //Устроит любой метод\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли МетодКопирования = 1 Тогда\r\n\t\tКопияМассива = КопияМассиваНаполнением(Массив, НачальныйЭлемент, ЧислоЭлементов);\r\n\tИначе\r\n\t\tКопияМассива = КопияМассиваУдалениемЛишних(Массив, НачальныйЭлемент, ЧислоЭлементов);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат КопияМассива;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает копию массива с указанием числа элементов и начального индекса\r\n// Создает полную копию и удаления лишние элементы\r\n// Эффективен, когда нужно взять бОльшую часть большОго массива\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/150\r\n// \r\n// Параметры:\r\n//  Массив - Массив из Произвольный\r\n//  НачальныйЭлемент - Число - Индекс начального элемента\r\n//  ЧислоЭлементов - Число - Число выбираемых элементов, 0 - все оставшиеся\r\n// \r\n// Возвращаемое значение:\r\n//  Массив из Произвольный\r\n//  \r\n// Примеры:\r\n//  ИсходныйМассив = СтрРазделить(\"1,2,3,4,5\", \",\");\r\n//  Результат = КопияМассива(ИсходныйМассив, 1, 3); //\"2,3,4\"     - Три элемента с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 1);    //\"2,3,4,5\"   - Все элементы с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 0, 2); //\"1,2\"       - Первые 2 элемента\r\n//  Результат = КопияМассива(ИсходныйМассив);       //\"1,2,3,4,5\" - Полная копия массива\r\nФункция КопияМассиваУдалениемЛишних(Знач Массив, \r\n\tЗнач НачальныйЭлемент = 0, Знач ЧислоЭлементов = 0) Экспорт\r\n\t\r\n\tКопияМассива = Новый Массив(Новый ФиксированныйМассив(Массив));\r\n\t\r\n\tПока НачальныйЭлемент > 0 Цикл\r\n\t\tКопияМассива.Удалить(0);\r\n\t\tНачальныйЭлемент = НачальныйЭлемент - 1;\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли ЧислоЭлементов > 0 Тогда\r\n\t\tЭлементовКУдалению = КопияМассива.Количество() - ЧислоЭлементов;\r\n\t\tПока ЭлементовКУдалению > 0 Цикл\r\n\t\t\tКопияМассива.Удалить(КопияМассива.ВГраница());\r\n\t\t\tЭлементовКУдалению = ЭлементовКУдалению - 1;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат КопияМассива;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает копию массива с указанием числа элементов и начального индекса\r\n// Создает пустой массив и наполняет его циклом из оригинала\r\n// Эффективен, когда нужно взять несколько элементов из оригинального большого массива\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/150\r\n// \r\n// Параметры:\r\n//  Массив - Массив из Произвольный\r\n//  НачальныйЭлемент - Число - Индекс начального элемента\r\n//  ЧислоЭлементов - Число - Число выбираемых элементов, 0 - все оставшиеся\r\n// \r\n// Возвращаемое значение:\r\n//  Массив из Произвольный\r\n//  \r\n// Примеры:\r\n//  ИсходныйМассив = СтрРазделить(\"1,2,3,4,5\", \",\");\r\n//  Результат = КопияМассива(ИсходныйМассив, 1, 3); //\"2,3,4\"     - Три элемента с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 1);    //\"2,3,4,5\"   - Все элементы с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 0, 2); //\"1,2\"       - Первые 2 элемента\r\n//  Результат = КопияМассива(ИсходныйМассив);       //\"1,2,3,4,5\" - Полная копия массива\r\nФункция КопияМассиваНаполнением(Знач Массив, \r\n\tЗнач НачальныйЭлемент = 0, Знач ЧислоЭлементов = 0) Экспорт\r\n\t\r\n\tЕсли ЧислоЭлементов = 0 Тогда\r\n\t\tЧислоЭлементов = Массив.Количество() - НачальныйЭлемент;\r\n\tКонецЕсли;\r\n\t\r\n\tКопияМассива = Новый Массив(ЧислоЭлементов);\r\n\t\r\n\tИндексКопии = 0;\r\n\tИндексМассива = НачальныйЭлемент;\r\n\t\r\n\tПока ИндексКопии < ЧислоЭлементов Цикл\r\n\t\t\r\n\t\tКопияМассива[ИндексКопии] = Массив[ИндексМассива];\r\n\t\t\r\n\t\tИндексМассива = ИндексМассива + 1;\r\n\t\tИндексКопии = ИндексКопии + 1;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат КопияМассива;\r\n\t\r\nКонецФункции\n\n// Возвращает копию массива с указанием числа элементов и начального индекса\r\n// Внутри есть определение метода копирования\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/150\r\n// \r\n// Параметры:\r\n//  Массив - Массив из Произвольный\r\n//  НачальныйЭлемент - Число - Индекс начального элемента\r\n//  ЧислоЭлементов - Число - Число выбираемых элементов, 0 - все оставшиеся\r\n//  МетодКопирования - Число - 0 - определять автоматически, 1 - наполнение циклом, 2 - удаление лишних\r\n// \r\n// Возвращаемое значение:\r\n//  Массив из Произвольный\r\n//\r\n// Примеры:\r\n//  ИсходныйМассив = СтрРазделить(\"1,2,3,4,5\", \",\");\r\n//  Результат = КопияМассива(ИсходныйМассив, 1, 3); //\"2,3,4\"     - Три элемента с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 1);    //\"2,3,4,5\"   - Все элементы с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 0, 2); //\"1,2\"       - Первые 2 элемента\r\n//  Результат = КопияМассива(ИсходныйМассив);       //\"1,2,3,4,5\" - Полная копия массива\r\n//  \r\nФункция КопияМассива(Знач Массив, Знач НачальныйЭлемент = 0, Знач ЧислоЭлементов = 0, Знач МетодКопирования = 0) Экспорт\r\n\t\r\n\tВсегоЭлементов = Массив.Количество();\r\n\t\r\n\tЕсли МетодКопирования = 0 Тогда\r\n\t\r\n\t\t//Если массив меньше, то нет принципиально разницы в скорости\r\n\t\t//TODO: Определить экспериментально идеальное значение\r\n\t\tМинимальнаяДлинаМассиваДляПоискаМетода = 10;\r\n\t\tЕсли ВсегоЭлементов > МинимальнаяДлинаМассиваДляПоискаМетода Тогда\r\n\t\t\r\n\t\t\tЕсли ЧислоЭлементов = 0 Тогда\r\n\t\t\t\tЧислоЭлементов = ВсегоЭлементов - (НачальныйЭлемент + 1);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tЕсли ЧислоЭлементов = 0 Тогда\r\n\t\t\t\tВозврат Новый Массив;\r\n\t\t\tИначе\r\n\t\t\t\tПроцентНужных = (ЧислоЭлементов / ВсегоЭлементов) * 100;\r\n\t\t\t\tЕсли ПроцентНужных > 90 Тогда\r\n\t\t\t\t\tМетодКопирования = 2; //Легче скопировать весь большой массив и удалить лишние элементы\r\n\t\t\t\tИначе\r\n\t\t\t\t\tМетодКопирования = 1; //Легче взять нужные элементы из большого массива\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\r\n\t\tИначе\r\n\t\t\t\r\n\t\t\tМетодКопирования = 1; //Устроит любой метод\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли МетодКопирования = 1 Тогда\r\n\t\tКопияМассива = КопияМассиваНаполнением(Массив, НачальныйЭлемент, ЧислоЭлементов);\r\n\tИначе\r\n\t\tКопияМассива = КопияМассиваУдалениемЛишних(Массив, НачальныйЭлемент, ЧислоЭлементов);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат КопияМассива;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает копию массива с указанием числа элементов и начального индекса\r\n// Создает полную копию и удаления лишние элементы\r\n// Эффективен, когда нужно взять бОльшую часть большОго массива\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/150\r\n// \r\n// Параметры:\r\n//  Массив - Массив из Произвольный\r\n//  НачальныйЭлемент - Число - Индекс начального элемента\r\n//  ЧислоЭлементов - Число - Число выбираемых элементов, 0 - все оставшиеся\r\n// \r\n// Возвращаемое значение:\r\n//  Массив из Произвольный\r\n//  \r\n// Примеры:\r\n//  ИсходныйМассив = СтрРазделить(\"1,2,3,4,5\", \",\");\r\n//  Результат = КопияМассива(ИсходныйМассив, 1, 3); //\"2,3,4\"     - Три элемента с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 1);    //\"2,3,4,5\"   - Все элементы с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 0, 2); //\"1,2\"       - Первые 2 элемента\r\n//  Результат = КопияМассива(ИсходныйМассив);       //\"1,2,3,4,5\" - Полная копия массива\r\nФункция КопияМассиваУдалениемЛишних(Знач Массив, \r\n\tЗнач НачальныйЭлемент = 0, Знач ЧислоЭлементов = 0) Экспорт\r\n\t\r\n\tКопияМассива = Новый Массив(Новый ФиксированныйМассив(Массив));\r\n\t\r\n\tПока НачальныйЭлемент > 0 Цикл\r\n\t\tКопияМассива.Удалить(0);\r\n\t\tНачальныйЭлемент = НачальныйЭлемент - 1;\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли ЧислоЭлементов > 0 Тогда\r\n\t\tЭлементовКУдалению = КопияМассива.Количество() - ЧислоЭлементов;\r\n\t\tПока ЭлементовКУдалению > 0 Цикл\r\n\t\t\tКопияМассива.Удалить(КопияМассива.ВГраница());\r\n\t\t\tЭлементовКУдалению = ЭлементовКУдалению - 1;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат КопияМассива;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает копию массива с указанием числа элементов и начального индекса\r\n// Создает пустой массив и наполняет его циклом из оригинала\r\n// Эффективен, когда нужно взять несколько элементов из оригинального большого массива\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/150\r\n// \r\n// Параметры:\r\n//  Массив - Массив из Произвольный\r\n//  НачальныйЭлемент - Число - Индекс начального элемента\r\n//  ЧислоЭлементов - Число - Число выбираемых элементов, 0 - все оставшиеся\r\n// \r\n// Возвращаемое значение:\r\n//  Массив из Произвольный\r\n//  \r\n// Примеры:\r\n//  ИсходныйМассив = СтрРазделить(\"1,2,3,4,5\", \",\");\r\n//  Результат = КопияМассива(ИсходныйМассив, 1, 3); //\"2,3,4\"     - Три элемента с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 1);    //\"2,3,4,5\"   - Все элементы с индекса 1\r\n//  Результат = КопияМассива(ИсходныйМассив, 0, 2); //\"1,2\"       - Первые 2 элемента\r\n//  Результат = КопияМассива(ИсходныйМассив);       //\"1,2,3,4,5\" - Полная копия массива\r\nФункция КопияМассиваНаполнением(Знач Массив, \r\n\tЗнач НачальныйЭлемент = 0, Знач ЧислоЭлементов = 0) Экспорт\r\n\t\r\n\tЕсли ЧислоЭлементов = 0 Тогда\r\n\t\tЧислоЭлементов = Массив.Количество() - НачальныйЭлемент;\r\n\tКонецЕсли;\r\n\t\r\n\tКопияМассива = Новый Массив(ЧислоЭлементов);\r\n\t\r\n\tИндексКопии = 0;\r\n\tИндексМассива = НачальныйЭлемент;\r\n\t\r\n\tПока ИндексКопии < ЧислоЭлементов Цикл\r\n\t\t\r\n\t\tКопияМассива[ИндексКопии] = Массив[ИндексМассива];\r\n\t\t\r\n\t\tИндексМассива = ИндексМассива + 1;\r\n\t\tИндексКопии = ИндексКопии + 1;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат КопияМассива;\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в бОльшую: Ольшую\r\nОрфографическая ошибка в большОго: больш"
  },
  {
    "title": "Построчный обход макета",
    "description": "Построчный обход макета",
    "code_snippet": "Макет = РеквизитФормыВЗначение(\"Объект\").ПолучитьМакет(\"Макет\");\r\n\tДля Стр=1 По Макет.ВысотаТаблицы Цикл\t\t\r\n\t\tКод=Макет.Область(Стр, 1).Текст; \r\n\tКонецЦикла;\n\nМакет = РеквизитФормыВЗначение(\"Объект\").ПолучитьМакет(\"Макет\");\r\n\tДля Стр=1 По Макет.ВысотаТаблицы Цикл\t\t\r\n\t\tКод=Макет.Область(Стр, 1).Текст; \r\n\tКонецЦикла;\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Запуск внешнего отчета в сформированном виде",
    "description": "Запуск внешнего отчета в сформированном виде",
    "code_snippet": "&НаКлиенте\r\nПроцедура ИнформацияПоЗданиям(Команда)\r\n\r\n\tВнешнийОтчетОбработкаДляОткрытияСсылка = СсылкаНаВнешнийОтчетОбработкуПоИмениНаСервере(\"Информация по зданиям\");\r\n\tЕсли Не ЗначениеЗаполнено(ВнешнийОтчетОбработкаДляОткрытияСсылка) Тогда\r\n\t\tСообщить(\"Отчет не найден\");\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n    \r\n    ИмяОбработкиСлужебное = ДополнительныеОтчетыИОбработкиВызовСервера.ПодключитьВнешнююОбработку(ВнешнийОтчетОбработкаДляОткрытияСсылка);\r\n    \r\n    ПараметрыФормы = Новый Структура;\r\n    \r\n    ПараметрыФормы.Вставить(\"КлючВарианта\", \"Основной\");\r\n    ПараметрыФормы.Вставить(\"СформироватьПриОткрытии\", Истина);\r\n    \r\n    ОткрытьФорму(\"ВнешнийОтчет.\" + ИмяОбработкиСлужебное + \".Форма\", ПараметрыФормы, ЭтаФорма);\r\n\r\nКонецПроцедуры\r\n\r\n&НаСервереБезКонтекста\r\nФункция СсылкаНаВнешнийОтчетОбработкуПоИмениНаСервере(ИмяОтчетаОбработки)\r\n    Возврат Справочники.ДополнительныеОтчетыИОбработки.НайтиПоНаименованию(ИмяОтчетаОбработки).Ссылка;\r\nКонецФункции\n\n&НаКлиенте\r\nПроцедура ИнформацияПоЗданиям(Команда)\r\n\r\n\tВнешнийОтчетОбработкаДляОткрытияСсылка = СсылкаНаВнешнийОтчетОбработкуПоИмениНаСервере(\"Информация по зданиям\");\r\n\tЕсли Не ЗначениеЗаполнено(ВнешнийОтчетОбработкаДляОткрытияСсылка) Тогда\r\n\t\tСообщить(\"Отчет не найден\");\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n    \r\n    ИмяОбработкиСлужебное = ДополнительныеОтчетыИОбработкиВызовСервера.ПодключитьВнешнююОбработку(ВнешнийОтчетОбработкаДляОткрытияСсылка);\r\n    \r\n    ПараметрыФормы = Новый Структура;\r\n    \r\n    ПараметрыФормы.Вставить(\"КлючВарианта\", \"Основной\");\r\n    ПараметрыФормы.Вставить(\"СформироватьПриОткрытии\", Истина);\r\n    \r\n    ОткрытьФорму(\"ВнешнийОтчет.\" + ИмяОбработкиСлужебное + \".Форма\", ПараметрыФормы, ЭтаФорма);\r\n\r\nКонецПроцедуры\r\n\r\n&НаСервереБезКонтекста\r\nФункция СсылкаНаВнешнийОтчетОбработкуПоИмениНаСервере(ИмяОтчетаОбработки)\r\n    Возврат Справочники.ДополнительныеОтчетыИОбработки.НайтиПоНаименованию(ИмяОтчетаОбработки).Ссылка;\r\nКонецФункции"
  },
  {
    "title": "Добавление команды в общую форму отчета на БСП",
    "description": "Добавление команды в общую форму отчета на БСПВсе",
    "code_snippet": "Процедура НастроитьВариантыОтчетов(Настройки) Экспорт\n\tВариантыОтчетов.НастроитьОтчетВМодулеМенеджера(Настройки, Метаданные.Отчеты.тдс_ОтчетПоДебиторскойЗадолженности);\nКонецПроцедуры\n\nПроцедура НастроитьВариантыОтчета(Настройки, НастройкиОтчета) Экспорт\n\tНастройкиОтчета.ОпределитьНастройкиФормы = Истина;\nКонецПроцедуры\n\nПроцедура ОпределитьНастройкиФормы(Форма, КлючВарианта, Настройки) Экспорт\n\tНастройки.События.ПриСозданииНаСервере = Истина;\nКонецПроцедуры\n\nПроцедура ПриСозданииНаСервере(Форма, Отказ, СтандартнаяОбработка) Экспорт\n\n\tНоваяКоманда = Форма.Команды.Добавить(\"ИсходныеДанные\");\n\tНоваяКоманда.Заголовок = \"Исходные данные\";\n\tНоваяКоманда.Действие = \"ит_УправлениеФормамиКлиентСервер.ВыгрузитьСКДвТаблицуЗначений\";\n\tНоваяКоманда.Картинка = БиблиотекаКартинок.ФорматExcel;\n\tНоваяКоманда.Отображение = ОтображениеКнопки.КартинкаИТекст;\n\n\tОтчетыСервер.ВывестиКоманду(Форма, НоваяКоманда, \"Интеграция\");\n\t\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ВыгрузитьСКДвТаблицуЗначений(ФормаОтчета, Команда) Экспорт\n\t// ваш код команды\nКонецПроцедуры"
  },
  {
    "title": "Преобразование отчета на СКД в таблицу значений на табличном документе",
    "description": "Преобразование отчета на СКД в таблицу значений на табличном документеЛайфхаки 1С",
    "code_snippet": "&НаСервере\nПроцедура ВыгрузитьПлоскуюТаблицуНаСервере()\n\n\tРезультат = Новый ТаблицаЗначений;\n\t\n\tПопытка \n\t\t\n\t\tОтчетОбъект = РеквизитФормыВЗначение(\"Отчет\");\n\t\tСхемаКомпоновкиДанных = ОтчетОбъект.СхемаКомпоновкиДанных;\n\t\tНастройки = Отчет.КомпоновщикНастроек.ПолучитьНастройки();\n\t\t\n\t\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\n\n\t\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, Настройки,,, Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\n\t\t\t\t\t\t\n\t\tПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;\n\t\tПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновки);\t\n\n\t\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\n\t\tПроцессорВывода.УстановитьОбъект(Результат);\n\t\tПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных, Истина);\n\t\t\n\t\tОтчетТабличныйДокумент.Очистить();\n\t\tПостроитель = Новый ПостроительОтчета;\n\t\tПостроитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(Результат);\n\t\tПостроитель.Вывести(ОтчетТабличныйДокумент);\n        \n \tИсключение\n\t\tСообщить(\"Не удалось отобразить исходные данные, возможно выводятся несколько разнородных таблиц.\n\t\t\t\t |Перейдите в настройки и оставьте только одну необходимую таблицу.\");\n\tКонецПопытки;\n\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ВыгрузитьПлоскуюТаблицу(Команда)\n\tВыгрузитьПлоскуюТаблицуНаСервере();\nКонецПроцедуры"
  },
  {
    "title": "ЗначениеПеречисленияПоСинониму",
    "description": "ЗначениеПеречисленияПоСинониму",
    "code_snippet": "// <Описание функции>\n//\n// Параметры:\n//  <СинонимПеречисления>  - <Тип.Строка> - Синоним перечисления\n//                 \n//  <ИмяПеречисления>  - <Тип.Строка> - Имя метаданных перечисления в базе\n//                 \n// Возвращаемое значение:\n//   <ЗначениеПеречисления>\n//\n&НаСервере\nФункция ЗначениеПеречисленияПоСинониму(СинонимПеречисления, ИмяПеречисления)\n\t\t\n\tСоответствиеУсловий = Новый Соответствие;\n\t\n\tДля Каждого СтрМета из Метаданные.Перечисления[ИмяПеречисления].ЗначенияПеречисления Цикл\n        СоответствиеУсловий.Вставить(СтрМета.Синоним,СтрМета.Имя);\n\tКонецЦикла;\n\t\n\tВозврат Перечисления[ИмяПеречисления][СоответствиеУсловий[СинонимПеречисления]];\n\t\nКонецФункции"
  },
  {
    "title": "Скрипт автодополнения в стиле Vim (VimComplete)",
    "description": "Скрипт автодополнения в стиле Vim (VimComplete)",
    "code_snippet": ""
  },
  {
    "title": "Скрипт по командам для работы с отладкой (debugHelpers)",
    "description": "Скрипт по командам для работы с отладкой (debugHelpers)",
    "code_snippet": ""
  },
  {
    "title": "Замер времени выполнения кода с выводом результата замера в формате ЧЧ:мм:сс",
    "description": "Замер времени выполнения кода с выводом результата замера в формате ЧЧ:мм:сс",
    "code_snippet": "ДатаНачала = ТекущаяУниверсальнаяДатаВМиллисекундах();\r\n// Какой-то код\r\nДельта = (ТекущаяУниверсальнаяДатаВМиллисекундах() - ДатаНачала)/1000;\r\nВремяВыполнения = Формат(Дата(1,1,1) + Дельта, \"ДЛФ=T\");\r\nСообщить(ВремяВыполнения);\n\nДатаНачала = ТекущаяУниверсальнаяДатаВМиллисекундах();\r\n// Какой-то код\r\nДельта = (ТекущаяУниверсальнаяДатаВМиллисекундах() - ДатаНачала)/1000;\r\nВремяВыполнения = Формат(Дата(1,1,1) + Дельта, \"ДЛФ=T\");\r\nСообщить(ВремяВыполнения);"
  },
  {
    "title": "Таблица из набора данных СКД",
    "description": "Таблица из набора данных СКД",
    "code_snippet": "// Возвращает таблицу значений с колонками набора данных СКД\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/132\r\n// \r\n// Параметры:\r\n//  НаборДанных - НаборДанныхОбъектСхемыКомпоновкиДанных\r\n// \r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений\r\n//  \r\n// Пример:\r\n// \tТаблица = ТаблицаИзНабораДанных(СКД.НаборыДанных.Получить(0));\r\n// \t//Таблица содержит пустую ТЗ со всеми колонками для набора. \r\n// \t//Теперь её можно заполнять данными и далее \"скармливать\" при формировании СКД\r\n//  \r\nФункция ТаблицаИзНабораДанных(Знач НаборДанных) Экспорт\r\n\t\r\n\tРезультат = Новый ТаблицаЗначений();\r\n\t\r\n\tДля Каждого Поле Из НаборДанных.Поля Цикл\r\n\t\tРезультат.Колонки.Добавить(Поле.Поле, Поле.ТипЗначения, Поле.Заголовок);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\n// Возвращает таблицу значений с колонками набора данных СКД\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/132\r\n// \r\n// Параметры:\r\n//  НаборДанных - НаборДанныхОбъектСхемыКомпоновкиДанных\r\n// \r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений\r\n//  \r\n// Пример:\r\n// \tТаблица = ТаблицаИзНабораДанных(СКД.НаборыДанных.Получить(0));\r\n// \t//Таблица содержит пустую ТЗ со всеми колонками для набора. \r\n// \t//Теперь её можно заполнять данными и далее \"скармливать\" при формировании СКД\r\n//  \r\nФункция ТаблицаИзНабораДанных(Знач НаборДанных) Экспорт\r\n\t\r\n\tРезультат = Новый ТаблицаЗначений();\r\n\t\r\n\tДля Каждого Поле Из НаборДанных.Поля Цикл\r\n\t\tРезультат.Колонки.Добавить(Поле.Поле, Поле.ТипЗначения, Поле.Заголовок);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "СтрШаблон (с проверкой существования параметров)",
    "description": "СтрШаблон (с проверкой существования параметров)",
    "code_snippet": "// @skip-check method-too-many-params\r\n// Перед вставкой параметров проверяет существование параметра в шаблоне\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/129\r\n// \r\n// Параметры:\r\n//  Шаблон - Строка\r\n//  Параметр1 - Произвольный\r\n//  Параметр2 - Произвольный\r\n//  Параметр3 - Произвольный\r\n//  Параметр4 - Произвольный\r\n//  Параметр5 - Произвольный\r\n//  Параметр6 - Произвольный\r\n//  Параметр7 - Произвольный\r\n//  Параметр8 - Произвольный\r\n//  Параметр9 - Произвольный\r\n//  Параметр10 - Произвольный\r\n// \r\n// Возвращаемое значение:\r\n//  Строка\r\nФункция СтрШаблонБезопасно(Знач Шаблон, Знач Параметр1 = Неопределено, \r\n\tЗнач Параметр2 = Неопределено, Знач Параметр3 = Неопределено, Знач Параметр4 = Неопределено, \r\n\tЗнач Параметр5 = Неопределено, Знач Параметр6 = Неопределено, Знач Параметр7 = Неопределено,\r\n\tЗнач Параметр8 = Неопределено, Знач Параметр9 = Неопределено, Знач Параметр10 = Неопределено) Экспорт\r\n\t\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр1, 1);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр2, 2);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр3, 3);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр4, 4);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр5, 5);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр6, 6);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр7, 7);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр8, 8);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр9, 9);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр10, 10);\r\n\t\r\n\tВозврат СтрШаблон(Шаблон, \r\n\t\tПараметр1, Параметр2, Параметр3, Параметр4, Параметр5, \r\n\t\tПараметр6, Параметр7, Параметр8, Параметр9, Параметр10);\r\n\t\r\nКонецФункции\r\n\r\n// Затереть параметр при его отсутствии в шаблоне.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/129\r\n// \r\n// Параметры:\r\n//  Шаблон - Строка\r\n//  Параметр - Произвольный\r\n//  Номер - Число\r\nПроцедура ЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Знач Шаблон, Параметр, Знач Номер) Экспорт\r\n\t\r\n\tЕсли Параметр <> Неопределено И СтрНайти(Шаблон, \"%\" + Номер) = 0 Тогда\r\n\t\tПараметр = Неопределено;\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\n// @skip-check method-too-many-params\r\n// Перед вставкой параметров проверяет существование параметра в шаблоне\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/129\r\n// \r\n// Параметры:\r\n//  Шаблон - Строка\r\n//  Параметр1 - Произвольный\r\n//  Параметр2 - Произвольный\r\n//  Параметр3 - Произвольный\r\n//  Параметр4 - Произвольный\r\n//  Параметр5 - Произвольный\r\n//  Параметр6 - Произвольный\r\n//  Параметр7 - Произвольный\r\n//  Параметр8 - Произвольный\r\n//  Параметр9 - Произвольный\r\n//  Параметр10 - Произвольный\r\n// \r\n// Возвращаемое значение:\r\n//  Строка\r\nФункция СтрШаблонБезопасно(Знач Шаблон, Знач Параметр1 = Неопределено, \r\n\tЗнач Параметр2 = Неопределено, Знач Параметр3 = Неопределено, Знач Параметр4 = Неопределено, \r\n\tЗнач Параметр5 = Неопределено, Знач Параметр6 = Неопределено, Знач Параметр7 = Неопределено,\r\n\tЗнач Параметр8 = Неопределено, Знач Параметр9 = Неопределено, Знач Параметр10 = Неопределено) Экспорт\r\n\t\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр1, 1);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр2, 2);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр3, 3);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр4, 4);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр5, 5);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр6, 6);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр7, 7);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр8, 8);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр9, 9);\r\n\tЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Шаблон, Параметр10, 10);\r\n\t\r\n\tВозврат СтрШаблон(Шаблон, \r\n\t\tПараметр1, Параметр2, Параметр3, Параметр4, Параметр5, \r\n\t\tПараметр6, Параметр7, Параметр8, Параметр9, Параметр10);\r\n\t\r\nКонецФункции\r\n\r\n// Затереть параметр при его отсутствии в шаблоне.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/129\r\n// \r\n// Параметры:\r\n//  Шаблон - Строка\r\n//  Параметр - Произвольный\r\n//  Номер - Число\r\nПроцедура ЗатеретьПараметрПриЕгоОтсутствииВШаблоне(Знач Шаблон, Параметр, Знач Номер) Экспорт\r\n\t\r\n\tЕсли Параметр <> Неопределено И СтрНайти(Шаблон, \"%\" + Номер) = 0 Тогда\r\n\t\tПараметр = Неопределено;\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\nОрфографическая ошибка в params: params"
  },
  {
    "title": "Строка из символа",
    "description": "Строка из символа",
    "code_snippet": "// Возвращает строку нужной длины из указанного символа\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/120\r\n// \r\n// Параметры:\r\n//  Длина - Число\r\n//  Символ - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  Строка\r\nФункция СтрокаСимволов(Знач Длина, Знач Символ = \" \") Экспорт\r\n\t\r\n\tКвалификатор = Новый КвалификаторыСтроки(Длина, ДопустимаяДлина.Фиксированная);\r\n\tОписаниеТипов = Новый ОписаниеТипов(\"Строка\", Квалификатор);\r\n\tРезультат = ОписаниеТипов.ПривестиЗначение(\"\"); // Строка\r\n\tЕсли Символ <> \" \" Тогда\r\n\t\tРезультат = СтрЗаменить(Результат, \" \", Символ);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\n// Возвращает строку нужной длины из указанного символа\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/120\r\n// \r\n// Параметры:\r\n//  Длина - Число\r\n//  Символ - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  Строка\r\nФункция СтрокаСимволов(Знач Длина, Знач Символ = \" \") Экспорт\r\n\t\r\n\tКвалификатор = Новый КвалификаторыСтроки(Длина, ДопустимаяДлина.Фиксированная);\r\n\tОписаниеТипов = Новый ОписаниеТипов(\"Строка\", Квалификатор);\r\n\tРезультат = ОписаниеТипов.ПривестиЗначение(\"\"); // Строка\r\n\tЕсли Символ <> \" \" Тогда\r\n\t\tРезультат = СтрЗаменить(Результат, \" \", Символ);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nФункция СтрокаСимволов(Знач Длина, Знач Символ = \" \") Экспорт\n\t\n\tВозврат СтрСоединить(Новый Массив(Длина+1),Символ);\n\t\nКонецФункции"
  },
  {
    "title": "Проверить корректность шаблона для СтрШаблон()",
    "description": "Проверить корректность шаблона для СтрШаблон()",
    "code_snippet": "// Возвращает результат проверки корректности шаблона строки (метода СтрШаблон)\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/12\r\n//  \r\n// Параметры:\r\n//  ШаблонСтроки - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  Булево - Корректен ли шаблон строки\r\nФункция ШаблонСтрокиКорректен(Знач ШаблонСтроки) Экспорт\r\n\t\r\n\tПопытка\r\n\t\tПроверитьШаблонСтроки(ШаблонСтроки);\r\n\t\tВозврат Истина;\r\n\tИсключение\r\n\t\tВозврат Ложь;\r\n\tКонецПопытки;\r\n\t\r\nКонецФункции\r\n\r\n// Проверяет корректность шаблона строки (метода СтрШаблон)\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/12\r\n// \r\n// Параметры:\r\n//  ШаблонСтроки - Строка\r\nПроцедура ПроверитьШаблонСтроки(Знач ШаблонСтроки) Экспорт\r\n\t\r\n\tСтрШаблон(ШаблонСтроки, Неопределено, Неопределено, \r\n    \tНеопределено, Неопределено, Неопределено, Неопределено, \r\n    \tНеопределено, Неопределено, Неопределено, Неопределено);\r\n\t\r\nКонецПроцедуры\n\n// Возвращает результат проверки корректности шаблона строки (метода СтрШаблон)\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/12\r\n//  \r\n// Параметры:\r\n//  ШаблонСтроки - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  Булево - Корректен ли шаблон строки\r\nФункция ШаблонСтрокиКорректен(Знач ШаблонСтроки) Экспорт\r\n\t\r\n\tПопытка\r\n\t\tПроверитьШаблонСтроки(ШаблонСтроки);\r\n\t\tВозврат Истина;\r\n\tИсключение\r\n\t\tВозврат Ложь;\r\n\tКонецПопытки;\r\n\t\r\nКонецФункции\r\n\r\n// Проверяет корректность шаблона строки (метода СтрШаблон)\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/12\r\n// \r\n// Параметры:\r\n//  ШаблонСтроки - Строка\r\nПроцедура ПроверитьШаблонСтроки(Знач ШаблонСтроки) Экспорт\r\n\t\r\n\tСтрШаблон(ШаблонСтроки, Неопределено, Неопределено, \r\n    \tНеопределено, Неопределено, Неопределено, Неопределено, \r\n    \tНеопределено, Неопределено, Неопределено, Неопределено);\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Найти подстроку и выделить оформлением",
    "description": "Найти подстроку и выделить оформлением",
    "code_snippet": "// Метод выделяет подстроку внутри подстроки с использованием метода см. СтрНайтиИВыделитьОформлением\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/3\r\n//  \r\n// Параметры:\r\n//  Строка - Строка - Исходная строка\r\n//  Подстрока - Строка - Искомая строка\r\n// \r\n// Возвращаемое значение:\r\n//  ФорматированнаяСтрока, Неопределено - вернет форматированную строку, если хотя бы одно вхождение найдено\r\nФункция СтрокаНайтиИВыделитьОформлением(Знач Строка, Знач Подстрока) Экспорт\r\n\r\n\tСтрокаВрег = ВРег(Строка);\r\n\tПодстрокаВрег = ВРег(Подстрока);\r\n\r\n\tДлинаСтроки = СтрДлина(Строка);\r\n\tДлинаПодстроки = СтрДлина(Подстрока);\r\n\r\n\tЧастиРезультата = Новый Массив; // Массив из Строка, ФорматированнаяСтрока\r\n\r\n\tНачалоПоиска = 1;\r\n\tПока НачалоПоиска <= ДлинаСтроки Цикл\r\n\r\n\t\tТекущаяКоордината = СтрНайти(СтрокаВрег, ПодстрокаВрег, , НачалоПоиска);\r\n\t\tЕсли ТекущаяКоордината = 0 Тогда\r\n\r\n\t\t\tЕсли ЗначениеЗаполнено(ЧастиРезультата) Тогда\r\n\t\t\t\tЧастьСтроки = Сред(Строка, НачалоПоиска);\r\n\t\t\t\tЧастиРезультата.Добавить(ЧастьСтроки);\r\n\t\t\t\tПрервать;\r\n\t\t\tИначе\r\n\t\t\t\tВозврат Неопределено;\r\n\t\t\tКонецЕсли;\r\n\r\n\t\tИначе\r\n\r\n\t\t\tЕсли НачалоПоиска < ТекущаяКоордината Тогда\r\n\t\t\t\tЧастьСтроки = Сред(Строка, НачалоПоиска, ТекущаяКоордината - НачалоПоиска);\r\n\t\t\t\tЧастиРезультата.Добавить(ЧастьСтроки);\r\n\t\t\tКонецЕсли;\r\n\r\n\t\t\tЧастьСтроки = Сред(Строка, ТекущаяКоордината, ДлинаПодстроки);\r\n\t\t\tЧастьСтроки = СтрНайтиИВыделитьОформлением(ЧастьСтроки, Подстрока);\r\n\t\t\tЧастиРезультата.Добавить(ЧастьСтроки);\r\n\r\n\t\t\tНачалоПоиска = ТекущаяКоордината + ДлинаПодстроки;\r\n\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\r\n\tВозврат Новый ФорматированнаяСтрока(ЧастиРезультата);\r\n\r\nКонецФункции\n\n// Метод выделяет подстроку внутри подстроки с использованием метода см. СтрНайтиИВыделитьОформлением\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/3\r\n//  \r\n// Параметры:\r\n//  Строка - Строка - Исходная строка\r\n//  Подстрока - Строка - Искомая строка\r\n// \r\n// Возвращаемое значение:\r\n//  ФорматированнаяСтрока, Неопределено - вернет форматированную строку, если хотя бы одно вхождение найдено\r\nФункция СтрокаНайтиИВыделитьОформлением(Знач Строка, Знач Подстрока) Экспорт\r\n\r\n\tСтрокаВрег = ВРег(Строка);\r\n\tПодстрокаВрег = ВРег(Подстрока);\r\n\r\n\tДлинаСтроки = СтрДлина(Строка);\r\n\tДлинаПодстроки = СтрДлина(Подстрока);\r\n\r\n\tЧастиРезультата = Новый Массив; // Массив из Строка, ФорматированнаяСтрока\r\n\r\n\tНачалоПоиска = 1;\r\n\tПока НачалоПоиска <= ДлинаСтроки Цикл\r\n\r\n\t\tТекущаяКоордината = СтрНайти(СтрокаВрег, ПодстрокаВрег, , НачалоПоиска);\r\n\t\tЕсли ТекущаяКоордината = 0 Тогда\r\n\r\n\t\t\tЕсли ЗначениеЗаполнено(ЧастиРезультата) Тогда\r\n\t\t\t\tЧастьСтроки = Сред(Строка, НачалоПоиска);\r\n\t\t\t\tЧастиРезультата.Добавить(ЧастьСтроки);\r\n\t\t\t\tПрервать;\r\n\t\t\tИначе\r\n\t\t\t\tВозврат Неопределено;\r\n\t\t\tКонецЕсли;\r\n\r\n\t\tИначе\r\n\r\n\t\t\tЕсли НачалоПоиска < ТекущаяКоордината Тогда\r\n\t\t\t\tЧастьСтроки = Сред(Строка, НачалоПоиска, ТекущаяКоордината - НачалоПоиска);\r\n\t\t\t\tЧастиРезультата.Добавить(ЧастьСтроки);\r\n\t\t\tКонецЕсли;\r\n\r\n\t\t\tЧастьСтроки = Сред(Строка, ТекущаяКоордината, ДлинаПодстроки);\r\n\t\t\tЧастьСтроки = СтрНайтиИВыделитьОформлением(ЧастьСтроки, Подстрока);\r\n\t\t\tЧастиРезультата.Добавить(ЧастьСтроки);\r\n\r\n\t\t\tНачалоПоиска = ТекущаяКоордината + ДлинаПодстроки;\r\n\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\r\n\tВозврат Новый ФорматированнаяСтрока(ЧастиРезультата);\r\n\r\nКонецФункции"
  },
  {
    "title": "Строка выделенная оформлением",
    "description": "Строка выделенная оформлением",
    "code_snippet": "// Возвращает форматированную строку, в которой части выделены.\r\n// Например, \"Выдели `слово` в предложении\"\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/4\r\n//  \r\n// Параметры:\r\n//  Строка - Строка\r\n//  Выделитель - Строка - Символ, который обрамляет выделяемую строку\r\n// \r\n// Возвращаемое значение:\r\n//  Строка\r\nФункция СтрокаВыделеннаяОформлением(Знач Строка, Знач Выделитель = \"`\") Экспорт\r\n\t\r\n\tЭтоВыделить = Ложь;\r\n\tЧастиСтроки = СтрРазделить(Строка, Выделитель, Истина);\r\n\tДля Индекс = 0 По ЧастиСтроки.Количество() - 1 Цикл\r\n\t\t\r\n\t\tЕсли ЭтоВыделить Тогда\r\n\t\t\tЧастьСтроки = ЧастиСтроки[Индекс];\r\n\t\t\tЧастьСтроки = СтрНайтиИВыделитьОформлением(ЧастьСтроки, ЧастьСтроки);\r\n\t\t\tЧастиСтроки[Индекс] = ЧастьСтроки;\r\n\t\t\tЭтоВыделить = Ложь;\r\n\t\tИначе\r\n\t\t\tЭтоВыделить = Истина;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Новый ФорматированнаяСтрока(ЧастиСтроки);\r\n\t\r\nКонецФункции\n\n// Возвращает форматированную строку, в которой части выделены.\r\n// Например, \"Выдели `слово` в предложении\"\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/4\r\n//  \r\n// Параметры:\r\n//  Строка - Строка\r\n//  Выделитель - Строка - Символ, который обрамляет выделяемую строку\r\n// \r\n// Возвращаемое значение:\r\n//  Строка\r\nФункция СтрокаВыделеннаяОформлением(Знач Строка, Знач Выделитель = \"`\") Экспорт\r\n\t\r\n\tЭтоВыделить = Ложь;\r\n\tЧастиСтроки = СтрРазделить(Строка, Выделитель, Истина);\r\n\tДля Индекс = 0 По ЧастиСтроки.Количество() - 1 Цикл\r\n\t\t\r\n\t\tЕсли ЭтоВыделить Тогда\r\n\t\t\tЧастьСтроки = ЧастиСтроки[Индекс];\r\n\t\t\tЧастьСтроки = СтрНайтиИВыделитьОформлением(ЧастьСтроки, ЧастьСтроки);\r\n\t\t\tЧастиСтроки[Индекс] = ЧастьСтроки;\r\n\t\t\tЭтоВыделить = Ложь;\r\n\t\tИначе\r\n\t\t\tЭтоВыделить = Истина;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Новый ФорматированнаяСтрока(ЧастиСтроки);\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в Выделитель (найдено 3): Выделитель"
  },
  {
    "title": "1С Менеджер конфигурацийНаш выбор",
    "description": "1С Менеджер конфигураций — альтернативный стартер информационных баз 1С:Предприятие.",
    "code_snippet": ""
  },
  {
    "title": "Вставить параметры в строку",
    "description": "Вставить параметры в строку",
    "code_snippet": "// Заменяет в строке именованные параметры на значения свойств объекта (по формату %ИмяСвойства%)\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/1\r\n//  \r\n// Параметры:\r\n//  ШаблонСтроки - Строка - Строка, в которую необходимо всавить свойства объекта\r\n//  Объект - Произвольный - Произвольный объект, свойства которого необходимо вставить в строку\r\n// \r\n// Возвращаемое значение:\r\n//  Строка\r\nФункция ВставитьПараметрыВСтроку(Знач ШаблонСтроки, Знач Объект) Экспорт\r\n\t\r\n\tРазделитель = \"%\";\r\n\tЭтоПараметр = Ложь;\r\n\tЧастиСтроки = СтрРазделить(ШаблонСтроки, Разделитель, Истина);\r\n\tДля Индекс = 0 По ЧастиСтроки.Количество() - 1 Цикл\r\n\t\t\r\n\t\tЕсли ЭтоПараметр Тогда\r\n\t\t\tИмяСвойства = ЧастиСтроки[Индекс];\r\n\t\t\tЕсли ИмяСвойства = \"\" Тогда //Экранирование символа разделителя\r\n\t\t\t\tЗначениеСвойства = Разделитель;\r\n\t\t\tИначе\r\n\t\t\t\tЗначениеСвойства = Строка(Объект[ИмяСвойства]);\r\n\t\t\tКонецЕсли;\r\n\t\t\tЧастиСтроки[Индекс] = ЗначениеСвойства;\r\n\t\t\tЭтоПараметр = Ложь;\r\n\t\tИначе\r\n\t\t\tЭтоПараметр = Истина;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат СтрСоединить(ЧастиСтроки, \"\");\r\n\t\r\nКонецФункции\n\n// Заменяет в строке именованные параметры на значения свойств объекта (по формату %ИмяСвойства%)\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/1\r\n//  \r\n// Параметры:\r\n//  ШаблонСтроки - Строка - Строка, в которую необходимо всавить свойства объекта\r\n//  Объект - Произвольный - Произвольный объект, свойства которого необходимо вставить в строку\r\n// \r\n// Возвращаемое значение:\r\n//  Строка\r\nФункция ВставитьПараметрыВСтроку(Знач ШаблонСтроки, Знач Объект) Экспорт\r\n\t\r\n\tРазделитель = \"%\";\r\n\tЭтоПараметр = Ложь;\r\n\tЧастиСтроки = СтрРазделить(ШаблонСтроки, Разделитель, Истина);\r\n\tДля Индекс = 0 По ЧастиСтроки.Количество() - 1 Цикл\r\n\t\t\r\n\t\tЕсли ЭтоПараметр Тогда\r\n\t\t\tИмяСвойства = ЧастиСтроки[Индекс];\r\n\t\t\tЕсли ИмяСвойства = \"\" Тогда //Экранирование символа разделителя\r\n\t\t\t\tЗначениеСвойства = Разделитель;\r\n\t\t\tИначе\r\n\t\t\t\tЗначениеСвойства = Строка(Объект[ИмяСвойства]);\r\n\t\t\tКонецЕсли;\r\n\t\t\tЧастиСтроки[Индекс] = ЗначениеСвойства;\r\n\t\t\tЭтоПараметр = Ложь;\r\n\t\tИначе\r\n\t\t\tЭтоПараметр = Истина;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат СтрСоединить(ЧастиСтроки, \"\");\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в всавить: всавить"
  },
  {
    "title": "Текущие данные таблицы формы",
    "description": "Текущие данные таблицы формы",
    "code_snippet": "// Текущие данные таблицы (клиент-сервеный метод для упрощения получания текущих данных табицы формы).\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/88\r\n// \r\n// Параметры:\r\n//  Форма - ФормаКлиентскогоПриложения\r\n//  ИмяТаблицы - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  ДанныеФормыЭлементКоллекции\r\nФункция ТекущиеДанныеТаблицы(Знач Форма, Знач ИмяТаблицы) Экспорт\r\n\t\r\n\tРезультат = Неопределено; // ДанныеФормыЭлементКоллекции\r\n\t\r\n\tЭлементФормы = Форма.Элементы[ИмяТаблицы];\r\n\t\r\n\t#Если Клиент Тогда\r\n\t\t\r\n\t\tРезультат = ЭлементФормы.ТекущиеДанные;\r\n\t\t\r\n\t#Иначе\r\n\t\t\r\n\t\tТекущаяСтрока = ЭлементФормы.ТекущаяСтрока;\r\n\t\tЕсли ТипЗнч(ТекущаяСтрока) = Тип(\"Число\") Тогда\r\n\t\t\t\r\n\t\t\tТаблицаФормы = Форма; // ДанныеФормыДерево\r\n\t\t\tЧастиПути = СтрРазделить(ЭлементФормы.ПутьКДанным, \".\");\r\n\t\t\tДля Каждого ЧастьПути Из ЧастиПути Цикл\r\n\t\t\t\tТаблицаФормы = ТаблицаФормы[ЧастьПути];\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tЕсли ТипЗнч(ТаблицаФормы) = Тип(\"ДанныеФормыКоллекция\")\r\n\t\t\t\tИЛИ ТипЗнч(ТаблицаФормы) = Тип(\"ДанныеФормыСтруктураСКоллекцией\")\r\n\t\t\t\tИЛИ ТипЗнч(ТаблицаФормы) = Тип(\"ДанныеФормыДерево\") Тогда\r\n\t\t\t\tРезультат = ТаблицаФормы.НайтиПоИдентификатору(ТекущаяСтрока);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\t\r\n\t#КонецЕсли\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\n// Текущие данные таблицы (клиент-сервеный метод для упрощения получания текущих данных табицы формы).\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/88\r\n// \r\n// Параметры:\r\n//  Форма - ФормаКлиентскогоПриложения\r\n//  ИмяТаблицы - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  ДанныеФормыЭлементКоллекции\r\nФункция ТекущиеДанныеТаблицы(Знач Форма, Знач ИмяТаблицы) Экспорт\r\n\t\r\n\tРезультат = Неопределено; // ДанныеФормыЭлементКоллекции\r\n\t\r\n\tЭлементФормы = Форма.Элементы[ИмяТаблицы];\r\n\t\r\n\t#Если Клиент Тогда\r\n\t\t\r\n\t\tРезультат = ЭлементФормы.ТекущиеДанные;\r\n\t\t\r\n\t#Иначе\r\n\t\t\r\n\t\tТекущаяСтрока = ЭлементФормы.ТекущаяСтрока;\r\n\t\tЕсли ТипЗнч(ТекущаяСтрока) = Тип(\"Число\") Тогда\r\n\t\t\t\r\n\t\t\tТаблицаФормы = Форма; // ДанныеФормыДерево\r\n\t\t\tЧастиПути = СтрРазделить(ЭлементФормы.ПутьКДанным, \".\");\r\n\t\t\tДля Каждого ЧастьПути Из ЧастиПути Цикл\r\n\t\t\t\tТаблицаФормы = ТаблицаФормы[ЧастьПути];\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tЕсли ТипЗнч(ТаблицаФормы) = Тип(\"ДанныеФормыКоллекция\")\r\n\t\t\t\tИЛИ ТипЗнч(ТаблицаФормы) = Тип(\"ДанныеФормыСтруктураСКоллекцией\")\r\n\t\t\t\tИЛИ ТипЗнч(ТаблицаФормы) = Тип(\"ДанныеФормыДерево\") Тогда\r\n\t\t\t\tРезультат = ТаблицаФормы.НайтиПоИдентификатору(ТекущаяСтрока);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\t\r\n\t#КонецЕсли\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в сервеный (найдено 2): сервеный\r\nОрфографическая ошибка в получания (найдено 2): получания\r\nОрфографическая ошибка в табицы (найдено 2): табицы"
  },
  {
    "title": "Обновить признак предупреждения при редактировании элемента",
    "description": "Обновить признак предупреждения при редактировании элемента",
    "code_snippet": "// Обновить признак предупреждения при редактировании элемента в зависимости от заполненности указанных данных.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/100\r\n// \r\n// Параметры:\r\n//  Форма - ФормаКлиентскогоПриложения\r\n//  ИменаЭлементов - Строка, Массив из Строка - Имена элементов предупреждения\r\n//  ПроверяемыеДанные - Строка, Массив из Строка - Проверяемые данные\r\nПроцедура ОбновитьПризнакПредупрежденияПриРедактированииЭлемента(Знач Форма, Знач ИменаЭлементов, Знач ПроверяемыеДанные) Экспорт\r\n\t\r\n\tЕсли ТипЗнч(ИменаЭлементов) = Тип(\"Строка\") Тогда\r\n\t\tИменаЭлементов = СтрРазделить(ИменаЭлементов, \",\" + Символы.ПС, Ложь);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ТипЗнч(ПроверяемыеДанные) = Тип(\"Строка\") Тогда\r\n\t\tПроверяемыеДанные = СтрРазделить(ПроверяемыеДанные, \",\" + Символы.ПС, Ложь);\r\n\tКонецЕсли;\r\n\t\r\n\tПризнакПредупреждения = ОтображениеПредупрежденияПриРедактировании.НеОтображать;\r\n\tДля Каждого ИмяДанных Из ПроверяемыеДанные Цикл\r\n\t\tДанныеЗаполнены = ЗначениеЗаполнено(Форма[ИмяДанных]);\r\n\t\tЕсли ДанныеЗаполнены Тогда\r\n\t\t\tПризнакПредупреждения = ОтображениеПредупрежденияПриРедактировании.Отображать;\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого ИмяЭлемента Из ИменаЭлементов Цикл\r\n\t\t\r\n\t\tЭлемент = Форма.Элементы.Найти(ИмяЭлемента);\r\n\t\tЕсли Элемент.ОтображениеПредупрежденияПриРедактировании <> ПризнакПредупреждения Тогда\r\n\t\t\tЭлемент.ОтображениеПредупрежденияПриРедактировании = ПризнакПредупреждения;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n// Обновить признак предупреждения при редактировании элемента в зависимости от заполненности указанных данных.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/100\r\n// \r\n// Параметры:\r\n//  Форма - ФормаКлиентскогоПриложения\r\n//  ИменаЭлементов - Строка, Массив из Строка - Имена элементов предупреждения\r\n//  ПроверяемыеДанные - Строка, Массив из Строка - Проверяемые данные\r\nПроцедура ОбновитьПризнакПредупрежденияПриРедактированииЭлемента(Знач Форма, Знач ИменаЭлементов, Знач ПроверяемыеДанные) Экспорт\r\n\t\r\n\tЕсли ТипЗнч(ИменаЭлементов) = Тип(\"Строка\") Тогда\r\n\t\tИменаЭлементов = СтрРазделить(ИменаЭлементов, \",\" + Символы.ПС, Ложь);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ТипЗнч(ПроверяемыеДанные) = Тип(\"Строка\") Тогда\r\n\t\tПроверяемыеДанные = СтрРазделить(ПроверяемыеДанные, \",\" + Символы.ПС, Ложь);\r\n\tКонецЕсли;\r\n\t\r\n\tПризнакПредупреждения = ОтображениеПредупрежденияПриРедактировании.НеОтображать;\r\n\tДля Каждого ИмяДанных Из ПроверяемыеДанные Цикл\r\n\t\tДанныеЗаполнены = ЗначениеЗаполнено(Форма[ИмяДанных]);\r\n\t\tЕсли ДанныеЗаполнены Тогда\r\n\t\t\tПризнакПредупреждения = ОтображениеПредупрежденияПриРедактировании.Отображать;\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого ИмяЭлемента Из ИменаЭлементов Цикл\r\n\t\t\r\n\t\tЭлемент = Форма.Элементы.Найти(ИмяЭлемента);\r\n\t\tЕсли Элемент.ОтображениеПредупрежденияПриРедактировании <> ПризнакПредупреждения Тогда\r\n\t\t\tЭлемент.ОтображениеПредупрежденияПриРедактировании = ПризнакПредупреждения;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Новый элемент условного оформления",
    "description": "Новый элемент условного оформления",
    "code_snippet": "// Добавляет элемент условного оформления по параметрам\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/83\r\n//\r\n// Параметры:\r\n//  УсловноеОформление\t - УсловноеОформлениеКомпоновкиДанных - Коллекция условного оформления\r\n//  ОформляемыеПоля\t\t - Строка, Массив из Строка - Имена полей, на которых распространяется условное оформление\r\n//  УсловияОтбора\t\t - Структура, Массив из Структура - Условия отбора оформления. \r\n//  ПараметрыОформления\t - Структура - Параметры оформления\r\n// \r\n// Возвращаемое значение:\r\n//  ЭлементУсловногоОформленияКомпоновкиДанных  - добавленный элемент\r\n//\r\nФункция НовыйЭлементУсловногоОформления(Знач УсловноеОформление, \r\n\tЗнач ОформляемыеПоля, Знач УсловияОтбора, Знач ПараметрыОформления) Экспорт\r\n\t\r\n\tНовыйЭлемент = УсловноеОформление.Элементы.Добавить();\r\n\tНовыйЭлемент.Использование = Истина;\r\n\t\r\n\tДля Каждого КлючИЗначение Из ПараметрыОформления Цикл\r\n\t\tНовыйЭлемент.Оформление.УстановитьЗначениеПараметра(КлючИЗначение.Ключ, КлючИЗначение.Значение);\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли ТипЗнч(ОформляемыеПоля) = Тип(\"Строка\") Тогда\r\n\t\tКоллекцияДобавляемыхПолей = СтрРазделить(ОформляемыеПоля, \",\");\r\n\tИначе\r\n\t\tКоллекцияДобавляемыхПолей = ОформляемыеПоля;\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого ДобавляемоеПоле Из КоллекцияДобавляемыхПолей Цикл\r\n\t\tОформляемоеПолеКомпоновкиДанных = НовыйЭлемент.Поля.Элементы.Добавить();\r\n\t\tОформляемоеПолеКомпоновкиДанных.Использование = Истина;\r\n\t\tОформляемоеПолеКомпоновкиДанных.Поле = Новый ПолеКомпоновкиДанных(ДобавляемоеПоле);\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли ТипЗнч(УсловияОтбора) = Тип(\"Массив\") Тогда\r\n\t\tКоллекцияУсловий = УсловияОтбора;\r\n\tИначе\r\n\t\tКоллекцияУсловий = Новый Массив(1);\r\n\t\tКоллекцияУсловий[0] = УсловияОтбора;\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого УсловиеОтбора Из КоллекцияУсловий Цикл\r\n\t\tЭлементОтбора = НовыйЭлемент.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n\t\tЗаполнитьЗначенияСвойств(ЭлементОтбора, УсловиеОтбора);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат НовыйЭлемент;\r\n\t\r\nКонецФункции\n\n// Добавляет элемент условного оформления по параметрам\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/83\r\n//\r\n// Параметры:\r\n//  УсловноеОформление\t - УсловноеОформлениеКомпоновкиДанных - Коллекция условного оформления\r\n//  ОформляемыеПоля\t\t - Строка, Массив из Строка - Имена полей, на которых распространяется условное оформление\r\n//  УсловияОтбора\t\t - Структура, Массив из Структура - Условия отбора оформления. \r\n//  ПараметрыОформления\t - Структура - Параметры оформления\r\n// \r\n// Возвращаемое значение:\r\n//  ЭлементУсловногоОформленияКомпоновкиДанных  - добавленный элемент\r\n//\r\nФункция НовыйЭлементУсловногоОформления(Знач УсловноеОформление, \r\n\tЗнач ОформляемыеПоля, Знач УсловияОтбора, Знач ПараметрыОформления) Экспорт\r\n\t\r\n\tНовыйЭлемент = УсловноеОформление.Элементы.Добавить();\r\n\tНовыйЭлемент.Использование = Истина;\r\n\t\r\n\tДля Каждого КлючИЗначение Из ПараметрыОформления Цикл\r\n\t\tНовыйЭлемент.Оформление.УстановитьЗначениеПараметра(КлючИЗначение.Ключ, КлючИЗначение.Значение);\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли ТипЗнч(ОформляемыеПоля) = Тип(\"Строка\") Тогда\r\n\t\tКоллекцияДобавляемыхПолей = СтрРазделить(ОформляемыеПоля, \",\");\r\n\tИначе\r\n\t\tКоллекцияДобавляемыхПолей = ОформляемыеПоля;\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого ДобавляемоеПоле Из КоллекцияДобавляемыхПолей Цикл\r\n\t\tОформляемоеПолеКомпоновкиДанных = НовыйЭлемент.Поля.Элементы.Добавить();\r\n\t\tОформляемоеПолеКомпоновкиДанных.Использование = Истина;\r\n\t\tОформляемоеПолеКомпоновкиДанных.Поле = Новый ПолеКомпоновкиДанных(ДобавляемоеПоле);\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли ТипЗнч(УсловияОтбора) = Тип(\"Массив\") Тогда\r\n\t\tКоллекцияУсловий = УсловияОтбора;\r\n\tИначе\r\n\t\tКоллекцияУсловий = Новый Массив(1);\r\n\t\tКоллекцияУсловий[0] = УсловияОтбора;\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого УсловиеОтбора Из КоллекцияУсловий Цикл\r\n\t\tЭлементОтбора = НовыйЭлемент.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n\t\tЗаполнитьЗначенияСвойств(ЭлементОтбора, УсловиеОтбора);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат НовыйЭлемент;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Структура из параметров формы",
    "description": "Структура из параметров формы",
    "code_snippet": "// Возвращает структуру из параметров формы.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/133\r\n// \r\n// Параметры:\r\n//  ПараметрыФормы - ДанныеФормыСтруктура\r\n// \r\n// Возвращаемое значение:\r\n//  Структура\r\nФункция СтруктураИзПараметровФормы(Знач ПараметрыФормы) Экспорт\r\n\t\r\n\tРезультат = Новый Структура;\r\n\t\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\tЗаписьXML.УстановитьСтроку();\r\n\tСериализаторXDTO.ЗаписатьXML(ЗаписьXML, ПараметрыФормы, НазначениеТипаXML.Явное);\r\n\tСтрокаXML = ЗаписьXML.Закрыть();\r\n\tЧтениеXML = Новый ЧтениеXML;\r\n\tЧтениеXML.УстановитьСтроку(СтрокаXML);\r\n\t\r\n\tПока ЧтениеXML.Прочитать() Цикл\r\n\t\t\r\n\t\tЕсли ЧтениеXML.Имя = \"structure\" \r\n\t\t\tИ ЧтениеXML.ПолучитьАтрибут(\"name\") = \"parameters\" \r\n\t\t\tИ ЧтениеXML.ТипУзла = ТипУзлаXML.КонецЭлемента Тогда\r\n\t\t\t\r\n\t\t\tПрервать;\r\n\t\t\t             \r\n\t\tИначеЕсли ЧтениеXML.Имя = \"field\" Тогда\r\n\t\t\t\r\n\t\t\tТекущийКлюч\t= ЧтениеXML.ПолучитьАтрибут(\"nameRu\");\r\n\t\t\tТекущийКлюч\t= ?(ЗначениеЗаполнено(ТекущийКлюч), ТекущийКлюч, ЧтениеXML.ПолучитьАтрибут(\"name\"));\r\n\t\t\tЕсли ЗначениеЗаполнено(ТекущийКлюч) Тогда\r\n\t\t\t\tРезультат.Вставить(ТекущийКлюч);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tЧтениеXML.Закрыть();\r\n\t\r\n\tЗаполнитьЗначенияСвойств(Результат, ПараметрыФормы);\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\n// Возвращает структуру из параметров формы.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/133\r\n// \r\n// Параметры:\r\n//  ПараметрыФормы - ДанныеФормыСтруктура\r\n// \r\n// Возвращаемое значение:\r\n//  Структура\r\nФункция СтруктураИзПараметровФормы(Знач ПараметрыФормы) Экспорт\r\n\t\r\n\tРезультат = Новый Структура;\r\n\t\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\tЗаписьXML.УстановитьСтроку();\r\n\tСериализаторXDTO.ЗаписатьXML(ЗаписьXML, ПараметрыФормы, НазначениеТипаXML.Явное);\r\n\tСтрокаXML = ЗаписьXML.Закрыть();\r\n\tЧтениеXML = Новый ЧтениеXML;\r\n\tЧтениеXML.УстановитьСтроку(СтрокаXML);\r\n\t\r\n\tПока ЧтениеXML.Прочитать() Цикл\r\n\t\t\r\n\t\tЕсли ЧтениеXML.Имя = \"structure\" \r\n\t\t\tИ ЧтениеXML.ПолучитьАтрибут(\"name\") = \"parameters\" \r\n\t\t\tИ ЧтениеXML.ТипУзла = ТипУзлаXML.КонецЭлемента Тогда\r\n\t\t\t\r\n\t\t\tПрервать;\r\n\t\t\t             \r\n\t\tИначеЕсли ЧтениеXML.Имя = \"field\" Тогда\r\n\t\t\t\r\n\t\t\tТекущийКлюч\t= ЧтениеXML.ПолучитьАтрибут(\"nameRu\");\r\n\t\t\tТекущийКлюч\t= ?(ЗначениеЗаполнено(ТекущийКлюч), ТекущийКлюч, ЧтениеXML.ПолучитьАтрибут(\"name\"));\r\n\t\t\tЕсли ЗначениеЗаполнено(ТекущийКлюч) Тогда\r\n\t\t\t\tРезультат.Вставить(ТекущийКлюч);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tЧтениеXML.Закрыть();\r\n\t\r\n\tЗаполнитьЗначенияСвойств(Результат, ПараметрыФормы);\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Метод существует",
    "description": "Метод существует",
    "code_snippet": "// Функция определяет существование метода объекта\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/56\r\n// \r\n// Параметры:\r\n//  Объект - Произвольный\r\n//  ИмяМетода - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  Булево - Существует ли метод объекта\r\nФункция МетодСуществует(Знач Объект, Знач ИмяМетода) Экспорт\r\n\t\r\n\tШаблонКода = \"Объект.%1(,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,)\";\r\n\tАлгоритм = СтрШаблон(ШаблонКода, ИмяМетода);\r\n\t\r\n\tПопытка\r\n\t\t//@skip-check server-execution-safe-mode, module-unused-local-variable\r\n\t\tНеобработанныйРезультат = Вычислить(Алгоритм);\r\n\tИсключение\r\n\t\tИнформацияОбОшибке = ИнформацияОбОшибке();\r\n\t\tЕсли СтрНачинаетсяС(ИнформацияОбОшибке.Описание, \"Значение не является значением объектного типа\") Тогда\r\n\t\t\tВозврат Ложь;\r\n\t\tИначеЕсли ИнформацияОбОшибке.Описание = \"Слишком много фактических параметров\" Тогда\r\n\t\t\tВозврат Истина;\r\n\t\tИначеЕсли СтрНачинаетсяС(ИнформацияОбОшибке.Описание, \"Обращение к процедуре объекта как к функции\") Тогда\r\n\t\t\tВозврат Истина;\r\n\t\tИначеЕсли СтрНачинаетсяС(ИнформацияОбОшибке.Описание, \"Метод объекта не обнаружен\") Тогда\r\n\t\t\tВозврат Ложь;\r\n\t\tИначе\r\n\t\t\tНеобработанныйРезультат = ИнформацияОбОшибке.Описание;\r\n\t\tКонецЕсли;\r\n\tКонецПопытки;\r\n\t\r\n\t//На всякий случай\r\n\tТекстИсключения = \"Проверяемый метод \"\"%1\"\" объекта \"\"%2\"\" типа \"\"%3\"\" содержит неопределенное число параметров и не может быть проверен!\r\n\t\t|Результат выполнения: %4\";\r\n\tТекстИсключения = СтрШаблон(ТекстИсключения, ИмяМетода, Объект, ТипЗнч(Объект), НеобработанныйРезультат);\r\n\tВызватьИсключение ТекстИсключения;\r\n\t\r\nКонецФункции\n\n// Функция определяет существование метода объекта\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/56\r\n// \r\n// Параметры:\r\n//  Объект - Произвольный\r\n//  ИмяМетода - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  Булево - Существует ли метод объекта\r\nФункция МетодСуществует(Знач Объект, Знач ИмяМетода) Экспорт\r\n\t\r\n\tШаблонКода = \"Объект.%1(,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,)\";\r\n\tАлгоритм = СтрШаблон(ШаблонКода, ИмяМетода);\r\n\t\r\n\tПопытка\r\n\t\t//@skip-check server-execution-safe-mode, module-unused-local-variable\r\n\t\tНеобработанныйРезультат = Вычислить(Алгоритм);\r\n\tИсключение\r\n\t\tИнформацияОбОшибке = ИнформацияОбОшибке();\r\n\t\tЕсли СтрНачинаетсяС(ИнформацияОбОшибке.Описание, \"Значение не является значением объектного типа\") Тогда\r\n\t\t\tВозврат Ложь;\r\n\t\tИначеЕсли ИнформацияОбОшибке.Описание = \"Слишком много фактических параметров\" Тогда\r\n\t\t\tВозврат Истина;\r\n\t\tИначеЕсли СтрНачинаетсяС(ИнформацияОбОшибке.Описание, \"Обращение к процедуре объекта как к функции\") Тогда\r\n\t\t\tВозврат Истина;\r\n\t\tИначеЕсли СтрНачинаетсяС(ИнформацияОбОшибке.Описание, \"Метод объекта не обнаружен\") Тогда\r\n\t\t\tВозврат Ложь;\r\n\t\tИначе\r\n\t\t\tНеобработанныйРезультат = ИнформацияОбОшибке.Описание;\r\n\t\tКонецЕсли;\r\n\tКонецПопытки;\r\n\t\r\n\t//На всякий случай\r\n\tТекстИсключения = \"Проверяемый метод \"\"%1\"\" объекта \"\"%2\"\" типа \"\"%3\"\" содержит неопределенное число параметров и не может быть проверен!\r\n\t\t|Результат выполнения: %4\";\r\n\tТекстИсключения = СтрШаблон(ТекстИсключения, ИмяМетода, Объект, ТипЗнч(Объект), НеобработанныйРезультат);\r\n\tВызватьИсключение ТекстИсключения;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Заменить ссылки на навигационные",
    "description": "Заменить ссылки на навигационные",
    "code_snippet": "// Заменяет в объекте все ссылки на элементы на их навигационные ссылки\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/127\r\n// \r\n// Параметры:\r\n//  Объект - Массив из Произвольный\r\n//         - Структура\r\n//         - Соответствие из КлючИЗначение\r\n//         - Произвольный\r\n//\r\n// Пример:\r\n//  \r\n//  ПараметрыВыполнения = ПараметрыВыполненияСуперМетода();\r\n//  //... Выполняем метод ...\r\n//  ЗаменитьСсылкиНаНавигационные(ПараметрыВыполнения);\r\n//  ЧитабельныйТекст = ОбщегоНазначения.ЗначениеВСтрокуXML(ПараметрыВыполнения);\r\n//  ЗаписьЖурналаРегистрации(\"Лог\", УровеньЖурналаРегистрации.Информация,,,ЧитабельныйТекст);\r\n//\r\nПроцедура ЗаменитьСсылкиНаНавигационные(Объект) Экспорт\r\n\t\r\n\tЕсли ТипЗнч(Объект) = Тип(\"Массив\") Тогда\r\n\t\t\r\n\t\tДля Индекс = 0 По Объект.Количество() - 1 Цикл\r\n\t\t\tЗначение = Объект[Индекс];\r\n\t\t\tЗаменитьСсылкиНаНавигационные(Значение);\r\n\t\t\tОбъект[Индекс] = Значение;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tИначеЕсли ТипЗнч(Объект) = Тип(\"Структура\")\r\n\t\tИЛИ ТипЗнч(Объект) = Тип(\"Соответствие\") Тогда\r\n\t\t\r\n\t\tДля Каждого КлючИЗначение Из Объект Цикл\r\n\t\t\tЗначение = КлючИЗначение.Значение;\r\n\t\t\tЗаменитьСсылкиНаНавигационные(Значение);\r\n\t\t\tОбъект[КлючИЗначение.Ключ] = Значение;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tОбъектМетаданных = Метаданные.НайтиПоТипу(ТипЗнч(Объект));\r\n\t\tЕсли ОбъектМетаданных <> Неопределено Тогда\r\n\t\t\tОбъект = ПолучитьНавигационнуюСсылку(Объект);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\n// Заменяет в объекте все ссылки на элементы на их навигационные ссылки\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/127\r\n// \r\n// Параметры:\r\n//  Объект - Массив из Произвольный\r\n//         - Структура\r\n//         - Соответствие из КлючИЗначение\r\n//         - Произвольный\r\n//\r\n// Пример:\r\n//  \r\n//  ПараметрыВыполнения = ПараметрыВыполненияСуперМетода();\r\n//  //... Выполняем метод ...\r\n//  ЗаменитьСсылкиНаНавигационные(ПараметрыВыполнения);\r\n//  ЧитабельныйТекст = ОбщегоНазначения.ЗначениеВСтрокуXML(ПараметрыВыполнения);\r\n//  ЗаписьЖурналаРегистрации(\"Лог\", УровеньЖурналаРегистрации.Информация,,,ЧитабельныйТекст);\r\n//\r\nПроцедура ЗаменитьСсылкиНаНавигационные(Объект) Экспорт\r\n\t\r\n\tЕсли ТипЗнч(Объект) = Тип(\"Массив\") Тогда\r\n\t\t\r\n\t\tДля Индекс = 0 По Объект.Количество() - 1 Цикл\r\n\t\t\tЗначение = Объект[Индекс];\r\n\t\t\tЗаменитьСсылкиНаНавигационные(Значение);\r\n\t\t\tОбъект[Индекс] = Значение;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tИначеЕсли ТипЗнч(Объект) = Тип(\"Структура\")\r\n\t\tИЛИ ТипЗнч(Объект) = Тип(\"Соответствие\") Тогда\r\n\t\t\r\n\t\tДля Каждого КлючИЗначение Из Объект Цикл\r\n\t\t\tЗначение = КлючИЗначение.Значение;\r\n\t\t\tЗаменитьСсылкиНаНавигационные(Значение);\r\n\t\t\tОбъект[КлючИЗначение.Ключ] = Значение;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tОбъектМетаданных = Метаданные.НайтиПоТипу(ТипЗнч(Объект));\r\n\t\tЕсли ОбъектМетаданных <> Неопределено Тогда\r\n\t\t\tОбъект = ПолучитьНавигационнуюСсылку(Объект);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Отформатированный текст запроса",
    "description": "Отформатированный текст запроса",
    "code_snippet": "// Возвращает отформатированный текст запроса.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/62\r\n//  \r\n// Параметры:\r\n//  ТекстЗапроса - Строка\r\n//  РежимКомпоновкиДанных - Булево\r\n// \r\n// Возвращаемое значение:\r\n//  Строка\r\n//  \r\n// Пример:\r\n//  ТекстЗапроса = \"ВЫБРАТЬ \" + ВыбираемыеПоля + \" ИЗ \" + Таблица + \" ГДЕ \" + Условия;\r\n//  ТекстЗапроса = ОтформатированныйТекстЗапроса(ТекстЗапроса); //Читабельный текст запроса\r\n//  \r\nФункция ОтформатированныйТекстЗапроса(Знач ТекстЗапроса, Знач РежимКомпоновкиДанных = Ложь) Экспорт\r\n\t\r\n\tСхемаЗапроса = Новый СхемаЗапроса();\r\n\tСхемаЗапроса.РежимКомпоновкиДанных = РежимКомпоновкиДанных;\r\n\tСхемаЗапроса.УстановитьТекстЗапроса(ТекстЗапроса);\r\n\t\r\n\tВозврат СхемаЗапроса.ПолучитьТекстЗапроса();\r\n\t\r\nКонецФункции\n\n// Возвращает отформатированный текст запроса.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/62\r\n//  \r\n// Параметры:\r\n//  ТекстЗапроса - Строка\r\n//  РежимКомпоновкиДанных - Булево\r\n// \r\n// Возвращаемое значение:\r\n//  Строка\r\n//  \r\n// Пример:\r\n//  ТекстЗапроса = \"ВЫБРАТЬ \" + ВыбираемыеПоля + \" ИЗ \" + Таблица + \" ГДЕ \" + Условия;\r\n//  ТекстЗапроса = ОтформатированныйТекстЗапроса(ТекстЗапроса); //Читабельный текст запроса\r\n//  \r\nФункция ОтформатированныйТекстЗапроса(Знач ТекстЗапроса, Знач РежимКомпоновкиДанных = Ложь) Экспорт\r\n\t\r\n\tСхемаЗапроса = Новый СхемаЗапроса();\r\n\tСхемаЗапроса.РежимКомпоновкиДанных = РежимКомпоновкиДанных;\r\n\tСхемаЗапроса.УстановитьТекстЗапроса(ТекстЗапроса);\r\n\t\r\n\tВозврат СхемаЗапроса.ПолучитьТекстЗапроса();\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Заполнить параметры запроса",
    "description": "Заполнить параметры запроса",
    "code_snippet": "// Заполняет в запросе параметры из структуры (берет только те, что есть в запросе, игнорируя лишние свойства).\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/5\r\n// \r\n// Параметры:\r\n//  Запрос - Запрос\r\n//  ИсточникПараметров - Структура\r\n//\r\n// Пример:\r\n//\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n//\tЗаполнитьПараметрыЗапроса(Запрос, ИсточникДанных);\r\n//\r\nПроцедура ЗаполнитьПараметрыЗапроса(Знач Запрос, Знач ИсточникПараметров) Экспорт\r\n\t\r\n\tДля Каждого ПараметрЗапроса Из Запрос.НайтиПараметры() Цикл\r\n\t\t\r\n\t\tИмяПараметра = ПараметрЗапроса.Имя;\r\n\t\tЗначениеПараметра = Неопределено;\r\n\t\tЕсли ИсточникПараметров.Свойство(ИмяПараметра, ЗначениеПараметра) Тогда\r\n\t\t\tЗапрос.УстановитьПараметр(ИмяПараметра, ЗначениеПараметра);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n// Заполняет в запросе параметры из структуры (берет только те, что есть в запросе, игнорируя лишние свойства).\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/5\r\n// \r\n// Параметры:\r\n//  Запрос - Запрос\r\n//  ИсточникПараметров - Структура\r\n//\r\n// Пример:\r\n//\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n//\tЗаполнитьПараметрыЗапроса(Запрос, ИсточникДанных);\r\n//\r\nПроцедура ЗаполнитьПараметрыЗапроса(Знач Запрос, Знач ИсточникПараметров) Экспорт\r\n\t\r\n\tДля Каждого ПараметрЗапроса Из Запрос.НайтиПараметры() Цикл\r\n\t\t\r\n\t\tИмяПараметра = ПараметрЗапроса.Имя;\r\n\t\tЗначениеПараметра = Неопределено;\r\n\t\tЕсли ИсточникПараметров.Свойство(ИмяПараметра, ЗначениеПараметра) Тогда\r\n\t\t\tЗапрос.УстановитьПараметр(ИмяПараметра, ЗначениеПараметра);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Данные таблицы базы данных",
    "description": "Данные таблицы базы данных",
    "code_snippet": "// Возвращает данные таблицы базы данных по отбору\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/71\r\n// \r\n// Параметры:\r\n//  Таблица  - Строка - Полное имя таблицы\r\n//  Отбор\t - Массив из ЭлементОтбора\r\n//           - Массив из Структура\r\n//  Колонки\t - Строка, Массив из Строка - Возвращаемые колонки. Если не указывать, то возвращаются все\r\n// \r\n// Возвращаемое значение:\r\n//  РезультатЗапроса\r\n//\r\n// Пример:\r\n//\t\r\n//\tИмяТаблицы = \"Справочник.ЖЧТ_ТестовыйСправочник\";\r\n//\tИменаКолонок = \"Ссылка,Код\";\r\n//\t\r\n//\tОтборы = Новый Массив;\r\n//\tОтборы.Добавить(Новый Структура(\"Имя,Значение\", \"ПометкаУдаления\", Ложь));\r\n//\tОтборы.Добавить(Новый Структура(\"Имя,ВидСравнения,Значение,\", \"Номер\", ВидСравнения.Больше, 1));\r\n//\t\r\n//\tРезультат = ТестируемыйМодуль.ДанныеТаблицыБазы(ИмяТаблицы, Отборы, ИменаКолонок);\r\n//\r\n//\r\nФункция ДанныеТаблицыБазы(Знач Таблица, Знач Отбор = Неопределено, Знач Колонки = Неопределено) Экспорт\r\n\t\r\n\tПостроитель  = Новый ПостроительЗапроса;\r\n\tПостроитель.Текст = СтрШаблон(\"ВЫБРАТЬ %1 ИЗ %2\", \"*\", Таблица);\r\n\tПостроитель.ЗаполнитьНастройки();\r\n\t\r\n\tЕсли НЕ Колонки = Неопределено Тогда\r\n\t\t\r\n\t\tЕсли ТипЗнч(Колонки) = Тип(\"Строка\") Тогда\r\n\t\t\t//@skip-check statement-type-change\r\n\t\t\tКолонки = СтрРазделить(Колонки, \",\");\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tПостроитель.ВыбранныеПоля.Очистить();\r\n\t\tДля Каждого ИмяКолонки Из Колонки Цикл\r\n\t\t\tПостроитель.ВыбранныеПоля.Добавить(ИмяКолонки);\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(Отбор) Тогда\r\n\t\tДля Каждого ЭлементОтбора Из Отбор Цикл\r\n\t\t\tНовыйЭлемент = Построитель.Отбор.Добавить(ЭлементОтбора.Имя);\r\n\t\t\tНовыйЭлемент.Использование = Истина;\r\n\t\t\tЗаполнитьЗначенияСвойств(НовыйЭлемент, ЭлементОтбора);\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\tПостроитель.Выполнить();\r\n\t\r\n\tВозврат Построитель.Результат;\r\n\t\t\r\nКонецФункции\n\n// Возвращает данные таблицы базы данных по отбору\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/71\r\n// \r\n// Параметры:\r\n//  Таблица  - Строка - Полное имя таблицы\r\n//  Отбор\t - Массив из ЭлементОтбора\r\n//           - Массив из Структура\r\n//  Колонки\t - Строка, Массив из Строка - Возвращаемые колонки. Если не указывать, то возвращаются все\r\n// \r\n// Возвращаемое значение:\r\n//  РезультатЗапроса\r\n//\r\n// Пример:\r\n//\t\r\n//\tИмяТаблицы = \"Справочник.ЖЧТ_ТестовыйСправочник\";\r\n//\tИменаКолонок = \"Ссылка,Код\";\r\n//\t\r\n//\tОтборы = Новый Массив;\r\n//\tОтборы.Добавить(Новый Структура(\"Имя,Значение\", \"ПометкаУдаления\", Ложь));\r\n//\tОтборы.Добавить(Новый Структура(\"Имя,ВидСравнения,Значение,\", \"Номер\", ВидСравнения.Больше, 1));\r\n//\t\r\n//\tРезультат = ТестируемыйМодуль.ДанныеТаблицыБазы(ИмяТаблицы, Отборы, ИменаКолонок);\r\n//\r\n//\r\nФункция ДанныеТаблицыБазы(Знач Таблица, Знач Отбор = Неопределено, Знач Колонки = Неопределено) Экспорт\r\n\t\r\n\tПостроитель  = Новый ПостроительЗапроса;\r\n\tПостроитель.Текст = СтрШаблон(\"ВЫБРАТЬ %1 ИЗ %2\", \"*\", Таблица);\r\n\tПостроитель.ЗаполнитьНастройки();\r\n\t\r\n\tЕсли НЕ Колонки = Неопределено Тогда\r\n\t\t\r\n\t\tЕсли ТипЗнч(Колонки) = Тип(\"Строка\") Тогда\r\n\t\t\t//@skip-check statement-type-change\r\n\t\t\tКолонки = СтрРазделить(Колонки, \",\");\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tПостроитель.ВыбранныеПоля.Очистить();\r\n\t\tДля Каждого ИмяКолонки Из Колонки Цикл\r\n\t\t\tПостроитель.ВыбранныеПоля.Добавить(ИмяКолонки);\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(Отбор) Тогда\r\n\t\tДля Каждого ЭлементОтбора Из Отбор Цикл\r\n\t\t\tНовыйЭлемент = Построитель.Отбор.Добавить(ЭлементОтбора.Имя);\r\n\t\t\tНовыйЭлемент.Использование = Истина;\r\n\t\t\tЗаполнитьЗначенияСвойств(НовыйЭлемент, ЭлементОтбора);\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\tПостроитель.Выполнить();\r\n\t\r\n\tВозврат Построитель.Результат;\r\n\t\t\r\nКонецФункции"
  },
  {
    "title": "Проведение документа с проверкой заполнения",
    "description": "Проведение документа с проверкой заполнения",
    "code_snippet": "Функция ПровестиДокумент(ДокументОбъект) Экспорт\r\n\t\r\n\tРезультат = Новый Структура(\"УспешноПроведен, ОписаниеОшибки\");\r\n\t\r\n\tЕсли ДокументОбъект.ПроверитьЗаполнение() Тогда\r\n\t\tРежимПроведения = РежимПроведенияДокумента.Неоперативный;\r\n\t\tЕсли ДокументОбъект.Дата >= НачалоДня(ТекущаяДатаСеанса())\r\n\t\t\tИ ДокументСсылка.Метаданные().ОперативноеПроведение = Метаданные.СвойстваОбъектов.ОперативноеПроведение.Разрешить Тогда\r\n\t\t\tРежимПроведения = РежимПроведенияДокумента.Оперативный;\r\n\t\tКонецЕсли;\r\n\t\tПопытка\r\n\t\t\tДокументОбъект.Записать(РежимЗаписиДокумента.Проведение, РежимПроведения);\r\n\t\t\tРезультат.УспешноПроведен = Истина;\r\n\t\tИсключение\r\n\t\t\tПредставлениеОшибки = КраткоеПредставлениеОшибки(ИнформацияОбОшибке());\r\n\t\t\tРезультат.УспешноПроведен = Ложь;\r\n\t\t\tРезультат.ОписаниеОшибки = ПредставлениеОшибки;\r\n\t\t\tДокументОбъект.Записать(РежимЗаписиДокумента.Запись, РежимПроведения);\r\n\t\tКонецПопытки;\r\n\tИначе\r\n\t\tДокументОбъект.Записать(РежимЗаписиДокумента.Запись, РежимПроведения);\r\n\t\tПредставлениеОшибки = НСтр(\"ru = 'Ошибки проверки заполнения:'\");\r\n\t\tСообПольз = ПолучитьСообщенияПользователю(Истина);\r\n\t\tДля Каждого ТекСооб Из СообПольз Цикл\r\n\t\t\tПредставлениеОшибки = ПредставлениеОшибки + Символы.ПС + ТекСооб.Текст;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tРезультат.УспешноПроведен = Ложь;\r\n\t\tРезультат.ОписаниеОшибки = ПредставлениеОшибки;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nФункция ПровестиДокумент(ДокументОбъект) Экспорт\r\n\t\r\n\tРезультат = Новый Структура(\"УспешноПроведен, ОписаниеОшибки\");\r\n\t\r\n\tЕсли ДокументОбъект.ПроверитьЗаполнение() Тогда\r\n\t\tРежимПроведения = РежимПроведенияДокумента.Неоперативный;\r\n\t\tЕсли ДокументОбъект.Дата >= НачалоДня(ТекущаяДатаСеанса())\r\n\t\t\tИ ДокументСсылка.Метаданные().ОперативноеПроведение = Метаданные.СвойстваОбъектов.ОперативноеПроведение.Разрешить Тогда\r\n\t\t\tРежимПроведения = РежимПроведенияДокумента.Оперативный;\r\n\t\tКонецЕсли;\r\n\t\tПопытка\r\n\t\t\tДокументОбъект.Записать(РежимЗаписиДокумента.Проведение, РежимПроведения);\r\n\t\t\tРезультат.УспешноПроведен = Истина;\r\n\t\tИсключение\r\n\t\t\tПредставлениеОшибки = КраткоеПредставлениеОшибки(ИнформацияОбОшибке());\r\n\t\t\tРезультат.УспешноПроведен = Ложь;\r\n\t\t\tРезультат.ОписаниеОшибки = ПредставлениеОшибки;\r\n\t\t\tДокументОбъект.Записать(РежимЗаписиДокумента.Запись, РежимПроведения);\r\n\t\tКонецПопытки;\r\n\tИначе\r\n\t\tДокументОбъект.Записать(РежимЗаписиДокумента.Запись, РежимПроведения);\r\n\t\tПредставлениеОшибки = НСтр(\"ru = 'Ошибки проверки заполнения:'\");\r\n\t\tСообПольз = ПолучитьСообщенияПользователю(Истина);\r\n\t\tДля Каждого ТекСооб Из СообПольз Цикл\r\n\t\t\tПредставлениеОшибки = ПредставлениеОшибки + Символы.ПС + ТекСооб.Текст;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tРезультат.УспешноПроведен = Ложь;\r\n\t\tРезультат.ОписаниеОшибки = ПредставлениеОшибки;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Пример подключение к базе MS SQL через внешние источники данных 1С",
    "description": "Пример подключение к базе MS SQL через внешние источники данных 1С",
    "code_snippet": "Функция ПолучитьПараметрыСервера() Экспорт\t\r\n\t\r\n\tДля каждого строкаПодключения из Объект.ПараметрыПодключения Цикл\r\n\t\tЕсли строкаПодключения.Выбор  Тогда\r\n\t\t\tИмяСервераSQL = строкаПодключения.Server;\r\n\t\t\tПользовательSQL = строкаПодключения.User;\r\n\t\t\tПарольSQL = строкаПодключения.Password;\r\n\t\t\tБазаДанныхSQL = строкаПодключения.Base;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\r\n\tСтрока =\r\n\t\"driver={SQL Server};\" +\r\n\t\"server=\"+ИмяСервераSQL+\";\"+\r\n\t\"database=\"+БазаДанныхSQL+\";\";\r\n\r\n\tПСБ_СтрокаСоединения = Строка;\r\n\tПСБ_АутентификацияСтандартная = Истина;\r\n\tПСБ_ИмяПользователя = ПользовательSQL;\r\n\tПСБ_Пароль = ПарольSQL;\r\n\tПСБ_СУБД = \"MS SQL Server\";\r\n\tПСБ_БД = БазаДанныхSQL;\r\n\t\r\n\tСтрокаСоедененияССервером = \"driver={SQL Server};\" +\r\n\t\"server=\"+ИмяСервераSQL+\";\"+\r\n\t\"uid=\"+ПользовательSQL+\";\"+\r\n\t\"pwd=\"+ПарольSQL+\";\"+\r\n\t\"database=\"+БазаДанныхSQL+\";\";\r\n\r\n\t\r\n\t\r\n\tПараметрыСервера = Новый Структура;\r\n\t\r\n\tПараметрыСервера.Вставить(\"ПСБ_СтрокаСоединения\", ПСБ_СтрокаСоединения);\r\n\tПараметрыСервера.Вставить(\"ПСБ_АутентификацияСтандартная\", ПСБ_АутентификацияСтандартная);\r\n\tПараметрыСервера.Вставить(\"ПСБ_ИмяПользователя\", ПСБ_ИмяПользователя);\r\n\tПараметрыСервера.Вставить(\"ПСБ_Пароль\", ПСБ_Пароль);\r\n\tПараметрыСервера.Вставить(\"ПСБ_СУБД\", ПСБ_СУБД);\r\n\tПараметрыСервера.Вставить(\"ПСБ_БД\", ПСБ_БД);\r\n\tПараметрыСервера.Вставить(\"СтрокаСоедененияССервером\", СтрокаСоедененияССервером);\r\n\t\r\n\tВозврат ПараметрыСервера;\r\n\t\r\n\t\r\nКонецФункции\r\n\r\n&НаСервере\r\nПроцедура ПроверитьПодключениеНаСервере()\r\n\t\r\n\tПараметрыСервера = ПолучитьПараметрыСервера();\r\n\tПараметрыСоединенияСБазой = Новый ПараметрыСоединенияВнешнегоИсточникаДанных;\r\n\tПараметрыСоединенияСБазой.СтрокаСоединения = ПараметрыСервера.ПСБ_СтрокаСоединения;\r\n\tПараметрыСоединенияСБазой.АутентификацияСтандартная = ПараметрыСервера.ПСБ_АутентификацияСтандартная;\r\n\tПараметрыСоединенияСБазой.ИмяПользователя = ПараметрыСервера.ПСБ_ИмяПользователя;\r\n\tПараметрыСоединенияСБазой.Пароль = ПараметрыСервера.ПСБ_Пароль;\r\n\tПараметрыСоединенияСБазой.СУБД = ПараметрыСервера.ПСБ_СУБД;\r\n\t\r\n\tВнешниеИсточникиДанных.ForRestPOS.УстановитьПараметрыСоединенияСеанса(ПараметрыСоединенияСБазой);\r\n\tПопытка\r\n\t\tВнешниеИсточникиДанных.ForRestPOS.УстановитьСоединение();\r\n\t\tСообщить(\"Подключение успешно!\");\r\n\tИсключение\r\n\t\tСообщить(\"Подключение не установлено!\");\r\n\tКонецПопытки;\r\n\r\nКонецПроцедуры\n\nФункция ПолучитьПараметрыСервера() Экспорт\t\r\n\t\r\n\tДля каждого строкаПодключения из Объект.ПараметрыПодключения Цикл\r\n\t\tЕсли строкаПодключения.Выбор  Тогда\r\n\t\t\tИмяСервераSQL = строкаПодключения.Server;\r\n\t\t\tПользовательSQL = строкаПодключения.User;\r\n\t\t\tПарольSQL = строкаПодключения.Password;\r\n\t\t\tБазаДанныхSQL = строкаПодключения.Base;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\r\n\tСтрока =\r\n\t\"driver={SQL Server};\" +\r\n\t\"server=\"+ИмяСервераSQL+\";\"+\r\n\t\"database=\"+БазаДанныхSQL+\";\";\r\n\r\n\tПСБ_СтрокаСоединения = Строка;\r\n\tПСБ_АутентификацияСтандартная = Истина;\r\n\tПСБ_ИмяПользователя = ПользовательSQL;\r\n\tПСБ_Пароль = ПарольSQL;\r\n\tПСБ_СУБД = \"MS SQL Server\";\r\n\tПСБ_БД = БазаДанныхSQL;\r\n\t\r\n\tСтрокаСоедененияССервером = \"driver={SQL Server};\" +\r\n\t\"server=\"+ИмяСервераSQL+\";\"+\r\n\t\"uid=\"+ПользовательSQL+\";\"+\r\n\t\"pwd=\"+ПарольSQL+\";\"+\r\n\t\"database=\"+БазаДанныхSQL+\";\";\r\n\r\n\t\r\n\t\r\n\tПараметрыСервера = Новый Структура;\r\n\t\r\n\tПараметрыСервера.Вставить(\"ПСБ_СтрокаСоединения\", ПСБ_СтрокаСоединения);\r\n\tПараметрыСервера.Вставить(\"ПСБ_АутентификацияСтандартная\", ПСБ_АутентификацияСтандартная);\r\n\tПараметрыСервера.Вставить(\"ПСБ_ИмяПользователя\", ПСБ_ИмяПользователя);\r\n\tПараметрыСервера.Вставить(\"ПСБ_Пароль\", ПСБ_Пароль);\r\n\tПараметрыСервера.Вставить(\"ПСБ_СУБД\", ПСБ_СУБД);\r\n\tПараметрыСервера.Вставить(\"ПСБ_БД\", ПСБ_БД);\r\n\tПараметрыСервера.Вставить(\"СтрокаСоедененияССервером\", СтрокаСоедененияССервером);\r\n\t\r\n\tВозврат ПараметрыСервера;\r\n\t\r\n\t\r\nКонецФункции\r\n\r\n&НаСервере\r\nПроцедура ПроверитьПодключениеНаСервере()\r\n\t\r\n\tПараметрыСервера = ПолучитьПараметрыСервера();\r\n\tПараметрыСоединенияСБазой = Новый ПараметрыСоединенияВнешнегоИсточникаДанных;\r\n\tПараметрыСоединенияСБазой.СтрокаСоединения = ПараметрыСервера.ПСБ_СтрокаСоединения;\r\n\tПараметрыСоединенияСБазой.АутентификацияСтандартная = ПараметрыСервера.ПСБ_АутентификацияСтандартная;\r\n\tПараметрыСоединенияСБазой.ИмяПользователя = ПараметрыСервера.ПСБ_ИмяПользователя;\r\n\tПараметрыСоединенияСБазой.Пароль = ПараметрыСервера.ПСБ_Пароль;\r\n\tПараметрыСоединенияСБазой.СУБД = ПараметрыСервера.ПСБ_СУБД;\r\n\t\r\n\tВнешниеИсточникиДанных.ForRestPOS.УстановитьПараметрыСоединенияСеанса(ПараметрыСоединенияСБазой);\r\n\tПопытка\r\n\t\tВнешниеИсточникиДанных.ForRestPOS.УстановитьСоединение();\r\n\t\tСообщить(\"Подключение успешно!\");\r\n\tИсключение\r\n\t\tСообщить(\"Подключение не установлено!\");\r\n\tКонецПопытки;\r\n\r\nКонецПроцедуры\n\nОрфографическая ошибка в СтрокаСоедененияССервером (найдено 3): Соеденения"
  },
  {
    "title": "ИР Свернуть другие строки",
    "description": "ИР Свернуть другие строкиTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "В Запросе - Преобразовать количество остатков в строки запроса",
    "description": "В Запросе - Преобразовать количество остатков в строки запроса",
    "code_snippet": "ВЫБРАТЬ\r\n\t0 КАК Х\r\nПОМЕСТИТЬ Регистр1\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n\t1\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tМладшие.Х + 2 * Старшие.Х КАК Х\r\nПОМЕСТИТЬ Регистр2\r\nИЗ\r\n\tРегистр1 КАК Младшие,\r\n\tРегистр1 КАК Старшие\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tМладшие.Х + 4 * Старшие.Х КАК Х\r\nПОМЕСТИТЬ Регистр3\r\nИЗ\r\n\tРегистр2 КАК Младшие,\r\n\tРегистр2 КАК Старшие\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации.Номенклатура КАК Номенклатура,\r\n\tВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации.Номенклатура.Код КАК НоменклатураКод,\r\n\tВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации.Количество КАК Количество\r\nПОМЕСТИТЬ Вт_Ном\r\nИЗ\r\n\tДокумент.ВводОстатковТМЦВЭксплуатации.ТМЦВЭксплуатации КАК ВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации\r\n\t\tЛЕВОЕ СОЕДИНЕНИЕ Документ.ВводОстатковТМЦВЭксплуатации КАК ВводОстатковТМЦВЭксплуатации\r\n\t\tПО ВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации.Ссылка = ВводОстатковТМЦВЭксплуатации.Ссылка\r\nГДЕ\r\n\tВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации.Номенклатура.ВидНоменклатуры = &ВидНоменклатуры\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tВт_Ном.Номенклатура КАК Номенклатура,\r\n\tВт_Ном.НоменклатураКод КАК НоменклатураКод,\r\n\t1 КАК КолВо\r\nИЗ\r\n\tВт_Ном КАК Вт_Ном\r\n\t\tЛЕВОЕ СОЕДИНЕНИЕ Регистр3 КАК Регистр3\r\n\t\tПО (Регистр3.Х < Вт_Ном.Количество)\n\nВЫБРАТЬ\r\n\t0 КАК Х\r\nПОМЕСТИТЬ Регистр1\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n\t1\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tМладшие.Х + 2 * Старшие.Х КАК Х\r\nПОМЕСТИТЬ Регистр2\r\nИЗ\r\n\tРегистр1 КАК Младшие,\r\n\tРегистр1 КАК Старшие\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tМладшие.Х + 4 * Старшие.Х КАК Х\r\nПОМЕСТИТЬ Регистр3\r\nИЗ\r\n\tРегистр2 КАК Младшие,\r\n\tРегистр2 КАК Старшие\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации.Номенклатура КАК Номенклатура,\r\n\tВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации.Номенклатура.Код КАК НоменклатураКод,\r\n\tВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации.Количество КАК Количество\r\nПОМЕСТИТЬ Вт_Ном\r\nИЗ\r\n\tДокумент.ВводОстатковТМЦВЭксплуатации.ТМЦВЭксплуатации КАК ВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации\r\n\t\tЛЕВОЕ СОЕДИНЕНИЕ Документ.ВводОстатковТМЦВЭксплуатации КАК ВводОстатковТМЦВЭксплуатации\r\n\t\tПО ВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации.Ссылка = ВводОстатковТМЦВЭксплуатации.Ссылка\r\nГДЕ\r\n\tВводОстатковТМЦВЭксплуатацииТМЦВЭксплуатации.Номенклатура.ВидНоменклатуры = &ВидНоменклатуры\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tВт_Ном.Номенклатура КАК Номенклатура,\r\n\tВт_Ном.НоменклатураКод КАК НоменклатураКод,\r\n\t1 КАК КолВо\r\nИЗ\r\n\tВт_Ном КАК Вт_Ном\r\n\t\tЛЕВОЕ СОЕДИНЕНИЕ Регистр3 КАК Регистр3\r\n\t\tПО (Регистр3.Х < Вт_Ном.Количество)\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Переход к следующей/предыдущей процедуре/функции модуля",
    "description": "Переход к следующей/предыдущей процедуре/функции модуля",
    "code_snippet": ""
  },
  {
    "title": "Список горячих клавиш TurboConf в формате Anki",
    "description": "Список горячих клавиш TurboConf для заучивания методом интервальных повторений при помощи Anki",
    "code_snippet": ""
  },
  {
    "title": "Поиск http ссылок в тексте, без RegEx.",
    "description": "Поиск http ссылок в тексте, без RegEx.",
    "code_snippet": "Функция НайтиСсылки(Текст)\r\n\t\r\n\tСсылки = Новый Массив;\r\n\t\r\n\tНачальнаяПозицияПоиска = 1;\r\n\tНомерПоследнейПозиции = СтрДлина(Текст);\r\n\tПока Истина Цикл\r\n\t\t\r\n\t\tЕсли НачальнаяПозицияПоиска > НомерПоследнейПозиции Тогда\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tНачальнаяПозиция = СтрНайти(Текст, \"http\", НаправлениеПоиска.СНачала, НачальнаяПозицияПоиска);\r\n\t\tЕсли НачальнаяПозиция > 0 Тогда\r\n\t\t\tЧислоСимволов = 4;\r\n\t\t\tПока Истина Цикл\r\n\t\t\t\tЧислоСимволов = ЧислоСимволов + 1;\r\n\t\t\t\tЕсли (НачальнаяПозицияПоиска + ЧислоСимволов - 1 > НомерПоследнейПозиции) Или ПустаяСтрока(Прав(Сред(Текст, НачальнаяПозиция, ЧислоСимволов), 1)) Тогда\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tСсылки.Добавить(Сред(Текст, НачальнаяПозиция, ЧислоСимволов - 1));\r\n\t\t\tНачальнаяПозицияПоиска = НачальнаяПозиция + ЧислоСимволов - 1;\r\n\t\tИначе\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Ссылки;\r\n\t\r\nКонецФункции\n\nФункция НайтиСсылки(Текст)\r\n\t\r\n\tСсылки = Новый Массив;\r\n\t\r\n\tНачальнаяПозицияПоиска = 1;\r\n\tНомерПоследнейПозиции = СтрДлина(Текст);\r\n\tПока Истина Цикл\r\n\t\t\r\n\t\tЕсли НачальнаяПозицияПоиска > НомерПоследнейПозиции Тогда\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tНачальнаяПозиция = СтрНайти(Текст, \"http\", НаправлениеПоиска.СНачала, НачальнаяПозицияПоиска);\r\n\t\tЕсли НачальнаяПозиция > 0 Тогда\r\n\t\t\tЧислоСимволов = 4;\r\n\t\t\tПока Истина Цикл\r\n\t\t\t\tЧислоСимволов = ЧислоСимволов + 1;\r\n\t\t\t\tЕсли (НачальнаяПозицияПоиска + ЧислоСимволов - 1 > НомерПоследнейПозиции) Или ПустаяСтрока(Прав(Сред(Текст, НачальнаяПозиция, ЧислоСимволов), 1)) Тогда\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tСсылки.Добавить(Сред(Текст, НачальнаяПозиция, ЧислоСимволов - 1));\r\n\t\t\tНачальнаяПозицияПоиска = НачальнаяПозиция + ЧислоСимволов - 1;\r\n\t\tИначе\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Ссылки;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "ИР Объявить тип выражения",
    "description": "ИР Объявить тип выраженияTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Использование таблицы в качестве параметра",
    "description": "Использование таблицы в качестве параметра",
    "code_snippet": "ТЗЦеныТиповРабот = Новый ТаблицаЗначений;\r\nТЗЦеныТиповРабот.Колонки.Добавить(\"ТипРабот\", Новый ОписаниеТипов(\"Строка\",КвалификаторСтроки)); \r\nТЗЦеныТиповРабот.Колонки.Добавить(\"Цена\", Новый ОписаниеТипов(\"Число\",КвалификаторЧисла));\r\nДля Каждого СтрокаТЗ Из ЦеныТиповРабот Цикл\r\n\tНоваяСтрока = ТЗЦеныТиповРабот.Добавить();\r\n\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаТЗ); \r\n\tНоваяСтрока.ТипРабот = СокрЛП(СтрокаТЗ.ТипРабот);\r\nКонецЦикла;\r\n\t\r\nЗапрос = Новый Запрос; \r\nЗапрос.УстановитьПараметр(\"ТрудозатратыСотрудника\", ТЗТрудозатратыСотрудника);\r\nЗапрос.УстановитьПараметр(\"СтоимостьРабот\", ТЗЦеныТиповРабот);\r\nЗапрос.УстановитьПараметр(\"СуммаРаспределить\", СуммаЗаработнойПлатыСотрудника);\r\nЗапрос.Текст = \"ВЫБРАТЬ\r\n\t               |\tТрудозатратыСотрудника.ВидРабот КАК ВидРабот,\r\n\t               |\tТрудозатратыСотрудника.ТипРабот КАК ТипРабот,\r\n\t               |\tТрудозатратыСотрудника.ЗатраченоЧасов КАК ЗатраченоЧасов\r\n\t               |ПОМЕСТИТЬ ВТ_ТрудозатратыСотрудника\r\n\t               |ИЗ\r\n\t               |\t&ТрудозатратыСотрудника КАК ТрудозатратыСотрудника\r\n\t               |;\r\n\t               |\r\n\t               |////////////////////////////////////////////////////////////////////////////////\r\n\t               |ВЫБРАТЬ\r\n\t               |\tСтоимостьРабот.ТипРабот КАК ТипРабот,\r\n\t               |\tСтоимостьРабот.Цена КАК Цена\r\n\t               |ПОМЕСТИТЬ ВТ_СтоимостьРабот\r\n\t               |ИЗ\r\n\t               |\t&СтоимостьРабот КАК СтоимостьРабот\r\n\t               |;\r\n\t               |\r\n\t               |////////////////////////////////////////////////////////////////////////////////\r\n\t               |ВЫБРАТЬ ПЕРВЫЕ 5\r\n\t               |\tВТ_ТрудозатратыСотрудника.ВидРабот КАК ВидРабот,\r\n\t               |\tВТ_ТрудозатратыСотрудника.ТипРабот КАК ТипРабот,\r\n\t               |\tВТ_ТрудозатратыСотрудника.ЗатраченоЧасов КАК ЗатраченоЧасов,\r\n\t               |\tЕСТЬNULL(ВТ_СтоимостьРабот.Цена, 0) КАК Цена,\r\n\t               |\tВТ_ТрудозатратыСотрудника.ЗатраченоЧасов * ЕСТЬNULL(ВТ_СтоимостьРабот.Цена, 0) КАК Стоимость\r\n\t               |ПОМЕСТИТЬ ВТ_5Записей\r\n\t               |ИЗ\r\n\t               |\tВТ_ТрудозатратыСотрудника КАК ВТ_ТрудозатратыСотрудника\r\n\t               |\t\tЛЕВОЕ СОЕДИНЕНИЕ ВТ_СтоимостьРабот КАК ВТ_СтоимостьРабот\r\n\t               |\t\tПО ВТ_ТрудозатратыСотрудника.ТипРабот = ВТ_СтоимостьРабот.ТипРабот\r\n\t               |\r\n\t               |УПОРЯДОЧИТЬ ПО\r\n\t               |\tСтоимость УБЫВ\r\n\t               |;\r\n\t               |\r\n\t               |////////////////////////////////////////////////////////////////////////////////\r\n\t               |ВЫБРАТЬ\r\n\t               |\tСУММА(ВТ_5Записей.Стоимость) КАК Стоимость\r\n\t               |ПОМЕСТИТЬ ИтогоСтоимость\r\n\t               |ИЗ\r\n\t               |\tВТ_5Записей КАК ВТ_5Записей\r\n\t               |;\r\n\t               |\r\n\t               |////////////////////////////////////////////////////////////////////////////////\r\n\t               |ВЫБРАТЬ\r\n\t               |\tВТ_5Записей.ВидРабот КАК ВидРабот,\r\n\t               |\tВТ_5Записей.ТипРабот КАК ТипРабот,\r\n\t               |\tВТ_5Записей.ЗатраченоЧасов КАК ЗатраченоЧасов,\r\n\t               |\tВТ_5Записей.Цена КАК Цена,\r\n\t               |\tВТ_5Записей.Стоимость КАК Стоимость,\r\n\t               |\tВТ_5Записей.Стоимость * 100 / ИтогоСтоимость.Стоимость КАК ПроцентРаспределения,\r\n\t               |\tВТ_5Записей.Стоимость * 100 / ИтогоСтоимость.Стоимость * &СуммаРаспределить / 100 КАК СуммаЗП\r\n\t               |ИЗ\r\n\t               |\tВТ_5Записей КАК ВТ_5Записей\r\n\t               |\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ ИтогоСтоимость КАК ИтогоСтоимость\r\n\t               |\t\tПО (ИСТИНА)\";\r\n\t\r\nРезультат = Запрос.Выполнить().Выгрузить();  \r\nДЛя каждого СтрокаТЗ из Результат Цикл\r\n\tНоваяСтрока = РезультатОтчет.Добавить();\r\n\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаТЗ);\t\r\nКонецЦикла;\n\nТЗЦеныТиповРабот = Новый ТаблицаЗначений;\r\nТЗЦеныТиповРабот.Колонки.Добавить(\"ТипРабот\", Новый ОписаниеТипов(\"Строка\",КвалификаторСтроки)); \r\nТЗЦеныТиповРабот.Колонки.Добавить(\"Цена\", Новый ОписаниеТипов(\"Число\",КвалификаторЧисла));\r\nДля Каждого СтрокаТЗ Из ЦеныТиповРабот Цикл\r\n\tНоваяСтрока = ТЗЦеныТиповРабот.Добавить();\r\n\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаТЗ); \r\n\tНоваяСтрока.ТипРабот = СокрЛП(СтрокаТЗ.ТипРабот);\r\nКонецЦикла;\r\n\t\r\nЗапрос = Новый Запрос; \r\nЗапрос.УстановитьПараметр(\"ТрудозатратыСотрудника\", ТЗТрудозатратыСотрудника);\r\nЗапрос.УстановитьПараметр(\"СтоимостьРабот\", ТЗЦеныТиповРабот);\r\nЗапрос.УстановитьПараметр(\"СуммаРаспределить\", СуммаЗаработнойПлатыСотрудника);\r\nЗапрос.Текст = \"ВЫБРАТЬ\r\n\t               |\tТрудозатратыСотрудника.ВидРабот КАК ВидРабот,\r\n\t               |\tТрудозатратыСотрудника.ТипРабот КАК ТипРабот,\r\n\t               |\tТрудозатратыСотрудника.ЗатраченоЧасов КАК ЗатраченоЧасов\r\n\t               |ПОМЕСТИТЬ ВТ_ТрудозатратыСотрудника\r\n\t               |ИЗ\r\n\t               |\t&ТрудозатратыСотрудника КАК ТрудозатратыСотрудника\r\n\t               |;\r\n\t               |\r\n\t               |////////////////////////////////////////////////////////////////////////////////\r\n\t               |ВЫБРАТЬ\r\n\t               |\tСтоимостьРабот.ТипРабот КАК ТипРабот,\r\n\t               |\tСтоимостьРабот.Цена КАК Цена\r\n\t               |ПОМЕСТИТЬ ВТ_СтоимостьРабот\r\n\t               |ИЗ\r\n\t               |\t&СтоимостьРабот КАК СтоимостьРабот\r\n\t               |;\r\n\t               |\r\n\t               |////////////////////////////////////////////////////////////////////////////////\r\n\t               |ВЫБРАТЬ ПЕРВЫЕ 5\r\n\t               |\tВТ_ТрудозатратыСотрудника.ВидРабот КАК ВидРабот,\r\n\t               |\tВТ_ТрудозатратыСотрудника.ТипРабот КАК ТипРабот,\r\n\t               |\tВТ_ТрудозатратыСотрудника.ЗатраченоЧасов КАК ЗатраченоЧасов,\r\n\t               |\tЕСТЬNULL(ВТ_СтоимостьРабот.Цена, 0) КАК Цена,\r\n\t               |\tВТ_ТрудозатратыСотрудника.ЗатраченоЧасов * ЕСТЬNULL(ВТ_СтоимостьРабот.Цена, 0) КАК Стоимость\r\n\t               |ПОМЕСТИТЬ ВТ_5Записей\r\n\t               |ИЗ\r\n\t               |\tВТ_ТрудозатратыСотрудника КАК ВТ_ТрудозатратыСотрудника\r\n\t               |\t\tЛЕВОЕ СОЕДИНЕНИЕ ВТ_СтоимостьРабот КАК ВТ_СтоимостьРабот\r\n\t               |\t\tПО ВТ_ТрудозатратыСотрудника.ТипРабот = ВТ_СтоимостьРабот.ТипРабот\r\n\t               |\r\n\t               |УПОРЯДОЧИТЬ ПО\r\n\t               |\tСтоимость УБЫВ\r\n\t               |;\r\n\t               |\r\n\t               |////////////////////////////////////////////////////////////////////////////////\r\n\t               |ВЫБРАТЬ\r\n\t               |\tСУММА(ВТ_5Записей.Стоимость) КАК Стоимость\r\n\t               |ПОМЕСТИТЬ ИтогоСтоимость\r\n\t               |ИЗ\r\n\t               |\tВТ_5Записей КАК ВТ_5Записей\r\n\t               |;\r\n\t               |\r\n\t               |////////////////////////////////////////////////////////////////////////////////\r\n\t               |ВЫБРАТЬ\r\n\t               |\tВТ_5Записей.ВидРабот КАК ВидРабот,\r\n\t               |\tВТ_5Записей.ТипРабот КАК ТипРабот,\r\n\t               |\tВТ_5Записей.ЗатраченоЧасов КАК ЗатраченоЧасов,\r\n\t               |\tВТ_5Записей.Цена КАК Цена,\r\n\t               |\tВТ_5Записей.Стоимость КАК Стоимость,\r\n\t               |\tВТ_5Записей.Стоимость * 100 / ИтогоСтоимость.Стоимость КАК ПроцентРаспределения,\r\n\t               |\tВТ_5Записей.Стоимость * 100 / ИтогоСтоимость.Стоимость * &СуммаРаспределить / 100 КАК СуммаЗП\r\n\t               |ИЗ\r\n\t               |\tВТ_5Записей КАК ВТ_5Записей\r\n\t               |\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ ИтогоСтоимость КАК ИтогоСтоимость\r\n\t               |\t\tПО (ИСТИНА)\";\r\n\t\r\nРезультат = Запрос.Выполнить().Выгрузить();  \r\nДЛя каждого СтрокаТЗ из Результат Цикл\r\n\tНоваяСтрока = РезультатОтчет.Добавить();\r\n\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаТЗ);\t\r\nКонецЦикла;\n\nОрфографическая ошибка в ТрудозатратыСотрудника (найдено 6): Трудозатраты\r\nОрфографическая ошибка в ТЗТрудозатратыСотрудника: Трудозатраты\r\nОрфографическая ошибка в ВТ_ТрудозатратыСотрудника (найдено 8): Трудозатраты"
  },
  {
    "title": "КомпоновщикНастроек для выполнения отбора на форме",
    "description": "КомпоновщикНастроек для выполнения отбора на форме",
    "code_snippet": "&НаСервере\r\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\r\n\t\r\n\t// Инициализация реквизита формы КомпоновщикНастроекОтбор\r\n\r\n\tСхемаКомпоновкиОтбор = РеквизитФормыВЗначение(\"Объект\").ПолучитьМакет(\"ИмяМакета\");\r\n\tАдресВременногоХранилища = ПоместитьВоВременноеХранилище(СхемаКомпоновкиОтбор, УникальныйИдентификатор);\r\n\tИсточникНастроек = Новый ИсточникДоступныхНастроекКомпоновкиДанных(АдресВременногоХранилища);\r\n\tКомпоновщикНастроекОтбор.Инициализировать(ИсточникНастроек);\r\n\tКомпоновщикНастроекОтбор.ЗагрузитьНастройки(СхемаКомпоновкиОтбор.НастройкиПоУмолчанию);\r\n\r\n\t// если требуется восстановить НастройкиКомпоновщика\r\n\tНастройкиКомпоновщика = МояФункцияВосстановленияНастроекКомпоновщика();\r\n\tЕсли НастройкиКомпоновщика <> Неопределено Тогда\r\n\t\tКомпоновщикНастроекОтбор.ЗагрузитьНастройки(НастройкиКомпоновщика);\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ВыполнитьОтбор()\r\n\r\n\t// Произвольная процедура с заполнением таблицы отбора\r\n\r\n\tТаблицаОтбора = Новый ТаблицаЗначений;\r\n\t\r\n\tСхемаКомпоновкиОтбор = РеквизитФормыВЗначение(\"Объект\").ПолучитьМакет(\"ИмяМакета\");\r\n\tНастройкиКомпоновщика = КомпоновщикНастроекОтбор.ПолучитьНастройки();\r\n\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиОтбор,\r\n\t\t\t\t\t  НастройкиКомпоновщика, , ,\r\n\t\t\t\t\t  Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\r\n\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки);\r\n\t\t\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\tПроцессорВывода.УстановитьОбъект(ТаблицаОтбора);\r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновки);\r\n\r\n\t// в ТаблицаОтбора содержится результат выполнения схемы компоновки\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)\r\n\t// если требуется сохранить существующие НастройкиКомпоновщика\r\n\tНастройкиКомпоновщика = КомпоновщикНастроекИсключения.ПолучитьНастройки();\r\n\tМояПроцедураСохраненияНастроекКомпоновщика(НастройкиКомпоновщика);\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\r\n\t\r\n\t// Инициализация реквизита формы КомпоновщикНастроекОтбор\r\n\r\n\tСхемаКомпоновкиОтбор = РеквизитФормыВЗначение(\"Объект\").ПолучитьМакет(\"ИмяМакета\");\r\n\tАдресВременногоХранилища = ПоместитьВоВременноеХранилище(СхемаКомпоновкиОтбор, УникальныйИдентификатор);\r\n\tИсточникНастроек = Новый ИсточникДоступныхНастроекКомпоновкиДанных(АдресВременногоХранилища);\r\n\tКомпоновщикНастроекОтбор.Инициализировать(ИсточникНастроек);\r\n\tКомпоновщикНастроекОтбор.ЗагрузитьНастройки(СхемаКомпоновкиОтбор.НастройкиПоУмолчанию);\r\n\r\n\t// если требуется восстановить НастройкиКомпоновщика\r\n\tНастройкиКомпоновщика = МояФункцияВосстановленияНастроекКомпоновщика();\r\n\tЕсли НастройкиКомпоновщика <> Неопределено Тогда\r\n\t\tКомпоновщикНастроекОтбор.ЗагрузитьНастройки(НастройкиКомпоновщика);\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ВыполнитьОтбор()\r\n\r\n\t// Произвольная процедура с заполнением таблицы отбора\r\n\r\n\tТаблицаОтбора = Новый ТаблицаЗначений;\r\n\t\r\n\tСхемаКомпоновкиОтбор = РеквизитФормыВЗначение(\"Объект\").ПолучитьМакет(\"ИмяМакета\");\r\n\tНастройкиКомпоновщика = КомпоновщикНастроекОтбор.ПолучитьНастройки();\r\n\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиОтбор,\r\n\t\t\t\t\t  НастройкиКомпоновщика, , ,\r\n\t\t\t\t\t  Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\r\n\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки);\r\n\t\t\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\tПроцессорВывода.УстановитьОбъект(ТаблицаОтбора);\r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновки);\r\n\r\n\t// в ТаблицаОтбора содержится результат выполнения схемы компоновки\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)\r\n\t// если требуется сохранить существующие НастройкиКомпоновщика\r\n\tНастройкиКомпоновщика = КомпоновщикНастроекИсключения.ПолучитьНастройки();\r\n\tМояПроцедураСохраненияНастроекКомпоновщика(НастройкиКомпоновщика);\r\nКонецПроцедуры"
  },
  {
    "title": "ТаблицаЗначенийВМассивСтруктур",
    "description": "ТаблицаЗначенийВМассивСтруктур",
    "code_snippet": "Функция ТаблицаЗначенийВМассивСтруктур(ТаблицаЗначений)\r\n\r\n\tКолонкиТаблицы = Новый Массив;\r\n\tДля каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tКолонкиТаблицы.Добавить(Колонка.Имя);\r\n\tКонецЦикла;\r\n\tСтрокаКолонок = СтрСоединить(КолонкиТаблицы, \",\");\r\n\r\n\tМассивСтруктур = Новый Массив;\r\n\tДля каждого СтрокаТаблицыЗначений Из ТаблицаЗначений Цикл\r\n\t\tСтруктураСтроки = Новый Структура(СтрокаКолонок);\r\n\t\tЗаполнитьЗначенияСвойств(СтруктураСтроки, СтрокаТаблицыЗначений);\r\n\t\tМассивСтруктур.Добавить(СтруктураСтроки);\r\n\tКонецЦикла;\r\n\r\n\tВозврат МассивСтруктур;\r\n\r\nКонецФункции // ТаблицаЗначенийВМассивСтруктур()\n\nФункция ТаблицаЗначенийВМассивСтруктур(ТаблицаЗначений)\r\n\r\n\tКолонкиТаблицы = Новый Массив;\r\n\tДля каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tКолонкиТаблицы.Добавить(Колонка.Имя);\r\n\tКонецЦикла;\r\n\tСтрокаКолонок = СтрСоединить(КолонкиТаблицы, \",\");\r\n\r\n\tМассивСтруктур = Новый Массив;\r\n\tДля каждого СтрокаТаблицыЗначений Из ТаблицаЗначений Цикл\r\n\t\tСтруктураСтроки = Новый Структура(СтрокаКолонок);\r\n\t\tЗаполнитьЗначенияСвойств(СтруктураСтроки, СтрокаТаблицыЗначений);\r\n\t\tМассивСтруктур.Добавить(СтруктураСтроки);\r\n\tКонецЦикла;\r\n\r\n\tВозврат МассивСтруктур;\r\n\r\nКонецФункции // ТаблицаЗначенийВМассивСтруктур()\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "МассивСтруктурВТаблицуЗначений",
    "description": "МассивСтруктурВТаблицуЗначений",
    "code_snippet": "Функция МассивСтруктурВТаблицуЗначений(МассивСтруктур)\r\n\r\n\tТаблицаЗначений = Новый ТаблицаЗначений;\r\n\tДобавлятьКолонки = Истина;\r\n\t\r\n\tДля каждого СтруктураСтроки Из МассивСтруктур Цикл\r\n\t\t\r\n\t\tЕсли ДобавлятьКолонки Тогда\r\n\t\t\tДля каждого ЭлементСтруктуры Из СтруктураСтроки Цикл\r\n\t\t\t\tТаблицаЗначений.Колонки.Добавить(ЭлементСтруктуры.Ключ);\r\n\t\t\tКонецЦикла;\r\n\t\t\tДобавлятьКолонки = Ложь;\r\n\t\tКонецЕсли;\r\n\r\n\t\tНоваяСтрока = ТаблицаЗначений.Добавить();\r\n\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтруктураСтроки); \r\n\t\r\n\tКонецЦикла;\r\n\r\n\tВозврат ТаблицаЗначений;\r\n\r\nКонецФункции // МассивСтруктурВТаблицуЗначений()\n\nФункция МассивСтруктурВТаблицуЗначений(МассивСтруктур)\r\n\r\n\tТаблицаЗначений = Новый ТаблицаЗначений;\r\n\tДобавлятьКолонки = Истина;\r\n\t\r\n\tДля каждого СтруктураСтроки Из МассивСтруктур Цикл\r\n\t\t\r\n\t\tЕсли ДобавлятьКолонки Тогда\r\n\t\t\tДля каждого ЭлементСтруктуры Из СтруктураСтроки Цикл\r\n\t\t\t\tТаблицаЗначений.Колонки.Добавить(ЭлементСтруктуры.Ключ);\r\n\t\t\tКонецЦикла;\r\n\t\t\tДобавлятьКолонки = Ложь;\r\n\t\tКонецЕсли;\r\n\r\n\t\tНоваяСтрока = ТаблицаЗначений.Добавить();\r\n\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтруктураСтроки); \r\n\t\r\n\tКонецЦикла;\r\n\r\n\tВозврат ТаблицаЗначений;\r\n\r\nКонецФункции // МассивСтруктурВТаблицуЗначений()\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "СписокСтруктурВТаблицуЗначений",
    "description": "СписокСтруктурВТаблицуЗначений",
    "code_snippet": "Функция СписокСтруктурВТаблицуЗначений(СписокСтруктур)\r\n\r\n\tТаблицаЗначений = Новый ТаблицаЗначений;\r\n\tДля каждого ЭлементСписка Из СписокСтруктур Цикл\r\n\t\tСтруктураСтроки = ЭлементСписка.Значение;\r\n\t\tЕсли Не ТаблицаЗначений.Колонки.Количество() Тогда\r\n\t\t\tДля каждого ЭлементСтруктуры Из СтруктураСтроки Цикл\r\n\t\t\t\tТаблицаЗначений.Колонки.Добавить(ЭлементСтруктуры.Ключ);\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЕсли;\r\n\t\tНоваяСтрока = ТаблицаЗначений.Добавить();\r\n\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтруктураСтроки); \r\n\tКонецЦикла;\r\n\r\n\tВозврат ТаблицаЗначений;\r\n\r\nКонецФункции // СписокСтруктурВТаблицуЗначений()\n\nФункция СписокСтруктурВТаблицуЗначений(СписокСтруктур)\r\n\r\n\tТаблицаЗначений = Новый ТаблицаЗначений;\r\n\tДля каждого ЭлементСписка Из СписокСтруктур Цикл\r\n\t\tСтруктураСтроки = ЭлементСписка.Значение;\r\n\t\tЕсли Не ТаблицаЗначений.Колонки.Количество() Тогда\r\n\t\t\tДля каждого ЭлементСтруктуры Из СтруктураСтроки Цикл\r\n\t\t\t\tТаблицаЗначений.Колонки.Добавить(ЭлементСтруктуры.Ключ);\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЕсли;\r\n\t\tНоваяСтрока = ТаблицаЗначений.Добавить();\r\n\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтруктураСтроки); \r\n\tКонецЦикла;\r\n\r\n\tВозврат ТаблицаЗначений;\r\n\r\nКонецФункции // СписокСтруктурВТаблицуЗначений()\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "ТаблицаЗначенийВСписокСтруктур",
    "description": "ТаблицаЗначенийВСписокСтруктур",
    "code_snippet": "Функция ТаблицаЗначенийВСписокСтруктур(ТаблицаЗначений)\r\n\r\n\tКолонкиТаблицы = Новый Массив;\r\n\tДля каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tКолонкиТаблицы.Добавить(Колонка.Имя);\r\n\tКонецЦикла;\r\n\tСтрокаКолонок = СтрСоединить(КолонкиТаблицы, \",\");\r\n\t\r\n\tСписокСтруктур = Новый СписокЗначений;\r\n\tДля каждого СтрокаТаблицыЗначений Из ТаблицаЗначений Цикл\r\n\t\tСтруктураСтроки = Новый Структура(СтрокаКолонок);\r\n\t\tЗаполнитьЗначенияСвойств(СтруктураСтроки, СтрокаТаблицыЗначений);\r\n\t\tСписокСтруктур.Добавить(СтруктураСтроки);\r\n\tКонецЦикла;\r\n\r\n\tВозврат СписокСтруктур;\r\n\r\nКонецФункции // ТаблицаЗначенийВСписокСтруктур()\n\nФункция ТаблицаЗначенийВСписокСтруктур(ТаблицаЗначений)\r\n\r\n\tКолонкиТаблицы = Новый Массив;\r\n\tДля каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tКолонкиТаблицы.Добавить(Колонка.Имя);\r\n\tКонецЦикла;\r\n\tСтрокаКолонок = СтрСоединить(КолонкиТаблицы, \",\");\r\n\t\r\n\tСписокСтруктур = Новый СписокЗначений;\r\n\tДля каждого СтрокаТаблицыЗначений Из ТаблицаЗначений Цикл\r\n\t\tСтруктураСтроки = Новый Структура(СтрокаКолонок);\r\n\t\tЗаполнитьЗначенияСвойств(СтруктураСтроки, СтрокаТаблицыЗначений);\r\n\t\tСписокСтруктур.Добавить(СтруктураСтроки);\r\n\tКонецЦикла;\r\n\r\n\tВозврат СписокСтруктур;\r\n\r\nКонецФункции // ТаблицаЗначенийВСписокСтруктур()\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "Пример парсера XML файла через построитель DOM",
    "description": "Пример парсера XML файла через построитель DOM",
    "code_snippet": "Путь = \"Путь до файла\";\r\nМассивФайлов = НайтиФайлы(путь, \"*docum*.xml\", Ложь);\r\nКоличествоФайлов = МассивФайлов.Количество();\r\nЕсли КоличествоФайлов > 0 Тогда\r\n\t\tДля каждого Файл из МассивФайлов Цикл \r\n\r\n\r\n\t\t\tТест = Новый ДвоичныеДанные(Файл.ПолноеИмя); \r\n\r\n\r\n\t\t\tПарсер = Новый ЧтениеXML;        \r\n\t\t\tПарсер.УстановитьСтроку(ПолучитьСтрокуИзДвоичныхДанных(Тест, КодировкаТекста.UTF8));  //устанавливаем парсер на строку с файлом\t\r\n\t\t\tДокументДОМ = Новый ПостроительDOM;\r\n\t\t\tРез = ДокументДОМ.Прочитать(Парсер); \r\n\t\t\tПопытка \r\n\t\t\t\tФлагПроведения = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[0].ТекстовоеСодержимое;\r\n\t\t\t\tДатаДок = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[1].ТекстовоеСодержимое;\r\n\t\t\t\tСчетПокупателю = Документы.СчетНаОплатуПокупателю.НайтиПоНомеру(Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[2].ТекстовоеСодержимое,ОбщегоНазначенияКлиентСервер.СтрокаВДату(ДатаДок));\r\n\t\t\t\tНомерДок = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[2].ТекстовоеСодержимое;\r\n\t\t\t\tЕсли ЗначениеЗаполнено(СчетПокупателю.Ссылка) Тогда\r\n\t\t\t\t\tДок = СчетПокупателю.ПолучитьОбъект();\r\n\t\t\t\t\tДок.Товары.Очистить();     //очищаем табличные части, иначе они задваиваются\r\n\t\t\t\tИначе\r\n\t\t\t\t\tДок = Документы.СчетНаОплатуПокупателю.СоздатьДокумент();\r\n\t\t\t\t\tДок.Дата = ДатаДок;\r\n\t\t\t\t\tДок.Номер = НомерДок;\r\n\t\t\t\tКонецЕсли; \r\n\t\t\t\tДок.Контрагент = Справочники.Контрагенты.НайтиПоРеквизиту(\"ИНН\", Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[8].ТекстовоеСодержимое); \r\n\r\n\r\n\t\t\t\tЕсли Док.Контрагент.Пустая() Тогда\r\n\t\t\t\t\tНовыйКонтрагент = Справочники.Контрагенты.СоздатьЭлемент();\r\n\t\t\t\t\tНовыйКонтрагент.Наименование = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[14].ТекстовоеСодержимое;\r\n\t\t\t\t\tНовыйКонтрагент.ИНН = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[8].ТекстовоеСодержимое;\r\n\t\t\t\t\tНовыйКонтрагент.КПП = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[15].ТекстовоеСодержимое;\r\n\t\t\t\t\tНовыйКонтрагент.КодПоОКПО = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[16].ТекстовоеСодержимое;\r\n\t\t\t\t\tНовыйКонтрагент.Записать();\r\n\t\t\t\t\tДок.Контрагент = НовыйКонтрагент.Ссылка;\r\n\t\t\t\tКонецЕсли;\r\n\r\n\t\t\t\tДок.ДоговорКонтрагента = Справочники.ДоговорыКонтрагентов.НайтиПоНаименованию(Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[4].ТекстовоеСодержимое, , , Док.Контрагент);\r\n\t\t\t\tЕсли Док.ДоговорКонтрагента.Пустая() Тогда\r\n\t\t\t\t\tНовыйДоговор = Справочники.ДоговорыКонтрагентов.СоздатьЭлемент();\r\n\t\t\t\t\tНовыйДоговор.Наименование = \"Основной договор\";\r\n\t\t\t\t\tНовыйДоговор.ВалютаВзаиморасчетов = Константы.ВалютаРегламентированногоУчета.Получить();\r\n\t\t\t\t\tНовыйДоговор.ВидДоговора = Перечисления.ВидыДоговоровКонтрагентов.СПокупателем;\r\n\t\t\t\t\tНовыйДоговор.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;\r\n\t\t\t\t\tНовыйДоговор.Владелец = Док.Контрагент;\r\n\t\t\t\t\tНовыйДоговор.Организация = Справочники.Организации.НайтиПоРеквизиту(\"ИНН\", \"9703016258\");\r\n\t\t\t\t\tНовыйДоговор.Записать();\r\n\t\t\t\t\tДок.ДоговорКонтрагента = НовыйДоговор.Ссылка;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\tДок.Ответственный = Справочники.Пользователи.НайтиПоНаименованию(Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[3].ТекстовоеСодержимое);\r\n\t\t\t\tДок.КратностьВзаиморасчетов = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[6].ТекстовоеСодержимое;\r\n\t\t\t\tДок.Комментарий = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[9].ТекстовоеСодержимое;\r\n\t\t\t\tДок.АдресДоставки = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[10].ТекстовоеСодержимое;\r\n\t\t\t\tДок.ВалютаДокумента = Константы.ВалютаРегламентированногоУчета.Получить();\r\n\t\t\t\tДок.СуммаВключаетНДС = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[12].ТекстовоеСодержимое;\r\n\t\t\t\tДок.СуммаДокумента = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[13].ТекстовоеСодержимое; \r\n\t\t\t\tДок.Организация = Справочники.Организации.НайтиПоРеквизиту(\"ИНН\", \"9703016258\"); \r\n\t\t\t\tДок.Товары.Очистить();\r\n\t\t\t\tДля каждого стр из Рез.ДочерниеУзлы Цикл\r\n\t\t\t\t\tДля каждого стр2 из стр.ДочерниеУзлы Цикл\r\n\t\t\t\t\t\tДля каждого стр3 из стр2.ДочерниеУзлы Цикл \r\n\t\t\t\t\t\t\tЕсли стр3.ИмяУзла  = \"Товары\" Тогда \r\n\t\t\t\t\t\t\t\tНоваяСтрока = Док.Товары.Добавить();\r\n\t\t\t\t\t\t\t\tДля каждого стр4 из стр3.ДочерниеУзлы Цикл\r\n\t\t\t\t\t\t\t\t\tдля Каждого стр4 из стр3.ДочерниеУзлы Цикл \r\n\t\t\t\t\t\t\t\t\t\tЕсли стр4.ИмяУзла = \"Цена\" тогда\r\n\t\t\t\t\t\t\t\t\t\t\tНоваяСтрока.Цена = Число(стр4.ТекстовоеСодержимое);\r\n\t\t\t\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\tЕсли стр4.ИмяУзла = \"Сумма\" Тогда\r\n\t\t\t\t\t\t\t\t\t\t\tНоваяСтрока.Сумма = Число(стр4.ТекстовоеСодержимое);\r\n\t\t\t\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\tЕсли стр4.ИмяУзла = \"СуммаНДС\" Тогда\r\n\t\t\t\t\t\t\t\t\t\t\tНоваяСтрока.СуммаНДС = Число(стр4.ТекстовоеСодержимое);\r\n\t\t\t\t\t\t\t\t\t\tКонецЕсли; \r\n\t\t\t\t\t\t\t\t\t\tЕсли стр4.ИмяУзла = \"Количество\" Тогда\r\n\t\t\t\t\t\t\t\t\t\t\tНоваяСтрока.Количество = Число(стр4.ТекстовоеСодержимое);\r\n\t\t\t\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\tЕсли стр4.ИмяУзла = \"Номенклатура\" Тогда\r\n\t\t\t\t\t\t\t\t\t\t\tнаименованиетовара = стр4.ТекстовоеСодержимое;\r\n\t\t\t\t\t\t\t\t\t\t\tНомен = Справочники.Номенклатура.НайтиПоНаименованию(СокрЛП(наименованиетовара)); \r\n\r\n\t\t\t\t\t\t\t\t\t\t\tЕсли Номен = Справочники.Номенклатура.ПустаяСсылка() Тогда\r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен = Справочники.Номенклатура.СоздатьЭлемент();\r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен.ВидНоменклатуры = Справочники.ВидыНоменклатуры.НайтиПоНаименованию(\"Товар\");\r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен.Наименование = СокрЛП(наименованиетовара);\r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен.ЕдиницаИзмерения = Справочники.КлассификаторЕдиницИзмерения.НайтиПоНаименованию(\"шт\");    \r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен.Комментарий = \"Перенесено из УСЦ\";\r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен.Записать();\r\n\t\t\t\t\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\t\tНоваяСтрока.Номенклатура = Номен.Ссылка;\r\n\t\t\t\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\tКонецЦикла;\r\n\r\n\t\t\t\t\t\t\t\tКонецЦикла; \r\n\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\tКонецЦикла;\r\n\t\t\t\t\tКонецЦикла;\r\n\t\t\t\tКонецЦикла; \r\n\r\n\t\t\t\tЕсли Док.Товары.Количество() > 0 Тогда\r\n\t\t\t\t\tДля каждого стр из Док.Товары Цикл\r\n\t\t\t\t\t\tстр.СтавкаНДС = Перечисления.СтавкиНДС.НДС20;\r\n\t\t\t\t\tКонецЦикла;\r\n\t\t\t\tКонецЕсли;\r\n\r\n\t\t\t\tДок.Склад = Справочники.Склады.НайтиПоНаименованию(\"Основной\"); \r\n\t\t\t\tДок.СтруктурнаяЕдиница = Док.Организация.ОсновнойБанковскийСчет; \r\n\t\t\t\tДок.ВидОперации = Перечисления.ВидыОперацийСчетаПокупателю.ТоварыИУслуги;\r\n\t\t\t\t//СрокОплаты = СрокиОплатыДокументов.СрокОплатыДокументаРасчетовАвторасчет(Док, Док.Дата, Док.ДоговорКонтрагента);\r\n\t\t\t\t\t\t\t\tСрокОплаты = СрокиОплатыДокументов.СрокОплатыНовогоСчетаПокупателю(Док.Дата);\r\n\t\t\t\tСрокиОплатыДокументов.ЗаписатьСрокОплатыДокумента(Док.Ссылка, СрокОплаты);\t\t\t\t\r\n\t\t\t\tЕсли ФлагПроведения Тогда\r\n\t\t\t\t\tДок.Записать(РежимЗаписиДокумента.Проведение); \r\n\t\t\t\tИначе\r\n\t\t\t\t\tДок.Записать(РежимЗаписиДокумента.Запись);\r\n\t\t\t\tКонецЕсли; \r\n\r\n\t\t\t\t//Если Док.Проведен  Тогда\r\n\t\t\t\t//\tПопытка\r\n\t\t\t\t\t\tУдалитьФайлы(файл.Путь, файл.Имя);  //удаляем файлы после удачной загрузки\r\n\t\t\t\t\t//Исключение\r\n\t\t\t\t\t//\tСообщить(ОписаниеОшибки());\r\n\t\t\t\t\t//КонецПопытки;\r\n\t\t\t\t//КонецЕсли;\r\n\r\n\t\t\tИсключение \r\n\t\t\t\tСообщить(ОписаниеОшибки());\r\n\t\t\tКонецПопытки;\r\n\r\n\t\tКонецЦикла;\r\n\r\nКонецЕсли;\n\nПуть = \"Путь до файла\";\r\nМассивФайлов = НайтиФайлы(путь, \"*docum*.xml\", Ложь);\r\nКоличествоФайлов = МассивФайлов.Количество();\r\nЕсли КоличествоФайлов > 0 Тогда\r\n\t\tДля каждого Файл из МассивФайлов Цикл \r\n\r\n\r\n\t\t\tТест = Новый ДвоичныеДанные(Файл.ПолноеИмя); \r\n\r\n\r\n\t\t\tПарсер = Новый ЧтениеXML;        \r\n\t\t\tПарсер.УстановитьСтроку(ПолучитьСтрокуИзДвоичныхДанных(Тест, КодировкаТекста.UTF8));  //устанавливаем парсер на строку с файлом\t\r\n\t\t\tДокументДОМ = Новый ПостроительDOM;\r\n\t\t\tРез = ДокументДОМ.Прочитать(Парсер); \r\n\t\t\tПопытка \r\n\t\t\t\tФлагПроведения = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[0].ТекстовоеСодержимое;\r\n\t\t\t\tДатаДок = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[1].ТекстовоеСодержимое;\r\n\t\t\t\tСчетПокупателю = Документы.СчетНаОплатуПокупателю.НайтиПоНомеру(Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[2].ТекстовоеСодержимое,ОбщегоНазначенияКлиентСервер.СтрокаВДату(ДатаДок));\r\n\t\t\t\tНомерДок = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[2].ТекстовоеСодержимое;\r\n\t\t\t\tЕсли ЗначениеЗаполнено(СчетПокупателю.Ссылка) Тогда\r\n\t\t\t\t\tДок = СчетПокупателю.ПолучитьОбъект();\r\n\t\t\t\t\tДок.Товары.Очистить();     //очищаем табличные части, иначе они задваиваются\r\n\t\t\t\tИначе\r\n\t\t\t\t\tДок = Документы.СчетНаОплатуПокупателю.СоздатьДокумент();\r\n\t\t\t\t\tДок.Дата = ДатаДок;\r\n\t\t\t\t\tДок.Номер = НомерДок;\r\n\t\t\t\tКонецЕсли; \r\n\t\t\t\tДок.Контрагент = Справочники.Контрагенты.НайтиПоРеквизиту(\"ИНН\", Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[8].ТекстовоеСодержимое); \r\n\r\n\r\n\t\t\t\tЕсли Док.Контрагент.Пустая() Тогда\r\n\t\t\t\t\tНовыйКонтрагент = Справочники.Контрагенты.СоздатьЭлемент();\r\n\t\t\t\t\tНовыйКонтрагент.Наименование = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[14].ТекстовоеСодержимое;\r\n\t\t\t\t\tНовыйКонтрагент.ИНН = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[8].ТекстовоеСодержимое;\r\n\t\t\t\t\tНовыйКонтрагент.КПП = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[15].ТекстовоеСодержимое;\r\n\t\t\t\t\tНовыйКонтрагент.КодПоОКПО = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[16].ТекстовоеСодержимое;\r\n\t\t\t\t\tНовыйКонтрагент.Записать();\r\n\t\t\t\t\tДок.Контрагент = НовыйКонтрагент.Ссылка;\r\n\t\t\t\tКонецЕсли;\r\n\r\n\t\t\t\tДок.ДоговорКонтрагента = Справочники.ДоговорыКонтрагентов.НайтиПоНаименованию(Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[4].ТекстовоеСодержимое, , , Док.Контрагент);\r\n\t\t\t\tЕсли Док.ДоговорКонтрагента.Пустая() Тогда\r\n\t\t\t\t\tНовыйДоговор = Справочники.ДоговорыКонтрагентов.СоздатьЭлемент();\r\n\t\t\t\t\tНовыйДоговор.Наименование = \"Основной договор\";\r\n\t\t\t\t\tНовыйДоговор.ВалютаВзаиморасчетов = Константы.ВалютаРегламентированногоУчета.Получить();\r\n\t\t\t\t\tНовыйДоговор.ВидДоговора = Перечисления.ВидыДоговоровКонтрагентов.СПокупателем;\r\n\t\t\t\t\tНовыйДоговор.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;\r\n\t\t\t\t\tНовыйДоговор.Владелец = Док.Контрагент;\r\n\t\t\t\t\tНовыйДоговор.Организация = Справочники.Организации.НайтиПоРеквизиту(\"ИНН\", \"9703016258\");\r\n\t\t\t\t\tНовыйДоговор.Записать();\r\n\t\t\t\t\tДок.ДоговорКонтрагента = НовыйДоговор.Ссылка;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\tДок.Ответственный = Справочники.Пользователи.НайтиПоНаименованию(Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[3].ТекстовоеСодержимое);\r\n\t\t\t\tДок.КратностьВзаиморасчетов = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[6].ТекстовоеСодержимое;\r\n\t\t\t\tДок.Комментарий = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[9].ТекстовоеСодержимое;\r\n\t\t\t\tДок.АдресДоставки = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[10].ТекстовоеСодержимое;\r\n\t\t\t\tДок.ВалютаДокумента = Константы.ВалютаРегламентированногоУчета.Получить();\r\n\t\t\t\tДок.СуммаВключаетНДС = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[12].ТекстовоеСодержимое;\r\n\t\t\t\tДок.СуммаДокумента = Рез.ДочерниеУзлы[0].ДочерниеУзлы[0].ДочерниеУзлы[13].ТекстовоеСодержимое; \r\n\t\t\t\tДок.Организация = Справочники.Организации.НайтиПоРеквизиту(\"ИНН\", \"9703016258\"); \r\n\t\t\t\tДок.Товары.Очистить();\r\n\t\t\t\tДля каждого стр из Рез.ДочерниеУзлы Цикл\r\n\t\t\t\t\tДля каждого стр2 из стр.ДочерниеУзлы Цикл\r\n\t\t\t\t\t\tДля каждого стр3 из стр2.ДочерниеУзлы Цикл \r\n\t\t\t\t\t\t\tЕсли стр3.ИмяУзла  = \"Товары\" Тогда \r\n\t\t\t\t\t\t\t\tНоваяСтрока = Док.Товары.Добавить();\r\n\t\t\t\t\t\t\t\tДля каждого стр4 из стр3.ДочерниеУзлы Цикл\r\n\t\t\t\t\t\t\t\t\tдля Каждого стр4 из стр3.ДочерниеУзлы Цикл \r\n\t\t\t\t\t\t\t\t\t\tЕсли стр4.ИмяУзла = \"Цена\" тогда\r\n\t\t\t\t\t\t\t\t\t\t\tНоваяСтрока.Цена = Число(стр4.ТекстовоеСодержимое);\r\n\t\t\t\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\tЕсли стр4.ИмяУзла = \"Сумма\" Тогда\r\n\t\t\t\t\t\t\t\t\t\t\tНоваяСтрока.Сумма = Число(стр4.ТекстовоеСодержимое);\r\n\t\t\t\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\tЕсли стр4.ИмяУзла = \"СуммаНДС\" Тогда\r\n\t\t\t\t\t\t\t\t\t\t\tНоваяСтрока.СуммаНДС = Число(стр4.ТекстовоеСодержимое);\r\n\t\t\t\t\t\t\t\t\t\tКонецЕсли; \r\n\t\t\t\t\t\t\t\t\t\tЕсли стр4.ИмяУзла = \"Количество\" Тогда\r\n\t\t\t\t\t\t\t\t\t\t\tНоваяСтрока.Количество = Число(стр4.ТекстовоеСодержимое);\r\n\t\t\t\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\tЕсли стр4.ИмяУзла = \"Номенклатура\" Тогда\r\n\t\t\t\t\t\t\t\t\t\t\tнаименованиетовара = стр4.ТекстовоеСодержимое;\r\n\t\t\t\t\t\t\t\t\t\t\tНомен = Справочники.Номенклатура.НайтиПоНаименованию(СокрЛП(наименованиетовара)); \r\n\r\n\t\t\t\t\t\t\t\t\t\t\tЕсли Номен = Справочники.Номенклатура.ПустаяСсылка() Тогда\r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен = Справочники.Номенклатура.СоздатьЭлемент();\r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен.ВидНоменклатуры = Справочники.ВидыНоменклатуры.НайтиПоНаименованию(\"Товар\");\r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен.Наименование = СокрЛП(наименованиетовара);\r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен.ЕдиницаИзмерения = Справочники.КлассификаторЕдиницИзмерения.НайтиПоНаименованию(\"шт\");    \r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен.Комментарий = \"Перенесено из УСЦ\";\r\n\t\t\t\t\t\t\t\t\t\t\t\tНомен.Записать();\r\n\t\t\t\t\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\t\tНоваяСтрока.Номенклатура = Номен.Ссылка;\r\n\t\t\t\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\tКонецЦикла;\r\n\r\n\t\t\t\t\t\t\t\tКонецЦикла; \r\n\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\tКонецЦикла;\r\n\t\t\t\t\tКонецЦикла;\r\n\t\t\t\tКонецЦикла; \r\n\r\n\t\t\t\tЕсли Док.Товары.Количество() > 0 Тогда\r\n\t\t\t\t\tДля каждого стр из Док.Товары Цикл\r\n\t\t\t\t\t\tстр.СтавкаНДС = Перечисления.СтавкиНДС.НДС20;\r\n\t\t\t\t\tКонецЦикла;\r\n\t\t\t\tКонецЕсли;\r\n\r\n\t\t\t\tДок.Склад = Справочники.Склады.НайтиПоНаименованию(\"Основной\"); \r\n\t\t\t\tДок.СтруктурнаяЕдиница = Док.Организация.ОсновнойБанковскийСчет; \r\n\t\t\t\tДок.ВидОперации = Перечисления.ВидыОперацийСчетаПокупателю.ТоварыИУслуги;\r\n\t\t\t\t//СрокОплаты = СрокиОплатыДокументов.СрокОплатыДокументаРасчетовАвторасчет(Док, Док.Дата, Док.ДоговорКонтрагента);\r\n\t\t\t\t\t\t\t\tСрокОплаты = СрокиОплатыДокументов.СрокОплатыНовогоСчетаПокупателю(Док.Дата);\r\n\t\t\t\tСрокиОплатыДокументов.ЗаписатьСрокОплатыДокумента(Док.Ссылка, СрокОплаты);\t\t\t\t\r\n\t\t\t\tЕсли ФлагПроведения Тогда\r\n\t\t\t\t\tДок.Записать(РежимЗаписиДокумента.Проведение); \r\n\t\t\t\tИначе\r\n\t\t\t\t\tДок.Записать(РежимЗаписиДокумента.Запись);\r\n\t\t\t\tКонецЕсли; \r\n\r\n\t\t\t\t//Если Док.Проведен  Тогда\r\n\t\t\t\t//\tПопытка\r\n\t\t\t\t\t\tУдалитьФайлы(файл.Путь, файл.Имя);  //удаляем файлы после удачной загрузки\r\n\t\t\t\t\t//Исключение\r\n\t\t\t\t\t//\tСообщить(ОписаниеОшибки());\r\n\t\t\t\t\t//КонецПопытки;\r\n\t\t\t\t//КонецЕсли;\r\n\r\n\t\t\tИсключение \r\n\t\t\t\tСообщить(ОписаниеОшибки());\r\n\t\t\tКонецПопытки;\r\n\r\n\t\tКонецЦикла;\r\n\r\nКонецЕсли;\n\n{1} Высокая цикломатическая сложность: 21\r\nОрфографическая ошибка в парсера: парсера\r\nОрфографическая ошибка в docum: docum\r\nОрфографическая ошибка в Парсер (найдено 3): Парсер\r\nОрфографическая ошибка в парсер: парсер\r\nОрфографическая ошибка в задваиваются: задваиваются\r\nОрфографическая ошибка в наименованиетовара (найдено 3): наименованиетовара"
  },
  {
    "title": "Найти ссылку по реквизиту",
    "description": "Найти ссылку по реквизиту",
    "code_snippet": "// Возвращает первую ссылку по значению реквизита\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/36\r\n// \r\n// Параметры:\r\n//  ОбъектМетаданных - ОбъектМетаданныхСправочник, ОбъектМетаданныхДокумент, ОбъектМетаданныхБизнесПроцесс, ОбъектМетаданныхЗадача, ОбъектМетаданныхПланВидовХарактеристик - \r\n//  ИмяРеквизита - Строка\r\n//  ЗначениеРеквизита - Произвольный\r\n// \r\n// Возвращаемое значение:\r\n//  ЛюбаяСсылка\r\n//\r\n// Пример:\r\n//\tРезультат = НайтиСсылкуПоРеквизиту(Метаданные.Справочники.ЖЧТ_ТестовыйСправочник, \"Номер\", 999);\r\n//\t//Результат - ссылка на элемент справочника (или найденная или пустая) \r\n//\r\nФункция НайтиСсылкуПоРеквизиту(Знач ОбъектМетаданных, Знач ИмяРеквизита, Знач ЗначениеРеквизита) Экспорт\r\n\t\r\n\tТекстЗапроса = СтрШаблон(\"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1 Ссылка ИЗ %1 ГДЕ %2 = &П\", \r\n\t\tОбъектМетаданных.ПолноеИмя(), ИмяРеквизита);\r\n\t\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tЗапрос.УстановитьПараметр(\"П\", ЗначениеРеквизита);\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\tЕсли РезультатЗапроса.Пустой() Тогда\r\n\t\tВозврат ОбъектМетаданных.СтандартныеРеквизиты.Ссылка.Тип.ПривестиЗначение();\r\n\tИначе\r\n\t\tВыборка = РезультатЗапроса.Выбрать();\r\n\t\tВыборка.Следующий();\r\n\t\tВозврат Выборка[0];\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции\n\n// Возвращает первую ссылку по значению реквизита\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/36\r\n// \r\n// Параметры:\r\n//  ОбъектМетаданных - ОбъектМетаданныхСправочник, ОбъектМетаданныхДокумент, ОбъектМетаданныхБизнесПроцесс, ОбъектМетаданныхЗадача, ОбъектМетаданныхПланВидовХарактеристик - \r\n//  ИмяРеквизита - Строка\r\n//  ЗначениеРеквизита - Произвольный\r\n// \r\n// Возвращаемое значение:\r\n//  ЛюбаяСсылка\r\n//\r\n// Пример:\r\n//\tРезультат = НайтиСсылкуПоРеквизиту(Метаданные.Справочники.ЖЧТ_ТестовыйСправочник, \"Номер\", 999);\r\n//\t//Результат - ссылка на элемент справочника (или найденная или пустая) \r\n//\r\nФункция НайтиСсылкуПоРеквизиту(Знач ОбъектМетаданных, Знач ИмяРеквизита, Знач ЗначениеРеквизита) Экспорт\r\n\t\r\n\tТекстЗапроса = СтрШаблон(\"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1 Ссылка ИЗ %1 ГДЕ %2 = &П\", \r\n\t\tОбъектМетаданных.ПолноеИмя(), ИмяРеквизита);\r\n\t\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tЗапрос.УстановитьПараметр(\"П\", ЗначениеРеквизита);\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\tЕсли РезультатЗапроса.Пустой() Тогда\r\n\t\tВозврат ОбъектМетаданных.СтандартныеРеквизиты.Ссылка.Тип.ПривестиЗначение();\r\n\tИначе\r\n\t\tВыборка = РезультатЗапроса.Выбрать();\r\n\t\tВыборка.Следующий();\r\n\t\tВозврат Выборка[0];\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Пустая таблица по тексту запроса",
    "description": "Пустая таблица по тексту запроса",
    "code_snippet": "// Возвращает пустую таблицу значений результата запроса на основе его текста\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/85\r\n// \r\n// Параметры:\r\n//  ТекстЗапроса - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений\r\n//  \r\n// Пример:\r\n// \tТекстЗапроса = \"ВЫБРАТЬ Код,Наименование,Ссылка ИЗ Справочник.Валюты\";\r\n//\tРезультат = ПустаяТаблицаПоТекстуЗапроса(ТекстЗапроса);\r\n//\t//Результат - ТЗ с колонками Код,Наименование,Ссылка соответствующих типов\r\n//  \r\nФункция ПустаяТаблицаПоТекстуЗапроса(Знач ТекстЗапроса) Экспорт\r\n\t\r\n\tТаблицаЗначений = Новый ТаблицаЗначений;\r\n\t\r\n\tСхемаЗапроса = Новый СхемаЗапроса;\r\n\tСхемаЗапроса.УстановитьТекстЗапроса(ТекстЗапроса);\r\n\tПакетыЗапросов = СхемаЗапроса.ПакетЗапросов;\r\n\t\r\n\tКоличествоПакетов = ПакетыЗапросов.Количество();\r\n\tЕсли КоличествоПакетов > 0 Тогда\r\n\t\t\r\n\t\t//Определяем последний пакет с типом выборки\r\n\t\tПакетВыборки = Неопределено;\r\n\t\tТекущийИндекс = КоличествоПакетов - 1;\r\n\t\tПока ПакетВыборки = Неопределено И ТекущийИндекс >= 0 Цикл\r\n\t\t\tТекущийПакет = ПакетыЗапросов.Получить(ТекущийИндекс);\r\n\t\t\tЕсли ТипЗнч(ТекущийПакет) = Тип(\"ЗапросВыбораСхемыЗапроса\") Тогда\r\n\t\t\t\tПакетВыборки = ТекущийПакет;\r\n\t\t\tИначе\r\n\t\t\t\tТекущийИндекс = ТекущийИндекс - 1;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\t//Перебираем колонки найденного пакета\r\n\t\tЕсли ПакетВыборки <> Неопределено Тогда\r\n\t\t\tДля Каждого КолонкаЗапроса Из ПакетВыборки.Колонки Цикл\r\n\t\t\t\tЕсли ТипЗнч(КолонкаЗапроса) = Тип(\"КолонкаСхемыЗапроса\") Тогда\r\n\t\t\t\t\tТаблицаЗначений.Колонки.Добавить(КолонкаЗапроса.Псевдоним, КолонкаЗапроса.ТипЗначения);\r\n\t\t\t\tИначеЕсли ТипЗнч(КолонкаЗапроса) = Тип(\"КолонкаВложеннаяТаблицаСхемыЗапроса\") Тогда\r\n\t\t\t\t\t// TODO: Нужно доработать. Такая ситуация возникает, когда в запросе указана выборка по типу ИмяТаблицы.ИмяТЧ.(Колонка1, Колонка2) КАК ТЧ\r\n\t\t\t\t\t//\tТаблицаЗначений.Колонки.Добавить(КолонкаЗапроса.Псевдоним, Тип(\"ТаблицаЗначений\"));\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ТаблицаЗначений;\r\n\r\nКонецФункции\n\n// Возвращает пустую таблицу значений результата запроса на основе его текста\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/85\r\n// \r\n// Параметры:\r\n//  ТекстЗапроса - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений\r\n//  \r\n// Пример:\r\n// \tТекстЗапроса = \"ВЫБРАТЬ Код,Наименование,Ссылка ИЗ Справочник.Валюты\";\r\n//\tРезультат = ПустаяТаблицаПоТекстуЗапроса(ТекстЗапроса);\r\n//\t//Результат - ТЗ с колонками Код,Наименование,Ссылка соответствующих типов\r\n//  \r\nФункция ПустаяТаблицаПоТекстуЗапроса(Знач ТекстЗапроса) Экспорт\r\n\t\r\n\tТаблицаЗначений = Новый ТаблицаЗначений;\r\n\t\r\n\tСхемаЗапроса = Новый СхемаЗапроса;\r\n\tСхемаЗапроса.УстановитьТекстЗапроса(ТекстЗапроса);\r\n\tПакетыЗапросов = СхемаЗапроса.ПакетЗапросов;\r\n\t\r\n\tКоличествоПакетов = ПакетыЗапросов.Количество();\r\n\tЕсли КоличествоПакетов > 0 Тогда\r\n\t\t\r\n\t\t//Определяем последний пакет с типом выборки\r\n\t\tПакетВыборки = Неопределено;\r\n\t\tТекущийИндекс = КоличествоПакетов - 1;\r\n\t\tПока ПакетВыборки = Неопределено И ТекущийИндекс >= 0 Цикл\r\n\t\t\tТекущийПакет = ПакетыЗапросов.Получить(ТекущийИндекс);\r\n\t\t\tЕсли ТипЗнч(ТекущийПакет) = Тип(\"ЗапросВыбораСхемыЗапроса\") Тогда\r\n\t\t\t\tПакетВыборки = ТекущийПакет;\r\n\t\t\tИначе\r\n\t\t\t\tТекущийИндекс = ТекущийИндекс - 1;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\t//Перебираем колонки найденного пакета\r\n\t\tЕсли ПакетВыборки <> Неопределено Тогда\r\n\t\t\tДля Каждого КолонкаЗапроса Из ПакетВыборки.Колонки Цикл\r\n\t\t\t\tЕсли ТипЗнч(КолонкаЗапроса) = Тип(\"КолонкаСхемыЗапроса\") Тогда\r\n\t\t\t\t\tТаблицаЗначений.Колонки.Добавить(КолонкаЗапроса.Псевдоним, КолонкаЗапроса.ТипЗначения);\r\n\t\t\t\tИначеЕсли ТипЗнч(КолонкаЗапроса) = Тип(\"КолонкаВложеннаяТаблицаСхемыЗапроса\") Тогда\r\n\t\t\t\t\t// TODO: Нужно доработать. Такая ситуация возникает, когда в запросе указана выборка по типу ИмяТаблицы.ИмяТЧ.(Колонка1, Колонка2) КАК ТЧ\r\n\t\t\t\t\t//\tТаблицаЗначений.Колонки.Добавить(КолонкаЗапроса.Псевдоним, Тип(\"ТаблицаЗначений\"));\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ТаблицаЗначений;\r\n\r\nКонецФункции"
  },
  {
    "title": "Элемент базы уникален",
    "description": "Элемент базы уникален",
    "code_snippet": "// Проверяет уникальность элемента базы.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/89\r\n//  \r\n// Параметры:\r\n//  Элемент - ЛюбаяСсылка, СправочникОбъект, ДокументОбъект, ПланВидовРасчетаОбъект, ПланОбменаОбъект, ПланВидовХарактеристикОбъект, ЗадачаОбъект, БизнесПроцессОбъект - Ссылка или ссылочный объект\r\n//  РеквизитУникальности - Строка - Реквизит уникальности\r\n//  ДополнительныеОтборы - Строка - Дополнительные отборы\r\n// \r\n// Возвращаемое значение:\r\n//  Булево - элемент уникален\r\n//  \r\n// Пример:\r\n//  Если НЕ ЭлементБазыУникален(Ссылка, \"Наименование\", \"НЕ ПометкаУдаления\") Тогда\r\n//\t\tВызватьИсключение \"Элемент с таким наименованием уже существует!\";\r\n//\tКонецЕсли;  \r\n//  \r\nФункция ЭлементБазыУникален(Знач Элемент, Знач РеквизитУникальности = \"Наименование\", Знач ДополнительныеОтборы = \"\") Экспорт\r\n\t\r\n\tМетаданныеЭлемента = Элемент.Метаданные();\r\n\tЭтоСсылка = МетаданныеЭлемента.СтандартныеРеквизиты.Ссылка.Тип.СодержитТип(ТипЗнч(Элемент));\r\n\t\r\n\tТребуемыеРеквизиты = \"Ссылка,\" + РеквизитУникальности;\r\n\tЕсли ЭтоСсылка Тогда\r\n\t\tЗначенияРеквизитов = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Элемент, \"Ссылка,\" + РеквизитУникальности);\r\n\tИначе\r\n\t\tЗначенияРеквизитов = Новый Структура(ТребуемыеРеквизиты);\r\n\t\tЗаполнитьЗначенияСвойств(ЗначенияРеквизитов, Элемент);\r\n\tКонецЕсли;\r\n\t\r\n\tТекстЗапроса = \"ВЫБРАТЬ ПЕРВЫЕ 1 1 ИЗ %1 ГДЕ %2 = &%2 И Ссылка <> &Ссылка\";\r\n\tТекстЗапроса = СтрШаблон(ТекстЗапроса, Элемент.Метаданные().ПолноеИмя(), РеквизитУникальности);\r\n\tЕсли ЗначениеЗаполнено(ДополнительныеОтборы) Тогда\r\n\t\tТекстЗапроса = СтрШаблон(\"%1 И %2\", ТекстЗапроса, ДополнительныеОтборы);\r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tДля Каждого КлючИЗначение Из ЗначенияРеквизитов Цикл\r\n\t\tЗапрос.УстановитьПараметр(КлючИЗначение.Ключ, КлючИЗначение.Значение);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Запрос.Выполнить().Пустой();\r\n\t\r\nКонецФункции\n\n// Проверяет уникальность элемента базы.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/89\r\n//  \r\n// Параметры:\r\n//  Элемент - ЛюбаяСсылка, СправочникОбъект, ДокументОбъект, ПланВидовРасчетаОбъект, ПланОбменаОбъект, ПланВидовХарактеристикОбъект, ЗадачаОбъект, БизнесПроцессОбъект - Ссылка или ссылочный объект\r\n//  РеквизитУникальности - Строка - Реквизит уникальности\r\n//  ДополнительныеОтборы - Строка - Дополнительные отборы\r\n// \r\n// Возвращаемое значение:\r\n//  Булево - элемент уникален\r\n//  \r\n// Пример:\r\n//  Если НЕ ЭлементБазыУникален(Ссылка, \"Наименование\", \"НЕ ПометкаУдаления\") Тогда\r\n//\t\tВызватьИсключение \"Элемент с таким наименованием уже существует!\";\r\n//\tКонецЕсли;  \r\n//  \r\nФункция ЭлементБазыУникален(Знач Элемент, Знач РеквизитУникальности = \"Наименование\", Знач ДополнительныеОтборы = \"\") Экспорт\r\n\t\r\n\tМетаданныеЭлемента = Элемент.Метаданные();\r\n\tЭтоСсылка = МетаданныеЭлемента.СтандартныеРеквизиты.Ссылка.Тип.СодержитТип(ТипЗнч(Элемент));\r\n\t\r\n\tТребуемыеРеквизиты = \"Ссылка,\" + РеквизитУникальности;\r\n\tЕсли ЭтоСсылка Тогда\r\n\t\tЗначенияРеквизитов = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Элемент, \"Ссылка,\" + РеквизитУникальности);\r\n\tИначе\r\n\t\tЗначенияРеквизитов = Новый Структура(ТребуемыеРеквизиты);\r\n\t\tЗаполнитьЗначенияСвойств(ЗначенияРеквизитов, Элемент);\r\n\tКонецЕсли;\r\n\t\r\n\tТекстЗапроса = \"ВЫБРАТЬ ПЕРВЫЕ 1 1 ИЗ %1 ГДЕ %2 = &%2 И Ссылка <> &Ссылка\";\r\n\tТекстЗапроса = СтрШаблон(ТекстЗапроса, Элемент.Метаданные().ПолноеИмя(), РеквизитУникальности);\r\n\tЕсли ЗначениеЗаполнено(ДополнительныеОтборы) Тогда\r\n\t\tТекстЗапроса = СтрШаблон(\"%1 И %2\", ТекстЗапроса, ДополнительныеОтборы);\r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tДля Каждого КлючИЗначение Из ЗначенияРеквизитов Цикл\r\n\t\tЗапрос.УстановитьПараметр(КлючИЗначение.Ключ, КлючИЗначение.Значение);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Запрос.Выполнить().Пустой();\r\n\t\r\nКонецФункции"
  },
  {
    "title": "ИР Найти в списке",
    "description": "ИР Найти в спискеTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Сведения О Внешней Обработке",
    "description": "Сведения О Внешней Обработке",
    "code_snippet": "/////////////////////////////////////////////////////////////////////////\r\n// РЕГИСТРАЦИЯ ВНЕШНЕЙ ОБРАБОТКИ\r\n\r\n#Область ОсновныеНастройкиДляПодключения\r\n//не забываем заполнять Обработка->Действия->Свойства->ХранилищеВариантовОтчетов\r\nФункция ВернутьСтруктуруПараметров()\r\n\t\r\n\tСтруктура = Новый Структура();\r\n\tСтруктура.Вставить(\"Документ\",\"\");\r\n\tСтруктура.Вставить(\"Представление\",ЭтотОбъект.Метаданные().Представление());\r\n\tСтруктура.Вставить(\"Наименование\",ЭтотОбъект.Метаданные().Синоним);\r\n\tСтруктура.Вставить(\"Идентификатор\",ЭтотОбъект.Метаданные().Имя);\r\n\tСтруктура.Вставить(\"Версия\",\"1.0\");\r\n\tВозврат Структура;\t\r\n\t\r\nКонецФункции \r\n\r\nФункция СведенияОВнешнейОбработке() ЭКСПОРТ\r\n\t\r\n\tПараметрыОбработки = ВернутьСтруктуруПараметров();\r\n\t\r\n\tСведения = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке();\r\n\tСведения.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка();\r\n\tСведения.Наименование = ПараметрыОбработки.Наименование;\r\n\tСведения.Версия = ПараметрыОбработки.Версия;\r\n\t\r\n\tстр              =Сведения.Команды.Добавить();\r\n\tстр.Представление=ПараметрыОбработки.Представление;\r\n\tстр.Идентификатор=ПараметрыОбработки.Идентификатор;\r\n\tстр.Использование=ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();\r\n\t\r\n\tВозврат Сведения;\r\n\t\r\nКонецФункции\r\n#КонецОбласти\n\n/////////////////////////////////////////////////////////////////////////\r\n// РЕГИСТРАЦИЯ ВНЕШНЕЙ ОБРАБОТКИ\r\n\r\n#Область ОсновныеНастройкиДляПодключения\r\n//не забываем заполнять Обработка->Действия->Свойства->ХранилищеВариантовОтчетов\r\nФункция ВернутьСтруктуруПараметров()\r\n\t\r\n\tСтруктура = Новый Структура();\r\n\tСтруктура.Вставить(\"Документ\",\"\");\r\n\tСтруктура.Вставить(\"Представление\",ЭтотОбъект.Метаданные().Представление());\r\n\tСтруктура.Вставить(\"Наименование\",ЭтотОбъект.Метаданные().Синоним);\r\n\tСтруктура.Вставить(\"Идентификатор\",ЭтотОбъект.Метаданные().Имя);\r\n\tСтруктура.Вставить(\"Версия\",\"1.0\");\r\n\tВозврат Структура;\t\r\n\t\r\nКонецФункции \r\n\r\nФункция СведенияОВнешнейОбработке() ЭКСПОРТ\r\n\t\r\n\tПараметрыОбработки = ВернутьСтруктуруПараметров();\r\n\t\r\n\tСведения = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке();\r\n\tСведения.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка();\r\n\tСведения.Наименование = ПараметрыОбработки.Наименование;\r\n\tСведения.Версия = ПараметрыОбработки.Версия;\r\n\t\r\n\tстр              =Сведения.Команды.Добавить();\r\n\tстр.Представление=ПараметрыОбработки.Представление;\r\n\tстр.Идентификатор=ПараметрыОбработки.Идентификатор;\r\n\tстр.Использование=ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();\r\n\t\r\n\tВозврат Сведения;\r\n\t\r\nКонецФункции\r\n#КонецОбласти"
  },
  {
    "title": "Выгрузить колонку таблицы значений",
    "description": "Выгрузить колонку таблицы значений",
    "code_snippet": "// Выгружает колонку таблицы значений\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/90\r\n// \r\n//  Параметры:\r\n//  Таблица - ТаблицаЗначений\r\n//  ИмяКолонки - Строка\r\n//  Различные - Булево\r\n//  Сортировать - Булево\r\n// \r\n// Возвращаемое значение:\r\n//  Массив из Произвольный\r\n//  \r\n// Пример:\r\n// \t//ТаблицаЗначений содержит 3 строки со значениями в колонке \"Колонка\": 3,2,3\r\n//  Результат = ВыгрузитьКолонку(ТаблицаЗначений, \"Колонка\", Истина, Истина);\r\n//\t//Результат - массив со значениями: 2,3\r\nФункция ВыгрузитьКолонку(Знач Таблица, Знач ИмяКолонки, Знач Различные = Ложь, Знач Сортировать = Ложь) Экспорт\r\n\t\r\n\tЕсли Различные ИЛИ Сортировать Тогда\r\n\t\t\r\n\t\tТаблица = Таблица.Скопировать(, ИмяКолонки);\r\n\t\t\r\n\t\tЕсли Различные Тогда\r\n\t\t\tТаблица.Свернуть(ИмяКолонки);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли Сортировать Тогда\r\n\t\t\tТаблица.Сортировать(ИмяКолонки);\r\n\t\tКонецЕсли;\r\n\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Таблица.ВыгрузитьКолонку(ИмяКолонки);\r\n\t\r\nКонецФункции\n\n// Выгружает колонку таблицы значений\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/90\r\n// \r\n//  Параметры:\r\n//  Таблица - ТаблицаЗначений\r\n//  ИмяКолонки - Строка\r\n//  Различные - Булево\r\n//  Сортировать - Булево\r\n// \r\n// Возвращаемое значение:\r\n//  Массив из Произвольный\r\n//  \r\n// Пример:\r\n// \t//ТаблицаЗначений содержит 3 строки со значениями в колонке \"Колонка\": 3,2,3\r\n//  Результат = ВыгрузитьКолонку(ТаблицаЗначений, \"Колонка\", Истина, Истина);\r\n//\t//Результат - массив со значениями: 2,3\r\nФункция ВыгрузитьКолонку(Знач Таблица, Знач ИмяКолонки, Знач Различные = Ложь, Знач Сортировать = Ложь) Экспорт\r\n\t\r\n\tЕсли Различные ИЛИ Сортировать Тогда\r\n\t\t\r\n\t\tТаблица = Таблица.Скопировать(, ИмяКолонки);\r\n\t\t\r\n\t\tЕсли Различные Тогда\r\n\t\t\tТаблица.Свернуть(ИмяКолонки);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли Сортировать Тогда\r\n\t\t\tТаблица.Сортировать(ИмяКолонки);\r\n\t\tКонецЕсли;\r\n\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Таблица.ВыгрузитьКолонку(ИмяКолонки);\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Заполнить таблицу значений из дерева (рекурсивно)",
    "description": "Заполнить таблицу значений из дерева (рекурсивно)",
    "code_snippet": "// Заполнить таблицу значений из дерева рекурсивно.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/91\r\n//  \r\n// Параметры:\r\n//  ТаблицаЗначений - ТаблицаЗначений\r\n//  ДеревоЗначений - ДеревоЗначений\r\n//  ПостоянныеЗначения - Неопределено, Структура -\r\n//  \r\n// Пример:\r\n//  \r\n//  ПостоянныеЗначения = Новый Структура(\"Дата\", ТекущаяДатаСеанса());\r\n//  ЗаполнитьТаблицуИзДереваРекурсивно(ТаблицаЗначений, ДеревоЗначений, ПостоянныеЗначения);\r\n//  \r\nПроцедура ЗаполнитьТаблицуИзДереваРекурсивно(\r\n\tЗнач ТаблицаЗначений, Знач ДеревоЗначений, Знач ПостоянныеЗначения = Неопределено) Экспорт\r\n\t\r\n\tКоллекцияКолонок = Новый Массив; //Массив из КоллекцияСтрокДереваЗначений\r\n\tКоллекцияКолонок.Добавить(ДеревоЗначений.Строки);\r\n\t\r\n\tДля Каждого ТекущаяКоллекция Из КоллекцияКолонок Цикл\r\n\t\t\r\n\t\tДля Каждого ТекущаяСтрока Из ТекущаяКоллекция Цикл //СтрокаДереваЗначений\r\n\t\t\t\r\n\t\t\tЕсли ЗначениеЗаполнено(ТекущаяСтрока.Строки) Тогда\r\n\t\t\t\tКоллекцияКолонок.Добавить(ТекущаяСтрока.Строки);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tНоваяСтрока = ТаблицаЗначений.Добавить();\r\n\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, ТекущаяСтрока);\r\n\t\t\t\r\n\t\t\tЕсли ПостоянныеЗначения <> Неопределено Тогда\r\n\t\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, ПостоянныеЗначения);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n// Заполнить таблицу значений из дерева рекурсивно.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/91\r\n//  \r\n// Параметры:\r\n//  ТаблицаЗначений - ТаблицаЗначений\r\n//  ДеревоЗначений - ДеревоЗначений\r\n//  ПостоянныеЗначения - Неопределено, Структура -\r\n//  \r\n// Пример:\r\n//  \r\n//  ПостоянныеЗначения = Новый Структура(\"Дата\", ТекущаяДатаСеанса());\r\n//  ЗаполнитьТаблицуИзДереваРекурсивно(ТаблицаЗначений, ДеревоЗначений, ПостоянныеЗначения);\r\n//  \r\nПроцедура ЗаполнитьТаблицуИзДереваРекурсивно(\r\n\tЗнач ТаблицаЗначений, Знач ДеревоЗначений, Знач ПостоянныеЗначения = Неопределено) Экспорт\r\n\t\r\n\tКоллекцияКолонок = Новый Массив; //Массив из КоллекцияСтрокДереваЗначений\r\n\tКоллекцияКолонок.Добавить(ДеревоЗначений.Строки);\r\n\t\r\n\tДля Каждого ТекущаяКоллекция Из КоллекцияКолонок Цикл\r\n\t\t\r\n\t\tДля Каждого ТекущаяСтрока Из ТекущаяКоллекция Цикл //СтрокаДереваЗначений\r\n\t\t\t\r\n\t\t\tЕсли ЗначениеЗаполнено(ТекущаяСтрока.Строки) Тогда\r\n\t\t\t\tКоллекцияКолонок.Добавить(ТекущаяСтрока.Строки);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tНоваяСтрока = ТаблицаЗначений.Добавить();\r\n\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, ТекущаяСтрока);\r\n\t\t\t\r\n\t\t\tЕсли ПостоянныеЗначения <> Неопределено Тогда\r\n\t\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, ПостоянныеЗначения);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Алгоритм загрузки в документ \"Корректировка регистров\"",
    "description": "Алгоритм загрузки в документ \"Корректировка регистров\"",
    "code_snippet": "Запрос = Новый Запрос;\r\n\tЗапрос.Текст =\"ВЫБРАТЬ\r\n\t\t|\tДАТАВРЕМЯ(2020, 1, 1, 0, 0, 0) КАК Период,\r\n\t\t|\tВЫБОР\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток > 0\r\n\t\t|\t\t\tТОГДА ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток < 0\r\n\t\t|\t\t\tТОГДА ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)\r\n\t\t|\tКОНЕЦ КАК ВидДвижения,\r\n\t\t|\tПартииТоваровКомпанииОстатки.Номенклатура КАК Номенклатура,\r\n\t\t|\tПартииТоваровКомпанииОстатки.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,\r\n\t\t|\tПартииТоваровКомпанииОстатки.СтатусПартии КАК СтатусПартии,\r\n\t\t|\tПартииТоваровКомпанииОстатки.ДокументПоставки КАК ДокументПоставки,\r\n\t\t|\tПартииТоваровКомпанииОстатки.СкладКомпании КАК СкладКомпании,\r\n\t\t|\tПартииТоваровКомпанииОстатки.КоличествоОстаток КАК Количество,\r\n\t\t|\tВЫБОР\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток > 0\r\n\t\t|\t\t\tТОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток < 0\r\n\t\t|\t\t\tТОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток * -1\r\n\t\t|\tКОНЕЦ КАК Стоимость,\r\n\t\t|\tВЫБОР\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьБезНДСОстаток > 0\r\n\t\t|\t\t\tТОГДА ПартииТоваровКомпанииОстатки.СтоимостьБезНДСОстаток\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьБезНДСОстаток < 0\r\n\t\t|\t\t\tТОГДА ПартииТоваровКомпанииОстатки.СтоимостьБезНДСОстаток * -1\r\n\t\t|\tКОНЕЦ КАК СтоимостьБезНДСОстаток\r\n\t\t|ИЗ\r\n\t\t|\tРегистрНакопления.ПартииТоваровКомпании.Остатки КАК ПартииТоваровКомпанииОстатки\r\n\t\t|ГДЕ\r\n\t\t|\tПартииТоваровКомпанииОстатки.КоличествоОстаток = 0\r\n\t\t|\tИ ПартииТоваровКомпанииОстатки.СтоимостьОстаток <> 0\r\n\t\t|\";\t\r\n\t\t\r\n\tмРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tОбъект.Движения.ПартииТоваровКомпании.Загрузить(мРезультатЗапроса.Выгрузить());\n\nЗапрос = Новый Запрос;\r\n\tЗапрос.Текст =\"ВЫБРАТЬ\r\n\t\t|\tДАТАВРЕМЯ(2020, 1, 1, 0, 0, 0) КАК Период,\r\n\t\t|\tВЫБОР\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток > 0\r\n\t\t|\t\t\tТОГДА ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток < 0\r\n\t\t|\t\t\tТОГДА ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)\r\n\t\t|\tКОНЕЦ КАК ВидДвижения,\r\n\t\t|\tПартииТоваровКомпанииОстатки.Номенклатура КАК Номенклатура,\r\n\t\t|\tПартииТоваровКомпанииОстатки.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,\r\n\t\t|\tПартииТоваровКомпанииОстатки.СтатусПартии КАК СтатусПартии,\r\n\t\t|\tПартииТоваровКомпанииОстатки.ДокументПоставки КАК ДокументПоставки,\r\n\t\t|\tПартииТоваровКомпанииОстатки.СкладКомпании КАК СкладКомпании,\r\n\t\t|\tПартииТоваровКомпанииОстатки.КоличествоОстаток КАК Количество,\r\n\t\t|\tВЫБОР\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток > 0\r\n\t\t|\t\t\tТОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток < 0\r\n\t\t|\t\t\tТОГДА ПартииТоваровКомпанииОстатки.СтоимостьОстаток * -1\r\n\t\t|\tКОНЕЦ КАК Стоимость,\r\n\t\t|\tВЫБОР\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьБезНДСОстаток > 0\r\n\t\t|\t\t\tТОГДА ПартииТоваровКомпанииОстатки.СтоимостьБезНДСОстаток\r\n\t\t|\t\tКОГДА ПартииТоваровКомпанииОстатки.СтоимостьБезНДСОстаток < 0\r\n\t\t|\t\t\tТОГДА ПартииТоваровКомпанииОстатки.СтоимостьБезНДСОстаток * -1\r\n\t\t|\tКОНЕЦ КАК СтоимостьБезНДСОстаток\r\n\t\t|ИЗ\r\n\t\t|\tРегистрНакопления.ПартииТоваровКомпании.Остатки КАК ПартииТоваровКомпанииОстатки\r\n\t\t|ГДЕ\r\n\t\t|\tПартииТоваровКомпанииОстатки.КоличествоОстаток = 0\r\n\t\t|\tИ ПартииТоваровКомпанииОстатки.СтоимостьОстаток <> 0\r\n\t\t|\";\t\r\n\t\t\r\n\tмРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tОбъект.Движения.ПартииТоваровКомпании.Загрузить(мРезультатЗапроса.Выгрузить());"
  },
  {
    "title": "ОграничениеТипа списка выбора",
    "description": "ОграничениеТипа списка выбора",
    "code_snippet": "Процедура СкладыИнвентаризацииНачалоВыбора(Элемент, СтандартнаяОбработка)\r\n\t\r\n    Элемент.ОграничениеТипа = Новый ОписаниеТипов(\"СправочникСсылка.Склады\");\r\n    Элемент.Значение = Элемент.ОграничениеТипа.ПривестиЗначение(Элемент.Значение);\r\n    Элемент.ВыбиратьТип = Ложь;\r\n\t\r\nКонецПроцедуры\n\nПроцедура СкладыИнвентаризацииНачалоВыбора(Элемент, СтандартнаяОбработка)\r\n\t\r\n    Элемент.ОграничениеТипа = Новый ОписаниеТипов(\"СправочникСсылка.Склады\");\r\n    Элемент.Значение = Элемент.ОграничениеТипа.ПривестиЗначение(Элемент.Значение);\r\n    Элемент.ВыбиратьТип = Ложь;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "ИР Открыть в VS Code с Гитом",
    "description": "ИР Открыть в VS Code с ГитомTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Табличный документ в таблицу значений",
    "description": "Табличный документ в таблицу значений",
    "code_snippet": "// загружаем табдок в таблицу значений\r\n\tОбластиТаб = ТабДок.Область(1, 1, ТабДок.ВысотаТаблицы, ТабДок.ШиринаТаблицы);\r\n\t//\r\n\tПостроитель = Новый ПостроительЗапроса;\r\n\tПостроитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(ОбластиТаб);  \r\n\tПостроитель.Выполнить();\r\n\t\r\n\tТабДанные = Построитель.Результат.Выгрузить();\n\n// загружаем табдок в таблицу значений\r\n\tОбластиТаб = ТабДок.Область(1, 1, ТабДок.ВысотаТаблицы, ТабДок.ШиринаТаблицы);\r\n\t//\r\n\tПостроитель = Новый ПостроительЗапроса;\r\n\tПостроитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(ОбластиТаб);  \r\n\tПостроитель.Выполнить();\r\n\t\r\n\tТабДанные = Построитель.Результат.Выгрузить();\n\n{8} Переменной ТабДанные присвоено значение, но оно нигде не используется\n\nПостроитель = Новый ПостроительЗапроса;\nПостроитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабДок.Область());  \nТабДанные = Построитель.Результат.Выгрузить();"
  },
  {
    "title": "ИР Запомнить для сравнения",
    "description": "ИР Запомнить для сравненияTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "Программное перемещение строк ДанныхФормКоллекции(Таблица значений) на Клиенте",
    "description": "Программное перемещение строк ДанныхФормКоллекции(Таблица значений) на Клиенте",
    "code_snippet": "&НаКлиенте\nПроцедура ПереместитьСтрокуВверх(Команда)\n\t\n\tПереместитьСтроку(-1);\n\t\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ПереместитьСтрокуВниз(Команда)\n\t\n\tПереместитьСтроку(1);\n\t\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ПереместитьСтроку(ГраницаСмещения)\n\t\n\tТекущиеДанные = Элементы.ТаблицаСоСпискомСтрок.ТекущиеДанные;\n\t\n\tЕсли ТекущиеДанные = Неопределено Тогда\n\t\tВозврат;\n\tКонецЕсли;\n\t\n\tТекущийПорядок = ТекущиеДанные.ПорядковыйНомер;\n\tНовыйПорядок = ТекущийПорядок + ГраницаСмещения;\n\t\n\tОбновитьВсеСтроки = Истина;\n\tЕсли НовыйПорядок < 1 Тогда\n\t\tНовыйПорядок = ТаблицаСоСпискомСтрок.Количество();\n\tИначеЕсли НовыйПорядок > ТаблицаСоСпискомСтрок.Количество() Тогда\n\t\tНовыйПорядок = 1;\n\tИначе\n\t\tОбновитьВсеСтроки = Ложь;\n\tКонецЕсли;\n\t\t\n\tТекущийИндекс = ТекущийПорядок - 1;\n\tНовыйИндекс = НовыйПорядок - 1;\n\t\n\tЕсли ТекущийПорядок <> НовыйПорядок Тогда\n\t\tДельтаСмещения = НовыйИндекс - ТекущийИндекс;\n\t\tТаблицаСоСпискомСтрок.Сдвинуть(ТекущийИндекс, ДельтаСмещения);\n\t\t\n\t\tПеремещаемаяСтрока = ТаблицаСоСпискомСтрок.Получить(НовыйИндекс);\n\t\tПеремещаемаяСтрока.ПорядковыйНомер = НовыйПорядок;\n\t\t\n\t\tЗамещаемаяСтрока = ТаблицаСоСпискомСтрок.Получить(ТекущийИндекс);\n\t\tЗамещаемаяСтрока.ПорядковыйНомер = ТекущийПорядок;\n\tКонецЕсли;\n\t\n\tЕсли ОбновитьВсеСтроки Тогда\n\t\tОбновитьПорядокВсехСтрок();\n\tКонецЕсли;\n\t\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ОбновитьПорядокВсехСтрок()\n\t\n\tДля Каждого СтрокаСписка Из ТаблицаСоСпискомСтрок Цикл\n\t\tСтрокаСписка.ПорядковыйНомер = ТаблицаСоСпискомСтрок.Индекс(СтрокаСписка) + 1;\n\tКонецЦикла;\n\nКонецПроцедуры"
  },
  {
    "title": "Получение ссылки по навигационной ссылке",
    "description": "Получение ссылки по навигационной ссылке",
    "code_snippet": "Функция СсылкаПоНС(НС)\r\n\tПерваяТочка = Найти(НС, \"e1cib/data/\");\r\n    ВтораяТочка = Найти(НС, \"?ref=\");\r\n    \r\n    ПредставлениеТипа   = Сред(НС, ПерваяТочка + 11, ВтораяТочка - ПерваяТочка - 11);\r\n    ШаблонЗначения = ЗначениеВСтрокуВнутр(ПредопределенноеЗначение(ПредставлениеТипа + \".ПустаяСсылка\"));\r\n    ЗначениеСсылки = СтрЗаменить(ШаблонЗначения, \"00000000000000000000000000000000\", Сред(НС, ВтораяТочка + 5));\r\n    Ссылка = ЗначениеИзСтрокиВнутр(ЗначениеСсылки);\r\n\tВозврат НС;\r\nКонецФункции\n\nФункция СсылкаПоНС(НС)\r\n\tПерваяТочка = Найти(НС, \"e1cib/data/\");\r\n    ВтораяТочка = Найти(НС, \"?ref=\");\r\n    \r\n    ПредставлениеТипа   = Сред(НС, ПерваяТочка + 11, ВтораяТочка - ПерваяТочка - 11);\r\n    ШаблонЗначения = ЗначениеВСтрокуВнутр(ПредопределенноеЗначение(ПредставлениеТипа + \".ПустаяСсылка\"));\r\n    ЗначениеСсылки = СтрЗаменить(ШаблонЗначения, \"00000000000000000000000000000000\", Сред(НС, ВтораяТочка + 5));\r\n    Ссылка = ЗначениеИзСтрокиВнутр(ЗначениеСсылки);\r\n\tВозврат НС;\r\nКонецФункции\n\n{8} Переменной Ссылка присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Скрипт по соединению строк (аналог Vim Join)",
    "description": "Соединяет текущую и нижестоящую строки в одну",
    "code_snippet": ""
  },
  {
    "title": "Сжатие длинной Строки",
    "description": "Сжатие длинной Строки",
    "code_snippet": "Функция СжатьСтроку(СтрокаJSON)\r\n\t//Для СтрокаJSON длиной 1 000 000 байт\r\n\t//СтрокаBase64 имеет длину 36 000 байт\r\n\t\r\n\tСжатиеДанных = Новый СжатиеДанных(9);\r\n\tЗначение = Новый ХранилищеЗначения(СтрокаJSON,СжатиеДанных);\r\n\tСтрокаBase64 = XMLСтрока(Значение);\t\t\t\t\t\t\t\t//Преобразуем в Base64 \t\t\t\r\n\tВозврат СтрокаBase64;\r\nКонецФункции\r\n\r\nФункция ВосстановитьСтроку(Стр)\r\n\r\n\tРезультат = Стр;\r\n\t\r\n\tХранилище = XMLЗначение(Тип(\"ХранилищеЗначения\"), Стр);\t\r\n\tСтрокаJSONизХранилища = Хранилище.Получить();\r\n\tЕсли НЕ СтрокаJSONизХранилища = Неопределено Тогда\t\t//  Исползовалось Сжатие через ХранилищеЗначения\r\n\t\tРезультат = СтрокаJSONизХранилища;\r\n\tКонецЕсли;\t\t\t\t\r\n\r\n\tВозврат Результат;\r\nКонецФункции\n\nФункция СжатьСтроку(СтрокаJSON)\r\n\t//Для СтрокаJSON длиной 1 000 000 байт\r\n\t//СтрокаBase64 имеет длину 36 000 байт\r\n\t\r\n\tСжатиеДанных = Новый СжатиеДанных(9);\r\n\tЗначение = Новый ХранилищеЗначения(СтрокаJSON,СжатиеДанных);\r\n\tСтрокаBase64 = XMLСтрока(Значение);\t\t\t\t\t\t\t\t//Преобразуем в Base64 \t\t\t\r\n\tВозврат СтрокаBase64;\r\nКонецФункции\r\n\r\nФункция ВосстановитьСтроку(Стр)\r\n\r\n\tРезультат = Стр;\r\n\t\r\n\tХранилище = XMLЗначение(Тип(\"ХранилищеЗначения\"), Стр);\t\r\n\tСтрокаJSONизХранилища = Хранилище.Получить();\r\n\tЕсли НЕ СтрокаJSONизХранилища = Неопределено Тогда\t\t//  Исползовалось Сжатие через ХранилищеЗначения\r\n\t\tРезультат = СтрокаJSONизХранилища;\r\n\tКонецЕсли;\t\t\t\t\r\n\r\n\tВозврат Результат;\r\nКонецФункции\n\nОрфографическая ошибка в Исползовалось: Исползовалось"
  },
  {
    "title": "Как в TurboConf заменить Ctrl+Click для перехода к объекту на горячую клавишу",
    "description": "Как в TurboConf заменить Ctrl+Click для перехода к объекту на горячую клавишуСекреты TurboConf",
    "code_snippet": ""
  },
  {
    "title": "Функция копирования колонок в таблицу или дерево значений (конструктор таблиц и деревьев значений)",
    "description": "Функция копирования колонок в таблицу или дерево значений (конструктор таблиц и деревьев значений)",
    "code_snippet": "// СкопироватьКолонки  —  Копирует заданные колонки из Источника в Приемник с учетом исключений\r\n// \r\n// Параметры: \r\n// Приемник — ТаблицаЗначений, ДеревоЗначений — коллекция в которой создаются колонки\r\n// Источник — РезультатЗапроса, ТаблицаЗначений, ДеревоЗначений — коллекция из которой копируются свойства колонок\r\n//          — СтрокаДереваЗначений, СтрокаТаблицыЗначений — строка коллекции из которой копируются свойства колонок\r\n// ИменаКолонок — Строка — разделенные запятыми имена колонок, которые подлежат копированию\r\n//              — Массив, ФиксированныйМассив — массив имен колонок, которые подлежат копированию              \r\n//              — Неопределено — копируются все колонки с учетом исключений              \r\n// ИменаКолонокИсключений — Строка — разделенные запятыми имена колонок, которые исключены из копирования\r\n//              \t\t  — Массив, ФиксированныйМассив — массив имен колонок, которые исключены из копирования\r\n//              \t\t  — Неопределено — нет исключений              \r\n//\r\n// Возвращаемое значение: \r\n//      — ТаблицаЗначений, ДеревоЗначений — значение параметра Приемник\r\n// Пример:\r\n//       Дерево = СкопироватьКолонки(Новый ДеревоЗначений(), РезультатЗапроса);\r\n//\r\nФункция СкопироватьКолонки(Приемник, Знач Источник, Знач ИменаКолонок = Неопределено, Знач ИменаКолонокИсключений = Неопределено) Экспорт\r\n\tПерем Колонка, КоллекцияИмен, КоллекцияИменИсключений, КолонкиИсточника;        \r\n\t\r\n\tЕсли ЗначениеЗаполнено(ИменаКолонок) Тогда \r\n\t\tЕсли ТипЗнч(ИменаКолонок) = Тип(\"Строка\") Тогда\r\n\t\t    КоллекцияИмен = РазложитьСтрокуВМассивПодстрок(ИменаКолонок, \",\", Истина, Истина);\r\n\t\tИначе\t\r\n\t\t    КоллекцияИмен = ИменаКолонок;\r\n\t\tКонецЕсли;                      \r\n\tИначе \r\n\t\tКоллекцияИмен = Неопределено;\r\n\tКонецЕсли;     \r\n\r\n\tЕсли ЗначениеЗаполнено(ИменаКолонокИсключений) Тогда \r\n\t\tЕсли ТипЗнч(ИменаКолонокИсключений) = Тип(\"Строка\") Тогда\r\n\t\t    КоллекцияИменИсключений = РазложитьСтрокуВМассивПодстрок(ИменаКолонокИсключений, \",\", Истина, Истина);\r\n\t\tИначе\t\r\n\t\t    КоллекцияИменИсключений = ИменаКолонокИсключений;\r\n\t\tКонецЕсли;\r\n\tИначе \r\n\t\tКоллекцияИменИсключений = Неопределено;\r\n\tКонецЕсли;     \r\n\t\r\n\tЕсли ТипЗнч(Источник) = Тип(\"СтрокаДереваЗначений\") \r\n\t\tИЛИ ТипЗнч(Источник) = Тип(\"СтрокаТаблицыЗначений\") Тогда \r\n\t\tКолонкиИсточника = Источник.Владелец().Колонки;\r\n\tИначе\t\r\n\t\tКолонкиИсточника = Источник.Колонки;\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого Колонка Из КолонкиИсточника Цикл\r\n\t\tЕсли (КоллекцияИмен = Неопределено ИЛИ КоллекцияИмен.Найти(Колонка.Имя) <> Неопределено)\r\n\t\t\tИ (КоллекцияИменИсключений = Неопределено ИЛИ КоллекцияИменИсключений.Найти(Колонка.Имя) = Неопределено)\r\n\t\tТогда\r\n            Если ТипЗнч(Источник) = Тип(\"РезультатЗапроса\") Тогда\r\n\t\t\t    Приемник.Колонки.Добавить(Колонка.Имя, Колонка.ТипЗначения, Колонка.Имя, Колонка.Ширина);\r\n            Иначе\r\n\t\t\t    Приемник.Колонки.Добавить(Колонка.Имя, Колонка.ТипЗначения, Колонка.Заголовок, Колонка.Ширина);\r\n            КонецЕсли; \r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tВозврат Приемник;\t\r\nКонецФункции\n\n// СкопироватьКолонки  —  Копирует заданные колонки из Источника в Приемник с учетом исключений\r\n// \r\n// Параметры: \r\n// Приемник — ТаблицаЗначений, ДеревоЗначений — коллекция в которой создаются колонки\r\n// Источник — РезультатЗапроса, ТаблицаЗначений, ДеревоЗначений — коллекция из которой копируются свойства колонок\r\n//          — СтрокаДереваЗначений, СтрокаТаблицыЗначений — строка коллекции из которой копируются свойства колонок\r\n// ИменаКолонок — Строка — разделенные запятыми имена колонок, которые подлежат копированию\r\n//              — Массив, ФиксированныйМассив — массив имен колонок, которые подлежат копированию              \r\n//              — Неопределено — копируются все колонки с учетом исключений              \r\n// ИменаКолонокИсключений — Строка — разделенные запятыми имена колонок, которые исключены из копирования\r\n//              \t\t  — Массив, ФиксированныйМассив — массив имен колонок, которые исключены из копирования\r\n//              \t\t  — Неопределено — нет исключений              \r\n//\r\n// Возвращаемое значение: \r\n//      — ТаблицаЗначений, ДеревоЗначений — значение параметра Приемник\r\n// Пример:\r\n//       Дерево = СкопироватьКолонки(Новый ДеревоЗначений(), РезультатЗапроса);\r\n//\r\nФункция СкопироватьКолонки(Приемник, Знач Источник, Знач ИменаКолонок = Неопределено, Знач ИменаКолонокИсключений = Неопределено) Экспорт\r\n\tПерем Колонка, КоллекцияИмен, КоллекцияИменИсключений, КолонкиИсточника;        \r\n\t\r\n\tЕсли ЗначениеЗаполнено(ИменаКолонок) Тогда \r\n\t\tЕсли ТипЗнч(ИменаКолонок) = Тип(\"Строка\") Тогда\r\n\t\t    КоллекцияИмен = РазложитьСтрокуВМассивПодстрок(ИменаКолонок, \",\", Истина, Истина);\r\n\t\tИначе\t\r\n\t\t    КоллекцияИмен = ИменаКолонок;\r\n\t\tКонецЕсли;                      \r\n\tИначе \r\n\t\tКоллекцияИмен = Неопределено;\r\n\tКонецЕсли;     \r\n\r\n\tЕсли ЗначениеЗаполнено(ИменаКолонокИсключений) Тогда \r\n\t\tЕсли ТипЗнч(ИменаКолонокИсключений) = Тип(\"Строка\") Тогда\r\n\t\t    КоллекцияИменИсключений = РазложитьСтрокуВМассивПодстрок(ИменаКолонокИсключений, \",\", Истина, Истина);\r\n\t\tИначе\t\r\n\t\t    КоллекцияИменИсключений = ИменаКолонокИсключений;\r\n\t\tКонецЕсли;\r\n\tИначе \r\n\t\tКоллекцияИменИсключений = Неопределено;\r\n\tКонецЕсли;     \r\n\t\r\n\tЕсли ТипЗнч(Источник) = Тип(\"СтрокаДереваЗначений\") \r\n\t\tИЛИ ТипЗнч(Источник) = Тип(\"СтрокаТаблицыЗначений\") Тогда \r\n\t\tКолонкиИсточника = Источник.Владелец().Колонки;\r\n\tИначе\t\r\n\t\tКолонкиИсточника = Источник.Колонки;\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого Колонка Из КолонкиИсточника Цикл\r\n\t\tЕсли (КоллекцияИмен = Неопределено ИЛИ КоллекцияИмен.Найти(Колонка.Имя) <> Неопределено)\r\n\t\t\tИ (КоллекцияИменИсключений = Неопределено ИЛИ КоллекцияИменИсключений.Найти(Колонка.Имя) = Неопределено)\r\n\t\tТогда\r\n            Если ТипЗнч(Источник) = Тип(\"РезультатЗапроса\") Тогда\r\n\t\t\t    Приемник.Колонки.Добавить(Колонка.Имя, Колонка.ТипЗначения, Колонка.Имя, Колонка.Ширина);\r\n            Иначе\r\n\t\t\t    Приемник.Колонки.Добавить(Колонка.Имя, Колонка.ТипЗначения, Колонка.Заголовок, Колонка.Ширина);\r\n            КонецЕсли; \r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tВозврат Приемник;\t\r\nКонецФункции"
  },
  {
    "title": "Функции копирования настроек компоновки данных",
    "description": "Функции копирования настроек компоновки данных",
    "code_snippet": "// СкопироватьЭлементыНастроекКомпоновкиДанных  —  копирует однотипные коллекции элементов настроек Компоновки Данных\r\n// \r\n// Параметры: \r\n// КоллекцияПриемник —  — приемник,коллекция элементов Компоновки Данных, того же типа, что и источник \r\n// КоллекцияИсточник —  — источник, любая коллекция элементов Компоновки Данных\r\n// ОчищатьПриемник — Булево — при значении Истина (по умолчанию) предварительно очищается коллекция приемник\r\n//\r\n// Пример:\r\n//А.  \r\n//\tЗаписьXML = Новый ЗаписьXML;\r\n//\tЗаписьXML.УстановитьСтроку();     \r\n//\tСериализаторXDTO.ЗаписатьXML(ЗаписьXML, НастройкиОтбора , \"Filter\", \"http://v8.1c.ru/8.1/data-composition-system/settings\");\r\n//  УсловияСопоставленияДокументовXML = ЗаписьXML.Закрыть();\r\n//  ......\r\n//\tЧтениеXML = Новый ЧтениеXML;   \r\n//\tЧтениеXML.УстановитьСтроку(УсловияСопоставленияДокументовXML);\r\n//\tНастройкиОтбораДокументов = СериализаторXDTO.ПрочитатьXML(ЧтениеXML, Тип(\"ОтборКомпоновкиДанных\")); \r\n//      СкопироватьЭлементыНастроекКомпоновкиДанных(КомпоновщикНастроек.Настройки.Отбор, НастройкиОтбораДокументов, Истина);\r\n//  \r\n//Б. \r\n//\tСкопироватьЭлементыНастроекКомпоновкиДанных(ОтчетОбъект.КомпоновщикНастроек.Настройки.Порядок, Настройки.Порядок, Истина);\r\nПроцедура СкопироватьЭлементыНастроекКомпоновкиДанных(Знач КоллекцияПриемник, Знач КоллекцияИсточник, Знач ОчищатьПриемник = Истина) Экспорт\r\n    \r\n    Если ТипЗнч(КоллекцияИсточник) = Тип(\"УсловноеОформлениеКомпоновкиДанных\")\r\n        ИЛИ ТипЗнч(КоллекцияИсточник) = Тип(\"ВариантыПользовательскогоПоляВыборКомпоновкиДанных\")\r\n        ИЛИ ТипЗнч(КоллекцияИсточник) = Тип(\"ОформляемыеПоляКомпоновкиДанных\")\r\n        ИЛИ ТипЗнч(КоллекцияИсточник) = Тип(\"ЗначенияПараметровДанныхКомпоновкиДанных\") Тогда\r\n        СоздаватьПоТипу = Ложь;\r\n    Иначе\r\n        СоздаватьПоТипу = Истина;\r\n    КонецЕсли;\r\n    \r\n    ПриемникЭлементов = КоллекцияПриемник.Элементы;\r\n    Если ОчищатьПриемник Тогда\r\n        ПриемникЭлементов.Очистить();\r\n    КонецЕсли;\r\n    ИсточникЭлементов = КоллекцияИсточник.Элементы;\r\n    \r\n    Для каждого ЭлементИсточник Из ИсточникЭлементов Цикл\r\n        \r\n        Если ТипЗнч(ЭлементИсточник) = Тип(\"ЭлементПорядкаКомпоновкиДанных\") Тогда\r\n            Индекс = ИсточникЭлементов.Индекс(ЭлементИсточник);                            // Элементы порядка добавляем в начало\r\n\r\n            ЭлементПриемник = ПриемникЭлементов.Вставить(Индекс, ТипЗнч(ЭлементИсточник));\r\n        Иначе\r\n            Если СоздаватьПоТипу Тогда\r\n                ЭлементПриемник = ПриемникЭлементов.Добавить(ТипЗнч(ЭлементИсточник));\r\n            Иначе\r\n                ЭлементПриемник = ПриемникЭлементов.Добавить();\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n        \r\n        ЗаполнитьЗначенияСвойств(ЭлементПриемник, ЭлементИсточник);\r\n        \r\n        // скопируем вложенные коллекции\r\n        Если ТипЗнч(ИсточникЭлементов) = Тип(\"КоллекцияЭлементовУсловногоОформленияКомпоновкиДанных\") Тогда\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.Поля, ЭлементИсточник.Поля);\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.Отбор, ЭлементИсточник.Отбор);\r\n            ЗаполнитьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.Оформление, ЭлементИсточник.Оформление); \r\n        ИначеЕсли ТипЗнч(ИсточникЭлементов) = Тип(\"КоллекцияВариантовПользовательскогоПоляВыборКомпоновкиДанных\") Тогда\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.Отбор, ЭлементИсточник.Отбор);\r\n        КонецЕсли;\r\n        \r\n        // скопируем подчиненные коллекции\r\n        Если ТипЗнч(ЭлементИсточник) = Тип(\"ГруппаЭлементовОтбораКомпоновкиДанных\") Тогда\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник, ЭлементИсточник);\r\n        ИначеЕсли ТипЗнч(ЭлементИсточник) = Тип(\"ГруппаВыбранныхПолейКомпоновкиДанных\") Тогда\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник, ЭлементИсточник);\r\n        ИначеЕсли ТипЗнч(ЭлементИсточник) = Тип(\"ПользовательскоеПолеВыборКомпоновкиДанных\") Тогда\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.Варианты, ЭлементИсточник.Варианты);\r\n        ИначеЕсли ТипЗнч(ЭлементИсточник) = Тип(\"ПользовательскоеПолеВыражениеКомпоновкиДанных\") Тогда\r\n            ЭлементПриемник.УстановитьВыражениеДетальныхЗаписей (ЭлементИсточник.ПолучитьВыражениеДетальныхЗаписей());\r\n            ЭлементПриемник.УстановитьВыражениеИтоговыхЗаписей(ЭлементИсточник.ПолучитьВыражениеИтоговыхЗаписей());\r\n            ЭлементПриемник.УстановитьПредставлениеВыраженияДетальныхЗаписей(ЭлементИсточник.ПолучитьПредставлениеВыраженияДетальныхЗаписей ());\r\n            ЭлементПриемник.УстановитьПредставлениеВыраженияИтоговыхЗаписей(ЭлементИсточник.ПолучитьПредставлениеВыраженияИтоговыхЗаписей ());\r\n        КонецЕсли;\r\n        \r\n    КонецЦикла;\r\n    \r\nКонецПроцедуры\r\n\r\n// ЗаполнитьЭлементыНастроекКомпоновкиДанных  —  копирует однотипные коллекции значений параметров настроек Компоновки Данных\r\n// \r\n// Параметры: \r\n// ПриемникЗначения —  — приемник, коллекция однотипная с источником \r\n// ИсточникЗначения —  — источник, любая коллекция значений параметров настроек Компоновки Данных\r\n// ПредыдущийУровень —  — предыдущий уровень в иерархии приемника\r\n//\r\nПроцедура ЗаполнитьЭлементыНастроекКомпоновкиДанных(Знач ПриемникЗначения, Знач ИсточникЗначения, Знач ПредыдущийУровень = Неопределено) Экспорт\r\n    \r\n    Если ТипЗнч(ПриемникЗначения) = Тип(\"КоллекцияЗначенийПараметровКомпоновкиДанных\") Тогда\r\n        КоллекцияЗначений = ИсточникЗначения;\r\n    Иначе\r\n        КоллекцияЗначений = ИсточникЗначения.Элементы;\r\n    КонецЕсли;\r\n    \r\n    Для каждого ЭлементИсточник Из КоллекцияЗначений Цикл\r\n        Если ПредыдущийУровень = Неопределено Тогда\r\n            ЭлементПриемник = ПриемникЗначения.НайтиЗначениеПараметра(ЭлементИсточник.Параметр);\r\n        Иначе\r\n            ЭлементПриемник = ПредыдущийУровень.НайтиЗначениеПараметра(ЭлементИсточник.Параметр);\r\n        КонецЕсли;\r\n        Если ЭлементПриемник = Неопределено Тогда\r\n            Продолжить;\r\n        КонецЕсли;\r\n        ЗаполнитьЗначенияСвойств(ЭлементПриемник, ЭлементИсточник);\r\n        Если ТипЗнч(ЭлементИсточник) = Тип(\"ЗначениеПараметраКомпоновкиДанных\") Тогда\r\n            Если ЭлементИсточник.ЗначенияВложенныхПараметров.Количество() <> 0 Тогда\r\n                ЗаполнитьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.ЗначенияВложенныхПараметров, ЭлементИсточник.ЗначенияВложенныхПараметров, ПриемникЗначения);\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n    КонецЦикла;\r\n    \r\nКонецПроцедуры\n\n// СкопироватьЭлементыНастроекКомпоновкиДанных  —  копирует однотипные коллекции элементов настроек Компоновки Данных\r\n// \r\n// Параметры: \r\n// КоллекцияПриемник —  — приемник,коллекция элементов Компоновки Данных, того же типа, что и источник \r\n// КоллекцияИсточник —  — источник, любая коллекция элементов Компоновки Данных\r\n// ОчищатьПриемник — Булево — при значении Истина (по умолчанию) предварительно очищается коллекция приемник\r\n//\r\n// Пример:\r\n//А.  \r\n//\tЗаписьXML = Новый ЗаписьXML;\r\n//\tЗаписьXML.УстановитьСтроку();     \r\n//\tСериализаторXDTO.ЗаписатьXML(ЗаписьXML, НастройкиОтбора , \"Filter\", \"http://v8.1c.ru/8.1/data-composition-system/settings\");\r\n//  УсловияСопоставленияДокументовXML = ЗаписьXML.Закрыть();\r\n//  ......\r\n//\tЧтениеXML = Новый ЧтениеXML;   \r\n//\tЧтениеXML.УстановитьСтроку(УсловияСопоставленияДокументовXML);\r\n//\tНастройкиОтбораДокументов = СериализаторXDTO.ПрочитатьXML(ЧтениеXML, Тип(\"ОтборКомпоновкиДанных\")); \r\n//      СкопироватьЭлементыНастроекКомпоновкиДанных(КомпоновщикНастроек.Настройки.Отбор, НастройкиОтбораДокументов, Истина);\r\n//  \r\n//Б. \r\n//\tСкопироватьЭлементыНастроекКомпоновкиДанных(ОтчетОбъект.КомпоновщикНастроек.Настройки.Порядок, Настройки.Порядок, Истина);\r\nПроцедура СкопироватьЭлементыНастроекКомпоновкиДанных(Знач КоллекцияПриемник, Знач КоллекцияИсточник, Знач ОчищатьПриемник = Истина) Экспорт\r\n    \r\n    Если ТипЗнч(КоллекцияИсточник) = Тип(\"УсловноеОформлениеКомпоновкиДанных\")\r\n        ИЛИ ТипЗнч(КоллекцияИсточник) = Тип(\"ВариантыПользовательскогоПоляВыборКомпоновкиДанных\")\r\n        ИЛИ ТипЗнч(КоллекцияИсточник) = Тип(\"ОформляемыеПоляКомпоновкиДанных\")\r\n        ИЛИ ТипЗнч(КоллекцияИсточник) = Тип(\"ЗначенияПараметровДанныхКомпоновкиДанных\") Тогда\r\n        СоздаватьПоТипу = Ложь;\r\n    Иначе\r\n        СоздаватьПоТипу = Истина;\r\n    КонецЕсли;\r\n    \r\n    ПриемникЭлементов = КоллекцияПриемник.Элементы;\r\n    Если ОчищатьПриемник Тогда\r\n        ПриемникЭлементов.Очистить();\r\n    КонецЕсли;\r\n    ИсточникЭлементов = КоллекцияИсточник.Элементы;\r\n    \r\n    Для каждого ЭлементИсточник Из ИсточникЭлементов Цикл\r\n        \r\n        Если ТипЗнч(ЭлементИсточник) = Тип(\"ЭлементПорядкаКомпоновкиДанных\") Тогда\r\n            Индекс = ИсточникЭлементов.Индекс(ЭлементИсточник);                            // Элементы порядка добавляем в начало\r\n\r\n            ЭлементПриемник = ПриемникЭлементов.Вставить(Индекс, ТипЗнч(ЭлементИсточник));\r\n        Иначе\r\n            Если СоздаватьПоТипу Тогда\r\n                ЭлементПриемник = ПриемникЭлементов.Добавить(ТипЗнч(ЭлементИсточник));\r\n            Иначе\r\n                ЭлементПриемник = ПриемникЭлементов.Добавить();\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n        \r\n        ЗаполнитьЗначенияСвойств(ЭлементПриемник, ЭлементИсточник);\r\n        \r\n        // скопируем вложенные коллекции\r\n        Если ТипЗнч(ИсточникЭлементов) = Тип(\"КоллекцияЭлементовУсловногоОформленияКомпоновкиДанных\") Тогда\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.Поля, ЭлементИсточник.Поля);\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.Отбор, ЭлементИсточник.Отбор);\r\n            ЗаполнитьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.Оформление, ЭлементИсточник.Оформление); \r\n        ИначеЕсли ТипЗнч(ИсточникЭлементов) = Тип(\"КоллекцияВариантовПользовательскогоПоляВыборКомпоновкиДанных\") Тогда\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.Отбор, ЭлементИсточник.Отбор);\r\n        КонецЕсли;\r\n        \r\n        // скопируем подчиненные коллекции\r\n        Если ТипЗнч(ЭлементИсточник) = Тип(\"ГруппаЭлементовОтбораКомпоновкиДанных\") Тогда\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник, ЭлементИсточник);\r\n        ИначеЕсли ТипЗнч(ЭлементИсточник) = Тип(\"ГруппаВыбранныхПолейКомпоновкиДанных\") Тогда\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник, ЭлементИсточник);\r\n        ИначеЕсли ТипЗнч(ЭлементИсточник) = Тип(\"ПользовательскоеПолеВыборКомпоновкиДанных\") Тогда\r\n            СкопироватьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.Варианты, ЭлементИсточник.Варианты);\r\n        ИначеЕсли ТипЗнч(ЭлементИсточник) = Тип(\"ПользовательскоеПолеВыражениеКомпоновкиДанных\") Тогда\r\n            ЭлементПриемник.УстановитьВыражениеДетальныхЗаписей (ЭлементИсточник.ПолучитьВыражениеДетальныхЗаписей());\r\n            ЭлементПриемник.УстановитьВыражениеИтоговыхЗаписей(ЭлементИсточник.ПолучитьВыражениеИтоговыхЗаписей());\r\n            ЭлементПриемник.УстановитьПредставлениеВыраженияДетальныхЗаписей(ЭлементИсточник.ПолучитьПредставлениеВыраженияДетальныхЗаписей ());\r\n            ЭлементПриемник.УстановитьПредставлениеВыраженияИтоговыхЗаписей(ЭлементИсточник.ПолучитьПредставлениеВыраженияИтоговыхЗаписей ());\r\n        КонецЕсли;\r\n        \r\n    КонецЦикла;\r\n    \r\nКонецПроцедуры\r\n\r\n// ЗаполнитьЭлементыНастроекКомпоновкиДанных  —  копирует однотипные коллекции значений параметров настроек Компоновки Данных\r\n// \r\n// Параметры: \r\n// ПриемникЗначения —  — приемник, коллекция однотипная с источником \r\n// ИсточникЗначения —  — источник, любая коллекция значений параметров настроек Компоновки Данных\r\n// ПредыдущийУровень —  — предыдущий уровень в иерархии приемника\r\n//\r\nПроцедура ЗаполнитьЭлементыНастроекКомпоновкиДанных(Знач ПриемникЗначения, Знач ИсточникЗначения, Знач ПредыдущийУровень = Неопределено) Экспорт\r\n    \r\n    Если ТипЗнч(ПриемникЗначения) = Тип(\"КоллекцияЗначенийПараметровКомпоновкиДанных\") Тогда\r\n        КоллекцияЗначений = ИсточникЗначения;\r\n    Иначе\r\n        КоллекцияЗначений = ИсточникЗначения.Элементы;\r\n    КонецЕсли;\r\n    \r\n    Для каждого ЭлементИсточник Из КоллекцияЗначений Цикл\r\n        Если ПредыдущийУровень = Неопределено Тогда\r\n            ЭлементПриемник = ПриемникЗначения.НайтиЗначениеПараметра(ЭлементИсточник.Параметр);\r\n        Иначе\r\n            ЭлементПриемник = ПредыдущийУровень.НайтиЗначениеПараметра(ЭлементИсточник.Параметр);\r\n        КонецЕсли;\r\n        Если ЭлементПриемник = Неопределено Тогда\r\n            Продолжить;\r\n        КонецЕсли;\r\n        ЗаполнитьЗначенияСвойств(ЭлементПриемник, ЭлементИсточник);\r\n        Если ТипЗнч(ЭлементИсточник) = Тип(\"ЗначениеПараметраКомпоновкиДанных\") Тогда\r\n            Если ЭлементИсточник.ЗначенияВложенныхПараметров.Количество() <> 0 Тогда\r\n                ЗаполнитьЭлементыНастроекКомпоновкиДанных(ЭлементПриемник.ЗначенияВложенныхПараметров, ЭлементИсточник.ЗначенияВложенныхПараметров, ПриемникЗначения);\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n    КонецЦикла;\r\n    \r\nКонецПроцедуры\n\nОрфографическая ошибка в однотипные (найдено 3): однотипные\r\nОрфографическая ошибка в однотипная: однотипная"
  },
  {
    "title": "Присоединение печатной формы в виде файла к объекту-основанию",
    "description": "Присоединение печатной формы в виде файла к объекту-основаниюВсе",
    "code_snippet": "УстановитьПривилегированныйРежим(Истина);\n\nТабДок = Новый ТабличныйДокумент;\nМакет  = УправлениеПечатью.МакетПечатнойФормы(\"Документ.ЗаказМатериаловВПроизводство.ПФ_MXL_ЗаказМатериаловВПроизводство\"); \n\nЗаголовокДокумента = Макет.ПолучитьОбласть(\"Заголовок\"); \nШапкаТаблицы       = Макет.ПолучитьОбласть(\"Шапка\");   \nСтрокаТаблицы\t   = Макет.ПолучитьОбласть(\"Строка\");   \nПодвалТаблицы\t   = Макет.ПолучитьОбласть(\"Подвал\");   \nПодвалМЗК\t\t   = Макет.ПолучитьОбласть(\"ПодвалМЗК\");   \nПодвалПроминком    = Макет.ПолучитьОбласть(\"ПодвалПроминкомНе60\"); \n\nЗапрос = Новый Запрос; \nЗапрос.УстановитьПараметр(\"МассивСсылок\", МассивОбъектов);\nЗапрос.Текст =\n\"ВЫБРАТЬ\n|\tЗаказМатериаловВПроизводство.Ссылка  \t\t\t\t\t\t\t\t\t\tКАК СсылкаОтбор,\n|\tЗаказМатериаловВПроизводство.з_ПодразделениеЗакупки \t\t\t\t\t\tКАК ПодразделениеЗакупки,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводство.Ссылка) \t\t\t\t\t\t\tКАК Ссылка,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводство.Дата) \t\t\t\t\t\t\tКАК Дата,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводство.Номер) \t\t\t\t\t\t\tКАК Номер,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводство.Организация) \t\t\t\t\tКАК Организация,\n|\tЗаказМатериаловВПроизводство.Организация.ИНН \t\t\t\t\t\t\t\tКАК ИННОрганизации,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводство.Склад) \t\t\t\t\t\t\tКАК Склад,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводство.ЦеховаяКладовая) \t\t\t\tКАК ЦеховаяКладовая,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводство.НаправлениеДеятельности) \t\tКАК НаправлениеДеятельности,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводство.Ответственный) \t\t\t\t\tКАК Ответственный,\n|\tЗаказМатериаловВПроизводство.Ответственный.Наименование \t\t\t\t\tКАК ОтветственныйНаименование,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводство.з_Спецификация) \t\t\t\t\tКАК Спецификация,\n|ИЗ\n|\tДокумент.ЗаказМатериаловВПроизводство \t\t\t\t\t\t\t\t\t\tКАК ЗаказМатериаловВПроизводство\n|ГДЕ\n|\tЗаказМатериаловВПроизводство.Ссылка В(&МассивСсылок)\n|;\n|\n|////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n|ВЫБРАТЬ\n|\tЗаказМатериаловВПроизводствоТовары.Ссылка \t\t\t\t\t\t\t\t\tКАК СсылкаОтбор,  \n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводствоТовары.НомерСтроки) \t\t\t\tКАК НомерСтроки,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводствоТовары.Номенклатура) \t\t\t\tКАК Номенклатура,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводствоТовары.НачалоОтгрузки) \t\t\tКАК ДатаОтгрузки,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводствоТовары.КоличествоУпаковок) \t\tКАК Количество,    \t\n|\tЕСТЬNULL(спрНоменклатура.Артикул, \"\"\"\") \t\t\t\t\t\t\t\t\tКАК Артикул,\n|\tЕСТЬNULL(спрНоменклатура.ЕдиницаИзмерения, \"\"\"\") \t\t\t\t\t\t\tКАК ЕдИзм,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводствоТовары.ВариантОбеспечения) \t\tКАК Действия,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводствоТовары.з_ЦелевойСрокПоставки) \tКАК ЦелевойСрок,\n|\tПРЕДСТАВЛЕНИЕ(ЗаказМатериаловВПроизводствоТовары.з_ПлановыйСрокПоставки) \tКАК ПлановыйСрокПоставки\n|ИЗ\n|\tДокумент.ЗаказМатериаловВПроизводство.Товары \t\t\t\t\t\t\t\tКАК ЗаказМатериаловВПроизводствоТовары\n|\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура \t\t\t\t\t\t\t\tКАК спрНоменклатура\n|\tПО (ЗаказМатериаловВПроизводствоТовары.Номенклатура = спрНоменклатура.Ссылка)\n|\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура.ДополнительныеРеквизиты \t\tКАК спрНоменклатураДополнительныеРеквизиты\n|\tПО (ЗаказМатериаловВПроизводствоТовары.Номенклатура = спрНоменклатураДополнительныеРеквизиты.Ссылка\n|\tИ ДополнительныеРеквизитыИСведения.Ссылка = спрНоменклатураДополнительныеРеквизиты.Свойство)\n|ГДЕ\n|\tЗаказМатериаловВПроизводствоТовары.Ссылка В(&МассивСсылок)\n|ИТОГИ ПО\n|\tСсылкаОтбор\t\t\";\n\t\nКоллекцияРезультатов = Запрос.ВыполнитьПакет();\nВыборкаШапкаДокументов = КоллекцияРезультатов[0].Выбрать();\nВыборкаТоварыДокумента = КоллекцияРезультатов[1].Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);\t\t\n\nПодразделениеЗакупки   = Справочники.СтруктураПредприятия.НайтиПоКоду(\"60\");\n\nПерваяСтраница = Истина;\nПока ВыборкаШапкаДокументов.Следующий() Цикл\n\t\n\t НомерСтрокиНачало = ТабДок.ВысотаТаблицы + 1; // +++ ДополнительныйФункционалСохранения\n\t \n\t ТекущаяСсылка = ВыборкаШапкаДокументов.СсылкаОтбор;\n\t\n\t Если ПерваяСтраница Тогда  \n\t\t ПерваяСтраница = Ложь;\n\t Иначе\n\t\t ТабДок.ВывестиГоризонтальныйРазделительСтраниц();\n\t КонецЕсли;\n\t \n\t // Заполнение заголовка документа.\n\t ЗаголовокДокумента.Параметры.Заполнить(ВыборкаШапкаДокументов); \n\t ТабДок.Вывести(ЗаголовокДокумента); \n\t \n\t // Вывод шапки таблицы документа.\n\t ТабДок.Вывести(ШапкаТаблицы);\n\t \n\t // Заполнение строки таблицы документа.\n\t ПараметрыПоиска = Новый Структура(\"СсылкаОтбор\", ТекущаяСсылка);\n\t ЗаписьНайдена   = ВыборкаТоварыДокумента.НайтиСледующий(ПараметрыПоиска);\n\t Если ЗаписьНайдена Тогда\n\t\t \n\t\t // Указатель перемещен.\t\t\t \n\t\t ВыборкаТоварыДетальные = ВыборкаТоварыДокумента.Выбрать();\n\t\t \n\t\t Пока ВыборкаТоварыДетальные.Следующий() Цикл\n\t\t\t СтрокаТаблицы.Параметры.Заполнить(ВыборкаТоварыДетальные);  \n\t\t\t ТабДок.Вывести(СтрокаТаблицы);\n\t\t КонецЦикла;  \n\t\t ВыборкаТоварыДокумента.Сбросить();\n\t\t \n\t КонецЕсли;  \n\t \n\t // Заполнение подвала таблицы документа.\n\t Если ВыборкаШапкаДокументов.ПодразделениеЗакупки = ПодразделениеЗакупки Тогда\n\t\t \n\t\t ПодвалМЗК.Параметры.Исполнитель = ФизическиеЛицаКлиентСервер.ФамилияИнициалы(ВыборкаШапкаДокументов.ОтветственныйНаименование);\n\t\t ПодвалМЗК.Параметры.РуководительЗЗ = ФизическиеЛицаКлиентСервер.ФамилияИнициалы(РуководительЗЗ(ВыборкаШапкаДокументов.ЗЗ));\n\t\t ПодвалМЗК.Параметры.НД = ВыборкаШапкаДокументов.НаправлениеДеятельности;\n\t\t \n\t\t ТаблицаПодписантов = з_ОбщийМодульСервер.ПолучитьСведеньеОПодписантах(ТекущаяСсылка);\n\t\t \n\t\t Для Каждого СтрокаТЧ Из ТаблицаПодписантов Цикл    \n\t\t\t \n\t\t\t Если СтрНайти(СтрокаТЧ.Ключ, \"Подписант\") > 0 Тогда\n\t\t\t\tНомерПодписанта = СтрЗаменить(СтрокаТЧ.Ключ, \"Подписант\", \"\"); \n\t\t\t\tПодвалМЗК.Параметры[\"Подписант\" + НомерПодписанта] = ФизическиеЛицаКлиентСервер.ФамилияИнициалы(СтрокаТЧ.Значение);\n\t\t\tИначеЕсли СтрНайти(СтрокаТЧ.Ключ, \"Должность\") > 0 Тогда\n\t\t\t\tНомерДолжности= СтрЗаменить(СтрокаТЧ.Ключ, \"Должность\", \"\"); \n\t\t\t\tПодвалМЗК.Параметры[\"ДолжностьПодписанта\" + НомерДолжности] = СтрокаТЧ.Значение;\n\t\t\t КонецЕсли;     \n\t\t\t \n\t\t КонецЦикла;\t\n\t\t \n\t\t ТабДок.Вывести(ПодвалМЗК);\n\t\t \n\t Иначе\n\t\t \n\t\t Если ВыборкаШапкаДокументов.ИННОрганизации = \"00000000000\" Тогда\n\t\t\t ПодвалПроминком.Параметры.Ответственный = ВыборкаШапкаДокументов.Ответственный;\n\t\t\t ТабДок.Вывести(ПодвалПроминком);\n\t\t Иначе\t \n\t\t\t ПодвалТаблицы.Параметры.Ответственный = ВыборкаШапкаДокументов.Ответственный;   \n\t\t\t ТабДок.Вывести(ПодвалТаблицы);\n\t\t КонецЕсли;  \n\t\t \n\t КонецЕсли;\t \n\t\t\t \t\t \t\n\tТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;\t\n\tТабДок.АвтоМасштаб = Истина;\n\t\n\tУправлениеПечатью.ЗадатьОбластьПечатиДокумента( // +++ ДополнительныйФункционалСохранения\n\t\t\t\t\t\t\t\t\t\t\tТабДок,\n\t\t\t\t\t\t\t\t\t\t\tНомерСтрокиНачало,\n\t\t\t\t\t\t\t\t\t\t\tОбъектыПечати,\n\t\t\t\t\t\t\t\t\t\t\tТекущаяСсылка); \n\t\nКонецЦикла;\n\t\t\nВозврат ТабДок;"
  },
  {
    "title": "Функция сортировки массива или списка значений (ссылок одного типа) по реквизитам соответствующих объектов",
    "description": "Функция сортировки массива или списка значений (ссылок одного типа) по реквизитам соответствующих объектов",
    "code_snippet": "// СортироватьСсылкиПоРеквизитам  —  сортирует массив или список значений (ссылок одного типа) по реквизитам соответствующих объектов\r\n// \r\n// Параметры: \r\n// КоллекцияСсылок — Массив, СписокЗначений — сортируемая коллекция однотипных ссылок\r\n// РеквизитыСортировки — Строка — Список имен реквизитов, разделенных запятыми, по которым производится сортировка коллекции. \r\n//\t\t\t\t\t\t\t\t  После каждого имени колонки через пробел может быть указано направление сортировки. \r\n//\t\t\t\t\t\t\t\t  Направление определяется: \"Убыв\" (\"Desc\") - упорядочивать по убыванию; \"Возр\" (\"Asc\") - упорядочивать по возрастанию. \r\n//\t\t\t\t\t\t\t\t  По умолчанию сортировка производится по возрастанию. Порядок указания имен реквизитов определяет порядок сортировки. \r\n//\t\t\t\t\t\t\t\t  При пустом значении производится автоупорядочивание ссылок.\r\n// Возвращаемое значение: \r\n//      — Массив — \r\n//      — СписокЗначений — \r\n// Пример:\r\n//     СЗ = СортироватьСсылкиПоРеквизитам(СЗ, \"Код УБЫВ\");\r\nФункция СортироватьСсылкиПоРеквизитам(Знач КоллекцияСсылок, Знач РеквизитыСортировки = Неопределено) Экспорт\r\n\tОбщегоНазначенияКлиентСервер.ПроверитьПараметр(\r\n\t\t\t\"ОбщегоНазначения.СортироватьСсылкиПоРеквизитам\"\r\n\t\t\t, \"КоллекцияСсылок\"\r\n\t\t\t, КоллекцияСсылок\r\n\t\t\t, Новый ОписаниеТипов(\"Массив, СписокЗначений\"));\r\n\t\t\t\r\n\tЕсли Не ЗначениеЗаполнено(КоллекцияСсылок) Тогда\r\n\t\tЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"Массив\") Тогда\r\n\t\t\tВозврат Новый Массив;\r\n\t\tИначеЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"СписокЗначений\") Тогда\t\r\n\t\t\tВозврат Новый СписокЗначений(); \r\n\t\tКонецЕсли;\r\n\tКонецЕсли;           \r\n\r\n\tЕсли НЕ ЗначениеЗаполнено(РеквизитыСортировки) Тогда\r\n\t\tРеквизитыСортировки = \"Ссылка\";\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"Массив\") Тогда\r\n\t\tМассивСсылок = КоллекцияСсылок; \r\n\tИначеЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"СписокЗначений\") Тогда\t\r\n\t\tМассивСсылок = КоллекцияСсылок.ВыгрузитьЗначения(); \r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст =\r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tСсылка КАК Ссылка \r\n\t\t|ИЗ\r\n\t\t|\t\" + МассивСсылок[0].Метаданные().ПолноеИмя() + \" КАК Таблица\r\n\t\t|ГДЕ\r\n\t\t|\tТаблица.Ссылка В (&МассивСсылок)\r\n\t    |УПОРЯДОЧИТЬ ПО\r\n\t    |\t\" + РеквизитыСортировки + \"\r\n\t    |АВТОУПОРЯДОЧИВАНИЕ\";\r\n\r\n\tЗапрос.УстановитьПараметр(\"МассивСсылок\", МассивСсылок);\t\r\n\tОтсортированныеСсылки = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку(0);\r\n\tЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"Массив\") Тогда\r\n\t\tВозврат ОтсортированныеСсылки;\r\n\tИначеЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"СписокЗначений\") Тогда\t  \r\n\t\tСЗ = Новый СписокЗначений();\r\n\t\tДля каждого Ссылка Из ОтсортированныеСсылки Цикл\r\n\t\t\tДля каждого элСписка Из КоллекцияСсылок Цикл\r\n\t\t\t\tЕсли элСписка.Значение = Ссылка Тогда\r\n\t\t\t\t\tСЗ.Добавить(элСписка.Значение, элСписка.Представление, элСписка.Пометка, элСписка.Картинка);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЦикла;\r\n\t\tВозврат СЗ; \r\n\tКонецЕсли;\r\nКонецФункции\n\n// СортироватьСсылкиПоРеквизитам  —  сортирует массив или список значений (ссылок одного типа) по реквизитам соответствующих объектов\r\n// \r\n// Параметры: \r\n// КоллекцияСсылок — Массив, СписокЗначений — сортируемая коллекция однотипных ссылок\r\n// РеквизитыСортировки — Строка — Список имен реквизитов, разделенных запятыми, по которым производится сортировка коллекции. \r\n//\t\t\t\t\t\t\t\t  После каждого имени колонки через пробел может быть указано направление сортировки. \r\n//\t\t\t\t\t\t\t\t  Направление определяется: \"Убыв\" (\"Desc\") - упорядочивать по убыванию; \"Возр\" (\"Asc\") - упорядочивать по возрастанию. \r\n//\t\t\t\t\t\t\t\t  По умолчанию сортировка производится по возрастанию. Порядок указания имен реквизитов определяет порядок сортировки. \r\n//\t\t\t\t\t\t\t\t  При пустом значении производится автоупорядочивание ссылок.\r\n// Возвращаемое значение: \r\n//      — Массив — \r\n//      — СписокЗначений — \r\n// Пример:\r\n//     СЗ = СортироватьСсылкиПоРеквизитам(СЗ, \"Код УБЫВ\");\r\nФункция СортироватьСсылкиПоРеквизитам(Знач КоллекцияСсылок, Знач РеквизитыСортировки = Неопределено) Экспорт\r\n\tОбщегоНазначенияКлиентСервер.ПроверитьПараметр(\r\n\t\t\t\"ОбщегоНазначения.СортироватьСсылкиПоРеквизитам\"\r\n\t\t\t, \"КоллекцияСсылок\"\r\n\t\t\t, КоллекцияСсылок\r\n\t\t\t, Новый ОписаниеТипов(\"Массив, СписокЗначений\"));\r\n\t\t\t\r\n\tЕсли Не ЗначениеЗаполнено(КоллекцияСсылок) Тогда\r\n\t\tЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"Массив\") Тогда\r\n\t\t\tВозврат Новый Массив;\r\n\t\tИначеЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"СписокЗначений\") Тогда\t\r\n\t\t\tВозврат Новый СписокЗначений(); \r\n\t\tКонецЕсли;\r\n\tКонецЕсли;           \r\n\r\n\tЕсли НЕ ЗначениеЗаполнено(РеквизитыСортировки) Тогда\r\n\t\tРеквизитыСортировки = \"Ссылка\";\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"Массив\") Тогда\r\n\t\tМассивСсылок = КоллекцияСсылок; \r\n\tИначеЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"СписокЗначений\") Тогда\t\r\n\t\tМассивСсылок = КоллекцияСсылок.ВыгрузитьЗначения(); \r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст =\r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tСсылка КАК Ссылка \r\n\t\t|ИЗ\r\n\t\t|\t\" + МассивСсылок[0].Метаданные().ПолноеИмя() + \" КАК Таблица\r\n\t\t|ГДЕ\r\n\t\t|\tТаблица.Ссылка В (&МассивСсылок)\r\n\t    |УПОРЯДОЧИТЬ ПО\r\n\t    |\t\" + РеквизитыСортировки + \"\r\n\t    |АВТОУПОРЯДОЧИВАНИЕ\";\r\n\r\n\tЗапрос.УстановитьПараметр(\"МассивСсылок\", МассивСсылок);\t\r\n\tОтсортированныеСсылки = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку(0);\r\n\tЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"Массив\") Тогда\r\n\t\tВозврат ОтсортированныеСсылки;\r\n\tИначеЕсли ТипЗнч(КоллекцияСсылок) = Тип(\"СписокЗначений\") Тогда\t  \r\n\t\tСЗ = Новый СписокЗначений();\r\n\t\tДля каждого Ссылка Из ОтсортированныеСсылки Цикл\r\n\t\t\tДля каждого элСписка Из КоллекцияСсылок Цикл\r\n\t\t\t\tЕсли элСписка.Значение = Ссылка Тогда\r\n\t\t\t\t\tСЗ.Добавить(элСписка.Значение, элСписка.Представление, элСписка.Пометка, элСписка.Картинка);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЦикла;\r\n\t\tВозврат СЗ; \r\n\tКонецЕсли;\r\nКонецФункции\n\n{15} Высокая цикломатическая сложность: 20\r\n{15} Не все части функции возвращают значение\r\nОрфографическая ошибка в однотипных: однотипных\r\nОрфографическая ошибка в автоупорядочивание: автоупорядочивание"
  },
  {
    "title": "Определение в текущей транзакции значения РежимУправленияБлокировкойДанных",
    "description": "Определение в текущей транзакции значения РежимУправленияБлокировкойДанных",
    "code_snippet": "Функция ОпределитьРежимУправленияБлокировкойДанных() Экспорт\r\n    Если НЕ ТранзакцияАктивна() Тогда\r\n        Возврат Неопределено;\r\n    КонецЕсли;  \r\n\t\r\n    Попытка\r\n        НачатьТранзакцию(РежимУправленияБлокировкойДанных.Автоматический);\r\n        ЗафиксироватьТранзакцию();\r\n    Исключение\r\n        Возврат РежимУправленияБлокировкойДанных.Управляемый;\r\n    КонецПопытки; \r\n    Возврат РежимУправленияБлокировкойДанных.Автоматический;\t\r\nКонецФункции\n\nФункция ОпределитьРежимУправленияБлокировкойДанных() Экспорт\r\n    Если НЕ ТранзакцияАктивна() Тогда\r\n        Возврат Неопределено;\r\n    КонецЕсли;  \r\n\t\r\n    Попытка\r\n        НачатьТранзакцию(РежимУправленияБлокировкойДанных.Автоматический);\r\n        ЗафиксироватьТранзакцию();\r\n    Исключение\r\n        Возврат РежимУправленияБлокировкойДанных.Управляемый;\r\n    КонецПопытки; \r\n    Возврат РежимУправленияБлокировкойДанных.Автоматический;\t\r\nКонецФункции"
  },
  {
    "title": "Реализация функции Пауза() из 1С ERP",
    "description": "Реализация функции Пауза() из 1С ERP",
    "code_snippet": "//Процедуру следует разместить в модуле КакойтоСерверныйОбщийМодуль :)\r\n\r\n// Делает паузу выполнения кода\r\n// \r\n// Параметры:\r\n// \tКоличествоСекунд - Число - длительность паузы\r\n\r\nПроцедура Пауза(КоличествоСекунд) Экспорт\r\n\tЕсли ТипЗнч(КоличествоСекунд) <> Тип(\"Число\") ИЛИ КоличествоСекунд < 1 ИЛИ КоличествоСекунд > 180 Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\r\n\tФоновоеЗадание = ПолучитьТекущийСеансИнформационнойБазы().ПолучитьФоновоеЗадание();\r\n\tЕсли ФоновоеЗадание = Неопределено Тогда\r\n\t\tПараметры = Новый Массив;\r\n\t\tПараметры.Добавить(КоличествоСекунд);\r\n\t\tИмяМетода = \"КакойтоСерверныйОбщийМодуль.Пауза\";\r\n\t\tФоновоеЗадание = РасширенияКонфигурации.ВыполнитьФоновоеЗаданиеБезРасширений(ИмяМетода, Параметры);\r\n\t\tФоновоеЗадание.ОжидатьЗавершенияВыполнения(КоличествоСекунд);\r\n\tИначе\r\n\t\tФоновоеЗадание.ОжидатьЗавершенияВыполнения(КоличествоСекунд)\r\n\tКонецЕсли;\r\nКонецПроцедуры\n\n//Процедуру следует разместить в модуле КакойтоСерверныйОбщийМодуль :)\r\n\r\n// Делает паузу выполнения кода\r\n// \r\n// Параметры:\r\n// \tКоличествоСекунд - Число - длительность паузы\r\n\r\nПроцедура Пауза(КоличествоСекунд) Экспорт\r\n\tЕсли ТипЗнч(КоличествоСекунд) <> Тип(\"Число\") ИЛИ КоличествоСекунд < 1 ИЛИ КоличествоСекунд > 180 Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\r\n\tФоновоеЗадание = ПолучитьТекущийСеансИнформационнойБазы().ПолучитьФоновоеЗадание();\r\n\tЕсли ФоновоеЗадание = Неопределено Тогда\r\n\t\tПараметры = Новый Массив;\r\n\t\tПараметры.Добавить(КоличествоСекунд);\r\n\t\tИмяМетода = \"КакойтоСерверныйОбщийМодуль.Пауза\";\r\n\t\tФоновоеЗадание = РасширенияКонфигурации.ВыполнитьФоновоеЗаданиеБезРасширений(ИмяМетода, Параметры);\r\n\t\tФоновоеЗадание.ОжидатьЗавершенияВыполнения(КоличествоСекунд);\r\n\tИначе\r\n\t\tФоновоеЗадание.ОжидатьЗавершенияВыполнения(КоличествоСекунд)\r\n\tКонецЕсли;\r\nКонецПроцедуры\n\nОрфографическая ошибка в КакойтоСерверныйОбщийМодуль (найдено 2): Какойто"
  },
  {
    "title": "Полное(стек) и краткое представление ошибок в журнале регистрации",
    "description": "Полное(стек) и краткое представление ошибок в журнале регистрации",
    "code_snippet": "Попытка\r\n\t\t\tВесоГабариты = Новый Структура(\"Вес\", СтроковыеФункцииКлиентСервер.СтрокаВЧисло(ПараметрыНоменклатуры.получить(\"Weight\")));\r\n\t\tИсключение\t\t\r\n\t\t\tОписание = ОписаниеОшибки();\r\n\t\t\t// {ВнешняяОбработка.ОписаниеОшибки.Форма.Форма.Форма(6)}: Недостаточно фактических параметров\r\n\t\t\t\r\n\t\t\tИнформация = ИнформацияОбОшибке();\r\n\t\t\t// Информация.ИмяМодуля = \"ВнешняяОбработка.ОписаниеОшибки.Форма.Форма.Форма\"\r\n\t\t\t// Информация.ИсходнаяСтрока = \"\t\tА = ОбщегоНазначения.ЗначениеРеквизитаОбъекта();\"\r\n\t\t\t// Информация.НомерСтроки = 30\r\n\t\t\t// Информация.Описание = \"Недостаточно фактических параметров\"\r\n\t\t\t// Информация.Причина = Неопределено\r\n\t\t\t\r\n\t\t\t//КраткоеПредставлениеОшибки(Информация);\r\n\t\t\t// Недостаточно фактических параметров\r\n\t\t\t\r\n\t\t\tПодробности = ПодробноеПредставлениеОшибки(Информация);\r\n\t\t\t// Недостаточно фактических параметров\r\n\t\t\t// {ВнешняяОбработка.ОписаниеОшибки.Форма.Форма.Форма(6)}:\t\tА = ОбщегоНазначения.ЗначениеРеквизитаОбъекта();\r\n\t\t\t\r\n\t\t\t//ВызватьИсключение \"Не удалось получить значение реквизита по причине: \" + Описание;\t\t\t\r\n\t\t\t//ОбщегоНазначения.СообщитьПользователю(\"-\" + ПараметрыНоменклатуры.получить(\"ExternalItemId\") + \": \" + ОписаниеОшибки());\r\n\t\t\tЗаписьЖурналаРегистрации(\"Axapta.Обновление номенклатуры\", УровеньЖурналаРегистрации.Ошибка, Номенклатура.Метаданные(), Номенклатура,\r\n\t\t\t\t\"Не удалось получить сведения по номенклатуре: \" + Подробности);\r\n            Возврат Номенклатура\r\n\t\tКонецПопытки;\n\nПопытка\r\n\t\t\tВесоГабариты = Новый Структура(\"Вес\", СтроковыеФункцииКлиентСервер.СтрокаВЧисло(ПараметрыНоменклатуры.получить(\"Weight\")));\r\n\t\tИсключение\t\t\r\n\t\t\tОписание = ОписаниеОшибки();\r\n\t\t\t// {ВнешняяОбработка.ОписаниеОшибки.Форма.Форма.Форма(6)}: Недостаточно фактических параметров\r\n\t\t\t\r\n\t\t\tИнформация = ИнформацияОбОшибке();\r\n\t\t\t// Информация.ИмяМодуля = \"ВнешняяОбработка.ОписаниеОшибки.Форма.Форма.Форма\"\r\n\t\t\t// Информация.ИсходнаяСтрока = \"\t\tА = ОбщегоНазначения.ЗначениеРеквизитаОбъекта();\"\r\n\t\t\t// Информация.НомерСтроки = 30\r\n\t\t\t// Информация.Описание = \"Недостаточно фактических параметров\"\r\n\t\t\t// Информация.Причина = Неопределено\r\n\t\t\t\r\n\t\t\t//КраткоеПредставлениеОшибки(Информация);\r\n\t\t\t// Недостаточно фактических параметров\r\n\t\t\t\r\n\t\t\tПодробности = ПодробноеПредставлениеОшибки(Информация);\r\n\t\t\t// Недостаточно фактических параметров\r\n\t\t\t// {ВнешняяОбработка.ОписаниеОшибки.Форма.Форма.Форма(6)}:\t\tА = ОбщегоНазначения.ЗначениеРеквизитаОбъекта();\r\n\t\t\t\r\n\t\t\t//ВызватьИсключение \"Не удалось получить значение реквизита по причине: \" + Описание;\t\t\t\r\n\t\t\t//ОбщегоНазначения.СообщитьПользователю(\"-\" + ПараметрыНоменклатуры.получить(\"ExternalItemId\") + \": \" + ОписаниеОшибки());\r\n\t\t\tЗаписьЖурналаРегистрации(\"Axapta.Обновление номенклатуры\", УровеньЖурналаРегистрации.Ошибка, Номенклатура.Метаданные(), Номенклатура,\r\n\t\t\t\t\"Не удалось получить сведения по номенклатуре: \" + Подробности);\r\n            Возврат Номенклатура\r\n\t\tКонецПопытки;\n\n{2} Переменной ВесоГабариты присвоено значение, но оно нигде не используется\r\n{4} Переменной Описание присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в Axapta: Axapta"
  },
  {
    "title": "MenuHotkeys",
    "description": "Назначает горячие клавиши элементам меню.",
    "code_snippet": ""
  },
  {
    "title": "Преобразовать UNICODE ответ с Сайта",
    "description": "Преобразовать UNICODE ответ с Сайта",
    "code_snippet": "//Отдельные сайты шлют ответы в перемешку UTF-16 и UTF-8 \r\n//Например \t\t\"%u041F%20%3A TEST\"\r\n//Надо сделать \t\"%u041F%u0020%u003A TEST\"\r\nФункция ПреобразоватьUnicode(Unicode) Экспорт\r\n\t\r\n\tСтрUnicode = \"\";\r\n\t\r\n\tМассивПодстрок = СтрРазделить(Unicode,\"%\",Ложь);\r\n\tДля Каждого Подстрока Из МассивПодстрок Цикл\r\n\t\tЕсли Сред(Подстрока,1,1) = \"u\" Тогда \t\t//Это UTF-16\r\n\t\t\tСтрUnicode = СтрUnicode + \"%\" + Подстрока;\r\n\t\t\tПродолжить;\r\n\t\tИначе\t\t\t\t\t\t\t\t\t\t//Это UTF-8\r\n\t\t\tПервыеДваСимвола = Сред(Подстрока,1,2);\r\n\t\t\tПоследниеСимволы = Сред(Подстрока,3);\r\n\t\t\tПодстрока = \"u00\" + ПервыеДваСимвола + ПоследниеСимволы;\r\n\t\t\tСтрUnicode = СтрUnicode + \"%\" + Подстрока;\r\n\t\tКонецЕСли;\r\n\tКонецЦикла;\r\n\t\r\n\tСтрUnicode  = СтрЗаменить(СтрUnicode,\"%\",\"\\\");\t\t//Подготовим для JSON\r\n\t\t\r\n\tЧтениеJSON = Новый ЧтениеJSON;\t\t\r\n\t\r\n\tСтр = \"{\"\"Текст\"\":\"\"\"+СтрUnicode + \"\"\"}\";\r\n\t\r\n\tЧтениеJSON.УстановитьСтроку(Стр);\r\n\t\r\n    Соответствие    =  ПрочитатьJSON(ЧтениеJSON, Истина);\r\n    Результат    = Соответствие.Получить(\"Текст\");\r\n\t\r\n\tВозврат Результат;\r\nКонецФункции\n\n//Отдельные сайты шлют ответы в перемешку UTF-16 и UTF-8 \r\n//Например \t\t\"%u041F%20%3A TEST\"\r\n//Надо сделать \t\"%u041F%u0020%u003A TEST\"\r\nФункция ПреобразоватьUnicode(Unicode) Экспорт\r\n\t\r\n\tСтрUnicode = \"\";\r\n\t\r\n\tМассивПодстрок = СтрРазделить(Unicode,\"%\",Ложь);\r\n\tДля Каждого Подстрока Из МассивПодстрок Цикл\r\n\t\tЕсли Сред(Подстрока,1,1) = \"u\" Тогда \t\t//Это UTF-16\r\n\t\t\tСтрUnicode = СтрUnicode + \"%\" + Подстрока;\r\n\t\t\tПродолжить;\r\n\t\tИначе\t\t\t\t\t\t\t\t\t\t//Это UTF-8\r\n\t\t\tПервыеДваСимвола = Сред(Подстрока,1,2);\r\n\t\t\tПоследниеСимволы = Сред(Подстрока,3);\r\n\t\t\tПодстрока = \"u00\" + ПервыеДваСимвола + ПоследниеСимволы;\r\n\t\t\tСтрUnicode = СтрUnicode + \"%\" + Подстрока;\r\n\t\tКонецЕСли;\r\n\tКонецЦикла;\r\n\t\r\n\tСтрUnicode  = СтрЗаменить(СтрUnicode,\"%\",\"\\\");\t\t//Подготовим для JSON\r\n\t\t\r\n\tЧтениеJSON = Новый ЧтениеJSON;\t\t\r\n\t\r\n\tСтр = \"{\"\"Текст\"\":\"\"\"+СтрUnicode + \"\"\"}\";\r\n\t\r\n\tЧтениеJSON.УстановитьСтроку(Стр);\r\n\t\r\n    Соответствие    =  ПрочитатьJSON(ЧтениеJSON, Истина);\r\n    Результат    = Соответствие.Получить(\"Текст\");\r\n\t\r\n\tВозврат Результат;\r\nКонецФункции\n\nОрфографическая ошибка в перемешку: перемешку"
  },
  {
    "title": "Получение данных из запроса динамического списка",
    "description": "Получение данных из запроса динамического списка",
    "code_snippet": "СписокСхема \t\t= Элементы.СписокДокументов.ПолучитьИсполняемуюСхемуКомпоновкиДанных();\r\n\t\tНастройки\t\t\t= Элементы.СписокДокументов.ПолучитьИсполняемыеНастройкиКомпоновкиДанных();\r\n\t\t\r\n\t\tКомпоновщикМакета \t= Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\t\tМакетКомпоновки   \t= КомпоновщикМакета.Выполнить(СписокСхема, Настройки, , \r\n                ,Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\t\t\r\n\t\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\t\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки);\r\n\t\t\r\n\t\tПроцессорВывода \t= Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\t\t\r\n\t\tПолученныеДанные\t= ПроцессорВывода.Вывести(ПроцессорКомпоновки);  // Таблица значений.\n\nСписокСхема \t\t= Элементы.СписокДокументов.ПолучитьИсполняемуюСхемуКомпоновкиДанных();\r\n\t\tНастройки\t\t\t= Элементы.СписокДокументов.ПолучитьИсполняемыеНастройкиКомпоновкиДанных();\r\n\t\t\r\n\t\tКомпоновщикМакета \t= Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\t\tМакетКомпоновки   \t= КомпоновщикМакета.Выполнить(СписокСхема, Настройки, , \r\n                ,Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\t\t\r\n\t\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\t\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки);\r\n\t\t\r\n\t\tПроцессорВывода \t= Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\t\t\r\n\t\tПолученныеДанные\t= ПроцессорВывода.Вывести(ПроцессорКомпоновки);  // Таблица значений.\n\n{13} Переменной ПолученныеДанные присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Пауза() при выполнении кода 1С",
    "description": "Пауза() при выполнении кода 1С",
    "code_snippet": "// Пауза от 1 до 999 сек\r\n// Без показа дополнительных окон\r\nПроцедура Пауза(Секунд) Экспорт\r\n\t\r\n\tWshShell = Новый COMОбъект(\"WScript.Shell\");\r\n\t\r\n\tСтрокаКоманды = \"timeout /t \"+Секунд+\" /nobreak\";\r\n\tСтрокаКоманды = \"cmd /c \"+СтрокаКоманды;\t\t\t\t\t// Закрываем окно после завершения (ключ /с)\r\n\t\r\n\tОжидатьЗавершения = Истина;\r\n\tWshShell.Run(СтрокаКоманды, 0,ОжидатьЗавершения);\t\t\t// 0 - не показывать окно командного интерпритатора\r\n\r\nКонецПроцедуры\n\n// Пауза от 1 до 999 сек\r\n// Без показа дополнительных окон\r\nПроцедура Пауза(Секунд) Экспорт\r\n\t\r\n\tWshShell = Новый COMОбъект(\"WScript.Shell\");\r\n\t\r\n\tСтрокаКоманды = \"timeout /t \"+Секунд+\" /nobreak\";\r\n\tСтрокаКоманды = \"cmd /c \"+СтрокаКоманды;\t\t\t\t\t// Закрываем окно после завершения (ключ /с)\r\n\t\r\n\tОжидатьЗавершения = Истина;\r\n\tWshShell.Run(СтрокаКоманды, 0,ОжидатьЗавершения);\t\t\t// 0 - не показывать окно командного интерпритатора\r\n\r\nКонецПроцедуры\n\nОрфографическая ошибка в nobreak: nobreak\r\nОрфографическая ошибка в интерпритатора: интерпритатора\n\nКонДата = ТекущаяДата() + КолВоСекунд;\nПока ТекущаяДата() < КонДата Цикл\n\t// пауза ...\nКонецЦикла;"
  },
  {
    "title": "Процедура КомандаСистемы() без отображения окна командного интерпритатора",
    "description": "Процедура КомандаСистемы() без отображения окна командного интерпритатора",
    "code_snippet": "Процедура КомандаСистемыWshShell(Команда, ИмяКаталога = \"\", ЗакрыватьОкно = Истина, ПоказыватьОкно = Ложь, ОжидатьЗавершения = Истина)\t\r\n\t//В командной строке можно выполнить несколько команд\r\n\t//В этом случае команды отделяются \" && \"\r\n\t\r\n\tОтладка = Ложь;\r\n\tЕсли Отладка = Истина Тогда\r\n\t\tЗакрыватьОкно = Ложь; \r\n\t\tПоказыватьОкно = Истина;\r\n\tКонецЕСли;\r\n\t\r\n\tWshShell = Новый COMОбъект(\"WScript.Shell\");\r\n\r\n\tСтрокаКоманды = Команда;\r\n\tЕсли ЗначениеЗаполнено(ИмяКаталога) Тогда\r\n\t\tМассивПодстрок = СтрРазделить(ИмяКаталога, \":\\\",Ложь);\r\n\t\tЕсли МассивПодстрок.Количество() = 2 Тогда\r\n\t\t\tИмяДиска = МассивПодстрок.Получить(0)+\":\";\r\n\t\t\tКомандаСменитьКаталог = \" \"+ИмяДиска + \" && \" + \" cd \" + ИмяКаталога;\r\n\t\t\t\r\n\t\t\tСтрокаКоманды = КомандаСменитьКаталог + \" && \" + СтрокаКоманды;\r\n\t\tКонецЕСли;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗакрыватьОкно = Истина Тогда\r\n\t\tСтрокаКоманды = \"cmd /c \"+СтрокаКоманды;\r\n\tИначе\r\n\t\tСтрокаКоманды = \"cmd /k \"+СтрокаКоманды;\r\n\tКонецЕСли;\r\n\t\r\n\t//Запустить командный Интерпритатор, установить каталог по умолчанию, запустить программу, закрыть Окно интерпритатора (ключ /с)\r\n\t//     cmd /c c: && cd c:\\OpenSSL && OpenSSL.exe\r\n\t//\r\n\t//Запустить командный Интерпритатор, использовать каталог по умолчанию, запустить программу, НЕ закрывать Окно интерпритатора (ключ /k)\r\n\t//     cmd /k OpenSSL.exe\r\n\t//\r\n\t\r\n\tЕсли ПоказыватьОкно = Истина Тогда\r\n\t\tWshShell.Run(СтрокаКоманды, 1,ОжидатьЗавершения);\r\n\tИначе\r\n\t\tWshShell.Run(СтрокаКоманды, 0,ОжидатьЗавершения);\r\n\tКонецЕСли;\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ПодписатьOpenSSL()\r\n\t\r\n\tИмяКаталога \t\t\t= \"c:\\OpenSSL\";\r\n\tИмяФайлаДляПодписания \t= \"Тест.txt\";\r\n\tИмяФайлаПодписано \t\t= \"Sign.txt\";\r\n\tИмяФайлаПриватногоКлюча = \"Server.key\";\r\n\r\n\tСтрокаКоманды = \"openssl.exe dgst -sha256 -sign \"+ИмяФайлаПриватногоКлюча+\" -out \"+ИмяФайлаПодписано+\" \" + ИмяФайлаДляПодписания;\t\r\n\t\r\n\tЗакрыватьОкно = Истина;\r\n\tПоказыватьОкно = Ложь;\r\n\tОжидатьЗавершениеКоманды = Истина;\r\n\t\r\n\tКомандаСистемыWshShell(СтрокаКоманды,ИмяКаталога, ЗакрыватьОкно, ПоказыватьОкно, ОжидатьЗавершениеКоманды);\r\n\t\r\nКонецПроцедуры\n\nПроцедура КомандаСистемыWshShell(Команда, ИмяКаталога = \"\", ЗакрыватьОкно = Истина, ПоказыватьОкно = Ложь, ОжидатьЗавершения = Истина)\t\r\n\t//В командной строке можно выполнить несколько команд\r\n\t//В этом случае команды отделяются \" && \"\r\n\t\r\n\tОтладка = Ложь;\r\n\tЕсли Отладка = Истина Тогда\r\n\t\tЗакрыватьОкно = Ложь; \r\n\t\tПоказыватьОкно = Истина;\r\n\tКонецЕСли;\r\n\t\r\n\tWshShell = Новый COMОбъект(\"WScript.Shell\");\r\n\r\n\tСтрокаКоманды = Команда;\r\n\tЕсли ЗначениеЗаполнено(ИмяКаталога) Тогда\r\n\t\tМассивПодстрок = СтрРазделить(ИмяКаталога, \":\\\",Ложь);\r\n\t\tЕсли МассивПодстрок.Количество() = 2 Тогда\r\n\t\t\tИмяДиска = МассивПодстрок.Получить(0)+\":\";\r\n\t\t\tКомандаСменитьКаталог = \" \"+ИмяДиска + \" && \" + \" cd \" + ИмяКаталога;\r\n\t\t\t\r\n\t\t\tСтрокаКоманды = КомандаСменитьКаталог + \" && \" + СтрокаКоманды;\r\n\t\tКонецЕСли;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗакрыватьОкно = Истина Тогда\r\n\t\tСтрокаКоманды = \"cmd /c \"+СтрокаКоманды;\r\n\tИначе\r\n\t\tСтрокаКоманды = \"cmd /k \"+СтрокаКоманды;\r\n\tКонецЕСли;\r\n\t\r\n\t//Запустить командный Интерпритатор, установить каталог по умолчанию, запустить программу, закрыть Окно интерпритатора (ключ /с)\r\n\t//     cmd /c c: && cd c:\\OpenSSL && OpenSSL.exe\r\n\t//\r\n\t//Запустить командный Интерпритатор, использовать каталог по умолчанию, запустить программу, НЕ закрывать Окно интерпритатора (ключ /k)\r\n\t//     cmd /k OpenSSL.exe\r\n\t//\r\n\t\r\n\tЕсли ПоказыватьОкно = Истина Тогда\r\n\t\tWshShell.Run(СтрокаКоманды, 1,ОжидатьЗавершения);\r\n\tИначе\r\n\t\tWshShell.Run(СтрокаКоманды, 0,ОжидатьЗавершения);\r\n\tКонецЕСли;\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ПодписатьOpenSSL()\r\n\t\r\n\tИмяКаталога \t\t\t= \"c:\\OpenSSL\";\r\n\tИмяФайлаДляПодписания \t= \"Тест.txt\";\r\n\tИмяФайлаПодписано \t\t= \"Sign.txt\";\r\n\tИмяФайлаПриватногоКлюча = \"Server.key\";\r\n\r\n\tСтрокаКоманды = \"openssl.exe dgst -sha256 -sign \"+ИмяФайлаПриватногоКлюча+\" -out \"+ИмяФайлаПодписано+\" \" + ИмяФайлаДляПодписания;\t\r\n\t\r\n\tЗакрыватьОкно = Истина;\r\n\tПоказыватьОкно = Ложь;\r\n\tОжидатьЗавершениеКоманды = Истина;\r\n\t\r\n\tКомандаСистемыWshShell(СтрокаКоманды,ИмяКаталога, ЗакрыватьОкно, ПоказыватьОкно, ОжидатьЗавершениеКоманды);\r\n\t\r\nКонецПроцедуры\n\n{6} Условие всегда Ложь\r\nОрфографическая ошибка в интерпритатора (найдено 4): интерпритатора\r\nОрфографическая ошибка в Интерпритатор (найдено 2): Интерпритатор\r\nОрфографическая ошибка в openssl: openssl\r\nОрфографическая ошибка в dgst: dgst"
  },
  {
    "title": "Формирование Паузы при выполнении кода",
    "description": "Формирование Паузы при выполнении кода",
    "code_snippet": "Процедура Пауза(Секунд)\r\n\t\r\n\tСоединениеHTTP = Новый HTTPСоединение(\"127.0.0.0\",,,,, Секунд);\r\n\t\r\n\tПопытка\r\n    \tСоединениеHTTP.Получить(Новый HTTPЗапрос)\r\n   \tИсключение\r\n\tКонецПопытки\r\n\t\r\nКонецПроцедуры\n\nПроцедура Пауза(Секунд)\r\n\t\r\n\tСоединениеHTTP = Новый HTTPСоединение(\"127.0.0.0\",,,,, Секунд);\r\n\t\r\n\tПопытка\r\n    \tСоединениеHTTP.Получить(Новый HTTPЗапрос)\r\n   \tИсключение\r\n\tКонецПопытки\r\n\t\r\nКонецПроцедуры\n\nПопытка\n        СоединениеHTTP = Новый HTTPСоединение(\"127.0.0.0\",,,,НастройкиProxy,МиллиСекунды);\n        СоединениеHTTP.Получить(Новый HTTPЗапрос());\n    Исключение\n        Возврат Неопределено;\n    КонецПопытки;"
  },
  {
    "title": "Установка отбора Списка по СпискуЗначений",
    "description": "Установка отбора Списка по СпискуЗначений",
    "code_snippet": "//ВНИМАНИЕ\r\n// Для корректной установки отбора по списку Значений\r\n// Важно соблюдать последовательность операций\r\n//      ЭлементОтбора.ВидСравнения = ВидСравнения.ВСписке;\r\n//\t\tЭлементОтбора.Значение = СписокЗначений;\r\n//В противном случае будет будет получена ошибка при выполнении операции\r\n//\t\tЭлементОтбора.Значение = СписокЗначений;\r\n//\r\nПроцедура УстановитьОтборСпискаПоСпискуЗначений(СписокЗначений,ИмяРеквизита)\r\n\t\r\n\tОтборСписка = РегистрСведенийСписок.Отбор;\r\n\t\r\n\tЭлементОтбора = ОтборСписка.Найти(\"ИмяРеквизита\");\r\n\tЕсли НЕ ЭлементОтбора = Неопределено Тогда\r\n\t\tЭлементОтбора.ВидСравнения = ВидСравнения.ВСписке;\r\n\t\tЭлементОтбора.Значение = СписокЗначений;\r\n\t\tЭлементОтбора.Использование = Истина\r\n\tКонецЕсли;\t\t\t\t\r\nКонецПроцедуры\n\n//ВНИМАНИЕ\r\n// Для корректной установки отбора по списку Значений\r\n// Важно соблюдать последовательность операций\r\n//      ЭлементОтбора.ВидСравнения = ВидСравнения.ВСписке;\r\n//\t\tЭлементОтбора.Значение = СписокЗначений;\r\n//В противном случае будет будет получена ошибка при выполнении операции\r\n//\t\tЭлементОтбора.Значение = СписокЗначений;\r\n//\r\nПроцедура УстановитьОтборСпискаПоСпискуЗначений(СписокЗначений,ИмяРеквизита)\r\n\t\r\n\tОтборСписка = РегистрСведенийСписок.Отбор;\r\n\t\r\n\tЭлементОтбора = ОтборСписка.Найти(\"ИмяРеквизита\");\r\n\tЕсли НЕ ЭлементОтбора = Неопределено Тогда\r\n\t\tЭлементОтбора.ВидСравнения = ВидСравнения.ВСписке;\r\n\t\tЭлементОтбора.Значение = СписокЗначений;\r\n\t\tЭлементОтбора.Использование = Истина\r\n\tКонецЕсли;\t\t\t\t\r\nКонецПроцедуры"
  },
  {
    "title": "МассивИзДереваЗначенийНаСервере",
    "description": "МассивИзДереваЗначенийНаСервере",
    "code_snippet": "&НаСервере\nПроцедура МассивИзДереваЗначенийНаСервере()\n    ВыгрузкаДЗ = РеквизитФормыВЗначение(\"Дерево\");\n    ИмяВременнойКолонки = \"_ВременнаяКолонка_\";\n    ВыгрузкаДЗ.Колонки.Добавить(ИмяВременнойКолонки);\n\n    Отбор = Новый Структура(ИмяВременнойКолонки, Неопределено);\n    МассивИзДереваЗначений = ВыгрузкаДЗ.Строки.НайтиСтроки(Отбор, Истина);\n    \n    ВыгрузкаДЗ.Колонки.Удалить(ИмяВременнойКолонки);\nКонецПроцедуры"
  },
  {
    "title": "TurboTrackerEva",
    "description": "Скрипт для использования трекера Eva (https://www.evateam.ru/) как источника данных для ТурбоТрекера",
    "code_snippet": ""
  },
  {
    "title": "Отладка методов серверных модулей через внешнюю обработку",
    "description": "Отладка методов серверных модулей через внешнюю обработку",
    "code_snippet": "//TODO удалить - начало\nОписаниеЗащиты = Новый ОписаниеЗащитыОтОпасныхДействий;\nОписаниеЗащиты.ПредупреждатьОбОпасныхДействиях = Ложь;\nОбработка = ВнешниеОбработки.Создать(\n\"\\\\какая_то_чаще_всего_сетевая_папка\\ВнешняяОбработка1.epf\", Ложь, ОписаниеЗащиты);\nОбработка.<Метод()>; Возврат;\nВозврат Обработка.<Метод()>;\n<?>\n//TODO удалить - конец"
  },
  {
    "title": "Программное добавление условного оформления документа",
    "description": "Программное добавление условного оформления документа",
    "code_snippet": "// Процедура НастроитьУсловноеОформление предназначена для создания и настройки условного оформления документа. \n// \n//\n&НаСервере\nПроцедура НастроитьУсловноеОформление()\n\t\n  \t// Создание элемента условного оформления\n\tЭлементОформления = УсловноеОформление.Элементы.Добавить();\n\tЭлементОформления.Использование = Истина;\n\tЭлементОформления.Оформление.УстановитьЗначениеПараметра(\"Доступность\", Ложь);\n\t\n    // Создание условия для элемента оформления\n\tЭлементУсловия                = ЭлементОформления.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\n\tЭлементУсловия.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных(\"Объект.Реквизит\");\n\tЭлементУсловия.ПравоеЗначение = Истина; \n\tЭлементУсловия.ВидСравнения   = ВидСравненияКомпоновкиДанных.Равно;\n\tЭлементУсловия.Использование  = Истина;\n\t\n    // Настройка оформляемого поля\n\tОформляемоеПоле      = ЭлементОформления.Поля.Элементы.Добавить();\n\tОформляемоеПоле.Поле = Новый ПолеКомпоновкиДанных(\"ТЧ_Документа\");\n\t\nКонецПроцедуры"
  },
  {
    "title": "Закрытие терминальной сессии",
    "description": "Закрытие терминальной сессии",
    "code_snippet": "ЗапуститьПриложение(\"taskkill /f /im splwow64.exe\");\n\nЗапуститьПриложение(\"taskkill /f /im splwow64.exe\");\n\nОрфографическая ошибка в splwow64 (найдено 2): splwow\r\nОрфографическая ошибка в ПризавершенииРаботыСистемы: Призавершении\r\nОрфографическая ошибка в taskkill: taskkill"
  },
  {
    "title": "ИР Открыть объект метаданных",
    "description": "ИР Открыть объект метаданныхTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "ИР Подписки на события",
    "description": "ИР Подписки на события",
    "code_snippet": ""
  },
  {
    "title": "Создание записи в журнал регистрации",
    "description": "Создание записи в журнал регистрации",
    "code_snippet": "&НаСервере\r\nПроцедура ДобавитьЗаписьВЖурналРегистрации()\r\n\r\n    //Индексы хранятся в каталоге 1Cv8Log в файлах с расширением .lgx\r\n    ЗаписьЖурналаРегистрации(\"Обновление1С\", УровеньЖурналаРегистрации.Информация,,,\r\n    \"Выполнено\", РежимТранзакцииЗаписиЖурналаРегистрации.Транзакционная);\r\n    //ЗаписьЖурналаРегистрации(<ИмяСобытия>, <Уровень>, <ОбъектМетаданных к которому относится событие>, <Данные>, <Комментарий>, <РежимТранзакции>)\r\n    //Обработчик...\r\n\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ДобавитьЗаписьВЖурналРегистрацииЧерезСтруктуру()\r\n\r\n   СписокЗаписейЖурнала = Новый СписокЗначений();\r\n\r\n   ЗаписьЖурналаНачало = Новый Структура(\"ИмяСобытия, ПредставлениеУровня, Комментарий,ДатаСобытия\");\r\n   ЗаписьЖурналаНачало.ИмяСобытия = \"НачалоОбновления1С\";\r\n   ЗаписьЖурналаНачало.ПредставлениеУровня = \"Информация\"; //\"Предупреждение\", \"Ошибка\", \"Предупреждение\", \"Примечание\".\r\n   ЗаписьЖурналаНачало.Комментарий = \"Начато обновление конфигурации до версии 3.7.41\";\r\n   ЗаписьЖурналаНачало.ДатаСобытия = ТекущаяДата();\r\n   СписокЗаписейЖурнала.Добавить(ЗаписьЖурналаНачало);\r\n\r\n   //... здесь по аналогии журналируем поэтапно сам процесс\r\n\r\n   ЗаписьЖурналаКонец = Новый Структура(\"ИмяСобытия, ПредставлениеУровня, Комментарий,ДатаСобытия\");\r\n   ЗаписьЖурналаКонец.ИмяСобытия = \"ОкончаниеОбновления1С\";\r\n   ЗаписьЖурналаКонец.ПредставлениеУровня = \"Информация\"; //\"Предупреждение\", \"Ошибка\", \"Предупреждение\", \"Примечание\".\r\n   ЗаписьЖурналаКонец.Комментарий = \"Завершено обновление конфигурации до версии 3.7.41\";\r\n   ЗаписьЖурналаКонец.ДатаСобытия = ТекущаяДата();\r\n   СписокЗаписейЖурнала.Добавить(ЗаписьЖурналаКонец);\r\n\r\n   ЖурналРегистрации.ЗаписатьСобытияВЖурналРегистрации(СписокЗаписейЖурнала);\r\n\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ДобавитьЗаписьВЖурналРегистрации()\r\n\r\n    //Индексы хранятся в каталоге 1Cv8Log в файлах с расширением .lgx\r\n    ЗаписьЖурналаРегистрации(\"Обновление1С\", УровеньЖурналаРегистрации.Информация,,,\r\n    \"Выполнено\", РежимТранзакцииЗаписиЖурналаРегистрации.Транзакционная);\r\n    //ЗаписьЖурналаРегистрации(<ИмяСобытия>, <Уровень>, <ОбъектМетаданных к которому относится событие>, <Данные>, <Комментарий>, <РежимТранзакции>)\r\n    //Обработчик...\r\n\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ДобавитьЗаписьВЖурналРегистрацииЧерезСтруктуру()\r\n\r\n   СписокЗаписейЖурнала = Новый СписокЗначений();\r\n\r\n   ЗаписьЖурналаНачало = Новый Структура(\"ИмяСобытия, ПредставлениеУровня, Комментарий,ДатаСобытия\");\r\n   ЗаписьЖурналаНачало.ИмяСобытия = \"НачалоОбновления1С\";\r\n   ЗаписьЖурналаНачало.ПредставлениеУровня = \"Информация\"; //\"Предупреждение\", \"Ошибка\", \"Предупреждение\", \"Примечание\".\r\n   ЗаписьЖурналаНачало.Комментарий = \"Начато обновление конфигурации до версии 3.7.41\";\r\n   ЗаписьЖурналаНачало.ДатаСобытия = ТекущаяДата();\r\n   СписокЗаписейЖурнала.Добавить(ЗаписьЖурналаНачало);\r\n\r\n   //... здесь по аналогии журналируем поэтапно сам процесс\r\n\r\n   ЗаписьЖурналаКонец = Новый Структура(\"ИмяСобытия, ПредставлениеУровня, Комментарий,ДатаСобытия\");\r\n   ЗаписьЖурналаКонец.ИмяСобытия = \"ОкончаниеОбновления1С\";\r\n   ЗаписьЖурналаКонец.ПредставлениеУровня = \"Информация\"; //\"Предупреждение\", \"Ошибка\", \"Предупреждение\", \"Примечание\".\r\n   ЗаписьЖурналаКонец.Комментарий = \"Завершено обновление конфигурации до версии 3.7.41\";\r\n   ЗаписьЖурналаКонец.ДатаСобытия = ТекущаяДата();\r\n   СписокЗаписейЖурнала.Добавить(ЗаписьЖурналаКонец);\r\n\r\n   ЖурналРегистрации.ЗаписатьСобытияВЖурналРегистрации(СписокЗаписейЖурнала);\r\n\r\nКонецПроцедуры\n\nОрфографическая ошибка в журналируем: журналируем"
  },
  {
    "title": "ИР Анализ замера",
    "description": "ИР Анализ замераTurboConf ИР",
    "code_snippet": ""
  },
  {
    "title": "mxl в таблицу значений",
    "description": "mxl в таблицу значений",
    "code_snippet": "ТабДок = Новый ТабличныйДокумент; \r\nТабДок.Прочитать(\"C:\\load\\vigr.mxl\");\r\nПЗ = Новый ПостроительЗапроса;\r\nПЗ.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабДок.Область());//передаем ТЗ\r\nПЗ.ДобавлениеПредставлений = ТипДобавленияПредставлений.НеДобавлять;\r\nПЗ.ЗаполнитьНастройки();\r\nПЗ.Выполнить();\r\nТЗ = ПЗ.Результат.Выгрузить();\n\nТабДок = Новый ТабличныйДокумент; \r\nТабДок.Прочитать(\"C:\\load\\vigr.mxl\");\r\nПЗ = Новый ПостроительЗапроса;\r\nПЗ.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабДок.Область());//передаем ТЗ\r\nПЗ.ДобавлениеПредставлений = ТипДобавленияПредставлений.НеДобавлять;\r\nПЗ.ЗаполнитьНастройки();\r\nПЗ.Выполнить();\r\nТЗ = ПЗ.Результат.Выгрузить();\n\n{8} Переменной ТЗ присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в vigr: vigr"
  },
  {
    "title": "Вывод картинки при печати в Табличный документ",
    "description": "Вывод картинки при печати в Табличный документ",
    "code_snippet": "//В свойствах ячейки Параметра Фото1 - на вкладке Макет ПараметрКартинки указать Фото1\r\n  //шрифт Параметра в ячейке делаем Белым, чтобы не было видно \"Картинка\"\r\n  ФайлКартинки = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(\r\n\t\tСправочники.Номенклатура.НайтиПоНаименованию(СтрокаТовары.Номенклатура),\r\n\t\t\"ФайлКартинки\");\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ФайлКартинки.Наименование) Тогда\r\n\t\t\t\r\n\t\t\tДвоичныеДанныеФайла                   = РаботаСФайлами.ДвоичныеДанныеФайла(ФайлКартинки);\t\r\n\t\t\tЕсли ТипЗнч(ДвоичныеДанныеФайла)      = Тип(\"Картинка\") Тогда\r\n\t\t\t\tКартинка                          = ДвоичныеДанныеФайла;\r\n\t\t\tИначеЕсли ТипЗнч(ДвоичныеДанныеФайла) = Тип(\"ДвоичныеДанные\") Тогда\r\n\t\t\t\tКартинка                          = Новый Картинка(ДвоичныеДанныеФайла);\r\n\t\t\tИначе\r\n\t\t\t\tКартинка                          = Новый Картинка;\r\n\t\t\tКонецЕсли;\r\n\t\t\tОбластьСтрокаТаблицыТовары.Параметры.Фото1         = Картинка;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\tТабличныйДокумент.Вывести(ОбластьСтрокаТаблицыТовары);\n\n//В свойствах ячейки Параметра Фото1 - на вкладке Макет ПараметрКартинки указать Фото1\r\n  //шрифт Параметра в ячейке делаем Белым, чтобы не было видно \"Картинка\"\r\n  ФайлКартинки = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(\r\n\t\tСправочники.Номенклатура.НайтиПоНаименованию(СтрокаТовары.Номенклатура),\r\n\t\t\"ФайлКартинки\");\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ФайлКартинки.Наименование) Тогда\r\n\t\t\t\r\n\t\t\tДвоичныеДанныеФайла                   = РаботаСФайлами.ДвоичныеДанныеФайла(ФайлКартинки);\t\r\n\t\t\tЕсли ТипЗнч(ДвоичныеДанныеФайла)      = Тип(\"Картинка\") Тогда\r\n\t\t\t\tКартинка                          = ДвоичныеДанныеФайла;\r\n\t\t\tИначеЕсли ТипЗнч(ДвоичныеДанныеФайла) = Тип(\"ДвоичныеДанные\") Тогда\r\n\t\t\t\tКартинка                          = Новый Картинка(ДвоичныеДанныеФайла);\r\n\t\t\tИначе\r\n\t\t\t\tКартинка                          = Новый Картинка;\r\n\t\t\tКонецЕсли;\r\n\t\t\tОбластьСтрокаТаблицыТовары.Параметры.Фото1         = Картинка;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\tТабличныйДокумент.Вывести(ОбластьСтрокаТаблицыТовары);"
  },
  {
    "title": "Подчеркнуть текст в макете",
    "description": "Подчеркнуть текст в макете",
    "code_snippet": "Функция ПодчеркнутьТекстВМакете(Строка) Экспорт\r\n    Результат = \"\";\r\n    Для Индекс = 1 По СтрДлина(Строка) Цикл\r\n        Если Найти(\" _-\", Сред(Строка, Индекс, 1)) = 0 Тогда \r\n            Результат = Результат + Символ(863);\r\n        КонецЕсли;\r\n        Результат = Результат + Сред(Строка, Индекс, 1);\r\n    КонецЦикла;\r\n\r\n    Возврат Результат;\r\nКонецФункции\n\nФункция ПодчеркнутьТекстВМакете(Строка) Экспорт\r\n    Результат = \"\";\r\n    Для Индекс = 1 По СтрДлина(Строка) Цикл\r\n        Если Найти(\" _-\", Сред(Строка, Индекс, 1)) = 0 Тогда \r\n            Результат = Результат + Символ(863);\r\n        КонецЕсли;\r\n        Результат = Результат + Сред(Строка, Индекс, 1);\r\n    КонецЦикла;\r\n\r\n    Возврат Результат;\r\nКонецФункции"
  },
  {
    "title": "Шаблон модуля команды для включения варианта внешнего отчета в интерфейс отдельной строкой",
    "description": "Шаблон модуля команды для включения варианта внешнего отчета в интерфейс отдельной строкой",
    "code_snippet": "&НаКлиенте\nФункция ДанныеОтчетаИВарианта()\n\t\n\tРезультат = Новый Структура;\n\t\n\t// внести данные по открываемому отчету и варианту\n\tРезультат.Вставить(\"ИмяОтчета\", \"ОтчетПоПродажамПоПродавцам\"); // Имя внешнего отчета.\n\tРезультат.Вставить(\"НаименованиеОтчета\", \"Отчет по продажам\"); // Наименование отчета. Как он зарегистрирован\n\tРезультат.Вставить(\"ИмяВариантаОтчета\", \"Отчет по продажам (по продавцам)\"); // Наименование варианта. Встроенного или пользовательского\n\t\n\tВозврат Результат\n\t\nКонецФункции\n\n#Область ОбработчикиСобытий\n\n&НаКлиенте\nПроцедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)\n\t\n\tПараметрыОтчета = ДанныеОтчетаИВарианта();\n\t\n\t//Подключение нужно только для внешнего отчета\n\tЕсли ПодключитьВнешнийОтчет(ПараметрыОтчета) Тогда\n\t\t\n\t\tКлючВарианта = ПолучитьКлючВариантаОтчета(ПараметрыОтчета);\n\t\tЕсли КлючВарианта = Неопределено Тогда\n\t\t\tСообщить(\"Не найден вариант отчета\");\n\t\t\tВозврат;\n\t\tКонецЕсли;\n\t\t\n\t\tПараметрыФормы = Новый Структура(\"КлючВарианта\", КлючВарианта);\n\t\tОткрытьФорму(\"ВнешнийОтчет.\" + ПараметрыОтчета.ИмяОтчета + \".Форма\", ПараметрыФормы);\n\t\t\n\tКонецЕсли;\n\t\nКонецПроцедуры\n\n#КонецОбласти\n\n#Область СлужебныеПроцедурыИФункции\n\n&НаСервере\nФункция ПодключитьВнешнийОтчет(ПараметрыОтчета)\n\t\n\tОтчетСсылка = Справочники.ДополнительныеОтчетыИОбработки.НайтиПоНаименованию(ПараметрыОтчета.НаименованиеОтчета);\n\tЕсли ОтчетСсылка.Пустая() Тогда\n\t\tСообщить(\"Не удалось найти внешний отчет\");\n\t\tВозврат Ложь;\n\tКонецЕсли;\n\t\n\tДвоичныеДанные = ОтчетСсылка.ХранилищеОбработки.Получить();\n\tАдресХранилища = ПоместитьВоВременноеХранилище(ДвоичныеДанные);\n\tВнешниеОтчеты.Подключить(АдресХранилища, ПараметрыОтчета.ИмяОтчета);\n\t\n\tВозврат Истина;\n\t\nКонецФункции\n\n&НаСервере\nФункция ПолучитьКлючВариантаОтчета(ПараметрыОтчета)\n\t\n\tСписокВариантов = ПолучитьСписок(\"ВнешнийОтчет.\" + ПараметрыОтчета.ИмяОтчета);\n\tЕсли СписокВариантов.Количество() = 0 Тогда\n\t\tВозврат Неопределено;\n\tКонецЕсли;\n\t\n\tЕсли СписокВариантов.Количество() = 1 Тогда\n\t\tВозврат СписокВариантов[0].Значение;\n\tКонецЕсли;\n\t\n\tДля Каждого ТекВариант Из СписокВариантов Цикл\n\t\t\n\t\tЕсли ТекВариант.Представление = ПараметрыОтчета.ИмяВариантаОтчета Тогда\n\t\t\tВозврат ТекВариант.Значение;\n\t\tКонецЕсли;\n\t\t\n\tКонецЦикла;\n\t\n\tВозврат Неопределено;\n\t\nКонецФункции\n\n&НаСервере\nФункция ПолучитьСсылкуНаОтчетПоИмени(НаименованиеОтчета)\n\t\n\tСсылкаНаОтчет = Справочники.ДополнительныеОтчетыИОбработки.НайтиПоНаименованию(НаименованиеОтчета);\n\tВозврат СсылкаНаОтчет;\n\t\nКонецФункции\n\n// Получает список настроек из хранилища. Значениями элементов списка являются ключи настроек.\n//\n// Параметры:\n//   КлючОтчета   - Строка - Полное имя отчета с точкой.\n//   Пользователь - Пользователь, настройки которого получаются. Необязательный параметр.\n//       - Неопределено                   - Получаются настройки текущего пользователя.\n//       - Строка                         - Имя пользователя ИБ.\n//       - УникальныйИдентификатор        - Идентификатор пользователя ИБ.\n//       - ПользовательИнформационнойБазы - Пользователь ИБ.\n//       - СправочникСсылка.Пользователи  - Пользователь.\n//\n// Возвращаемое значение: \n//   СписокЗначений - Список вариантов отчета.\n//       * Значение      - Строка - Ключ варианта.\n//       * Представление - Строка - Представление варианта.\n//\n// Важно:\n//   В отличие от механизма платформы вместо права \"АдминистрированиеДанных\" проверяются права доступа к отчету.\n//\n// См. также:\n//   \"СтандартноеХранилищеНастроекМенеджер.ПолучитьСписок\" в синтакс-помощнике.\n//\n&НаСервере\nФункция ПолучитьСписок(КлючОтчета, Знач Пользователь = Неопределено, Пользовательский = Ложь) Экспорт\n#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда\n\tРезультат = Новый СписокЗначений;\n\t\n\tЕсли ТипЗнч(КлючОтчета) = Тип(\"Строка\") Тогда\n\t\tОтчетИнформация = ВариантыОтчетов.СформироватьИнформациюОбОтчетеПоПолномуИмени(КлючОтчета);\n\t\tЕсли ТипЗнч(ОтчетИнформация.ТекстОшибки) = Тип(\"Строка\") Тогда\n\t\t\tВызватьИсключение ОтчетИнформация.ТекстОшибки;\n\t\tКонецЕсли;\n\t\tОтчетСсылка = ОтчетИнформация.Отчет;\n\tИначе\n\t\tОтчетСсылка = КлючОтчета;\n\tКонецЕсли;\n\t\n\tЗапрос = Новый Запрос;\n\tЗапрос.Текст = \n\t\"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ\n\t|\tВарианты.КлючВарианта,\n\t|\tВарианты.Наименование\n\t|ИЗ\n\t|\tСправочник.ВариантыОтчетов КАК Варианты\n\t|ГДЕ\n\t|\tВарианты.Отчет = &Отчет\n\t|\tИ Варианты.Автор = &Автор\n\t|\tИ Варианты.Автор.ИдентификаторПользователяИБ = &GUID\n\t|\tИ Варианты.ПометкаУдаления = ЛОЖЬ\n\t|\tИ Варианты.Пользовательский = ИСТИНА\";\n\tЗапрос.УстановитьПараметр(\"Отчет\", ОтчетСсылка);\n\t\n\tЕсли Пользователь = \"\" Тогда\n\t\tПользователь = Пользователи.СсылкаНеуказанногоПользователя();\n\tИначеЕсли Пользователь = Неопределено Тогда\n\t\tПользователь = Пользователи.АвторизованныйПользователь();\n\tКонецЕсли;\n\t\n\tЕсли Не Пользовательский Тогда\n\t\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"И Варианты.Пользовательский = ИСТИНА\", \"\");\n\t\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"И Варианты.Автор = &Автор\", \"\");\n\tКонецЕсли;\n\t\n\tЕсли ТипЗнч(Пользователь) = Тип(\"СправочникСсылка.Пользователи\") Тогда\n\t\tЗапрос.УстановитьПараметр(\"Автор\", Пользователь);\n\t\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"И Варианты.Автор.ИдентификаторПользователяИБ = &GUID\", \"\");\n\tИначе\n\t\tЕсли ТипЗнч(Пользователь) = Тип(\"УникальныйИдентификатор\") Тогда\n\t\t\tИдентификаторПользователя = Пользователь;\n\t\tИначе\n\t\t\tЕсли ТипЗнч(Пользователь) = Тип(\"Строка\") Тогда\n\t\t\t\tУстановитьПривилегированныйРежим(Истина);\n\t\t\t\tПользовательИБ = ПользователиИнформационнойБазы.НайтиПоИмени(Пользователь);\n\t\t\t\tУстановитьПривилегированныйРежим(Ложь);\n\t\t\t\tЕсли ПользовательИБ = Неопределено Тогда\n\t\t\t\t\tВозврат Результат;\n\t\t\t\tКонецЕсли;\n\t\t\tИначеЕсли ТипЗнч(Пользователь) = Тип(\"ПользовательИнформационнойБазы\") Тогда\n\t\t\t\tПользовательИБ = Пользователь;\n\t\t\tИначе\n\t\t\t\tВозврат Результат;\n\t\t\tКонецЕсли;\n\t\t\tИдентификаторПользователя = ПользовательИБ.УникальныйИдентификатор;\n\t\tКонецЕсли;\n\t\tЗапрос.УстановитьПараметр(\"GUID\", ИдентификаторПользователя);\n\t\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"И Варианты.Автор = &Автор\", \"\");\n\tКонецЕсли;\n\t\n\tТаблицаВариантов = Запрос.Выполнить().Выгрузить();\n\tДля Каждого СтрокаТаблицы Из ТаблицаВариантов Цикл\n\t\tРезультат.Добавить(СтрокаТаблицы.КлючВарианта, СтрокаТаблицы.Наименование);\n\tКонецЦикла;\n\t\n\tВозврат Результат;\n#КонецЕсли\nКонецФункции\n\n#КонецОбласти"
  },
  {
    "title": "Скрипт для точечного снятия с поддержки объектов конфигурации",
    "description": "Скрипт для TurboConf. Снимает с поддержки выделенный в дереве метаданных Объект, Реквизит, Измерение и т.п.",
    "code_snippet": ""
  },
  {
    "title": "Удалить недопустимые символы XML",
    "description": "Удалить недопустимые символы XML",
    "code_snippet": "Функция УдалитьНедопустимыеСимволыXML(Стр) Экспорт\r\n\tПозиция = НайтиНедопустимыеСимволыXML(Стр);\r\n\r\n\tПока Позиция <> 0 Цикл\r\n\t\tСтр = Лев(Стр, Позиция - 1) + Сред(Стр, Позиция + 1);\r\n\t\tПозиция = НайтиНедопустимыеСимволыXML(Стр);\r\n\tКонецЦикла;\r\n\r\n\tВозврат Стр;\r\nКонецФункции  //УдалитьНедопустимыеСимволыXML()\n\nФункция УдалитьНедопустимыеСимволыXML(Стр) Экспорт\r\n\tПозиция = НайтиНедопустимыеСимволыXML(Стр);\r\n\r\n\tПока Позиция <> 0 Цикл\r\n\t\tСтр = Лев(Стр, Позиция - 1) + Сред(Стр, Позиция + 1);\r\n\t\tПозиция = НайтиНедопустимыеСимволыXML(Стр);\r\n\tКонецЦикла;\r\n\r\n\tВозврат Стр;\r\nКонецФункции  //УдалитьНедопустимыеСимволыXML()"
  },
  {
    "title": "Значение перечисления по синониму",
    "description": "Значение перечисления по синониму",
    "code_snippet": "Функция ЗначениеПеречисления(ИмяПеречисления = Неопределено, Синоним = Неопределено, СообщитьЗначения = Ложь) Экспорт\r\n\t\r\n\tНайденныеЭлементы = Новый Массив;\r\n\tПредопределенноеПеречисление = Метаданные.Перечисления.Найти(ИмяПеречисления);\r\n\tШаблонВывода = \"Перечисление.%1.%2\";\r\n\t\r\n\tЕсли ПредопределенноеПеречисление <> Неопределено Тогда\r\n\t\tДля Каждого ЭлементПеречисления Из ПредопределенноеПеречисление.ЗначенияПеречисления Цикл\r\n\t\t\tЕсли ЗначениеЗаполнено(Синоним) Тогда\r\n\t\t\t\tЕсли ЭлементПеречисления.Синоним = Синоним Тогда\r\n\t\t\t\t\tЭлемент = СтрШаблон(ШаблонВывода, ПредопределенноеПеречисление.Имя, ЭлементПеречисления.Имя);\r\n\t\t\t\t\tНайденныеЭлементы.Добавить(Элемент);\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tИначе\r\n\t\t\t\tЭлемент = СтрШаблон(ШаблонВывода, ПредопределенноеПеречисление.Имя, ЭлементПеречисления.Имя);\r\n\t\t\t\tНайденныеЭлементы.Добавить(Элемент);\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tИначе\r\n\t\tДля Каждого ТекущееПеречисление Из Метаданные.Перечисления Цикл\r\n\t\t\tДля Каждого ЭлементПеречисления Из ТекущееПеречисление.ЗначенияПеречисления Цикл \r\n\t\t\t\tЕсли ЗначениеЗаполнено(Синоним) Тогда\r\n\t\t\t\t\tЕсли ЭлементПеречисления.Синоним = Синоним Тогда\r\n\t\t\t\t\t\tЭлемент = СтрШаблон(ШаблонВывода, ТекущееПеречисление.Имя, ЭлементПеречисления.Имя);\r\n\t\t\t\t\t\tНайденныеЭлементы.Добавить(Элемент);\r\n\t\t\t\t\t\tПрервать;\r\n\t\t\t\t\tКонецЕсли;\r\n\t\t\t\tИначе\r\n\t\t\t\t\tЭлемент = СтрШаблон(ШаблонВывода, ТекущееПеречисление.Имя, ЭлементПеречисления.Имя);\r\n\t\t\t\t\tНайденныеЭлементы.Добавить(Элемент);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли СообщитьЗначения Тогда\r\n\t\tДля Каждого ЭлементМассива Из НайденныеЭлементы Цикл\r\n\t\t\tСообщить(ЭлементМассива);\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат НайденныеЭлементы;\r\n\t\r\nКонецФункции // ЗначениеПеречисления()\n\nФункция ЗначениеПеречисления(ИмяПеречисления = Неопределено, Синоним = Неопределено, СообщитьЗначения = Ложь) Экспорт\r\n\t\r\n\tНайденныеЭлементы = Новый Массив;\r\n\tПредопределенноеПеречисление = Метаданные.Перечисления.Найти(ИмяПеречисления);\r\n\tШаблонВывода = \"Перечисление.%1.%2\";\r\n\t\r\n\tЕсли ПредопределенноеПеречисление <> Неопределено Тогда\r\n\t\tДля Каждого ЭлементПеречисления Из ПредопределенноеПеречисление.ЗначенияПеречисления Цикл\r\n\t\t\tЕсли ЗначениеЗаполнено(Синоним) Тогда\r\n\t\t\t\tЕсли ЭлементПеречисления.Синоним = Синоним Тогда\r\n\t\t\t\t\tЭлемент = СтрШаблон(ШаблонВывода, ПредопределенноеПеречисление.Имя, ЭлементПеречисления.Имя);\r\n\t\t\t\t\tНайденныеЭлементы.Добавить(Элемент);\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tИначе\r\n\t\t\t\tЭлемент = СтрШаблон(ШаблонВывода, ПредопределенноеПеречисление.Имя, ЭлементПеречисления.Имя);\r\n\t\t\t\tНайденныеЭлементы.Добавить(Элемент);\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tИначе\r\n\t\tДля Каждого ТекущееПеречисление Из Метаданные.Перечисления Цикл\r\n\t\t\tДля Каждого ЭлементПеречисления Из ТекущееПеречисление.ЗначенияПеречисления Цикл \r\n\t\t\t\tЕсли ЗначениеЗаполнено(Синоним) Тогда\r\n\t\t\t\t\tЕсли ЭлементПеречисления.Синоним = Синоним Тогда\r\n\t\t\t\t\t\tЭлемент = СтрШаблон(ШаблонВывода, ТекущееПеречисление.Имя, ЭлементПеречисления.Имя);\r\n\t\t\t\t\t\tНайденныеЭлементы.Добавить(Элемент);\r\n\t\t\t\t\t\tПрервать;\r\n\t\t\t\t\tКонецЕсли;\r\n\t\t\t\tИначе\r\n\t\t\t\t\tЭлемент = СтрШаблон(ШаблонВывода, ТекущееПеречисление.Имя, ЭлементПеречисления.Имя);\r\n\t\t\t\t\tНайденныеЭлементы.Добавить(Элемент);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли СообщитьЗначения Тогда\r\n\t\tДля Каждого ЭлементМассива Из НайденныеЭлементы Цикл\r\n\t\t\tСообщить(ЭлементМассива);\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат НайденныеЭлементы;\r\n\t\r\nКонецФункции // ЗначениеПеречисления()"
  },
  {
    "title": "Пакет поддержки английского языка для TurboConf",
    "description": "TurboConf Engish Support Pack позволяет использовать TurboConf 6 при разработке на английском языке.",
    "code_snippet": ""
  },
  {
    "title": "Найти дату самого первого документа в любой базе",
    "description": "Найти дату самого первого документа в любой базе",
    "code_snippet": "Функция НайтиСамыйПервыйДокументБазыДата() Экспорт\r\n\t\r\n\tТаблицаПервыхДокументов = Новый ТаблицаЗначений;\r\n\tТаблицаПервыхДокументов.Колонки.Добавить(\"Дата\");\r\n\t\r\n\tДля Каждого ВидДокумента Из Метаданные.Документы Цикл\r\n\t\t\r\n\t\tЗапрос = Новый Запрос;\r\n\t\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t|\tИмяДокумента.Дата КАК Дата\r\n\t\t|ИЗ\r\n\t\t|\tДокумент.%ИмяДокумента% КАК ИмяДокумента\r\n\t\t|\r\n\t\t|УПОРЯДОЧИТЬ ПО\r\n\t\t|\tДата\";\r\n\t\t\r\n\t\tЗапрос.Текст = СтрЗаменить(Запрос.Текст,\"%ИмяДокумента%\", ВидДокумента.Имя);\r\n\t\t\r\n\t\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\t\r\n\t\tЕсли РезультатЗапроса.Пустой() Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\t\r\n\t\tВыборкаДетальныеЗаписи.Следующий();\r\n\t\t\r\n\t\tНоваяЗапись = ТаблицаПервыхДокументов.Добавить();\r\n\t\tНоваяЗапись.Дата = ВыборкаДетальныеЗаписи.Дата;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tТаблицаПервыхДокументов.Сортировать(\"Дата Возр\");\r\n\t\r\n\tЕсли ТаблицаПервыхДокументов.Количество()=0 Тогда\r\n\t\tНоваяЗапись = ТаблицаПервыхДокументов.Добавить();\r\n\t\tНоваяЗапись.Дата = \"ЗАМЕНИТЬ НА ВАШУ ДАТА НА ВЫБОР\";\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ТаблицаПервыхДокументов[0].Дата;\r\n\r\nКонецФункции\n\nФункция НайтиСамыйПервыйДокументБазыДата() Экспорт\r\n\t\r\n\tТаблицаПервыхДокументов = Новый ТаблицаЗначений;\r\n\tТаблицаПервыхДокументов.Колонки.Добавить(\"Дата\");\r\n\t\r\n\tДля Каждого ВидДокумента Из Метаданные.Документы Цикл\r\n\t\t\r\n\t\tЗапрос = Новый Запрос;\r\n\t\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t|\tИмяДокумента.Дата КАК Дата\r\n\t\t|ИЗ\r\n\t\t|\tДокумент.%ИмяДокумента% КАК ИмяДокумента\r\n\t\t|\r\n\t\t|УПОРЯДОЧИТЬ ПО\r\n\t\t|\tДата\";\r\n\t\t\r\n\t\tЗапрос.Текст = СтрЗаменить(Запрос.Текст,\"%ИмяДокумента%\", ВидДокумента.Имя);\r\n\t\t\r\n\t\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\t\r\n\t\tЕсли РезультатЗапроса.Пустой() Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\t\r\n\t\tВыборкаДетальныеЗаписи.Следующий();\r\n\t\t\r\n\t\tНоваяЗапись = ТаблицаПервыхДокументов.Добавить();\r\n\t\tНоваяЗапись.Дата = ВыборкаДетальныеЗаписи.Дата;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tТаблицаПервыхДокументов.Сортировать(\"Дата Возр\");\r\n\t\r\n\tЕсли ТаблицаПервыхДокументов.Количество()=0 Тогда\r\n\t\tНоваяЗапись = ТаблицаПервыхДокументов.Добавить();\r\n\t\tНоваяЗапись.Дата = \"ЗАМЕНИТЬ НА ВАШУ ДАТА НА ВЫБОР\";\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ТаблицаПервыхДокументов[0].Дата;\r\n\r\nКонецФункции"
  },
  {
    "title": "Редактор скрипта для TurboConf 1.08",
    "description": "База 1С (DT) для удобного редактирования скрипта TurboConf в режиме конфигуратора с ИР адаптером",
    "code_snippet": ""
  },
  {
    "title": "Переопределение основных настроек динамического списка БСП",
    "description": "Переопределение основных настроек динамического списка БСП",
    "code_snippet": "Список.ПроизвольныйЗапрос = Истина;\r\n\r\n// 1. Переопределение настроек динамического списка.\r\n// 1.1 Получение структуры настроек.\r\nПараметрыСписка   = ОбщегоНазначения.СтруктураСвойствДинамическогоСписка();    \r\n// 1.2 Заполнение структуры настроек.\r\nПараметрыСписка.ТекстЗапроса = ПолучитьТекстПроизвольногоЗапросаДинамическогоСписка(); \r\nПараметрыСписка.ДинамическоеСчитываниеДанных = Истина;\r\nПараметрыСписка.ОсновнаяТаблица = \"Документ.КорректировкаНазначенияТоваров\".\r\n// 2. Установка свойств.\r\nОбщегоНазначения.УстановитьСвойстваДинамическогоСписка(Элементы.Список, ПараметрыСписка);\n\nСписок.ПроизвольныйЗапрос = Истина;\r\n\r\n// 1. Переопределение настроек динамического списка.\r\n// 1.1 Получение структуры настроек.\r\nПараметрыСписка   = ОбщегоНазначения.СтруктураСвойствДинамическогоСписка();    \r\n// 1.2 Заполнение структуры настроек.\r\nПараметрыСписка.ТекстЗапроса = ПолучитьТекстПроизвольногоЗапросаДинамическогоСписка(); \r\nПараметрыСписка.ДинамическоеСчитываниеДанных = Истина;\r\nПараметрыСписка.ОсновнаяТаблица = \"Документ.КорректировкаНазначенияТоваров\".\r\n// 2. Установка свойств.\r\nОбщегоНазначения.УстановитьСвойстваДинамическогоСписка(Элементы.Список, ПараметрыСписка);"
  },
  {
    "title": "Чтение файла (в таблицу значений) расширения .xlsx с помощью построителя запроса",
    "description": "Чтение файла (в таблицу значений) расширения .xlsx с помощью построителя запроса",
    "code_snippet": "// Создаем табдок;\r\n\tТабДок = Новый ТабличныйДокумент;\r\n\r\n\tТабДок.Прочитать(ИмяФайла, СпособЧтенияЗначенийТабличногоДокумента.Значение);\r\n\r\n\t// Получаем данные запросом;\r\n\tПЗ = Новый ПостроительЗапроса;\r\n\r\n\tПЗ.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабДок.Область());\r\n\r\n\tПЗ.ДобавлениеПредставлений = ТипДобавленияПредставлений.НеДобавлять;\r\n\r\n\tПЗ.ЗаполнитьНастройки();\r\n\r\n\tПЗ.Выполнить();\r\n\r\n\tТаблицаЗначений = ПЗ.Результат.Выгрузить();\n\n// Создаем табдок;\r\n\tТабДок = Новый ТабличныйДокумент;\r\n\r\n\tТабДок.Прочитать(ИмяФайла, СпособЧтенияЗначенийТабличногоДокумента.Значение);\r\n\r\n\t// Получаем данные запросом;\r\n\tПЗ = Новый ПостроительЗапроса;\r\n\r\n\tПЗ.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабДок.Область());\r\n\r\n\tПЗ.ДобавлениеПредставлений = ТипДобавленияПредставлений.НеДобавлять;\r\n\r\n\tПЗ.ЗаполнитьНастройки();\r\n\r\n\tПЗ.Выполнить();\r\n\r\n\tТаблицаЗначений = ПЗ.Результат.Выгрузить();\n\n{17} Переменной ТаблицаЗначений присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Быстрое объединение двух таблиц значений",
    "description": "Быстрое объединение двух таблиц значений",
    "code_snippet": "// Добавляет в начало первой ТЗ, значения из второй ТЗ, колонки обоих ТЗ должны совпадать\n// Данный способ работает быстрее чем стандартный с добавлением в конец строк из другой ТЗ\n// Подробности см. http://www.gilev.ru/простой-трюк-для-быстрого-объединени/\n//\n// Параметры:\n//  Таблица1 - ТаблицаЗначений\t - в эту таблицу, в начало (а не в конец) будут добавлены строки из Таблица2\n//  Таблица2 - ТаблицаЗначений\t - таблица, строками которой требуется дополнить значение из параметра Таблица1\n//\nПроцедура ДополнитьТаблицуЗначениямиИзВторой(Таблица1, Таблица2) Экспорт\n\t\n\tДля Индекс = 1 По Таблица2.Количество() Цикл\n\t\tТаблица1.Вставить(0);\n\tКонецЦикла;\n\tДля Индекс = 0 По Таблица2.Колонки.Количество() - 1 Цикл\n\t\tТаблица1.ЗагрузитьКолонку(Таблица2.ВыгрузитьКолонку(Индекс), Индекс);\n\tКонецЦикла;\n\t\nКонецПроцедуры"
  },
  {
    "title": "Соревнование по программированию на 1С",
    "description": "Соревнование по программированию на 1С",
    "code_snippet": ""
  },
  {
    "title": "TurboConf 6 - расширение Конфигуратора 1СНаш выбор",
    "description": "TurboConf повышает эффективность работы в Конфигураторе 1С и помогает программисту автоматизировать свои задачи.",
    "code_snippet": ""
  },
  {
    "title": "Отладка скриптов",
    "description": "Отладка скриптовСекреты TurboConf",
    "code_snippet": "{\n    // Use IntelliSense to learn about possible attributes.\n    // Hover to view descriptions of existing attributes.\n    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Отладка 1Script\",\n            \"type\": \"oscript\",\n            \"request\": \"attach\",\n            \"program\": \"${file}\",\n            \"args\": [],\n            \"cwd\": \"${workspaceRoot}\",\n            \"env\": {},\n            \"runtimeExecutable\": null,\n            \"runtimeArgs\": [],\n            \"debugPort\": 5318,\n            \"protocol\": \"tcp\"\n        }\n    ]\n}"
  },
  {
    "title": "Пробуем ChatGPT в реальной работе",
    "description": "Пробуем ChatGPT в реальной работеНейросети и AI",
    "code_snippet": "e.Graphics.DrawImage(Properties.Resources.context_menu_template, rectImage);\n\nimage = Properties.Resources.context_menu_template;"
  },
  {
    "title": "Запись текста без BOM",
    "description": "Запись текста без BOM",
    "code_snippet": "//Пример записи Строки в файл\t\r\n\tСтр = \"Строка для записи\";\r\n\tИмяФайла = \"Текст.txt\";\r\n\t\r\n//Запись стандартными методами. Добавляет BOM. Размер файла 35 байт\r\n\tТекст = Новый ТекстовыйДокумент;\r\n\tТекст.УстановитьТекст(Стр);\r\n\tТекст.Записать(ИмяФайла, КодировкаТекста.UTF8);\r\n\t\r\n//Запись без BOM. Размер файла 32 байта\t\r\n\tЗаписатьBOM = Ложь;\r\n\tДвоичныеДанныеСтроки = ПолучитьДвоичныеДанныеИзСтроки(Стр, КодировкаТекста.UTF8, ЗаписатьBOM);\t\r\n\tДвоичныеДанныеСтроки.Записать(ИмяФайла);\n\n//Пример записи Строки в файл\t\r\n\tСтр = \"Строка для записи\";\r\n\tИмяФайла = \"Текст.txt\";\r\n\t\r\n//Запись стандартными методами. Добавляет BOM. Размер файла 35 байт\r\n\tТекст = Новый ТекстовыйДокумент;\r\n\tТекст.УстановитьТекст(Стр);\r\n\tТекст.Записать(ИмяФайла, КодировкаТекста.UTF8);\r\n\t\r\n//Запись без BOM. Размер файла 32 байта\t\r\n\tЗаписатьBOM = Ложь;\r\n\tДвоичныеДанныеСтроки = ПолучитьДвоичныеДанныеИзСтроки(Стр, КодировкаТекста.UTF8, ЗаписатьBOM);\t\r\n\tДвоичныеДанныеСтроки.Записать(ИмяФайла);"
  },
  {
    "title": "Получить ссылку из навигационной ссылки",
    "description": "Получить ссылку из навигационной ссылки",
    "code_snippet": "Функция ПолучитьСсылкуИзНавигационной(НС) Экспорт\r\n    \r\n    ПерваяТочка = Найти(НС, \"e1cib/data/\");\r\n    ВтораяТочка = Найти(НС, \"?ref=\");\r\n    \r\n    ПредставлениеТипа   = Сред(НС, ПерваяТочка + 11, ВтораяТочка - ПерваяТочка - 11);\r\n    ШаблонЗначения = ЗначениеВСтрокуВнутр(ПредопределенноеЗначение(ПредставлениеТипа + \".ПустаяСсылка\"));\r\n    ЗначениеСсылки = СтрЗаменить(ШаблонЗначения, \"00000000000000000000000000000000\", Сред(НС, ВтораяТочка + 5));\r\n    Возврат ЗначениеИзСтрокиВнутр(ЗначениеСсылки);\r\n   \t \r\nКонецФункции\n\nФункция ПолучитьСсылкуИзНавигационной(НС) Экспорт\r\n    \r\n    ПерваяТочка = Найти(НС, \"e1cib/data/\");\r\n    ВтораяТочка = Найти(НС, \"?ref=\");\r\n    \r\n    ПредставлениеТипа   = Сред(НС, ПерваяТочка + 11, ВтораяТочка - ПерваяТочка - 11);\r\n    ШаблонЗначения = ЗначениеВСтрокуВнутр(ПредопределенноеЗначение(ПредставлениеТипа + \".ПустаяСсылка\"));\r\n    ЗначениеСсылки = СтрЗаменить(ШаблонЗначения, \"00000000000000000000000000000000\", Сред(НС, ВтораяТочка + 5));\r\n    Возврат ЗначениеИзСтрокиВнутр(ЗначениеСсылки);\r\n   \t \r\nКонецФункции"
  },
  {
    "title": "Переназначение штатных комбинаций горячих клавиш в конфигураторе 1С",
    "description": "Переназначение штатных комбинаций горячих клавиш в конфигураторе 1ССекреты TurboConf",
    "code_snippet": "//@script_name KeyRemapSample\n//@script_display_name  Пример переназначения комбинаций клавиш\n//@script_description Переназначает штатные хоткеи на пользовательские\n//@script_author m.bolsun\n//@script_developer_url http://turboconf.ru\n//@script_url https://turboconf.ru\n//@script_section Ассистирование\n//@script_hotkey Control+F3 ПереназначитьКлавишуНайтиСледующийВыделенный\n//@script_hotkey F3 ПереназначитьКлавишуНайтиСледующий\n//@retain_clipboard 0\n//@enterprise_mode 0\n//@hide_actions 0\n//@text_documents_only 1\n\nПерем ТурбоКонф;\n\nПроцедура ПереназначитьКлавишуНайтиСледующийВыделенный()\n\tТурбоКонф.Клавиша(Keys.F3);\nКонецПроцедуры\n\nПроцедура ПереназначитьКлавишуНайтиСледующий()\n\tТурбоКонф.КонтролКлавиша(Keys.F3);\nКонецПроцедуры\n\nТурбоКонф = Новый ТурбоКонф;"
  },
  {
    "title": "TurboConf ИР адаптер 2.52",
    "description": "Cкрипт \"ИР Адаптер\" для платного расширения TurboConf конфигуратора 1С 8 обеспечивает доступ к функциям мощной подсистемы \"Инструменты разработчика Tormozit\" (ИР)",
    "code_snippet": ""
  },
  {
    "title": "Отобразить заголовки периодов на форме отчета БСП",
    "description": "Отобразить заголовки периодов на форме отчета БСП",
    "code_snippet": "Процедура ОпределитьНастройкиФормы(Параметр, КлючВарианта, НастройкиОтчета) Экспорт\r\n\t\r\n\tНастройкиОтчета.События.ПослеЗаполненияПанелиБыстрыхНастроек = Истина;\r\n\t\t\r\nКонецПроцедуры\r\n\r\nПроцедура ПослеЗаполненияПанелиБыстрыхНастроек(ФормаОтчета, ПараметрыОбновления) Экспорт\r\n\t\r\n\tПочинитьЗаголовкиПериодов(ФормаОтчета);\r\n\t\t\r\nКонецПроцедуры\r\n\r\nПроцедура ПочинитьЗаголовкиПериодов(ФормаОтчета)\r\n\t\r\n\tЗаголовкиЭлементов = Новый Массив;\r\n\tДля Каждого ПараметрСКД Из СхемаКомпоновкиДанных.Параметры Цикл\r\n\t\tЗначениеТипа = ПараметрСКД.ТипЗначения.ПривестиЗначение(Неопределено);\r\n\t\tЕсли ТипЗнч(ЗначениеТипа) = Тип(\"СтандартныйПериод\") Тогда\r\n\t\t\tЗаголовкиЭлементов.Добавить(ПараметрСКД.Заголовок + \":\");\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого ЭлементФормы Из ФормаОтчета.Элементы Цикл\r\n\t\t\r\n\t\tСвойстваЭлемента = Новый Структура(\"ПоложениеЗаголовка,Заголовок,ПутьКДанным\");\r\n\t\tЗаполнитьЗначенияСвойств(СвойстваЭлемента, ЭлементФормы);\r\n\t\t\r\n\t\tЕсли СвойстваЭлемента.ПоложениеЗаголовка = ПоложениеЗаголовкаЭлементаФормы.Нет\r\n\t\t\tИ ЗаголовкиЭлементов.Найти(СвойстваЭлемента.Заголовок) <> Неопределено Тогда\r\n\t\t\tЭлементФормы.ПоложениеЗаголовка = ПоложениеЗаголовкаЭлементаФормы.Авто;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\t\r\nКонецПроцедуры\n\nПроцедура ОпределитьНастройкиФормы(Параметр, КлючВарианта, НастройкиОтчета) Экспорт\r\n\t\r\n\tНастройкиОтчета.События.ПослеЗаполненияПанелиБыстрыхНастроек = Истина;\r\n\t\t\r\nКонецПроцедуры\r\n\r\nПроцедура ПослеЗаполненияПанелиБыстрыхНастроек(ФормаОтчета, ПараметрыОбновления) Экспорт\r\n\t\r\n\tПочинитьЗаголовкиПериодов(ФормаОтчета);\r\n\t\t\r\nКонецПроцедуры\r\n\r\nПроцедура ПочинитьЗаголовкиПериодов(ФормаОтчета)\r\n\t\r\n\tЗаголовкиЭлементов = Новый Массив;\r\n\tДля Каждого ПараметрСКД Из СхемаКомпоновкиДанных.Параметры Цикл\r\n\t\tЗначениеТипа = ПараметрСКД.ТипЗначения.ПривестиЗначение(Неопределено);\r\n\t\tЕсли ТипЗнч(ЗначениеТипа) = Тип(\"СтандартныйПериод\") Тогда\r\n\t\t\tЗаголовкиЭлементов.Добавить(ПараметрСКД.Заголовок + \":\");\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого ЭлементФормы Из ФормаОтчета.Элементы Цикл\r\n\t\t\r\n\t\tСвойстваЭлемента = Новый Структура(\"ПоложениеЗаголовка,Заголовок,ПутьКДанным\");\r\n\t\tЗаполнитьЗначенияСвойств(СвойстваЭлемента, ЭлементФормы);\r\n\t\t\r\n\t\tЕсли СвойстваЭлемента.ПоложениеЗаголовка = ПоложениеЗаголовкаЭлементаФормы.Нет\r\n\t\t\tИ ЗаголовкиЭлементов.Найти(СвойстваЭлемента.Заголовок) <> Неопределено Тогда\r\n\t\t\tЭлементФормы.ПоложениеЗаголовка = ПоложениеЗаголовкаЭлементаФормы.Авто;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\t\r\nКонецПроцедуры"
  },
  {
    "title": "Функция восстановления значения при чтении JSON (ЧтениеJSON)",
    "description": "Функция восстановления значения при чтении JSON (ЧтениеJSON)",
    "code_snippet": "// Структура JSON файла:\r\n{\r\n \"Info\": [\r\n  {\r\n   \"Наименование\": \"Global Trade Company GmbH\",\r\n   \"НаименованиеПолное\": \"Global Trade Company GmbH\",\r\n   \"ИНН\": \"\",\r\n   \"КПП\": \"\",\r\n   \"ЮрФизЛицо\": \"Юридическое лицо\",\r\n   \"ТекущаяДата\": \"2023-09-03T16:45:44Z\",\r\n   \"ДанныеАдреса\": \"Страна - 1; Город  - 1; Индекс - 1\"\r\n  },\r\n  {\r\n   \"Наименование\": \"Kikinda (Сербия)\",\r\n   \"НаименованиеПолное\": \"Kikinda (Сербия)\",\r\n   \"ИНН\": \"\",\r\n   \"КПП\": \"\",\r\n   \"ЮрФизЛицо\": \"Юридическое лицо\",\r\n   \"ТекущаяДата\": \"2023-09-03T16:45:44Z\",\r\n   \"ДанныеАдреса\": \"Страна - 2; Город  - 2; Индекс - 2\"\r\n  },\r\n  {\r\n   \"Наименование\": \"Koenig Holding GmbH\",\r\n   \"НаименованиеПолное\": \"Koenig Holding GmbH\",\r\n   \"ИНН\": \"\",\r\n   \"КПП\": \"\",\r\n   \"ЮрФизЛицо\": \"Юридическое лицо\",\r\n   \"ТекущаяДата\": \"2023-09-03T16:45:44Z\",\r\n   \"ДанныеАдреса\": \"Страна - 3; Город  - 3; Индекс - 3\"\r\n  },\r\n  {\r\n   \"Наименование\": \"АВИКА\",\r\n   \"НаименованиеПолное\": \"АВИКА\",\r\n   \"ИНН\": \"4825005381\",\r\n   \"КПП\": \"482201001\",\r\n   \"ЮрФизЛицо\": \"Юридическое лицо\",\r\n   \"ТекущаяДата\": \"2023-09-03T16:45:44Z\",\r\n   \"ДанныеАдреса\": \"Страна - 4; Город  - 4; Индекс - 4\"\r\n  },\r\n  {\r\n   \"Наименование\": \"АвтБанк АКБ\",\r\n   \"НаименованиеПолное\": \"АКБ АвтБанк\",\r\n   \"ИНН\": \"\",\r\n   \"КПП\": \"\",\r\n   \"ЮрФизЛицо\": \"Юридическое лицо\",\r\n   \"ТекущаяДата\": \"2023-09-03T16:45:44Z\",\r\n   \"ДанныеАдреса\": \"Страна - 5; Город  - 5; Индекс - 5\"\r\n  }\r\n ]\r\n}\r\n\r\n//Код в модуле формы:\r\n&НаСервере\r\nФункция ФункцияВосстановленияСериализуемогоЗначения(Свойство, Значение, ДополнительныеПараметры) Экспорт\r\n\r\n\t Если Свойство = \"ИНН\" ИЛИ Свойство = \"КПП\" Тогда\r\n\t \t Если ПустаяСтрока(Значение) Тогда\r\n\t\t\tВозврат \"Пустая строка \" + Свойство; \r\n\t\t КонецЕсли;\r\n\t КонецЕсли;\r\n\r\nКонецФункции // ()\r\n\r\n&НаСервере\r\nПроцедура ВыполнитьЧтениеДанныхНаСервере()\r\n\t\r\n\t// Проверка наличия файла по пути;\r\n\tПутьНаСервере1  = \"C:\\Users\\SystemX\\Desktop\\TestJSON_1.json\";\r\n\t\r\n\tФайлJSON = Новый Файл(ПутьНаСервере1);\r\n\t\r\n\tЕсли НЕ ФайлJSON.Существует() Тогда\r\n\t\tОбщегоНазначения.СообщитьПользователю(\"Файл отсутствует по пути: \" + ПутьНаСервере1);\t\t\r\n\t    Возврат;\r\n\tКонецЕсли;\r\n\t\r\n\tЧтениеJSON = Новый ЧтениеJSON();\r\n\tПопытка\r\n\t   ЧтениеJSON.ОткрытьФайл(ПутьНаСервере1, \"UTF-8\");\r\n\tИсключение\r\n\tКонецПопытки;\r\n\t\r\n\tПрочитанноеЗначение = ПрочитатьJSON(ЧтениеJSON, Ложь,,, \"ФункцияВосстановленияСериализуемогоЗначения\", ЭтотОбъект);\r\n\t\r\n\tЧтениеJSON.Закрыть(); \r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ВыполнитьЧтениеДанных(Команда)\r\n\tВыполнитьЧтениеДанныхНаСервере();\r\nКонецПроцедуры\n\n// Структура JSON файла:\r\n{\r\n \"Info\": [\r\n  {\r\n   \"Наименование\": \"Global Trade Company GmbH\",\r\n   \"НаименованиеПолное\": \"Global Trade Company GmbH\",\r\n   \"ИНН\": \"\",\r\n   \"КПП\": \"\",\r\n   \"ЮрФизЛицо\": \"Юридическое лицо\",\r\n   \"ТекущаяДата\": \"2023-09-03T16:45:44Z\",\r\n   \"ДанныеАдреса\": \"Страна - 1; Город  - 1; Индекс - 1\"\r\n  },\r\n  {\r\n   \"Наименование\": \"Kikinda (Сербия)\",\r\n   \"НаименованиеПолное\": \"Kikinda (Сербия)\",\r\n   \"ИНН\": \"\",\r\n   \"КПП\": \"\",\r\n   \"ЮрФизЛицо\": \"Юридическое лицо\",\r\n   \"ТекущаяДата\": \"2023-09-03T16:45:44Z\",\r\n   \"ДанныеАдреса\": \"Страна - 2; Город  - 2; Индекс - 2\"\r\n  },\r\n  {\r\n   \"Наименование\": \"Koenig Holding GmbH\",\r\n   \"НаименованиеПолное\": \"Koenig Holding GmbH\",\r\n   \"ИНН\": \"\",\r\n   \"КПП\": \"\",\r\n   \"ЮрФизЛицо\": \"Юридическое лицо\",\r\n   \"ТекущаяДата\": \"2023-09-03T16:45:44Z\",\r\n   \"ДанныеАдреса\": \"Страна - 3; Город  - 3; Индекс - 3\"\r\n  },\r\n  {\r\n   \"Наименование\": \"АВИКА\",\r\n   \"НаименованиеПолное\": \"АВИКА\",\r\n   \"ИНН\": \"4825005381\",\r\n   \"КПП\": \"482201001\",\r\n   \"ЮрФизЛицо\": \"Юридическое лицо\",\r\n   \"ТекущаяДата\": \"2023-09-03T16:45:44Z\",\r\n   \"ДанныеАдреса\": \"Страна - 4; Город  - 4; Индекс - 4\"\r\n  },\r\n  {\r\n   \"Наименование\": \"АвтБанк АКБ\",\r\n   \"НаименованиеПолное\": \"АКБ АвтБанк\",\r\n   \"ИНН\": \"\",\r\n   \"КПП\": \"\",\r\n   \"ЮрФизЛицо\": \"Юридическое лицо\",\r\n   \"ТекущаяДата\": \"2023-09-03T16:45:44Z\",\r\n   \"ДанныеАдреса\": \"Страна - 5; Город  - 5; Индекс - 5\"\r\n  }\r\n ]\r\n}\r\n\r\n//Код в модуле формы:\r\n&НаСервере\r\nФункция ФункцияВосстановленияСериализуемогоЗначения(Свойство, Значение, ДополнительныеПараметры) Экспорт\r\n\r\n\t Если Свойство = \"ИНН\" ИЛИ Свойство = \"КПП\" Тогда\r\n\t \t Если ПустаяСтрока(Значение) Тогда\r\n\t\t\tВозврат \"Пустая строка \" + Свойство; \r\n\t\t КонецЕсли;\r\n\t КонецЕсли;\r\n\r\nКонецФункции // ()\r\n\r\n&НаСервере\r\nПроцедура ВыполнитьЧтениеДанныхНаСервере()\r\n\t\r\n\t// Проверка наличия файла по пути;\r\n\tПутьНаСервере1  = \"C:\\Users\\SystemX\\Desktop\\TestJSON_1.json\";\r\n\t\r\n\tФайлJSON = Новый Файл(ПутьНаСервере1);\r\n\t\r\n\tЕсли НЕ ФайлJSON.Существует() Тогда\r\n\t\tОбщегоНазначения.СообщитьПользователю(\"Файл отсутствует по пути: \" + ПутьНаСервере1);\t\t\r\n\t    Возврат;\r\n\tКонецЕсли;\r\n\t\r\n\tЧтениеJSON = Новый ЧтениеJSON();\r\n\tПопытка\r\n\t   ЧтениеJSON.ОткрытьФайл(ПутьНаСервере1, \"UTF-8\");\r\n\tИсключение\r\n\tКонецПопытки;\r\n\t\r\n\tПрочитанноеЗначение = ПрочитатьJSON(ЧтениеJSON, Ложь,,, \"ФункцияВосстановленияСериализуемогоЗначения\", ЭтотОбъект);\r\n\t\r\n\tЧтениеJSON.Закрыть(); \r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ВыполнитьЧтениеДанных(Команда)\r\n\tВыполнитьЧтениеДанныхНаСервере();\r\nКонецПроцедуры\n\nДлина не может быть меньше нуля.\r\nИмя параметра: length\r\nОрфографическая ошибка в Kikinda (найдено 2): Kikinda\r\nОрфографическая ошибка в Koenig (найдено 2): Koenig\r\nОрфографическая ошибка в ФункцияВосстановленияСериализуемогоЗначения (найдено 2): Сериализуемого"
  },
  {
    "title": "Функции преобразования ЗаписьJSON",
    "description": "Функции преобразования ЗаписьJSON",
    "code_snippet": "&НаСервере\r\nПроцедура ВыполнитьЗаписьДанныхНаСервере()\r\n\t\r\n\tПутьНаСервере1  = \"C:\\Users\\SystemX\\Desktop\\TestJSON_1.json\"; \r\n\tПутьНаСервере2  = \"C:\\Users\\SystemX\\Desktop\\TestJSON_2.json\";\r\n\r\n\tМассивДанных = Новый Массив;\r\n\t\r\n\tЗаполнитьМассивДанными(МассивДанных);\r\n\t\r\n\tСтруктураЗаписываемогоФайла = Новый Структура(\"Info\");\r\n\t\r\n\tСтруктураЗаписываемогоФайла.Info = МассивДанных;     \r\n\t\r\n\t// 1. Новый способ (преимущественно для простых типов, быстрой генерации JSON строки); \r\n\t//Попытка\r\n\t//\tЗначениеJSON = ЗаписатьЗначениеJSON(СтруктураЗаписываемогоФайла);\t\r\n\t//Исключение\r\n\t//КонецПопытки;\r\n\t\r\n\t// 2. Старый способ;\r\n\tЗаписьJSON = Новый ЗаписьJSON();\r\n\t\r\n\tЗаписьJSON.ОткрытьФайл(ПутьНаСервере1, \"UTF-8\",, Новый ПараметрыЗаписиJSON(, \" \"));\r\n\t\r\n\tНастройкиСериализации = Новый НастройкиСериализацииJSON(); \r\n\tНастройкиСериализации.ВариантЗаписиДаты = ВариантЗаписиДатыJSON.УниверсальнаяДата;\r\n\tНастройкиСериализации.СериализовыватьМассивыКакОбъекты \t= Ложь;\t\r\n\tНастройкиСериализации.ФорматСериализацииДаты \t\t\t= ФорматДатыJSON.ISO;\r\n\t\r\n\tПопытка\r\n\t\tЗаписатьJSON(ЗаписьJSON, СтруктураЗаписываемогоФайла, НастройкиСериализации, \"ФункцияПреобразованияНеСериализуемыхТипов\", ЭтотОбъект);\r\n\tИсключение\r\n\tКонецПопытки;\r\n\t\r\n\tЗаписьJSON.Закрыть();\t\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ЗаполнитьМассивДанными(МассивДанных)\r\n\t\r\n\tЗапрос = Новый Запрос(\"ВЫБРАТЬ ПЕРВЫЕ 20\r\n\t                      |\tКонтрагенты.Наименование \t\t\tКАК Наименование,\r\n\t                      |\tКонтрагенты.НаименованиеПолное \t\tКАК НаименованиеПолное,\r\n\t                      |\tКонтрагенты.ИНН \t\t\t\t\tКАК ИНН,\r\n\t                      |\tКонтрагенты.КПП \t\t\t\t\tКАК КПП,\r\n\t                      |\tКонтрагенты.ЮрФизЛицо \t\t\t\tКАК ЮрФизЛицо\r\n\t                      |ИЗ\r\n\t                      |\tСправочник.Контрагенты \t\t\t\tКАК Контрагенты\t\t\");\r\n\t\r\n\tВыборка = Запрос.Выполнить().Выбрать();\r\n\t\r\n\tСчетчик = 1;\r\n\tПока Выборка.Следующий() \tЦикл\r\n\t\t                     \t\r\n\t\tСтруктураКонтрагент = Новый Структура(\"Наименование, НаименованиеПолное, ИНН, КПП, ЮрФизЛицо\");   \r\n\t\t\r\n\t\tЗаполнитьЗначенияСвойств(СтруктураКонтрагент, Выборка);\r\n\t\t\r\n\t\tЕсли Выборка.ЮрФизЛицо = Перечисления.ЮрФизЛицо.ФизЛицо Тогда\r\n\t\t\tСтруктураКонтрагент.ЮрФизЛицо = \"Физическое лицо\";\t\r\n\t\tИначеЕсли Выборка.ЮрФизЛицо = Перечисления.ЮрФизЛицо.ЮрЛицо Тогда\r\n\t\t\tСтруктураКонтрагент.ЮрФизЛицо = \"Юридическое лицо\";  \r\n\t\tИначе\r\n\t\t\tСтруктураКонтрагент.ЮрФизЛицо = \"Индивидуальный предприниматель\";\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tСтруктураКонтрагент.Вставить(\"ТекущаяДата\", ЗаписатьДатуJSON(ТекущаяДата(), ФорматДатыJSON.ISO, ВариантЗаписиДатыJSON.УниверсальнаяДата));\r\n\t\t\r\n\t\tДопИнформация = Новый ДанныеАдреса(\r\n\t\t\t\t\t\t\t\t\t\t  Новый Структура\r\n\t\t\t\t\t\t\t\t\t\t  (\r\n\t\t\t\t\t\t\t\t\t\t  \"Страна, Город, Дом, Индекс\", \r\n\t\t\t\t\t\t\t\t          \"Страна - \" + Счетчик, \r\n\t\t\t\t\t\t\t\t\t\t  \"Город  - \" + Счетчик,\r\n\t\t\t\t\t\t\t\t\t\t  \"Дом    - \" + Счетчик, \r\n\t\t\t\t\t\t\t\t\t\t  \"Индекс - \" + Счетчик\r\n\t\t\t\t\t\t\t\t\t\t  )\r\n\t\t\t\t\t\t\t\t\t\t  );\r\n\t\t\t\t\r\n\t\tСтруктураКонтрагент.Вставить(\"ДанныеАдреса\", ДопИнформация);  \r\n\t\t\r\n\t\tМассивДанных.Добавить(СтруктураКонтрагент);    \r\n\t\t\r\n\t\tСчетчик = Счетчик + 1;\r\n\t\t\r\n\tКонецЦикла;\r\n\r\nКонецПроцедуры // ЗаполнитьМассивДанными()\r\n\r\n&НаСервере\r\nФункция ФункцияПреобразованияНеСериализуемыхТипов(Свойство, Значение, ДополнительныеПараметры, Отказ) Экспорт\r\n\t\r\n\t// Вызывается для тех типов, которые платформа не может автоматические преобразовать в JSON;\r\n\tЕсли Свойство = \"ДанныеАдреса\" Тогда    \r\n\t\tВозврат Строка(Значение.Страна + \"; \" + Значение.Город + \"; \" + Значение.Индекс); \t\r\n\tКонецЕсли;\r\n\r\nКонецФункции // ФункцияПреобразованиеСложныхТипов()\r\n\r\n&НаКлиенте\r\nПроцедура ВыполнитьЗаписьДанных(Команда)\r\n\tВыполнитьЗаписьДанныхНаСервере();\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ВыполнитьЗаписьДанныхНаСервере()\r\n\t\r\n\tПутьНаСервере1  = \"C:\\Users\\SystemX\\Desktop\\TestJSON_1.json\"; \r\n\tПутьНаСервере2  = \"C:\\Users\\SystemX\\Desktop\\TestJSON_2.json\";\r\n\r\n\tМассивДанных = Новый Массив;\r\n\t\r\n\tЗаполнитьМассивДанными(МассивДанных);\r\n\t\r\n\tСтруктураЗаписываемогоФайла = Новый Структура(\"Info\");\r\n\t\r\n\tСтруктураЗаписываемогоФайла.Info = МассивДанных;     \r\n\t\r\n\t// 1. Новый способ (преимущественно для простых типов, быстрой генерации JSON строки); \r\n\t//Попытка\r\n\t//\tЗначениеJSON = ЗаписатьЗначениеJSON(СтруктураЗаписываемогоФайла);\t\r\n\t//Исключение\r\n\t//КонецПопытки;\r\n\t\r\n\t// 2. Старый способ;\r\n\tЗаписьJSON = Новый ЗаписьJSON();\r\n\t\r\n\tЗаписьJSON.ОткрытьФайл(ПутьНаСервере1, \"UTF-8\",, Новый ПараметрыЗаписиJSON(, \" \"));\r\n\t\r\n\tНастройкиСериализации = Новый НастройкиСериализацииJSON(); \r\n\tНастройкиСериализации.ВариантЗаписиДаты = ВариантЗаписиДатыJSON.УниверсальнаяДата;\r\n\tНастройкиСериализации.СериализовыватьМассивыКакОбъекты \t= Ложь;\t\r\n\tНастройкиСериализации.ФорматСериализацииДаты \t\t\t= ФорматДатыJSON.ISO;\r\n\t\r\n\tПопытка\r\n\t\tЗаписатьJSON(ЗаписьJSON, СтруктураЗаписываемогоФайла, НастройкиСериализации, \"ФункцияПреобразованияНеСериализуемыхТипов\", ЭтотОбъект);\r\n\tИсключение\r\n\tКонецПопытки;\r\n\t\r\n\tЗаписьJSON.Закрыть();\t\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ЗаполнитьМассивДанными(МассивДанных)\r\n\t\r\n\tЗапрос = Новый Запрос(\"ВЫБРАТЬ ПЕРВЫЕ 20\r\n\t                      |\tКонтрагенты.Наименование \t\t\tКАК Наименование,\r\n\t                      |\tКонтрагенты.НаименованиеПолное \t\tКАК НаименованиеПолное,\r\n\t                      |\tКонтрагенты.ИНН \t\t\t\t\tКАК ИНН,\r\n\t                      |\tКонтрагенты.КПП \t\t\t\t\tКАК КПП,\r\n\t                      |\tКонтрагенты.ЮрФизЛицо \t\t\t\tКАК ЮрФизЛицо\r\n\t                      |ИЗ\r\n\t                      |\tСправочник.Контрагенты \t\t\t\tКАК Контрагенты\t\t\");\r\n\t\r\n\tВыборка = Запрос.Выполнить().Выбрать();\r\n\t\r\n\tСчетчик = 1;\r\n\tПока Выборка.Следующий() \tЦикл\r\n\t\t                     \t\r\n\t\tСтруктураКонтрагент = Новый Структура(\"Наименование, НаименованиеПолное, ИНН, КПП, ЮрФизЛицо\");   \r\n\t\t\r\n\t\tЗаполнитьЗначенияСвойств(СтруктураКонтрагент, Выборка);\r\n\t\t\r\n\t\tЕсли Выборка.ЮрФизЛицо = Перечисления.ЮрФизЛицо.ФизЛицо Тогда\r\n\t\t\tСтруктураКонтрагент.ЮрФизЛицо = \"Физическое лицо\";\t\r\n\t\tИначеЕсли Выборка.ЮрФизЛицо = Перечисления.ЮрФизЛицо.ЮрЛицо Тогда\r\n\t\t\tСтруктураКонтрагент.ЮрФизЛицо = \"Юридическое лицо\";  \r\n\t\tИначе\r\n\t\t\tСтруктураКонтрагент.ЮрФизЛицо = \"Индивидуальный предприниматель\";\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tСтруктураКонтрагент.Вставить(\"ТекущаяДата\", ЗаписатьДатуJSON(ТекущаяДата(), ФорматДатыJSON.ISO, ВариантЗаписиДатыJSON.УниверсальнаяДата));\r\n\t\t\r\n\t\tДопИнформация = Новый ДанныеАдреса(\r\n\t\t\t\t\t\t\t\t\t\t  Новый Структура\r\n\t\t\t\t\t\t\t\t\t\t  (\r\n\t\t\t\t\t\t\t\t\t\t  \"Страна, Город, Дом, Индекс\", \r\n\t\t\t\t\t\t\t\t          \"Страна - \" + Счетчик, \r\n\t\t\t\t\t\t\t\t\t\t  \"Город  - \" + Счетчик,\r\n\t\t\t\t\t\t\t\t\t\t  \"Дом    - \" + Счетчик, \r\n\t\t\t\t\t\t\t\t\t\t  \"Индекс - \" + Счетчик\r\n\t\t\t\t\t\t\t\t\t\t  )\r\n\t\t\t\t\t\t\t\t\t\t  );\r\n\t\t\t\t\r\n\t\tСтруктураКонтрагент.Вставить(\"ДанныеАдреса\", ДопИнформация);  \r\n\t\t\r\n\t\tМассивДанных.Добавить(СтруктураКонтрагент);    \r\n\t\t\r\n\t\tСчетчик = Счетчик + 1;\r\n\t\t\r\n\tКонецЦикла;\r\n\r\nКонецПроцедуры // ЗаполнитьМассивДанными()\r\n\r\n&НаСервере\r\nФункция ФункцияПреобразованияНеСериализуемыхТипов(Свойство, Значение, ДополнительныеПараметры, Отказ) Экспорт\r\n\t\r\n\t// Вызывается для тех типов, которые платформа не может автоматические преобразовать в JSON;\r\n\tЕсли Свойство = \"ДанныеАдреса\" Тогда    \r\n\t\tВозврат Строка(Значение.Страна + \"; \" + Значение.Город + \"; \" + Значение.Индекс); \t\r\n\tКонецЕсли;\r\n\r\nКонецФункции // ФункцияПреобразованиеСложныхТипов()\r\n\r\n&НаКлиенте\r\nПроцедура ВыполнитьЗаписьДанных(Команда)\r\n\tВыполнитьЗаписьДанныхНаСервере();\r\nКонецПроцедуры\n\n{5} Переменной ПутьНаСервере2 присвоено значение, но оно нигде не используется\r\n{93} Не все части функции возвращают значение\r\nОрфографическая ошибка в сериализовано: сериализовано\r\nОрфографическая ошибка в СериализовыватьМассивыКакОбъекты: Сериализовывать\r\nОрфографическая ошибка в ФункцияПреобразованияНеСериализуемыхТипов (найдено 2): Сериализуемых"
  },
  {
    "title": "Вывод табличного документа в типовое окно печати для УФ",
    "description": "Вывод табличного документа в типовое окно печати для УФ",
    "code_snippet": "&НаКлиенте\n\tПроцедура КомандаПечати(Команда) \n\t\tТабличныйДокументДляПечати = ПолучитьТаблчныйДокумент(); \n\n\t\tКоллекция = УправлениеПечатьюКлиент.НоваяКоллекцияПечатныхФорм(\"Макет\");\n\n\t\t//структура в массиве\n\t\tСтруктураКоллекции = Коллекция.Получить(0);\n\t\tСтруктураКоллекции.ТабличныйДокумент =ТабДокОшибок ;\n\t\tСтруктураКоллекции.ТабличныйДокумент =ТабДокОшибок ;\n\t\tСтруктураКоллекции.СинонимМакета = \"Имя файла\"; //Для сохранения, отпраки по почет\n\n\t\tУправлениеПечатьюКлиент.ПечатьДокументов(Коллекция,,ЭтаФорма);\n\n\tКонецПроцедуры\n\n&НаКлиенте\n\tПроцедура КомандаПечати(Команда) \n\t\tТабличныйДокументДляПечати = ПолучитьТабличныйДокумент(); \n\t\tКоллекция = УправлениеПечатьюКлиент.НоваяКоллекцияПечатныхФорм(\"Макет\");\n\n\t\t//структура в массиве\n\t\tСтруктураКоллекции = Коллекция.Получить(0);\n\t\tСтруктураКоллекции.ТабличныйДокумент =ТабличныйДокументДляПечати ;\n\t\tСтруктураКоллекции.СинонимМакета = \"Имя файла\"; //Для сохранения, отправки по почте\n\n\t\tУправлениеПечатьюКлиент.ПечатьДокументов(Коллекция,,ЭтаФорма);\n\n\tКонецПроцедуры\n\nТабличныйДокумент = ПолучитьИзВременногоХранилища(АдресХранилища);\n        \n    МодульУправлениеПечатьюКлиент = ОбщегоНазначенияКлиент.ОбщийМодуль(\"УправлениеПечатьюКлиент\");\n    ИдентификаторПечатнойФормы = \"Печать\";\n        \n    КоллекцияПечатныхФорм = МодульУправлениеПечатьюКлиент.НоваяКоллекцияПечатныхФорм(ИдентификаторПечатнойФормы);\n    ПечатнаяФорма = МодульУправлениеПечатьюКлиент.ОписаниеПечатнойФормы(КоллекцияПечатныхФорм, ИдентификаторПечатнойФормы);\n    ПечатнаяФорма.СинонимМакета = НСтр(\"ru = 'Печать'\");\n    ПечатнаяФорма.ТабличныйДокумент = ТабличныйДокумент;\n    \n    МодульУправлениеПечатьюКлиент.ПечатьДокументов(КоллекцияПечатныхФорм);"
  },
  {
    "title": "Заполнить контрагента по ИНН, Получить данные по ИНН",
    "description": "Заполнить контрагента по ИНН, Получить данные по ИНН",
    "code_snippet": "// <Описание функции>\n//\n// Параметры:\n//  ИНН  - Тип.Строка - Строка с ИНН\n//                 <продолжение описания параметра>\n//\n// Возвращаемое значение:\n//   <Тип.Структура>   - Структура сожержит\n//\t\t\t\t\t\t\t\t\t*ВидКонтрагента \n//\t\t\t\t\t\t\t\t\t*КПП\n//\t\t\t\t\t\t\t\t\t*РегистрационныйНомер\n//\t\t\t\t\t\t\t\t\t*Наименование\n//\t\t\t\t\t\t\t     \t*НаименованиеПолное\n//\tЕсли организация не является ИП *ЮредическийАдрес\t\t\t\t\t\t\n//\n// Сайт API\n// https://egrul.itsoft.ru/\n&НаСервереБезКонтекста\nФункция ЗК_ПолучитьДанныеКонтрагентаПоИНН(ИНН)\n\t\t\n\tДанныеКонтрагента = Новый Структура;\n\tДанныеКонтрагента.Вставить(\"ИНН\", ИНН); \n\t\n\tАдресСервера = \"egrul.itsoft.ru\";\n\tАдресРесурса = \"/short_data/?\" + ИНН;\n\t\n\tСоеденения = Новый HTTPСоединение(АдресСервера,,,,, 30, Новый ЗащищенноеСоединениеOpenSSL);\n\t\n\tЗапрос = Новый HTTPЗапрос(АдресРесурса);\n\t\n\tПопытка\n\t\tОтвет = Соеденения.Получить(Запрос);\t\n\tИсключение\n\t\tСообщить(\"Не удалось получить данные по ИНН по причине: \" + ОписаниеОшибки());\n\t\tВозврат ДанныеКонтрагента;\n\tКонецПопытки;\n\t\n\tДанныеЕГРБЛ = Неопределено;\n\t\n\tЕсли Ответ.КодСостояния = 200 Тогда\n\t\t\n\t\tСтрокаJSON = Ответ.ПолучитьТелоКакСтроку();\n\t\tЧтениеJSON = Новый ЧтениеJSON;\n\t\tЧтениеJSON.УстановитьСтроку(СтрокаJSON);\n\t\t\n\t\tДанныеЕГРБЛ = ПрочитатьJSON(ЧтениеJSON, Истина);\n\t\t\n\tИначе\n\t\t\n\t\tТекст = СтрШаблон(\"Не удалось получать данные по ИНН...\n\t\t\t\t\t\t\t|Код состояния: %1\n\t\t\t\t\t\t\t|Ответ сервера: %2\", Ответ.КодСостояния, СтрокаJSON);\n\n\t\tСообщить(Текст);\n\t\tВозврат ДанныеКонтрагента;\n\t\n\tКонецЕсли; \n\t\n\tЕсли ДанныеЕГРБЛ[\"short_form\"] <> Неопределено И ДанныеЕГРБЛ[\"short_form\"] = \"ИП\" Тогда\n\t\tВидКонтрагента = Перечисления.ВидыКонтрагентовСПАРКРиски.ИндивидуальныйПредприниматель;\n\tИначе\n\t\tВидКонтрагента = Перечисления.ВидыКонтрагентовСПАРКРиски.ЮридическоеЛицо;\n\tКонецЕсли;\n\t\n\tДанныеКонтрагента.Вставить(\"ВидКонтрагента\"\t     , ВидКонтрагента);\n\tДанныеКонтрагента.Вставить(\"КПП\"\t\t\t\t , ДанныеЕГРБЛ[\"kpp\"]);\n\tДанныеКонтрагента.Вставить(\"РегистрационныйНомер\", ДанныеЕГРБЛ[\"ogrn\"]);\n\tДанныеКонтрагента.Вставить(\"Наименование\"\t\t , ДанныеЕГРБЛ[\"short_name\"]);\n\tДанныеКонтрагента.Вставить(\"НаименованиеПолное\"\t , ДанныеЕГРБЛ[\"full_name\"]);\n\t                                                                                    \n\tЕсли ДанныеЕГРБЛ[\"address\"] <> Неопределено Тогда\n\t\tДанныеКонтрагента.Вставить(\"ЮредическийАдрес\", ДанныеЕГРБЛ[\"address\"]);\t\n\tКонецЕсли;\n\t\n\tВозврат ДанныеКонтрагента;\n\t\nКонецФункции // ЗК_ПолучитьДанныеКонтрагентаПоИНН()"
  },
  {
    "title": "Автосохранение текстов модулей в папку TurboConf",
    "description": "Автосохранение текстов модулей в папку TurboConfСекреты TurboConf",
    "code_snippet": ""
  },
  {
    "title": "Парсинг URL",
    "description": "Парсинг URL",
    "code_snippet": "Функция РазложитьURL(URL) Экспорт\n\t\n\tРезультат = СтруктураURL();\n\tНачальнаяПозицияПоиска = 1;\n\t\n\t// Получим протокол\n\tДанныеПарсинга = РаспарситьСтроку(URL, НачальнаяПозицияПоиска,,,, \"://\");\n\t\n\tЕсли ДанныеПарсинга.Успех Тогда\n\t\t\n\t\tРезультат.Протокол = НРег(ДанныеПарсинга.Вырез);\n\t\t\n\t\tЕсли Результат.Протокол <> \"https\" Тогда\n\t\t\t\n\t\t\tРезультат.БезопасноеСоединение = Ложь;\n\t\t\tРезультат.Порт = 80;\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\t\tНачальнаяПозицияПоиска = ДанныеПарсинга.ВырезКонец + 3; // Добавим размер шаблона\n\t\t\n\tКонецЕсли;\n\t\n\t// Получим адрес хоста\n\tДанныеПарсинга = РаспарситьСтроку(URL, НачальнаяПозицияПоиска,,,, \"/\");\n\tДостигнутКонецСтроки = Ложь;\n\t\n\tЕсли ДанныеПарсинга.Успех Тогда\n\t\t\n\t\t// Найден конец адреса и он продолжается\n\t\tРезультат.АдресВебСервера = ДанныеПарсинга.Вырез;\n\t\tНачальнаяПозицияПоиска = ДанныеПарсинга.ВырезКонец;\n\t\t\n\tИначе\n\t\t\n\t\t// Не найден конец адреса, значит он закончился, берем всю строку\n\t\tДанныеПарсинга = РаспарситьСтроку(URL, НачальнаяПозицияПоиска);\n\t\t\n\t\tЕсли ДанныеПарсинга.Успех Тогда\n\t\t\t\n\t\t\tРезультат.АдресВебСервера = ДанныеПарсинга.Вырез;\n\t\t\tНачальнаяПозицияПоиска = ДанныеПарсинга.ВырезКонец;\n\t\t\tДостигнутКонецСтроки = Истина;\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\tКонецЕсли;\n\t\n\t// Обработаем адрес веб-сервера\n\tЕсли Не ПустаяСтрока(Результат.АдресВебСервера) Тогда\n\t\t\n\t\t// Если адрес содержит параметры авторизации, выделим их\n\t\tДанныеПарсинга = РаспарситьСтроку(Результат.АдресВебСервера,,,,, \"@\");\n\t\t\n\t\tЕсли ДанныеПарсинга.Успех Тогда\n\t\t\t\n\t\t\tРезультат.АдресВебСервера = Сред(Результат.АдресВебСервера, ДанныеПарсинга.ВырезКонец + 1);\n\t\t\tПараметрыАвторизации = ДанныеПарсинга.Вырез;\n\t\t\tРезультат.Авторизация = Новый Структура(\"ИмяПользователя, Пароль\", \"\", \"\");\n\t\t\tДанныеПарсинга = РаспарситьСтроку(ПараметрыАвторизации,,,,, \":\");\n\t\t\t\n\t\t\tЕсли ДанныеПарсинга.Успех Тогда\n\t\t\t\t\n\t\t\t\tРезультат.Авторизация.ИмяПользователя = ДанныеПарсинга.Вырез;\n\t\t\t\tРезультат.Авторизация.Пароль = Сред(ПараметрыАвторизации, ДанныеПарсинга.ВырезКонец + 1);\n\t\t\t\t\n\t\t\tИначе // Есть только логин\n\t\t\t\t\n\t\t\t\tРезультат.Авторизация.ИмяПользователя = ПараметрыАвторизации;\n\t\t\t\t\n\t\t\tКонецЕсли;\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\t\t// Если адрес содержит порт, выделим его\n\t\tДанныеПарсинга = РаспарситьСтроку(Результат.АдресВебСервера,,,,, \":\");\n\t\t\n\t\tЕсли ДанныеПарсинга.Успех Тогда\n\t\t\t\n\t\t\tРезультат.Порт = Число(Сред(Результат.АдресВебСервера, ДанныеПарсинга.ВырезКонец + 1));\n\t\t\tРезультат.АдресВебСервера = ДанныеПарсинга.Вырез;\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\tКонецЕсли;\n\t\n\tЕсли Не ДостигнутКонецСтроки и СтрДлина(URL) - НачальнаяПозицияПоиска <= 1 Тогда\n\t\t\n\t\tДостигнутКонецСтроки = Истина;\n\t\t\n\tКонецЕсли;\n\t\n\tЕсли ДостигнутКонецСтроки Тогда\n\t\t\n\t\tВыделитьЯкорьИзURL(Результат);\n\t\tВыделитьПараметрыЗапросаИзURL(Результат);\n\t\t\n\t\tВозврат Результат;\n\t\t\n\tКонецЕсли;\n\t\n\t// Получим текст запроса\n\tДанныеПарсинга = РаспарситьСтроку(URL, НачальнаяПозицияПоиска);\n\t\n\tЕсли ДанныеПарсинга.Успех Тогда\n\t\t\n\t\tРезультат.Запрос = ДанныеПарсинга.Вырез;\n\t\t\n\tКонецЕсли;\n\t\n\t// Получим путь запроса\n\tДанныеПарсинга = РаспарситьСтроку(URL, НачальнаяПозицияПоиска, \"/\", Истина,, \"/\", Истина);\n\t\n\tЕсли ДанныеПарсинга.Успех Тогда\n\t\t\n\t\tРезультат.ПутьЗапроса = ?(ДанныеПарсинга.Вырез = \"/\", \"\", ДанныеПарсинга.Вырез);\n\t\tНачальнаяПозицияПоиска = ДанныеПарсинга.ВырезКонец;\n\t\t\n\t\tЕсли СтрНайти(Результат.ПутьЗапроса, \"_t\", НаправлениеПоиска.СКонца) > 0 Тогда\n\t\t\t\n\t\t\tРезультат.ТипБазы = 1; // Тестовая\n\t\t\t\n\t\tИначеЕсли СтрНайти(Результат.ПутьЗапроса, \"_n\", НаправлениеПоиска.СКонца) > 0 Тогда\n\t\t\t\n\t\t\tРезультат.ТипБазы = 2; // Копия (тестовая)\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\tКонецЕсли;\n\t\n\t// Получим конечную точку (условно говоря, скрипт)\n\tДанныеПарсинга = РаспарситьСтроку(URL, НачальнаяПозицияПоиска);\n\t\n\tЕсли ДанныеПарсинга.Успех Тогда\n\t\t\n\t\tРезультат.КонечнаяТочкаПути = ДанныеПарсинга.Вырез;\n\t\tДанныеПарсинга = РаспарситьСтроку(Результат.КонечнаяТочкаПути,,,,, \"?\");\n\t\t\n\t\tЕсли ДанныеПарсинга.Успех Тогда\n\t\t\t\n\t\t\tРезультат.КонечнаяТочкаПути = ДанныеПарсинга.Вырез;\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\tКонецЕсли;\n\t\n\tВыделитьЯкорьИзURL(Результат);\n\tВыделитьПараметрыЗапросаИзURL(Результат);\n\t\n\tВозврат Результат;\n\t\nКонецФункции\n\nФункция СтруктураURL()\n\t\n\tСостав = Новый Структура;\n\tСостав.Вставить(\"Авторизация\"); //Новый Структура(\"ИмяПользователя, Пароль\");\n\tСостав.Вставить(\"Протокол\", \"https\");\n\tСостав.Вставить(\"БезопасноеСоединение\", Истина);\n\tСостав.Вставить(\"АдресВебСервера\", \"\");\n\tСостав.Вставить(\"Порт\", 443);\n\tСостав.Вставить(\"Запрос\");\n\tСостав.Вставить(\"ПутьЗапроса\");\n\tСостав.Вставить(\"КонечнаяТочкаПути\");\n\tСостав.Вставить(\"Параметры\", Новый Соответствие);\n\tСостав.Вставить(\"ТипБазы\", 0); // 0 - Рабочая, 1 - тестовая, 2 - копия рабочей\n\tСостав.Вставить(\"Якорь\"); // Всё что после #\n\t\n\tВозврат Состав;\n\t\nКонецФункции\n\nПроцедура ВыделитьПараметрыЗапросаИзURL(ДанныеURL)\n\t\n\tДанныеПарсинга = РаспарситьСтроку(ДанныеURL.Запрос,,,,, \"?\");\n\t\n\tЕсли Не ДанныеПарсинга.Успех Тогда\n\t\t\n\t\tВозврат;\n\t\t\n\tКонецЕсли;\n\t\n\tПозицияРазделителя = ДанныеПарсинга.ВырезКонец;\n\tДанныеПарсинга = РаспарситьСтроку(ДанныеURL.Запрос,,,, ПозицияРазделителя);\n\t\n\tЕсли Не ДанныеПарсинга.Успех Тогда\n\t\t\n\t\tВозврат;\n\t\t\n\tКонецЕсли;\n\t\n\tЗапросБезПараметров = ДанныеПарсинга.Вырез;\n\tДанныеПарсинга = РаспарситьСтроку(ДанныеURL.Запрос, ПозицияРазделителя + 1);\n\tДанныеURL.Запрос = ЗапросБезПараметров;\n\t\n\tЕсли Не ДанныеПарсинга.Успех Тогда\n\t\t\n\t\tВозврат;\n\t\t\n\tКонецЕсли;\n\t\n\tСписокПараметров = СтрРазделить(ДанныеПарсинга.Вырез, \"&\", Ложь);\n\t\n\tДля Каждого ТекПараметр Из СписокПараметров Цикл\n\t\t\n\t\tКлючИЗначение = СтрРазделить(ТекПараметр, \"=\", Ложь);\n\t\t\n\t\tЕсли КлючИЗначение.Количество() >= 2 Тогда\n\t\t\t\n\t\t\tДанныеURL.Параметры.Вставить(КлючИЗначение[0], КлючИЗначение[1]);\n\t\t\t\n\t\tИначе\n\t\t\t\n\t\t\tДанныеURL.Параметры.Вставить(КлючИЗначение[0]);\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\tКонецЦикла;\t\n\t\nКонецПроцедуры\n\nПроцедура ВыделитьЯкорьИзURL(ДанныеURL)\n\t\n\tДанныеПарсинга = РаспарситьСтроку(ДанныеURL.Запрос,,,,, \"#\");\n\t\n\tЕсли Не ДанныеПарсинга.Успех Тогда\n\t\t\n\t\tВозврат;\n\t\t\n\tКонецЕсли;\n\t\n\tДанныеURL.Якорь = Сред(ДанныеURL.Запрос, ДанныеПарсинга.ВырезКонец + 1);\n\tДанныеURL.Запрос = ДанныеПарсинга.Вырез;\n\t\nКонецПроцедуры"
  },
  {
    "title": "Упрощенный парсинг строк",
    "description": "Упрощенный парсинг строк",
    "code_snippet": "Функция РаспарситьСтроку(Строка,\n\tЗнач ПозицияСЛева = Неопределено, ПодстрокаСЛева = Неопределено, ВключаетПодстрокуСЛева = Ложь,\n\tЗнач ПозицияСПрава = Неопределено, ПодстрокаСПрава = Неопределено, ВключаетПодстрокуСПрава = Ложь)\n\t\n\tРезультатПарсинга = Новый Структура;\n\tРезультатПарсинга.Вставить(\"Успех\", Ложь);\n\tРезультатПарсинга.Вставить(\"ВырезНачало\", 0);\n\tРезультатПарсинга.Вставить(\"ВырезКонец\", 0);\n\tРезультатПарсинга.Вставить(\"Вырез\", \"\");\n\t\n\tЕсли ПозицияСЛева = Неопределено и ПодстрокаСЛева = Неопределено и\n\t\tПозицияСПрава = Неопределено и ПодстрокаСПрава = Неопределено Тогда\n\t\t\n\t\tВозврат РезультатПарсинга;\n\t\t\n\tКонецЕсли;\n\t\n\t// Ищем начальную позицию\n\tПозицияСЛеваДляПоиска = Неопределено;\n\t\n\tЕсли ПозицияСЛева = Неопределено и ПодстрокаСЛева = Неопределено Тогда\n\t\t\n\t\tПозицияСЛева = 1; // Критериев начала выреза не задано, значит берем начало строки\n\t\t\n\tИначеЕсли ПодстрокаСЛева <> Неопределено Тогда\n\t\t\n\t\tПозицияСЛева = СтрНайти(Строка, ПодстрокаСЛева,, ?(ПозицияСЛева = Неопределено, 1, ПозицияСЛева));\n\t\tПозицияСЛеваДляПоиска = ПозицияСЛева + СтрДлина(ПодстрокаСЛева);\n\t\t\n\t\tЕсли ПозицияСЛева = 0 Тогда\n\t\t\t\n\t\t\tВозврат РезультатПарсинга;\n\t\t\t\n\t\tИначеЕсли Не ВключаетПодстрокуСЛева Тогда\n\t\t\t\n\t\t\tПозицияСЛева = ПозицияСЛева + СтрДлина(ПодстрокаСЛева);\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\tКонецЕсли;\n\t\n\t// Ищем конечную позицию\n\tЕсли ПозицияСПрава = Неопределено и ПодстрокаСПрава = Неопределено Тогда\n\t\t\n\t\tПозицияСПрава = СтрДлина(Строка) + 1; // Критериев окончания выреза не задано, значит берем до конца строки\n\t\t\n\tИначеЕсли ПодстрокаСПрава <> Неопределено Тогда\n\t\t\n\t\tНачальнаяПозицияПоиска = ?(ПозицияСЛеваДляПоиска = Неопределено, ПозицияСЛева, ПозицияСЛеваДляПоиска);\n\t\t\n\t\tЕсли ПозицияСПрава <> Неопределено и ПозицияСПрава > НачальнаяПозицияПоиска Тогда\n\t\t\t\n\t\t\tНачальнаяПозицияПоиска = ПозицияСПрава;\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\t\tПозицияСПрава = СтрНайти(Строка, ПодстрокаСПрава,, НачальнаяПозицияПоиска);\n\t\t\n\t\tЕсли ПозицияСПрава = 0 Тогда\n\t\t\t\n\t\t\tВозврат РезультатПарсинга;\n\t\t\t\n\t\tИначеЕсли ВключаетПодстрокуСПрава Тогда\n\t\t\t\n\t\t\tПозицияСПрава = ПозицияСПрава + СтрДлина(ПодстрокаСПрава);\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\tКонецЕсли;\n\t\n\tРезультатПарсинга.Успех = Истина;\n\tРезультатПарсинга.ВырезНачало = ПозицияСЛева;\n\tРезультатПарсинга.ВырезКонец = ПозицияСПрава;\n\tРезультатПарсинга.Вырез = Сред(Строка, ПозицияСЛева, ПозицияСПрава - ПозицияСЛева);\n\t\n\tВозврат РезультатПарсинга;\n\t\nКонецФункции"
  },
  {
    "title": "Вывод месяца строкой из даты",
    "description": "Вывод месяца строкой из даты",
    "code_snippet": "&НаСервере\r\nФункция ФорматМесяц(ДатаИсходная)\r\n\tМесяц = Нрег(Формат(ДатаИсходная, \"ДЛФ=DD\"));\r\n\tМесяц = СтрЗаменить(Месяц, Лев(Месяц, СтрНайти(Месяц, \" \")), \"\");\r\n\tМесяц = Лев(Месяц, СтрНайти(Месяц, \" \"));\r\n\t\r\n\tВозврат Месяц;\r\nКонецФункции //ФорматМесяц\n\n&НаСервере\r\nФункция ФорматМесяц(ДатаИсходная)\r\n\tМесяц = Нрег(Формат(ДатаИсходная, \"ДЛФ=DD\"));\r\n\tМесяц = СтрЗаменить(Месяц, Лев(Месяц, СтрНайти(Месяц, \" \")), \"\");\r\n\tМесяц = Лев(Месяц, СтрНайти(Месяц, \" \"));\r\n\t\r\n\tВозврат Месяц;\r\nКонецФункции //ФорматМесяц\n\nМесяц = Нрег(Формат(ДатаИсходная, \"\"ДФ=MMMM\"\"));\nВозврат Месяц;"
  },
  {
    "title": "Сортировка ДанныеФормыДеревоЗначений с изменением направления",
    "description": "Сортировка ДанныеФормыДеревоЗначений с изменением направления",
    "code_snippet": "&НаКлиентеНаСервереБезКонтекста\r\nПроцедура СортироватьДанныеФормыДерево(КоллекцияСортировки, КолонкаСортировки, ВключатьПодчиненные = Ложь, ПоВозрастанию = Истина)\r\n    \r\n    КоллекцияСтрок = КоллекцияСортировки.ПолучитьЭлементы();\r\n    \r\n    СортироватьДанныеФормыКоллекция(КоллекцияСтрок, КолонкаСортировки, ПоВозрастанию);\r\n    \r\n    Если ВключатьПодчиненные Тогда\r\n        \r\n        Для Каждого ТекущаяСтрока Из КоллекцияСтрок Цикл\r\n            \r\n            СортироватьДанныеФормыДерево(ТекущаяСтрока, КолонкаСортировки, ВключатьПодчиненные, ПоВозрастанию);\r\n            \r\n        КонецЦикла;\r\n        \r\n    КонецЕсли;\r\n    \r\nКонецПроцедуры\r\n\r\n&НаКлиентеНаСервереБезКонтекста\r\nПроцедура СортироватьДанныеФормыКоллекция(КоллекцияСтрок, КолонкаСортировки, ПоВозрастанию = Истина)\r\n    \r\n    ПараметрыЗначений     = Новый Соответствие;\r\n    СортированныеЗначения = Новый СписокЗначений;\r\n    \r\n    Для Каждого ТекущаяСтрока Из КоллекцияСтрок Цикл\r\n        \r\n        ТекущееЗначение = ТекущаяСтрока[КолонкаСортировки];\r\n        \r\n        ПараметрыЗначения = ПараметрыЗначений.Получить(ТекущееЗначение);\r\n        \r\n        Если ПараметрыЗначения = Неопределено Тогда\r\n            \r\n            ПараметрыЗначения = Новый Массив;\r\n            ПараметрыЗначений.Вставить(ТекущееЗначение, ПараметрыЗначения);\r\n            СортированныеЗначения.Добавить(ТекущееЗначение);\r\n            \r\n        КонецЕсли;\r\n        \r\n        ПараметрыЗначения.Добавить(ТекущаяСтрока);\r\n        \r\n    КонецЦикла;\r\n    \r\n    СортированныеЗначения.СортироватьПоЗначению(?(ПоВозрастанию, НаправлениеСортировки.Возр, НаправлениеСортировки.Убыв));\r\n    НовыйИндекс = 0;\r\n    \r\n    Для Каждого ТекущееЗначение Из СортированныеЗначения Цикл\r\n        \r\n        МассивСтрок = ПараметрыЗначений.Получить(ТекущееЗначение.Значение);\r\n        \r\n        Для Каждого ТекущаяСтрока Из МассивСтрок Цикл\r\n            \r\n            ТекущийИндекс = КоллекцияСтрок.Индекс(ТекущаяСтрока);\r\n            ШагСдвига     = НовыйИндекс - ТекущийИндекс;\r\n            \r\n            Если НЕ ШагСдвига = 0 Тогда\r\n                \r\n                КоллекцияСтрок.Сдвинуть(ТекущийИндекс, ШагСдвига);\r\n                \r\n            КонецЕсли;\r\n            \r\n            НовыйИндекс = НовыйИндекс + 1;\r\n            \r\n        КонецЦикла;\r\n        \r\n    КонецЦикла;\r\n    \r\nКонецПроцедуры\n\n&НаКлиентеНаСервереБезКонтекста\r\nПроцедура СортироватьДанныеФормыДерево(КоллекцияСортировки, КолонкаСортировки, ВключатьПодчиненные = Ложь, ПоВозрастанию = Истина)\r\n    \r\n    КоллекцияСтрок = КоллекцияСортировки.ПолучитьЭлементы();\r\n    \r\n    СортироватьДанныеФормыКоллекция(КоллекцияСтрок, КолонкаСортировки, ПоВозрастанию);\r\n    \r\n    Если ВключатьПодчиненные Тогда\r\n        \r\n        Для Каждого ТекущаяСтрока Из КоллекцияСтрок Цикл\r\n            \r\n            СортироватьДанныеФормыДерево(ТекущаяСтрока, КолонкаСортировки, ВключатьПодчиненные, ПоВозрастанию);\r\n            \r\n        КонецЦикла;\r\n        \r\n    КонецЕсли;\r\n    \r\nКонецПроцедуры\r\n\r\n&НаКлиентеНаСервереБезКонтекста\r\nПроцедура СортироватьДанныеФормыКоллекция(КоллекцияСтрок, КолонкаСортировки, ПоВозрастанию = Истина)\r\n    \r\n    ПараметрыЗначений     = Новый Соответствие;\r\n    СортированныеЗначения = Новый СписокЗначений;\r\n    \r\n    Для Каждого ТекущаяСтрока Из КоллекцияСтрок Цикл\r\n        \r\n        ТекущееЗначение = ТекущаяСтрока[КолонкаСортировки];\r\n        \r\n        ПараметрыЗначения = ПараметрыЗначений.Получить(ТекущееЗначение);\r\n        \r\n        Если ПараметрыЗначения = Неопределено Тогда\r\n            \r\n            ПараметрыЗначения = Новый Массив;\r\n            ПараметрыЗначений.Вставить(ТекущееЗначение, ПараметрыЗначения);\r\n            СортированныеЗначения.Добавить(ТекущееЗначение);\r\n            \r\n        КонецЕсли;\r\n        \r\n        ПараметрыЗначения.Добавить(ТекущаяСтрока);\r\n        \r\n    КонецЦикла;\r\n    \r\n    СортированныеЗначения.СортироватьПоЗначению(?(ПоВозрастанию, НаправлениеСортировки.Возр, НаправлениеСортировки.Убыв));\r\n    НовыйИндекс = 0;\r\n    \r\n    Для Каждого ТекущееЗначение Из СортированныеЗначения Цикл\r\n        \r\n        МассивСтрок = ПараметрыЗначений.Получить(ТекущееЗначение.Значение);\r\n        \r\n        Для Каждого ТекущаяСтрока Из МассивСтрок Цикл\r\n            \r\n            ТекущийИндекс = КоллекцияСтрок.Индекс(ТекущаяСтрока);\r\n            ШагСдвига     = НовыйИндекс - ТекущийИндекс;\r\n            \r\n            Если НЕ ШагСдвига = 0 Тогда\r\n                \r\n                КоллекцияСтрок.Сдвинуть(ТекущийИндекс, ШагСдвига);\r\n                \r\n            КонецЕсли;\r\n            \r\n            НовыйИндекс = НовыйИндекс + 1;\r\n            \r\n        КонецЦикла;\r\n        \r\n    КонецЦикла;\r\n    \r\nКонецПроцедуры"
  },
  {
    "title": "СоздатьЭлементФормы",
    "description": "СоздатьЭлементФормы",
    "code_snippet": "Функция СоздатьЭлементФормы(Форма, ИмяЭлемента, ТипЭлемента, РодительЭлемента, ЭлементПеред = Неопределено) Экспорт\r\n\t\r\n\tЕсли ЭлементПеред = Неопределено Тогда\r\n\t\tНовыйЭлемент = Форма.Элементы.Добавить(ИмяЭлемента, ТипЭлемента, РодительЭлемента);\r\n\tИначе\r\n\t\tНовыйЭлемент = Форма.Элементы.Вставить(ИмяЭлемента, ТипЭлемента, РодительЭлемента, ЭлементПеред);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат НовыйЭлемент;\r\n\t\r\nКонецФункции\n\nФункция СоздатьЭлементФормы(Форма, ИмяЭлемента, ТипЭлемента, РодительЭлемента, ЭлементПеред = Неопределено) Экспорт\r\n\t\r\n\tЕсли ЭлементПеред = Неопределено Тогда\r\n\t\tНовыйЭлемент = Форма.Элементы.Добавить(ИмяЭлемента, ТипЭлемента, РодительЭлемента);\r\n\tИначе\r\n\t\tНовыйЭлемент = Форма.Элементы.Вставить(ИмяЭлемента, ТипЭлемента, РодительЭлемента, ЭлементПеред);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат НовыйЭлемент;\r\n\t\r\nКонецФункции\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "Шаблон данных для печатных форм ЗУП",
    "description": "Шаблон данных для печатных форм ЗУП",
    "code_snippet": "//---------- Сбор Данных ----------//\r\n&НаСервере\r\nФункция ПолучитьДанные(ОбъектНаПечать, Отказ, ТекстОшибокОтказ, Документ = Неопределено)\r\n\t\r\n\tЕсли ТипЗнч(ОбъектнаПечать) = Тип(\"СправочникСсылка.Сотрудники\") Тогда\r\n\t\tСотрудник = ОбъектнаПечать;\r\n\tИначе\t\r\n\t\tСотрудник = ОбъектнаПечать.Сотрудник;\r\n\tКонецЕсли;\r\n \r\n\tОшибки = \"\";\r\n\t\r\n\tЕсли НЕ ЗначениеЗаполнено(Сотрудник.ФизическоеЛицо) Тогда\r\n\t\tТекстОшибокОтказ = ТекстОшибокОтказ + (\"Требуется указать физическое лицо сотруднику\") + Символы.ПС; \r\n\t\tОтказ = Истина;\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\tСтруктура = Новый Структура;\r\n\t\r\n\t//-------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"ДатаАктуальностиДанных\",\tТекущаяДатаСеанса());\t\t// Специальный параметр для получения данных\r\n\t\r\n\t//Получаем общие данные\r\n\tПолучитьОбщиеДанные(Структура, Ошибки);\r\n\t\r\n\t//Получаем всю необходимую информацию по сотруднику\r\n\tПолучитьДанныеСотрудника(Сотрудник, Структура, Ошибки);\r\n\t\r\n\t//Получаем все данные организации \r\n\tОрганизация = ОпределитьОрганизацию(Сотрудник, Документ); \r\n\tПолучитьДанныеОрганизации(Организация, Структура, Ошибки);\r\n\t\r\n\t//Получаем кадровые данные сотрудника\r\n\tПолучитьКадровыеДанныеСотрудника(Сотрудник, Структура, Ошибки);\r\n\t\r\n\t//Получить общие данные документа\r\n\tЕсли ЗначениеЗаполнено(Документ) Тогда\r\n\t\tПолучитьОбщиеДанныеДокумента(Документ, Структура, Ошибки);\r\n\tКонецЕсли;\r\n\r\n\t//-------------------------------------------------------------------------//\r\n\t\r\n\t//Получить данные документа \"Прием на работу\"\r\n\tЕсли ЗначениеЗаполнено(Документ) И ТипЗнч(Документ) = Тип(\"ДокументСсылка.ПриемНаРаботу\") Тогда\r\n\t\tПолучитьДанныеПримемаНаРаботу(Документ, Структура, Ошибки);\t\r\n\tИначе\r\n\t\tЕсли Структура.Свойство(\"ПриказОприеме\") И Структура.ПриказОПриеме <> Неопределено Тогда\r\n\t\t\tПолучитьДанныеПримемаНаРаботу(Структура.ПриказОПриеме, Структура, Ошибки);\r\n\t\t\tСтруктура.ПриказОПриеме = \" \";\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\n\t//Получить данные документа \"ГПХ\"\r\n\tЕсли ЗначениеЗаполнено(Документ) И ТипЗнч(Документ) = Тип(\"ДокументСсылка.ДоговорРаботыУслуги\") Тогда\r\n\t\tПолучитьДанныеГПХ(Документ, Структура, Ошибки);\t\r\n\tКонецЕсли;\r\n\t\r\n\t//-------------------------------------------------------------------------//\r\n\t\r\n\t//Дополняем дополнительными данными клиента\r\n\tЗаполнитьДополнительныеДанные(Сотрудник, Документ, Структура, Ошибки);\r\n\r\n\t//-------------------------------------------------------------------------//\r\n\t\r\n\tЕсли ЗначениеЗаполнено(Ошибки) Тогда\r\n\t\tСообщить(Ошибки);\r\n\tКонецЕсли; \r\n\t\r\n\tВозврат Структура;\r\n\t\r\nКонецФункции   \r\n\r\n&НаСервере\r\nПроцедура ПолучитьОбщиеДанные(Структура, Ошибки)\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"ТекущаяДатаД\", \t\t\t\t\"«_____» ___________ 20__ г.\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ТекущаяДатаДД\", \t\t\t\"«_____» ___________ 20__ г.\");\t// 1 января 2005 г.\r\n\tСтруктура.Вставить(\"ТекущийГод\",\t\t\t\t\"20__ г.\");  \t\t\t\t\t// 2005\r\n    //--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\tСтруктура.ТекущаяДатаД\t\t= Формат(ТекущаяДата(), \"ДЛФ=Д\");\t// 01.01.2005\r\n\tСтруктура.ТекущаяДатаДД \t= Формат(ТекущаяДата(), \"ДЛФ=ДД\");\t// 1 января 2005 г.\r\n\tСтруктура.ТекущийГод \t\t= Формат(ТекущаяДата(), \"ДФ=гггг\");  // 2005\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ПолучитьДанныеСотрудника(Сотрудник, Структура, Ошибки)\r\n\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"ФИО\", \t\t\t\t\t\t\"_____________________\");\t// Иванов Иван Иванович\r\n\tСтруктура.Вставить(\"ФИОСклРодительный\", \t\t\"_____________________\");\t// Иванова Ивана Ивановича\r\n\tСтруктура.Вставить(\"ФИОСклДательный\", \t\t\t\"_____________________\");\t// Иванову Ивану Ивановичу\r\n\tСтруктура.Вставить(\"ФИОСклВинительный\", \t\t\"_____________________\");\t// Иванова Ивана Ивановича\r\n\tСтруктура.Вставить(\"ФИОСклТворительный\", \t\t\"_____________________\");\t// Ивановым Иваном Ивановичем\r\n\tСтруктура.Вставить(\"ФИОСклПредложный\", \t\t\t\"_____________________\");\t// Иванове Иване Ивановиче\r\n\t\r\n\tСтруктура.Вставить(\"ФамилияИнициалы\", \t\t\t\"_____________________\");\t// Михейцева Н. А. \r\n\tСтруктура.Вставить(\"ФамилияИнициалыРод\",\t\t\"_____________________\");   // Михейцевой Н. А.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыДат\",\t\t\"_____________________\");   // Михейцевой Н. А.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыВин\",\t\t\"_____________________\");\t// Михейцеву Н. А.  \r\n\tСтруктура.Вставить(\"ФамилияИнициалыТвор\",\t\t\"_____________________\");   // Михейцевой Н. А.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыПред\",\t\t\"_____________________\");   // Михейцевой Н. А.   \r\n\t\r\n\tСтруктура.Вставить(\"ИнициалыФамилия\", \t\t\t\"_____________________\");\t// Н. А. Михейцева  \r\n\tСтруктура.Вставить(\"ИнициалыФамилияРод\",\t\t\"_____________________\");   // Н. А. Михейцевой\r\n\tСтруктура.Вставить(\"ИнициалыФамилияДат\",\t\t\"_____________________\");   // Н. А. Михейцевой\r\n\tСтруктура.Вставить(\"ИнициалыФамилияВин\",\t\t\"_____________________\");\t// Н. А. Михейцеву \r\n\tСтруктура.Вставить(\"ИнициалыФамилияТвор\",\t\t\"_____________________\");   // Н. А. Михейцевой\r\n\tСтруктура.Вставить(\"ИнициалыФамилияПред\",\t\t\"_____________________\");   // Н. А. Михейцевой\r\n\t\t\t\r\n\tСтруктура.Вставить(\"ТелефонМобильныйСотрудника\",\"___________\"); \t\t\t// 88005553535\r\n\tСтруктура.Вставить(\"EmailСотрудника\",\t\t\t\"___________\"); \t\t\t// example@mail.ru\t \r\n\tСтруктура.Вставить(\"ИННСотрудника\",\t\t\t\t\"_____________________\");\t//123456789012\r\n\tСтруктура.Вставить(\"СнилсСотрудника\",\t\t\t\"_____________________\");\t// 123-456-789 00\r\n    \r\n\tСтруктура.Вставить(\"ДокументПредставление\",\t\t\t\t\"__________________________________________\"); \t// Паспорт гражданина РФ, серия: 12 34, № 111126, выдан: 01 января 2000 года, ПВР №1\r\n\tСтруктура.Вставить(\"ДокументСерия\",\t\t\t\t\t\t\"__________________________________________\"); \t// 12 34\r\n    Структура.Вставить(\"ДокументНомер\",\t\t\t\t\t\t\"__________________________________________\"); \t// 56789\r\n    Структура.Вставить(\"КемВыдан\",\t\t\t\t\t\t\t\"__________________________________________\"); \t// ПВР №1 \r\n    Структура.Вставить(\"КодПодразделения\",\t\t\t\t\t\"__________________________________________\"); \t// 650-001 \r\n\tСтруктура.Вставить(\"ДатаВыдачиД\",\t\t\t\t\t\t\"__________________________________________\"); \t// 01.01.2005 \r\n\tСтруктура.Вставить(\"ДатаВыдачиДД\",\t\t\t\t\t\t\"__________________________________________\"); \t// 1 января 2005 г. \r\n\t\r\n\tСтруктура.Вставить(\"Страна\",\t\t\t\t\t\t\t\"____________\"); \t\t\t\t\t\t\t\t// Россия \r\n\r\n\tСтруктура.Вставить(\"АдресПоПропискеПредставление\",\t\t\"__________________________________________\"); \t// РОССИЯ, 105122, Москва г, Амурская ул, дом № 1, квартира 2\r\n\tСтруктура.Вставить(\"АдресПроживанияСотрудника\",\t\t\t\"__________________________________________\"); \t// РОССИЯ, 105122, Москва г, Амурская ул, дом № 1, квартира 2\r\n\t\r\n\tСтруктура.Вставить(\"ДатаРожденияСотрудникаД\",\t\t\t\"«_____» ___________ 20__ г.\"); \t\t\t\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаРожденияСотрудникаДД\",\t\t\t\"«_____» ___________ 20__ г.\");\t\t\t\t\t// 1 января 2005 г.\t\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\t// Удостоверение личности\r\n\tУдостоверенияЛичности = Неопределено;\r\n\tДокументыСотрудника = КадровыйУчет.ДокументыФизическихЛиц(Сотрудник.ФизическоеЛицо, Истина); \r\n\tЕсли ДокументыСотрудника.Количество() > 0 Тогда \r\n\t\t\r\n\t\tПриоритетВидовДокумента = Новый Массив();\r\n\t\tПриоритетВидовДокумента.Добавить(Справочники.ВидыДокументовФизическихЛиц.ПаспортРФ);\r\n\t\tПриоритетВидовДокумента.Добавить(Справочники.ВидыДокументовФизическихЛиц.НайтиПоНаименованию(\"Иностранный паспорт\"));\r\n\t\t\r\n\t\tДля каждого ВидДокумента из ПриоритетВидовДокумента Цикл \r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(ВидДокумента) Тогда Продолжить КонецЕсли;\r\n\t\t\tОтбор = Новый Структура(\"ВидДокумента\", ВидДокумента);\r\n\t\t\tНайденныеДокументы = ДокументыСотрудника.НайтиСтроки(Отбор);\r\n\t\t\tЕсли НайденныеДокументы.Количество() > 0 Тогда\r\n\t\t\t\tУдостоверенияЛичности = НайденныеДокументы[0];\r\n\t\t\t\tПрервать;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;   \r\n\t\t\r\n\t\tЕсли УдостоверенияЛичности = неопределено Тогда\r\n\t\t\tУдостоверенияЛичности = ДокументыСотрудника[0];\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\n    ДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, \r\n\t\tОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Сотрудник), \r\n\t\t\"АдресМестаПроживания, АдресМестаПроживанияПредставление, АдресПоПрописке, АдресПоПропискеПредставление, Страна,\r\n\t\t| ТелефонМобильныйПредставление, ТелефонДомашнийПредставление, ТелефонРабочий, ТелефонРабочийПредставление, EMail, EMailПредставление\", ТекущаяДата())[0];\r\n\r\n\t\t\r\n\t//Общие\r\n\tСтруктура.ФИО\t\t\t\t\t\t= Сотрудник.Наименование;\r\n\tСтруктура.ФИОСклРодительный\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.Наименование, 2, Сотрудник.ФизическоеЛицо.Пол);\t//Иванова Ивана Ивановича\r\n\tСтруктура.ФИОСклДательный\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.Наименование, 3, Сотрудник.ФизическоеЛицо.Пол);\t//Иванову Ивану Ивановичу\r\n\tСтруктура.ФИОСклВинительный\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.Наименование, 4, Сотрудник.ФизическоеЛицо.Пол);\t//Иванова Ивана Ивановича\r\n\tСтруктура.ФИОСклТворительный\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.Наименование, 5, Сотрудник.ФизическоеЛицо.Пол);\t//Ивановым Иваном Ивановичем\r\n\tСтруктура.ФИОСклПредложный\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.Наименование, 6, Сотрудник.ФизическоеЛицо.Пол);\t//Иванове Иване Ивановиче\r\n\t\r\n\tСтруктура.ФамилияИнициалы\t\t\t= Сотрудник.ФизическоеЛицо.Фамилия + \" \" +Сотрудник.ФизическоеЛицо.Инициалы; \r\n\tСтруктура.ФамилияИнициалыРод\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 2, Сотрудник.ФизическоеЛицо.Пол) + \" \" + Сотрудник.ФизическоеЛицо.Инициалы;\r\n\tСтруктура.ФамилияИнициалыДат\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 3, Сотрудник.ФизическоеЛицо.Пол) + \" \" + Сотрудник.ФизическоеЛицо.Инициалы;\r\n\tСтруктура.ФамилияИнициалыВин\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 4, Сотрудник.ФизическоеЛицо.Пол) + \" \" + Сотрудник.ФизическоеЛицо.Инициалы;\r\n\tСтруктура.ФамилияИнициалыТвор\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 5, Сотрудник.ФизическоеЛицо.Пол) + \" \" + Сотрудник.ФизическоеЛицо.Инициалы;\r\n\tСтруктура.ФамилияИнициалыПред\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 6, Сотрудник.ФизическоеЛицо.Пол) + \" \" + Сотрудник.ФизическоеЛицо.Инициалы; \r\n\t\r\n\tСтруктура.ИнициалыФамилия\t\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + Сотрудник.ФизическоеЛицо.Фамилия; \r\n\tСтруктура.ИнициалыФамилияРод\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 2, Сотрудник.ФизическоеЛицо.Пол);\r\n\tСтруктура.ИнициалыФамилияДат\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 3, Сотрудник.ФизическоеЛицо.Пол);\r\n\tСтруктура.ИнициалыФамилияВин\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 4, Сотрудник.ФизическоеЛицо.Пол);\r\n\tСтруктура.ИнициалыФамилияТвор\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 5, Сотрудник.ФизическоеЛицо.Пол);\r\n\tСтруктура.ИнициалыФамилияПред\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 6, Сотрудник.ФизическоеЛицо.Пол);\r\n\t\r\n\t\r\n\t//ТелефонМобильныйСотрудника\r\n\tЕсли ЗначениеЗаполнено(ДанныеСотрудника.ТелефонМобильныйПредставление) Тогда\r\n\t\tСтруктура.ТелефонМобильныйСотрудника = ДанныеСотрудника.ТелефонМобильныйПредставление;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не заполнен Мобильный телефон у сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\t\r\n\t//EmailСотрудника\r\n\tЕсли ЗначениеЗаполнено(ДанныеСотрудника.EMAILПРЕДСТАВЛЕНИЕ) Тогда\r\n\t\tСтруктура.EmailСотрудника = ДанныеСотрудника.EMAILПРЕДСТАВЛЕНИЕ;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не заполнен Email у сотрудника\" + Символы.ПС;\r\n\tКонецЕсли;\r\n\t\t\r\n\t//ИННСотрудника\r\n\tЕсли ЗначениеЗаполнено(Сотрудник.ФизическоеЛицо.ИНН) Тогда\r\n\t\tСтруктура.ИННСотрудника = Сотрудник.ФизическоеЛицо.ИНН;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не заполнен ИНН у сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\t\r\n\t//СнилсСотрудника\r\n\tЕсли ЗначениеЗаполнено(Сотрудник.ФизическоеЛицо.СтраховойНомерПФР) Тогда\r\n\t\tСтруктура.СнилсСотрудника = Сотрудник.ФизическоеЛицо.СтраховойНомерПФР;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не заполнен СНИЛС у сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\r\n\t\r\n\tЕсли ЗначениеЗаполнено(УдостоверенияЛичности) Тогда\r\n\t\t\r\n\t\t//ДокументПредставление\r\n\t\tЕсли ЗначениеЗаполнено(УдостоверенияЛичности.Представление) Тогда\r\n\t\t\tСтруктура.ДокументПредставление = УдостоверенияЛичности.Представление;\r\n\t\t\tСтруктура.ДокументСерия = УдостоверенияЛичности.Серия;\r\n\t\t\tСтруктура.ДокументНомер = УдостоверенияЛичности.Номер;\r\n\t\t\tСтруктура.КемВыдан \t\t= УдостоверенияЛичности.КемВыдан;\r\n\t\t\tСтруктура.КодПодразделения = УдостоверенияЛичности.КодПодразделения; \r\n\t\t\tСтруктура.ДатаВыдачиД \t= Формат(УдостоверенияЛичности.ДатаВыдачи, \"ДЛФ=Д\"); \r\n\t\t\tСтруктура.ДатаВыдачиДД \t= Формат(УдостоверенияЛичности.ДатаВыдачи, \"ДЛФ=ДД\"); \t\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить паспортные данные сотрудника\" + Символы.ПС;\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t// Страна\r\n\tЕсли ЗначениеЗаполнено(ДанныеСотрудника.Страна) Тогда\r\n\t\tСтруктура.Страна = Строка(ДанныеСотрудника.Страна);\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить Страну сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\t\r\n\t// Адрес по прописке\r\n\tЕсли ЗначениеЗаполнено(ДанныеСотрудника.АДРЕСПОПРОПИСКЕПРЕДСТАВЛЕНИЕ) Тогда\r\n\t\tСтруктура.АдресПоПропискеПредставление = Строка(ДанныеСотрудника.АДРЕСПОПРОПИСКЕПРЕДСТАВЛЕНИЕ);\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить Адрес по прописке сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\r\n\t//ДатаРожденияСотрудникаД и ДД\r\n\tЕсли ЗначениеЗаполнено(ДанныеСотрудника.ФизическоеЛицо.ДатаРождения) Тогда\r\n\t\tСтруктура.ДатаРожденияСотрудникаД\t\t\t= Формат(ДанныеСотрудника.ФизическоеЛицо.ДатаРождения, \"ДЛФ=Д\"); // 01.01.2005\r\n\t\tСтруктура.ДатаРожденияСотрудникаДД\t\t\t= Формат(ДанныеСотрудника.ФизическоеЛицо.ДатаРождения, \"ДЛФ=ДД\");// 1 января 2005 г.\t\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату рождения сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры   \r\n\r\n&НаСервере\r\nПроцедура ПолучитьДанныеОрганизации(Организация, Структура, Ошибки)  \r\n\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"Организация\",\t\t\t\t\t\"\");\t\t\t\t\t\t// Ссылка Крон-Ц. Филиал в г. Калининград\r\n\tСтруктура.Вставить(\"ОрганизацияНаименование\", \t\t\"_______________________\"); // Крон-Ц. Филиал в г. Калининград\r\n\tСтруктура.Вставить(\"ОрганизацияНаименованиеПолное\", \"_______________________\"); // Открытое акционерное общество \"Крон-Ц\". Филиал в г. Калининград\r\n\tСтруктура.Вставить(\"ОрганизацияНаименованиеСокр\", \t\"_______________________\"); // ОАО \"Крон-Ц\". Филиал в г. Калининград\r\n\t\r\n\tСтруктура.Вставить(\"ИННОрг\",\t\t\t\t\t\t\"_______________\"); \t// 500100732259\r\n\tСтруктура.Вставить(\"КППОрг\",\t\t\t\t\t\t\"_______________\"); \t// 773301001\r\n\tСтруктура.Вставить(\"ОГРНОрг\",\t\t\t\t\t\t\"_______________\"); \t// 1117746358608\r\n\t\r\n\tСтруктура.Вставить(\"ТелОрганизации\",\t\t       \t\"+7-___-___-____.\"); \t// +7-800-555-3535.\r\n\tСтруктура.Вставить(\"Имейл\",\t\t       \t\t\t\t\"\"); \t\t\t\t\t// example@mail.com\r\n\tСтруктура.Вставить(\"ЮрАдресОргПредставление\",\t\t\"_______________________________\"); \t// 127083, Москва г, ул 8 Марта, д. 4   \r\n\tСтруктура.Вставить(\"ФактАдресОрганизации\",\t\t\t\"_______________________________\"); \t// 127083, Москва г, ул 8 Марта, д. 4   \r\n\t\r\n\tСтруктура.Вставить(\"ФиоРукИменительный\", \t\t\"_____________________\");\t// Иванов Иван Иванович\r\n\tСтруктура.Вставить(\"ФиоРукРодительный\", \t\t\"_____________________\");\t// Иванова Ивана Ивановича\r\n\tСтруктура.Вставить(\"ФиоРукДательный\",\t\t\t\"_____________________\");\t// Иванову Ивану Ивановичу\r\n\tСтруктура.Вставить(\"ФиоРукВинительный\", \t\t\"_____________________\");\t// Иванова Ивана Ивановича\r\n\tСтруктура.Вставить(\"ФиоРукТворительный\", \t\t\"_____________________\");\t// Ивановым Иваном Ивановичем\r\n\tСтруктура.Вставить(\"ФиоРукПредложный\", \t\t\t\"_____________________\");\t// Иванове Иване Ивановиче\r\n\t\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРук\", \t\t\"_____________________\");\t// Иванов И. И.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРукРод\",\t\t\"_____________________\");   // Иванова И. И.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРукДат\",\t\t\"_____________________\");   // Иванову И. И.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРукВин\",\t\t\"_____________________\");   // Иванова И. И.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРукТвор\",\t\"_____________________\");   // Ивановым И. И.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРукПред\",\t\"_____________________\");   // Иванове И. И.\r\n\t\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРук\",\t\t\"_____________________\");\t// И. И. Иванов\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРукРод\",\t\t\"_____________________\");\t// И. И. Иванова\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРукДат\",\t\t\"_____________________\");\t// И. И. Иванову\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРукВин\",\t\t\"_____________________\");\t// И. И. Иванова\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРукТвор\",\t\"_____________________\");\t// И. И. Ивановым\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРукПрод\",\t\"_____________________\");\t// И. И. Иванове\r\n\t\r\n\tСтруктура.Вставить(\"ДолжностьРуководителя\", \t\t\"_____________________\"); // Генеральный директор \r\n\tСтруктура.Вставить(\"ДолжностьРуководителяРод\",\t\t\"_____________________\"); // Генерального директора\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяДат\",\t\t\"_____________________\"); // Генеральному директору \r\n\tСтруктура.Вставить(\"ДолжностьРуководителяВин\",\t\t\"_____________________\"); // Генеральном директоре\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяТвор\",\t\t\"_____________________\"); // Генерального директора\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяПред\",\t\t\"_____________________\"); // Генеральным директором  \r\n\t\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяНРег\", \t\t\"_____________________\"); // генеральный директор \r\n\tСтруктура.Вставить(\"ДолжностьРуководителяРодНРег\",\t\t\"_____________________\"); // генерального директора\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяДатНРег\",\t\t\"_____________________\"); // генеральному директору \r\n\tСтруктура.Вставить(\"ДолжностьРуководителяВинНРег\",\t\t\"_____________________\"); // генеральном директоре\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяТворНРег\",\t\t\"_____________________\"); // генерального директора\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяПредНРег\",\t\t\"_____________________\"); // генеральным директором\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\tЕсли ЗначениеЗаполнено(Организация) Тогда \r\n\t\tСписокПОказателей = Новый Массив;\r\n\t\tСписокПоказателей.Добавить(\"ДолжнРук\");\r\n\t\tСписокПоказателей.Добавить(\"ИННЮЛ\");\r\n\t\tСписокПоказателей.Добавить(\"КППЮЛ\");\r\n\t\tСписокПоказателей.Добавить(\"ОГРН\");\r\n\t\tСписокПоказателей.Добавить(\"РукСсылка\");\r\n\t\tСписокПоказателей.Добавить(\"ТелОрганизации\");\r\n        СписокПоказателей.Добавить(\"АдресЭлектроннойПочтыОрганизации\");\r\n\r\n\t\tСведенияОбОрганизации = ЗарплатаКадрыБазовый.ПолучитьСведенияОбОрганизации(Организация, ТекущаяДата(), СписокПОказателей); \r\n\t\t\r\n\t\tСтруктура.Организация\t\t\t\t\t\t= Организация.Ссылка;\r\n\t\tСтруктура.ОрганизацияНаименование\t\t\t= Организация.Наименование;\r\n\t\tСтруктура.ОрганизацияНаименованиеПолное\t\t= Организация.НаименованиеПолное;\r\n\t\tСтруктура.ОрганизацияНаименованиеСокр\t\t= Организация.НаименованиеСокращенное;\r\n\t\t\r\n\t\tСтруктура.ИННОрг\t\t\t= Организация.Инн;\r\n\t\tСтруктура.КППОрг\t\t\t= ?(Организация.Метаданные().Реквизиты.Найти(\"КПП\") = Неопределено, СведенияОбОрганизации.КППЮЛ, Организация.Кпп);\r\n\t\tСтруктура.ОГРНОрг\t\t\t= Организация.ОГРН;\r\n\t\t\r\n\t\t//ТелОрганизации\r\n\t\tЕсли ЗначениеЗаполнено(СведенияОбОрганизации.ТелОрганизации) Тогда\r\n\t\t\tСтруктура.ТелОрганизации = СведенияОбОрганизации.ТелОрганизации;\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить телефон организации\" + Символы.ПС;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//Имейл\r\n\t\tЕсли ЗначениеЗаполнено(СведенияОбОрганизации.АдресЭлектроннойПочтыОрганизации) Тогда\r\n\t\t\tСтруктура.Имейл = СведенияОбОрганизации.АдресЭлектроннойПочтыОрганизации;\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить имейл организации\" + Символы.ПС;\r\n\t\tКонецЕсли;\r\n\r\n\t\t\r\n\t\t//ЮрАдресОргПредставление\r\n\t\tЕсли ЗначениеЗаполнено(Организация) Тогда\r\n\t\t\tЮрАдресОргПредставление = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияОбъекта(Организация, Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации, ТекущаяДатаСеанса(), Истина);\r\n\t\t\tСтруктура.ЮрАдресОргПредставление = ?(ЗначениеЗаполнено(ЮрАдресОргПредставление), ЮрАдресОргПредставление, Структура.ЮрАдресОргПредставление);\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить юридический адрес организации\" + Символы.ПС;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//ФактАдресОрганизации\r\n\t\tЕсли ЗначениеЗаполнено(Организация) Тогда\r\n\t\t\tФактАдресОрганизации = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияОбъекта(Организация, Справочники.ВидыКонтактнойИнформации.ФактАдресОрганизации, ТекущаяДатаСеанса(), Истина);\r\n\t\t\tСтруктура.ФактАдресОрганизации = ?(ЗначениеЗаполнено(ФактАдресОрганизации), ФактАдресОрганизации, Структура.ФактАдресОрганизации);\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить Фактический адрес организации\" + Символы.ПС;\r\n\t\tКонецЕсли;\r\n\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(СведенияОбОрганизации.РукСсылка) Тогда\r\n\t\t\tРуководительОрганизации = СведенияОбОрганизации.РукСсылка; \r\n\t\tИначе\r\n\t\t\tОшибки = Ошибки + \"Не удалось определить руководителя организации\" + Символы.ПС;\t\r\n\t\tКонецЕсли;\r\n\t\r\n\t\tЕсли ЗначениеЗаполнено(РуководительОрганизации) Тогда\r\n\t\t\r\n\t\t\tСтруктура.ФиоРукИменительный\t\t\t= РуководительОрганизации.Наименование;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Иванов Иван Иванович\r\n\t\t\tСтруктура.ФиоРукРодительный\t\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Наименование, 2, РуководительОрганизации.Пол);\t// Иванова Ивана Ивановича\r\n\t\t\tСтруктура.ФиоРукДательный\t\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Наименование, 3, РуководительОрганизации.Пол);\t// Иванову Ивану Ивановичу\r\n\t\t\tСтруктура.ФиоРукВинительный\t\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Наименование, 4, РуководительОрганизации.Пол);\t// Иванова Ивана Ивановича\r\n\t\t\tСтруктура.ФиоРукТворительный\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Наименование, 5, РуководительОрганизации.Пол);\t// Ивановым Иваном Ивановичем\r\n\t\t\tСтруктура.ФиоРукПредложный\t\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Наименование, 6, РуководительОрганизации.Пол);\t// Иванове Иване Ивановиче\r\n\t\t\t\r\n\t\t\tСтруктура.ФамилияИнициалыРук\t\t\t= РуководительОрганизации.Фамилия + \" \" +РуководительОрганизации.Инициалы;\t\t\t\t\t\t\t\t\t\t// Иванов И. И.\r\n\t\t\tСтруктура.ФамилияИнициалыРукРод\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 2, РуководительОрганизации.Пол) + \" \" + РуководительОрганизации.Инициалы;\r\n\t\t\tСтруктура.ФамилияИнициалыРукДат\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 3, РуководительОрганизации.Пол) + \" \" + РуководительОрганизации.Инициалы;\r\n\t\t\tСтруктура.ФамилияИнициалыРукВин\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 4, РуководительОрганизации.Пол) + \" \" + РуководительОрганизации.Инициалы;\r\n\t\t\tСтруктура.ФамилияИнициалыРукТвор\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 5, РуководительОрганизации.Пол) + \" \" + РуководительОрганизации.Инициалы;\r\n\t\t\tСтруктура.ФамилияИнициалыРукПред\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 6, РуководительОрганизации.Пол) + \" \" + РуководительОрганизации.Инициалы;\r\n\t\t\t\r\n\t\t\tСтруктура.ИнициалыФамилияРук\t\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 1, РуководительОрганизации.Пол);\r\n\t\t\tСтруктура.ИнициалыФамилияРукРод\t\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 2, РуководительОрганизации.Пол);\r\n\t\t\tСтруктура.ИнициалыФамилияРукДат\t\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 3, РуководительОрганизации.Пол);\r\n\t\t\tСтруктура.ИнициалыФамилияРукВин\t\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 4, РуководительОрганизации.Пол);\r\n\t\t\tСтруктура.ИнициалыФамилияРукТвор\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 5, РуководительОрганизации.Пол);\r\n\t\t\tСтруктура.ИнициалыФамилияРукПрод\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 6, РуководительОрганизации.Пол);\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(СведенияОбОрганизации.ДолжнРук) Тогда\r\n\t\t\tСтруктура.ДолжностьРуководителя\t\t\t= СведенияОбОрганизации.ДолжнРук.Наименование;\r\n\t\t\tСтруктура.ДолжностьРуководителяРод\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(СведенияОбОрганизации.ДолжнРук, 2);\r\n\t\t\tСтруктура.ДолжностьРуководителяДат\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(СведенияОбОрганизации.ДолжнРук, 3);\r\n\t\t\tСтруктура.ДолжностьРуководителяВин\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(СведенияОбОрганизации.ДолжнРук, 4);\r\n\t\t\tСтруктура.ДолжностьРуководителяТвор\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(СведенияОбОрганизации.ДолжнРук, 5);\r\n\t\t\tСтруктура.ДолжностьРуководителяПред\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(СведенияОбОрганизации.ДолжнРук, 6);\r\n\t\t\t\r\n\t\t\tСтруктура.ДолжностьРуководителяНРег\t\t\t= НРег(Структура.ДолжностьРуководителя);\r\n\t\t\tСтруктура.ДолжностьРуководителяРодНРег\t\t= НРег(Структура.ДолжностьРуководителяРод);\r\n\t\t\tСтруктура.ДолжностьРуководителяДатНРег\t\t= НРег(Структура.ДолжностьРуководителяДат);\r\n\t\t\tСтруктура.ДолжностьРуководителяВинНРег\t\t= НРег(Структура.ДолжностьРуководителяВин);\r\n\t\t\tСтруктура.ДолжностьРуководителяТворНРег\t\t= НРег(Структура.ДолжностьРуководителяТвор);\r\n\t\t\tСтруктура.ДолжностьРуководителяПредНРег\t\t= НРег(Структура.ДолжностьРуководителяПред);\r\n\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить должность руководителя организации\" + Символы.ПС;\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить данные организации\" + Символы.ПС; \r\n\tКонецЕсли;\r\n\t\r\n\t\t\t\t\r\n\t\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ПолучитьКадровыеДанныеСотрудника(Сотрудник, Структура, Ошибки)\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------/\t\r\n\tСтруктура.Вставить(\"Должность\", \t\t\t\t\"_____________________\");\t// Эксперт\r\n\tСтруктура.Вставить(\"ДолжностьРод\",\t\t\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ДолжностьДат\",\t\t\t\t\"_____________________\");\t// Эксперту\r\n\tСтруктура.Вставить(\"ДолжностьВин\",\t\t\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ДолжностьТвор\",\t\t\t\t\"_____________________\"); \t// Экспертом\r\n\tСтруктура.Вставить(\"ДолжностьПред\",\t\t\t\t\"_____________________\");\t// Эксперте\r\n\t\r\n\tСтруктура.Вставить(\"ДолжностьШР\",\t \t\t\t\"_____________________\");\t// Эксперт\r\n\tСтруктура.Вставить(\"ДолжностьШРРод\",\t\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ДолжностьШРДат\",\t\t\t\"_____________________\");\t// Эксперту\r\n\tСтруктура.Вставить(\"ДолжностьШРВин\",\t\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ДолжностьШРТвор\",\t\t\t\"_____________________\"); \t// Экспертом\r\n\tСтруктура.Вставить(\"ДолжностьШРПред\",\t\t\t\"_____________________\");\t// Эксперте \r\n\t\r\n\tСтруктура.Вставить(\"ДолжностьИРазряд\",\t \t\t\"_____________________\");\t// Эксперт, 1 категория\r\n\tСтруктура.Вставить(\"ДолжностьИРазрядРод\",\t\t\"_____________________\");\t// Эксперта, 1 категории\r\n\tСтруктура.Вставить(\"ДолжностьИРазрядДат\",\t\t\"_____________________\");\t// Эксперту, 1 категории\r\n\tСтруктура.Вставить(\"ДолжностьИРазрядВин\",\t\t\"_____________________\");\t// Эксперта, 1 категории\r\n\tСтруктура.Вставить(\"ДолжностьИРазрядТвор\",\t\t\"_____________________\"); \t// Экспертом, 1 категории\r\n\tСтруктура.Вставить(\"ДолжностьИРазрядПред\",\t\t\"_____________________\");\t// Эксперте, 1 категории \r\n\t\r\n\tСтруктура.Вставить(\"ТекущаяДолжность\", \t\t\t\"_____________________\");\t// Эксперт\r\n\tСтруктура.Вставить(\"ТекущаяДолжностьРод\",\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ТекущаяДолжностьДат\",\t\t\"_____________________\");\t// Эксперту\r\n\tСтруктура.Вставить(\"ТекущаяДолжностьВин\",\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ТекущаяДолжностьТвор\",\t\t\"_____________________\"); \t// Экспертом\r\n\tСтруктура.Вставить(\"ТекущаяДолжностьПред\",\t\t\"_____________________\");\t// Эксперте\r\n\t\t\r\n\tСтруктура.Вставить(\"Подразделение\",\t\t\t\t\"_____________________\");\t// Служба безопасности \r\n\t\r\n\tСтруктура.Вставить(\"ПроцентСевернойНадбавки\",\t\t\"_______\");\t\t\t\t// 50 \r\n\tСтруктура.Вставить(\"РайонныйКоэффициент\",\t\t\t\"_______\");\t\t\t\t// 1,6\r\n\tСтруктура.Вставить(\"ПроцентРайонныйКоэффициент\",\t\"_______\");\t\t\t\t// 60%\r\n\tСтруктура.Вставить(\"ПроцентНадбавкиЗаВредность\",\t\"—\");\t\t\t\t\t// 4%\r\n\t\r\n\tСтруктура.Вставить(\"ТарифнаяСтавка\", \t\t\t\t\"________\");  \t\t\t// 102,00\r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаЧисло\", \t\t\t\"________\");  \t\t\t// 102,00\r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаНаПечать\",\t\t\"__________________\");  // 102 руб. 00 коп.\r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаПрописью\",\t\t\"__________________\");  // сто два рубля 00 коп.\r\n\t\r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаПочасоваяЧисло\",\t\"_______\");\t\t\t\t// \r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаПочасоваяНаПечать\",\"__________________\"); // 102 руб. 00 коп.\r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаПочасоваяПрописью\",\"__________________\"); // сто два рубля 00 коп.\r\n\t\r\n\tСтруктура.Вставить(\"ДатаПриемаД\",\t\t\t\t\t\"__________________\");  // 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаПриемаДД\",\t\t\t\t\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"ДатаУвольненияД\",\t\t\t\t\"__________________\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаУвольненияДД\",\t\t\t\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"НомерТрудовогоДоговора\",\t\t\"____\");\t\t\t\t// 182\r\n\tСтруктура.Вставить(\"ДатаТрудовогоДоговораД\",\t\t\"__________________\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаТрудовогоДоговораДД\",\t\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговора\",\tТекущаяДата());\t\t\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговораД\",\t\"__________________\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговораДД\",\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"ДатаОкончанияТрудовогоДоговораД\",\t\"__________________\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаОкончанияТрудовогоДоговораДД\",\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"СрокЗаключенияДоговора\",\t\t\t\"неопределенный срок\");\t\r\n\tСтруктура.Вставить(\"СрокЗаключенияДоговораОписание\",\t\"\"); //На время исполнения государственного контракта № 02-22-2 от 11.04.2022г.\t\r\n\tСтруктура.Вставить(\"ОснованиеСрочногоДоговора\",\t\t\t\"\");\r\n\t\r\n\tСтруктура.Вставить(\"ПродолжительностьРабочейНедели\",\t\"___\"); \t\t\t// 48\r\n\t\t\r\n\tСтруктура.Вставить(\"НомерПриказа\",\t\t\t\t\t\"____\");                // 182\r\n\tСтруктура.Вставить(\"ДатаПриказаД\",\t\t\t\t\t\"__________________\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаПриказаДД\",\t\t\t\t\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"ВидЗанятости\",\t\t\t\t\"_____________________\");\t// Основное место работы\r\n\tСтруктура.Вставить(\"ВидЗанятостиРод\",\t\t\t\"_____________________\");\t// Основного места работы\r\n    Структура.Вставить(\"ВидЗанятостиДат\",\t\t\t\"_____________________\");\t// Основному месту работы\r\n\tСтруктура.Вставить(\"ВидЗанятостиВин\",\t\t\t\"_____________________\");\t// Основное место работы\r\n\tСтруктура.Вставить(\"ВидЗанятостиТвор\",\t\t\t\"_____________________\");\t// Основным местом работы\r\n\tСтруктура.Вставить(\"ВидЗанятостиПред\",\t\t\t\"_____________________\");\t// об Основном месте работы\r\n\t\r\n\tСтруктура.Вставить(\"ОтпускОсновной\",\t\t\t\"___\");\t\t\t\t\t\t// 24\r\n\tСтруктура.Вставить(\"ОтпускЗаВредность\",\t\t\t\"___\");\t\t\t\t\t\t// 5 \r\n\tСтруктура.Вставить(\"ОтпускСеверные\",\t\t\t\"___\");\t\t\t\t\t\t// 18 \r\n\t\r\n\tСтруктура.Вставить(\"КоличествоСтавок\",\t\t\t\" - \"); // 1 / 0,5 / 0,25 - В зависимости от ставки\r\n\tСтруктура.Вставить(\"ДоляСтавки\", \t\t\t\t\" - \"); // на полную ставку / на 0,5 ставки / на 0,25 ставки \r\n\t\r\n\tСтруктура.Вставить(\"КлассУсловийСпецоценка\",\t\"\"); // Подкласс 3.1 класса условий труда \"вредный\"\r\n\t\r\n\t\r\n\tСтруктура.Вставить(\"БанкСотрудника\",\t\"\"); \t\t// Филиал № 2754 ВТБ (ПАО) \r\n\tСтруктура.Вставить(\"БанкИННСотрудника\",\t\"\"); \t\t// 7702070139 \r\n\tСтруктура.Вставить(\"БанкКППСотрудника\",\t\"\"); \t\t// 272143002 \r\n\tСтруктура.Вставить(\"БанкКорСчетСотрудника\",\t\"\"); \t// 30101810708130000713 \r\n\tСтруктура.Вставить(\"БанкБИКСотрудника\",\t\"\"); \t\t// 040813713 \r\n\tСтруктура.Вставить(\"БанкСчетСотрудника\",\"\");\t\t// 4**17*10**023**00**7\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\t\r\n\t\r\n\tКадровыеДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, \r\n    ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Сотрудник), \r\n    \"Организация,ФизическоеЛицо,ТабельныйНомер,Подразделение,Должность,ВидЗанятости,ДолжностьПоШтатномуРасписанию, ПроцентСевернойНадбавки, \r\n\t| ТарифнаяСтавка, ТекущаяТарифнаяСтавка, Надбавка, ДатаДоговораКонтракта, НомерДоговораКонтракта, ДатаНачала, ДатаОкончания, СрочныйДоговор, ОснованиеСрочногоДоговора, СрокЗаключенияДоговора, \r\n\t| КоличествоСтавок,ДатаПриема,ДатаУвольнения,ГрафикРаботы,СтатьяФинансирования, РазрядКатегория, ТекущаяДолжность, ПриказОПриеме, МестоВыплаты\", ТекущаяДата())[0];  \r\n\r\n\t\r\n\t// Заполняем параметр актуальности данных\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ПриказОПриеме) И \r\n\t\tЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаПриема) Тогда\r\n\t\tСтруктура.ДатаАктуальностиДанных = КадровыеДанныеСотрудника.ДатаПриема; \r\n\t\tДатаАктуальности = КонецДня(Структура.ДатаАктуальностиДанных);\r\n\tКонецЕсли;\r\n\t\r\n\t//Должность\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.Должность) Тогда\r\n\t\tСтруктура.Должность\t\t\t\t\t= КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование;\r\n\t\tСтруктура.ДолжностьРод\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.Должность.Наименование, 2);\r\n\t\tСтруктура.ДолжностьДат\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.Должность.Наименование, 3);\r\n\t\tСтруктура.ДолжностьВин\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.Должность.Наименование, 4);\r\n\t\tСтруктура.ДолжностьТвор\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.Должность.Наименование, 5);\r\n\t\tСтруктура.ДолжностьПред\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.Должность.Наименование, 6);\r\n\tКонецЕсли;\r\n\r\n\t//ДолжностьПоШтатномуРасписанию\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию) Тогда\t\r\n\t\tСтруктура.ДолжностьШР\t\t\t\t\t= КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование;\r\n\t\tСтруктура.ДолжностьШРРод\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Наименование, 2);\r\n\t\tСтруктура.ДолжностьШРДат\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Наименование, 3);\r\n\t\tСтруктура.ДолжностьШРВин\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Наименование, 4);\r\n\t\tСтруктура.ДолжностьШРТвор\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Наименование, 5);\r\n\t\tСтруктура.ДолжностьШРПред\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Наименование, 6);\r\n\tКонецЕсли; \r\n\t\r\n\t//Должность и разряд\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию) Тогда\r\n\t\tРазрядКатегория = КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.РазрядКатегория; \r\n\t\tЕсли ЗначениеЗаполнено(РазрядКатегория) Тогда\r\n\t\t\tСтруктура.ДолжностьИРазряд\t\t\t\t= КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t            + \", \" + РазрядКатегория.Наименование;\r\n\t\t\tСтруктура.ДолжностьИРазрядРод\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t\t\t\t+ \", \" + РазрядКатегория.Наименование, 2);\r\n\t\t\tСтруктура.ДолжностьИРазрядДат\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t\t\t\t+ \", \" + РазрядКатегория.Наименование, 3);\r\n\t\t\tСтруктура.ДолжностьИРазрядВин\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t\t\t\t+ \", \" + РазрядКатегория.Наименование, 4);\r\n\t\t\tСтруктура.ДолжностьИРазрядТвор\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t\t\t\t+ \", \" + РазрядКатегория.Наименование, 5);\r\n\t\t\tСтруктура.ДолжностьИРазрядПред\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t\t\t\t+ \", \" + РазрядКатегория.Наименование, 6);  \r\n\t\tИначе\r\n\t\t\tСтруктура.ДолжностьИРазряд\t\t\t\t= КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование;\r\n\t\t\tСтруктура.ДолжностьИРазрядРод\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование, 2);\r\n\t\t\tСтруктура.ДолжностьИРазрядДат\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование, 3);\r\n\t\t\tСтруктура.ДолжностьИРазрядВин\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование, 4);\r\n\t\t\tСтруктура.ДолжностьИРазрядТвор\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование, 5);\r\n\t\t\tСтруктура.ДолжностьИРазрядПред\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование, 6);\r\n\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t//ТекущаяДолжность\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ТекущаяДолжность) Тогда\r\n\t\tСтруктура.ТекущаяДолжность\t\t\t\t\t= КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование;\r\n\t\tСтруктура.ТекущаяДолжностьРод\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование, 2);\r\n\t\tСтруктура.ТекущаяДолжностьДат\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование, 3);\r\n\t\tСтруктура.ТекущаяДолжностьВин\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование, 4);\r\n\t\tСтруктура.ТекущаяДолжностьТвор\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование, 5);\r\n\t\tСтруктура.ТекущаяДолжностьПред\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование, 6);\r\n\tКонецЕсли; \r\n\t\r\n\t//Подразделение\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.Подразделение) Тогда\r\n\t\tСтруктура.Подразделение\t\t\t\t\t= КадровыеДанныеСотрудника.Подразделение.Наименование;\t\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить подразделение\" + Символы.ПС;\t\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t//Процент северной надбавки\r\n\tЕсли ЗначениеЗАполнено(КадровыеДанныеСотрудника.ПроцентСевернойНадбавки) Тогда\r\n\t\tСтруктура.ПроцентСевернойНадбавки = КадровыеДанныеСотрудника.ПроцентСевернойНадбавки;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить процент северной надбавки\" + Символы.ПС;\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t//Районный коэффициент\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ РАЗЛИЧНЫЕ\r\n\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Показатель КАК Показатель,\r\n\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Значение КАК Значение,\r\n\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.ДействуетДо КАК ДействуетДо,\r\n\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Организация КАК Организация\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудников.СрезПоследних(\r\n\t\t|\t\t\t&ТекДата,\r\n\t\t|\t\t\tПоказатель = &Показатель\r\n\t\t|\t\t\t\tИ Сотрудник = &Сотрудник) КАК ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних\";\r\n\t\r\n\tПопытка\r\n\t\t// Попытка сделана для разных версий ЗУП\r\n\t\tЗапрос.УстановитьПараметр(\"Показатель\", Справочники.ПоказателиРасчетаЗарплаты.РайонныйКоэффициент);\r\n\tИсключение\r\n\t\tЗапрос.УстановитьПараметр(\"Показатель\", Справочники.ПоказателиРасчетаЗарплаты.РайонныйКоэффициентРФ);\r\n    КонецПопытки;\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\tЗапрос.УстановитьПараметр(\"ТекДата\", ДатаАктуальности);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\tСтруктура.РайонныйКоэффициент = ВыборкаДетальныеЗаписи.Значение;\r\n\t\tСтруктура.ПроцентРайонныйКОэффициент = (ВыборкаДетальныеЗаписи.Значение - 1) * 100;\r\n\tКонецЦикла;\r\n\t\r\n\t//Надбавка за вредность\r\n\tЕсли ПолучитьФункциональнуюОпцию(\"ИспользоватьНадбавкуЗаВредность\") Тогда\r\n\t\tЗапрос = Новый Запрос;\r\n\t\tЗапрос.Текст = \r\n\t\t\t\"ВЫБРАТЬ РАЗЛИЧНЫЕ\r\n\t\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Показатель КАК Показатель,\r\n\t\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Значение КАК Значение,\r\n\t\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.ДействуетДо КАК ДействуетДо,\r\n\t\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Организация КАК Организация\r\n\t\t\t|ИЗ\r\n\t\t\t|\tРегистрСведений.ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудников.СрезПоследних(\r\n\t\t\t|\t\t\t&ТекДата,\r\n\t\t\t|\t\t\tПоказатель = &Показатель\r\n\t\t\t|\t\t\t\tИ Сотрудник = &Сотрудник) КАК ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних\";\r\n\t\t\r\n\t\tЗапрос.УстановитьПараметр(\"Показатель\", Справочники.ПоказателиРасчетаЗарплаты.ПроцентНадбавкиЗаВредность);\r\n\t\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\t\tЗапрос.УстановитьПараметр(\"ТекДата\", ДатаАктуальности);\r\n\t\t\r\n\t\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\t\r\n\t\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\t\r\n\t\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\t\tСтруктура.ПроцентНадбавкиЗаВредность = Строка(ВыборкаДетальныеЗаписи.Значение) + \"%\";\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\t//Тарифная ставка\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ТарифнаяСтавка) Тогда\r\n\t\tСтруктура.ТарифнаяСтавка = КадровыеДанныеСотрудника.ТарифнаяСтавка;\r\n\t\tСтруктура.ТарифнаяСтавкаЧисло = Формат(КадровыеДанныеСотрудника.ТарифнаяСтавка, \"ЧДЦ=2\");\r\n\t\tСтруктура.ТарифнаяСтавкаНаПечать = ЗарплатаКадрыОтчеты.ТарифнаяСтавкаНаПечать(КадровыеДанныеСотрудника.ТарифнаяСтавка, Истина);\r\n\t\tСтруктура.ТарифнаяСтавкаПрописью = РаботаСКурсамиВалют.СформироватьСуммуПрописью(КадровыеДанныеСотрудника.ТарифнаяСтавка, Справочники.Валюты.НайтиПоКоду(643));\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить тарифную ставку\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\t\r\n\t//Тарифная ставка почасовая\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Значение КАК Значение\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудников.СрезПоследних(\r\n\t\t|\t\t\t&ДатаПриема,\r\n\t\t|\t\t\tСотрудник = &Сотрудник\r\n\t\t|\t\t\t\tИ Организация = &Организация\r\n\t\t|\t\t\t\tИ Показатель = &Показатель) КАК ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ДатаПриема\", ДатаАктуальности);\t\r\n\tЗапрос.УстановитьПараметр(\"Организация\", Структура.Организация);\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\tЗапрос.УстановитьПараметр(\"Показатель\", Справочники.ПоказателиРасчетаЗарплаты.ТарифнаяСтавкаЧасовая);\r\n\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\tСтруктура.ТарифнаяСтавкаПочасоваяЧисло = Формат(ВыборкаДетальныеЗаписи.Значение, \"ЧДЦ=2\");\r\n\t\tСтруктура.ТарифнаяСтавкаПочасоваяНаПечать = ЗарплатаКадрыОтчеты.ТарифнаяСтавкаНаПечать(ВыборкаДетальныеЗаписи.Значение, Истина);\r\n\t\tСтруктура.ТарифнаяСтавкаПочасоваяПрописью = РаботаСКурсамиВалют.СформироватьСуммуПрописью(ВыборкаДетальныеЗаписи.Значение,\r\n\t\t\t\t\t\t\t\t\tСправочники.Валюты.НайтиПоКоду(643));\r\n\tКонецЦикла;\r\n\t\r\n\t\t\r\n\t//Дата приема на работу\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаПриема) Тогда\r\n\t\tСтруктура.ДатаПриемаД =\tФормат(КадровыеДанныеСотрудника.ДатаПриема, \"ДЛФ=Д\");\t// 01.01.2005   \r\n\t\tСтруктура.ДатаПриемаДД = Формат(КадровыеДанныеСотрудника.ДатаПриема, \"ДЛФ=ДД\");\t// 1 января 2005 г.\t\t\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату приема на работу сотрудника\" + Символы.ПС\t\r\n\tКонецЕсли; \r\n\t\r\n\t//Дата увольнения\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаУвольнения) Тогда\r\n\t\tСтруктура.ДатаУвольненияД = Формат(КадровыеДанныеСотрудника.ДатаУвольнения, \"ДЛФ=Д\");\t// 01.01.2005   \r\n\t\tСтруктура.ДатаУвольненияДД = Формат(КадровыеДанныеСотрудника.ДатаУвольнения, \"ДЛФ=ДД\");\t// 1 января 2005 г.\t\t\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату увольнения сотрудника\" + Символы.ПС\t\r\n\tКонецЕсли;\r\n\r\n\t\r\n\t\r\n\t//Трудовой договор номер\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.НомерДоговораКонтракта) Тогда\r\n\t\tСтруктура.Вставить(\"НомерТрудовогоДоговора\",\tКадровыеДанныеСотрудника.НомерДоговораКонтракта);\t// 182\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить номер договора сотрудника\" + Символы.ПС;\r\n\tКонецЕсли;\r\n\t\r\n\t//Трудовой договор Дата\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаДоговораКонтракта) Тогда\r\n\t\tСтруктура.Вставить(\"ДатаТрудовогоДоговораД\",\tФормат(КадровыеДанныеСотрудника.ДатаДоговораКонтракта, \"ДЛФ=Д\"));\t// 01.01.2005   \r\n\t\tСтруктура.Вставить(\"ДатаТрудовогоДоговораДД\",\tФормат(КадровыеДанныеСотрудника.ДатаДоговораКонтракта, \"ДЛФ=ДД\"));\t// 1 января 2005 г.\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату договора сотрудника\" + Символы.ПС;\r\n\tКонецЕсли; \r\n\r\n\t//Номер приказа и дата\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ПриказОПриеме) Тогда\r\n\t\tСтруктура.Вставить(\"ПриказОПриеме\",\tКадровыеДанныеСотрудника.ПриказОПриеме);\t\t\t\t\t// ссылка  \r\n\t\tСтруктура.Вставить(\"ПриказОПриемеНомер\",\tКадровыеДанныеСотрудника.ПриказОПриеме.Номер);\t\t// 0П00-000182  \r\n\t\tСтруктура.Вставить(\"ДатаПриказаД\",\tФормат(КадровыеДанныеСотрудника.ПриказОПриеме.Дата, \"ДЛФ=Д\"));\t// 01.01.2005   \r\n\t\tСтруктура.Вставить(\"ДатаПриказаДД\",\tФормат(КадровыеДанныеСотрудника.ПриказОПриеме.Дата, \"ДЛФ=ДД\"));\t// 1 января 2005 г.\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить приказ у сотрудника\" + Символы.ПС;\r\n\tКонецЕсли; \r\n\t\r\n\t//Дата начала трудового договора\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаНачала) Тогда\r\n\t\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговора\",\tКадровыеДанныеСотрудника.ДатаНачала);\t// 01.01.2005   \r\n\t\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговораД\",\tФормат(КадровыеДанныеСотрудника.ДатаНачала, \"ДЛФ=Д\"));\t// 01.01.2005   \r\n\t\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговораДД\",\tФормат(КадровыеДанныеСотрудника.ДатаНачала, \"ДЛФ=ДД\"));\t// 1 января 2005 г.\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату начала трудового договора у сотрудника\" + Символы.ПС;\r\n\tКонецЕсли;  \r\n\t\r\n\t//Дата окончания трудового договора\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаНачала) Тогда\r\n\t\tСтруктура.Вставить(\"ДатаОкончанияТрудовогоДоговораД\",\tФормат(КадровыеДанныеСотрудника.ДатаОкончания, \"ДЛФ=Д\"));\t// 01.01.2005   \r\n\t\tСтруктура.Вставить(\"ДатаОкончанияТрудовогоДоговораДД\",\tФормат(КадровыеДанныеСотрудника.ДатаОкончания, \"ДЛФ=ДД\"));\t// 1 января 2005 г.\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату окончания трудового договора у сотрудника\" + Символы.ПС;\r\n\tКонецЕсли; \r\n\t\r\n\t\r\n\t//Срок Заключения Договора\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.СрочныйДоговор) И КадровыеДанныеСотрудника.СрочныйДоговор Тогда\r\n\t\tСтруктура.СрокЗаключенияДоговора\t\t\t= \"Определенный срок\" + \" до \" + Структура.ДатаОкончанияТрудовогоДоговораДД;  \r\n\t\tСтруктура.СрокЗаключенияДоговораОписание\t= КадровыеДанныеСотрудника.СрокЗаключенияДоговора ;\r\n\t\tСтруктура.ОснованиеСрочногоДоговора \t\t= КадровыеДанныеСотрудника.ОснованиеСрочногоДоговора;\t\r\n\tКонецЕсли;\r\n\t\r\n\t//ПродолжительностьРабочейНедели\r\n\tЕсли ЗначениеЗАполнено(КадровыеДанныеСотрудника.ГрафикРаботы) Тогда\r\n\t\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ГрафикРаботы.ДлительностьРабочейНедели) Тогда\r\n\t\t\tСтруктура.ПродолжительностьРабочейНедели = КадровыеДанныеСотрудника.ГрафикРаботы.ДлительностьРабочейНедели;\t\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить продолжительность рабочей недели в графике\" + Символы.ПС;\t\t\t\r\n\t\tКонецЕсли;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить график работы в документе\" + Символы.ПС;\t\t\t\t\r\n\tКонецЕсли;\r\n\r\n\t//ВидЗанятости\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ВидЗанятости) Тогда\r\n\t\tСтруктура.ВидЗанятости\t\t\t\t\t= Строка(КадровыеДанныеСотрудника.ВидЗанятости);\r\n\t\tСтруктура.ВидЗанятостиРод\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(КадровыеДанныеСотрудника.ВидЗанятости), 2);\r\n\t\tСтруктура.ВидЗанятостиДат\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(КадровыеДанныеСотрудника.ВидЗанятости), 3);\r\n\t\tСтруктура.ВидЗанятостиВин\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(КадровыеДанныеСотрудника.ВидЗанятости), 4);\r\n\t\tСтруктура.ВидЗанятостиТвор\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(КадровыеДанныеСотрудника.ВидЗанятости), 5);\r\n\t\tСтруктура.ВидЗанятостиПред\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(КадровыеДанныеСотрудника.ВидЗанятости), 6);\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не заполнен вид занятости в документе\" + Символы.ПС;\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t// Оптуска\r\n\tЗаполнитьОтпускаИзРегистра(Структура, Сотрудник);\r\n\t\r\n\t// Количество ставок\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tКадроваяИсторияСотрудниковСрезПоследних.КоличествоСтавок КАК КоличествоСтавок\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.КадроваяИсторияСотрудников.СрезПоследних(&ДатаОкончания, Сотрудник = &Сотрудник) КАК КадроваяИсторияСотрудниковСрезПоследних\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ДатаОкончания\", ТекущаяДата());\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\tСтруктура.КоличествоСтавок = ВыборкаДетальныеЗаписи.КоличествоСтавок;\r\n\tКонецЦикла;\r\n\t\r\n\t// Доля ставки\r\n\tЕсли Структура.КоличествоСтавок = 1 Тогда\r\n\t\tСтруктура.ДоляСтавки = \"на полную ставку\";\r\n\tИначеЕсли Структура.КоличествоСтавок <> \" - \" Тогда\r\n\t\tСтруктура.ДоляСтавки = \" на \" + Структура.КоличествоСтавок + \" ставки\";\t\r\n\tКонецЕсли;    \r\n\t\r\n\t// Класс условий (спецоценка)\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tКлассыУсловийТрудаПоДолжностямСрезПоследних.КлассУсловийТруда КАК КлассУсловийТруда\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.КлассыУсловийТрудаПоДолжностям.СрезПоследних(&ДатаПриема, Должность = &Должность) КАК КлассыУсловийТрудаПоДолжностямСрезПоследних\";\r\n\t \r\n\tЗапрос.УстановитьПараметр(\"ДатаПриема\", ДатаАктуальности);\r\n\tЗапрос.УстановитьПараметр(\"Должность\", КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\tСтруктура.КлассУсловийСпецоценка = ВыборкаДетальныеЗаписи.КлассУсловийТруда;\r\n\tКонецЦикла;\r\n\t\r\n\t//МестоВыплаты\r\n\tЕсли ЗначениеЗАполнено(КадровыеДанныеСотрудника.МестоВыплаты) Тогда\r\n\t\tЕсли ТипЗнч(КадровыеДанныеСотрудника.МестоВыплаты) = ТИП(\"СправочникСсылка.БанковскиеСчетаКонтрагентов\") Тогда \r\n\t\t\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.МестоВыплаты.Банк) Тогда\r\n\t\t\t\tСтруктура.БанкИННСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.Банк.ИНН;\t\r\n\t\t\t\tСтруктура.БанкКорСчетСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.Банк.КоррСчет;\r\n\t\t\t\t//Структура.БанкКППСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.Банк.ИНН;\r\n\t\t\t\tСтруктура.БанкБИКСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.Банк.БИКРКЦ;\r\n\t\t\t\tСтруктура.БанкСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.Банк.Наименование;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tСтруктура.БанкСчетСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.НомерСчета;\r\n\t\tКонецЕсли;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить место выплаты\" + Символы.ПС;\t\t\r\n\tКонецЕсли;\r\n\r\n\t\r\nКонецПроцедуры\t\r\n\r\n&НаСервере\r\nПроцедура ПолучитьОбщиеДанныеДокумента(Документ, Структура, Ошибки)\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"ДатаДокументаД\", \t\t\t\"«_____» ___________ 20__ г.\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаДокументаДД\", \t\t\t\"«_____» ___________ 20__ г.\");\t// 1 января 2005 г.\r\n\t\t\r\n\tСтруктура.Вставить(\"НомерДокумента\", \t\t\t\"___\"); // ПП-1 / 14, типовой механизм при печати номеров в документах\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\tСтруктура.ДатаДокументаД\t= Формат(Документ.Дата, \"ДЛФ=Д\");\t// 01.01.2005\r\n\tСтруктура.ДатаДокументаДД\t= Формат(Документ.Дата, \"ДЛФ=ДД\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.НомерДокумента \t= ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(Документ.Номер, Ложь, Истина);\r\n\r\nКонецПроцедуры\t\r\n\r\n&НаСервере\r\nПроцедура ПолучитьДанныеПримемаНаРаботу(Документ, Структура, Ошибки)\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\tСтруктура.Вставить(\"ИспытательныйСрокЧисло\", \t\"без срока испытания\");\t\t\t\t\t\t\t// 3\r\n\tСтруктура.Вставить(\"ИспытательныйСрокПрописью\", \"без срока испытания\");\t\t\t\t\t\t\t// Три\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\t//Испытательный Срок\r\n\tПараметрыПредметаИсчисления = \"месяц,месяца,месяцев,м,,,,,0\";\r\n\tФорматнаяСтрока = \"Л=ru_RU\"; \r\n      \r\n   Попытка\r\n\t\tЕсли ЗначениеЗаполнено(Документ.ДлительностьИспытательногоСрока) Тогда \r\n\t\t\tСтруктура.Вставить(\"ИспытательныйСрокЧисло\", Документ.ДлительностьИспытательногоСрока);\r\n\t\t\tСтруктура.Вставить(\"ИспытательныйСрокПрописью\", ЧислоПрописью(Документ.ДлительностьИспытательногоСрока,ФорматнаяСтрока,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tПараметрыПредметаИсчисления));\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\tИсключение КонецПопытки;\r\n\t\t\r\n\t\r\n\t\t\r\nКонецПроцедуры\t\r\n\r\n&НаСервере\r\nПроцедура ПолучитьДанныеГПХ(Документ, Структура, Ошибки)\r\n\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"ДатаДНачалаГПХ\",\t\t\t\"«_____» ___________ 20__ г.\"); \t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаДДНачалаГПХ\",\t\t\t\"«_____» ___________ 20__ г.\"); // 1 января 2005 г.\r\n\r\n\tСтруктура.Вставить(\"ДатаДОкончаниеГПХ\",\t\t\t\"«_____» ___________ 20__ г.\"); \t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаДДОкончаниеГПХ\",\t\t\"«_____» ___________ 20__ г.\"); // 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"НомерПервичногоДокумента\",\t\"_____\"); \t\t\t\t// 123\r\n    Структура.Вставить(\"НомерГПХ\",\t\t\t\t\t\"_____\"); \t\t\t\t// 123\r\n\r\n\r\n\tСтруктура.Вставить(\"СуммаДоговора\", \t\t\t\"________\");  \t\t\t// 102,00\r\n\tСтруктура.Вставить(\"СуммаДоговораНаПечать\",\t\t\"__________________\");  // 102 руб. 00 коп.\r\n\tСтруктура.Вставить(\"СуммаДоговораПрописью\",\t\t\"__________________\");  // сто два рубля 00 коп. \r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\t//ДатаДНачалаГПХ\r\n\tЕсли ЗначениеЗаполнено(Документ.ДатаОкончания) Тогда\r\n\t\tСтруктура.ДатаДНачалаГПХ\t \t= Формат(Документ.ДатаНачала, \"ДЛФ=Д\");\t\t// 01.01.2005\r\n\t\tСтруктура.ДатаДДНачалаГПХ\t\t= Формат(Документ.ДатаНачала, \"ДЛФ=ДД\");\t\t// 1 января 2005 г. \r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату окончания договора\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\r\n\t//ДатаДОкончаниеГПХ\r\n\tЕсли ЗначениеЗаполнено(Документ.ДатаОкончания) Тогда\r\n\t\tСтруктура.ДатаДОкончаниеГПХ\t \t= Формат(Документ.ДатаОкончания, \"ДЛФ=Д\");\t\t// 01.01.2005\r\n\t\tСтруктура.ДатаДДОкончаниеГПХ\t= Формат(Документ.ДатаОкончания, \"ДЛФ=ДД\");\t\t// 1 января 2005 г. \r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату окончания договора\" + Символы.ПС;\t\r\n\tКонецЕсли; \r\n\t\r\n\t//Номер первичного документа и номер гпх\r\n\tЕсли ЗначениеЗаполнено(Документ.НомерПервичногоДокумента) Тогда\r\n\t\tСтруктура.НомерГПХ\t \t\t\t\t\t= ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(Документ.Номер, Ложь, Истина); \r\n\t\tЕсли ЗначениеЗаполнено(Документ.НомерПервичногоДокумента) Тогда\r\n\t\t\tСтруктура.НомерПервичногоДокумента\t= Документ.НомерПервичногоДокумента;\r\n\t\tИначе\r\n\t\t\tСтруктура.НомерПервичногоДокумента\t= Структура.НомерГПХ;\r\n\t\tКонецЕсли;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить номер договора\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\r\n\r\n\t\r\n\t//СуммаДоговора\r\n\tЕсли ЗначениеЗаполнено(Документ.Сумма) Тогда\r\n\t\tСтруктура.СуммаДоговора = Документ.Сумма;\r\n\t\tСтруктура.СуммаДоговораНаПечать = ЗарплатаКадрыОтчеты.ТарифнаяСтавкаНаПечать(Документ.Сумма, Истина);\r\n\t\tСтруктура.СуммаДоговораПрописью = РаботаСКурсамиВалют.СформироватьСуммуПрописью(Документ.Сумма, Справочники.Валюты.НайтиПоКоду(643));\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить сумму договора\" + Символы.ПС;\t\r\n\tКонецЕсли;\t\r\n\r\nКонецПроцедуры\t\r\n\t\r\n&НаСервере\r\nПроцедура ЗаполнитьДополнительныеДанные(Сотрудник, Документ, Структура, Ошибки)\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------// \r\n\t\r\n\t// Дополнительные данные на те случаи, когда нужны параметры применымие только к конкретному клиенту\r\n\t\r\n\t//Структура.Вставить(\"СпециалистПоКадрам\",\tСпециалистПоКадрам); \t// 48    \r\n\t//Структура.Вставить(\"ДопПремия\",\t\t\t\t\"\"); \t// 48  \r\n\tСтруктура.Вставить(\"ОтпускЗаНенормируемость\",\t\"___\");\t\t\t\t\t\t// 10 \r\n\tСтруктура.Вставить(\"ПроцентнаяНадбавкаЗаРазделениеДняНаЧасти\", \"50\");\r\n\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\t//Отпуск за ненормируемость и др. отпуска по их видам\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tПоложенныеВидыЕжегодныхОтпусковСрезПоследних.КоличествоДнейВГод КАК КоличествоДнейВГод,\r\n\t\t|\tПоложенныеВидыЕжегодныхОтпусковСрезПоследних.ВидЕжегодногоОтпуска КАК ВидЕжегодногоОтпуска\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ПоложенныеВидыЕжегодныхОтпусков.СрезПоследних(&Дата, Сотрудник = &Сотрудник) КАК ПоложенныеВидыЕжегодныхОтпусковСрезПоследних\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\tЕсли Структура.Свойство(\"ПриказОПриеме\") Тогда // на сотрудника заведен прием и берем дату начала трудового договора.\r\n\t\tЗапрос.УстановитьПараметр(\"Дата\", КонецДня(Структура.ДатаНачалаТрудовогоДоговора));\t\r\n\tИначе // Значит сотрудник занесен начальным ШР \r\n\t\tЗапрос.УстановитьПараметр(\"Дата\", КонецДня(ТекущаяДата()));\r\n\tКонецЕсли;\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\tВыборка = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока Выборка.Следующий() Цикл\r\n\t\tЕсли Выборка.ВидЕжегодногоОтпуска.Наименование = \"Отпуск за ненормированный рабочий день\" Тогда\r\n\t\t\tСтруктура[\"ОтпускЗаНенормируемость\"] = Выборка.КоличествоДнейВГод; \r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\t// Выбор оклада или ставки\r\n\tЕсли Структура.ТарифнаяСтавкаПочасоваяЧисло <> \"_______\" Тогда\r\n\t\tСтруктура.ТарифнаяСтавкаЧисло = \"—\";\r\n\tИначе\r\n\t\tСтруктура.ТарифнаяСтавкаПочасоваяЧисло = \"—\";\t\r\n\tКонецЕсли;   \r\n\t\r\n\t// Испытательный срок из дополнительного реквизита\r\n\tЕсли НЕ Структура.Свойство(\"ИспытательныйСрокЧисло\") Тогда \r\n\t\tСтруктура.Вставить(\"ИспытательныйСрокЧисло\", \t\"без срока испытания\");\t\t\t\t\t\t\t// 3\r\n\t\tСтруктура.Вставить(\"ИспытательныйСрокПрописью\", \"без срока испытания\");\t\t\t\t\t\t\t// Три\r\n\t\t\r\n\t\tИспытательныйСрокВСотруднике = ПолучитьЗначениеДопРеквизитаСведения(Сотрудник, \"itpИспытательныйСрок\");\r\n\t\tЕсли ЗначениеЗаполнено(ИспытательныйСрокВСотруднике) Тогда \r\n\t\t\t//Испытательный Срок\r\n\t\t\tПараметрыПредметаИсчисления = \"месяц,месяца,месяцев,м,,,,,0\";\r\n\t\t\tФорматнаяСтрока = \"Л=ru_RU\"; \r\n\t\t\tСтруктура.ИспытательныйСрокЧисло = ИспытательныйСрокВСотруднике;\r\n\t\t\tСтруктура.ИспытательныйСрокПрописью = ЧислоПрописью(ИспытательныйСрокВСотруднике,ФорматнаяСтрока,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tПараметрыПредметаИсчисления)\r\n\t\tКонецЕсли;\t\r\n\tКонецЕсли;\r\n\t\t\r\n\t\t\r\nКонецПроцедуры\t\r\n\r\n#Область ВспомогательныеФункции\r\n\r\n&НаСервере\r\nФункция ОпределитьОрганизацию(Сотрудник, Документ = Неопределено) \r\n\t\r\n\tКадровыеДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, \r\n    ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Сотрудник), \r\n    \"Организация\", ТекущаяДата())[0];  \r\n\t\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.Организация) Тогда\r\n\t\tВозврат КадровыеДанныеСотрудника.Организация;\r\n\tКонецЕсли;\r\n\t\r\n\tОрганизация = Неопределено;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tОрганизации.Ссылка КАК Ссылка\r\n\t\t|ИЗ\r\n\t\t|\tСправочник.Организации КАК Организации\r\n\t\t|ГДЕ\r\n\t\t|\tНЕ Организации.ПометкаУдаления\";\r\n\tРезультатЗапроса = Запрос.Выполнить().Выгрузить();\r\n\tЕсли РезультатЗапроса.Количество() = 1 Тогда \r\n\t\t//Если у нас только 1 организация\r\n\t\tОрганизация = РезультатЗапроса[0].Ссылка;\r\n\tИначе\r\n\t\t//Если у нас несколько организаций, ищем по сотруднику документ принятия на работу и берем организацию оттуда.\r\n\t\tЗапрос = Новый Запрос;\r\n\t\tЗапрос.Текст = \r\n\t\t\t\"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t\t|\tКадроваяИсторияСотрудниковСрезПоследних.ГоловнаяОрганизация КАК ГоловнаяОрганизация,\r\n\t\t\t|\tКадроваяИсторияСотрудниковСрезПоследних.Организация КАК Организация\r\n\t\t\t|ИЗ\r\n\t\t\t|\tРегистрСведений.КадроваяИсторияСотрудников.СрезПоследних(, Сотрудник = &Сотрудник) КАК КадроваяИсторияСотрудниковСрезПоследних\";\t\r\n\t\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\t\tРезультатЗапроса = Запрос.Выполнить().Выгрузить();\r\n\t\tЕсли РезультатЗапроса.Количество() = 1 Тогда\r\n\t\t\tОрганизация = ?(ЗначениеЗаполнено(РезультатЗапроса[0].Организация),РезультатЗапроса[0].Организация,РезультатЗапроса[0].ГоловнаяОрганизация);\t\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\r\n\tЕсли НЕ ЗначениеЗаполнено(Организация) Тогда\r\n\t\tПопытка\r\n\t\t\tОрганизация = Документ.Организация;\r\n\t\tИсключение\r\n\t\tКонецПопытки;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Организация;\r\n\t\r\nКонецФункции\r\n\r\n&НаСервере\r\nПроцедура ЗаполнитьОтпускаИзРегистра(Структура, Сотрудник)\r\n\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tПоложенныеВидыЕжегодныхОтпусковСрезПоследних.КоличествоДнейВГод КАК КоличествоДнейВГод,\r\n\t\t|\tПоложенныеВидыЕжегодныхОтпусковСрезПоследних.ВидЕжегодногоОтпуска КАК ВидЕжегодногоОтпуска\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ПоложенныеВидыЕжегодныхОтпусков.СрезПоследних(, Сотрудник = &Сотрудник) КАК ПоложенныеВидыЕжегодныхОтпусковСрезПоследних\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\tВыборка = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока Выборка.Следующий() Цикл\r\n\t\tЕсли Выборка.ВидЕжегодногоОтпуска = Справочники.ВидыОтпусков.Основной Тогда\r\n\t\t\tСтруктура[\"ОтпускОсновной\"] = Выборка.КоличествоДнейВГод; \r\n\t\tИначеЕсли  ПолучитьФункциональнуюОпцию(\"ИспользоватьНадбавкуЗаВредность\") И Выборка.ВидЕжегодногоОтпуска = Справочники.ВидыОтпусков.ОтпускЗаВредность Тогда\r\n\t\t\tСтруктура[\"ОтпускЗаВредность\"] = Выборка.КоличествоДнейВГод;\r\n\t\tИначеЕсли Выборка.ВидЕжегодногоОтпуска = Справочники.ВидыОтпусков.Северный Тогда\r\n\t\t\tСтруктура[\"ОтпускСеверные\"] = Выборка.КоличествоДнейВГод;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\t\r\nКонецПроцедуры\r\n\r\n#КонецОбласти\r\n\r\n#Область РаботаСДополнительнымиРеквизитами\r\n\r\nПроцедура УстановитьЗначениеДопРеквизитаСведения(СсылкаНаОбъект, ИмяДляРазработчиков, Значение)  \r\n\t\r\n\tТаблица = Новый ТаблицаЗначений;\r\n\tТаблица.Колонки.Добавить(\"Свойство\");\r\n\tТаблица.Колонки.Добавить(\"Значение\");\r\n\tТаблица.Очистить();\t\r\n\t\r\n\tСвойство = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоРеквизиту(\"Имя\", ИмяДляРазработчиков);\t\r\n\r\n\tСтрока = Таблица.Добавить();\r\n\tСтрока.Свойство = Свойство;\r\n\tСтрока.Значение = Значение;\r\n\t\r\n\tУправлениеСвойствами.ЗаписатьСвойстваУОбъекта(СсылкаНаОбъект, Таблица);\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция ПолучитьЗначениеДопРеквизитаСведения(СсылкаНаОбъект, ИмяДляРазработчиков)  \r\n\t\r\n\tСвойство = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоРеквизиту(\"Имя\", ИмяДляРазработчиков);\r\n\tВозврат УправлениеСвойствами.ЗначениеСвойства(СсылкаНаОбъект, Свойство);\r\n\t\r\nКонецФункции\r\n\r\n#КонецОбласти\n\n//---------- Сбор Данных ----------//\r\n&НаСервере\r\nФункция ПолучитьДанные(ОбъектНаПечать, Отказ, ТекстОшибокОтказ, Документ = Неопределено)\r\n\t\r\n\tЕсли ТипЗнч(ОбъектнаПечать) = Тип(\"СправочникСсылка.Сотрудники\") Тогда\r\n\t\tСотрудник = ОбъектнаПечать;\r\n\tИначе\t\r\n\t\tСотрудник = ОбъектнаПечать.Сотрудник;\r\n\tКонецЕсли;\r\n \r\n\tОшибки = \"\";\r\n\t\r\n\tЕсли НЕ ЗначениеЗаполнено(Сотрудник.ФизическоеЛицо) Тогда\r\n\t\tТекстОшибокОтказ = ТекстОшибокОтказ + (\"Требуется указать физическое лицо сотруднику\") + Символы.ПС; \r\n\t\tОтказ = Истина;\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\tСтруктура = Новый Структура;\r\n\t\r\n\t//-------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"ДатаАктуальностиДанных\",\tТекущаяДатаСеанса());\t\t// Специальный параметр для получения данных\r\n\t\r\n\t//Получаем общие данные\r\n\tПолучитьОбщиеДанные(Структура, Ошибки);\r\n\t\r\n\t//Получаем всю необходимую информацию по сотруднику\r\n\tПолучитьДанныеСотрудника(Сотрудник, Структура, Ошибки);\r\n\t\r\n\t//Получаем все данные организации \r\n\tОрганизация = ОпределитьОрганизацию(Сотрудник, Документ); \r\n\tПолучитьДанныеОрганизации(Организация, Структура, Ошибки);\r\n\t\r\n\t//Получаем кадровые данные сотрудника\r\n\tПолучитьКадровыеДанныеСотрудника(Сотрудник, Структура, Ошибки);\r\n\t\r\n\t//Получить общие данные документа\r\n\tЕсли ЗначениеЗаполнено(Документ) Тогда\r\n\t\tПолучитьОбщиеДанныеДокумента(Документ, Структура, Ошибки);\r\n\tКонецЕсли;\r\n\r\n\t//-------------------------------------------------------------------------//\r\n\t\r\n\t//Получить данные документа \"Прием на работу\"\r\n\tЕсли ЗначениеЗаполнено(Документ) И ТипЗнч(Документ) = Тип(\"ДокументСсылка.ПриемНаРаботу\") Тогда\r\n\t\tПолучитьДанныеПримемаНаРаботу(Документ, Структура, Ошибки);\t\r\n\tИначе\r\n\t\tЕсли Структура.Свойство(\"ПриказОприеме\") И Структура.ПриказОПриеме <> Неопределено Тогда\r\n\t\t\tПолучитьДанныеПримемаНаРаботу(Структура.ПриказОПриеме, Структура, Ошибки);\r\n\t\t\tСтруктура.ПриказОПриеме = \" \";\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\n\t//Получить данные документа \"ГПХ\"\r\n\tЕсли ЗначениеЗаполнено(Документ) И ТипЗнч(Документ) = Тип(\"ДокументСсылка.ДоговорРаботыУслуги\") Тогда\r\n\t\tПолучитьДанныеГПХ(Документ, Структура, Ошибки);\t\r\n\tКонецЕсли;\r\n\t\r\n\t//-------------------------------------------------------------------------//\r\n\t\r\n\t//Дополняем дополнительными данными клиента\r\n\tЗаполнитьДополнительныеДанные(Сотрудник, Документ, Структура, Ошибки);\r\n\r\n\t//-------------------------------------------------------------------------//\r\n\t\r\n\tЕсли ЗначениеЗаполнено(Ошибки) Тогда\r\n\t\tСообщить(Ошибки);\r\n\tКонецЕсли; \r\n\t\r\n\tВозврат Структура;\r\n\t\r\nКонецФункции   \r\n\r\n&НаСервере\r\nПроцедура ПолучитьОбщиеДанные(Структура, Ошибки)\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"ТекущаяДатаД\", \t\t\t\t\"«_____» ___________ 20__ г.\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ТекущаяДатаДД\", \t\t\t\"«_____» ___________ 20__ г.\");\t// 1 января 2005 г.\r\n\tСтруктура.Вставить(\"ТекущийГод\",\t\t\t\t\"20__ г.\");  \t\t\t\t\t// 2005\r\n    //--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\tСтруктура.ТекущаяДатаД\t\t= Формат(ТекущаяДата(), \"ДЛФ=Д\");\t// 01.01.2005\r\n\tСтруктура.ТекущаяДатаДД \t= Формат(ТекущаяДата(), \"ДЛФ=ДД\");\t// 1 января 2005 г.\r\n\tСтруктура.ТекущийГод \t\t= Формат(ТекущаяДата(), \"ДФ=гггг\");  // 2005\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ПолучитьДанныеСотрудника(Сотрудник, Структура, Ошибки)\r\n\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"ФИО\", \t\t\t\t\t\t\"_____________________\");\t// Иванов Иван Иванович\r\n\tСтруктура.Вставить(\"ФИОСклРодительный\", \t\t\"_____________________\");\t// Иванова Ивана Ивановича\r\n\tСтруктура.Вставить(\"ФИОСклДательный\", \t\t\t\"_____________________\");\t// Иванову Ивану Ивановичу\r\n\tСтруктура.Вставить(\"ФИОСклВинительный\", \t\t\"_____________________\");\t// Иванова Ивана Ивановича\r\n\tСтруктура.Вставить(\"ФИОСклТворительный\", \t\t\"_____________________\");\t// Ивановым Иваном Ивановичем\r\n\tСтруктура.Вставить(\"ФИОСклПредложный\", \t\t\t\"_____________________\");\t// Иванове Иване Ивановиче\r\n\t\r\n\tСтруктура.Вставить(\"ФамилияИнициалы\", \t\t\t\"_____________________\");\t// Михейцева Н. А. \r\n\tСтруктура.Вставить(\"ФамилияИнициалыРод\",\t\t\"_____________________\");   // Михейцевой Н. А.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыДат\",\t\t\"_____________________\");   // Михейцевой Н. А.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыВин\",\t\t\"_____________________\");\t// Михейцеву Н. А.  \r\n\tСтруктура.Вставить(\"ФамилияИнициалыТвор\",\t\t\"_____________________\");   // Михейцевой Н. А.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыПред\",\t\t\"_____________________\");   // Михейцевой Н. А.   \r\n\t\r\n\tСтруктура.Вставить(\"ИнициалыФамилия\", \t\t\t\"_____________________\");\t// Н. А. Михейцева  \r\n\tСтруктура.Вставить(\"ИнициалыФамилияРод\",\t\t\"_____________________\");   // Н. А. Михейцевой\r\n\tСтруктура.Вставить(\"ИнициалыФамилияДат\",\t\t\"_____________________\");   // Н. А. Михейцевой\r\n\tСтруктура.Вставить(\"ИнициалыФамилияВин\",\t\t\"_____________________\");\t// Н. А. Михейцеву \r\n\tСтруктура.Вставить(\"ИнициалыФамилияТвор\",\t\t\"_____________________\");   // Н. А. Михейцевой\r\n\tСтруктура.Вставить(\"ИнициалыФамилияПред\",\t\t\"_____________________\");   // Н. А. Михейцевой\r\n\t\t\t\r\n\tСтруктура.Вставить(\"ТелефонМобильныйСотрудника\",\"___________\"); \t\t\t// 88005553535\r\n\tСтруктура.Вставить(\"EmailСотрудника\",\t\t\t\"___________\"); \t\t\t// example@mail.ru\t \r\n\tСтруктура.Вставить(\"ИННСотрудника\",\t\t\t\t\"_____________________\");\t//123456789012\r\n\tСтруктура.Вставить(\"СнилсСотрудника\",\t\t\t\"_____________________\");\t// 123-456-789 00\r\n    \r\n\tСтруктура.Вставить(\"ДокументПредставление\",\t\t\t\t\"__________________________________________\"); \t// Паспорт гражданина РФ, серия: 12 34, № 111126, выдан: 01 января 2000 года, ПВР №1\r\n\tСтруктура.Вставить(\"ДокументСерия\",\t\t\t\t\t\t\"__________________________________________\"); \t// 12 34\r\n    Структура.Вставить(\"ДокументНомер\",\t\t\t\t\t\t\"__________________________________________\"); \t// 56789\r\n    Структура.Вставить(\"КемВыдан\",\t\t\t\t\t\t\t\"__________________________________________\"); \t// ПВР №1 \r\n    Структура.Вставить(\"КодПодразделения\",\t\t\t\t\t\"__________________________________________\"); \t// 650-001 \r\n\tСтруктура.Вставить(\"ДатаВыдачиД\",\t\t\t\t\t\t\"__________________________________________\"); \t// 01.01.2005 \r\n\tСтруктура.Вставить(\"ДатаВыдачиДД\",\t\t\t\t\t\t\"__________________________________________\"); \t// 1 января 2005 г. \r\n\t\r\n\tСтруктура.Вставить(\"Страна\",\t\t\t\t\t\t\t\"____________\"); \t\t\t\t\t\t\t\t// Россия \r\n\r\n\tСтруктура.Вставить(\"АдресПоПропискеПредставление\",\t\t\"__________________________________________\"); \t// РОССИЯ, 105122, Москва г, Амурская ул, дом № 1, квартира 2\r\n\tСтруктура.Вставить(\"АдресПроживанияСотрудника\",\t\t\t\"__________________________________________\"); \t// РОССИЯ, 105122, Москва г, Амурская ул, дом № 1, квартира 2\r\n\t\r\n\tСтруктура.Вставить(\"ДатаРожденияСотрудникаД\",\t\t\t\"«_____» ___________ 20__ г.\"); \t\t\t\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаРожденияСотрудникаДД\",\t\t\t\"«_____» ___________ 20__ г.\");\t\t\t\t\t// 1 января 2005 г.\t\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\t// Удостоверение личности\r\n\tУдостоверенияЛичности = Неопределено;\r\n\tДокументыСотрудника = КадровыйУчет.ДокументыФизическихЛиц(Сотрудник.ФизическоеЛицо, Истина); \r\n\tЕсли ДокументыСотрудника.Количество() > 0 Тогда \r\n\t\t\r\n\t\tПриоритетВидовДокумента = Новый Массив();\r\n\t\tПриоритетВидовДокумента.Добавить(Справочники.ВидыДокументовФизическихЛиц.ПаспортРФ);\r\n\t\tПриоритетВидовДокумента.Добавить(Справочники.ВидыДокументовФизическихЛиц.НайтиПоНаименованию(\"Иностранный паспорт\"));\r\n\t\t\r\n\t\tДля каждого ВидДокумента из ПриоритетВидовДокумента Цикл \r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(ВидДокумента) Тогда Продолжить КонецЕсли;\r\n\t\t\tОтбор = Новый Структура(\"ВидДокумента\", ВидДокумента);\r\n\t\t\tНайденныеДокументы = ДокументыСотрудника.НайтиСтроки(Отбор);\r\n\t\t\tЕсли НайденныеДокументы.Количество() > 0 Тогда\r\n\t\t\t\tУдостоверенияЛичности = НайденныеДокументы[0];\r\n\t\t\t\tПрервать;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;   \r\n\t\t\r\n\t\tЕсли УдостоверенияЛичности = неопределено Тогда\r\n\t\t\tУдостоверенияЛичности = ДокументыСотрудника[0];\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\n    ДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, \r\n\t\tОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Сотрудник), \r\n\t\t\"АдресМестаПроживания, АдресМестаПроживанияПредставление, АдресПоПрописке, АдресПоПропискеПредставление, Страна,\r\n\t\t| ТелефонМобильныйПредставление, ТелефонДомашнийПредставление, ТелефонРабочий, ТелефонРабочийПредставление, EMail, EMailПредставление\", ТекущаяДата())[0];\r\n\r\n\t\t\r\n\t//Общие\r\n\tСтруктура.ФИО\t\t\t\t\t\t= Сотрудник.Наименование;\r\n\tСтруктура.ФИОСклРодительный\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.Наименование, 2, Сотрудник.ФизическоеЛицо.Пол);\t//Иванова Ивана Ивановича\r\n\tСтруктура.ФИОСклДательный\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.Наименование, 3, Сотрудник.ФизическоеЛицо.Пол);\t//Иванову Ивану Ивановичу\r\n\tСтруктура.ФИОСклВинительный\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.Наименование, 4, Сотрудник.ФизическоеЛицо.Пол);\t//Иванова Ивана Ивановича\r\n\tСтруктура.ФИОСклТворительный\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.Наименование, 5, Сотрудник.ФизическоеЛицо.Пол);\t//Ивановым Иваном Ивановичем\r\n\tСтруктура.ФИОСклПредложный\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.Наименование, 6, Сотрудник.ФизическоеЛицо.Пол);\t//Иванове Иване Ивановиче\r\n\t\r\n\tСтруктура.ФамилияИнициалы\t\t\t= Сотрудник.ФизическоеЛицо.Фамилия + \" \" +Сотрудник.ФизическоеЛицо.Инициалы; \r\n\tСтруктура.ФамилияИнициалыРод\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 2, Сотрудник.ФизическоеЛицо.Пол) + \" \" + Сотрудник.ФизическоеЛицо.Инициалы;\r\n\tСтруктура.ФамилияИнициалыДат\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 3, Сотрудник.ФизическоеЛицо.Пол) + \" \" + Сотрудник.ФизическоеЛицо.Инициалы;\r\n\tСтруктура.ФамилияИнициалыВин\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 4, Сотрудник.ФизическоеЛицо.Пол) + \" \" + Сотрудник.ФизическоеЛицо.Инициалы;\r\n\tСтруктура.ФамилияИнициалыТвор\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 5, Сотрудник.ФизическоеЛицо.Пол) + \" \" + Сотрудник.ФизическоеЛицо.Инициалы;\r\n\tСтруктура.ФамилияИнициалыПред\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 6, Сотрудник.ФизическоеЛицо.Пол) + \" \" + Сотрудник.ФизическоеЛицо.Инициалы; \r\n\t\r\n\tСтруктура.ИнициалыФамилия\t\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + Сотрудник.ФизическоеЛицо.Фамилия; \r\n\tСтруктура.ИнициалыФамилияРод\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 2, Сотрудник.ФизическоеЛицо.Пол);\r\n\tСтруктура.ИнициалыФамилияДат\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 3, Сотрудник.ФизическоеЛицо.Пол);\r\n\tСтруктура.ИнициалыФамилияВин\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 4, Сотрудник.ФизическоеЛицо.Пол);\r\n\tСтруктура.ИнициалыФамилияТвор\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 5, Сотрудник.ФизическоеЛицо.Пол);\r\n\tСтруктура.ИнициалыФамилияПред\t\t= Сотрудник.ФизическоеЛицо.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(Сотрудник.ФизическоеЛицо.Фамилия, 6, Сотрудник.ФизическоеЛицо.Пол);\r\n\t\r\n\t\r\n\t//ТелефонМобильныйСотрудника\r\n\tЕсли ЗначениеЗаполнено(ДанныеСотрудника.ТелефонМобильныйПредставление) Тогда\r\n\t\tСтруктура.ТелефонМобильныйСотрудника = ДанныеСотрудника.ТелефонМобильныйПредставление;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не заполнен Мобильный телефон у сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\t\r\n\t//EmailСотрудника\r\n\tЕсли ЗначениеЗаполнено(ДанныеСотрудника.EMAILПРЕДСТАВЛЕНИЕ) Тогда\r\n\t\tСтруктура.EmailСотрудника = ДанныеСотрудника.EMAILПРЕДСТАВЛЕНИЕ;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не заполнен Email у сотрудника\" + Символы.ПС;\r\n\tКонецЕсли;\r\n\t\t\r\n\t//ИННСотрудника\r\n\tЕсли ЗначениеЗаполнено(Сотрудник.ФизическоеЛицо.ИНН) Тогда\r\n\t\tСтруктура.ИННСотрудника = Сотрудник.ФизическоеЛицо.ИНН;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не заполнен ИНН у сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\t\r\n\t//СнилсСотрудника\r\n\tЕсли ЗначениеЗаполнено(Сотрудник.ФизическоеЛицо.СтраховойНомерПФР) Тогда\r\n\t\tСтруктура.СнилсСотрудника = Сотрудник.ФизическоеЛицо.СтраховойНомерПФР;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не заполнен СНИЛС у сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\r\n\t\r\n\tЕсли ЗначениеЗаполнено(УдостоверенияЛичности) Тогда\r\n\t\t\r\n\t\t//ДокументПредставление\r\n\t\tЕсли ЗначениеЗаполнено(УдостоверенияЛичности.Представление) Тогда\r\n\t\t\tСтруктура.ДокументПредставление = УдостоверенияЛичности.Представление;\r\n\t\t\tСтруктура.ДокументСерия = УдостоверенияЛичности.Серия;\r\n\t\t\tСтруктура.ДокументНомер = УдостоверенияЛичности.Номер;\r\n\t\t\tСтруктура.КемВыдан \t\t= УдостоверенияЛичности.КемВыдан;\r\n\t\t\tСтруктура.КодПодразделения = УдостоверенияЛичности.КодПодразделения; \r\n\t\t\tСтруктура.ДатаВыдачиД \t= Формат(УдостоверенияЛичности.ДатаВыдачи, \"ДЛФ=Д\"); \r\n\t\t\tСтруктура.ДатаВыдачиДД \t= Формат(УдостоверенияЛичности.ДатаВыдачи, \"ДЛФ=ДД\"); \t\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить паспортные данные сотрудника\" + Символы.ПС;\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t// Страна\r\n\tЕсли ЗначениеЗаполнено(ДанныеСотрудника.Страна) Тогда\r\n\t\tСтруктура.Страна = Строка(ДанныеСотрудника.Страна);\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить Страну сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\t\r\n\t// Адрес по прописке\r\n\tЕсли ЗначениеЗаполнено(ДанныеСотрудника.АДРЕСПОПРОПИСКЕПРЕДСТАВЛЕНИЕ) Тогда\r\n\t\tСтруктура.АдресПоПропискеПредставление = Строка(ДанныеСотрудника.АДРЕСПОПРОПИСКЕПРЕДСТАВЛЕНИЕ);\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить Адрес по прописке сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\r\n\t//ДатаРожденияСотрудникаД и ДД\r\n\tЕсли ЗначениеЗаполнено(ДанныеСотрудника.ФизическоеЛицо.ДатаРождения) Тогда\r\n\t\tСтруктура.ДатаРожденияСотрудникаД\t\t\t= Формат(ДанныеСотрудника.ФизическоеЛицо.ДатаРождения, \"ДЛФ=Д\"); // 01.01.2005\r\n\t\tСтруктура.ДатаРожденияСотрудникаДД\t\t\t= Формат(ДанныеСотрудника.ФизическоеЛицо.ДатаРождения, \"ДЛФ=ДД\");// 1 января 2005 г.\t\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату рождения сотрудника\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры   \r\n\r\n&НаСервере\r\nПроцедура ПолучитьДанныеОрганизации(Организация, Структура, Ошибки)  \r\n\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"Организация\",\t\t\t\t\t\"\");\t\t\t\t\t\t// Ссылка Крон-Ц. Филиал в г. Калининград\r\n\tСтруктура.Вставить(\"ОрганизацияНаименование\", \t\t\"_______________________\"); // Крон-Ц. Филиал в г. Калининград\r\n\tСтруктура.Вставить(\"ОрганизацияНаименованиеПолное\", \"_______________________\"); // Открытое акционерное общество \"Крон-Ц\". Филиал в г. Калининград\r\n\tСтруктура.Вставить(\"ОрганизацияНаименованиеСокр\", \t\"_______________________\"); // ОАО \"Крон-Ц\". Филиал в г. Калининград\r\n\t\r\n\tСтруктура.Вставить(\"ИННОрг\",\t\t\t\t\t\t\"_______________\"); \t// 500100732259\r\n\tСтруктура.Вставить(\"КППОрг\",\t\t\t\t\t\t\"_______________\"); \t// 773301001\r\n\tСтруктура.Вставить(\"ОГРНОрг\",\t\t\t\t\t\t\"_______________\"); \t// 1117746358608\r\n\t\r\n\tСтруктура.Вставить(\"ТелОрганизации\",\t\t       \t\"+7-___-___-____.\"); \t// +7-800-555-3535.\r\n\tСтруктура.Вставить(\"Имейл\",\t\t       \t\t\t\t\"\"); \t\t\t\t\t// example@mail.com\r\n\tСтруктура.Вставить(\"ЮрАдресОргПредставление\",\t\t\"_______________________________\"); \t// 127083, Москва г, ул 8 Марта, д. 4   \r\n\tСтруктура.Вставить(\"ФактАдресОрганизации\",\t\t\t\"_______________________________\"); \t// 127083, Москва г, ул 8 Марта, д. 4   \r\n\t\r\n\tСтруктура.Вставить(\"ФиоРукИменительный\", \t\t\"_____________________\");\t// Иванов Иван Иванович\r\n\tСтруктура.Вставить(\"ФиоРукРодительный\", \t\t\"_____________________\");\t// Иванова Ивана Ивановича\r\n\tСтруктура.Вставить(\"ФиоРукДательный\",\t\t\t\"_____________________\");\t// Иванову Ивану Ивановичу\r\n\tСтруктура.Вставить(\"ФиоРукВинительный\", \t\t\"_____________________\");\t// Иванова Ивана Ивановича\r\n\tСтруктура.Вставить(\"ФиоРукТворительный\", \t\t\"_____________________\");\t// Ивановым Иваном Ивановичем\r\n\tСтруктура.Вставить(\"ФиоРукПредложный\", \t\t\t\"_____________________\");\t// Иванове Иване Ивановиче\r\n\t\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРук\", \t\t\"_____________________\");\t// Иванов И. И.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРукРод\",\t\t\"_____________________\");   // Иванова И. И.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРукДат\",\t\t\"_____________________\");   // Иванову И. И.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРукВин\",\t\t\"_____________________\");   // Иванова И. И.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРукТвор\",\t\"_____________________\");   // Ивановым И. И.\r\n\tСтруктура.Вставить(\"ФамилияИнициалыРукПред\",\t\"_____________________\");   // Иванове И. И.\r\n\t\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРук\",\t\t\"_____________________\");\t// И. И. Иванов\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРукРод\",\t\t\"_____________________\");\t// И. И. Иванова\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРукДат\",\t\t\"_____________________\");\t// И. И. Иванову\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРукВин\",\t\t\"_____________________\");\t// И. И. Иванова\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРукТвор\",\t\"_____________________\");\t// И. И. Ивановым\r\n\tСтруктура.Вставить(\"ИнициалыФамилияРукПрод\",\t\"_____________________\");\t// И. И. Иванове\r\n\t\r\n\tСтруктура.Вставить(\"ДолжностьРуководителя\", \t\t\"_____________________\"); // Генеральный директор \r\n\tСтруктура.Вставить(\"ДолжностьРуководителяРод\",\t\t\"_____________________\"); // Генерального директора\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяДат\",\t\t\"_____________________\"); // Генеральному директору \r\n\tСтруктура.Вставить(\"ДолжностьРуководителяВин\",\t\t\"_____________________\"); // Генеральном директоре\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяТвор\",\t\t\"_____________________\"); // Генерального директора\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяПред\",\t\t\"_____________________\"); // Генеральным директором  \r\n\t\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяНРег\", \t\t\"_____________________\"); // генеральный директор \r\n\tСтруктура.Вставить(\"ДолжностьРуководителяРодНРег\",\t\t\"_____________________\"); // генерального директора\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяДатНРег\",\t\t\"_____________________\"); // генеральному директору \r\n\tСтруктура.Вставить(\"ДолжностьРуководителяВинНРег\",\t\t\"_____________________\"); // генеральном директоре\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяТворНРег\",\t\t\"_____________________\"); // генерального директора\r\n\tСтруктура.Вставить(\"ДолжностьРуководителяПредНРег\",\t\t\"_____________________\"); // генеральным директором\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\tЕсли ЗначениеЗаполнено(Организация) Тогда \r\n\t\tСписокПОказателей = Новый Массив;\r\n\t\tСписокПоказателей.Добавить(\"ДолжнРук\");\r\n\t\tСписокПоказателей.Добавить(\"ИННЮЛ\");\r\n\t\tСписокПоказателей.Добавить(\"КППЮЛ\");\r\n\t\tСписокПоказателей.Добавить(\"ОГРН\");\r\n\t\tСписокПоказателей.Добавить(\"РукСсылка\");\r\n\t\tСписокПоказателей.Добавить(\"ТелОрганизации\");\r\n        СписокПоказателей.Добавить(\"АдресЭлектроннойПочтыОрганизации\");\r\n\r\n\t\tСведенияОбОрганизации = ЗарплатаКадрыБазовый.ПолучитьСведенияОбОрганизации(Организация, ТекущаяДата(), СписокПОказателей); \r\n\t\t\r\n\t\tСтруктура.Организация\t\t\t\t\t\t= Организация.Ссылка;\r\n\t\tСтруктура.ОрганизацияНаименование\t\t\t= Организация.Наименование;\r\n\t\tСтруктура.ОрганизацияНаименованиеПолное\t\t= Организация.НаименованиеПолное;\r\n\t\tСтруктура.ОрганизацияНаименованиеСокр\t\t= Организация.НаименованиеСокращенное;\r\n\t\t\r\n\t\tСтруктура.ИННОрг\t\t\t= Организация.Инн;\r\n\t\tСтруктура.КППОрг\t\t\t= ?(Организация.Метаданные().Реквизиты.Найти(\"КПП\") = Неопределено, СведенияОбОрганизации.КППЮЛ, Организация.Кпп);\r\n\t\tСтруктура.ОГРНОрг\t\t\t= Организация.ОГРН;\r\n\t\t\r\n\t\t//ТелОрганизации\r\n\t\tЕсли ЗначениеЗаполнено(СведенияОбОрганизации.ТелОрганизации) Тогда\r\n\t\t\tСтруктура.ТелОрганизации = СведенияОбОрганизации.ТелОрганизации;\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить телефон организации\" + Символы.ПС;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//Имейл\r\n\t\tЕсли ЗначениеЗаполнено(СведенияОбОрганизации.АдресЭлектроннойПочтыОрганизации) Тогда\r\n\t\t\tСтруктура.Имейл = СведенияОбОрганизации.АдресЭлектроннойПочтыОрганизации;\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить имейл организации\" + Символы.ПС;\r\n\t\tКонецЕсли;\r\n\r\n\t\t\r\n\t\t//ЮрАдресОргПредставление\r\n\t\tЕсли ЗначениеЗаполнено(Организация) Тогда\r\n\t\t\tЮрАдресОргПредставление = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияОбъекта(Организация, Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации, ТекущаяДатаСеанса(), Истина);\r\n\t\t\tСтруктура.ЮрАдресОргПредставление = ?(ЗначениеЗаполнено(ЮрАдресОргПредставление), ЮрАдресОргПредставление, Структура.ЮрАдресОргПредставление);\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить юридический адрес организации\" + Символы.ПС;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//ФактАдресОрганизации\r\n\t\tЕсли ЗначениеЗаполнено(Организация) Тогда\r\n\t\t\tФактАдресОрганизации = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияОбъекта(Организация, Справочники.ВидыКонтактнойИнформации.ФактАдресОрганизации, ТекущаяДатаСеанса(), Истина);\r\n\t\t\tСтруктура.ФактАдресОрганизации = ?(ЗначениеЗаполнено(ФактАдресОрганизации), ФактАдресОрганизации, Структура.ФактАдресОрганизации);\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить Фактический адрес организации\" + Символы.ПС;\r\n\t\tКонецЕсли;\r\n\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(СведенияОбОрганизации.РукСсылка) Тогда\r\n\t\t\tРуководительОрганизации = СведенияОбОрганизации.РукСсылка; \r\n\t\tИначе\r\n\t\t\tОшибки = Ошибки + \"Не удалось определить руководителя организации\" + Символы.ПС;\t\r\n\t\tКонецЕсли;\r\n\t\r\n\t\tЕсли ЗначениеЗаполнено(РуководительОрганизации) Тогда\r\n\t\t\r\n\t\t\tСтруктура.ФиоРукИменительный\t\t\t= РуководительОрганизации.Наименование;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Иванов Иван Иванович\r\n\t\t\tСтруктура.ФиоРукРодительный\t\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Наименование, 2, РуководительОрганизации.Пол);\t// Иванова Ивана Ивановича\r\n\t\t\tСтруктура.ФиоРукДательный\t\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Наименование, 3, РуководительОрганизации.Пол);\t// Иванову Ивану Ивановичу\r\n\t\t\tСтруктура.ФиоРукВинительный\t\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Наименование, 4, РуководительОрганизации.Пол);\t// Иванова Ивана Ивановича\r\n\t\t\tСтруктура.ФиоРукТворительный\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Наименование, 5, РуководительОрганизации.Пол);\t// Ивановым Иваном Ивановичем\r\n\t\t\tСтруктура.ФиоРукПредложный\t\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Наименование, 6, РуководительОрганизации.Пол);\t// Иванове Иване Ивановиче\r\n\t\t\t\r\n\t\t\tСтруктура.ФамилияИнициалыРук\t\t\t= РуководительОрганизации.Фамилия + \" \" +РуководительОрганизации.Инициалы;\t\t\t\t\t\t\t\t\t\t// Иванов И. И.\r\n\t\t\tСтруктура.ФамилияИнициалыРукРод\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 2, РуководительОрганизации.Пол) + \" \" + РуководительОрганизации.Инициалы;\r\n\t\t\tСтруктура.ФамилияИнициалыРукДат\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 3, РуководительОрганизации.Пол) + \" \" + РуководительОрганизации.Инициалы;\r\n\t\t\tСтруктура.ФамилияИнициалыРукВин\t\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 4, РуководительОрганизации.Пол) + \" \" + РуководительОрганизации.Инициалы;\r\n\t\t\tСтруктура.ФамилияИнициалыРукТвор\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 5, РуководительОрганизации.Пол) + \" \" + РуководительОрганизации.Инициалы;\r\n\t\t\tСтруктура.ФамилияИнициалыРукПред\t\t= ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 6, РуководительОрганизации.Пол) + \" \" + РуководительОрганизации.Инициалы;\r\n\t\t\t\r\n\t\t\tСтруктура.ИнициалыФамилияРук\t\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 1, РуководительОрганизации.Пол);\r\n\t\t\tСтруктура.ИнициалыФамилияРукРод\t\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 2, РуководительОрганизации.Пол);\r\n\t\t\tСтруктура.ИнициалыФамилияРукДат\t\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 3, РуководительОрганизации.Пол);\r\n\t\t\tСтруктура.ИнициалыФамилияРукВин\t\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 4, РуководительОрганизации.Пол);\r\n\t\t\tСтруктура.ИнициалыФамилияРукТвор\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 5, РуководительОрганизации.Пол);\r\n\t\t\tСтруктура.ИнициалыФамилияРукПрод\t\t= РуководительОрганизации.Инициалы + \" \" + ЗарплатаКадрыОтчеты.ПросклоненныеФИО(РуководительОрганизации.Фамилия, 6, РуководительОрганизации.Пол);\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(СведенияОбОрганизации.ДолжнРук) Тогда\r\n\t\t\tСтруктура.ДолжностьРуководителя\t\t\t= СведенияОбОрганизации.ДолжнРук.Наименование;\r\n\t\t\tСтруктура.ДолжностьРуководителяРод\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(СведенияОбОрганизации.ДолжнРук, 2);\r\n\t\t\tСтруктура.ДолжностьРуководителяДат\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(СведенияОбОрганизации.ДолжнРук, 3);\r\n\t\t\tСтруктура.ДолжностьРуководителяВин\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(СведенияОбОрганизации.ДолжнРук, 4);\r\n\t\t\tСтруктура.ДолжностьРуководителяТвор\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(СведенияОбОрганизации.ДолжнРук, 5);\r\n\t\t\tСтруктура.ДолжностьРуководителяПред\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(СведенияОбОрганизации.ДолжнРук, 6);\r\n\t\t\t\r\n\t\t\tСтруктура.ДолжностьРуководителяНРег\t\t\t= НРег(Структура.ДолжностьРуководителя);\r\n\t\t\tСтруктура.ДолжностьРуководителяРодНРег\t\t= НРег(Структура.ДолжностьРуководителяРод);\r\n\t\t\tСтруктура.ДолжностьРуководителяДатНРег\t\t= НРег(Структура.ДолжностьРуководителяДат);\r\n\t\t\tСтруктура.ДолжностьРуководителяВинНРег\t\t= НРег(Структура.ДолжностьРуководителяВин);\r\n\t\t\tСтруктура.ДолжностьРуководителяТворНРег\t\t= НРег(Структура.ДолжностьРуководителяТвор);\r\n\t\t\tСтруктура.ДолжностьРуководителяПредНРег\t\t= НРег(Структура.ДолжностьРуководителяПред);\r\n\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить должность руководителя организации\" + Символы.ПС;\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить данные организации\" + Символы.ПС; \r\n\tКонецЕсли;\r\n\t\r\n\t\t\t\t\r\n\t\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ПолучитьКадровыеДанныеСотрудника(Сотрудник, Структура, Ошибки)\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------/\t\r\n\tСтруктура.Вставить(\"Должность\", \t\t\t\t\"_____________________\");\t// Эксперт\r\n\tСтруктура.Вставить(\"ДолжностьРод\",\t\t\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ДолжностьДат\",\t\t\t\t\"_____________________\");\t// Эксперту\r\n\tСтруктура.Вставить(\"ДолжностьВин\",\t\t\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ДолжностьТвор\",\t\t\t\t\"_____________________\"); \t// Экспертом\r\n\tСтруктура.Вставить(\"ДолжностьПред\",\t\t\t\t\"_____________________\");\t// Эксперте\r\n\t\r\n\tСтруктура.Вставить(\"ДолжностьШР\",\t \t\t\t\"_____________________\");\t// Эксперт\r\n\tСтруктура.Вставить(\"ДолжностьШРРод\",\t\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ДолжностьШРДат\",\t\t\t\"_____________________\");\t// Эксперту\r\n\tСтруктура.Вставить(\"ДолжностьШРВин\",\t\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ДолжностьШРТвор\",\t\t\t\"_____________________\"); \t// Экспертом\r\n\tСтруктура.Вставить(\"ДолжностьШРПред\",\t\t\t\"_____________________\");\t// Эксперте \r\n\t\r\n\tСтруктура.Вставить(\"ДолжностьИРазряд\",\t \t\t\"_____________________\");\t// Эксперт, 1 категория\r\n\tСтруктура.Вставить(\"ДолжностьИРазрядРод\",\t\t\"_____________________\");\t// Эксперта, 1 категории\r\n\tСтруктура.Вставить(\"ДолжностьИРазрядДат\",\t\t\"_____________________\");\t// Эксперту, 1 категории\r\n\tСтруктура.Вставить(\"ДолжностьИРазрядВин\",\t\t\"_____________________\");\t// Эксперта, 1 категории\r\n\tСтруктура.Вставить(\"ДолжностьИРазрядТвор\",\t\t\"_____________________\"); \t// Экспертом, 1 категории\r\n\tСтруктура.Вставить(\"ДолжностьИРазрядПред\",\t\t\"_____________________\");\t// Эксперте, 1 категории \r\n\t\r\n\tСтруктура.Вставить(\"ТекущаяДолжность\", \t\t\t\"_____________________\");\t// Эксперт\r\n\tСтруктура.Вставить(\"ТекущаяДолжностьРод\",\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ТекущаяДолжностьДат\",\t\t\"_____________________\");\t// Эксперту\r\n\tСтруктура.Вставить(\"ТекущаяДолжностьВин\",\t\t\"_____________________\");\t// Эксперта\r\n\tСтруктура.Вставить(\"ТекущаяДолжностьТвор\",\t\t\"_____________________\"); \t// Экспертом\r\n\tСтруктура.Вставить(\"ТекущаяДолжностьПред\",\t\t\"_____________________\");\t// Эксперте\r\n\t\t\r\n\tСтруктура.Вставить(\"Подразделение\",\t\t\t\t\"_____________________\");\t// Служба безопасности \r\n\t\r\n\tСтруктура.Вставить(\"ПроцентСевернойНадбавки\",\t\t\"_______\");\t\t\t\t// 50 \r\n\tСтруктура.Вставить(\"РайонныйКоэффициент\",\t\t\t\"_______\");\t\t\t\t// 1,6\r\n\tСтруктура.Вставить(\"ПроцентРайонныйКоэффициент\",\t\"_______\");\t\t\t\t// 60%\r\n\tСтруктура.Вставить(\"ПроцентНадбавкиЗаВредность\",\t\"—\");\t\t\t\t\t// 4%\r\n\t\r\n\tСтруктура.Вставить(\"ТарифнаяСтавка\", \t\t\t\t\"________\");  \t\t\t// 102,00\r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаЧисло\", \t\t\t\"________\");  \t\t\t// 102,00\r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаНаПечать\",\t\t\"__________________\");  // 102 руб. 00 коп.\r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаПрописью\",\t\t\"__________________\");  // сто два рубля 00 коп.\r\n\t\r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаПочасоваяЧисло\",\t\"_______\");\t\t\t\t// \r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаПочасоваяНаПечать\",\"__________________\"); // 102 руб. 00 коп.\r\n\tСтруктура.Вставить(\"ТарифнаяСтавкаПочасоваяПрописью\",\"__________________\"); // сто два рубля 00 коп.\r\n\t\r\n\tСтруктура.Вставить(\"ДатаПриемаД\",\t\t\t\t\t\"__________________\");  // 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаПриемаДД\",\t\t\t\t\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"ДатаУвольненияД\",\t\t\t\t\"__________________\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаУвольненияДД\",\t\t\t\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"НомерТрудовогоДоговора\",\t\t\"____\");\t\t\t\t// 182\r\n\tСтруктура.Вставить(\"ДатаТрудовогоДоговораД\",\t\t\"__________________\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаТрудовогоДоговораДД\",\t\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговора\",\tТекущаяДата());\t\t\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговораД\",\t\"__________________\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговораДД\",\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"ДатаОкончанияТрудовогоДоговораД\",\t\"__________________\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаОкончанияТрудовогоДоговораДД\",\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"СрокЗаключенияДоговора\",\t\t\t\"неопределенный срок\");\t\r\n\tСтруктура.Вставить(\"СрокЗаключенияДоговораОписание\",\t\"\"); //На время исполнения государственного контракта № 02-22-2 от 11.04.2022г.\t\r\n\tСтруктура.Вставить(\"ОснованиеСрочногоДоговора\",\t\t\t\"\");\r\n\t\r\n\tСтруктура.Вставить(\"ПродолжительностьРабочейНедели\",\t\"___\"); \t\t\t// 48\r\n\t\t\r\n\tСтруктура.Вставить(\"НомерПриказа\",\t\t\t\t\t\"____\");                // 182\r\n\tСтруктура.Вставить(\"ДатаПриказаД\",\t\t\t\t\t\"__________________\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаПриказаДД\",\t\t\t\t\t\"__________________\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"ВидЗанятости\",\t\t\t\t\"_____________________\");\t// Основное место работы\r\n\tСтруктура.Вставить(\"ВидЗанятостиРод\",\t\t\t\"_____________________\");\t// Основного места работы\r\n    Структура.Вставить(\"ВидЗанятостиДат\",\t\t\t\"_____________________\");\t// Основному месту работы\r\n\tСтруктура.Вставить(\"ВидЗанятостиВин\",\t\t\t\"_____________________\");\t// Основное место работы\r\n\tСтруктура.Вставить(\"ВидЗанятостиТвор\",\t\t\t\"_____________________\");\t// Основным местом работы\r\n\tСтруктура.Вставить(\"ВидЗанятостиПред\",\t\t\t\"_____________________\");\t// об Основном месте работы\r\n\t\r\n\tСтруктура.Вставить(\"ОтпускОсновной\",\t\t\t\"___\");\t\t\t\t\t\t// 24\r\n\tСтруктура.Вставить(\"ОтпускЗаВредность\",\t\t\t\"___\");\t\t\t\t\t\t// 5 \r\n\tСтруктура.Вставить(\"ОтпускСеверные\",\t\t\t\"___\");\t\t\t\t\t\t// 18 \r\n\t\r\n\tСтруктура.Вставить(\"КоличествоСтавок\",\t\t\t\" - \"); // 1 / 0,5 / 0,25 - В зависимости от ставки\r\n\tСтруктура.Вставить(\"ДоляСтавки\", \t\t\t\t\" - \"); // на полную ставку / на 0,5 ставки / на 0,25 ставки \r\n\t\r\n\tСтруктура.Вставить(\"КлассУсловийСпецоценка\",\t\"\"); // Подкласс 3.1 класса условий труда \"вредный\"\r\n\t\r\n\t\r\n\tСтруктура.Вставить(\"БанкСотрудника\",\t\"\"); \t\t// Филиал № 2754 ВТБ (ПАО) \r\n\tСтруктура.Вставить(\"БанкИННСотрудника\",\t\"\"); \t\t// 7702070139 \r\n\tСтруктура.Вставить(\"БанкКППСотрудника\",\t\"\"); \t\t// 272143002 \r\n\tСтруктура.Вставить(\"БанкКорСчетСотрудника\",\t\"\"); \t// 30101810708130000713 \r\n\tСтруктура.Вставить(\"БанкБИКСотрудника\",\t\"\"); \t\t// 040813713 \r\n\tСтруктура.Вставить(\"БанкСчетСотрудника\",\"\");\t\t// 4**17*10**023**00**7\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\t\r\n\t\r\n\tКадровыеДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, \r\n    ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Сотрудник), \r\n    \"Организация,ФизическоеЛицо,ТабельныйНомер,Подразделение,Должность,ВидЗанятости,ДолжностьПоШтатномуРасписанию, ПроцентСевернойНадбавки, \r\n\t| ТарифнаяСтавка, ТекущаяТарифнаяСтавка, Надбавка, ДатаДоговораКонтракта, НомерДоговораКонтракта, ДатаНачала, ДатаОкончания, СрочныйДоговор, ОснованиеСрочногоДоговора, СрокЗаключенияДоговора, \r\n\t| КоличествоСтавок,ДатаПриема,ДатаУвольнения,ГрафикРаботы,СтатьяФинансирования, РазрядКатегория, ТекущаяДолжность, ПриказОПриеме, МестоВыплаты\", ТекущаяДата())[0];  \r\n\r\n\t\r\n\t// Заполняем параметр актуальности данных\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ПриказОПриеме) И \r\n\t\tЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаПриема) Тогда\r\n\t\tСтруктура.ДатаАктуальностиДанных = КадровыеДанныеСотрудника.ДатаПриема; \r\n\t\tДатаАктуальности = КонецДня(Структура.ДатаАктуальностиДанных);\r\n\tКонецЕсли;\r\n\t\r\n\t//Должность\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.Должность) Тогда\r\n\t\tСтруктура.Должность\t\t\t\t\t= КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование;\r\n\t\tСтруктура.ДолжностьРод\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.Должность.Наименование, 2);\r\n\t\tСтруктура.ДолжностьДат\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.Должность.Наименование, 3);\r\n\t\tСтруктура.ДолжностьВин\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.Должность.Наименование, 4);\r\n\t\tСтруктура.ДолжностьТвор\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.Должность.Наименование, 5);\r\n\t\tСтруктура.ДолжностьПред\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.Должность.Наименование, 6);\r\n\tКонецЕсли;\r\n\r\n\t//ДолжностьПоШтатномуРасписанию\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию) Тогда\t\r\n\t\tСтруктура.ДолжностьШР\t\t\t\t\t= КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование;\r\n\t\tСтруктура.ДолжностьШРРод\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Наименование, 2);\r\n\t\tСтруктура.ДолжностьШРДат\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Наименование, 3);\r\n\t\tСтруктура.ДолжностьШРВин\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Наименование, 4);\r\n\t\tСтруктура.ДолжностьШРТвор\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Наименование, 5);\r\n\t\tСтруктура.ДолжностьШРПред\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Наименование, 6);\r\n\tКонецЕсли; \r\n\t\r\n\t//Должность и разряд\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию) Тогда\r\n\t\tРазрядКатегория = КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.РазрядКатегория; \r\n\t\tЕсли ЗначениеЗаполнено(РазрядКатегория) Тогда\r\n\t\t\tСтруктура.ДолжностьИРазряд\t\t\t\t= КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t            + \", \" + РазрядКатегория.Наименование;\r\n\t\t\tСтруктура.ДолжностьИРазрядРод\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t\t\t\t+ \", \" + РазрядКатегория.Наименование, 2);\r\n\t\t\tСтруктура.ДолжностьИРазрядДат\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t\t\t\t+ \", \" + РазрядКатегория.Наименование, 3);\r\n\t\t\tСтруктура.ДолжностьИРазрядВин\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t\t\t\t+ \", \" + РазрядКатегория.Наименование, 4);\r\n\t\t\tСтруктура.ДолжностьИРазрядТвор\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t\t\t\t+ \", \" + РазрядКатегория.Наименование, 5);\r\n\t\t\tСтруктура.ДолжностьИРазрядПред\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование\r\n\t\t\t\t\t\t\t+ \", \" + РазрядКатегория.Наименование, 6);  \r\n\t\tИначе\r\n\t\t\tСтруктура.ДолжностьИРазряд\t\t\t\t= КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование;\r\n\t\t\tСтруктура.ДолжностьИРазрядРод\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование, 2);\r\n\t\t\tСтруктура.ДолжностьИРазрядДат\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование, 3);\r\n\t\t\tСтруктура.ДолжностьИРазрядВин\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование, 4);\r\n\t\t\tСтруктура.ДолжностьИРазрядТвор\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование, 5);\r\n\t\t\tСтруктура.ДолжностьИРазрядПред\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию.Должность.Наименование, 6);\r\n\t\tКонецЕсли;\r\n\t\t\t\t\t\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t//ТекущаяДолжность\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ТекущаяДолжность) Тогда\r\n\t\tСтруктура.ТекущаяДолжность\t\t\t\t\t= КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование;\r\n\t\tСтруктура.ТекущаяДолжностьРод\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование, 2);\r\n\t\tСтруктура.ТекущаяДолжностьДат\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование, 3);\r\n\t\tСтруктура.ТекущаяДолжностьВин\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование, 4);\r\n\t\tСтруктура.ТекущаяДолжностьТвор\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование, 5);\r\n\t\tСтруктура.ТекущаяДолжностьПред\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(КадровыеДанныеСотрудника.ТекущаяДолжность.Наименование, 6);\r\n\tКонецЕсли; \r\n\t\r\n\t//Подразделение\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.Подразделение) Тогда\r\n\t\tСтруктура.Подразделение\t\t\t\t\t= КадровыеДанныеСотрудника.Подразделение.Наименование;\t\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить подразделение\" + Символы.ПС;\t\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t//Процент северной надбавки\r\n\tЕсли ЗначениеЗАполнено(КадровыеДанныеСотрудника.ПроцентСевернойНадбавки) Тогда\r\n\t\tСтруктура.ПроцентСевернойНадбавки = КадровыеДанныеСотрудника.ПроцентСевернойНадбавки;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить процент северной надбавки\" + Символы.ПС;\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t//Районный коэффициент\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ РАЗЛИЧНЫЕ\r\n\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Показатель КАК Показатель,\r\n\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Значение КАК Значение,\r\n\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.ДействуетДо КАК ДействуетДо,\r\n\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Организация КАК Организация\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудников.СрезПоследних(\r\n\t\t|\t\t\t&ТекДата,\r\n\t\t|\t\t\tПоказатель = &Показатель\r\n\t\t|\t\t\t\tИ Сотрудник = &Сотрудник) КАК ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних\";\r\n\t\r\n\tПопытка\r\n\t\t// Попытка сделана для разных версий ЗУП\r\n\t\tЗапрос.УстановитьПараметр(\"Показатель\", Справочники.ПоказателиРасчетаЗарплаты.РайонныйКоэффициент);\r\n\tИсключение\r\n\t\tЗапрос.УстановитьПараметр(\"Показатель\", Справочники.ПоказателиРасчетаЗарплаты.РайонныйКоэффициентРФ);\r\n    КонецПопытки;\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\tЗапрос.УстановитьПараметр(\"ТекДата\", ДатаАктуальности);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\tСтруктура.РайонныйКоэффициент = ВыборкаДетальныеЗаписи.Значение;\r\n\t\tСтруктура.ПроцентРайонныйКОэффициент = (ВыборкаДетальныеЗаписи.Значение - 1) * 100;\r\n\tКонецЦикла;\r\n\t\r\n\t//Надбавка за вредность\r\n\tЕсли ПолучитьФункциональнуюОпцию(\"ИспользоватьНадбавкуЗаВредность\") Тогда\r\n\t\tЗапрос = Новый Запрос;\r\n\t\tЗапрос.Текст = \r\n\t\t\t\"ВЫБРАТЬ РАЗЛИЧНЫЕ\r\n\t\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Показатель КАК Показатель,\r\n\t\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Значение КАК Значение,\r\n\t\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.ДействуетДо КАК ДействуетДо,\r\n\t\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Организация КАК Организация\r\n\t\t\t|ИЗ\r\n\t\t\t|\tРегистрСведений.ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудников.СрезПоследних(\r\n\t\t\t|\t\t\t&ТекДата,\r\n\t\t\t|\t\t\tПоказатель = &Показатель\r\n\t\t\t|\t\t\t\tИ Сотрудник = &Сотрудник) КАК ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних\";\r\n\t\t\r\n\t\tЗапрос.УстановитьПараметр(\"Показатель\", Справочники.ПоказателиРасчетаЗарплаты.ПроцентНадбавкиЗаВредность);\r\n\t\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\t\tЗапрос.УстановитьПараметр(\"ТекДата\", ДатаАктуальности);\r\n\t\t\r\n\t\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\t\r\n\t\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\t\r\n\t\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\t\tСтруктура.ПроцентНадбавкиЗаВредность = Строка(ВыборкаДетальныеЗаписи.Значение) + \"%\";\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\t\r\n\t//Тарифная ставка\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ТарифнаяСтавка) Тогда\r\n\t\tСтруктура.ТарифнаяСтавка = КадровыеДанныеСотрудника.ТарифнаяСтавка;\r\n\t\tСтруктура.ТарифнаяСтавкаЧисло = Формат(КадровыеДанныеСотрудника.ТарифнаяСтавка, \"ЧДЦ=2\");\r\n\t\tСтруктура.ТарифнаяСтавкаНаПечать = ЗарплатаКадрыОтчеты.ТарифнаяСтавкаНаПечать(КадровыеДанныеСотрудника.ТарифнаяСтавка, Истина);\r\n\t\tСтруктура.ТарифнаяСтавкаПрописью = РаботаСКурсамиВалют.СформироватьСуммуПрописью(КадровыеДанныеСотрудника.ТарифнаяСтавка, Справочники.Валюты.НайтиПоКоду(643));\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить тарифную ставку\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\t\r\n\t//Тарифная ставка почасовая\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Значение КАК Значение\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудников.СрезПоследних(\r\n\t\t|\t\t\t&ДатаПриема,\r\n\t\t|\t\t\tСотрудник = &Сотрудник\r\n\t\t|\t\t\t\tИ Организация = &Организация\r\n\t\t|\t\t\t\tИ Показатель = &Показатель) КАК ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ДатаПриема\", ДатаАктуальности);\t\r\n\tЗапрос.УстановитьПараметр(\"Организация\", Структура.Организация);\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\tЗапрос.УстановитьПараметр(\"Показатель\", Справочники.ПоказателиРасчетаЗарплаты.ТарифнаяСтавкаЧасовая);\r\n\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\tСтруктура.ТарифнаяСтавкаПочасоваяЧисло = Формат(ВыборкаДетальныеЗаписи.Значение, \"ЧДЦ=2\");\r\n\t\tСтруктура.ТарифнаяСтавкаПочасоваяНаПечать = ЗарплатаКадрыОтчеты.ТарифнаяСтавкаНаПечать(ВыборкаДетальныеЗаписи.Значение, Истина);\r\n\t\tСтруктура.ТарифнаяСтавкаПочасоваяПрописью = РаботаСКурсамиВалют.СформироватьСуммуПрописью(ВыборкаДетальныеЗаписи.Значение,\r\n\t\t\t\t\t\t\t\t\tСправочники.Валюты.НайтиПоКоду(643));\r\n\tКонецЦикла;\r\n\t\r\n\t\t\r\n\t//Дата приема на работу\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаПриема) Тогда\r\n\t\tСтруктура.ДатаПриемаД =\tФормат(КадровыеДанныеСотрудника.ДатаПриема, \"ДЛФ=Д\");\t// 01.01.2005   \r\n\t\tСтруктура.ДатаПриемаДД = Формат(КадровыеДанныеСотрудника.ДатаПриема, \"ДЛФ=ДД\");\t// 1 января 2005 г.\t\t\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату приема на работу сотрудника\" + Символы.ПС\t\r\n\tКонецЕсли; \r\n\t\r\n\t//Дата увольнения\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаУвольнения) Тогда\r\n\t\tСтруктура.ДатаУвольненияД = Формат(КадровыеДанныеСотрудника.ДатаУвольнения, \"ДЛФ=Д\");\t// 01.01.2005   \r\n\t\tСтруктура.ДатаУвольненияДД = Формат(КадровыеДанныеСотрудника.ДатаУвольнения, \"ДЛФ=ДД\");\t// 1 января 2005 г.\t\t\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату увольнения сотрудника\" + Символы.ПС\t\r\n\tКонецЕсли;\r\n\r\n\t\r\n\t\r\n\t//Трудовой договор номер\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.НомерДоговораКонтракта) Тогда\r\n\t\tСтруктура.Вставить(\"НомерТрудовогоДоговора\",\tКадровыеДанныеСотрудника.НомерДоговораКонтракта);\t// 182\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить номер договора сотрудника\" + Символы.ПС;\r\n\tКонецЕсли;\r\n\t\r\n\t//Трудовой договор Дата\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаДоговораКонтракта) Тогда\r\n\t\tСтруктура.Вставить(\"ДатаТрудовогоДоговораД\",\tФормат(КадровыеДанныеСотрудника.ДатаДоговораКонтракта, \"ДЛФ=Д\"));\t// 01.01.2005   \r\n\t\tСтруктура.Вставить(\"ДатаТрудовогоДоговораДД\",\tФормат(КадровыеДанныеСотрудника.ДатаДоговораКонтракта, \"ДЛФ=ДД\"));\t// 1 января 2005 г.\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату договора сотрудника\" + Символы.ПС;\r\n\tКонецЕсли; \r\n\r\n\t//Номер приказа и дата\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ПриказОПриеме) Тогда\r\n\t\tСтруктура.Вставить(\"ПриказОПриеме\",\tКадровыеДанныеСотрудника.ПриказОПриеме);\t\t\t\t\t// ссылка  \r\n\t\tСтруктура.Вставить(\"ПриказОПриемеНомер\",\tКадровыеДанныеСотрудника.ПриказОПриеме.Номер);\t\t// 0П00-000182  \r\n\t\tСтруктура.Вставить(\"ДатаПриказаД\",\tФормат(КадровыеДанныеСотрудника.ПриказОПриеме.Дата, \"ДЛФ=Д\"));\t// 01.01.2005   \r\n\t\tСтруктура.Вставить(\"ДатаПриказаДД\",\tФормат(КадровыеДанныеСотрудника.ПриказОПриеме.Дата, \"ДЛФ=ДД\"));\t// 1 января 2005 г.\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить приказ у сотрудника\" + Символы.ПС;\r\n\tКонецЕсли; \r\n\t\r\n\t//Дата начала трудового договора\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаНачала) Тогда\r\n\t\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговора\",\tКадровыеДанныеСотрудника.ДатаНачала);\t// 01.01.2005   \r\n\t\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговораД\",\tФормат(КадровыеДанныеСотрудника.ДатаНачала, \"ДЛФ=Д\"));\t// 01.01.2005   \r\n\t\tСтруктура.Вставить(\"ДатаНачалаТрудовогоДоговораДД\",\tФормат(КадровыеДанныеСотрудника.ДатаНачала, \"ДЛФ=ДД\"));\t// 1 января 2005 г.\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату начала трудового договора у сотрудника\" + Символы.ПС;\r\n\tКонецЕсли;  \r\n\t\r\n\t//Дата окончания трудового договора\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ДатаНачала) Тогда\r\n\t\tСтруктура.Вставить(\"ДатаОкончанияТрудовогоДоговораД\",\tФормат(КадровыеДанныеСотрудника.ДатаОкончания, \"ДЛФ=Д\"));\t// 01.01.2005   \r\n\t\tСтруктура.Вставить(\"ДатаОкончанияТрудовогоДоговораДД\",\tФормат(КадровыеДанныеСотрудника.ДатаОкончания, \"ДЛФ=ДД\"));\t// 1 января 2005 г.\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату окончания трудового договора у сотрудника\" + Символы.ПС;\r\n\tКонецЕсли; \r\n\t\r\n\t\r\n\t//Срок Заключения Договора\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.СрочныйДоговор) И КадровыеДанныеСотрудника.СрочныйДоговор Тогда\r\n\t\tСтруктура.СрокЗаключенияДоговора\t\t\t= \"Определенный срок\" + \" до \" + Структура.ДатаОкончанияТрудовогоДоговораДД;  \r\n\t\tСтруктура.СрокЗаключенияДоговораОписание\t= КадровыеДанныеСотрудника.СрокЗаключенияДоговора ;\r\n\t\tСтруктура.ОснованиеСрочногоДоговора \t\t= КадровыеДанныеСотрудника.ОснованиеСрочногоДоговора;\t\r\n\tКонецЕсли;\r\n\t\r\n\t//ПродолжительностьРабочейНедели\r\n\tЕсли ЗначениеЗАполнено(КадровыеДанныеСотрудника.ГрафикРаботы) Тогда\r\n\t\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ГрафикРаботы.ДлительностьРабочейНедели) Тогда\r\n\t\t\tСтруктура.ПродолжительностьРабочейНедели = КадровыеДанныеСотрудника.ГрафикРаботы.ДлительностьРабочейНедели;\t\r\n\t\tИначе\r\n\t\t\t//Ошибки = Ошибки + \"Не удалось определить продолжительность рабочей недели в графике\" + Символы.ПС;\t\t\t\r\n\t\tКонецЕсли;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить график работы в документе\" + Символы.ПС;\t\t\t\t\r\n\tКонецЕсли;\r\n\r\n\t//ВидЗанятости\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.ВидЗанятости) Тогда\r\n\t\tСтруктура.ВидЗанятости\t\t\t\t\t= Строка(КадровыеДанныеСотрудника.ВидЗанятости);\r\n\t\tСтруктура.ВидЗанятостиРод\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(КадровыеДанныеСотрудника.ВидЗанятости), 2);\r\n\t\tСтруктура.ВидЗанятостиДат\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(КадровыеДанныеСотрудника.ВидЗанятости), 3);\r\n\t\tСтруктура.ВидЗанятостиВин\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(КадровыеДанныеСотрудника.ВидЗанятости), 4);\r\n\t\tСтруктура.ВидЗанятостиТвор\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(КадровыеДанныеСотрудника.ВидЗанятости), 5);\r\n\t\tСтруктура.ВидЗанятостиПред\t\t\t\t= СклонениеПредставленийОбъектов.ПросклонятьПредставление(Строка(КадровыеДанныеСотрудника.ВидЗанятости), 6);\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не заполнен вид занятости в документе\" + Символы.ПС;\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t// Оптуска\r\n\tЗаполнитьОтпускаИзРегистра(Структура, Сотрудник);\r\n\t\r\n\t// Количество ставок\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tКадроваяИсторияСотрудниковСрезПоследних.КоличествоСтавок КАК КоличествоСтавок\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.КадроваяИсторияСотрудников.СрезПоследних(&ДатаОкончания, Сотрудник = &Сотрудник) КАК КадроваяИсторияСотрудниковСрезПоследних\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ДатаОкончания\", ТекущаяДата());\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\tСтруктура.КоличествоСтавок = ВыборкаДетальныеЗаписи.КоличествоСтавок;\r\n\tКонецЦикла;\r\n\t\r\n\t// Доля ставки\r\n\tЕсли Структура.КоличествоСтавок = 1 Тогда\r\n\t\tСтруктура.ДоляСтавки = \"на полную ставку\";\r\n\tИначеЕсли Структура.КоличествоСтавок <> \" - \" Тогда\r\n\t\tСтруктура.ДоляСтавки = \" на \" + Структура.КоличествоСтавок + \" ставки\";\t\r\n\tКонецЕсли;    \r\n\t\r\n\t// Класс условий (спецоценка)\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tКлассыУсловийТрудаПоДолжностямСрезПоследних.КлассУсловийТруда КАК КлассУсловийТруда\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.КлассыУсловийТрудаПоДолжностям.СрезПоследних(&ДатаПриема, Должность = &Должность) КАК КлассыУсловийТрудаПоДолжностямСрезПоследних\";\r\n\t \r\n\tЗапрос.УстановитьПараметр(\"ДатаПриема\", ДатаАктуальности);\r\n\tЗапрос.УстановитьПараметр(\"Должность\", КадровыеДанныеСотрудника.ДолжностьПоШтатномуРасписанию);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\tСтруктура.КлассУсловийСпецоценка = ВыборкаДетальныеЗаписи.КлассУсловийТруда;\r\n\tКонецЦикла;\r\n\t\r\n\t//МестоВыплаты\r\n\tЕсли ЗначениеЗАполнено(КадровыеДанныеСотрудника.МестоВыплаты) Тогда\r\n\t\tЕсли ТипЗнч(КадровыеДанныеСотрудника.МестоВыплаты) = ТИП(\"СправочникСсылка.БанковскиеСчетаКонтрагентов\") Тогда \r\n\t\t\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.МестоВыплаты.Банк) Тогда\r\n\t\t\t\tСтруктура.БанкИННСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.Банк.ИНН;\t\r\n\t\t\t\tСтруктура.БанкКорСчетСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.Банк.КоррСчет;\r\n\t\t\t\t//Структура.БанкКППСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.Банк.ИНН;\r\n\t\t\t\tСтруктура.БанкБИКСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.Банк.БИКРКЦ;\r\n\t\t\t\tСтруктура.БанкСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.Банк.Наименование;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tСтруктура.БанкСчетСотрудника = КадровыеДанныеСотрудника.МестоВыплаты.НомерСчета;\r\n\t\tКонецЕсли;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить место выплаты\" + Символы.ПС;\t\t\r\n\tКонецЕсли;\r\n\r\n\t\r\nКонецПроцедуры\t\r\n\r\n&НаСервере\r\nПроцедура ПолучитьОбщиеДанныеДокумента(Документ, Структура, Ошибки)\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"ДатаДокументаД\", \t\t\t\"«_____» ___________ 20__ г.\");\t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаДокументаДД\", \t\t\t\"«_____» ___________ 20__ г.\");\t// 1 января 2005 г.\r\n\t\t\r\n\tСтруктура.Вставить(\"НомерДокумента\", \t\t\t\"___\"); // ПП-1 / 14, типовой механизм при печати номеров в документах\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\tСтруктура.ДатаДокументаД\t= Формат(Документ.Дата, \"ДЛФ=Д\");\t// 01.01.2005\r\n\tСтруктура.ДатаДокументаДД\t= Формат(Документ.Дата, \"ДЛФ=ДД\");\t// 1 января 2005 г.\r\n\t\r\n\tСтруктура.НомерДокумента \t= ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(Документ.Номер, Ложь, Истина);\r\n\r\nКонецПроцедуры\t\r\n\r\n&НаСервере\r\nПроцедура ПолучитьДанныеПримемаНаРаботу(Документ, Структура, Ошибки)\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\tСтруктура.Вставить(\"ИспытательныйСрокЧисло\", \t\"без срока испытания\");\t\t\t\t\t\t\t// 3\r\n\tСтруктура.Вставить(\"ИспытательныйСрокПрописью\", \"без срока испытания\");\t\t\t\t\t\t\t// Три\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\t//Испытательный Срок\r\n\tПараметрыПредметаИсчисления = \"месяц,месяца,месяцев,м,,,,,0\";\r\n\tФорматнаяСтрока = \"Л=ru_RU\"; \r\n      \r\n   Попытка\r\n\t\tЕсли ЗначениеЗаполнено(Документ.ДлительностьИспытательногоСрока) Тогда \r\n\t\t\tСтруктура.Вставить(\"ИспытательныйСрокЧисло\", Документ.ДлительностьИспытательногоСрока);\r\n\t\t\tСтруктура.Вставить(\"ИспытательныйСрокПрописью\", ЧислоПрописью(Документ.ДлительностьИспытательногоСрока,ФорматнаяСтрока,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tПараметрыПредметаИсчисления));\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\tИсключение КонецПопытки;\r\n\t\t\r\n\t\r\n\t\t\r\nКонецПроцедуры\t\r\n\r\n&НаСервере\r\nПроцедура ПолучитьДанныеГПХ(Документ, Структура, Ошибки)\r\n\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\tСтруктура.Вставить(\"ДатаДНачалаГПХ\",\t\t\t\"«_____» ___________ 20__ г.\"); \t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаДДНачалаГПХ\",\t\t\t\"«_____» ___________ 20__ г.\"); // 1 января 2005 г.\r\n\r\n\tСтруктура.Вставить(\"ДатаДОкончаниеГПХ\",\t\t\t\"«_____» ___________ 20__ г.\"); \t// 01.01.2005\r\n\tСтруктура.Вставить(\"ДатаДДОкончаниеГПХ\",\t\t\"«_____» ___________ 20__ г.\"); // 1 января 2005 г.\r\n\t\r\n\tСтруктура.Вставить(\"НомерПервичногоДокумента\",\t\"_____\"); \t\t\t\t// 123\r\n    Структура.Вставить(\"НомерГПХ\",\t\t\t\t\t\"_____\"); \t\t\t\t// 123\r\n\r\n\r\n\tСтруктура.Вставить(\"СуммаДоговора\", \t\t\t\"________\");  \t\t\t// 102,00\r\n\tСтруктура.Вставить(\"СуммаДоговораНаПечать\",\t\t\"__________________\");  // 102 руб. 00 коп.\r\n\tСтруктура.Вставить(\"СуммаДоговораПрописью\",\t\t\"__________________\");  // сто два рубля 00 коп. \r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\t//ДатаДНачалаГПХ\r\n\tЕсли ЗначениеЗаполнено(Документ.ДатаОкончания) Тогда\r\n\t\tСтруктура.ДатаДНачалаГПХ\t \t= Формат(Документ.ДатаНачала, \"ДЛФ=Д\");\t\t// 01.01.2005\r\n\t\tСтруктура.ДатаДДНачалаГПХ\t\t= Формат(Документ.ДатаНачала, \"ДЛФ=ДД\");\t\t// 1 января 2005 г. \r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату окончания договора\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\r\n\t//ДатаДОкончаниеГПХ\r\n\tЕсли ЗначениеЗаполнено(Документ.ДатаОкончания) Тогда\r\n\t\tСтруктура.ДатаДОкончаниеГПХ\t \t= Формат(Документ.ДатаОкончания, \"ДЛФ=Д\");\t\t// 01.01.2005\r\n\t\tСтруктура.ДатаДДОкончаниеГПХ\t= Формат(Документ.ДатаОкончания, \"ДЛФ=ДД\");\t\t// 1 января 2005 г. \r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить дату окончания договора\" + Символы.ПС;\t\r\n\tКонецЕсли; \r\n\t\r\n\t//Номер первичного документа и номер гпх\r\n\tЕсли ЗначениеЗаполнено(Документ.НомерПервичногоДокумента) Тогда\r\n\t\tСтруктура.НомерГПХ\t \t\t\t\t\t= ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(Документ.Номер, Ложь, Истина); \r\n\t\tЕсли ЗначениеЗаполнено(Документ.НомерПервичногоДокумента) Тогда\r\n\t\t\tСтруктура.НомерПервичногоДокумента\t= Документ.НомерПервичногоДокумента;\r\n\t\tИначе\r\n\t\t\tСтруктура.НомерПервичногоДокумента\t= Структура.НомерГПХ;\r\n\t\tКонецЕсли;\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить номер договора\" + Символы.ПС;\t\r\n\tКонецЕсли;\r\n\r\n\r\n\t\r\n\t//СуммаДоговора\r\n\tЕсли ЗначениеЗаполнено(Документ.Сумма) Тогда\r\n\t\tСтруктура.СуммаДоговора = Документ.Сумма;\r\n\t\tСтруктура.СуммаДоговораНаПечать = ЗарплатаКадрыОтчеты.ТарифнаяСтавкаНаПечать(Документ.Сумма, Истина);\r\n\t\tСтруктура.СуммаДоговораПрописью = РаботаСКурсамиВалют.СформироватьСуммуПрописью(Документ.Сумма, Справочники.Валюты.НайтиПоКоду(643));\r\n\tИначе\r\n\t\t//Ошибки = Ошибки + \"Не удалось определить сумму договора\" + Символы.ПС;\t\r\n\tКонецЕсли;\t\r\n\r\nКонецПроцедуры\t\r\n\t\r\n&НаСервере\r\nПроцедура ЗаполнитьДополнительныеДанные(Сотрудник, Документ, Структура, Ошибки)\r\n\t\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------// \r\n\t\r\n\t// Дополнительные данные на те случаи, когда нужны параметры применымие только к конкретному клиенту\r\n\t\r\n\t//Структура.Вставить(\"СпециалистПоКадрам\",\tСпециалистПоКадрам); \t// 48    \r\n\t//Структура.Вставить(\"ДопПремия\",\t\t\t\t\"\"); \t// 48  \r\n\tСтруктура.Вставить(\"ОтпускЗаНенормируемость\",\t\"___\");\t\t\t\t\t\t// 10 \r\n\tСтруктура.Вставить(\"ПроцентнаяНадбавкаЗаРазделениеДняНаЧасти\", \"50\");\r\n\r\n\t//--------------------------------------------------------------------------------------------------------------------------------------//\r\n\t\r\n\t//Отпуск за ненормируемость и др. отпуска по их видам\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tПоложенныеВидыЕжегодныхОтпусковСрезПоследних.КоличествоДнейВГод КАК КоличествоДнейВГод,\r\n\t\t|\tПоложенныеВидыЕжегодныхОтпусковСрезПоследних.ВидЕжегодногоОтпуска КАК ВидЕжегодногоОтпуска\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ПоложенныеВидыЕжегодныхОтпусков.СрезПоследних(&Дата, Сотрудник = &Сотрудник) КАК ПоложенныеВидыЕжегодныхОтпусковСрезПоследних\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\tЕсли Структура.Свойство(\"ПриказОПриеме\") Тогда // на сотрудника заведен прием и берем дату начала трудового договора.\r\n\t\tЗапрос.УстановитьПараметр(\"Дата\", КонецДня(Структура.ДатаНачалаТрудовогоДоговора));\t\r\n\tИначе // Значит сотрудник занесен начальным ШР \r\n\t\tЗапрос.УстановитьПараметр(\"Дата\", КонецДня(ТекущаяДата()));\r\n\tКонецЕсли;\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\tВыборка = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока Выборка.Следующий() Цикл\r\n\t\tЕсли Выборка.ВидЕжегодногоОтпуска.Наименование = \"Отпуск за ненормированный рабочий день\" Тогда\r\n\t\t\tСтруктура[\"ОтпускЗаНенормируемость\"] = Выборка.КоличествоДнейВГод; \r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\t// Выбор оклада или ставки\r\n\tЕсли Структура.ТарифнаяСтавкаПочасоваяЧисло <> \"_______\" Тогда\r\n\t\tСтруктура.ТарифнаяСтавкаЧисло = \"—\";\r\n\tИначе\r\n\t\tСтруктура.ТарифнаяСтавкаПочасоваяЧисло = \"—\";\t\r\n\tКонецЕсли;   \r\n\t\r\n\t// Испытательный срок из дополнительного реквизита\r\n\tЕсли НЕ Структура.Свойство(\"ИспытательныйСрокЧисло\") Тогда \r\n\t\tСтруктура.Вставить(\"ИспытательныйСрокЧисло\", \t\"без срока испытания\");\t\t\t\t\t\t\t// 3\r\n\t\tСтруктура.Вставить(\"ИспытательныйСрокПрописью\", \"без срока испытания\");\t\t\t\t\t\t\t// Три\r\n\t\t\r\n\t\tИспытательныйСрокВСотруднике = ПолучитьЗначениеДопРеквизитаСведения(Сотрудник, \"itpИспытательныйСрок\");\r\n\t\tЕсли ЗначениеЗаполнено(ИспытательныйСрокВСотруднике) Тогда \r\n\t\t\t//Испытательный Срок\r\n\t\t\tПараметрыПредметаИсчисления = \"месяц,месяца,месяцев,м,,,,,0\";\r\n\t\t\tФорматнаяСтрока = \"Л=ru_RU\"; \r\n\t\t\tСтруктура.ИспытательныйСрокЧисло = ИспытательныйСрокВСотруднике;\r\n\t\t\tСтруктура.ИспытательныйСрокПрописью = ЧислоПрописью(ИспытательныйСрокВСотруднике,ФорматнаяСтрока,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tПараметрыПредметаИсчисления)\r\n\t\tКонецЕсли;\t\r\n\tКонецЕсли;\r\n\t\t\r\n\t\t\r\nКонецПроцедуры\t\r\n\r\n#Область ВспомогательныеФункции\r\n\r\n&НаСервере\r\nФункция ОпределитьОрганизацию(Сотрудник, Документ = Неопределено) \r\n\t\r\n\tКадровыеДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, \r\n    ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Сотрудник), \r\n    \"Организация\", ТекущаяДата())[0];  \r\n\t\r\n\tЕсли ЗначениеЗаполнено(КадровыеДанныеСотрудника.Организация) Тогда\r\n\t\tВозврат КадровыеДанныеСотрудника.Организация;\r\n\tКонецЕсли;\r\n\t\r\n\tОрганизация = Неопределено;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tОрганизации.Ссылка КАК Ссылка\r\n\t\t|ИЗ\r\n\t\t|\tСправочник.Организации КАК Организации\r\n\t\t|ГДЕ\r\n\t\t|\tНЕ Организации.ПометкаУдаления\";\r\n\tРезультатЗапроса = Запрос.Выполнить().Выгрузить();\r\n\tЕсли РезультатЗапроса.Количество() = 1 Тогда \r\n\t\t//Если у нас только 1 организация\r\n\t\tОрганизация = РезультатЗапроса[0].Ссылка;\r\n\tИначе\r\n\t\t//Если у нас несколько организаций, ищем по сотруднику документ принятия на работу и берем организацию оттуда.\r\n\t\tЗапрос = Новый Запрос;\r\n\t\tЗапрос.Текст = \r\n\t\t\t\"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t\t|\tКадроваяИсторияСотрудниковСрезПоследних.ГоловнаяОрганизация КАК ГоловнаяОрганизация,\r\n\t\t\t|\tКадроваяИсторияСотрудниковСрезПоследних.Организация КАК Организация\r\n\t\t\t|ИЗ\r\n\t\t\t|\tРегистрСведений.КадроваяИсторияСотрудников.СрезПоследних(, Сотрудник = &Сотрудник) КАК КадроваяИсторияСотрудниковСрезПоследних\";\t\r\n\t\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\t\tРезультатЗапроса = Запрос.Выполнить().Выгрузить();\r\n\t\tЕсли РезультатЗапроса.Количество() = 1 Тогда\r\n\t\t\tОрганизация = ?(ЗначениеЗаполнено(РезультатЗапроса[0].Организация),РезультатЗапроса[0].Организация,РезультатЗапроса[0].ГоловнаяОрганизация);\t\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\r\n\tЕсли НЕ ЗначениеЗаполнено(Организация) Тогда\r\n\t\tПопытка\r\n\t\t\tОрганизация = Документ.Организация;\r\n\t\tИсключение\r\n\t\tКонецПопытки;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Организация;\r\n\t\r\nКонецФункции\r\n\r\n&НаСервере\r\nПроцедура ЗаполнитьОтпускаИзРегистра(Структура, Сотрудник)\r\n\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tПоложенныеВидыЕжегодныхОтпусковСрезПоследних.КоличествоДнейВГод КАК КоличествоДнейВГод,\r\n\t\t|\tПоложенныеВидыЕжегодныхОтпусковСрезПоследних.ВидЕжегодногоОтпуска КАК ВидЕжегодногоОтпуска\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ПоложенныеВидыЕжегодныхОтпусков.СрезПоследних(, Сотрудник = &Сотрудник) КАК ПоложенныеВидыЕжегодныхОтпусковСрезПоследних\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\tВыборка = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока Выборка.Следующий() Цикл\r\n\t\tЕсли Выборка.ВидЕжегодногоОтпуска = Справочники.ВидыОтпусков.Основной Тогда\r\n\t\t\tСтруктура[\"ОтпускОсновной\"] = Выборка.КоличествоДнейВГод; \r\n\t\tИначеЕсли  ПолучитьФункциональнуюОпцию(\"ИспользоватьНадбавкуЗаВредность\") И Выборка.ВидЕжегодногоОтпуска = Справочники.ВидыОтпусков.ОтпускЗаВредность Тогда\r\n\t\t\tСтруктура[\"ОтпускЗаВредность\"] = Выборка.КоличествоДнейВГод;\r\n\t\tИначеЕсли Выборка.ВидЕжегодногоОтпуска = Справочники.ВидыОтпусков.Северный Тогда\r\n\t\t\tСтруктура[\"ОтпускСеверные\"] = Выборка.КоличествоДнейВГод;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\t\r\nКонецПроцедуры\r\n\r\n#КонецОбласти\r\n\r\n#Область РаботаСДополнительнымиРеквизитами\r\n\r\nПроцедура УстановитьЗначениеДопРеквизитаСведения(СсылкаНаОбъект, ИмяДляРазработчиков, Значение)  \r\n\t\r\n\tТаблица = Новый ТаблицаЗначений;\r\n\tТаблица.Колонки.Добавить(\"Свойство\");\r\n\tТаблица.Колонки.Добавить(\"Значение\");\r\n\tТаблица.Очистить();\t\r\n\t\r\n\tСвойство = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоРеквизиту(\"Имя\", ИмяДляРазработчиков);\t\r\n\r\n\tСтрока = Таблица.Добавить();\r\n\tСтрока.Свойство = Свойство;\r\n\tСтрока.Значение = Значение;\r\n\t\r\n\tУправлениеСвойствами.ЗаписатьСвойстваУОбъекта(СсылкаНаОбъект, Таблица);\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция ПолучитьЗначениеДопРеквизитаСведения(СсылкаНаОбъект, ИмяДляРазработчиков)  \r\n\t\r\n\tСвойство = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоРеквизиту(\"Имя\", ИмяДляРазработчиков);\r\n\tВозврат УправлениеСвойствами.ЗначениеСвойства(СсылкаНаОбъект, Свойство);\r\n\t\r\nКонецФункции\r\n\r\n#КонецОбласти\n\n{427} Высокая цикломатическая сложность: 32\r\nОрфографическая ошибка в ПолучитьДанныеПримемаНаРаботу (найдено 3): Примема\r\nОрфографическая ошибка в Михейцева (найдено 2): Михейцева\r\nОрфографическая ошибка в Михейцевой (найдено 8): Михейцевой\r\nОрфографическая ошибка в Михейцеву (найдено 2): Михейцеву\r\nОрфографическая ошибка в СнилсСотрудника (найдено 3): Снилс\r\nОрфографическая ошибка в ПросклоненныеФИО (найдено 31): Просклоненные\r\nОрфографическая ошибка в Имейл (найдено 3): Имейл\r\nОрфографическая ошибка в СписокПОказателей (найдено 2): Оказателей\r\nОрфографическая ошибка в ДолжнРук (найдено 8): Должн\r\nОрфографическая ошибка в имейл: имейл\r\nОрфографическая ошибка в КлассУсловийСпецоценка (найдено 2): Спецоценка\r\nОрфографическая ошибка в ПроцентРайонныйКОэффициент: Оэффициент\r\nОрфографическая ошибка в Оптуска: Оптуска\r\nОрфографическая ошибка в спецоценка: спецоценка\r\nОрфографическая ошибка в применымие: применымие\r\nОрфографическая ошибка в ОтпускЗаНенормируемость (найдено 2): Ненормируемость\r\nОрфографическая ошибка в ненормируемость: ненормируемость"
  },
  {
    "title": "Предупреждение-оповещение",
    "description": "Предупреждение-оповещение",
    "code_snippet": "ПоказатьПредупреждение(\r\n\t\tНеопределено, \"ТекстПредупреждения\", 3, \"Заголовок\");\n\nПоказатьПредупреждение(\r\n\t\tНеопределено, \"ТекстПредупреждения\", 3, \"Заголовок\");"
  },
  {
    "title": "Что делать, если сервер падает из-за перебоев с электричеством?",
    "description": "Что делать, если сервер падает из-за перебоев с электричеством?",
    "code_snippet": ""
  },
  {
    "title": "Убрать префикс и лидирующие нули",
    "description": "Убрать префикс и лидирующие нули",
    "code_snippet": "Функция ПолучитьНомер(Строка) \r\n\t\r\n\tRegExp = Новый COMОбъект(\"VBScript.RegExp\");\r\n\tRegExp.MultiLine = Истина;\r\n\tRegExp.Global = Истина;\r\n\tRegExp.IgnoreCase = Истина;\r\n\t\r\n\tШаблон = \"№ 0*(\\d+)\";\r\n\t\r\n\tRegExp.Pattern = Шаблон;\r\n\tMatches=RegExp.Execute(Строка);\t\r\n\t\r\n\tВозврат Matches;\r\n\t\r\nКонецФункции\n\nФункция ПолучитьНомер(Строка) \r\n\t\r\n\tRegExp = Новый COMОбъект(\"VBScript.RegExp\");\r\n\tRegExp.MultiLine = Истина;\r\n\tRegExp.Global = Истина;\r\n\tRegExp.IgnoreCase = Истина;\r\n\t\r\n\tШаблон = \"№ 0*(\\d+)\";\r\n\t\r\n\tRegExp.Pattern = Шаблон;\r\n\tMatches=RegExp.Execute(Строка);\t\r\n\t\r\n\tВозврат Matches;\r\n\t\r\nКонецФункции\n\nФункция УдалитьЛидирующиеНулиИзНомераОбъекта(Знач НомерОбъекта) Экспорт\n\t\n\tПользовательскийПрефикс = ПользовательскийПрефикс(НомерОбъекта);\n\t\n\tЕсли НомерСодержитСтандартныйПрефикс(НомерОбъекта) Тогда\n\t\t\n\t\tЕсли НомерСодержитПятизначныйПрефикс(НомерОбъекта) Тогда\n\t\t\tПрефикс = Лев(НомерОбъекта, 5);\n\t\t\tНомер = Сред(НомерОбъекта, 6 + СтрДлина(ПользовательскийПрефикс));\n\t\tИначе\n\t\t\tПрефикс = Лев(НомерОбъекта, 3);\n\t\t\tНомер = Сред(НомерОбъекта, 4 + СтрДлина(ПользовательскийПрефикс));\n\t\tКонецЕсли;\n\t\t\n\tИначе\n\t\t\n\t\tПрефикс = \"\";\n\t\tНомер = Сред(НомерОбъекта, 1 + СтрДлина(ПользовательскийПрефикс));\n\t\t\n\tКонецЕсли;\n\t\n\t// Удаляем лидирующие нули слева в номере.\n\tНомер = СтроковыеФункцииКлиентСервер.УдалитьПовторяющиесяСимволы(Номер, \"0\");\n\t\n\tВозврат Префикс + ПользовательскийПрефикс + Номер;\nКонецФункции"
  },
  {
    "title": "Переход к определению одним кликом",
    "description": "Переход к определению одним кликом",
    "code_snippet": ""
  },
  {
    "title": "Генерация методов \"на лету\"",
    "description": "Генерация методов \"на лету\"Секреты TurboConf",
    "code_snippet": ""
  },
  {
    "title": "Отправка сформированного отчета на почту (в виде html текста)",
    "description": "Отправка сформированного отчета на почту (в виде html текста)",
    "code_snippet": "// Описание ПочтовогоПрофиля;\r\n\tПочтовыйПрофиль  = Новый ИнтернетПочтовыйПрофиль;\r\n\t\r\n\t// SMTP (отправляем сообщение);    \r\n\tПочтовыйПрофиль.АдресСервераSMTP = \"smtp.yandex.com\";\r\n\t//ПочтовыйПрофиль.АдресСервераIMAP = \"imap.yandex.com\";\r\n\t\r\n\tПочтовыйПрофиль.ПользовательSMTP = \"xxxxx.xxxxxx@yandex.ru\";\r\n\tПочтовыйПрофиль.ПарольSMTP \t= \"tcbbrwraduriuusz\"; \r\n\t\r\n\tПочтовыйПрофиль.Пользователь = \"xxxxx.xxxxxx@yandex.ru\";\r\n\tПочтовыйПрофиль.Пароль = \"tcbbrwraduriuusz\";\r\n\t\r\n\tПочтовыйПрофиль.ПортSMTP = 465; \r\n\t//ПочтовыйПрофиль.ПортIMAP = 993;\r\n\tПочтовыйПрофиль.Таймаут = 30; // мс;\r\n\t\r\n\tПочтовыйПрофиль.ИспользоватьSSLSMTP = Истина;\r\n\tПочтовыйПрофиль.ИспользоватьSSLIMAP = Истина;\r\n\t\r\n\t// ИнтернетПочта;\r\n\tПочта = Новый ИнтернетПочта;\r\n\t\r\n\tПодключеноУспешно = Ложь;\r\n\tПопытка\r\n\t\tПочта.Подключиться(ПочтовыйПрофиль, ПротоколИнтернетПочты.IMAP);\r\n\t\tПодключеноУспешно = Истина;\r\n\tИсключение\r\n\tКонецПопытки;\r\n\t\r\n\t// Проверка;\r\n\tЕсли НЕ ПодключеноУспешно Тогда\r\n    \t        ЖурналРегистрации.ДобавитьСообщениеДляЖурналаРегистрации(ОписаниеОшибки(), \r\n                     УровеньЖурналаРегистрации.Ошибка,,,  \"Сообщение- не было отправлено!\");  \r\n\t\tВозврат;\r\n\tИначе\r\n\t\t\r\n\t\tАдресФайлаВложения = ПолучитьИмяВременногоФайла(\".txt\");\r\n\t\t\r\n\t\t// Формирование отчета;\r\n\t\tТаблДок = Новый ТабличныйДокумент;\r\n                // Формируем отчет (какой хотим);\r\n\t\tОтчеты.ABCXYZАнализНоменклатуры.Создать().СкомпоноватьРезультат(ТаблДок);   \r\n\t\tТаблДок.Записать(АдресФайлаВложения, ТипФайлаТабличногоДокумента.HTML);\r\n\t\t\r\n\t\tТекстHTML = \"\";\r\n\t\t\tТекДок = Новый ТекстовыйДокумент;\r\n\t\t\tТекДок.Прочитать(АдресФайлаВложения);\r\n\t\tТекстHTML = ТекДок.ПолучитьТекст();\r\n\t\t\r\n\t\t// Формирование сообщения;\r\n\t\tПочтовоеСообщение = Новый ИнтернетПочтовоеСообщение;\r\n\t\tПочтовоеСообщение.Тема \t\t= СтрШаблон(\"Отчет \"\"Остатки товаров организаций\"\" от %1\", Формат(ТекущаяДата(), \"ДЛФ=DD\"));\r\n\t\tПочтовоеСообщение.Важность \t= ВажностьИнтернетПочтовогоСообщения.Наивысшая;\r\n\t\tПочтовоеСообщение.Тексты.Добавить(ТекстHTML, ТипТекстаПочтовогоСообщения.HTML);\r\n\t\t//\r\n\t\tПочтовоеСообщение.Отправитель.Адрес = \"xxxxx.xxxxxx@yandex.ru\";\r\n\t\tПочтовоеСообщение.Получатели.Добавить(\"xxxxx.xxxxxx@yandex.ru\");  \r\n\t\t\r\n\t\t//ИнтернетПочтовоеВложение  = ПочтовоеСообщение.Вложения.Добавить(АдресФайлаВложения, \"Остатки товаров организаций\");\r\n\t\t\r\n\t\tПопытка\r\n\t\t\tСоответствиеОтвет = Почта.Послать(ПочтовоеСообщение,, ПротоколИнтернетПочты.SMTP);\t\r\n\t\tИсключение\r\n\t\tКонецПопытки;\r\n\t\t\r\n\tКонецЕсли;\n\n// Описание ПочтовогоПрофиля;\r\n\tПочтовыйПрофиль  = Новый ИнтернетПочтовыйПрофиль;\r\n\t\r\n\t// SMTP (отправляем сообщение);    \r\n\tПочтовыйПрофиль.АдресСервераSMTP = \"smtp.yandex.com\";\r\n\t//ПочтовыйПрофиль.АдресСервераIMAP = \"imap.yandex.com\";\r\n\t\r\n\tПочтовыйПрофиль.ПользовательSMTP = \"xxxxx.xxxxxx@yandex.ru\";\r\n\tПочтовыйПрофиль.ПарольSMTP \t= \"tcbbrwraduriuusz\"; \r\n\t\r\n\tПочтовыйПрофиль.Пользователь = \"xxxxx.xxxxxx@yandex.ru\";\r\n\tПочтовыйПрофиль.Пароль = \"tcbbrwraduriuusz\";\r\n\t\r\n\tПочтовыйПрофиль.ПортSMTP = 465; \r\n\t//ПочтовыйПрофиль.ПортIMAP = 993;\r\n\tПочтовыйПрофиль.Таймаут = 30; // мс;\r\n\t\r\n\tПочтовыйПрофиль.ИспользоватьSSLSMTP = Истина;\r\n\tПочтовыйПрофиль.ИспользоватьSSLIMAP = Истина;\r\n\t\r\n\t// ИнтернетПочта;\r\n\tПочта = Новый ИнтернетПочта;\r\n\t\r\n\tПодключеноУспешно = Ложь;\r\n\tПопытка\r\n\t\tПочта.Подключиться(ПочтовыйПрофиль, ПротоколИнтернетПочты.IMAP);\r\n\t\tПодключеноУспешно = Истина;\r\n\tИсключение\r\n\tКонецПопытки;\r\n\t\r\n\t// Проверка;\r\n\tЕсли НЕ ПодключеноУспешно Тогда\r\n    \t        ЖурналРегистрации.ДобавитьСообщениеДляЖурналаРегистрации(ОписаниеОшибки(), \r\n                     УровеньЖурналаРегистрации.Ошибка,,,  \"Сообщение- не было отправлено!\");  \r\n\t\tВозврат;\r\n\tИначе\r\n\t\t\r\n\t\tАдресФайлаВложения = ПолучитьИмяВременногоФайла(\".txt\");\r\n\t\t\r\n\t\t// Формирование отчета;\r\n\t\tТаблДок = Новый ТабличныйДокумент;\r\n                // Формируем отчет (какой хотим);\r\n\t\tОтчеты.ABCXYZАнализНоменклатуры.Создать().СкомпоноватьРезультат(ТаблДок);   \r\n\t\tТаблДок.Записать(АдресФайлаВложения, ТипФайлаТабличногоДокумента.HTML);\r\n\t\t\r\n\t\tТекстHTML = \"\";\r\n\t\t\tТекДок = Новый ТекстовыйДокумент;\r\n\t\t\tТекДок.Прочитать(АдресФайлаВложения);\r\n\t\tТекстHTML = ТекДок.ПолучитьТекст();\r\n\t\t\r\n\t\t// Формирование сообщения;\r\n\t\tПочтовоеСообщение = Новый ИнтернетПочтовоеСообщение;\r\n\t\tПочтовоеСообщение.Тема \t\t= СтрШаблон(\"Отчет \"\"Остатки товаров организаций\"\" от %1\", Формат(ТекущаяДата(), \"ДЛФ=DD\"));\r\n\t\tПочтовоеСообщение.Важность \t= ВажностьИнтернетПочтовогоСообщения.Наивысшая;\r\n\t\tПочтовоеСообщение.Тексты.Добавить(ТекстHTML, ТипТекстаПочтовогоСообщения.HTML);\r\n\t\t//\r\n\t\tПочтовоеСообщение.Отправитель.Адрес = \"xxxxx.xxxxxx@yandex.ru\";\r\n\t\tПочтовоеСообщение.Получатели.Добавить(\"xxxxx.xxxxxx@yandex.ru\");  \r\n\t\t\r\n\t\t//ИнтернетПочтовоеВложение  = ПочтовоеСообщение.Вложения.Добавить(АдресФайлаВложения, \"Остатки товаров организаций\");\r\n\t\t\r\n\t\tПопытка\r\n\t\t\tСоответствиеОтвет = Почта.Послать(ПочтовоеСообщение,, ПротоколИнтернетПочты.SMTP);\t\r\n\t\tИсключение\r\n\t\tКонецПопытки;\r\n\t\t\r\n\tКонецЕсли;\n\n{46} Переменной ТекстHTML присвоено значение, но оно нигде не используется\r\n{63} Переменной СоответствиеОтвет присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в smtp (найдено 2): smtp\r\nОрфографическая ошибка в yandex (найдено 6): yandex\r\nОрфографическая ошибка в xxxxx (найдено 4): xxxxx\r\nОрфографическая ошибка в xxxxxx (найдено 4): xxxxxx\r\nОрфографическая ошибка в tcbbrwraduriuusz (найдено 2): tcbbrwraduriuusz"
  },
  {
    "title": "CОМ подключение к базе-приемнику",
    "description": "CОМ подключение к базе-приемнику",
    "code_snippet": "// Параметры:\r\n//\r\n// ПутьКБазе - Строка\r\n// ПользовательБазы - Строка  \r\n// ПарольБазы - Строка \r\n// ДополнительныеПараметры - Структура\r\n//\r\n// Возвращаемое значение: \r\n//\r\n// Значение - СОМ Объект\r\n// Значение - Неопределено \r\n// -\r\nФункция ВыполнитьПодключениеКБазе(ПутьКБазе = Неопределено,\r\n\t\t\t\t\t\t\t\t  ПользовательБазы = Неопределено,\r\n\t\t\t\t\t\t\t\t  ПарольБазы = Неопределено, \r\n\t\t\t\t\t\t\t\t  ДополнительныеПараметры = Неопределено) Экспорт\r\n\r\n\t  БазаПриемник = Неопределено;\t\t\t\t\t\t\t  \r\n\t  \r\n\t  // Статические параметры подключения;\r\n\t  ПользовательБазы = \"Савинская З.Ю. (Системный программист)\"; \r\n\t  ПарольБазы = \"\";\r\n\t  ПутьКБазе = \"D:\\1С_dev\\1C_Bases\\HRM_Demo\";\r\n\t\t\t\t\t\t\t\t  \r\n\t  // Подключаемся через СОМ;\r\n\t  СОМСоединение = Новый COMОбъект(\"V83.ComConnector\");\t\t\t\t\t\t\t\t\t\t\t\t   \r\n\t  ПараметрыДоступа = СтрШаблон(\"File=\"\"%1\"\";Usr=\"\"%2\"\";Pwd=\"\"%3\"\";\", ПутьКБазе, ПользовательБазы, ПарольБазы); \r\n\t  \r\n\t  Попытка\r\n\t\t  БазаПриемник = СОМСоединение.Connect(ПараметрыДоступа);\t\r\n\t  Исключение\r\n\t  КонецПопытки;\t\t\t\t\t\t\t  \r\n\t  \r\n\t  Возврат БазаПриемник;\r\n\r\nКонецФункции // ()\n\n// Параметры:\r\n//\r\n// ПутьКБазе - Строка\r\n// ПользовательБазы - Строка  \r\n// ПарольБазы - Строка \r\n// ДополнительныеПараметры - Структура\r\n//\r\n// Возвращаемое значение: \r\n//\r\n// Значение - СОМ Объект\r\n// Значение - Неопределено \r\n// -\r\nФункция ВыполнитьПодключениеКБазе(ПутьКБазе = Неопределено,\r\n\t\t\t\t\t\t\t\t  ПользовательБазы = Неопределено,\r\n\t\t\t\t\t\t\t\t  ПарольБазы = Неопределено, \r\n\t\t\t\t\t\t\t\t  ДополнительныеПараметры = Неопределено) Экспорт\r\n\r\n\t  БазаПриемник = Неопределено;\t\t\t\t\t\t\t  \r\n\t  \r\n\t  // Статические параметры подключения;\r\n\t  ПользовательБазы = \"Савинская З.Ю. (Системный программист)\"; \r\n\t  ПарольБазы = \"\";\r\n\t  ПутьКБазе = \"D:\\1С_dev\\1C_Bases\\HRM_Demo\";\r\n\t\t\t\t\t\t\t\t  \r\n\t  // Подключаемся через СОМ;\r\n\t  СОМСоединение = Новый COMОбъект(\"V83.ComConnector\");\t\t\t\t\t\t\t\t\t\t\t\t   \r\n\t  ПараметрыДоступа = СтрШаблон(\"File=\"\"%1\"\";Usr=\"\"%2\"\";Pwd=\"\"%3\"\";\", ПутьКБазе, ПользовательБазы, ПарольБазы); \r\n\t  \r\n\t  Попытка\r\n\t\t  БазаПриемник = СОМСоединение.Connect(ПараметрыДоступа);\t\r\n\t  Исключение\r\n\t  КонецПопытки;\t\t\t\t\t\t\t  \r\n\t  \r\n\t  Возврат БазаПриемник;\r\n\r\nКонецФункции // ()"
  },
  {
    "title": "Сериализация массива объектов в xml (файл)",
    "description": "Сериализация массива объектов в xml (файл)",
    "code_snippet": "// 1. Сериализуем массив объектов; \r\n\tОбъектXDTO = СериализаторXDTO.ЗаписатьXDTO(МассивОбъектов);\r\n\t\r\n\t// 2. Инициализируем ЗаписьXML;\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\t\r\n\t// 3. Открываем (создаем) файл для записи XML;  \r\n\tИмяФайлаXML = ПолучитьИмяВременногоФайла(\".xml\");\r\n\tЗаписьXML.ОткрытьФайл(ИмяФайлаXML, \"UTF-8\", Ложь);\r\n\t\r\n\t// 4. Выполняем запись; \r\n\tФабрикаXDTO.ЗаписатьXML(ЗаписьXML, ОбъектXDTO);\r\n\t\r\n\t// 5. Закрываем запись;\r\n\tЗаписьXML.Закрыть();\n\n// 1. Сериализуем массив объектов; \r\n\tОбъектXDTO = СериализаторXDTO.ЗаписатьXDTO(МассивОбъектов);\r\n\t\r\n\t// 2. Инициализируем ЗаписьXML;\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\t\r\n\t// 3. Открываем (создаем) файл для записи XML;  \r\n\tИмяФайлаXML = ПолучитьИмяВременногоФайла(\".xml\");\r\n\tЗаписьXML.ОткрытьФайл(ИмяФайлаXML, \"UTF-8\", Ложь);\r\n\t\r\n\t// 4. Выполняем запись; \r\n\tФабрикаXDTO.ЗаписатьXML(ЗаписьXML, ОбъектXDTO);\r\n\t\r\n\t// 5. Закрываем запись;\r\n\tЗаписьXML.Закрыть();\n\nОрфографическая ошибка в Сериализуем: Сериализуем"
  },
  {
    "title": "Галка \"Подпись и печать\" в свою внешнюю печатную форму",
    "description": "Галка \"Подпись и печать\" в свою внешнюю печатную форму",
    "code_snippet": "// Интерфейс для выполнения команд обработки.\r\nПроцедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\r\n\t\r\n\tЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, \"ПФ_MXL_Макет\") Тогда\r\n\t\tУправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, \"ПФ_MXL_Макет\", \"Наименование\", \r\n\t\t\tПолучитьПечатныеФормы(МассивОбъектов, ОбъектыПечати));\r\n\t\tОбщегоНазначенияБП.ЗаполнитьДополнительныеПараметрыПечати(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода);\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция ПолучитьПечатныеФормы(МассивОбъектов, ОбъектыПечати) Экспорт\r\n\r\n\tПараметрыПечати = Новый Структура;\r\n\tПараметрыПечати.Вставить(\"ДополнитьКомплектВнешнимиПечатнымиФормами\", Ложь);\r\n\t\r\n\tТабличныйДокумент = Новый ТабличныйДокумент;\r\n\tТабличныйДокумент.АвтоМасштаб\t\t\t= Истина;\r\n\tТабличныйДокумент.ОриентацияСтраницы\t= ОриентацияСтраницы.Портрет;\r\n\tТабличныйДокумент.КлючПараметровПечати\t= \"ПАРАМЕТРЫ_ПЕЧАТИ_ВПФ_123\";\r\n\t\r\n\tПервыйДокумент = Истина;\r\n\tДля каждого Объект Из МассивОбъектов Цикл\r\n\t\r\n\t\tЕсли НЕ ПервыйДокумент Тогда\r\n\t\t\tТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tПервыйДокумент = Ложь;\r\n\t\t\r\n\t\t// Запомним номер строки, с которой начали выводить текущий документ.\r\n\t\tНомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;\r\n\t\t\r\n\t\tТабличныйДокумент.Вывести(ПечатьОдногоОбъекта(Объект));\r\n\t\t\r\n\t\tЗапросШапка = Новый Запрос(\"ВЫБРАТЬ\r\n\t\t                           |\tРеализацияТоваровУслуг.Ссылка КАК Документ,\r\n\t\t                           |\tРеализацияТоваровУслуг.Организация КАК Организация,\r\n\t\t                           |\tРеализацияТоваровУслуг.Руководитель КАК Руководитель,\r\n\t\t                           |\tРеализацияТоваровУслуг.ГлавныйБухгалтер КАК ГлавныйБухгалтер,\r\n\t\t                           |\tРеализацияТоваровУслуг.ОтветственныйЗаОформление КАК ОтветственныйЗаОформление\r\n\t\t                           |ИЗ\r\n\t\t                           |\tДокумент.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг\r\n\t\t                           |ГДЕ\r\n\t\t                           |\tРеализацияТоваровУслуг.Ссылка = &Ссылка\");\r\n\t\t\r\n\t\tЗапросШапка.УстановитьПараметр(\"Ссылка\", Объект); \r\n\t\t\r\n\t\tВыборкаШапка = ЗапросШапка.Выполнить().Выбрать();\r\n\t\tВыборкаШапка.Следующий();\r\n\t\t\r\n\t\t// В табличном документе зададим имя области, в которую был \r\n\t\t// выведен объект. Нужно для возможности печати покомплектно.\r\n\t\tУправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, НомерСтрокиНачало, ОбъектыПечати, ВыборкаШапка.Документ);\r\n\r\n\t\tУправлениеПечатьюБП.ДополнитьДокументПодписьюИПечатью(ТабличныйДокумент, ВыборкаШапка, ОбъектыПечати, ПараметрыПечати);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\t\r\n\tВозврат ТабличныйДокумент;\r\n\r\nКонецФункции\r\n\r\nФункция ПечатьОдногоОбъекта(СсылкаНаОбъект)\r\n\t\r\n\tМакет = ПолучитьМакет(\"ПФ_MXL_Макет\");\r\n\tТабДокумент = Новый ТабличныйДокумент;\r\n\tТекущаяОбласть = Макет.ПолучитьОбласть(\"Шапка\");\r\n\tТекущаяОбласть.Параметры.Заполнить(СсылкаНаОбъект);\r\n\r\n\tВозврат ТабДокумент;\r\n\r\nКонецФункции // Печать\n\n// Интерфейс для выполнения команд обработки.\r\nПроцедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\r\n\t\r\n\tЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, \"ПФ_MXL_Макет\") Тогда\r\n\t\tУправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, \"ПФ_MXL_Макет\", \"Наименование\", \r\n\t\t\tПолучитьПечатныеФормы(МассивОбъектов, ОбъектыПечати));\r\n\t\tОбщегоНазначенияБП.ЗаполнитьДополнительныеПараметрыПечати(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода);\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция ПолучитьПечатныеФормы(МассивОбъектов, ОбъектыПечати) Экспорт\r\n\r\n\tПараметрыПечати = Новый Структура;\r\n\tПараметрыПечати.Вставить(\"ДополнитьКомплектВнешнимиПечатнымиФормами\", Ложь);\r\n\t\r\n\tТабличныйДокумент = Новый ТабличныйДокумент;\r\n\tТабличныйДокумент.АвтоМасштаб\t\t\t= Истина;\r\n\tТабличныйДокумент.ОриентацияСтраницы\t= ОриентацияСтраницы.Портрет;\r\n\tТабличныйДокумент.КлючПараметровПечати\t= \"ПАРАМЕТРЫ_ПЕЧАТИ_ВПФ_123\";\r\n\t\r\n\tПервыйДокумент = Истина;\r\n\tДля каждого Объект Из МассивОбъектов Цикл\r\n\t\r\n\t\tЕсли НЕ ПервыйДокумент Тогда\r\n\t\t\tТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tПервыйДокумент = Ложь;\r\n\t\t\r\n\t\t// Запомним номер строки, с которой начали выводить текущий документ.\r\n\t\tНомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;\r\n\t\t\r\n\t\tТабличныйДокумент.Вывести(ПечатьОдногоОбъекта(Объект));\r\n\t\t\r\n\t\tЗапросШапка = Новый Запрос(\"ВЫБРАТЬ\r\n\t\t                           |\tРеализацияТоваровУслуг.Ссылка КАК Документ,\r\n\t\t                           |\tРеализацияТоваровУслуг.Организация КАК Организация,\r\n\t\t                           |\tРеализацияТоваровУслуг.Руководитель КАК Руководитель,\r\n\t\t                           |\tРеализацияТоваровУслуг.ГлавныйБухгалтер КАК ГлавныйБухгалтер,\r\n\t\t                           |\tРеализацияТоваровУслуг.ОтветственныйЗаОформление КАК ОтветственныйЗаОформление\r\n\t\t                           |ИЗ\r\n\t\t                           |\tДокумент.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг\r\n\t\t                           |ГДЕ\r\n\t\t                           |\tРеализацияТоваровУслуг.Ссылка = &Ссылка\");\r\n\t\t\r\n\t\tЗапросШапка.УстановитьПараметр(\"Ссылка\", Объект); \r\n\t\t\r\n\t\tВыборкаШапка = ЗапросШапка.Выполнить().Выбрать();\r\n\t\tВыборкаШапка.Следующий();\r\n\t\t\r\n\t\t// В табличном документе зададим имя области, в которую был \r\n\t\t// выведен объект. Нужно для возможности печати покомплектно.\r\n\t\tУправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, НомерСтрокиНачало, ОбъектыПечати, ВыборкаШапка.Документ);\r\n\r\n\t\tУправлениеПечатьюБП.ДополнитьДокументПодписьюИПечатью(ТабличныйДокумент, ВыборкаШапка, ОбъектыПечати, ПараметрыПечати);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\t\r\n\tВозврат ТабличныйДокумент;\r\n\r\nКонецФункции\r\n\r\nФункция ПечатьОдногоОбъекта(СсылкаНаОбъект)\r\n\t\r\n\tМакет = ПолучитьМакет(\"ПФ_MXL_Макет\");\r\n\tТабДокумент = Новый ТабличныйДокумент;\r\n\tТекущаяОбласть = Макет.ПолучитьОбласть(\"Шапка\");\r\n\tТекущаяОбласть.Параметры.Заполнить(СсылкаНаОбъект);\r\n\r\n\tВозврат ТабДокумент;\r\n\r\nКонецФункции // Печать\n\nОрфографическая ошибка в покомплектно: покомплектно"
  },
  {
    "title": "ТЗ в массив структур (для себя)",
    "description": "ТЗ в массив структур (для себя)",
    "code_snippet": "&НаСервереБезКонтекста\r\nФункция ПреобразоватьВМассивСтруктур(Таблица) \r\n\t\r\n\tМассивСтруктур = Новый Массив;\r\n\t\r\n\tДля каждого СтрокаТЗ Из Таблица Цикл\r\n\t\t\r\n\t\t// Строка;\r\n\t\tСтруктураДанных = Новый Структура;\r\n\t\t\r\n\t\tДля каждого КолонкаТЗ Из Таблица.Колонки Цикл\r\n        \tИмяКолонки = КолонкаТЗ.Имя;\r\n\t\t\tСтруктураДанных.Вставить(ИмяКолонки, СтрокаТЗ[ИмяКолонки]);\r\n\t\tКонецЦикла; \r\n\t\t\r\n\t\tМассивСтруктур.Добавить(СтруктураДанных);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат МассивСтруктур;\r\n\t\r\nКонецФункции\n\n&НаСервереБезКонтекста\r\nФункция ПреобразоватьВМассивСтруктур(Таблица) \r\n\t\r\n\tМассивСтруктур = Новый Массив;\r\n\t\r\n\tДля каждого СтрокаТЗ Из Таблица Цикл\r\n\t\t\r\n\t\t// Строка;\r\n\t\tСтруктураДанных = Новый Структура;\r\n\t\t\r\n\t\tДля каждого КолонкаТЗ Из Таблица.Колонки Цикл\r\n        \tИмяКолонки = КолонкаТЗ.Имя;\r\n\t\t\tСтруктураДанных.Вставить(ИмяКолонки, СтрокаТЗ[ИмяКолонки]);\r\n\t\tКонецЦикла; \r\n\t\t\r\n\t\tМассивСтруктур.Добавить(СтруктураДанных);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат МассивСтруктур;\r\n\t\r\nКонецФункции\n\n(1) Radik13, спасибо за тест"
  },
  {
    "title": "Заготовка на внешнюю обработку (минимум)",
    "description": "Заготовка на внешнюю обработку (минимум)",
    "code_snippet": "#Область ДанныеОтчетаОбработки\n\nФункция ВерсияОбработки(Строкой = Ложь) Экспорт\n\t\n\tВерсияОбработки = \"1.01.001\";\n\t\n\tЕсли НЕ Строкой Тогда\n\t\t\n\t\tИнформацияОВерсии = \"v.\" + ВерсияОбработки + \":\" + Символы.ПС\n\t\t\t\t\t\t\t+ НСтр(\"ru = 'Текст описания внешней обработки или просто наименование'\");\n\t\t\n\t\tЗаголовокВерсияОбработки = ?(ПустаяСтрока(ВерсияОбработки), \"\", \"[v.\" + ВерсияОбработки + \"]\");\n\t\t\n\t\tРезультат = Новый Структура;\n\t\tРезультат.Вставить(\"Версия\",\t\tВерсияОбработки);\n\t\tРезультат.Вставить(\"Заголовок\",\t\tЗаголовокВерсияОбработки);\n\t\tРезультат.Вставить(\"Информация\",\tИнформацияОВерсии);\n\t\tРезультат.Вставить(\"ЧтоНового\",\t\tОписаниеВерсии());\n\t\t\n\t\tВозврат Результат;\n\t\t\n\tКонецЕсли;\n\t\n\tВозврат ВерсияОбработки;\n\t\nКонецФункции\n\nФункция ОписаниеВерсии()\n\t\n\tТекстыОписания = Новый Массив;\n\t\n\tТекстыОписания.Добавить(\"1.01.003 - Исправлено..., доработано..., добавлено...\");\n\tТекстыОписания.Добавить(\"1.01.002 - Исправлено..., доработано..., добавлено...\");\n\t\n\tВозврат СтрСоединить(ТекстыОписания, Символы.ПС)\n\t\nКонецФункции\n\n#Область Инициализация\n// Необходимо заполнить один раз при создании обработки\n\nФункция НаименованиеОбработки() Экспорт\n\t\n\tВозврат \"Наименование обработки в списке Доболнительных отчетов и обработок\";\n\t\nКонецФункции\n\nФункция КомандыОбработки(ТаблицаКоманд)\n\t\n\tДобавитьКоманду(ТаблицаКоманд,\n\t\t\t\t\tНСтр(\"ru = 'Открыть'\"),\n\t\t\t\t\t\"\",\n\t\t\t\t\t\"ОткрытиеФормы\",\n\t\t\t\t\tИстина);\n\t\n\tВозврат ТаблицаКоманд;\n\t\nКонецФункции\n\nФункция Назначения()\n\t\n\tМассивНазначений = Новый Массив;\n\tМассивНазначений.Добавить(\"\");\n\t\n\tВозврат МассивНазначений;\n\t\nКонецФункции\n\nФункция ИспользоватьБезопасныйРежим()\n\t\n\tВозврат Ложь;\n\t\nКонецФункции\n\nФункция ВидОтчетаОбработки()\n\t\n\tВозврат ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительныйОтчет();\n\t\nКонецФункции\n\nФункция ВерсияБСП(Строкой = Истина)\n\t\n\tВерсияБСП = \"2.3.6.121\";\n\t\n\tЕсли НЕ Строкой Тогда\n\t\t\n\t\tРезультат = Новый Структура;\n\t\tРезультат.Вставить(\"Версия\",\tВерсияБСП);\n\t\t\n\t\tВозврат Результат;\n\t\t\n\tКонецЕсли;\n\t\n\tВозврат ВерсияБСП;\n\t\nКонецФункции\n\n#КонецОбласти\n\n#КонецОбласти\n\n#Область СлужебныйПрограммныйИнтерфейс\n\nФункция СведенияОВнешнейОбработке() Экспорт\n\t\n\tВерсияОбработки = ВерсияОбработки();\n\t\n\tПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(ВерсияБСП());\n\t\n\tПараметрыРегистрации.Вид = ВидОтчетаОбработки();\n\tПараметрыРегистрации.Версия = ВерсияОбработки.Версия;\n\tПараметрыРегистрации.Назначение = Назначения();\n\tПараметрыРегистрации.Наименование = НаименованиеОбработки();\n\tПараметрыРегистрации.БезопасныйРежим = ИспользоватьБезопасныйРежим();\n\tПараметрыРегистрации.Информация = ВерсияОбработки.Информация;\n\t\n\tКомандыОбработки(ПараметрыРегистрации.Команды);\n\t\n\tВозврат ПараметрыРегистрации;\n\t\nКонецФункции\n\n#КонецОбласти\n\n#Область СлужебныеПроцедурыИФункции\n\nПроцедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование, ПоказыватьОповещение = Ложь, Модификатор = \"\")\n\tНоваяКоманда = ТаблицаКоманд.Добавить();\n\tНоваяКоманда.Представление = Представление;\n\tНоваяКоманда.Идентификатор = Идентификатор;\n\tНоваяКоманда.Использование = Использование;\n\tНоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;\n\tНоваяКоманда.Модификатор = Модификатор;\nКонецПроцедуры\n\n#КонецОбласти"
  },
  {
    "title": "Выбрать Файл Excel и преобразовать в Таблицу значений",
    "description": "Выбрать Файл Excel и преобразовать в Таблицу значений",
    "code_snippet": "&НаКлиенте\r\nПроцедура ПутьКФайлуНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)\r\n\tСтандартнаяОбработка = Ложь;\r\n\tДиалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);\r\n\tДиалог.Заголовок = \"Выбор файла\";\r\n\tДиалог.Фильтр = \"Excel файлы(*.xls;*.xlsx)|*.xls;*.xlsx\";\r\n\tДиалог.ИндексФильтра = 0;\r\n\tДиалог.ПредварительныйПросмотр = Ложь;\r\n\tДиалог.ПроверятьСуществованиеФайла = Истина;\r\n\tДиалог.МножественныйВыбор = Ложь; \r\n\tДиалог.ПолноеИмяФайла = Объект.ПутьКФайлу;\r\n\t\r\n\tЕсли Диалог.Выбрать() Тогда\r\n\t\tОбъект.ПутьКФайлу = Диалог.ПолноеИмяФайла;\r\n\tКонецЕсли;\t\r\n\tКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ПрочитатьФайлEXEL(Команда)\r\n\tФайл = Новый Файл(Объект.ПутьКФайлу);\r\n\tЕсли НЕ Файл.Существует() Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\tДвоичныеДанные = Новый ДвоичныеДанные(Объект.ПутьКФайлу);\r\n\tEXCELВТаблицуЗначений(ДвоичныеДанные, Файл.Расширение);\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура EXCELВТаблицуЗначений(ДвоичныеДанные, Расширение)\r\n\t\r\n\tФайлEXCELНаСервере = ПолучитьИмяВременногоФайла(Расширение);\r\n\tДвоичныеДанные.Записать(ФайлEXCELНаСервере);\r\n\t\r\n\tФайлEXCELНаСервере = ПолучитьИмяВременногоФайла(Расширение);\r\n\tДвоичныеДанные.Записать(ФайлEXCELНаСервере);\r\n\t\r\n\tТабличныйДокумент = Новый ТабличныйДокумент;\r\n\tТабличныйДокумент.Прочитать(ФайлEXCELНаСервере);\r\n\tУдалитьФайлы(ФайлEXCELНаСервере);\r\n\tОбластьТаблицы = ТабличныйДокумент.Область();\r\n\tПостроительЗапроса = Новый ПостроительЗапроса;\r\n\tПостроительЗапроса.ИсточникДанных = Новый ОписаниеИсточникаДанных(ОбластьТаблицы);  \r\n\t\r\n\tПостроительЗапроса.Выполнить();\r\n\tТаблицаДанных = ПостроительЗапроса.Результат.Выгрузить();\r\n\t\r\n\tДобавитьКолонкуНаСервере(ТаблицаДанных);\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ДобавитьКолонкуНаСервере(Таблица)\r\n\t// добавим таблицу: сначала саму таблицу, потом колонку.\r\n\tРеквизиты = Новый Массив;\r\n\tРеквизиты.Добавить(Новый РеквизитФормы(\"ТаблицаНаФорме\", Новый ОписаниеТипов(\"ТаблицаЗначений\")));\r\n\t\r\n\tДля Каждого Ст ИЗ Таблица.Колонки Цикл\r\n\t\tРеквизиты.Добавить(Новый РеквизитФормы(Ст.Имя, Ст.ТипЗначения, \"ТаблицаНаФорме\"));\r\n\tКонецЦикла;\r\n\t\r\n\t// добавим реквизиты на форму\r\n\tИзменитьРеквизиты(Реквизиты);\r\n\t\r\n\t// добавим элементы формы\r\n\tТаб = Элементы.Добавить(\"ТаблицаНаФорме\", Тип(\"ТаблицаФормы\"));\r\n\tТаб.ПутьКДанным = \"ТаблицаНаФорме\";\r\n\t\r\n\t// запретим менять положение строк и сами строки, отключим командную панель\r\n\tТаб.ИзменятьСоставСтрок = Ложь;\r\n\tТаб.ИзменятьПорядокСтрок = Ложь;\r\n\tТаб.ПоложениеКоманднойПанели = ПоложениеКоманднойПанелиЭлементаФормы.Нет;\r\n\t\r\n\tДля Каждого Ст ИЗ Таблица.Колонки Цикл\r\n\t\tРек = Элементы.Добавить(\"Колонка\" + Ст.Имя, Тип(\"ПолеФормы\"), Таб);\r\n\t\tРек.Вид = ВидПоляФормы.ПолеНадписи;\r\n\t\tРек.ПутьКДанным = \"ТаблицаНаФорме\" + \".\" + Ст.Имя;\r\n\t\tРек.Заголовок = Ст.Имя;\r\n\tКонецЦикла;\r\n\t\r\n\t// заполним таблицу\r\n\tЗначениеВРеквизитФормы(Таблица, \"ТаблицаНаФорме\");\t\r\n\t\r\n\tЭлементы.ПроверитьДанные.Видимость = ИСТИНА;\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура ПутьКФайлуНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)\r\n\tСтандартнаяОбработка = Ложь;\r\n\tДиалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);\r\n\tДиалог.Заголовок = \"Выбор файла\";\r\n\tДиалог.Фильтр = \"Excel файлы(*.xls;*.xlsx)|*.xls;*.xlsx\";\r\n\tДиалог.ИндексФильтра = 0;\r\n\tДиалог.ПредварительныйПросмотр = Ложь;\r\n\tДиалог.ПроверятьСуществованиеФайла = Истина;\r\n\tДиалог.МножественныйВыбор = Ложь; \r\n\tДиалог.ПолноеИмяФайла = Объект.ПутьКФайлу;\r\n\t\r\n\tЕсли Диалог.Выбрать() Тогда\r\n\t\tОбъект.ПутьКФайлу = Диалог.ПолноеИмяФайла;\r\n\tКонецЕсли;\t\r\n\tКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ПрочитатьФайлEXEL(Команда)\r\n\tФайл = Новый Файл(Объект.ПутьКФайлу);\r\n\tЕсли НЕ Файл.Существует() Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\tДвоичныеДанные = Новый ДвоичныеДанные(Объект.ПутьКФайлу);\r\n\tEXCELВТаблицуЗначений(ДвоичныеДанные, Файл.Расширение);\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура EXCELВТаблицуЗначений(ДвоичныеДанные, Расширение)\r\n\t\r\n\tФайлEXCELНаСервере = ПолучитьИмяВременногоФайла(Расширение);\r\n\tДвоичныеДанные.Записать(ФайлEXCELНаСервере);\r\n\t\r\n\tФайлEXCELНаСервере = ПолучитьИмяВременногоФайла(Расширение);\r\n\tДвоичныеДанные.Записать(ФайлEXCELНаСервере);\r\n\t\r\n\tТабличныйДокумент = Новый ТабличныйДокумент;\r\n\tТабличныйДокумент.Прочитать(ФайлEXCELНаСервере);\r\n\tУдалитьФайлы(ФайлEXCELНаСервере);\r\n\tОбластьТаблицы = ТабличныйДокумент.Область();\r\n\tПостроительЗапроса = Новый ПостроительЗапроса;\r\n\tПостроительЗапроса.ИсточникДанных = Новый ОписаниеИсточникаДанных(ОбластьТаблицы);  \r\n\t\r\n\tПостроительЗапроса.Выполнить();\r\n\tТаблицаДанных = ПостроительЗапроса.Результат.Выгрузить();\r\n\t\r\n\tДобавитьКолонкуНаСервере(ТаблицаДанных);\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ДобавитьКолонкуНаСервере(Таблица)\r\n\t// добавим таблицу: сначала саму таблицу, потом колонку.\r\n\tРеквизиты = Новый Массив;\r\n\tРеквизиты.Добавить(Новый РеквизитФормы(\"ТаблицаНаФорме\", Новый ОписаниеТипов(\"ТаблицаЗначений\")));\r\n\t\r\n\tДля Каждого Ст ИЗ Таблица.Колонки Цикл\r\n\t\tРеквизиты.Добавить(Новый РеквизитФормы(Ст.Имя, Ст.ТипЗначения, \"ТаблицаНаФорме\"));\r\n\tКонецЦикла;\r\n\t\r\n\t// добавим реквизиты на форму\r\n\tИзменитьРеквизиты(Реквизиты);\r\n\t\r\n\t// добавим элементы формы\r\n\tТаб = Элементы.Добавить(\"ТаблицаНаФорме\", Тип(\"ТаблицаФормы\"));\r\n\tТаб.ПутьКДанным = \"ТаблицаНаФорме\";\r\n\t\r\n\t// запретим менять положение строк и сами строки, отключим командную панель\r\n\tТаб.ИзменятьСоставСтрок = Ложь;\r\n\tТаб.ИзменятьПорядокСтрок = Ложь;\r\n\tТаб.ПоложениеКоманднойПанели = ПоложениеКоманднойПанелиЭлементаФормы.Нет;\r\n\t\r\n\tДля Каждого Ст ИЗ Таблица.Колонки Цикл\r\n\t\tРек = Элементы.Добавить(\"Колонка\" + Ст.Имя, Тип(\"ПолеФормы\"), Таб);\r\n\t\tРек.Вид = ВидПоляФормы.ПолеНадписи;\r\n\t\tРек.ПутьКДанным = \"ТаблицаНаФорме\" + \".\" + Ст.Имя;\r\n\t\tРек.Заголовок = Ст.Имя;\r\n\tКонецЦикла;\r\n\t\r\n\t// заполним таблицу\r\n\tЗначениеВРеквизитФормы(Таблица, \"ТаблицаНаФорме\");\t\r\n\t\r\n\tЭлементы.ПроверитьДанные.Видимость = ИСТИНА;\r\nКонецПроцедуры"
  },
  {
    "title": "Преобразование объекта в структуру",
    "description": "Преобразование объекта в структуру",
    "code_snippet": "Функция ОбъектВСтруктуру(ОбъектДанных)\r\n\t\r\n\tОбъектКакСтрукутра = Новый Структура;\r\n\r\n\tСтандартныеРеквизитыОбъекта = ОбъектДанных.Метаданные().СтандартныеРеквизиты;\r\n\tДля Каждого РеквизитОбъекта Из СтандартныеРеквизитыОбъекта Цикл\r\n\t\tОбъектКакСтрукутра.Вставить(РеквизитОбъекта.Имя, ОбъектДанных[РеквизитОбъекта.Имя]);\t\r\n\tКонецЦикла;\r\n\r\n\tРеквизитыОбъекта = ОбъектДанных.Метаданные().Реквизиты;\r\n\tДля Каждого РеквизитОбъекта Из РеквизитыОбъекта Цикл\r\n\t\tОбъектКакСтрукутра.Вставить(РеквизитОбъекта.Имя, ОбъектДанных[РеквизитОбъекта.Имя]);\t\r\n\tКонецЦикла;\r\n\t\r\n\tТабличныеЧасти = ОбъектДанных.Метаданные().ТабличныеЧасти;\r\n\tДля Каждого ТабличнаяЧасть Из ТабличныеЧасти Цикл \r\n\t\tТЗ = ОбъектДанных[ТабличнаяЧасть.Имя].Выгрузить();\r\n\t\tМассив = ОбщегоНазначения.ТаблицаЗначенийВМассив(ТЗ);\r\n\t\tОбъектКакСтрукутра.Вставить(ТабличнаяЧасть.Имя, Массив);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат ОбъектКакСтрукутра;\r\n\t\r\nКонецФункции\n\nФункция ОбъектВСтруктуру(ОбъектДанных)\r\n\t\r\n\tОбъектКакСтрукутра = Новый Структура;\r\n\r\n\tСтандартныеРеквизитыОбъекта = ОбъектДанных.Метаданные().СтандартныеРеквизиты;\r\n\tДля Каждого РеквизитОбъекта Из СтандартныеРеквизитыОбъекта Цикл\r\n\t\tОбъектКакСтрукутра.Вставить(РеквизитОбъекта.Имя, ОбъектДанных[РеквизитОбъекта.Имя]);\t\r\n\tКонецЦикла;\r\n\r\n\tРеквизитыОбъекта = ОбъектДанных.Метаданные().Реквизиты;\r\n\tДля Каждого РеквизитОбъекта Из РеквизитыОбъекта Цикл\r\n\t\tОбъектКакСтрукутра.Вставить(РеквизитОбъекта.Имя, ОбъектДанных[РеквизитОбъекта.Имя]);\t\r\n\tКонецЦикла;\r\n\t\r\n\tТабличныеЧасти = ОбъектДанных.Метаданные().ТабличныеЧасти;\r\n\tДля Каждого ТабличнаяЧасть Из ТабличныеЧасти Цикл \r\n\t\tТЗ = ОбъектДанных[ТабличнаяЧасть.Имя].Выгрузить();\r\n\t\tМассив = ОбщегоНазначения.ТаблицаЗначенийВМассив(ТЗ);\r\n\t\tОбъектКакСтрукутра.Вставить(ТабличнаяЧасть.Имя, Массив);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат ОбъектКакСтрукутра;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Удалить повторяющиеся элементы массива",
    "description": "Удалить повторяющиеся элементы массива",
    "code_snippet": "ОбщегоНазначенияУТ.УдалитьПовторяющиесяЭлементыМассива(Массив);\n\nОбщегоНазначенияУТ.УдалитьПовторяющиесяЭлементыМассива(Массив);\n\nОрфографическая ошибка в Повзоляет: Повзоляет"
  },
  {
    "title": "Определение внешнего IP адреса (external IP adress)",
    "description": "Определение внешнего IP адреса (external IP adress)",
    "code_snippet": "1. Используем powershell , копируем в консоль: return (Invoke-WebRequest -uri \"https://api.ipify.org/\").Content\r\n2. 1С (функция - возвращает внешний айпи строкой).\r\n\r\nФункция УзнатьВнешнийIPАдресПользователя() Экспорт\r\n\r\n\t// headers;\r\n\tЗаголовки  = Новый Соответствие;\r\n\tЗаголовки.Вставить(\"Accept\", \"*/*\");\r\n\tЗаголовки.Вставить(\"Accept-Encoding\", \"gzip, deflate, br\");\r\n\tЗаголовки.Вставить(\"Connection\", \"keep-alive\");\r\n\tЗаголовки.Вставить(\"Content-type\", \"application/json\");\r\n\t\r\n\tДополнительныеПараметры = Новый Структура(\"Заголовки\", Заголовки);\r\n\t\r\n\t// http query;\r\n\tssl = Новый ЗащищенноеСоединениеOpenSSL();\r\n\t\r\n\tхост = \"api.ipify.org\";\r\n\thttp_соединение = Новый HTTPСоединение(хост,443,,,,,ssl);\r\n\thttp_запрос = Новый HTTPЗапрос(\"/\", Заголовки); \r\n\t\r\n\tОтвет = http_соединение.Получить(http_запрос);  \r\n\tТелоСтрокой = Ответ.ПолучитьТелоКакСтроку();\r\n\t\r\n\tВозврат ТелоСтрокой;\r\n\r\nКонецФункции\n\n1. Используем powershell , копируем в консоль: return (Invoke-WebRequest -uri \"https://api.ipify.org/\").Content\r\n2. 1С (функция - возвращает внешний айпи строкой).\r\n\r\nФункция УзнатьВнешнийIPАдресПользователя() Экспорт\r\n\r\n\t// headers;\r\n\tЗаголовки  = Новый Соответствие;\r\n\tЗаголовки.Вставить(\"Accept\", \"*/*\");\r\n\tЗаголовки.Вставить(\"Accept-Encoding\", \"gzip, deflate, br\");\r\n\tЗаголовки.Вставить(\"Connection\", \"keep-alive\");\r\n\tЗаголовки.Вставить(\"Content-type\", \"application/json\");\r\n\t\r\n\tДополнительныеПараметры = Новый Структура(\"Заголовки\", Заголовки);\r\n\t\r\n\t// http query;\r\n\tssl = Новый ЗащищенноеСоединениеOpenSSL();\r\n\t\r\n\tхост = \"api.ipify.org\";\r\n\thttp_соединение = Новый HTTPСоединение(хост,443,,,,,ssl);\r\n\thttp_запрос = Новый HTTPЗапрос(\"/\", Заголовки); \r\n\t\r\n\tОтвет = http_соединение.Получить(http_запрос);  \r\n\tТелоСтрокой = Ответ.ПолучитьТелоКакСтроку();\r\n\t\r\n\tВозврат ТелоСтрокой;\r\n\r\nКонецФункции\n\n{} Ожидается идентификатор\r\nОрфографическая ошибка в powershell (найдено 2): powershell\r\nОрфографическая ошибка в айпи: айпи\r\nОрфографическая ошибка в ipify: ipify"
  },
  {
    "title": "Заполнить таблицу значений на основе строки",
    "description": "Заполнить таблицу значений на основе строки",
    "code_snippet": "// Возвращает таблицу значений на основе текста (формат в примере использования).\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/11\r\n//  \r\n// Параметры:\r\n//  Текст - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений\r\n//  \r\n// Пример:\r\n// \tСодержимое = \r\n// \t\"Фамилия   |Имя       |Отчество\r\n// \t|\r\n// \t|Смирнов   |Александр |Владимирович\r\n// \t|Иванова   |Мария     |Петровна\r\n// \t|Кузнецов  |Дмитрий   |Александрович\";\r\n// \t\r\n// \tТаблица = ТаблицаЗначенийИзСтроки(Содержимое);\r\n// \t//Таблица будет содержать 3 колонки Фамилия, Имя, Отчество и 3 строки\r\n//  \r\nФункция ТаблицаЗначенийИзСтроки(Знач Текст) Экспорт\r\n\t\r\n\tТаблица = Новый ТаблицаЗначений();\r\n\tЗаполнитьТаблицуЗначенийИзСтроки(Текст, Таблица, Истина);\r\n\t\r\n\tВозврат Таблица;\r\n\t\r\nКонецФункции\r\n\r\n// Заполнить таблицу значений из строки (формат в примере использования)\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/11\r\n//  \r\n// Параметры:\r\n//  Текст   - Строка\r\n//  Таблица - ТаблицаЗначений, Неопределено - Таблица или переменная, в которую она будет помещена\r\n//  ДополнятьКолонками - Булево - Нужно ли дополнять колонками таблицу\r\n//  \r\n// Пример:\r\n// \tСодержимое = \r\n// \t\"Фамилия   |Имя       |Отчество\r\n// \t|\r\n// \t|Смирнов   |Александр |Владимирович\r\n// \t|Иванова   |Мария     |Петровна\r\n// \t|Кузнецов  |Дмитрий   |Александрович\";\r\n// \t\r\n// \tТаблица = Новый ТаблицаЗначений();\r\n// \tТаблица.Колонки.Добавить(\"Фамилия\");\r\n// \tТаблица.Колонки.Добавить(\"Имя\");\r\n// \t\r\n// \tЗаполнитьТаблицуЗначенийИзСтроки(Содержимое, Таблица, Истина);\r\n// \t//Таблица будет содержать 3 колонки Фамилия, Имя, Отчество и 3 строки\r\n//  \r\nПроцедура ЗаполнитьТаблицуЗначенийИзСтроки(Знач Текст, Знач Таблица = Неопределено, Знач ДополнятьКолонками = Ложь) Экспорт\r\n\t\r\n\tЕсли Таблица = Неопределено Тогда\r\n\t\tТаблица = Новый ТаблицаЗначений();\r\n\tКонецЕсли;\r\n\t\r\n\tЧислоСтрок   = СтрЧислоСтрок(Текст);\r\n\tИменаКолонок = Новый Массив; // Массив из Строка\r\n\tРазделитель  = \"|\";\r\n\t\r\n\tДля НомерСтроки = 1 По ЧислоСтрок Цикл\r\n\t\t\r\n\t\tСтрокаТекста = СтрПолучитьСтроку(Текст, НомерСтроки);\r\n\t\tЕсли ПустаяСтрока(СтрокаТекста) Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЧастиСтроки = СтрРазделить(СтрокаТекста, Разделитель, Истина);\r\n\t\tЗаполненыКолонки = ЗначениеЗаполнено(ИменаКолонок);\r\n\t\t\r\n\t\tЕсли ЗаполненыКолонки Тогда\r\n\t\t\tСтрокаТаблицы = Таблица.Добавить();\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tДля ИндексЧасти = 0 По ЧастиСтроки.Количество() - 1 Цикл\r\n\t\t\t\r\n\t\t\tЧастьСтроки = СокрЛП(ЧастиСтроки[ИндексЧасти]);\r\n\t\t\t\r\n\t\t\tЕсли ПустаяСтрока(ЧастьСтроки) Тогда\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tЕсли ЗаполненыКолонки Тогда\r\n\t\t\t\tСтрокаТаблицы[ИменаКолонок[ИндексЧасти]] = ЧастьСтроки;\r\n\t\t\tИначе\r\n\t\t\t\tИменаКолонок.Добавить(ЧастьСтроки);\r\n\t\t\t\tЕсли ДополнятьКолонками И Таблица.Колонки.Найти(ЧастьСтроки) = Неопределено Тогда\r\n\t\t\t\t\tТаблица.Колонки.Добавить(ЧастьСтроки, Новый ОписаниеТипов(\"Строка\"));\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n// Возвращает таблицу значений на основе текста (формат в примере использования).\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/11\r\n//  \r\n// Параметры:\r\n//  Текст - Строка\r\n// \r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений\r\n//  \r\n// Пример:\r\n// \tСодержимое = \r\n// \t\"Фамилия   |Имя       |Отчество\r\n// \t|\r\n// \t|Смирнов   |Александр |Владимирович\r\n// \t|Иванова   |Мария     |Петровна\r\n// \t|Кузнецов  |Дмитрий   |Александрович\";\r\n// \t\r\n// \tТаблица = ТаблицаЗначенийИзСтроки(Содержимое);\r\n// \t//Таблица будет содержать 3 колонки Фамилия, Имя, Отчество и 3 строки\r\n//  \r\nФункция ТаблицаЗначенийИзСтроки(Знач Текст) Экспорт\r\n\t\r\n\tТаблица = Новый ТаблицаЗначений();\r\n\tЗаполнитьТаблицуЗначенийИзСтроки(Текст, Таблица, Истина);\r\n\t\r\n\tВозврат Таблица;\r\n\t\r\nКонецФункции\r\n\r\n// Заполнить таблицу значений из строки (формат в примере использования)\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/11\r\n//  \r\n// Параметры:\r\n//  Текст   - Строка\r\n//  Таблица - ТаблицаЗначений, Неопределено - Таблица или переменная, в которую она будет помещена\r\n//  ДополнятьКолонками - Булево - Нужно ли дополнять колонками таблицу\r\n//  \r\n// Пример:\r\n// \tСодержимое = \r\n// \t\"Фамилия   |Имя       |Отчество\r\n// \t|\r\n// \t|Смирнов   |Александр |Владимирович\r\n// \t|Иванова   |Мария     |Петровна\r\n// \t|Кузнецов  |Дмитрий   |Александрович\";\r\n// \t\r\n// \tТаблица = Новый ТаблицаЗначений();\r\n// \tТаблица.Колонки.Добавить(\"Фамилия\");\r\n// \tТаблица.Колонки.Добавить(\"Имя\");\r\n// \t\r\n// \tЗаполнитьТаблицуЗначенийИзСтроки(Содержимое, Таблица, Истина);\r\n// \t//Таблица будет содержать 3 колонки Фамилия, Имя, Отчество и 3 строки\r\n//  \r\nПроцедура ЗаполнитьТаблицуЗначенийИзСтроки(Знач Текст, Знач Таблица = Неопределено, Знач ДополнятьКолонками = Ложь) Экспорт\r\n\t\r\n\tЕсли Таблица = Неопределено Тогда\r\n\t\tТаблица = Новый ТаблицаЗначений();\r\n\tКонецЕсли;\r\n\t\r\n\tЧислоСтрок   = СтрЧислоСтрок(Текст);\r\n\tИменаКолонок = Новый Массив; // Массив из Строка\r\n\tРазделитель  = \"|\";\r\n\t\r\n\tДля НомерСтроки = 1 По ЧислоСтрок Цикл\r\n\t\t\r\n\t\tСтрокаТекста = СтрПолучитьСтроку(Текст, НомерСтроки);\r\n\t\tЕсли ПустаяСтрока(СтрокаТекста) Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЧастиСтроки = СтрРазделить(СтрокаТекста, Разделитель, Истина);\r\n\t\tЗаполненыКолонки = ЗначениеЗаполнено(ИменаКолонок);\r\n\t\t\r\n\t\tЕсли ЗаполненыКолонки Тогда\r\n\t\t\tСтрокаТаблицы = Таблица.Добавить();\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tДля ИндексЧасти = 0 По ЧастиСтроки.Количество() - 1 Цикл\r\n\t\t\t\r\n\t\t\tЧастьСтроки = СокрЛП(ЧастиСтроки[ИндексЧасти]);\r\n\t\t\t\r\n\t\t\tЕсли ПустаяСтрока(ЧастьСтроки) Тогда\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tЕсли ЗаполненыКолонки Тогда\r\n\t\t\t\tСтрокаТаблицы[ИменаКолонок[ИндексЧасти]] = ЧастьСтроки;\r\n\t\t\tИначе\r\n\t\t\t\tИменаКолонок.Добавить(ЧастьСтроки);\r\n\t\t\t\tЕсли ДополнятьКолонками И Таблица.Колонки.Найти(ЧастьСтроки) = Неопределено Тогда\r\n\t\t\t\t\tТаблица.Колонки.Добавить(ЧастьСтроки, Новый ОписаниеТипов(\"Строка\"));\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Форматтер кода BSL",
    "description": "Форматирование кода с BSL Server",
    "code_snippet": ""
  },
  {
    "title": "Выделение жирным шрифтом шаблонов слов в MS Word",
    "description": "Выделение жирным шрифтом шаблонов слов в MS Word",
    "code_snippet": "Range = Document.Content;\r\nWdReplaceAll = 2;\r\nRange.Find.Replacement.Font.Bold = 1;\r\nRange.Find.Execute(\"#??\\.??\\.????#\", , , 1 , , , , , , \"^&\", wdReplaceAll);\r\nRange.Find.Execute(\"#\", , , , , , , , 0 , \"\", wdReplaceAll);\n\nRange = Document.Content;\r\nWdReplaceAll = 2;\r\nRange.Find.Replacement.Font.Bold = 1;\r\nRange.Find.Execute(\"#??\\.??\\.????#\", , , 1 , , , , , , \"^&\", wdReplaceAll);\r\nRange.Find.Execute(\"#\", , , , , , , , 0 , \"\", wdReplaceAll);\n\nRange.Find.Execute(\"#??\\.??\\.????#\", , , 1 , , , , , , \"^&\", wdReplaceAll);"
  },
  {
    "title": "Программное формирование обсуждения через систему взаимодействия",
    "description": "Программное формирование обсуждения через систему взаимодействия",
    "code_snippet": "НавигационнаяСсыылка   = ПолучитьНавигационнуюСсылку(СсылкаНаДокументОбсуждения);\n КонтекстОбсуждения     = Новый КонтекстОбсужденияСистемыВзаимодействия(НавигационнаяСсыылка);\n МенеджерВзаимодействия = Новый МенеджерСистемыВзаимодействия;\n \t\n Отбор = Новый ОтборОбсужденийСистемыВзаимодействия;\n Отбор.КонтекстноеОбсуждение = Истина;\n Отбор.ТекущийПользовательЯвляетсяУчастником = Ложь;\n Отбор.КонтекстОбсуждения = КонтекстОбсуждения;\n Обсуждение = МенеджерВзаимодействия.ПолучитьОбсуждения(Отбор);\n \t\n Если Обсуждение.Количество() = 0 Тогда\n \t\tОбсуждение = МенеджерВзаимодействия.СоздатьОбсуждение();\n \t\tОбсуждение.КонтекстОбсуждения = КонтекстОбсуждения;\n \t\tОбсуждение.Ключ = Строка(СсылкаНаДокументОбсуждения.УникальныйИдентификатор());\n \t\tОбсуждение.Записать();\n \tИначе\n \t\tОбсуждение = Обсуждение[0];\n \tКонецЕсли; \n \t\n Автор = ПараметрыСеанса.ТекущийПользователь;\n \t\n СообщениеДляОбсуждения = МенеджерВзаимодействия.СоздатьСообщение(Обсуждение.Идентификатор);\n СообщениеДляОбсуждения.Дата  = ТекущаяДата();\n СообщениеДляОбсуждения.Автор = ПолучитьИД(Автор);\n СообщениеДляОбсуждения.Получатели.Добавить(ПолучитьИД(ПолучательОповещенияВСистемеВзаимодействия));\n СообщениеДляОбсуждения.Текст = Новый ФорматированнаяСтрока(\"текст обсуждения\");\n СообщениеДляОбсуждения.Записать();"
  },
  {
    "title": "Программный вывод отчета СКД",
    "description": "Программный вывод отчета СКД",
    "code_snippet": "Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\r\n    \r\n    СтандартнаяОбработка = Ложь;\r\n\r\n    // Формируем макет, с помощью компоновщика макета\r\n    КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n    \r\n    // Передаем в макет компоновки схему, настройки и данные расшифровки\r\n    НастройкиКомпоновки = КомпоновщикНастроек.ПолучитьНастройки();\r\n    \r\n    МакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, НастройкиКомпоновки, ДанныеРасшифровки,, Тип(\"ГенераторМакетаКомпоновкиДанных\"));\r\n    \r\n    // Выполним компоновку с помощью процессора компоновки\r\n    ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;\r\n    ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновкиДанных,, ДанныеРасшифровки, Истина);\r\n    \r\n    // Выводим результат в табличный документ\r\n    ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n    ПроцессорВывода.УстановитьДокумент(ДокументРезультат);\r\n    \r\n    ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);\r\n    \r\nКонецПроцедуры\n\nПроцедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\r\n    \r\n    СтандартнаяОбработка = Ложь;\r\n\r\n    // Формируем макет, с помощью компоновщика макета\r\n    КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n    \r\n    // Передаем в макет компоновки схему, настройки и данные расшифровки\r\n    НастройкиКомпоновки = КомпоновщикНастроек.ПолучитьНастройки();\r\n    \r\n    МакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, НастройкиКомпоновки, ДанныеРасшифровки,, Тип(\"ГенераторМакетаКомпоновкиДанных\"));\r\n    \r\n    // Выполним компоновку с помощью процессора компоновки\r\n    ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;\r\n    ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновкиДанных,, ДанныеРасшифровки, Истина);\r\n    \r\n    // Выводим результат в табличный документ\r\n    ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n    ПроцессорВывода.УстановитьДокумент(ДокументРезультат);\r\n    \r\n    ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);\r\n    \r\nКонецПроцедуры"
  },
  {
    "title": "Установить элемент отбора динамического списка",
    "description": "Установить элемент отбора динамического списка",
    "code_snippet": "Для Каждого ЭлементОтбора Из ДинамическийСписок.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы Цикл\n\t\n\tЕсли ТипЗнч(ЭлементОтбора) = Тип(\"ОтборКомпоновкиДанных\") Тогда\n\t\t\n\t\tПользовательскийОтбор = ЭлементОтбора.Элементы;\n\t\tНовыйЭлементОтбора = Неопределено;\n\t\t\n\t\tДля Каждого СуществующийЭлементОтбора Из ПользовательскийОтбор Цикл\n\t\t\t\n\t\t\tЕсли СуществующийЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(ИмяПоля) Тогда\n\t\t\t\tНовыйЭлементОтбора = СуществующийЭлементОтбора;\n\t\t\t\tПрервать;\n\t\t\tКонецЕсли;\t\n\t\t\t\t\n\t\tКонецЦикла;\n\t\t\n\t\tЕсли НовыйЭлементОтбора = Неопределено Тогда\n\t\t\tНовыйЭлементОтбора = ПользовательскийОтбор.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\n\t\t\tНовыйЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(ИмяПоля);\n\t\tКонецЕсли;\n\t\n\t\tНовыйЭлементОтбора.ВидСравнения\t\t= ВидСравнения;\n\t\tНовыйЭлементОтбора.Использование\t= ЗначениеЗаполнено(ЗначениеПоля);\n\t\tНовыйЭлементОтбора.РежимОтображения\t= РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Обычный;\n\t\tНовыйЭлементОтбора.ПравоеЗначение\t= ЗначениеПоля;\t\t\t\n\t\t\n\tКонецЕсли;\n\t\nКонецЦикла;"
  },
  {
    "title": "Отправить документ в чат телеграм",
    "description": "Отправить документ в чат телеграм",
    "code_snippet": "Token \t = \"6235344929:AAENWBK3pMX4hLMMtx6LNtFg9roqC0v7Scw\";\r\n\tServerTg  = \"api.telegram.org\";\r\n\tChatID \t = \"815505225\";\r\n\t\r\n\tФайлОтправки = Новый Файл(ПутьКФайлу);\r\n\t\r\n\tСтрокаСоединения = \"bot\" + Token + \"/sendDocument\";\r\n\t\r\n\t// Разделитель;\r\n\tBoundary = \"----\"+Строка(Новый УникальныйИдентификатор());\r\n\t\r\n\t// Определяем массив для процедуры ОбъединитьФайлы;\r\n\tМассивФайловДляОбъединения = Новый Массив;\r\n\t\r\n\t// Формируем начальный фрагмент файла POST-запроса;\t\r\n\tИмяФайлаОтправкиНачало = ПолучитьИмяВременногоФайла(\"txt\");\r\n\tФайлОтправкиНачало = Новый ЗаписьТекста(ИмяФайлаОтправкиНачало, КодировкаТекста.UTF8);\r\n\t\r\n\t// Формируем конечный фрагмент файла POST-запроса;\t\r\n\tИмяФайлаОтправкиКонец = ПолучитьИмяВременногоФайла(\"txt\");\r\n\tФайлаОтправкиКонец = Новый ЗаписьТекста(ИмяФайлаОтправкиКонец, КодировкаТекста.UTF8);\r\n\t\r\n\tТекстДляОтправки = \"\";\r\n\t\r\n\tТекстДляОтправки = ТекстДляОтправки + \"--\" + Boundary + Символы.ПС;\r\n\tТекстДляОтправки = ТекстДляОтправки + \"Content-Disposition: form-data; name=\"\"chat_id\"\"\" + Символы.ПС + Символы.ПС + СтрЗаменить(Формат(ChatID, \"ЧДЦ=0; ЧС=; ЧРГ=.; ЧГ=0\"), \".\", \"\") + Символы.ПС;\r\n\t\r\n\tТекстДляОтправки = ТекстДляОтправки + \"--\" + Boundary + Символы.ПС;\r\n\tТекстДляОтправки = ТекстДляОтправки + \"Content-Disposition: form-data; name=\"\"document\"\"; filename=\"\"/\" + ФайлОтправки.Имя + \"\"\"\" + Символы.ПС;\r\n\t\r\n\t// Записываем ФайлОтправкиНачало; \r\n\tФайлОтправкиНачало.ЗаписатьСтроку(ТекстДляОтправки);\r\n\tФайлОтправкиНачало.Закрыть();\r\n\t\r\n\tТекстДляОтправки = \"\" + Символы.ПС;\r\n\tТекстДляОтправки = ТекстДляОтправки + \"--\" +  Boundary+\"--\";\r\n\t\r\n\t// Записываем ФайлаОтправкиКонец; \r\n\tФайлаОтправкиКонец.ЗаписатьСтроку(ТекстДляОтправки);\r\n\tФайлаОтправкиКонец.Закрыть();\r\n\t\r\n\t// Заполняем массив;\r\n\tМассивФайловДляОбъединения.Добавить(ИмяФайлаОтправкиКонец);\r\n\tМассивФайловДляОбъединения.Добавить(ИмяФайлаОтправкиНачало);\r\n\tМассивФайловДляОбъединения.Добавить(СокрЛП(ПутьКФайлу));\r\n\t\r\n\t// Формируем ИмяФайлаОтправки;\r\n\tИмяФайлаОтправки = ПолучитьИмяВременногоФайла(\"txt\");\r\n\tОбъединитьФайлы(МассивФайловДляОбъединения, ИмяФайлаОтправки);\r\n\t\r\n\tHTTPЗапрос \t= Новый HTTPЗапрос;\r\n\tЗаголовки \t= Новый Соответствие;\r\n\t\r\n\t// Формируем Заголовки HTTP Запроса;\r\n\tHTTPЗапрос.Заголовки.Вставить(\"Connection\", \"keep-alive\");\r\n\tHTTPЗапрос.Заголовки.Вставить(\"Content-Type\", \"multipart/form-data; boundary=\"+Boundary);\r\n\t\r\n\tHTTPЗапрос.УстановитьИмяФайлаТела(ИмяФайлаОтправки);\r\n\t\r\n\t// Установим АдресРесурса;\r\n\tHTTPЗапрос.АдресРесурса \t= СтрокаСоединения;\r\n\t\r\n\tSSL  = Новый ЗащищенноеСоединениеOpenSSL();\r\n\tHTTPСоединение = Новый HTTPСоединение(ServerTg, 443,,,,, SSL);\r\n\t\r\n\tПопытка\r\n\t\t// POST запрос; \r\n\t\tОтвет = HTTPСоединение.ОтправитьДляОбработки(HTTPЗапрос);\r\n\t\t\r\n\t\tКодСостояния     = Ответ.КодСостояния;\r\n\t\tСтрокаОтвета     = Ответ.ПолучитьТелоКакСтроку();\r\n\t\t\r\n\t\tЕсли КодСостояния = 200 тогда\r\n\t\t\t// Читаем JSON;\r\n\t\t\tЧтениеJSON = Новый ЧтениеJSON;\r\n\t\t\t\r\n\t\t\tЧтениеJSON.УстановитьСтроку(СтрокаОтвета);\r\n\t\t\t\r\n\t\t\tРезультатСтруктура = ПрочитатьJSON(ЧтениеJSON);\r\n\t\t\t\r\n\t\t\tЕсли РезультатСтруктура.ok = Истина Тогда\r\n\t\t\t\tСтруктураMessage = РезультатСтруктура.result;\r\n\t\t\tКонецЕсли; \r\n\t\tИначе\r\n\t\t\tСообщить(\"КодСостояния \" + КодСостояния);\r\n\t\t\tСообщить(СтрокаОтвета);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tИсключение\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \"Ошибка: \" + ОписаниеОшибки();\r\n\t\tСообщение.Сообщить();\r\n\tКонецПопытки;\n\nToken \t = \"6235344929:AAENWBK3pMX4hLMMtx6LNtFg9roqC0v7Scw\";\r\n\tServerTg  = \"api.telegram.org\";\r\n\tChatID \t = \"815505225\";\r\n\t\r\n\tФайлОтправки = Новый Файл(ПутьКФайлу);\r\n\t\r\n\tСтрокаСоединения = \"bot\" + Token + \"/sendDocument\";\r\n\t\r\n\t// Разделитель;\r\n\tBoundary = \"----\"+Строка(Новый УникальныйИдентификатор());\r\n\t\r\n\t// Определяем массив для процедуры ОбъединитьФайлы;\r\n\tМассивФайловДляОбъединения = Новый Массив;\r\n\t\r\n\t// Формируем начальный фрагмент файла POST-запроса;\t\r\n\tИмяФайлаОтправкиНачало = ПолучитьИмяВременногоФайла(\"txt\");\r\n\tФайлОтправкиНачало = Новый ЗаписьТекста(ИмяФайлаОтправкиНачало, КодировкаТекста.UTF8);\r\n\t\r\n\t// Формируем конечный фрагмент файла POST-запроса;\t\r\n\tИмяФайлаОтправкиКонец = ПолучитьИмяВременногоФайла(\"txt\");\r\n\tФайлаОтправкиКонец = Новый ЗаписьТекста(ИмяФайлаОтправкиКонец, КодировкаТекста.UTF8);\r\n\t\r\n\tТекстДляОтправки = \"\";\r\n\t\r\n\tТекстДляОтправки = ТекстДляОтправки + \"--\" + Boundary + Символы.ПС;\r\n\tТекстДляОтправки = ТекстДляОтправки + \"Content-Disposition: form-data; name=\"\"chat_id\"\"\" + Символы.ПС + Символы.ПС + СтрЗаменить(Формат(ChatID, \"ЧДЦ=0; ЧС=; ЧРГ=.; ЧГ=0\"), \".\", \"\") + Символы.ПС;\r\n\t\r\n\tТекстДляОтправки = ТекстДляОтправки + \"--\" + Boundary + Символы.ПС;\r\n\tТекстДляОтправки = ТекстДляОтправки + \"Content-Disposition: form-data; name=\"\"document\"\"; filename=\"\"/\" + ФайлОтправки.Имя + \"\"\"\" + Символы.ПС;\r\n\t\r\n\t// Записываем ФайлОтправкиНачало; \r\n\tФайлОтправкиНачало.ЗаписатьСтроку(ТекстДляОтправки);\r\n\tФайлОтправкиНачало.Закрыть();\r\n\t\r\n\tТекстДляОтправки = \"\" + Символы.ПС;\r\n\tТекстДляОтправки = ТекстДляОтправки + \"--\" +  Boundary+\"--\";\r\n\t\r\n\t// Записываем ФайлаОтправкиКонец; \r\n\tФайлаОтправкиКонец.ЗаписатьСтроку(ТекстДляОтправки);\r\n\tФайлаОтправкиКонец.Закрыть();\r\n\t\r\n\t// Заполняем массив;\r\n\tМассивФайловДляОбъединения.Добавить(ИмяФайлаОтправкиКонец);\r\n\tМассивФайловДляОбъединения.Добавить(ИмяФайлаОтправкиНачало);\r\n\tМассивФайловДляОбъединения.Добавить(СокрЛП(ПутьКФайлу));\r\n\t\r\n\t// Формируем ИмяФайлаОтправки;\r\n\tИмяФайлаОтправки = ПолучитьИмяВременногоФайла(\"txt\");\r\n\tОбъединитьФайлы(МассивФайловДляОбъединения, ИмяФайлаОтправки);\r\n\t\r\n\tHTTPЗапрос \t= Новый HTTPЗапрос;\r\n\tЗаголовки \t= Новый Соответствие;\r\n\t\r\n\t// Формируем Заголовки HTTP Запроса;\r\n\tHTTPЗапрос.Заголовки.Вставить(\"Connection\", \"keep-alive\");\r\n\tHTTPЗапрос.Заголовки.Вставить(\"Content-Type\", \"multipart/form-data; boundary=\"+Boundary);\r\n\t\r\n\tHTTPЗапрос.УстановитьИмяФайлаТела(ИмяФайлаОтправки);\r\n\t\r\n\t// Установим АдресРесурса;\r\n\tHTTPЗапрос.АдресРесурса \t= СтрокаСоединения;\r\n\t\r\n\tSSL  = Новый ЗащищенноеСоединениеOpenSSL();\r\n\tHTTPСоединение = Новый HTTPСоединение(ServerTg, 443,,,,, SSL);\r\n\t\r\n\tПопытка\r\n\t\t// POST запрос; \r\n\t\tОтвет = HTTPСоединение.ОтправитьДляОбработки(HTTPЗапрос);\r\n\t\t\r\n\t\tКодСостояния     = Ответ.КодСостояния;\r\n\t\tСтрокаОтвета     = Ответ.ПолучитьТелоКакСтроку();\r\n\t\t\r\n\t\tЕсли КодСостояния = 200 тогда\r\n\t\t\t// Читаем JSON;\r\n\t\t\tЧтениеJSON = Новый ЧтениеJSON;\r\n\t\t\t\r\n\t\t\tЧтениеJSON.УстановитьСтроку(СтрокаОтвета);\r\n\t\t\t\r\n\t\t\tРезультатСтруктура = ПрочитатьJSON(ЧтениеJSON);\r\n\t\t\t\r\n\t\t\tЕсли РезультатСтруктура.ok = Истина Тогда\r\n\t\t\t\tСтруктураMessage = РезультатСтруктура.result;\r\n\t\t\tКонецЕсли; \r\n\t\tИначе\r\n\t\t\tСообщить(\"КодСостояния \" + КодСостояния);\r\n\t\t\tСообщить(СтрокаОтвета);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tИсключение\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \"Ошибка: \" + ОписаниеОшибки();\r\n\t\tСообщение.Сообщить();\r\n\tКонецПопытки;\n\n{52} Переменной Заголовки присвоено значение, но оно нигде не используется\r\n{82} Переменной СтруктураMessage присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Нахождение интервалов в запросе",
    "description": "Нахождение интервалов в запросе",
    "code_snippet": "Запрос.Текст = \r\n\"ВЫБРАТЬ\r\n|\tДАТАВРЕМЯ(2023, 1, 1) КАК ДатаНачала,\r\n|\tДАТАВРЕМЯ(2023, 1, 1) КАК ДатаОкончания\r\n|ПОМЕСТИТЬ ВТИсходныеДанные\r\n|\r\n|ОБЪЕДИНИТЬ\r\n|\r\n|ВЫБРАТЬ\r\n|\tДАТАВРЕМЯ(2023, 1, 2),\r\n|\tДАТАВРЕМЯ(2023, 1, 2)\r\n|\r\n|ОБЪЕДИНИТЬ\r\n|\r\n|ВЫБРАТЬ\r\n|\tДАТАВРЕМЯ(2023, 1, 5),\r\n|\tДАТАВРЕМЯ(2023, 1, 9)\r\n|\r\n|ОБЪЕДИНИТЬ\r\n|\r\n|ВЫБРАТЬ\r\n|\tДАТАВРЕМЯ(2023, 1, 11),\r\n|\tДАТАВРЕМЯ(2023, 1, 11)\r\n|\r\n|ОБЪЕДИНИТЬ\r\n|\r\n|ВЫБРАТЬ\r\n|\tДАТАВРЕМЯ(2023, 1, 12),\r\n|\tДАТАВРЕМЯ(2023, 1, 12)\r\n|;\r\n|\r\n|////////////////////////////////////////////////////////////////////////////////\r\n|ВЫБРАТЬ\r\n|\tСправа.ДатаНачала КАК ДатаНачала,\r\n|\tСправа.ДатаОкончания КАК ДатаОкончания,\r\n|\tСУММА(РАЗНОСТЬДАТ(Слева.ДатаНачала, Слева.ДатаОкончания, ДЕНЬ) + 1) КАК Интеграл\r\n|ПОМЕСТИТЬ ВТИнтегралы\r\n|ИЗ\r\n|\tВТИсходныеДанные КАК Слева\r\n|\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТИсходныеДанные КАК Справа\r\n|\t\tПО Слева.ДатаНачала <= Справа.ДатаОкончания\r\n|\r\n|СГРУППИРОВАТЬ ПО\r\n|\tСправа.ДатаНачала,\r\n|\tСправа.ДатаОкончания\r\n|;\r\n|\r\n|////////////////////////////////////////////////////////////////////////////////\r\n|ВЫБРАТЬ\r\n|\tМИНИМУМ(ВТИнтегралы.ДатаНачала) КАК ДатаНачала,\r\n|\tМАКСИМУМ(ВТИнтегралы.ДатаОкончания) КАК ДатаОкончания\r\n|ИЗ\r\n|\tВТИнтегралы КАК ВТИнтегралы\r\n|\r\n|СГРУППИРОВАТЬ ПО\r\n|\tДОБАВИТЬКДАТЕ(ВТИнтегралы.ДатаОкончания, ДЕНЬ, -ВТИнтегралы.Интеграл)\"\n\nЗапрос.Текст = \r\n\"ВЫБРАТЬ\r\n|\tДАТАВРЕМЯ(2023, 1, 1) КАК ДатаНачала,\r\n|\tДАТАВРЕМЯ(2023, 1, 1) КАК ДатаОкончания\r\n|ПОМЕСТИТЬ ВТИсходныеДанные\r\n|\r\n|ОБЪЕДИНИТЬ\r\n|\r\n|ВЫБРАТЬ\r\n|\tДАТАВРЕМЯ(2023, 1, 2),\r\n|\tДАТАВРЕМЯ(2023, 1, 2)\r\n|\r\n|ОБЪЕДИНИТЬ\r\n|\r\n|ВЫБРАТЬ\r\n|\tДАТАВРЕМЯ(2023, 1, 5),\r\n|\tДАТАВРЕМЯ(2023, 1, 9)\r\n|\r\n|ОБЪЕДИНИТЬ\r\n|\r\n|ВЫБРАТЬ\r\n|\tДАТАВРЕМЯ(2023, 1, 11),\r\n|\tДАТАВРЕМЯ(2023, 1, 11)\r\n|\r\n|ОБЪЕДИНИТЬ\r\n|\r\n|ВЫБРАТЬ\r\n|\tДАТАВРЕМЯ(2023, 1, 12),\r\n|\tДАТАВРЕМЯ(2023, 1, 12)\r\n|;\r\n|\r\n|////////////////////////////////////////////////////////////////////////////////\r\n|ВЫБРАТЬ\r\n|\tСправа.ДатаНачала КАК ДатаНачала,\r\n|\tСправа.ДатаОкончания КАК ДатаОкончания,\r\n|\tСУММА(РАЗНОСТЬДАТ(Слева.ДатаНачала, Слева.ДатаОкончания, ДЕНЬ) + 1) КАК Интеграл\r\n|ПОМЕСТИТЬ ВТИнтегралы\r\n|ИЗ\r\n|\tВТИсходныеДанные КАК Слева\r\n|\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТИсходныеДанные КАК Справа\r\n|\t\tПО Слева.ДатаНачала <= Справа.ДатаОкончания\r\n|\r\n|СГРУППИРОВАТЬ ПО\r\n|\tСправа.ДатаНачала,\r\n|\tСправа.ДатаОкончания\r\n|;\r\n|\r\n|////////////////////////////////////////////////////////////////////////////////\r\n|ВЫБРАТЬ\r\n|\tМИНИМУМ(ВТИнтегралы.ДатаНачала) КАК ДатаНачала,\r\n|\tМАКСИМУМ(ВТИнтегралы.ДатаОкончания) КАК ДатаОкончания\r\n|ИЗ\r\n|\tВТИнтегралы КАК ВТИнтегралы\r\n|\r\n|СГРУППИРОВАТЬ ПО\r\n|\tДОБАВИТЬКДАТЕ(ВТИнтегралы.ДатаОкончания, ДЕНЬ, -ВТИнтегралы.Интеграл)\"\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Объединить ячейки в СКД",
    "description": "Объединить ячейки в СКД",
    "code_snippet": "Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\r\n\t\r\n\tСтандартнаяОбработка = Ложь;\r\n\t\r\n\tНастройки = КомпоновщикНастроек.ПолучитьНастройки();\r\n\t\r\n\tПолучитьДанныеНаОснованииСКД(СхемаКомпоновкиДанных, Настройки, ДокументРезультат,, ДанныеРасшифровки);\r\n\t\r\n\tОбъединитьЯчейкиВТабличномДокументе(ДокументРезультат, \"#\");\r\n\t\r\n\t\r\nКонецПроцедуры\r\n\r\n// Заполняет переданный объект на основани СКД\r\n//\r\n// Параметры\r\n//\r\n//  СКД – собствеено настройки СКД\r\n//\r\n//  ОбъектДляЗагрузки – объект в который выгружаются данные, таблица значений, дерево значений, табличный документ\r\n//\r\n//  ИсполняемыеНастройки – Пользовательские настройки СКД если не указаны будут использованы настроки СКД по умолчанию\r\n//\r\n//  СтруктураПараметров - Структура – Передаваемые для СКД параметры\r\n//\r\n//  краткий лекбез, поправлю позже\r\n//\r\nПроцедура ПолучитьДанныеНаОснованииСКД(СКД, ИсполняемыеНастройки = Неопределено, ОбъектДляЗагрузки, СтруктураПараметров = Неопределено, РасшифровкаСКД = Неопределено, МакетКомпоновки = Неопределено, ВнешниеНаборыДанных = Неопределено) Экспорт\r\n\r\n    КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\r\n    Если ТипЗнч(ОбъектДляЗагрузки) = Тип(\"ТабличныйДокумент\") Тогда\r\n        ТипГенератора = Тип(\"ГенераторМакетаКомпоновкиДанных\");\r\n    Иначе\r\n        ТипГенератора = Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\");\r\n    КонецЕсли;\r\n\r\n    Если ИсполняемыеНастройки = Неопределено Тогда\r\n        ИсполняемыеНастройки = СКД.НастройкиПоУмолчанию;\r\n    КонецЕсли;\r\n\r\n    Если СтруктураПараметров <> Неопределено Тогда\r\n        КоллекцияЗначенийПараметров = ИсполняемыеНастройки.ПараметрыДанных.Элементы;\r\n        Для каждого Параметр Из СтруктураПараметров Цикл\r\n            НайденноеЗначениеПараметра = КоллекцияЗначенийПараметров.Найти(Параметр.Ключ);\r\n            Если НайденноеЗначениеПараметра <> Неопределено Тогда\r\n                НайденноеЗначениеПараметра.Использование = Истина;\r\n                НайденноеЗначениеПараметра.Значение = Параметр.Значение;\r\n            КонецЕсли;\r\n        КонецЦикла;\r\n    КонецЕсли;\r\n\r\n    МакетКомпоновкиСКД = КомпоновщикМакета.Выполнить(СКД, ИсполняемыеНастройки, РасшифровкаСКД, МакетКомпоновки, ТипГенератора);\r\n    ПроцессорКомпановки = Новый ПроцессорКомпоновкиДанных;\r\n    ПроцессорКомпановки.Инициализировать(МакетКомпоновкиСКД, ВнешниеНаборыДанных, РасшифровкаСКД, Истина);\r\n    Если ТипЗнч(ОбъектДляЗагрузки) = Тип(\"ТабличныйДокумент\") Тогда\r\n        ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n        ПроцессорВывода.УстановитьДокумент(ОбъектДляЗагрузки);\r\n    Иначе\r\n        ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n        ПроцессорВывода.УстановитьОбъект(ОбъектДляЗагрузки);\r\n    КонецЕсли;\r\n\r\n    ПроцессорВывода.ОтображатьПроцентВывода = Истина;\r\n    ПроцессорВывода.Вывести(ПроцессорКомпановки, Истина);\r\n\r\nКонецПроцедуры // ПолучитьДанныеНаОснованииСКД()\r\n\r\nПроцедура ОбъединитьЯчейкиВТабличномДокументе(ТабличныйДокумент, МаркерОбъединения) Экспорт\r\n\t// Находит ячейки, содержащие в тексте МаркерОбъединения\r\n\t// Объединяет ячейки, располагающиеся рядом, содержащие одинаковый текст и маркер объединения \r\n\t\r\n\tОбъединяемыеЯчейки = НайтиОбластиТабличногоДокументаПоВхождениюПодстроки(ТабличныйДокумент, МаркерОбъединения);\r\n\tОбъединяемыеЯчейки.Колонки.Добавить(\"Диапазон\");\r\n\tОбъединяемыеЯчейки.Сортировать(\"Верх,Лево\");\r\n\t\r\n\tДля Каждого Строка из ОбъединяемыеЯчейки Цикл\r\n\t\tОтбор = Новый Структура(\"Текст,Верх,Лево\", Строка.Текст, Строка.Верх-1, Строка.Лево);\r\n\t\tНайденныеСтроки = ОбъединяемыеЯчейки.НайтиСтроки(Отбор);\r\n\t\tЕсли НайденныеСтроки.Количество() Тогда\r\n\t\t\tСтрока.Диапазон = НайденныеСтроки[0].Диапазон;\r\n\t\t\tСтрока.Диапазон.Низ = Макс(Строка.Диапазон.Низ, Строка.Верх);\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tОтбор = Новый Структура(\"Текст,Верх,Лево\", Строка.Текст, Строка.Верх, Строка.Лево-1);\r\n\t\tНайденныеСтроки = ОбъединяемыеЯчейки.НайтиСтроки(Отбор);\r\n\t\tЕсли НайденныеСтроки.Количество() Тогда\r\n\t\t\tСтрока.Диапазон = НайденныеСтроки[0].Диапазон;\r\n\t\t\tСтрока.Диапазон.Право = Макс(Строка.Диапазон.Право, Строка.Лево);\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tСтрока.Диапазон = Новый Структура(\"Текст,Верх,Лево,Низ,Право\", Строка.Текст, Строка.Верх, Строка.Лево, Строка.Верх, Строка.Лево);\r\n\tКонецЦикла;\r\n\t\r\n\tОбъединяемыеЯчейки.Свернуть(\"Диапазон\");\r\n\tДля Каждого Строка Из ОбъединяемыеЯчейки Цикл\r\n\t\tДиапазон = Строка.Диапазон;\r\n\t\tОбласть = ТабличныйДокумент.Область(Диапазон.Верх, Диапазон.Лево, Диапазон.Низ, Диапазон.Право);\r\n\t\tОбласть.Объединить();\r\n\t\t\r\n\t\t// Удалим маркер объединения из текст ячейки\r\n\t\tОбласть.Текст = СтрЗаменить(Область.Текст, МаркерОбъединения, \"\");\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция НайтиОбластиТабличногоДокументаПоВхождениюПодстроки(ТабличныйДокумент, ПодстрокаПоиска) Экспорт\r\n\t\r\n\tНайденныеОбласти = Новый ТаблицаЗначений;\r\n\tНайденныеОбласти.Колонки.Добавить(\"Область\");\r\n\tНайденныеОбласти.Колонки.Добавить(\"Текст\");\r\n\tНайденныеОбласти.Колонки.Добавить(\"Верх\");\r\n\tНайденныеОбласти.Колонки.Добавить(\"Лево\");\r\n\t\r\n\tНайденнаяОбласть = ТабличныйДокумент.НайтиТекст(ПодстрокаПоиска);\r\n\t\r\n\tПока НЕ НайденнаяОбласть = Неопределено Цикл\r\n\t\t\r\n\t\tНоваяСтрока = НайденныеОбласти.Добавить();\r\n\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, НайденнаяОбласть);\r\n\t\tНоваяСтрока.Область = НайденнаяОбласть;\r\n\t\t\r\n\t\tНайденнаяОбласть = ТабличныйДокумент.НайтиТекст(ПодстрокаПоиска, НайденнаяОбласть);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат НайденныеОбласти;\r\n\t\r\nКонецФункции\n\nПроцедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\r\n\t\r\n\tСтандартнаяОбработка = Ложь;\r\n\t\r\n\tНастройки = КомпоновщикНастроек.ПолучитьНастройки();\r\n\t\r\n\tПолучитьДанныеНаОснованииСКД(СхемаКомпоновкиДанных, Настройки, ДокументРезультат,, ДанныеРасшифровки);\r\n\t\r\n\tОбъединитьЯчейкиВТабличномДокументе(ДокументРезультат, \"#\");\r\n\t\r\n\t\r\nКонецПроцедуры\r\n\r\n// Заполняет переданный объект на основани СКД\r\n//\r\n// Параметры\r\n//\r\n//  СКД – собствеено настройки СКД\r\n//\r\n//  ОбъектДляЗагрузки – объект в который выгружаются данные, таблица значений, дерево значений, табличный документ\r\n//\r\n//  ИсполняемыеНастройки – Пользовательские настройки СКД если не указаны будут использованы настроки СКД по умолчанию\r\n//\r\n//  СтруктураПараметров - Структура – Передаваемые для СКД параметры\r\n//\r\n//  краткий лекбез, поправлю позже\r\n//\r\nПроцедура ПолучитьДанныеНаОснованииСКД(СКД, ИсполняемыеНастройки = Неопределено, ОбъектДляЗагрузки, СтруктураПараметров = Неопределено, РасшифровкаСКД = Неопределено, МакетКомпоновки = Неопределено, ВнешниеНаборыДанных = Неопределено) Экспорт\r\n\r\n    КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\r\n    Если ТипЗнч(ОбъектДляЗагрузки) = Тип(\"ТабличныйДокумент\") Тогда\r\n        ТипГенератора = Тип(\"ГенераторМакетаКомпоновкиДанных\");\r\n    Иначе\r\n        ТипГенератора = Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\");\r\n    КонецЕсли;\r\n\r\n    Если ИсполняемыеНастройки = Неопределено Тогда\r\n        ИсполняемыеНастройки = СКД.НастройкиПоУмолчанию;\r\n    КонецЕсли;\r\n\r\n    Если СтруктураПараметров <> Неопределено Тогда\r\n        КоллекцияЗначенийПараметров = ИсполняемыеНастройки.ПараметрыДанных.Элементы;\r\n        Для каждого Параметр Из СтруктураПараметров Цикл\r\n            НайденноеЗначениеПараметра = КоллекцияЗначенийПараметров.Найти(Параметр.Ключ);\r\n            Если НайденноеЗначениеПараметра <> Неопределено Тогда\r\n                НайденноеЗначениеПараметра.Использование = Истина;\r\n                НайденноеЗначениеПараметра.Значение = Параметр.Значение;\r\n            КонецЕсли;\r\n        КонецЦикла;\r\n    КонецЕсли;\r\n\r\n    МакетКомпоновкиСКД = КомпоновщикМакета.Выполнить(СКД, ИсполняемыеНастройки, РасшифровкаСКД, МакетКомпоновки, ТипГенератора);\r\n    ПроцессорКомпановки = Новый ПроцессорКомпоновкиДанных;\r\n    ПроцессорКомпановки.Инициализировать(МакетКомпоновкиСКД, ВнешниеНаборыДанных, РасшифровкаСКД, Истина);\r\n    Если ТипЗнч(ОбъектДляЗагрузки) = Тип(\"ТабличныйДокумент\") Тогда\r\n        ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n        ПроцессорВывода.УстановитьДокумент(ОбъектДляЗагрузки);\r\n    Иначе\r\n        ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n        ПроцессорВывода.УстановитьОбъект(ОбъектДляЗагрузки);\r\n    КонецЕсли;\r\n\r\n    ПроцессорВывода.ОтображатьПроцентВывода = Истина;\r\n    ПроцессорВывода.Вывести(ПроцессорКомпановки, Истина);\r\n\r\nКонецПроцедуры // ПолучитьДанныеНаОснованииСКД()\r\n\r\nПроцедура ОбъединитьЯчейкиВТабличномДокументе(ТабличныйДокумент, МаркерОбъединения) Экспорт\r\n\t// Находит ячейки, содержащие в тексте МаркерОбъединения\r\n\t// Объединяет ячейки, располагающиеся рядом, содержащие одинаковый текст и маркер объединения \r\n\t\r\n\tОбъединяемыеЯчейки = НайтиОбластиТабличногоДокументаПоВхождениюПодстроки(ТабличныйДокумент, МаркерОбъединения);\r\n\tОбъединяемыеЯчейки.Колонки.Добавить(\"Диапазон\");\r\n\tОбъединяемыеЯчейки.Сортировать(\"Верх,Лево\");\r\n\t\r\n\tДля Каждого Строка из ОбъединяемыеЯчейки Цикл\r\n\t\tОтбор = Новый Структура(\"Текст,Верх,Лево\", Строка.Текст, Строка.Верх-1, Строка.Лево);\r\n\t\tНайденныеСтроки = ОбъединяемыеЯчейки.НайтиСтроки(Отбор);\r\n\t\tЕсли НайденныеСтроки.Количество() Тогда\r\n\t\t\tСтрока.Диапазон = НайденныеСтроки[0].Диапазон;\r\n\t\t\tСтрока.Диапазон.Низ = Макс(Строка.Диапазон.Низ, Строка.Верх);\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tОтбор = Новый Структура(\"Текст,Верх,Лево\", Строка.Текст, Строка.Верх, Строка.Лево-1);\r\n\t\tНайденныеСтроки = ОбъединяемыеЯчейки.НайтиСтроки(Отбор);\r\n\t\tЕсли НайденныеСтроки.Количество() Тогда\r\n\t\t\tСтрока.Диапазон = НайденныеСтроки[0].Диапазон;\r\n\t\t\tСтрока.Диапазон.Право = Макс(Строка.Диапазон.Право, Строка.Лево);\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tСтрока.Диапазон = Новый Структура(\"Текст,Верх,Лево,Низ,Право\", Строка.Текст, Строка.Верх, Строка.Лево, Строка.Верх, Строка.Лево);\r\n\tКонецЦикла;\r\n\t\r\n\tОбъединяемыеЯчейки.Свернуть(\"Диапазон\");\r\n\tДля Каждого Строка Из ОбъединяемыеЯчейки Цикл\r\n\t\tДиапазон = Строка.Диапазон;\r\n\t\tОбласть = ТабличныйДокумент.Область(Диапазон.Верх, Диапазон.Лево, Диапазон.Низ, Диапазон.Право);\r\n\t\tОбласть.Объединить();\r\n\t\t\r\n\t\t// Удалим маркер объединения из текст ячейки\r\n\t\tОбласть.Текст = СтрЗаменить(Область.Текст, МаркерОбъединения, \"\");\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция НайтиОбластиТабличногоДокументаПоВхождениюПодстроки(ТабличныйДокумент, ПодстрокаПоиска) Экспорт\r\n\t\r\n\tНайденныеОбласти = Новый ТаблицаЗначений;\r\n\tНайденныеОбласти.Колонки.Добавить(\"Область\");\r\n\tНайденныеОбласти.Колонки.Добавить(\"Текст\");\r\n\tНайденныеОбласти.Колонки.Добавить(\"Верх\");\r\n\tНайденныеОбласти.Колонки.Добавить(\"Лево\");\r\n\t\r\n\tНайденнаяОбласть = ТабличныйДокумент.НайтиТекст(ПодстрокаПоиска);\r\n\t\r\n\tПока НЕ НайденнаяОбласть = Неопределено Цикл\r\n\t\t\r\n\t\tНоваяСтрока = НайденныеОбласти.Добавить();\r\n\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, НайденнаяОбласть);\r\n\t\tНоваяСтрока.Область = НайденнаяОбласть;\r\n\t\t\r\n\t\tНайденнаяОбласть = ТабличныйДокумент.НайтиТекст(ПодстрокаПоиска, НайденнаяОбласть);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат НайденныеОбласти;\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в основани: основани\r\nОрфографическая ошибка в собствеено: собствеено\r\nОрфографическая ошибка в настроки: настроки\r\nОрфографическая ошибка в лекбез: лекбез\r\nОрфографическая ошибка в ПроцессорКомпановки (найдено 3): Компановки"
  },
  {
    "title": "Перенос настроек данных формы между пользователями",
    "description": "Перенос настроек данных формы между пользователями",
    "code_snippet": "&НаСервере\nПроцедура ПеренестиНастройкиНаСервере()\n\t\n\tКлючОбъекта = \"ВнешняяОбработка.ИмяВнешнейОбработки.Форма.Форма\";\n\tВладелецНастроек = \"ИмяВладельцаНастроек\";\n\t\n\tСписок = ХранилищеНастроекДанныхФорм.ПолучитьСписок(КлючОбъекта,ВладелецНастроек);\n\tДля каждого Настрока из Список Цикл  \n\t\t\n\t\tКлючНастроек = Настрока.Значение;\n\t\tПредставление = Настрока.Представление;\n\t\tВыборка =  ХранилищеНастроекДанныхФорм.Выбрать(новый Структура(\"КлючОбъекта, КлючНастроек\", КлючОбъекта, КлючНастроек));\n\t\tОписаниеНастройки = новый ОписаниеНастроек;\n\t\tОписаниеНастройки.КлючНастроек = КлючОбъекта;\n\t\tОписаниеНастройки.КлючНастроек = КлючНастроек;\n\t\tОписаниеНастройки.Представление = Представление;\n\n\t\tПока Выборка.Следующий() цикл\n\t\t\tХранилищеНастроекДанныхФорм.Сохранить(КлючОбъекта, КлючНастроек, Выборка.Настройки, ОписаниеНастройки, \"ИмяПользователяНастроек\");\t\n\t\tКонецЦикла;\n\t\t\n\tКонецЦикла; \n\nКонецПроцедуры"
  },
  {
    "title": "Выгрузка результата запроса в текстовый файл с разделителями",
    "description": "Выгрузка результата запроса в текстовый файл с разделителями",
    "code_snippet": "Процедура ВыгрузитьВыборкуЗапросаВТекстовыйФайл(ВыборкаЗапроса, стрИменаКолонок, стрАдресФайла, Разделитель = Неопределено) Экспорт\r\n  //Выгрузка результата запроса в текстовый файл с разделителями\r\n  //ВыборкаЗапроса = Запрос.Выполнить().Выбрать(); \r\n  //стрИменаКолонок - строка, имена колонок через запятую из которых нужно сохранить данные в файл + порядок колонок\r\n  //стрАдресФайла - строка\r\n  //Разделитель -  по-умолчанию: Символы.Таб; можно использовать Символы. ВК (CR),ВТаб (VTab),НПП (NBSp),ПС (LF),ПФ (FF),Таб (Tab)\r\n  //    При загрузке строку можно будет разложить в массив для дальнейшей работы, РазложитьСтрокуВМассивПодстрок( ТекСтр, Символы.Таб).\r\n  \r\n  Если Разделитель = Неопределено Тогда\r\n    Разделитель = Символы.Таб;\r\n  КонецЕсли; \r\n  \r\n  Текст = Новый ЗаписьТекста(стрАдресФайла, КодировкаТекста.ANSI);\r\n  \r\n  стрИменаКолонок = РазложитьСтрокуВМассивПодстрок(стрИменаКолонок, \",\");\r\n  чКоличествоКолонок = стрИменаКолонок.Количество();\r\n  чНомерКолонки = 1;\r\n  \r\n  Пока ВыборкаЗапроса.Следующий() Цикл  \r\n    ОбработкаПрерыванияПользователя();\r\n    Для каждого стрИмяПоля Из стрИменаКолонок Цикл\r\n      Значение = ВыборкаЗапроса[стрИмяПоля];\r\n      \r\n      Если ТипЗнч(Значение) = Тип(\"Дата\") Тогда\r\n        Значение = Формат(Значение,\"ДЛФ=D\");\r\n      КонецЕсли; \r\n      \r\n      стрРазделитель = ?(чКоличествоКолонок = чНомерКолонки, \"\", Разделитель);\r\n      Текст.ЗаписатьСтроку(Строка(Значение) + стрРазделитель); \r\n      \r\n      чНомерКолонки = чНомерКолонки + 1;\r\n    КонецЦикла; \r\n  КонецЦикла;  \r\n  \r\n  Текст.Закрыть();\r\n  \r\nКонецПроцедуры\n\nПроцедура ВыгрузитьВыборкуЗапросаВТекстовыйФайл(ВыборкаЗапроса, стрИменаКолонок, стрАдресФайла, Разделитель = Неопределено) Экспорт\r\n  //Выгрузка результата запроса в текстовый файл с разделителями\r\n  //ВыборкаЗапроса = Запрос.Выполнить().Выбрать(); \r\n  //стрИменаКолонок - строка, имена колонок через запятую из которых нужно сохранить данные в файл + порядок колонок\r\n  //стрАдресФайла - строка\r\n  //Разделитель -  по-умолчанию: Символы.Таб; можно использовать Символы. ВК (CR),ВТаб (VTab),НПП (NBSp),ПС (LF),ПФ (FF),Таб (Tab)\r\n  //    При загрузке строку можно будет разложить в массив для дальнейшей работы, РазложитьСтрокуВМассивПодстрок( ТекСтр, Символы.Таб).\r\n  \r\n  Если Разделитель = Неопределено Тогда\r\n    Разделитель = Символы.Таб;\r\n  КонецЕсли; \r\n  \r\n  Текст = Новый ЗаписьТекста(стрАдресФайла, КодировкаТекста.ANSI);\r\n  \r\n  стрИменаКолонок = РазложитьСтрокуВМассивПодстрок(стрИменаКолонок, \",\");\r\n  чКоличествоКолонок = стрИменаКолонок.Количество();\r\n  чНомерКолонки = 1;\r\n  \r\n  Пока ВыборкаЗапроса.Следующий() Цикл  \r\n    ОбработкаПрерыванияПользователя();\r\n    Для каждого стрИмяПоля Из стрИменаКолонок Цикл\r\n      Значение = ВыборкаЗапроса[стрИмяПоля];\r\n      \r\n      Если ТипЗнч(Значение) = Тип(\"Дата\") Тогда\r\n        Значение = Формат(Значение,\"ДЛФ=D\");\r\n      КонецЕсли; \r\n      \r\n      стрРазделитель = ?(чКоличествоКолонок = чНомерКолонки, \"\", Разделитель);\r\n      Текст.ЗаписатьСтроку(Строка(Значение) + стрРазделитель); \r\n      \r\n      чНомерКолонки = чНомерКолонки + 1;\r\n    КонецЦикла; \r\n  КонецЦикла;  \r\n  \r\n  Текст.Закрыть();\r\n  \r\nКонецПроцедуры"
  },
  {
    "title": "XML Сериализация  элементов прикладного объекта",
    "description": "XML Сериализация  элементов прикладного объекта",
    "code_snippet": "// Сериализация через XDTO;\r\n\t\r\n\t// 1. Создаем объект ЗаписьXML;\r\n\tЗаписьXML = Новый ЗаписьXML;   \r\n\t\r\n\t// 2. Указываем путь к сохраненному файлу;\r\n\tЗаписьXML.ОткрытьФайл(Объект.ПутьКФайлу + \"\\ВыгруженныеОбъекты.xml\", \"UTF-8\");\r\n\t\r\n\t// 3. Записываем объявление типа: <?xml version=\"1.0\" encoding=\"UTF-8\"?>;\r\n\tЗаписьXML.ЗаписатьОбъявлениеXML();\r\n\t\r\n\t// 4. Записываем название корневого элемента;\r\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"РеализацияТоваров\");  \r\n\t\r\n\t//для того чтобы пространства имен не объявлялись сериализатором в кажом элементе, пишем их в корневой элемент\r\n\t//они будут работать на все вложеные элементы\r\n\t//пространство имен по-умолчанию\r\n\tЗаписьXML.ЗаписатьСоответствиеПространстваИмен(\"\", \"http://v8.1c.ru/8.1/data/enterprise/current-config\");\r\n\t//пространства имен остальные префиксы\r\n\tЗаписьXML.ЗаписатьСоответствиеПространстваИмен(\"xsd\", \"http://www.w3.org/2001/XMLSchema\");\r\n\tЗаписьXML.ЗаписатьСоответствиеПространстваИмен(\"xsi\", \"http://www.w3.org/2001/XMLSchema-instance\");\r\n\t\r\n\t// 5. Сериализуем именно объекты (ссылки сериализуются по другому), что \"ДОСТУПНО\", то и сериализуется;\r\n\tДля каждого ТекСтрока Из ТаблицаДокументов Цикл \r\n\t\t СериализаторXDTO.ЗаписатьXML(ЗаписьXML, ТекСтрока.Ссылка.ПолучитьОбъект());\r\n\tКонецЦикла; \r\n\t\r\n\t// 6. Конец корневого элемента;\r\n\tЗаписьXML.ЗаписатьКонецЭлемента();\r\n\t\r\n\t// 7. Обязательно закрываем запись;\r\n\tЗаписьXML.Закрыть();\n\n// Сериализация через XDTO;\r\n\t\r\n\t// 1. Создаем объект ЗаписьXML;\r\n\tЗаписьXML = Новый ЗаписьXML;   \r\n\t\r\n\t// 2. Указываем путь к сохраненному файлу;\r\n\tЗаписьXML.ОткрытьФайл(Объект.ПутьКФайлу + \"\\ВыгруженныеОбъекты.xml\", \"UTF-8\");\r\n\t\r\n\t// 3. Записываем объявление типа: <?xml version=\"1.0\" encoding=\"UTF-8\"?>;\r\n\tЗаписьXML.ЗаписатьОбъявлениеXML();\r\n\t\r\n\t// 4. Записываем название корневого элемента;\r\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"РеализацияТоваров\");  \r\n\t\r\n\t//для того чтобы пространства имен не объявлялись сериализатором в кажом элементе, пишем их в корневой элемент\r\n\t//они будут работать на все вложеные элементы\r\n\t//пространство имен по-умолчанию\r\n\tЗаписьXML.ЗаписатьСоответствиеПространстваИмен(\"\", \"http://v8.1c.ru/8.1/data/enterprise/current-config\");\r\n\t//пространства имен остальные префиксы\r\n\tЗаписьXML.ЗаписатьСоответствиеПространстваИмен(\"xsd\", \"http://www.w3.org/2001/XMLSchema\");\r\n\tЗаписьXML.ЗаписатьСоответствиеПространстваИмен(\"xsi\", \"http://www.w3.org/2001/XMLSchema-instance\");\r\n\t\r\n\t// 5. Сериализуем именно объекты (ссылки сериализуются по другому), что \"ДОСТУПНО\", то и сериализуется;\r\n\tДля каждого ТекСтрока Из ТаблицаДокументов Цикл \r\n\t\t СериализаторXDTO.ЗаписатьXML(ЗаписьXML, ТекСтрока.Ссылка.ПолучитьОбъект());\r\n\tКонецЦикла; \r\n\t\r\n\t// 6. Конец корневого элемента;\r\n\tЗаписьXML.ЗаписатьКонецЭлемента();\r\n\t\r\n\t// 7. Обязательно закрываем запись;\r\n\tЗаписьXML.Закрыть();"
  },
  {
    "title": "Отключение проверки АПК",
    "description": "Вставляет в модуль шаблоны областей по стандартам разработки 1С",
    "code_snippet": ""
  },
  {
    "title": "Окружить текст оператором НСТР",
    "description": "Скрипт окружает выделенный фрагмент НСТР, либо создаёт шаблон НСТР, если ничего не выделено.",
    "code_snippet": ""
  },
  {
    "title": "Сохранить/Прочитать настройки СКД для обработок и прочих модулей",
    "description": "Сохранить/Прочитать настройки СКД для обработок и прочих модулей",
    "code_snippet": "Процедура СохранитьНастройкиСКД(КомпоновщикНастроекНастройки)\n\t\n\tОбщегоНазначения.ХранилищеОбщихНастроекСохранить(КлючОбъектаСтрокой(), КлючНастроекСтрокой(), КомпоновщикНастроекНастройки);\n\t\nКонецПроцедуры\n\nФункция ВосстановитьНастройкиСКД()\n\t\n\tКомпоновщикНастроекНастройки = ОбщегоНазначения.ХранилищеОбщихНастроекЗагрузить(КлючОбъектаСтрокой(), КлючНастроекСтрокой());\n\t\n\tВозврат КомпоновщикНастроекНастройки;\n\t\nКонецФункции\n\n// Процедура - Заполнить реквизиты формы из настроек компановщика\n//  Заполняет одноименные реквизиты формы из переданной настройки компоновщика (можно дополнить заполнение по структуре или соответствию)\n//\n// Параметры:\n//  КомпоновщикНастроекНастройки - НастройкиКомпоновкиДанных - Настройка компоновки данных (например, сохраненная ранее и восстановленная/прочитанная)\n//  по которой требуется заполнить реквизиты формы обработки\n//\nПроцедура ЗаполнитьРеквизитыФормыИзНастроекКомпановщика(КомпоновщикНастроекНастройки, НеЗаполняемыеПоля = \"\")\n\t\n\tНеЗаполняемыеПоля_ = Новый Массив;\n\tЕсли ТипЗнч(НеЗаполняемыеПоля) = Тип(\"Строка\") Тогда\n\t\tНеЗаполняемыеПоля_ = СтрРазделить(НеЗаполняемыеПоля, \",\");\n\tИначе\n\t\tНеЗаполняемыеПоля_ = НеЗаполняемыеПоля;\n\tКонецЕсли;\n\tДля Н = 0 По НеЗаполняемыеПоля_.Количество() - 1 Цикл\n\t\tНеЗаполняемыеПоля_[Н] = СокрЛП(НеЗаполняемыеПоля_[Н])\n\tКонецЦикла;\n\t\n\tЕсли ТипЗнч(КомпоновщикНастроекНастройки) = Тип(\"НастройкиКомпоновкиДанных\") Тогда\n\t\t\n\t\tСтруктураПараметров = Новый Структура;\n\t\t\n\t\tДля Каждого ТекПараметр Из КомпоновщикНастроекНастройки.ПараметрыДанных.Элементы Цикл\n\t\t\t\n\t\t\tИмяПараметра = Строка(ТекПараметр.Параметр);\n\t\t\tЕсли НеЗаполняемыеПоля_.Найти(ИмяПараметра) <> Неопределено Тогда Продолжить КонецЕсли;\n\t\t\tЗначениеПараметра = ТекПараметр.Значение;\n\t\t\t\n\t\t\tСтруктураПараметров.Вставить(ИмяПараметра, ЗначениеПараметра);\n\t\t\t\n\t\tКонецЦикла;\n\t\t\n\t\tМассивРеквизитовФормы = ЭтаФорма.ПолучитьРеквизиты();\n\t\tИменаРеквизитовФормы = Новый Массив;\n\t\tДля Каждого ТекРеквизит Из МассивРеквизитовФормы Цикл\n\t\t\tИменаРеквизитовФормы.Добавить(ТекРеквизит.Имя);\n\t\tКонецЦикла;\n\t\t\n\t\tДля Каждого ТекПараметр Из СтруктураПараметров Цикл\n\t\t\t\n\t\t\tЕсли ИменаРеквизитовФормы.Найти(ТекПараметр.Ключ) <> Неопределено Тогда\n\t\t\t\t\n\t\t\t\tЕсли ТипЗнч(ТекПараметр.Значение) = Тип(\"СписокЗначений\") Тогда\n\t\t\t\t\t\n\t\t\t\t\tЭтаФорма[ТекПараметр.Ключ].ЗагрузитьЗначения(ТекПараметр.Значение.ВыгрузитьЗначения());\n\t\t\t\t\tДля Каждого ТекЗнч Из ЭтаФорма[ТекПараметр.Ключ] Цикл\n\t\t\t\t\t\tТекЗнч.Пометка = Истина\n\t\t\t\t\tКонецЦикла;\n\t\t\t\t\t\n\t\t\t\tИначе\n\t\t\t\t\tЭтаФорма[ТекПараметр.Ключ] = ТекПараметр.Значение;\n\t\t\t\tКонецЕсли;\n\t\t\t\t\n\t\t\tКонецЕсли;\n\t\t\t\n\t\tКонецЦикла;\n\t\t\n\tИначе\n\t\t// Можно добавить обработку структуры или соответствия, но пока не нужно\n\t\tВозврат\n\tКонецЕсли;\n\t\nКонецПроцедуры"
  },
  {
    "title": "Получить число из строки",
    "description": "Получить число из строки",
    "code_snippet": "Функция ПолучитьСтрокуТолькоЦифры(ВходнаяСтрока)     \r\n\t\r\n\tРезультат = ВходнаяСтрока;   \r\n\t\r\n\tИндексЭлемента = 1;  \r\n\tДоступныеСимволы = \"0123456789\";\r\n\t\r\n\tПока ИндексЭлемента <= СтрДлина(Результат) Цикл\r\n\t\tПроверяемыйСимвол = Сред(Результат, ИндексЭлемента, 1);\r\n\t\t\r\n\t\t\r\n\t\tЕсли СтрНайти(ДоступныеСимволы, ПроверяемыйСимвол) = 0 Тогда\r\n\t\t\tРезультат = СтрЗаменить(Результат, ПроверяемыйСимвол, \"\");\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t\r\n\t\tИндексЭлемента = ИндексЭлемента + 1;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nФункция ПолучитьСтрокуТолькоЦифры(ВходнаяСтрока)     \r\n\t\r\n\tРезультат = ВходнаяСтрока;   \r\n\t\r\n\tИндексЭлемента = 1;  \r\n\tДоступныеСимволы = \"0123456789\";\r\n\t\r\n\tПока ИндексЭлемента <= СтрДлина(Результат) Цикл\r\n\t\tПроверяемыйСимвол = Сред(Результат, ИндексЭлемента, 1);\r\n\t\t\r\n\t\t\r\n\t\tЕсли СтрНайти(ДоступныеСимволы, ПроверяемыйСимвол) = 0 Тогда\r\n\t\t\tРезультат = СтрЗаменить(Результат, ПроверяемыйСимвол, \"\");\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t\r\n\t\tИндексЭлемента = ИндексЭлемента + 1;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Получение данных об организации и контрагентах в типовых конфигурациях с помощью БСП",
    "description": "Получение данных об организации и контрагентах в типовых конфигурациях с помощью БСП",
    "code_snippet": "СведенияОКонтрагенте = БухгалтерскийУчетПереопределяемый.СведенияОЮрФизЛице(Контрагент.ССылка, ТекущаяДата());\n\nСтрокаКонтрагент = ОбщегоНазначенияБПВызовСервера.ОписаниеОрганизации(СведенияОКонтрагенте,\"\",);\n\n// ООО \"Автотрейд\", ИНН 7799555720, 142770, Москва г, МКАД 40-й (п Сосенское) км,\n// владение № 1, строение 2, р/с 40702810100000000004, в банке ПАО СБЕРБАНК, БИК 044525225, \n// к/с 30101810400000000225\n\nОрганизацияСтуркт = БухгалтерскийУчетПереопределяемый.СтруктураОрганизации(Организация.Ссылка);"
  },
  {
    "title": "СкопироватьДокумент, Копирование документа",
    "description": "СкопироватьДокумент, Копирование документа",
    "code_snippet": "// Выполняет копирование документа.\r\n//\r\n// Параметры:\r\n//  Приемник\t\t\t\t\t - Объект\t - Документ, в который копируются данные.\r\n//  Источник\t\t\t\t\t - Ссылка\t - Документ, из которого копируются данные.\r\n//  ИсключаемыеСвойства\t\t\t - Строка\t - Имена свойств, разделенные запятыми, которые необходимо исключить из заполнения.\r\n//  ИсключаемыеТабличныеЧасти\t - Строка\t - Имена табличных частей, разделенные запятыми, которые необходимо исключить из заполнения.\r\n//  ДанныеЗаполнения\t\t\t - Структура - Значение параметра процедуры ОбработкаЗаполнения, используется как основание для заполнения документа.\r\n//\r\nПроцедура СкопироватьДокумент(Приемник, Источник, ИсключаемыеСвойства = \"\", ИсключаемыеТабличныеЧасти = \"\", ДанныеЗаполнения = Неопределено) Экспорт\r\n\t\r\n\tДанныеДокумента = Источник.Скопировать();\r\n\tМетаданныеДокумента = Приемник.Метаданные();\r\n\t\r\n\tЗаполнитьЗначенияСвойств(Приемник, ДанныеДокумента, , ИсключаемыеСвойства);\r\n\t\r\n\t// ЗарплатаКадрыПодсистемы.КадровыйУчет.ЭлектронныеТрудовыеКнижки\r\n\t\r\n\tЭлектронныеТрудовыеКнижкиРасширенный.ПриЗаполненииДокументаИсправления(Приемник, Источник);\r\n\t\r\n\t// Конец ЗарплатаКадрыПодсистемы.КадровыйУчет.ЭлектронныеТрудовыеКнижки\r\n\t\r\n\tЕсли ИсключаемыеТабличныеЧасти = \"\" Тогда\r\n\t\tИменаИсключаемыхТабличныхЧастей = Новый Массив;\r\n\tИначе\r\n\t\tИменаИсключаемыхТабличныхЧастей = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(ИсключаемыеТабличныеЧасти, , , Истина);\r\n\tКонецЕсли;\r\n\t\r\n\tДля каждого ТабличнаяЧастьДокумента Из МетаданныеДокумента.ТабличныеЧасти Цикл\r\n\t\tЕсли ИменаИсключаемыхТабличныхЧастей.Найти(ТабличнаяЧастьДокумента.Имя) <> Неопределено Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\tДля Каждого СтрокаДокумента Из Источник[ТабличнаяЧастьДокумента.Имя] Цикл\r\n\t\t\tНоваяСтрока = Приемник[ТабличнаяЧастьДокумента.Имя].Добавить();\r\n\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаДокумента);\r\n\t\tКонецЦикла;\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли ДанныеЗаполнения = Неопределено Тогда\r\n\t\tДанныеЗаполнения = Новый Структура;\r\n\t\tИсправлениеВТекущемПериоде = Ложь;\r\n\tИначе\r\n\t\tИсправлениеВТекущемПериоде = ДанныеЗаполнения.Свойство(\"ДопустимоИсправлениеВТекущемПериоде\")\r\n\t\t\tИ ДанныеЗаполнения.ДопустимоИсправлениеВТекущемПериоде\r\n\t\t\tИ ВозможноИсправлениеТекущимПериодом(Источник);\r\n\tКонецЕсли;\r\n\r\n\tЕсли Не ИсправлениеВТекущемПериоде Тогда\r\n\t\t// Период регистрации документа исправления необходимо увеличить.\r\n\t\tЕсли ДанныеЗаполнения.Свойство(\"ИмяПериодРегистрации\") Тогда\r\n\t\t\tИмяПериодРегистрации = ДанныеЗаполнения.ИмяПериодРегистрации;\r\n\t\t\tПериодРегистрацииИсправленногоДокумента = ДанныеЗаполнения.ПериодРегистрацииИсправленногоДокумента;\r\n\t\tИначе\r\n\t\t\tМетаданныеРеквизита = МетаданныеДокумента.Реквизиты.Найти(\"ПериодРегистрации\");\r\n\t\t\tЕсли МетаданныеРеквизита = Неопределено Тогда\r\n\t\t\t\tМетаданныеРеквизита = МетаданныеДокумента.Реквизиты.Найти(\"МесяцНачисления\");\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tЕсли МетаданныеРеквизита <> Неопределено Тогда\r\n\t\t\t\tИмяПериодРегистрации = МетаданныеРеквизита.Имя;\r\n\t\t\t\tПериодРегистрацииИсправленногоДокумента = ДанныеДокумента[ИмяПериодРегистрации];\r\n\t\t\tИначе\r\n\t\t\t\tИмяПериодРегистрации = Неопределено;\r\n\t\t\t\tПериодРегистрацииИсправленногоДокумента = Дата(1, 1, 1);\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ИмяПериодРегистрации <> Неопределено Тогда\r\n\t\t\tЗначения = Новый Структура(\"Месяц\");\r\n\t\t\tЗарплатаКадры.ПолучитьЗначенияПоУмолчанию(Значения);\r\n\t\t\t\r\n\t\t\tПриемник[ИмяПериодРегистрации] = Макс(ДобавитьМесяц(ПериодРегистрацииИсправленногоДокумента, 1), Значения.Месяц);\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\n// Выполняет копирование документа.\r\n//\r\n// Параметры:\r\n//  Приемник\t\t\t\t\t - Объект\t - Документ, в который копируются данные.\r\n//  Источник\t\t\t\t\t - Ссылка\t - Документ, из которого копируются данные.\r\n//  ИсключаемыеСвойства\t\t\t - Строка\t - Имена свойств, разделенные запятыми, которые необходимо исключить из заполнения.\r\n//  ИсключаемыеТабличныеЧасти\t - Строка\t - Имена табличных частей, разделенные запятыми, которые необходимо исключить из заполнения.\r\n//  ДанныеЗаполнения\t\t\t - Структура - Значение параметра процедуры ОбработкаЗаполнения, используется как основание для заполнения документа.\r\n//\r\nПроцедура СкопироватьДокумент(Приемник, Источник, ИсключаемыеСвойства = \"\", ИсключаемыеТабличныеЧасти = \"\", ДанныеЗаполнения = Неопределено) Экспорт\r\n\t\r\n\tДанныеДокумента = Источник.Скопировать();\r\n\tМетаданныеДокумента = Приемник.Метаданные();\r\n\t\r\n\tЗаполнитьЗначенияСвойств(Приемник, ДанныеДокумента, , ИсключаемыеСвойства);\r\n\t\r\n\t// ЗарплатаКадрыПодсистемы.КадровыйУчет.ЭлектронныеТрудовыеКнижки\r\n\t\r\n\tЭлектронныеТрудовыеКнижкиРасширенный.ПриЗаполненииДокументаИсправления(Приемник, Источник);\r\n\t\r\n\t// Конец ЗарплатаКадрыПодсистемы.КадровыйУчет.ЭлектронныеТрудовыеКнижки\r\n\t\r\n\tЕсли ИсключаемыеТабличныеЧасти = \"\" Тогда\r\n\t\tИменаИсключаемыхТабличныхЧастей = Новый Массив;\r\n\tИначе\r\n\t\tИменаИсключаемыхТабличныхЧастей = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(ИсключаемыеТабличныеЧасти, , , Истина);\r\n\tКонецЕсли;\r\n\t\r\n\tДля каждого ТабличнаяЧастьДокумента Из МетаданныеДокумента.ТабличныеЧасти Цикл\r\n\t\tЕсли ИменаИсключаемыхТабличныхЧастей.Найти(ТабличнаяЧастьДокумента.Имя) <> Неопределено Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\tДля Каждого СтрокаДокумента Из Источник[ТабличнаяЧастьДокумента.Имя] Цикл\r\n\t\t\tНоваяСтрока = Приемник[ТабличнаяЧастьДокумента.Имя].Добавить();\r\n\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаДокумента);\r\n\t\tКонецЦикла;\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли ДанныеЗаполнения = Неопределено Тогда\r\n\t\tДанныеЗаполнения = Новый Структура;\r\n\t\tИсправлениеВТекущемПериоде = Ложь;\r\n\tИначе\r\n\t\tИсправлениеВТекущемПериоде = ДанныеЗаполнения.Свойство(\"ДопустимоИсправлениеВТекущемПериоде\")\r\n\t\t\tИ ДанныеЗаполнения.ДопустимоИсправлениеВТекущемПериоде\r\n\t\t\tИ ВозможноИсправлениеТекущимПериодом(Источник);\r\n\tКонецЕсли;\r\n\r\n\tЕсли Не ИсправлениеВТекущемПериоде Тогда\r\n\t\t// Период регистрации документа исправления необходимо увеличить.\r\n\t\tЕсли ДанныеЗаполнения.Свойство(\"ИмяПериодРегистрации\") Тогда\r\n\t\t\tИмяПериодРегистрации = ДанныеЗаполнения.ИмяПериодРегистрации;\r\n\t\t\tПериодРегистрацииИсправленногоДокумента = ДанныеЗаполнения.ПериодРегистрацииИсправленногоДокумента;\r\n\t\tИначе\r\n\t\t\tМетаданныеРеквизита = МетаданныеДокумента.Реквизиты.Найти(\"ПериодРегистрации\");\r\n\t\t\tЕсли МетаданныеРеквизита = Неопределено Тогда\r\n\t\t\t\tМетаданныеРеквизита = МетаданныеДокумента.Реквизиты.Найти(\"МесяцНачисления\");\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tЕсли МетаданныеРеквизита <> Неопределено Тогда\r\n\t\t\t\tИмяПериодРегистрации = МетаданныеРеквизита.Имя;\r\n\t\t\t\tПериодРегистрацииИсправленногоДокумента = ДанныеДокумента[ИмяПериодРегистрации];\r\n\t\t\tИначе\r\n\t\t\t\tИмяПериодРегистрации = Неопределено;\r\n\t\t\t\tПериодРегистрацииИсправленногоДокумента = Дата(1, 1, 1);\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ИмяПериодРегистрации <> Неопределено Тогда\r\n\t\t\tЗначения = Новый Структура(\"Месяц\");\r\n\t\t\tЗарплатаКадры.ПолучитьЗначенияПоУмолчанию(Значения);\r\n\t\t\t\r\n\t\t\tПриемник[ИмяПериодРегистрации] = Макс(ДобавитьМесяц(ПериодРегистрацииИсправленногоДокумента, 1), Значения.Месяц);\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Расшифровка формы собственности организации",
    "description": "Расшифровка формы собственности организации",
    "code_snippet": "&НаСервереБезКонтекста\r\nФункция ЗаполнениеНаименованияСРасшифровкой(Знач ЮридическоеНаименование)\r\n\t\r\n\t// Проверка;\r\n\tЕсли ЮридическоеНаименование = \"\" Тогда\r\n\t\tВозврат \"\";\r\n\tКонецЕсли;\r\n\t\r\n\tСтруктураРасшифровки = Новый Структура; // Ключ форма собственности  - Значение расшифровка формы соб;\r\n\tСтруктураРасшифровки.Вставить(\"ООО\", \"Общество с ограниченной ответственностью\");\r\n\tСтруктураРасшифровки.Вставить(\"ИП\", \"Индивидуальный предприниматель\");\r\n\tСтруктураРасшифровки.Вставить(\"ОАО\", \"Открытое акционерное общество\");\r\n\tСтруктураРасшифровки.Вставить(\"АО\", \"Акционерное общество\");\r\n\tСтруктураРасшифровки.Вставить(\"ЧУП\", \"Частное унитарное предприятие\");\r\n\t//СтруктураРасшифровки.Вставить(\"\", );\r\n\t\r\n\tМассивЧастей = СтрРазделить(ЮридическоеНаименование, \" \", );  \r\n\t\r\n\tРасшифровкаЮрЛица = \"\"; \r\n\tМассивАббревиатурЮрЛица = Новый Массив;\r\n\t\r\n\tДля каждого Часть Из МассивЧастей Цикл\r\n\t\tДля каждого КлючИЗначение Из СтруктураРасшифровки Цикл\r\n\t\t\tЕсли  Трег(Часть) = КлючИЗначение.Ключ ИЛИ НРег(Часть) = КлючИЗначение.Ключ ИЛИ ВРег(Часть) = КлючИЗначение.Ключ Тогда\r\n\t\t\t\tМассивАббревиатурЮрЛица.Добавить(Трег(Часть));\r\n\t\t\t\tМассивАббревиатурЮрЛица.Добавить(НРег(Часть));\r\n\t\t\t\tМассивАббревиатурЮрЛица.Добавить(ВРег(Часть));\r\n\t\t\t\tРасшифровкаЮрЛица = КлючИЗначение.Значение;\t\r\n\t\t\tКонецЕсли;\t\r\n\t\tКонецЦикла;\r\n\tКонецЦикла;\t\r\n\t\r\n\t// чистим;\r\n\tДля каждого Аббревиатура Из МассивАббревиатурЮрЛица Цикл\r\n\t\tЮридическоеНаименование = СтрЗаменить(ЮридическоеНаименование, Аббревиатура, \"\");\r\n\tКонецЦикла;\r\n\tЮридическоеНаименование = СокрЛП(ЮридическоеНаименование);\r\n\tЮридическоеНаименование = Трег(ЮридическоеНаименование);\r\n\t\r\n\tПолноеНаименование\t= РасшифровкаЮрЛица + \" \"\"\" + ЮридическоеНаименование + \"\"\"\" ; \r\n\t\r\n\tВозврат ПолноеНаименование;\r\n\t\r\nКонецФункции // ()\n\n&НаСервереБезКонтекста\r\nФункция ЗаполнениеНаименованияСРасшифровкой(Знач ЮридическоеНаименование)\r\n\t\r\n\t// Проверка;\r\n\tЕсли ЮридическоеНаименование = \"\" Тогда\r\n\t\tВозврат \"\";\r\n\tКонецЕсли;\r\n\t\r\n\tСтруктураРасшифровки = Новый Структура; // Ключ форма собственности  - Значение расшифровка формы соб;\r\n\tСтруктураРасшифровки.Вставить(\"ООО\", \"Общество с ограниченной ответственностью\");\r\n\tСтруктураРасшифровки.Вставить(\"ИП\", \"Индивидуальный предприниматель\");\r\n\tСтруктураРасшифровки.Вставить(\"ОАО\", \"Открытое акционерное общество\");\r\n\tСтруктураРасшифровки.Вставить(\"АО\", \"Акционерное общество\");\r\n\tСтруктураРасшифровки.Вставить(\"ЧУП\", \"Частное унитарное предприятие\");\r\n\t//СтруктураРасшифровки.Вставить(\"\", );\r\n\t\r\n\tМассивЧастей = СтрРазделить(ЮридическоеНаименование, \" \", );  \r\n\t\r\n\tРасшифровкаЮрЛица = \"\"; \r\n\tМассивАббревиатурЮрЛица = Новый Массив;\r\n\t\r\n\tДля каждого Часть Из МассивЧастей Цикл\r\n\t\tДля каждого КлючИЗначение Из СтруктураРасшифровки Цикл\r\n\t\t\tЕсли  Трег(Часть) = КлючИЗначение.Ключ ИЛИ НРег(Часть) = КлючИЗначение.Ключ ИЛИ ВРег(Часть) = КлючИЗначение.Ключ Тогда\r\n\t\t\t\tМассивАббревиатурЮрЛица.Добавить(Трег(Часть));\r\n\t\t\t\tМассивАббревиатурЮрЛица.Добавить(НРег(Часть));\r\n\t\t\t\tМассивАббревиатурЮрЛица.Добавить(ВРег(Часть));\r\n\t\t\t\tРасшифровкаЮрЛица = КлючИЗначение.Значение;\t\r\n\t\t\tКонецЕсли;\t\r\n\t\tКонецЦикла;\r\n\tКонецЦикла;\t\r\n\t\r\n\t// чистим;\r\n\tДля каждого Аббревиатура Из МассивАббревиатурЮрЛица Цикл\r\n\t\tЮридическоеНаименование = СтрЗаменить(ЮридическоеНаименование, Аббревиатура, \"\");\r\n\tКонецЦикла;\r\n\tЮридическоеНаименование = СокрЛП(ЮридическоеНаименование);\r\n\tЮридическоеНаименование = Трег(ЮридическоеНаименование);\r\n\t\r\n\tПолноеНаименование\t= РасшифровкаЮрЛица + \" \"\"\" + ЮридическоеНаименование + \"\"\"\" ; \r\n\t\r\n\tВозврат ПолноеНаименование;\r\n\t\r\nКонецФункции // ()"
  },
  {
    "title": "Использование биометрии в мобильной платформе 1С",
    "description": "Использование биометрии в мобильной платформе 1С",
    "code_snippet": "&НаКлиенте\r\nФункция Биометрия()\r\n\t#Если МобильноеПриложениеКлиент Тогда\r\n\t\tЕсли ТелефонПоддерживаетБиометрическийВход() Тогда\r\n\t\t\tПоказатьВопрос(Новый ОписаниеОповещения(\"ТелефонПоддерживаетБиометрическийВходЗавершение\", ЭтотОбъект), \"Использовать биометрию для входа\", РежимДиалогаВопрос.ДаНет);\r\n\t\tКонецЕсли;\r\n\t#КонецЕсли\r\nКонецФункции\r\n\r\n&НаКлиенте\r\nПроцедура ТелефонПоддерживаетБиометрическийВходЗавершение(РезультатВопроса, ДополнительныеПараметры) Экспорт\r\n\tЕсли РезультатВопроса = КодВозвратаДиалога.Да Тогда\r\n\t\tПровестиБиометрическийВход();\r\n\tКонецЕсли;  \r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ПровестиБиометрическийВход()\r\n\t#Если МобильноеПриложениеКлиент Тогда\r\n\t\tПопытка\r\n\t\t\tСпособПроверки = СпособДополнительнойПроверкиПользователя.ТолькоБиометрическая;\r\n\t\t\t\r\n\t\t\tЕсли ДополнительнаяПроверкаПользователя.ПоддерживаетсяПроверка(СпособПроверки) Тогда\r\n\t\t\t\tДопПараметры = Новый Структура;\r\n\t\t\t\tОписаниеОповещения = Новый ОписаниеОповещения(\"ПровестиБиометрическийВходЗавершение\", ЭтотОбъект, ДопПараметры); \r\n\t\t\t\tДополнительнаяПроверкаПользователя.НачатьПроверку(СпособПроверки, \"Введите код\", ОписаниеОповещения);\r\n\t\t\tКонецЕсли;\r\n\t\tИсключение\r\n\t\t\tЗаписьЖурналаРегистрации(\"Mobile\", УровеньЖурналаРегистрации.Ошибка,,, ОписаниеОшибки());\r\n\t\tКонецПопытки;\r\n\t#КонецЕсли\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ПровестиБиометрическийВходЗавершение(ОтмененоПользователем, ДополнительныеПараметры) Экспорт\r\n\tПопытка\r\n\t\tЕсли НЕ ОтмененоПользователем Тогда\r\n\t\t\tЕсли ИспользоватьБиометрию = Ложь Тогда\r\n\t\t\t\tУстановитьИспользоватьБиометрию(Истина);\r\n\t\t\tИначе                      \r\n\t\t\t\tАвторизацияВыполнена = Истина;\r\n\t\t\t\tСтруктура = Новый Структура(\"ВходВыполнен\", АвторизацияВыполнена);    \r\n\t\t\t\tОбщегоНазначенияКлиент.ЗвукУспешногоВвода();\r\n\t\t\t\tЭтаФорма.Закрыть(Структура);  \r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;  \r\n\tИсключение                                                                                       \r\n\t\tЗаписьЖурналаРегистрации(\"Mobile\", УровеньЖурналаРегистрации.Ошибка,,, ОписаниеОшибки());\r\n\tКонецПопытки;\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nФункция ТелефонПоддерживаетБиометрическийВход()\r\n\t#Если МобильноеПриложениеКлиент Тогда\r\n\t\tПопытка   \r\n\t\t\tЕсли ДополнительнаяПроверкаПользователя.ПоддерживаетсяПроверка(СпособДополнительнойПроверкиПользователя.БиометрическаяИлиВводПароля) Тогда\r\n\t\t\t\tВозврат Истина;\r\n\t\t\tИначе\r\n\t\t\t\tВозврат Ложь;\r\n\t\t\tКонецЕсли;\r\n\t\tИсключение\r\n\t\t\tЗаписьЖурналаРегистрации(\"Mobile\", УровеньЖурналаРегистрации.Ошибка,,, ОписаниеОшибки());\r\n\t\t\tВозврат Ложь;\r\n\t\tКонецПопытки;\r\n\t#КонецЕсли\r\nКонецФункции\n\n&НаКлиенте\r\nФункция Биометрия()\r\n\t#Если МобильноеПриложениеКлиент Тогда\r\n\t\tЕсли ТелефонПоддерживаетБиометрическийВход() Тогда\r\n\t\t\tПоказатьВопрос(Новый ОписаниеОповещения(\"ТелефонПоддерживаетБиометрическийВходЗавершение\", ЭтотОбъект), \"Использовать биометрию для входа\", РежимДиалогаВопрос.ДаНет);\r\n\t\tКонецЕсли;\r\n\t#КонецЕсли\r\nКонецФункции\r\n\r\n&НаКлиенте\r\nПроцедура ТелефонПоддерживаетБиометрическийВходЗавершение(РезультатВопроса, ДополнительныеПараметры) Экспорт\r\n\tЕсли РезультатВопроса = КодВозвратаДиалога.Да Тогда\r\n\t\tПровестиБиометрическийВход();\r\n\tКонецЕсли;  \r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ПровестиБиометрическийВход()\r\n\t#Если МобильноеПриложениеКлиент Тогда\r\n\t\tПопытка\r\n\t\t\tСпособПроверки = СпособДополнительнойПроверкиПользователя.ТолькоБиометрическая;\r\n\t\t\t\r\n\t\t\tЕсли ДополнительнаяПроверкаПользователя.ПоддерживаетсяПроверка(СпособПроверки) Тогда\r\n\t\t\t\tДопПараметры = Новый Структура;\r\n\t\t\t\tОписаниеОповещения = Новый ОписаниеОповещения(\"ПровестиБиометрическийВходЗавершение\", ЭтотОбъект, ДопПараметры); \r\n\t\t\t\tДополнительнаяПроверкаПользователя.НачатьПроверку(СпособПроверки, \"Введите код\", ОписаниеОповещения);\r\n\t\t\tКонецЕсли;\r\n\t\tИсключение\r\n\t\t\tЗаписьЖурналаРегистрации(\"Mobile\", УровеньЖурналаРегистрации.Ошибка,,, ОписаниеОшибки());\r\n\t\tКонецПопытки;\r\n\t#КонецЕсли\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ПровестиБиометрическийВходЗавершение(ОтмененоПользователем, ДополнительныеПараметры) Экспорт\r\n\tПопытка\r\n\t\tЕсли НЕ ОтмененоПользователем Тогда\r\n\t\t\tЕсли ИспользоватьБиометрию = Ложь Тогда\r\n\t\t\t\tУстановитьИспользоватьБиометрию(Истина);\r\n\t\t\tИначе                      \r\n\t\t\t\tАвторизацияВыполнена = Истина;\r\n\t\t\t\tСтруктура = Новый Структура(\"ВходВыполнен\", АвторизацияВыполнена);    \r\n\t\t\t\tОбщегоНазначенияКлиент.ЗвукУспешногоВвода();\r\n\t\t\t\tЭтаФорма.Закрыть(Структура);  \r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;  \r\n\tИсключение                                                                                       \r\n\t\tЗаписьЖурналаРегистрации(\"Mobile\", УровеньЖурналаРегистрации.Ошибка,,, ОписаниеОшибки());\r\n\tКонецПопытки;\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nФункция ТелефонПоддерживаетБиометрическийВход()\r\n\t#Если МобильноеПриложениеКлиент Тогда\r\n\t\tПопытка   \r\n\t\t\tЕсли ДополнительнаяПроверкаПользователя.ПоддерживаетсяПроверка(СпособДополнительнойПроверкиПользователя.БиометрическаяИлиВводПароля) Тогда\r\n\t\t\t\tВозврат Истина;\r\n\t\t\tИначе\r\n\t\t\t\tВозврат Ложь;\r\n\t\t\tКонецЕсли;\r\n\t\tИсключение\r\n\t\t\tЗаписьЖурналаРегистрации(\"Mobile\", УровеньЖурналаРегистрации.Ошибка,,, ОписаниеОшибки());\r\n\t\t\tВозврат Ложь;\r\n\t\tКонецПопытки;\r\n\t#КонецЕсли\r\nКонецФункции\n\n{2} Не все части функции возвращают значение"
  },
  {
    "title": "Выгрузка файла на FTP",
    "description": "Выгрузка файла на FTP",
    "code_snippet": "// Параметры соединения; \r\n\tСервер = \"00.000.000.000\";\r\n\t\r\n\tПорт\t= 21;\r\n\t\r\n\tИмяПользователя \t= \"u00000\";\r\n\t\r\n\tПарольПользователя = \"86731db349\"; \r\n\t\r\n\t// Загрузка на  FTP;\r\n\tFTP_Cоединение = Новый FTPСоединение(Сервер, Порт, ИмяПользователя, ПарольПользователя,,, 20);\r\n\t\r\n\tПопытка\r\n\t\tFTP_Cоединение.УстановитьТекущийКаталог(\".\");          \r\n\t\tFTP_Cоединение.Записать(ПутьКФайлу, \"actual_products.json\"); // представим что отсюда сайт подгружает данные;\r\n\t\t\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \".JSON файл, находящийся в каталоге: \" + ПутьКФайлу + \" был успешно загружен на FTP_сервер!\";\r\n\t\tСообщение.Сообщить();\r\n\tИсключение\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \"Не удалось подключиться к FTP_серверу! Описание ошибки: \" + ОписаниеОшибки();\r\n\t\tСообщение.Сообщить();\r\n\tКонецПопытки;\n\n// Параметры соединения; \r\n\tСервер = \"00.000.000.000\";\r\n\t\r\n\tПорт\t= 21;\r\n\t\r\n\tИмяПользователя \t= \"u00000\";\r\n\t\r\n\tПарольПользователя = \"86731db349\"; \r\n\t\r\n\t// Загрузка на  FTP;\r\n\tFTP_Cоединение = Новый FTPСоединение(Сервер, Порт, ИмяПользователя, ПарольПользователя,,, 20);\r\n\t\r\n\tПопытка\r\n\t\tFTP_Cоединение.УстановитьТекущийКаталог(\".\");          \r\n\t\tFTP_Cоединение.Записать(ПутьКФайлу, \"actual_products.json\"); // представим что отсюда сайт подгружает данные;\r\n\t\t\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \".JSON файл, находящийся в каталоге: \" + ПутьКФайлу + \" был успешно загружен на FTP_сервер!\";\r\n\t\tСообщение.Сообщить();\r\n\tИсключение\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \"Не удалось подключиться к FTP_серверу! Описание ошибки: \" + ОписаниеОшибки();\r\n\t\tСообщение.Сообщить();\r\n\tКонецПопытки;\n\nОрфографическая ошибка в FTP_Cоединение (найдено 5): Cоединение"
  },
  {
    "title": "Удалить префикс, лидирующие нули",
    "description": "Удалить префикс, лидирующие нули",
    "code_snippet": "&НаКлиенте\r\nФункция ФорматироватьНомерДокуметаНаКлиенте(Знач НомерДокумента)\r\n\t\r\n\tНомерДокументаСтрокой \t= Строка(НомерДокумента);\r\n\t\r\n\tНомерДокументаСтрокой\t= СтрЗаменить(НомерДокументаСтрокой, \"-\", \"\");\r\n\t\r\n\tПозицияПервогоНуля\t\t= СтрНайти(НомерДокументаСтрокой, \"0\", НаправлениеПоиска.СНачала);\r\n\t\r\n\tНомерДокументаСтрокой \t= Сред(НомерДокументаСтрокой, ПозицияПервогоНуля, СтрДлина(НомерДокументаСтрокой)); //символы = цифры;\r\n\t\r\n\tСчетчик = 1;\r\n\tПока Лев(НомерДокументаСтрокой, 1) = \"0\" Цикл\r\n\t\tНомерДокументаСтрокой = Сред(НомерДокументаСтрокой, Счетчик + 1);\r\n\tКонецЦикла;\r\n\r\n\tВозврат НомерДокументаСтрокой;\r\n\t\r\nКонецФункции // ()\n\n&НаКлиенте\r\nФункция ФорматироватьНомерДокуметаНаКлиенте(Знач НомерДокумента)\r\n\t\r\n\tНомерДокументаСтрокой \t= Строка(НомерДокумента);\r\n\t\r\n\tНомерДокументаСтрокой\t= СтрЗаменить(НомерДокументаСтрокой, \"-\", \"\");\r\n\t\r\n\tПозицияПервогоНуля\t\t= СтрНайти(НомерДокументаСтрокой, \"0\", НаправлениеПоиска.СНачала);\r\n\t\r\n\tНомерДокументаСтрокой \t= Сред(НомерДокументаСтрокой, ПозицияПервогоНуля, СтрДлина(НомерДокументаСтрокой)); //символы = цифры;\r\n\t\r\n\tСчетчик = 1;\r\n\tПока Лев(НомерДокументаСтрокой, 1) = \"0\" Цикл\r\n\t\tНомерДокументаСтрокой = Сред(НомерДокументаСтрокой, Счетчик + 1);\r\n\tКонецЦикла;\r\n\r\n\tВозврат НомерДокументаСтрокой;\r\n\t\r\nКонецФункции // ()\n\nОрфографическая ошибка в ФорматироватьНомерДокуметаНаКлиенте: Докумета"
  },
  {
    "title": "При запуске конфигурации, с подключенным расширением, возникает ошибка \"Недопустимое состояние объекта\"",
    "description": "При запуске конфигурации, с подключенным расширением, возникает ошибка \"Недопустимое состояние объекта\"Все",
    "code_snippet": "Недопустимое состояние объекта\n[backbas - src\\backbas\\src\\ModuleWithPragmasHelper.cpp (1687)]\n\n&После(\"ПередЗавершениемРаботыСистемы\")\nПроцедура Расш1_ПередЗавершениемРаботыСистемы(Отказ, ТекстПредупреждения) КонецПроцедуры\n\n&После(\"ПередЗавершениемРаботыСистемы\")\nПроцедура Расш1_ПередЗавершениемРаботыСистемы(Отказ, ТекстПредупреждения)\nКонецПроцедуры"
  },
  {
    "title": "Является ли значение табличной частью",
    "description": "Является ли значение табличной частью",
    "code_snippet": "// Проверяет, что переданное значение имеет тип \"Табличная часть\", а не какой-либо другой.\r\nФункция ЭтоТабличнаяЧасть(Знач ТЧ) Экспорт\r\n\r\n\tЭтоТЧ = Ложь;\r\n\t\r\n\tТипЗначенияСтрокой = Строка(ТипЗнч(ТЧ)); // \"Справочник табличная часть: ...\", \"Внешняя обработка табличная часть: ...\",\r\n\t                                         // \"Catalog Tabular section: ...\", \"External data processor Tabular section: ...\" и т.д.\r\n\tФрагменты = СтрРазделить(ТипЗначенияСтрокой, \":\", Ложь);\r\n\tЕсли Фрагменты.Количество() > 1 Тогда\r\n\t\tПациент = Фрагменты[0]; // Анализируем только первый фрагмент (до первого двоеточия).\r\n\t\t                        // В синониме какого-либо объекта метаданных тоже может встретиться маркер \"... табличная часть:\",\r\n\t\t\t\t\t\t\t\t// но это всегда будет уже следующий фрагмент (и он нас не интересует).\r\n\t\tПациент = НРег(Пациент); // Фирма 1С не выдерживает единый стиль для русскоязычного и англоязычного вариантов встроенного языка,\r\n\t\t                         // поэтому на всякий случай приводим всё к какому-то одному регистру букв.\r\n\t\tЕсли СтрЗаканчиваетсяНа(Пациент, НРег(\" табличная часть\")) ИЛИ СтрЗаканчиваетсяНа(Пациент, НРег(\" Tabular section\")) Тогда\r\n\t\t\tЭтоТЧ = Истина;\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ЭтоТЧ;\r\n\r\nКонецФункции\n\n// Проверяет, что переданное значение имеет тип \"Табличная часть\", а не какой-либо другой.\r\nФункция ЭтоТабличнаяЧасть(Знач ТЧ) Экспорт\r\n\r\n\tЭтоТЧ = Ложь;\r\n\t\r\n\tТипЗначенияСтрокой = Строка(ТипЗнч(ТЧ)); // \"Справочник табличная часть: ...\", \"Внешняя обработка табличная часть: ...\",\r\n\t                                         // \"Catalog Tabular section: ...\", \"External data processor Tabular section: ...\" и т.д.\r\n\tФрагменты = СтрРазделить(ТипЗначенияСтрокой, \":\", Ложь);\r\n\tЕсли Фрагменты.Количество() > 1 Тогда\r\n\t\tПациент = Фрагменты[0]; // Анализируем только первый фрагмент (до первого двоеточия).\r\n\t\t                        // В синониме какого-либо объекта метаданных тоже может встретиться маркер \"... табличная часть:\",\r\n\t\t\t\t\t\t\t\t// но это всегда будет уже следующий фрагмент (и он нас не интересует).\r\n\t\tПациент = НРег(Пациент); // Фирма 1С не выдерживает единый стиль для русскоязычного и англоязычного вариантов встроенного языка,\r\n\t\t                         // поэтому на всякий случай приводим всё к какому-то одному регистру букв.\r\n\t\tЕсли СтрЗаканчиваетсяНа(Пациент, НРег(\" табличная часть\")) ИЛИ СтрЗаканчиваетсяНа(Пациент, НРег(\" Tabular section\")) Тогда\r\n\t\t\tЭтоТЧ = Истина;\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ЭтоТЧ;\r\n\r\nКонецФункции"
  },
  {
    "title": "Шаблон кода Внешней обработки Заполнение Объекта",
    "description": "Шаблон кода Внешней обработки Заполнение Объекта",
    "code_snippet": "&НаСервере\nПроцедура ВыполнитьКоманду(ИдентификаторКоманды, ОбъектыНазначенияМассив) Экспорт\n\t//: ОбъектыНазначенияМассив = Новый Массив;\n\n\tЕсли ИдентификаторКоманды = \"Заполнить...\" Тогда\n\t\tЗаполнение...(ОбъектыНазначенияМассив)\n\t\t\n\tИначеЕсли ИдентификаторКоманды = \"Заполнить....\" Тогда\n\t\tЗаполнить....(ОбъектыНазначенияМассив)\n\t\t\n\tИначе\n\t\tВозврат\n\t\t\n\tКонецЕсли;\n\t\nКонецПроцедуры\n\n\n#Область БСП\n\nФункция ВерсияОбработки(Строкой = Ложь)\n\t\n\tВерсияОбработки = \"1.01.001\";\n\t\n\tЕсли НЕ Строкой Тогда\n\t\t\n\t\tИнформацияОВерсии = \"v.\" + ВерсияОбработки + \":\" + Символы.ПС\n\t\t\t\t\t\t\t+ \"\";\n\t\t\n\t\tЗаголовокВерсияОбработки = ?(ПустаяСтрока(ВерсияОбработки), \"\", \"[v.\" + ВерсияОбработки + \"]\");\n\t\t\n\t\tРезультат = Новый Структура;\n\t\tРезультат.Вставить(\"Версия\",\t\tВерсияОбработки);\n\t\tРезультат.Вставить(\"Заголовок\",\t\tЗаголовокВерсияОбработки);\n\t\tРезультат.Вставить(\"Информация\",\tИнформацияОВерсии);\n\t\t\n\t\tВозврат Результат;\n\t\t\n\tКонецЕсли;\n\t\n\tВозврат ВерсияОбработки;\n\t\nКонецФункции\n\nФункция ВерсияБСП(Строкой = Истина)\n\t\n\tВерсияБСП = \"2.3.6.121\";\n\t\n\tЕсли НЕ Строкой Тогда\n\t\t\n\t\tРезультат = Новый Структура;\n\t\tРезультат.Вставить(\"Версия\",\tВерсияБСП);\n\t\t\n\t\t//Процедура ПриДобавленииПодсистемы(Описание)\n\t\t//\tОписание.Имя    = \"СтандартныеПодсистемы\";\n\t\t//\tОписание.Версия = \"2.3.6.121\";\n\t\t//\tОписание.РежимВыполненияОтложенныхОбработчиков = \"Параллельно\";\n\t\t//\tОписание.ПараллельноеОтложенноеОбновлениеСВерсии = \"2.3.3.0\";\n\t\t\n\t\tВозврат Результат;\n\t\t\n\tКонецЕсли;\n\t\n\tВозврат ВерсияБСП;\n\t\nКонецФункции\n\nФункция СведенияОВнешнейОбработке() Экспорт\n\t\n\tПараметрыРегистрации = Новый Структура;\n\tПараметрыРегистрации.Вставить(\"Вид\", \"ЗаполнениеОбъекта\"); //может быть – ПечатнаяФорма, ЗаполнениеОбъекта, ДополнительныйОтчет, СозданиеСвязанныхОбъектов…\n\t\n\tВерсияОбработки = ВерсияОбработки();\n\tЗаголовокВерсияОбработки = ?(ПустаяСтрока(ВерсияОбработки.Версия), \"\", \" \" + ВерсияОбработки.Заголовок);\n\t\n\tПараметрыРегистрации.Вставить(\"Наименование\", \"Заполнение ...\"); //здесь будет имя под которым обработка будет зарегестрирована в справочнике внешних обработок\n\tПараметрыРегистрации.Вставить(\"Информация\", \"Обработка заполнения объекта - Поступление товаров и услуг ...\"); //здесь пишем описание\n\tПараметрыРегистрации.Вставить(\"Версия\", ВерсияОбработки.Версия);\n\tПараметрыРегистрации.Вставить(\"ВерсияБСП\", ВерсияБСП());\n\tПараметрыРегистрации.Вставить(\"БезопасныйРежим\", Ложь);\n\t\n\t// Назначения\n\tМассивНазначений = Новый Массив;\n\tМассивНазначений.Добавить(\"Документ.ПоступлениеТоваровУслуг\"); //здесь мы добавляем в наш массив документ или несколько документов (если несколько - такой же строкой кода добавляем еще вид) к которому делаем обработку (ПФ, Заполнение...)\n\t\n\tПараметрыРегистрации.Вставить(\"Назначение\", МассивНазначений); //Добавляем наш массив со списком документов\n\t\n\t// Команды\n\tТаблицаКоманд = ПолучитьТаблицуКоманд();\n\t\n\tДобавитьКоманду(ТаблицаКоманд, \"Заполнить ...\", \"Заполнить...\", \"ВызовКлиентскогоМетода\");\n\t//ДобавитьКоманду(ТаблицаКоманд, \"Заполнить ...\", \"Заполнить...\", \"ВызовСерверногоМетода\");\n\t\n\t//\n\tПараметрыРегистрации.Вставить(\"Команды\", ТаблицаКоманд);\n\t\n\tВозврат ПараметрыРегистрации;\n\t\nКонецФункции\n\nФункция ПолучитьТаблицуКоманд()\n\t\n\tКоманды = Новый ТаблицаЗначений;\n\tКоманды.Колонки.Добавить(\"Представление\", Новый ОписаниеТипов(\"Строка\")); //как будет выглядеть описание ВПФ для пользователя\n\tКоманды.Колонки.Добавить(\"Идентификатор\", Новый ОписаниеТипов(\"Строка\")); //имя макета ВПФ\n\tКоманды.Колонки.Добавить(\"Использование\", Новый ОписаниеТипов(\"Строка\")); //ВызовСерверногоМетода или Клиентского метода\n\tКоманды.Колонки.Добавить(\"ПоказыватьОповещение\", Новый ОписаниеТипов(\"Булево\"));\n\tКоманды.Колонки.Добавить(\"Модификатор\", Новый ОписаниеТипов(\"Строка\"));\n\tКоманды.Колонки.Добавить(\"ПроверкаПроведенияПередПечатью\", Новый ОписаниеТипов(\"Булево\"));\n\tВозврат Команды;\n\t\nКонецФункции\n\nПроцедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование, ПоказыватьОповещение = Ложь, Модификатор = \"\")\n\t\n\tНоваяКоманда = ТаблицаКоманд.Добавить();\n\tНоваяКоманда.Представление = Представление; \n\tНоваяКоманда.Идентификатор = Идентификатор;\n\tНоваяКоманда.Использование = Использование;\n\tНоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;\n\tНоваяКоманда.Модификатор = Модификатор;\n\tНоваяКоманда.ПроверкаПроведенияПередПечатью = Ложь;\n\t\nКонецПроцедуры \n\n#КонецОбласти"
  },
  {
    "title": "ПоискПохожейСтроки (8.3 без режима совместимости с 8.2)",
    "description": "ПоискПохожейСтроки (8.3 без режима совместимости с 8.2)",
    "code_snippet": "// Функция - Поиск похожей строки из набора строк\r\n//\r\n// Параметры:\r\n//  ИсходнаяСтрока\t\t - Строка\t - Исходная строка\r\n//  ОбъектыДляПроверки\t - Массив\t - Массив элементов произвольного типа, в котором будем искать похожую строку\r\n//  пНаправлениеПоиска\t - НаправлениеПоиска\t -  Указывает направление поиска подстроки в строке\r\n//  ЖелательныйПроцентСовпадения\t - Число\t -  Ожидаемый процент совпадения подстроки поиска в проверяемой строке. По умолчанию 50\r\n// \r\n// Возвращаемое значение:\r\n// Строка  - строка с максимальным вхождением подстроки поиска\r\n//\r\nФункция ПоискПохожейСтроки(ИсходнаяСтрока, ОбъектыДляПроверки, пНаправлениеПоиска, ЖелательныйПроцентСовпадения)\r\n\t\r\n\tПохожаяСтрока = \"\";\r\n\t\r\n\tТаблицаСтатистики = Новый ТаблицаЗначений;\r\n\tТаблицаСтатистики.Колонки.Добавить(\"Объект\");\r\n\tТаблицаСтатистики.Колонки.Добавить(\"ЧислоВхождений\");\r\n\t\r\n\tДлинаИсходнойСтроки = СтрДлина(ИсходнаяСтрока);\r\n\t\t\r\n\tДля каждого Элемент Из ОбъектыДляПроверки Цикл\r\n\t\t\r\n\t\tТекОбъект = ВРЕГ(Элемент);\r\n\t\tДлинаТекОбъекта = СтрДлина(ТекОбъект);\r\n\t\t\r\n\t\tДля Сч = 0 По ДлинаИсходнойСтроки Цикл\r\n\t\t\t\r\n\t\t\tЕсли пНаправлениеПоиска = НаправлениеПоиска.СНачала Тогда\r\n\t\t\t\tИскомаяСтрока = Сред(ИсходнаяСтрока, 1, Сч + 1);\r\n\t\t\t\tНачПозицияПоиска = 1;\r\n\t\t\tИначе\t\r\n\t\t\t\tИскомаяСтрока = Сред(ИсходнаяСтрока, ДлинаИсходнойСтроки - Сч, Сч + 1);\r\n\t\t\t\tНачПозицияПоиска = ДлинаТекОбъекта;\r\n\t\t\tКонецЕсли; \r\n\t\t\t\t\t\t\r\n\t\t\tЕсли СтрНайти(ТекОбъект, ИскомаяСтрока, пНаправлениеПоиска, НачПозицияПоиска) > 0 Тогда\r\n\t\t\t\t\r\n\t\t\t\tСтрСтатистика = ТаблицаСтатистики.Найти(ТекОбъект, \"Объект\");\t\t\r\n\t\t\t\t\r\n\t\t\t\tЕсли СтрСтатистика <> Неопределено Тогда\r\n\t\t\t\t\tСтрСтатистика.ЧислоВхождений = СтрДлина(ИскомаяСтрока);\r\n\t\t\t\tИначе\r\n\t\t\t\t\tЕсли Цел(СтрДлина(ИскомаяСтрока) / ДлинаТекОбъекта * 100) > ЖелательныйПроцентСовпадения Тогда\r\n\t\t\t\t\t\tСтрСтатистика = ТаблицаСтатистики.Добавить();\r\n\t\t\t\t\t\tСтрСтатистика.Объект = ТекОбъект;\r\n\t\t\t\t\t\tСтрСтатистика.ЧислоВхождений = СтрДлина(ИскомаяСтрока);\t\t\t\t\t\t\r\n\t\t\t\t\tКонецЕсли; \r\n\t\t\t\tКонецЕсли; \r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\t\t\r\n\tКонецЦикла; \r\n\t\r\n\tЕсли ЗначениеЗаполнено(ТаблицаСтатистики) Тогда\r\n\t\tТаблицаСтатистики.Сортировать(\"ЧислоВхождений УБЫВ\");\r\n\t\tПохожаяСтрока = ТаблицаСтатистики.Получить(0).Объект;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ПохожаяСтрока\r\n\t\r\nКонецФункции\n\n// Функция - Поиск похожей строки из набора строк\r\n//\r\n// Параметры:\r\n//  ИсходнаяСтрока\t\t - Строка\t - Исходная строка\r\n//  ОбъектыДляПроверки\t - Массив\t - Массив элементов произвольного типа, в котором будем искать похожую строку\r\n//  пНаправлениеПоиска\t - НаправлениеПоиска\t -  Указывает направление поиска подстроки в строке\r\n//  ЖелательныйПроцентСовпадения\t - Число\t -  Ожидаемый процент совпадения подстроки поиска в проверяемой строке. По умолчанию 50\r\n// \r\n// Возвращаемое значение:\r\n// Строка  - строка с максимальным вхождением подстроки поиска\r\n//\r\nФункция ПоискПохожейСтроки(ИсходнаяСтрока, ОбъектыДляПроверки, пНаправлениеПоиска, ЖелательныйПроцентСовпадения)\r\n\t\r\n\tПохожаяСтрока = \"\";\r\n\t\r\n\tТаблицаСтатистики = Новый ТаблицаЗначений;\r\n\tТаблицаСтатистики.Колонки.Добавить(\"Объект\");\r\n\tТаблицаСтатистики.Колонки.Добавить(\"ЧислоВхождений\");\r\n\t\r\n\tДлинаИсходнойСтроки = СтрДлина(ИсходнаяСтрока);\r\n\t\t\r\n\tДля каждого Элемент Из ОбъектыДляПроверки Цикл\r\n\t\t\r\n\t\tТекОбъект = ВРЕГ(Элемент);\r\n\t\tДлинаТекОбъекта = СтрДлина(ТекОбъект);\r\n\t\t\r\n\t\tДля Сч = 0 По ДлинаИсходнойСтроки Цикл\r\n\t\t\t\r\n\t\t\tЕсли пНаправлениеПоиска = НаправлениеПоиска.СНачала Тогда\r\n\t\t\t\tИскомаяСтрока = Сред(ИсходнаяСтрока, 1, Сч + 1);\r\n\t\t\t\tНачПозицияПоиска = 1;\r\n\t\t\tИначе\t\r\n\t\t\t\tИскомаяСтрока = Сред(ИсходнаяСтрока, ДлинаИсходнойСтроки - Сч, Сч + 1);\r\n\t\t\t\tНачПозицияПоиска = ДлинаТекОбъекта;\r\n\t\t\tКонецЕсли; \r\n\t\t\t\t\t\t\r\n\t\t\tЕсли СтрНайти(ТекОбъект, ИскомаяСтрока, пНаправлениеПоиска, НачПозицияПоиска) > 0 Тогда\r\n\t\t\t\t\r\n\t\t\t\tСтрСтатистика = ТаблицаСтатистики.Найти(ТекОбъект, \"Объект\");\t\t\r\n\t\t\t\t\r\n\t\t\t\tЕсли СтрСтатистика <> Неопределено Тогда\r\n\t\t\t\t\tСтрСтатистика.ЧислоВхождений = СтрДлина(ИскомаяСтрока);\r\n\t\t\t\tИначе\r\n\t\t\t\t\tЕсли Цел(СтрДлина(ИскомаяСтрока) / ДлинаТекОбъекта * 100) > ЖелательныйПроцентСовпадения Тогда\r\n\t\t\t\t\t\tСтрСтатистика = ТаблицаСтатистики.Добавить();\r\n\t\t\t\t\t\tСтрСтатистика.Объект = ТекОбъект;\r\n\t\t\t\t\t\tСтрСтатистика.ЧислоВхождений = СтрДлина(ИскомаяСтрока);\t\t\t\t\t\t\r\n\t\t\t\t\tКонецЕсли; \r\n\t\t\t\tКонецЕсли; \r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\t\t\r\n\tКонецЦикла; \r\n\t\r\n\tЕсли ЗначениеЗаполнено(ТаблицаСтатистики) Тогда\r\n\t\tТаблицаСтатистики.Сортировать(\"ЧислоВхождений УБЫВ\");\r\n\t\tПохожаяСтрока = ТаблицаСтатистики.Получить(0).Объект;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ПохожаяСтрока\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Параметр данных при компоновке результата в модуле отчета",
    "description": "Параметр данных при компоновке результата в модуле отчета",
    "code_snippet": "ПараметрДанных\t\t\t\t\t= КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти(\"Склад\");\r\nПараметрДанных.Значение \t\t= Справочники.Склады.НайтиПоНаименованию(\"Основной\");\r\nПараметрДанных.Использование \t= Истина;\n\nПараметрДанных\t\t\t\t\t= КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти(\"Склад\");\r\nПараметрДанных.Значение \t\t= Справочники.Склады.НайтиПоНаименованию(\"Основной\");\r\nПараметрДанных.Использование \t= Истина;"
  },
  {
    "title": "Пересечение cписков",
    "description": "Пересечение cписков",
    "code_snippet": "Функция ПересечениеСписков(м1,м2)\r\n\tТз = Новый ТаблицаЗначений();\r\n\tДля каждого Эл из М1 Цикл\r\n\t\tТЗ.Добавить().Элемент=Эл.Значение;\r\n\tКонецЦикла;\r\n\tДля каждого Эл из М2 Цикл\r\n\t\tТЗ.Добавить().Элемент=Эл.Значение;\r\n\tКонецЦикла;\r\n\t\r\n\tТЗ.Колонки.Добавить(\"Флаг\");\r\n\tТЗ.ЗаполнитьЗначения(1,\"Флаг\");\r\n\tТЗ.Свернуть(\"Элемент\",\"Флаг\");\r\n\t\r\n\tСовпадающие = Новый СписокЗначений;\r\n\tДля каждого Строка из ТЗ.НайтиСтроки(Новый Структура(\"Флаг\",2)) Цикл\r\n\t\tСовпадающие.Добавить(Строка.Элемент);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Совпадающие\r\nКонецФункции\n\nФункция ПересечениеСписков(м1,м2)\r\n\tТз = Новый ТаблицаЗначений();\r\n\tДля каждого Эл из М1 Цикл\r\n\t\tТЗ.Добавить().Элемент=Эл.Значение;\r\n\tКонецЦикла;\r\n\tДля каждого Эл из М2 Цикл\r\n\t\tТЗ.Добавить().Элемент=Эл.Значение;\r\n\tКонецЦикла;\r\n\t\r\n\tТЗ.Колонки.Добавить(\"Флаг\");\r\n\tТЗ.ЗаполнитьЗначения(1,\"Флаг\");\r\n\tТЗ.Свернуть(\"Элемент\",\"Флаг\");\r\n\t\r\n\tСовпадающие = Новый СписокЗначений;\r\n\tДля каждого Строка из ТЗ.НайтиСтроки(Новый Структура(\"Флаг\",2)) Цикл\r\n\t\tСовпадающие.Добавить(Строка.Элемент);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Совпадающие\r\nКонецФункции\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "Краткое представление строки (в т.ч. многострочной) в виде первых N символов",
    "description": "Краткое представление строки (в т.ч. многострочной) в виде первых N символов",
    "code_snippet": "// Формирует из любой строки (в т.ч. многострочной) ее краткое однострочное представление, состоящее из первых N символов.\r\n// Если исходная строка многострочная, то берется ее первая подстрока.\r\n// \r\n// В варианте по умолчанию метод пропускает все пустые строки и незначащие символы слева перед тем,\r\n// как начать подсчет первых N символов, но этим можно управлять через необязательные параметры.\r\n// \r\n// Если длина исходной строки больше максимально допустимой (или если исходная строка многострочная),\r\n// то в возвращаемый результат добавляется многоточие, иначе - не добавляется.\r\n//\r\n// Параметры:\r\n//  ИсходнаяСтрока - Строка - Строка, которую нужно обрезать.\r\n//  МаксимальнаяДлина - Число - Сколько символов оставлять в возвращаемом результате.\r\n//  УдалятьПустыеСтроки - Булево - Исходная многострочная строка может начинаться с одной или нескольких пустых строк.\r\n//                                 Если их не удалять, то возвращаемый результат будет состоять из первой такой пустой строки.\r\n//  УдалятьПробелыСлева - Булево - Удалять или не удалять незначащие символы (пробелы, табуляции и т.д.) из начала возвращаемой строки.\r\n// \r\n// Возвращаемое значение:\r\n//  Строка - Результат усечения исходной строки до N символов.\r\n//\r\nФункция КраткоеПредставлениеСтроки(Знач ИсходнаяСтрока, Знач МаксимальнаяДлина, Знач УдалятьПустыеСтроки = Истина, Знач УдалятьПробелыСлева = Истина) Экспорт\r\n\t\r\n\tРезультат = \"\";\r\n\tПодстроки = СтрРазделить(ИсходнаяСтрока, Символы.ПС, НЕ УдалятьПустыеСтроки);\r\n\tЕсли Подстроки.Количество() > 0 Тогда\r\n\t\tРезультат = Подстроки[0];\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли УдалятьПробелыСлева Тогда\r\n\t\tРезультат = СокрЛ(Результат);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли СтрЧислоСтрок(ИсходнаяСтрока) > 1 ИЛИ СтрДлина(Результат) > МаксимальнаяДлина Тогда\r\n\t\tРезультат = Лев(Результат, МаксимальнаяДлина) + \"...\";\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\r\n\r\nКонецФункции\n\n// Формирует из любой строки (в т.ч. многострочной) ее краткое однострочное представление, состоящее из первых N символов.\r\n// Если исходная строка многострочная, то берется ее первая подстрока.\r\n// \r\n// В варианте по умолчанию метод пропускает все пустые строки и незначащие символы слева перед тем,\r\n// как начать подсчет первых N символов, но этим можно управлять через необязательные параметры.\r\n// \r\n// Если длина исходной строки больше максимально допустимой (или если исходная строка многострочная),\r\n// то в возвращаемый результат добавляется многоточие, иначе - не добавляется.\r\n//\r\n// Параметры:\r\n//  ИсходнаяСтрока - Строка - Строка, которую нужно обрезать.\r\n//  МаксимальнаяДлина - Число - Сколько символов оставлять в возвращаемом результате.\r\n//  УдалятьПустыеСтроки - Булево - Исходная многострочная строка может начинаться с одной или нескольких пустых строк.\r\n//                                 Если их не удалять, то возвращаемый результат будет состоять из первой такой пустой строки.\r\n//  УдалятьПробелыСлева - Булево - Удалять или не удалять незначащие символы (пробелы, табуляции и т.д.) из начала возвращаемой строки.\r\n// \r\n// Возвращаемое значение:\r\n//  Строка - Результат усечения исходной строки до N символов.\r\n//\r\nФункция КраткоеПредставлениеСтроки(Знач ИсходнаяСтрока, Знач МаксимальнаяДлина, Знач УдалятьПустыеСтроки = Истина, Знач УдалятьПробелыСлева = Истина) Экспорт\r\n\t\r\n\tРезультат = \"\";\r\n\tПодстроки = СтрРазделить(ИсходнаяСтрока, Символы.ПС, НЕ УдалятьПустыеСтроки);\r\n\tЕсли Подстроки.Количество() > 0 Тогда\r\n\t\tРезультат = Подстроки[0];\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли УдалятьПробелыСлева Тогда\r\n\t\tРезультат = СокрЛ(Результат);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли СтрЧислоСтрок(ИсходнаяСтрока) > 1 ИЛИ СтрДлина(Результат) > МаксимальнаяДлина Тогда\r\n\t\tРезультат = Лев(Результат, МаксимальнаяДлина) + \"...\";\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\r\n\r\nКонецФункции\n\nОрфографическая ошибка в однострочное (найдено 2): однострочное"
  },
  {
    "title": "Шаблон кода Внешней обработки Расчет Скидки Наценки",
    "description": "Шаблон кода Внешней обработки Расчет Скидки Наценки",
    "code_snippet": "////////////////////////////////////////////////////////////////////////////////\r\n// ПРОГРАММНЫЙ ИНТЕРФЕЙС\r\n\r\n// Возвращает сведения о внешней обработке.\r\nФункция СведенияОВнешнейОбработке() Экспорт\r\n\t\r\n\tНаименование = НСтр(\"ru = 'Процент/сумма по ... '\");\r\n\tИнформация = НСтр(\"ru = 'Предоставляется скидка (наценка) процентом (суммой), зависит от ... .'\");\r\n\tНазначение = Новый Массив;\r\n\t\r\n\tПараметрыРегистрации = Новый Структура;\r\n\t\r\n\tПараметрыРегистрации.Вставить(\"Вид\", Перечисления.ВидыДополнительныхОтчетовИОбработок.РасчетСкидкиНаценки);\r\n\tПараметрыРегистрации.Вставить(\"Версия\", \"1.01.001\");\r\n\tПараметрыРегистрации.Вставить(\"Назначение\", Назначение);\r\n\tПараметрыРегистрации.Вставить(\"Наименование\", Наименование);\r\n\tПараметрыРегистрации.Вставить(\"БезопасныйРежим\", Истина);\r\n\tПараметрыРегистрации.Вставить(\"Информация\", Информация);\r\n\tПараметрыРегистрации.Вставить(\"ВерсияБСП\", \"2.1.2.1\");\r\n\t\r\n\tПараметрыРегистрации.Вставить(\"Команды\", Новый ТаблицаЗначений);\r\n\t\r\n\tВозврат ПараметрыРегистрации;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает способ применения скидки (наценки)\r\n//\r\n// Возвращаемое значение:\r\n//\tПеречисления.СпособыПримененияСкидокНаценок - способ применения скидки (наценки)\r\n//\r\nФункция СпособПрименения() Экспорт\r\n\t\r\n\tВозврат Перечисления.СпособыПримененияСкидокНаценок.ПрименитьВМоментРасчетаСкидокНаценок;\r\n\t\r\nКонецФункции\r\n\r\n// Выполняет расчет скидки (наценки)\r\n//\r\n// Параметры:\r\n//\tСкидкаНаценка - Строка дерева скидок (наценок). Включает результаты проверки условий, способы совместного применения\r\n//\tНастройки - Структура - Настройки, заданные пользователем в форме настроек внешней обработки\r\n//\tТовары - Коллекция товаров, для которых требуется применить скидку (наценку)\r\n//\tПараметрыРасчета - Структура - Параметры расчета скидок (наценок)\r\n//\r\n// Возвращаемое значение:\r\n//\tРезультатРасчета - ТаблицаЗначений - результат расчета\r\n//\r\nФункция Рассчитать(СкидкаНаценка, Настройки, Товары, ПараметрыРасчета) Экспорт\r\n\t\r\n\tИмяРеквизитаУсловия = \"\";\r\n\t\r\n\tРезультатРасчета = СкидкиНаценкиСервер.ПустаяТаблицаСкидокСРасшифровкой();\r\n\t//Если своя {\r\n\t//РезультатРасчета = ПустаяТаблицаСкидокСРасшифровкой();\r\n\t//Если своя }\r\n\r\n\tЕсли ПараметрыРасчета.Объект.Ссылка.Пустая() Тогда\r\n\t\tВозврат РезультатРасчета;\r\n\tКонецЕсли;\r\n\t\r\n\tЭтоУмножение = СкидкаНаценка.ПрименятьУмножениеВРамкахВышестоящейГруппы;\r\n\t\r\n\t// { Поиск строк с нужным условием\r\n\tСтрокаТЧ = Настройки.Таблица.Найти(ПараметрыРасчета.Объект[ИмяРеквизитаУсловия], \"КолонкаУсловие\");\r\n\t// } Поиск строк с нужным условием\r\n\tЕсли СтрокаТЧ <> Неопределено Тогда\r\n\t\t\r\n\t\tДля Каждого Товар Из Товары Цикл\r\n\t\t\t\r\n\t\t\tЕсли СтрокаТЧ.СпособПредоставленияСкидки = Перечисления.СпособыПредоставленияСкидокНаценок.Процент Тогда\r\n\t\t\t\tСуммаСкидки = СтрокаТЧ.Значение / 100 * СкидкиНаценкиСервер1.ОстатокСуммыПоСтроке(СкидкаНаценка, Товар, ПараметрыРасчета, ЭтоУмножение);\r\n\t\t\t\tСкидкиНаценкиСервер.ПрименитьЗначениеСкидкиКТовару(СкидкаНаценка, СуммаСкидки, Товар, РезультатРасчета, ПараметрыРасчета);\r\n\t\t\tИначе\r\n\t\t\t\tДатаЦены = ?(ЗначениеЗаполнено(ПараметрыРасчета.Объект.ДатаСогласования), ПараметрыРасчета.Объект.ДатаСогласования, ПараметрыРасчета.Объект.Дата);\r\n\t\t\t\tСуммаСкидки = СтрокаТЧ.Значение * РаботаСКурсамиВалют.ПолучитьКурсВалюты(ПараметрыРасчета.Объект.Соглашение.ВидЦен.ВалютаЦены, ДатаЦены).Курс;\r\n\t\t\t\tСкидкиНаценкиСервер.ПрименитьЗначениеСкидкиКТовару(СкидкаНаценка, СуммаСкидки, Товар, РезультатРасчета, ПараметрыРасчета);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат РезультатРасчета;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает имя формы внешней обработки,\r\n// предназначенной для настройки условия предоставления \r\n//\r\n// Возвращаемое значение:\r\n//\tСтрока - Имя формы\r\n//\r\nФункция ИмяФормыНастроек() Экспорт\r\n\t\r\n\tВозврат \"Настройки\";\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает расширенное описание условия предоставления с учетом настроек\r\n//\r\n// Параметры:\r\n//\tНастройки - Структура - Значения настроек условия предоставления\r\n//\r\n// Возвращаемое значение:\r\n//\tСтрока - Расширенное описание\r\n//\r\nФункция ОписаниеДействия(Настройки) Экспорт\r\n\t\r\n\tПопытка\r\n\t\tЕсли Настройки<> Неопределено И Настройки.Таблица.Количество() > 0 Тогда\r\n\t\t\tОписание = \"Предоставляется скидка (наценка) процентом (суммой), зависит от ... :\";\r\n\t\t\tДля Каждого СтрокаТЧ Из Настройки.Таблица Цикл\r\n\t\t\t\tОписание = Описание + Символы.ПС + \"По условию \" + \" \"\"\" + СтрокаТЧ.КолонкаУсловие + \"\"\": \" + СтрокаТЧ.Значение\r\n\t\t\t\t+ ?(СтрокаТЧ.СпособПредоставленияСкидки = Перечисления.СпособыПредоставленияСкидокНаценок.Процент, \"%\", \"€\");\r\n\t\t\tКонецЦикла;\r\n\t\tИначе\r\n\t\t\tОписание = \"Не заданы настройки скидки (наценки)\";\r\n\t\tКонецЕсли;\r\n\tИсключение\r\n\t\tОписание = \"Настройки не загружены.\r\n\t\t           |При загрузке настроек скидки (наценки) произошла ошибка:\r\n\t\t           |\" + ОписаниеОшибки();\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат Описание;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает заголовок условия предоставления с учетом настроек\r\n//\r\n// Параметры:\r\n//\tНастройки - Структура - Значения настроек условия предоставления\r\n//\r\n// Возвращаемое значение:\r\n//\tСтрока - Наименование условия\r\n//\r\nФункция Автонаименование(Настройки) Экспорт\r\n\t\r\n\tВозврат НСтр(\"ru = 'Процент/сумма по ... '\");\r\n\t\r\nКонецФункции\r\n\r\nФункция ПустаяТаблицаСкидокСРасшифровкой(ПараметрыРасчета = Неопределено) Экспорт\r\n\t\r\n\tЕсли ПараметрыРасчета = Неопределено Тогда\r\n\t\tТаблица = Новый ТаблицаЗначений;\r\n\t\tТаблица.Колонки.Добавить(\"КлючСвязи\",   Новый ОписаниеТипов(\"Число\"));\r\n\t\tТаблица.Колонки.Добавить(\"Расшифровка\", Новый ОписаниеТипов(\"ТаблицаЗначений\"));\r\n\t\tТаблица.Колонки.Добавить(\"Сумма\",       Новый ОписаниеТипов(\"Число\",,,Новый КвалификаторыЧисла(15,2)));\r\n\t\tТаблица.Колонки.Добавить(\"Действует\",   Новый ОписаниеТипов(\"Булево\"));\r\n\t\tВозврат Таблица;\r\n\tИначе\r\n\t\tВозврат ПараметрыРасчета.ПустаяТаблицаСкидокСРасшифровкой.СкопироватьКолонки();\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции\n\n////////////////////////////////////////////////////////////////////////////////\r\n// ПРОГРАММНЫЙ ИНТЕРФЕЙС\r\n\r\n// Возвращает сведения о внешней обработке.\r\nФункция СведенияОВнешнейОбработке() Экспорт\r\n\t\r\n\tНаименование = НСтр(\"ru = 'Процент/сумма по ... '\");\r\n\tИнформация = НСтр(\"ru = 'Предоставляется скидка (наценка) процентом (суммой), зависит от ... .'\");\r\n\tНазначение = Новый Массив;\r\n\t\r\n\tПараметрыРегистрации = Новый Структура;\r\n\t\r\n\tПараметрыРегистрации.Вставить(\"Вид\", Перечисления.ВидыДополнительныхОтчетовИОбработок.РасчетСкидкиНаценки);\r\n\tПараметрыРегистрации.Вставить(\"Версия\", \"1.01.001\");\r\n\tПараметрыРегистрации.Вставить(\"Назначение\", Назначение);\r\n\tПараметрыРегистрации.Вставить(\"Наименование\", Наименование);\r\n\tПараметрыРегистрации.Вставить(\"БезопасныйРежим\", Истина);\r\n\tПараметрыРегистрации.Вставить(\"Информация\", Информация);\r\n\tПараметрыРегистрации.Вставить(\"ВерсияБСП\", \"2.1.2.1\");\r\n\t\r\n\tПараметрыРегистрации.Вставить(\"Команды\", Новый ТаблицаЗначений);\r\n\t\r\n\tВозврат ПараметрыРегистрации;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает способ применения скидки (наценки)\r\n//\r\n// Возвращаемое значение:\r\n//\tПеречисления.СпособыПримененияСкидокНаценок - способ применения скидки (наценки)\r\n//\r\nФункция СпособПрименения() Экспорт\r\n\t\r\n\tВозврат Перечисления.СпособыПримененияСкидокНаценок.ПрименитьВМоментРасчетаСкидокНаценок;\r\n\t\r\nКонецФункции\r\n\r\n// Выполняет расчет скидки (наценки)\r\n//\r\n// Параметры:\r\n//\tСкидкаНаценка - Строка дерева скидок (наценок). Включает результаты проверки условий, способы совместного применения\r\n//\tНастройки - Структура - Настройки, заданные пользователем в форме настроек внешней обработки\r\n//\tТовары - Коллекция товаров, для которых требуется применить скидку (наценку)\r\n//\tПараметрыРасчета - Структура - Параметры расчета скидок (наценок)\r\n//\r\n// Возвращаемое значение:\r\n//\tРезультатРасчета - ТаблицаЗначений - результат расчета\r\n//\r\nФункция Рассчитать(СкидкаНаценка, Настройки, Товары, ПараметрыРасчета) Экспорт\r\n\t\r\n\tИмяРеквизитаУсловия = \"\";\r\n\t\r\n\tРезультатРасчета = СкидкиНаценкиСервер.ПустаяТаблицаСкидокСРасшифровкой();\r\n\t//Если своя {\r\n\t//РезультатРасчета = ПустаяТаблицаСкидокСРасшифровкой();\r\n\t//Если своя }\r\n\r\n\tЕсли ПараметрыРасчета.Объект.Ссылка.Пустая() Тогда\r\n\t\tВозврат РезультатРасчета;\r\n\tКонецЕсли;\r\n\t\r\n\tЭтоУмножение = СкидкаНаценка.ПрименятьУмножениеВРамкахВышестоящейГруппы;\r\n\t\r\n\t// { Поиск строк с нужным условием\r\n\tСтрокаТЧ = Настройки.Таблица.Найти(ПараметрыРасчета.Объект[ИмяРеквизитаУсловия], \"КолонкаУсловие\");\r\n\t// } Поиск строк с нужным условием\r\n\tЕсли СтрокаТЧ <> Неопределено Тогда\r\n\t\t\r\n\t\tДля Каждого Товар Из Товары Цикл\r\n\t\t\t\r\n\t\t\tЕсли СтрокаТЧ.СпособПредоставленияСкидки = Перечисления.СпособыПредоставленияСкидокНаценок.Процент Тогда\r\n\t\t\t\tСуммаСкидки = СтрокаТЧ.Значение / 100 * СкидкиНаценкиСервер1.ОстатокСуммыПоСтроке(СкидкаНаценка, Товар, ПараметрыРасчета, ЭтоУмножение);\r\n\t\t\t\tСкидкиНаценкиСервер.ПрименитьЗначениеСкидкиКТовару(СкидкаНаценка, СуммаСкидки, Товар, РезультатРасчета, ПараметрыРасчета);\r\n\t\t\tИначе\r\n\t\t\t\tДатаЦены = ?(ЗначениеЗаполнено(ПараметрыРасчета.Объект.ДатаСогласования), ПараметрыРасчета.Объект.ДатаСогласования, ПараметрыРасчета.Объект.Дата);\r\n\t\t\t\tСуммаСкидки = СтрокаТЧ.Значение * РаботаСКурсамиВалют.ПолучитьКурсВалюты(ПараметрыРасчета.Объект.Соглашение.ВидЦен.ВалютаЦены, ДатаЦены).Курс;\r\n\t\t\t\tСкидкиНаценкиСервер.ПрименитьЗначениеСкидкиКТовару(СкидкаНаценка, СуммаСкидки, Товар, РезультатРасчета, ПараметрыРасчета);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат РезультатРасчета;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает имя формы внешней обработки,\r\n// предназначенной для настройки условия предоставления \r\n//\r\n// Возвращаемое значение:\r\n//\tСтрока - Имя формы\r\n//\r\nФункция ИмяФормыНастроек() Экспорт\r\n\t\r\n\tВозврат \"Настройки\";\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает расширенное описание условия предоставления с учетом настроек\r\n//\r\n// Параметры:\r\n//\tНастройки - Структура - Значения настроек условия предоставления\r\n//\r\n// Возвращаемое значение:\r\n//\tСтрока - Расширенное описание\r\n//\r\nФункция ОписаниеДействия(Настройки) Экспорт\r\n\t\r\n\tПопытка\r\n\t\tЕсли Настройки<> Неопределено И Настройки.Таблица.Количество() > 0 Тогда\r\n\t\t\tОписание = \"Предоставляется скидка (наценка) процентом (суммой), зависит от ... :\";\r\n\t\t\tДля Каждого СтрокаТЧ Из Настройки.Таблица Цикл\r\n\t\t\t\tОписание = Описание + Символы.ПС + \"По условию \" + \" \"\"\" + СтрокаТЧ.КолонкаУсловие + \"\"\": \" + СтрокаТЧ.Значение\r\n\t\t\t\t+ ?(СтрокаТЧ.СпособПредоставленияСкидки = Перечисления.СпособыПредоставленияСкидокНаценок.Процент, \"%\", \"€\");\r\n\t\t\tКонецЦикла;\r\n\t\tИначе\r\n\t\t\tОписание = \"Не заданы настройки скидки (наценки)\";\r\n\t\tКонецЕсли;\r\n\tИсключение\r\n\t\tОписание = \"Настройки не загружены.\r\n\t\t           |При загрузке настроек скидки (наценки) произошла ошибка:\r\n\t\t           |\" + ОписаниеОшибки();\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат Описание;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает заголовок условия предоставления с учетом настроек\r\n//\r\n// Параметры:\r\n//\tНастройки - Структура - Значения настроек условия предоставления\r\n//\r\n// Возвращаемое значение:\r\n//\tСтрока - Наименование условия\r\n//\r\nФункция Автонаименование(Настройки) Экспорт\r\n\t\r\n\tВозврат НСтр(\"ru = 'Процент/сумма по ... '\");\r\n\t\r\nКонецФункции\r\n\r\nФункция ПустаяТаблицаСкидокСРасшифровкой(ПараметрыРасчета = Неопределено) Экспорт\r\n\t\r\n\tЕсли ПараметрыРасчета = Неопределено Тогда\r\n\t\tТаблица = Новый ТаблицаЗначений;\r\n\t\tТаблица.Колонки.Добавить(\"КлючСвязи\",   Новый ОписаниеТипов(\"Число\"));\r\n\t\tТаблица.Колонки.Добавить(\"Расшифровка\", Новый ОписаниеТипов(\"ТаблицаЗначений\"));\r\n\t\tТаблица.Колонки.Добавить(\"Сумма\",       Новый ОписаниеТипов(\"Число\",,,Новый КвалификаторыЧисла(15,2)));\r\n\t\tТаблица.Колонки.Добавить(\"Действует\",   Новый ОписаниеТипов(\"Булево\"));\r\n\t\tВозврат Таблица;\r\n\tИначе\r\n\t\tВозврат ПараметрыРасчета.ПустаяТаблицаСкидокСРасшифровкой.СкопироватьКолонки();\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в Автонаименование: Автонаименование"
  },
  {
    "title": "Список телеграм-каналов по 1С",
    "description": "Список телеграм-каналов по 1СЛайфхаки 1С",
    "code_snippet": ""
  },
  {
    "title": "Выгрузить различные из поля коллекции",
    "description": "Выгрузить различные из поля коллекции",
    "code_snippet": "Функция ВыгрузитьРазличные(Коллекция,ИмяПоля)\r\n\t\r\n\tРезультат = Новый Массив;\r\n\tДля каждого ТекущийЭлемент Из Коллекция Цикл\r\n\t\tТекущееЗначение = ТекущийЭлемент[ИмяПоля];\r\n\t\tЕсли Результат.Найти(ТекущееЗначение) = Неопределено Тогда\r\n\t\t\tРезультат.Добавить(ТекущееЗначение);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла; \r\n\t\r\n\tВозврат Результат;\r\nКонецФункции\n\nФункция ВыгрузитьРазличные(Коллекция,ИмяПоля)\r\n\t\r\n\tРезультат = Новый Массив;\r\n\tДля каждого ТекущийЭлемент Из Коллекция Цикл\r\n\t\tТекущееЗначение = ТекущийЭлемент[ИмяПоля];\r\n\t\tЕсли Результат.Найти(ТекущееЗначение) = Неопределено Тогда\r\n\t\t\tРезультат.Добавить(ТекущееЗначение);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла; \r\n\t\r\n\tВозврат Результат;\r\nКонецФункции"
  },
  {
    "title": "Получить контактное лицо по умолчанию",
    "description": "Получить контактное лицо по умолчанию",
    "code_snippet": "// версия по партнеру\nКонтактноеЛицо = ПартнерыИКонтрагенты.ПолучитьКонтактноеЛицоПартнераПоУмолчанию(Партнер);\n\n// версия по контрагенту\nКонтактноеЛицо = ПартнерыИКонтрагенты.ПолучитьКонтактноеЛицоПартнераКонтрагентаПоУмолчанию(Контрагент);"
  },
  {
    "title": "Первый рабочий день месяца",
    "description": "Первый рабочий день месяца",
    "code_snippet": "// Функция - Это первый рабочий день месяца\n//\n// Параметры:\n//  Дата - Дата - Дата, которую необходимо проверить, если не заполнено, тогда функция проверяет текущую дату\n// \n// Возвращаемое значение:\n//  Булево - Фукнция возвращает истину, если дата -- первый рабочий день месяца\n//\nФункция ЭтоПервыйРабочийДеньМесяца(Дата = Неопределено)\n\t\n\tЕсли Дата = Неопределено Тогда\n\t\tДата = ТекущаяДатаСеанса();\n\tКонецЕсли;\n\t\n\tЗапрос = Новый Запрос;\n\tЗапрос.Текст = \n\t\"ВЫБРАТЬ\n\t|\tСУММА(ВЫБОР\n\t|\t\t\tКОГДА ДанныеПроизводственногоКалендаря.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Рабочий)\n\t|\t\t\t\tТОГДА 1\n\t|\t\t\tИНАЧЕ 0\n\t|\t\tКОНЕЦ) КАК ВидДня\n\t|ИЗ\n\t|\tРегистрСведений.ДанныеПроизводственногоКалендаря КАК ДанныеПроизводственногоКалендаря\n\t|ГДЕ\n\t|\tДанныеПроизводственногоКалендаря.Дата МЕЖДУ НАЧАЛОПЕРИОДА(&Период, МЕСЯЦ) И НАЧАЛОПЕРИОДА(&Период, ДЕНЬ)\"; \n\tЗапрос.УстановитьПараметр(\"Период\", Дата);\n\tРезультатЗапроса = Запрос.Выполнить();\n\tВыборка = РезультатЗапроса.Выбрать();\n\tВыборка.Следующий();\n\t\n\tВозврат Выборка.ВидДня = 1;\n\t\nКонецФункции"
  },
  {
    "title": "ИнициализацияТипом",
    "description": "ИнициализацияТипом",
    "code_snippet": "Процедура ИнициализацияТипом(Переменная,ТипДанных = \"СписокЗначений\",Очищать = Истина)\r\n\t\r\n\tЕсли Переменная = Неопределено Тогда\r\n\t\tПеременная = Вычислить(\"Новый \" + ТипДанных);\r\n\tИначеЕсли ТипЗнч(Переменная) = Тип(\"СписокЗначений\") Или ТипЗнч(Переменная) = Тип(\"Массив\") Или ТипЗнч(Переменная) = Тип(\"ТаблицаЗначений\") Тогда\r\n\t\tЕсли Очищать = Истина Тогда\r\n\t\t\tПеременная.Очистить();\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\nПроцедура ИнициализацияТипом(Переменная,ТипДанных = \"СписокЗначений\",Очищать = Истина)\r\n\t\r\n\tЕсли Переменная = Неопределено Тогда\r\n\t\tПеременная = Вычислить(\"Новый \" + ТипДанных);\r\n\tИначеЕсли ТипЗнч(Переменная) = Тип(\"СписокЗначений\") Или ТипЗнч(Переменная) = Тип(\"Массив\") Или ТипЗнч(Переменная) = Тип(\"ТаблицаЗначений\") Тогда\r\n\t\tЕсли Очищать = Истина Тогда\r\n\t\t\tПеременная.Очистить();\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "Получает краткое имя пользователя ИБ (информационной базы) из полного (Иванов Иван Иванович --> Иванов_ИИ)",
    "description": "Получает краткое имя пользователя ИБ (информационной базы) из полного (Иванов Иван Иванович --> Иванов_ИИ)",
    "code_snippet": "ПользователиСлужебныйКлиентСервер.ПолучитьКраткоеИмяПользователяИБ(Форма.Объект.Наименование)\n\nПользователиСлужебныйКлиентСервер.ПолучитьКраткоеИмяПользователяИБ(Форма.Объект.Наименование)"
  },
  {
    "title": "Создаем свой шаблон T9 с умным фильтром",
    "description": "Создаем свой шаблон T9 с умным фильтромСекреты TurboConf",
    "code_snippet": "//Сохраните файл под другим именем после внесения изменений\n\n// Команды:\n// <!> установить позицию курсора после вставки текста шаблона\n// <?> установить позицию курсора после вставки текста шаблона и нажать Ctrl+Space\n// <ENTER> нажать ENTER после вставки, но до установки позиции курсора\n\n//Context:\n//\t0 - любой (шаблон будет показан везде)\n//\t1 - глобальный (шаблон будет показан в глобальном контексте)\n//\t2 - класса (будет показан только после .)\n\n//Priority:\n//Шаблоны с более высоким приоритетом показываются в списке меню выше. Чем больше число, тем выше приоритет. По умолчанию 0.\n//Шаблоны с приоритетом 0 не показываются в списке, пока в поиске не набран хотя бы один символ\n//Встроенные функции языка имеют приоритет 10\n\n//Для динамических шаблонов, специальные переменные:\n //$0 - полное совпадение фильтра\n //$1 - первая захваченная группа (в скобках)\n //$2 - вторая группа и т.д.\n\n[\n   {\n    \"FromContext\": true,\n    \"Priority\": 30,\n    \"CustomFilter\": \"\",\n    \"Context\": 1,\n    \"ChildItems\": null,\n    \"ValueForFilter\": \"НовыйТаблицаЗначений\",\n    \"DisplayedValue\": \"Новый ТаблицаЗначений\",\n    \"Value\": \"Новый ТаблицаЗначений\",\n    \"IsMethod\": false,\n    Cached: true,\n    SmartFilter: \"\\\\s+(таб|тз)[\\\\w\\\\d_]*\\\\s*=\\\\s*н[\\\\w]*$\"\n  }\n]\n\n{\n    \"FromContext\": true,\n    \"Priority\": 30,\n    \"CustomFilter\": \"\",\n    \"Context\": 4,\n    \"ChildItems\": null,\n    \"ValueForFilter\": \"НовыйФайл\",\n    \"DisplayedValue\": \"Новый Файл\",\n    \"Value\": \"Новый Файл\",\n    \"IsMethod\": true,\n    Cached: true,\n    SmartFilter: \"\\\\s+файл[\\\\w\\\\d_]*\\\\s*=\\\\s*н[\\\\w]*$\"\n  }"
  },
  {
    "title": "Программная установка параметров выбора на примере банковских счетов из ERP 2.5",
    "description": "Программная установка параметров выбора на примере банковских счетов из ERP 2.5",
    "code_snippet": "&НаСервереБезКонтекста\r\nФункция ПараметрыВыбораБанковскихСчетов(ОплатаВВалюте, Организация)\r\n\r\n\tМассивПараметров = Новый Массив;\r\n\t\r\n\tЕсли НЕ ОплатаВВалюте Тогда\r\n\t\tМассивПараметров.Добавить(Новый ПараметрВыбора(\"Отбор.ВалютаДенежныхСредств\",\r\n\t\t\t\t\tЗначениеНастроекПовтИсп.ВалютаРегламентированногоУчетаОрганизации(Организация)));\r\n\tИначе\r\n\t\tМассивПараметров.Добавить(Новый ПараметрВыбора(\"Отбор.ВалютаДенежныхСредств\", Новый ФиксированныйМассив(ИностранныеВалюты(Организация))));\r\n\tКонецЕсли;\r\n\t\r\n\tМассивПараметров.Добавить(Новый ПараметрВыбора(\"ВыборСчетовГоловнойОрганизации\", Неопределено));\r\n\tМассивПараметров.Добавить(Новый ПараметрВыбора(\"Отбор.Закрыт\", Ложь));\r\n\t\r\n\tВозврат Новый ФиксированныйМассив(МассивПараметров);\r\n\t\r\nКонецФункции\r\n\r\n&НаСервере\r\nПроцедура ПриЧтенииНаСервере()\r\n\tПараметрыВыбораБанковскогоСчета = ПараметрыВыбораБанковскихСчетов(Ложь, Объект.Организация);\r\n\tЭлементы.БанковскийСчет.ПараметрыВыбора            = ПараметрыВыбораБанковскогоСчета;\r\n\tЭлементы.БанковскийСчетКонтрагента.ПараметрыВыбора = ПараметрыВыбораБанковскогоСчета;\r\nКонецПроцедуры\n\n&НаСервереБезКонтекста\r\nФункция ПараметрыВыбораБанковскихСчетов(ОплатаВВалюте, Организация)\r\n\r\n\tМассивПараметров = Новый Массив;\r\n\t\r\n\tЕсли НЕ ОплатаВВалюте Тогда\r\n\t\tМассивПараметров.Добавить(Новый ПараметрВыбора(\"Отбор.ВалютаДенежныхСредств\",\r\n\t\t\t\t\tЗначениеНастроекПовтИсп.ВалютаРегламентированногоУчетаОрганизации(Организация)));\r\n\tИначе\r\n\t\tМассивПараметров.Добавить(Новый ПараметрВыбора(\"Отбор.ВалютаДенежныхСредств\", Новый ФиксированныйМассив(ИностранныеВалюты(Организация))));\r\n\tКонецЕсли;\r\n\t\r\n\tМассивПараметров.Добавить(Новый ПараметрВыбора(\"ВыборСчетовГоловнойОрганизации\", Неопределено));\r\n\tМассивПараметров.Добавить(Новый ПараметрВыбора(\"Отбор.Закрыт\", Ложь));\r\n\t\r\n\tВозврат Новый ФиксированныйМассив(МассивПараметров);\r\n\t\r\nКонецФункции\r\n\r\n&НаСервере\r\nПроцедура ПриЧтенииНаСервере()\r\n\tПараметрыВыбораБанковскогоСчета = ПараметрыВыбораБанковскихСчетов(Ложь, Объект.Организация);\r\n\tЭлементы.БанковскийСчет.ПараметрыВыбора            = ПараметрыВыбораБанковскогоСчета;\r\n\tЭлементы.БанковскийСчетКонтрагента.ПараметрыВыбора = ПараметрыВыбораБанковскогоСчета;\r\nКонецПроцедуры"
  },
  {
    "title": "Как найти все скрипты, которые срабатывают автоматически",
    "description": "Как найти все скрипты, которые срабатывают автоматическиСекреты TurboConf",
    "code_snippet": ""
  },
  {
    "title": "Как в \"Навигаторе по метаданным\" удалить объект из истории",
    "description": "Как в \"Навигаторе по метаданным\" удалить объект из историиСекреты TurboConf",
    "code_snippet": ""
  },
  {
    "title": "Как отфильтровать объекты по типу в \"Навигаторе по метаданным\"",
    "description": "Как отфильтровать объекты по типу в \"Навигаторе по метаданным\"Секреты TurboConf",
    "code_snippet": ""
  },
  {
    "title": "Прочитать таблицу значений из XML",
    "description": "Прочитать таблицу значений из XML",
    "code_snippet": "Функция ПрочитатьТаблицуИзXML(СтрокаXML)\r\n    \r\n    ЧтениеXML = Новый ЧтениеXML;\r\n    ЧтениеXML.УстановитьСтроку(СтрокаXML);\r\n    ТипОбъектаXDTO = ФабрикаXDTO.Тип(\"http://v8.1c.ru/8.1/data/core\",\"ValueTable\");\r\n    ОбъектXDTO = ФабрикаXDTO.ПрочитатьXML(ЧтениеXML,ТипОбъектаXDTO); \r\n    ОбъектXDTO.Проверить();\r\n    \r\n    ЧтениеXML.Закрыть();\r\n    Возврат СериализаторXDTO.ПрочитатьXDTO(ОбъектXDTO);\r\n   \r\nКонецФункции\n\nФункция ПрочитатьТаблицуИзXML(СтрокаXML)\r\n    \r\n    ЧтениеXML = Новый ЧтениеXML;\r\n    ЧтениеXML.УстановитьСтроку(СтрокаXML);\r\n    ТипОбъектаXDTO = ФабрикаXDTO.Тип(\"http://v8.1c.ru/8.1/data/core\",\"ValueTable\");\r\n    ОбъектXDTO = ФабрикаXDTO.ПрочитатьXML(ЧтениеXML,ТипОбъектаXDTO); \r\n    ОбъектXDTO.Проверить();\r\n    \r\n    ЧтениеXML.Закрыть();\r\n    Возврат СериализаторXDTO.ПрочитатьXDTO(ОбъектXDTO);\r\n   \r\nКонецФункции\n\nОрфографическая ошибка в десериализацию: десериализацию\n\nФункция ЗначениеВСтрокуXML(Значение) Экспорт\n    \n    ЗаписьXML = Новый ЗаписьXML;\n    ЗаписьXML.УстановитьСтроку();\n    СериализаторXDTO.ЗаписатьXML(ЗаписьXML, Значение, НазначениеТипаXML.Явное);\n    \n    Возврат ЗаписьXML.Закрыть();\nКонецФункции\n\nФункция ЗначениеИзСтрокиXML(СтрокаXML) Экспорт\n    \n    ЧтениеXML = Новый ЧтениеXML;\n    ЧтениеXML.УстановитьСтроку(СтрокаXML);\n    \n    Возврат СериализаторXDTO.ПрочитатьXML(ЧтениеXML);\nКонецФункции"
  },
  {
    "title": "Записать таблицу значений в XML",
    "description": "Записать таблицу значений в XML",
    "code_snippet": "Функция ЗаписатьТаблицуВXML(ТЗ)\r\n    \r\n    ЗаписьXML = Новый ЗаписьXML;\r\n    ЗаписьXML.УстановитьСтроку();\r\n    ОбъектXDTO = СериализаторXDTO.ЗаписатьXDTO(ТЗ.Выгрузить());\r\n    ФабрикаXDTO.ЗаписатьXML(ЗаписьXML, ОбъектXDTO);\r\n    Возврат ЗаписьXML.Закрыть();\r\n    \r\nКонецФункции\n\nФункция ЗаписатьТаблицуВXML(ТЗ)\r\n    \r\n    ЗаписьXML = Новый ЗаписьXML;\r\n    ЗаписьXML.УстановитьСтроку();\r\n    ОбъектXDTO = СериализаторXDTO.ЗаписатьXDTO(ТЗ.Выгрузить());\r\n    ФабрикаXDTO.ЗаписатьXML(ЗаписьXML, ОбъектXDTO);\r\n    Возврат ЗаписьXML.Закрыть();\r\n    \r\nКонецФункции\n\nОрфографическая ошибка в сериализацию: сериализацию"
  },
  {
    "title": "Улучшаем игру Diablo 2 Resurrected с TurboConf",
    "description": "Улучшаем игру Diablo 2 Resurrected с TurboConfСекреты TurboConf",
    "code_snippet": "//@script_name Diablo2_BO_Reminder\n//@script_hotkey F10 ПоказатьТаймер ПоказатьТаймер\n//@retain_clipboard 0\n//@hide_actions 0\n//@global_mode 1\n//@filter Diablo II: Resurrected\n\nПроцедура ПоказатьТаймер()\n    \n    Таймаут = 140000;\n    \n    ТК = Новый ТурбоКонф;\n    ТК.ShowTimer(\"({0} s)\", Таймаут, 520, 961, 10000, 18);\n    ТК.Key(Keys.F10);\n\t\t\nКонецПроцедуры\n\n//@script_name Diablo2_BO_Reminder\n//@script_hotkey F10 ПоказатьТаймер ПоказатьТаймер\n//@script_hotkey Control+F11 ПоказатьМеню Показать меню\n//@retain_clipboard 0\n//@hide_actions 0\n//@global_mode 1\n//@filter Diablo II: Resurrected\n\nПерем ТурбоКонф;\n\nПроцедура ОбработчикВводаЗначения(Значение, Отказ) Экспорт\n\tТурбоКонф.СохранитьЗначение(\"D2_BO_Timeout\", Значение);\nКонецПроцедуры  \n\nПроцедура ПоказатьНастройкиБО()\n\n    Форма = Новый ФормаВводаЗначения();\n    Форма.УстановитьДействие(ЭтотОбъект, \"ОбработчикВводаЗначения\");\n    Форма.Значение = ТурбоКонф.ВосстановитьЗначение(\"D2_BO_Timeout\");\n    Форма.Заголовок = \"D2 BO Timeout\";\n    Форма.Текст = \"Battle Order duration (ms):\";\n    Форма.Показать();\n\nКонецПроцедуры\n\nПроцедура ОбработчикВыбораЗначения(Значение, Отказ) Экспорт\n\tЕсли Отказ Тогда\n        Возврат;\n    КонецЕсли;\n\n    Если Значение = \"nopickup\" Тогда\n        ТурбоКонф.Key(Keys.Enter);\n        ТурбоКонф.Ждать(200);\n        ТурбоКонф.ОтправитьТекст(\"/nopickup\");\n        ТурбоКонф.Ждать(200);\n        ТурбоКонф.Key(Keys.Enter);\n    ИначеЕсли Значение = \"leavetrade\" Тогда\n        ТурбоКонф.Key(Keys.Enter);\n        ТурбоКонф.Ждать(200);\n        ТурбоКонф.Key(Keys.Tab);\n        ТурбоКонф.Ждать(200);\n        ТурбоКонф.ОтправитьТекст(\"/channel leave\");\n        ТурбоКонф.Ждать(200);\n        ТурбоКонф.Key(Keys.Enter);   \n    ИначеЕсли Значение = \"setboduration\" Тогда   \n        ПоказатьНастройкиБО();\n    КонецЕсли;\nКонецПроцедуры  \n\nПроцедура ПоказатьМеню()\n    ТурбоКонф = Новый ТурбоКонф;\n\n    Форма = Новый ФормаВыбораЗначения();\n    Форма.УстановитьДействие(ЭтотОбъект, \"ОбработчикВыбораЗначения\");\n    \n    Пункты = Новый Соответствие;\n    Пункты.Вставить(\"No pick up\", \"nopickup\");\n    Пункты.Вставить(\"Leave trade channel\", \"leavetrade\");\n    Пункты.Вставить(\"Set BO duration\", \"setboduration\");\n    \n    Форма.Данные = Пункты;\n    Форма.Заголовок = \"TurboD2\";\n    Форма.АвтоматическийРазмер = Истина;\n    \n    Форма.Показать();\n\nКонецПроцедуры\n\nПроцедура ПоказатьТаймер()\n    \n    Таймаут = ТурбоКонф.ВосстановитьЗначение(\"D2_BO_Timeout\");\n    Если Таймаут = Неопределено Тогда\n        Таймаут = 60000;\n    КонецЕсли;\n    \n    ТК = Новый ТурбоКонф;\n    ТК.ShowTimer(\"({0} s)\", Таймаут, 520, 961, 10000, 18);\n    ТК.Key(Keys.F10);\nКонецПроцедуры\n\nТурбоКонф = Новый ТурбоКонф;"
  },
  {
    "title": "Как зарегистрироваться в ChatGPT из России",
    "description": "Как зарегистрироваться в ChatGPT из РоссииНейросети и AI",
    "code_snippet": "{\n  \"model\": \"text-davinci-003\",\n  \"prompt\": \"Все работает?\",\n  \"max_tokens\": 7,\n  \"temperature\": 0,\n  \"top_p\": 1,\n  \"n\": 1,\n  \"stream\": false,\n  \"logprobs\": null,\n  \"stop\": \".\"\n}"
  },
  {
    "title": "Записать таблицу значений в XML файл",
    "description": "Записать таблицу значений в XML файл",
    "code_snippet": "Процедура СохранитьТаблицуВФайлXML(ИмяФайла, ТЗ)\r\n\t\r\n\tСериализатор = Новый СериализаторXDTO(ФабрикаXDTO);\r\n\tXML = Новый ЗаписьXML;\r\n\tXML.ОткрытьФайл(ИмяФайла);\r\n\tСериализатор.ЗаписатьXML(XML, ТЗ);\r\n\tXML.Закрыть();\r\n\r\nКонецПроцедуры\n\nПроцедура СохранитьТаблицуВФайлXML(ИмяФайла, ТЗ)\r\n\t\r\n\tСериализатор = Новый СериализаторXDTO(ФабрикаXDTO);\r\n\tXML = Новый ЗаписьXML;\r\n\tXML.ОткрытьФайл(ИмяФайла);\r\n\tСериализатор.ЗаписатьXML(XML, ТЗ);\r\n\tXML.Закрыть();\r\n\r\nКонецПроцедуры\n\nОрфографическая ошибка в Сериализует: Сериализует"
  },
  {
    "title": "Исправляем неработающие горячие клавиши в Конфигураторе 1С",
    "description": "Исправляем неработающие горячие клавиши в Конфигураторе 1СЛайфхаки 1С",
    "code_snippet": ""
  },
  {
    "title": "TurboConf ИР адаптер 2.52Наш выбор",
    "description": "Cкрипт \"ИР Адаптер\" для платного расширения TurboConf конфигуратора 1С 8 обеспечивает доступ к функциям мощной подсистемы \"Инструменты разработчика Tormozit\" (ИР)",
    "code_snippet": ""
  },
  {
    "title": "Быстрое добавление объекта в кэш",
    "description": "Быстрое добавление объекта в кэшСекреты TurboConf",
    "code_snippet": ""
  },
  {
    "title": "Ввод специальных символов без переключения раскладки",
    "description": "Ввод специальных символов без переключения раскладкиСекреты TurboConf",
    "code_snippet": ""
  },
  {
    "title": "1С Менеджер конфигураций",
    "description": "1С Менеджер конфигураций — альтернативный стартер информационных баз 1С:Предприятие.",
    "code_snippet": ""
  },
  {
    "title": "Сообщить отложенные сообщения",
    "description": "Сообщить отложенные сообщения",
    "code_snippet": "// Выводит сообщения пользователю из заранее подготовленного массива объектов \"СообщениеПользователю\".\r\n// Массив предварительно может быть получен методом \"ПолучитьСообщенияПользователю\".\r\n// Рекомендуется применять, когда мы временно очистили буфер накопленных сообщений пользователю\r\n// и теперь хотим вернуть все такие изъятые из буфера сообщения обратно.\r\n//\r\n// Параметры:\r\n//  СообщенияПользователю - Массив, ФиксированныйМассив - Элементами массива должны быть объекты \"СообщениеПользователю\".\r\n//\r\nПроцедура СообщитьОтложенныеСообщения(Знач СообщенияПользователю) Экспорт\r\n\t\r\n\tДля Каждого СообщениеПользователю Из СообщенияПользователю Цикл\r\n\t\tСообщениеПользователю.Сообщить();\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n// Выводит сообщения пользователю из заранее подготовленного массива объектов \"СообщениеПользователю\".\r\n// Массив предварительно может быть получен методом \"ПолучитьСообщенияПользователю\".\r\n// Рекомендуется применять, когда мы временно очистили буфер накопленных сообщений пользователю\r\n// и теперь хотим вернуть все такие изъятые из буфера сообщения обратно.\r\n//\r\n// Параметры:\r\n//  СообщенияПользователю - Массив, ФиксированныйМассив - Элементами массива должны быть объекты \"СообщениеПользователю\".\r\n//\r\nПроцедура СообщитьОтложенныеСообщения(Знач СообщенияПользователю) Экспорт\r\n\t\r\n\tДля Каждого СообщениеПользователю Из СообщенияПользователю Цикл\r\n\t\tСообщениеПользователю.Сообщить();\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Выбор каталога (папки) файловой системы",
    "description": "Выбор каталога (папки) файловой системы",
    "code_snippet": "// Процедура - Имя каталога начало выбора\n// Обработка события НачалоВыбора поля ввода для выбора каталога\n// В процедуре определяется имя реквизита по Элементу куда нужно записать полученный каталог\n// Имя ПоляВвода должно совпадать с именем реквизита формы\n&НаКлиенте\nПроцедура ИмяКаталогаНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)\n\t\n\tИмяПоля = Элемент.Имя;\n\t\n\tДиалогВыборКаталога = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.ВыборКаталога);\n\t\n\t//Если пользователь не нажал кнопку ОТМЕНА в диалоге\n\tЕсли ДиалогВыборКаталога.Выбрать() Тогда\n\t\tЭтаФорма[ИмяПоля] = ДиалогВыборКаталога.Каталог;\n\tКонецЕсли;\n\t\nКонецПроцедуры"
  },
  {
    "title": "Таблица значений с колонкой любого имени (без ограничений используемых символов)",
    "description": "Таблица значений с колонкой любого имени (без ограничений используемых символов)1С не всерьез",
    "code_snippet": "// Возвращает новую таблицу значений с добавлением новой колонки в обход ограничений доступных символов в имени.\r\n// Использовать не рекомендуется. Просто забавы ради.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/35\r\n// \r\n// Параметры:\r\n//  ПлохоеИмя\t\t - Строка - Имя добавляемой колонки, которое может не соответствовать требованиям к символам\r\n//  ИсходнаяТаблица\t - Неопределено, ТаблицаЗначений - Функция вернет новую ТЗ на основе переданной\r\n//  ОписаниеТипа\t - ОписаниеТипов, Неопределено - Описание типа добавляемой колонки\r\n//  Заголовок\t\t - Строка - Заголовок добавляемой колонки\r\n// \r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений - новая таблица значений с добавленной колонкой\r\n//\r\n// Пример:\r\n//  ТЗ = ТаблицаЗначенийСПлохойКолонкой(\"12345\");\r\n//\tТЗ = ТаблицаЗначенийСПлохойКолонкой(\"  --23-502  =-2-=6524-0624 \", ТЗ);\r\nФункция ТаблицаЗначенийСПлохойКолонкой(Знач ПлохоеИмя, Знач ИсходнаяТаблица = Неопределено, \r\n\tЗнач ОписаниеТипа = Неопределено, Знач Заголовок = \"\") Экспорт\r\n\t\r\n\tТаблицаЗначений = ?(ИсходнаяТаблица = Неопределено, \r\n\t\tНовый ТаблицаЗначений, ИсходнаяТаблица);\r\n\t\t\r\n\tВременноеИмя = \"_\" + СтрЗаменить(Строка(Новый УникальныйИдентификатор), \"-\", \"\");\r\n\tТаблицаЗначений.Колонки.Добавить(ВременноеИмя, ОписаниеТипа, Заголовок);\r\n\tСтрокаВнутр = ЗначениеВСтрокуВнутр(ТаблицаЗначений);\r\n\tСтрокаВнутр = СтрЗаменить(СтрокаВнутр, ВременноеИмя, ПлохоеИмя);\r\n\t\r\n\tИсходнаяТаблица = ЗначениеИзСтрокиВнутр(СтрокаВнутр); // ТаблицаЗначений\r\n\tВозврат ИсходнаяТаблица; //@skip-check constructor-function-return-section - Баг ЕДТ - не понимает типизированный коммент\r\n\t\t\r\nКонецФункции\n\n// Возвращает новую таблицу значений с добавлением новой колонки в обход ограничений доступных символов в имени.\r\n// Использовать не рекомендуется. Просто забавы ради.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/35\r\n// \r\n// Параметры:\r\n//  ПлохоеИмя\t\t - Строка - Имя добавляемой колонки, которое может не соответствовать требованиям к символам\r\n//  ИсходнаяТаблица\t - Неопределено, ТаблицаЗначений - Функция вернет новую ТЗ на основе переданной\r\n//  ОписаниеТипа\t - ОписаниеТипов, Неопределено - Описание типа добавляемой колонки\r\n//  Заголовок\t\t - Строка - Заголовок добавляемой колонки\r\n// \r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений - новая таблица значений с добавленной колонкой\r\n//\r\n// Пример:\r\n//  ТЗ = ТаблицаЗначенийСПлохойКолонкой(\"12345\");\r\n//\tТЗ = ТаблицаЗначенийСПлохойКолонкой(\"  --23-502  =-2-=6524-0624 \", ТЗ);\r\nФункция ТаблицаЗначенийСПлохойКолонкой(Знач ПлохоеИмя, Знач ИсходнаяТаблица = Неопределено, \r\n\tЗнач ОписаниеТипа = Неопределено, Знач Заголовок = \"\") Экспорт\r\n\t\r\n\tТаблицаЗначений = ?(ИсходнаяТаблица = Неопределено, \r\n\t\tНовый ТаблицаЗначений, ИсходнаяТаблица);\r\n\t\t\r\n\tВременноеИмя = \"_\" + СтрЗаменить(Строка(Новый УникальныйИдентификатор), \"-\", \"\");\r\n\tТаблицаЗначений.Колонки.Добавить(ВременноеИмя, ОписаниеТипа, Заголовок);\r\n\tСтрокаВнутр = ЗначениеВСтрокуВнутр(ТаблицаЗначений);\r\n\tСтрокаВнутр = СтрЗаменить(СтрокаВнутр, ВременноеИмя, ПлохоеИмя);\r\n\t\r\n\tИсходнаяТаблица = ЗначениеИзСтрокиВнутр(СтрокаВнутр); // ТаблицаЗначений\r\n\tВозврат ИсходнаяТаблица; //@skip-check constructor-function-return-section - Баг ЕДТ - не понимает типизированный коммент\r\n\t\t\r\nКонецФункции\n\nОрфографическая ошибка в коммент: коммент"
  },
  {
    "title": "Запрос к нейросети ChatGPT",
    "description": "Запрос к нейросети ChatGPT",
    "code_snippet": "//Описание API https://beta.openai.com/docs/api-reference/\r\n\r\nПроцедура ЗапросКChatGPT(Текст)\r\n\t\r\n\tСоединение = Новый HTTPСоединение(\"api.openai.com\",,,,,,Новый ЗащищенноеСоединениеOpenSSL());\r\n\t\t\r\n\tЗаголовки=Новый Соответствие();\r\n\tЗаголовки.Вставить(\"Content-Type\", \"application/json\");\r\n\tЗаголовки.Вставить(\"Authorization\", \"Bearer <Ваш API-Key>\");\r\n\t\r\n\tЗапрос = Новый HTTPЗапрос();\r\n\tЗапрос.АдресРесурса = \"v1/completions\";\r\n\tЗапрос.Заголовки = Заголовки;\r\n\t\t\r\n    ТелоЗапроса = \r\n    \"\r\n\t|{\r\n  |\"\"model\"\": \"\"text-davinci-003\"\",\r\n  |\"\"prompt\"\": \"\"\" + Текст+ \"\"\",\r\n  |\"\"max_tokens\"\": 100,\r\n  |\"\"temperature\"\": 0,\r\n  |\"\"top_p\"\": 1,\r\n  |\"\"n\"\": 1,\r\n  |\"\"stream\"\": false,\r\n  |\"\"logprobs\"\": null,\r\n  |\"\"stop\"\": \"\".\"\"\r\n  |}\";\r\n\t\r\n\tЗапрос.УстановитьТелоИзСтроки(ТелоЗапроса);\r\n\t\r\n\tОтвет=Соединение.ОтправитьДляОбработки(Запрос);\r\n\t\r\n\tКодСостояния=Ответ.КодСостояния;\r\n\tСтрокаОтвета=Ответ.ПолучитьТелоКакСтроку();\r\n\t\r\n\tЕсли КодСостояния=200 Тогда\r\n\t\t//Ответ в виде Json\r\n\t\tСообщить(СтрокаОтвета);\r\n\tИначе\r\n\t\t//Ошибка при выполнении запроса\r\n\tКонецЕсли;\t\t\r\n    \r\nКонецПроцедуры\n\n//Описание API https://beta.openai.com/docs/api-reference/\r\n\r\nПроцедура ЗапросКChatGPT(Текст)\r\n\t\r\n\tСоединение = Новый HTTPСоединение(\"api.openai.com\",,,,,,Новый ЗащищенноеСоединениеOpenSSL());\r\n\t\t\r\n\tЗаголовки=Новый Соответствие();\r\n\tЗаголовки.Вставить(\"Content-Type\", \"application/json\");\r\n\tЗаголовки.Вставить(\"Authorization\", \"Bearer <Ваш API-Key>\");\r\n\t\r\n\tЗапрос = Новый HTTPЗапрос();\r\n\tЗапрос.АдресРесурса = \"v1/completions\";\r\n\tЗапрос.Заголовки = Заголовки;\r\n\t\t\r\n    ТелоЗапроса = \r\n    \"\r\n\t|{\r\n  |\"\"model\"\": \"\"text-davinci-003\"\",\r\n  |\"\"prompt\"\": \"\"\" + Текст+ \"\"\",\r\n  |\"\"max_tokens\"\": 100,\r\n  |\"\"temperature\"\": 0,\r\n  |\"\"top_p\"\": 1,\r\n  |\"\"n\"\": 1,\r\n  |\"\"stream\"\": false,\r\n  |\"\"logprobs\"\": null,\r\n  |\"\"stop\"\": \"\".\"\"\r\n  |}\";\r\n\t\r\n\tЗапрос.УстановитьТелоИзСтроки(ТелоЗапроса);\r\n\t\r\n\tОтвет=Соединение.ОтправитьДляОбработки(Запрос);\r\n\t\r\n\tКодСостояния=Ответ.КодСостояния;\r\n\tСтрокаОтвета=Ответ.ПолучитьТелоКакСтроку();\r\n\t\r\n\tЕсли КодСостояния=200 Тогда\r\n\t\t//Ответ в виде Json\r\n\t\tСообщить(СтрокаОтвета);\r\n\tИначе\r\n\t\t//Ошибка при выполнении запроса\r\n\tКонецЕсли;\t\t\r\n    \r\nКонецПроцедуры\n\nОрфографическая ошибка в нейросети (найдено 2): нейросети\r\nОрфографическая ошибка в openai: openai\r\nОрфографическая ошибка в davinci: davinci\r\nОрфографическая ошибка в logprobs: logprobs"
  },
  {
    "title": "Обмен с помощью Web - Сервисов. Новый (С примерами)",
    "description": "Обмен с помощью Web - Сервисов. Новый (С примерами)",
    "code_snippet": "///Параметры - Тип: \"строка\"\nФункция ПолучитьСписокНоменклатуры(Параметры)\n\t\n\t///Параметры - Это будет Структура, сериализованная в строку XML.\n\t///поэтому конвертируем его обратно в структуру.\n\t\n\tЧтениеXMLДанных = Новый ЧтениеXML;\n\tЧтениеXMLДанных.УстановитьСтроку(Параметры);\n\tСтруктураПараметров = СериализаторXDTO.ПрочитатьXML(ЧтениеXMLДанных);\n\tЧтениеXMLДанных.Закрыть();  \n\n\t\n\t/// Основная процедура вынесена в общие модуле, так как Синтаксис ошибкок в этом модуле не работает\n\tВозврат ОбменДанными.ПолучитьСписокНоменклатурыXML(СтруктураПараметров);\n\nКонецФункции\n\n\n//// Общий модуль: ОбменДанными\nФункция ПолучитьСписокНоменклатурыXML(СтруктураПараметров) Экспорт\n\n\tДобавлятьШтрихКод \t= Ложь;\n\t\n\t/// если в параметрах указано свойство \"Штрихкод\" - используем его значение \n\tСтруктураПараметров.Свойство(\"ШтрихКод\",ДобавлятьШтрихКод);\n\t\n\t\n\n\tЗапрос = Новый Запрос;\n\tЗапрос.Текст = \n\t\t\"ВЫБРАТЬ\n\t\t|\tНоменклатура.Код КАК Код,\n\t\t|\tНоменклатура.Наименование КАК Наименование,\n\t\t|\tНоменклатура.ЕдиницаДляОтчетов.Наименование КАК ЕдиницаДляОтчетовНаименование,\n\t\t|\tНоменклатура.ЕдиницаДляОтчетов.Вес КАК ЕдиницаДляОтчетовВес,\n\t\t|\tНоменклатура.ЕдиницаДляОтчетов.Объем КАК ЕдиницаДляОтчетовОбъем,\n\t\t|\tНоменклатура.ЕдиницаДляОтчетов.Коэффициент КАК ЕдиницаДляОтчетовКоэффициент,\n\t\t|\tНоменклатура.ЭтоГруппа КАК ЭтоГруппа,\n\t\t|\tНоменклатура.ПометкаУдаления КАК ПометкаУдаления,\n\t\t|\tНоменклатура.Ссылка КАК Ссылка,\n\t\t|\tНоменклатура.ЕдиницаДляОтчетов.Ссылка КАК ЕдиницаДляОтчетовСсылка\n\t\t|ИЗ\n\t\t|\tСправочник.Номенклатура КАК Номенклатура\n\t\t|ГДЕ\n\t\t|\tНоменклатура.Ссылка В ИЕРАРХИИ(&Родитель)\n\t\t|\tИ Номенклатура.ПометкаУдаления = ЛОЖЬ\";\n\t\n\tЗапрос.УстановитьПараметр(\"Родитель\", Родитель);\n\t\n\tРезультатЗапроса = Запрос.Выполнить();\n\t\n\tВыборка = РезультатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);\n\t\n\t//Весь список номенклатуры буден помещен в массив\n\tОбъектСписок = новый Массив;\n\n\tПока Выборка.Следующий() Цикл\n\t\t\n\t\t//Каждую номенклатуру помещаем в струткуру\n\t\tДанныеНоменклатуры = новый Структура(\"Код, Наименование, Ссылка, ЭтоГруппа, Родитель, ЕдиницаИзмерения, ШтрихКоды\",\n\t\t \t\t\t\t\t\tВыборка.Код, Выборка.Наименование,XMLСтрока(Выборка.Ссылка),Выборка.Ссылка.ЭтоГруппа,,,); \n\t\t\t\t\t\t\t\t\n\t\t//Если есть родитель, то создаем рекурсивно родителя\n\t\tЕсли НЕ Выборка.Ссылка.Родитель.Пустая() Тогда\n\t\t\tДанныеНоменклатуры.Родитель =  ДобавитьРодителей(Выборка.Ссылка.Родитель);\n\t\tКонецЕсли;\n\t\t\n\t\t//Создаем Единицу измерения в виде структуры\n\t\tЕсли НЕ Выборка.Ссылка.ЭтоГруппа Тогда\n\n\t\t\tЕсли НЕ Выборка.Ссылка.ЕдиницаДляОтчетов.Пустая() Тогда\n\t            ДанныеЕдиницыИзмерения = новый Структура(\"Код, Наименование, Ссылка, Вес, Объем, Коэффициент\",  \n\t\t\t \t\t\t\tВыборка.ЕдиницаДляОтчетовСсылка.Код,Выборка.ЕдиницаДляОтчетовСсылка.Наименование,XMLСтрока(Выборка.ЕдиницаДляОтчетовСсылка),\n\t\t\t\t\t\t\tВыборка.ЕдиницаДляОтчетовСсылка.Вес,Выборка.ЕдиницаДляОтчетовСсылка.Объем,Выборка.ЕдиницаДляОтчетовСсылка.Коэффициент);\n\t\t\t\t\n\t\t\t\tДанныеНоменклатуры.ЕдиницаИзмерения = ДанныеЕдиницыИзмерения;\n\t\t\tКонецЕсли;\n\t\t\t\n\t\t\tЕсли ДобавлятьШтрихКод Тогда\n\t\t\t\t///Штрихкодов может быть несколько, поэтому отдельно рисуем запрос на получения и добавляем в массив\n\t\t\t\tДанныеНоменклатуры.ШтрихКоды = ПолучитьШтрихКоды(Выборка.Ссылка);\n\t\t\tКонецЕсли;\t\n\t\tКонецЕсли;\t\n\t\t\n\t\tОбъектСписок.Добавить(ДанныеНоменклатуры);\n\t\n\tКонецЦикла;\n\t\n\tЗапись = Новый ЗаписьXML;\n\tЗапись.УстановитьСтроку(); \n\t\n\t//Преобразуем массив в объект XDTO\n\tМассивВОбъектеXDTO = СериализаторXDTO.ЗаписатьXDTO(ОбъектСписок);\n\t\n\t//Записываем объект XDTO в XML строку\n\tФабрикаXDTO.ЗаписатьXML(Запись, МассивВОбъектеXDTO); \n\t\n\tДанныеXML = Запись.Закрыть(); // документ готов!\n\t\n\t///Поместим данные в хранилище значений в сжатом виде\n\tХранилищеЗнч = новый ХранилищеЗначения(ДанныеXML,новый СжатиеДанных(9))\n\t\n\tВозврат ХранилищеЗнч;\n\t\nКонецФункции\n\nФункция ДобавитьРодителей(Родитель)\n\t\n\tДанныеРодителя = новый Структура(\"Код, Наименование, Ссылка, ЭтоГруппа, Родитель\",\n\t\t \t\t\t\t\t\tРодитель.Код, Родитель.Наименование,XMLСтрока(Родитель.Ссылка),Родитель.ЭтоГруппа,);\n\n\tЕсли НЕ Родитель.Родитель.Пустая() Тогда\n\t\tДанныеРодителя.Родитель = ДобавитьРодителей(Родитель.Родитель);\n\tКонецЕсли;\n\t\n\tВозврат ДанныеРодителя;\nКонецФункции\n\n\nФункция ПолучитьШтрихКоды(Владелец)\n\n\tЗапрос = Новый Запрос;\n\tЗапрос.Текст = \n\t\t\"ВЫБРАТЬ\n\t\t|\tШтрихкоды.Штрихкод КАК Штрихкод,\n\t\t|\tШтрихкоды.Владелец КАК Владелец\n\t\t|ИЗ\n\t\t|\tРегистрСведений.Штрихкоды КАК Штрихкоды\n\t\t|ГДЕ\n\t\t|\tШтрихкоды.Владелец = &Владелец\";\n\t\n\tЗапрос.УстановитьПараметр(\"Владелец\", Владелец);\n\tТЧ = Запрос.Выполнить().Выгрузить();\n\tЕсли ТЧ.Количество() = 0 Тогда\n\t\tвозврат новый Массив;\n\tКонецЕсли;\n\t\n\tВозврат ТЧ.ВыгрузитьКолонку(\"Штрихкод\");\n\t\t\nКонецФункции\n\nПроцедура ЗагрузитьНоменклатуру()  экспорт\t\n\t///----------данный кусок перенесен в справочник \"ПодключениеКWS\", чтобы не держать данные в модуле---<\n\tВСОпределение = Новый WSОпределения(\"127.1.1.1/Obmen/ws/Obmen.1cws?wsdl\", \"admin\", \"pass\"); \n\t//127.1.1.1 - ВашИПАдресГдеОпубликованWebСервис \n\t//admin - пользователь информационной базы с полными правами и пароль -pass\n\tВСПрокси = Новый WSПрокси(ВСОпределение, \"127.1.1.1\", \"Obmen\", \"ObmenSoap\");\n\t//127.1.1.1 - URl пространство имен Веб сервиса первой базы, Obmen -наименование \n\t// расширения ,\n\t//ObmenSoap тоже самое Но добавляем Soap к названии ))\n\t\n\tСклад= Элементы.Склад.Значение; //Элемент формы, выбранное поле - склад\n\tВремя=ТекущаяДата();\n\t\n\tВСПрокси.Пользователь = \"admin\";\n\tВСПрокси.Пароль = \"pass\";\n\t\n\t\n\t/// Добавим параметр: Штрихкод\t\n\tПараметрЗапроса = новый Структура;\n\tПараметрЗапроса.Вставить(\"Штрихкод\",Истина);\n\t\n\t/// Сериализуем структуру в строку.\n\tДокументВОбъектеXDTO = СериализаторXDTO.ЗаписатьXDTO(ПараметрЗапроса);\n\tМойXML = Новый ЗаписьXML;\n\tМойXML.УстановитьСтроку();\n\tФабрикаXDTO.ЗаписатьXML(МойXML, ДокументВОбъектеXDTO);\n\t\n\t\n\tПараметрЗапроса = МойXML.Закрыть();  \t\n\t\n\tХранилищеЗначений = ВСПрокси.ПолучитьСписокНоменклатуры(ПараметрЗапроса);  // подключаемся и получаем данные xml \t\n////--------------------------------------->\t \n/// ! для удобства добавил справочник \"ПодключениеКWS\" для заполнения настроек Веб сервисов, и получаю данные оттуда (Процедура ниже)\n\t    //Подключение = ПодключениеКWS();\n\t\t//ХранилищеЗначений = Подключение.ПолучитьСписокНоменклатуры(ПараметрЗапроса); \n\t\t\n\t\n\tТекстXML = ХранилищеЗначений.Получить();   \n\t\n\tЧтениеXML = новый ЧтениеXML;\n\tЧтениеXML.УстановитьСтроку(ТекстXML);\n\t\n\t/// Отключимся от БАЗЫ 1, так как данные уже получены. \n\t//Подключение = Неопределено;  \n\tВСПрокси = Неопределено;\n\t\n\tМассивНоменклатуры = СериализаторXDTO.ПрочитатьXML(ЧтениеXML);\n\t\n\tДля каждого Стр из МассивНоменклатуры Цикл\n\t\t\n\t\tНоменклатура = СоздатьНоменклатуру(Стр);\n\n\tКонецЦикла;  \n\t\n\nКонецПроцедуры   \n\n\n/// ОбъектНастроек = Справочник объект \"ПодключениеКWS\", используется для тетирования нового подключения до записи.  \nФункция ПодключениеКWS(ОбъектНастроек = Неопределено) Экспорт \n\t\n\tНастройки = Константы.НастройкиПодключения.Получить(); \t\t\n        \n\t\n\tЕсли ОбъектНастроек = Неопределено И Настройки.Пустая() Тогда\n\t\tВызватьИсключение(\"Не заполнены настройки подключения к веб сервисам!\");\n\tКонецЕсли;\n\t\n\tЕсли ОбъектНастроек <> Неопределено Тогда  ///Для тестов\n\t\tНастройки = ОбъектНастроек;\t\n\tКонецЕсли;\n\t\n\tМестоположениеWSDL \t\t\t= Настройки.IPАдрес +\"/\"+ Настройки.МестоположениеWSDL;\t\t\n\tИмяПользователя \t\t\t= Настройки.ИмяПользователя;\n\tПароль\t\t\t\t\t\t= Настройки.Пароль;            \t\t\n\tURIПространстваИменСервиса \t= Настройки.URIПространстваИмен; \t\n\tИмяСервиса\t\t\t\t\t= Настройки.ИмяСервиса;\t\t\t\t\t\n\t\t\n\tЗащищенноеСоединение = Новый ЗащищенноеСоединениеOpenSSL;            \n\t\n\tВСОпределение = Новый WSОпределения(МестоположениеWSDL, ИмяПользователя, Пароль,,,ЗащищенноеСоединение);        \t\n\tВСПрокси = Новый WSПрокси(ВСОпределение,URIПространстваИменСервиса , ИмяСервиса,ИмяСервиса+\"Soap\" );     \n\t\n\tВСПрокси.Пользователь = ИмяПользователя;\n\tВСПрокси.Пароль = Пароль;\n\t\t\n\tВозврат ВСПрокси;\n\nКонецФункции\n\n\nФункция СоздатьНоменклатуру(ДанныеНоменклатуры)   \n\t\n\t///Проверка на существование ссылки. Если ссылка найдена, пропускаем.\n\tСсылкаНоменклатуры = XMLЗначение(Тип(\"СправочникСсылка.Номенклатура\"),ДанныеНоменклатуры.Ссылка);  \n\t\n\t///Ссылка будет отображаться как битая, проверяем по реквизиту \"ВерсияДанных\"\n\tЕсли НЕ ЗначениеЗаполнено(СсылкаНоменклатуры.ВерсияДанных) Тогда   \n\t\t\n\t\tЕсли ДанныеНоменклатуры.ЭтоГруппа Тогда\n\t\t\tСПР = Справочники.Номенклатура.СоздатьГруппу();\n\t\tИначе\n\t\t\tСПР = Справочники.Номенклатура.СоздатьЭлемент();    \n\t\tКонецЕсли;  \n\t\tСПР.УстановитьСсылкуНового(СсылкаНоменклатуры);\n\tИначе\t\t\n\t\tСПР \t\t\t\t= СсылкаНоменклатуры.ПолучитьОбъект(); \n\tКонецЕсли;\n\n\tСПР.Код \t\t\t= ДанныеНоменклатуры.Код;     \n\tСПР.Наименование \t= ДанныеНоменклатуры.Наименование; \n\t\t\n\t///Если есть родитель, сначала нужно создать родителя, и так до самого корня начала\n\tЕсли ДанныеНоменклатуры.Родитель <> Неопределено Тогда\n\t\tСПР.Родитель \t\t= СоздатьНоменклатуру(ДанныеНоменклатуры.Родитель);\t\n\tКонецЕсли;\n\t\t\t\t\t\n\tСПР.Записать();\n\t\t\t\n\tЕсли НЕ СПР.ЭтоГруппа Тогда \n\t\t\t\n\t\tЕсли ДанныеНоменклатуры.ЕдиницаИзмерения <> Неопределено Тогда\n\t\t\tНоваяЕД = СоздатьЕдиницуИзмерения(ДанныеНоменклатуры.ЕдиницаИзмерения,СПР.Ссылка);\t\t\t\t\t\n\t\t\tСПР.БазоваяЕдиницаИзмерения = НоваяЕД.Наименование;\n\t\t\tСПР.ЕдиницаИзмерения \t\t= НоваяЕД.Ссылка;\n\t\t\t\t\t\n\t\t\tСПР.Записать();\n\t\tКонецЕсли; \n\t\t\t\n\t\tДля каждого ст из ДанныеНоменклатуры.ШтрихКоды цикл\n\t\t\tЗаписатьШтрихКод(СПР.Ссылка,ст);\n\t\tКонецЦикла;  \n\t\t\n\tКонецЕсли;\n\t\t\n\tВозврат СПР.Ссылка;\n  \t\t\nКонецФункции  \n\nПроцедура ЗаписатьШтрихКод(Владелец,ШтрихКод)\n\tМенеджерЗаписи = РегистрыСведений.Штрихкоды.СоздатьМенеджерЗаписи();\n\t\n\tМенеджерЗаписи.Владелец = Владелец;\n\tМенеджерЗаписи.ШтрихКод = ШтрихКод;\n\n\tМенеджерЗаписи.Записать();\nКонецПроцедуры\n\nФункция СоздатьЕдиницуИзмерения(СтрокаДанных,Владелец) \n\t\n\tСсылкаЕД = XMLЗначение(Тип(\"СправочникСсылка.ЕдиницаИзмерения\"),СтрокаДанных.Ссылка); \t\n\tЕсли НЕ ЗначениеЗаполнено(СсылкаЕД.ВерсияДанных) Тогда\n\t\tНоваяЕД = Справочники.ЕдиницаИзмерения.СоздатьЭлемент();\n\t\tНоваяЕД.УстановитьСсылкуНового(СсылкаЕД);\n\tИначе\t\n\t\tНоваяЕД = СсылкаЕД.ПолучитьОбъект();\n\tКонецЕсли; \t\n\t\n\tНоваяЕД.Код \t\t\t= СтрокаДанных.Код;\n\tНоваяЕД.Наименование   \t= СтрокаДанных.Наименование; \n\tНоваяЕД.Вес             = СтрокаДанных.Вес;\n\tНоваяЕД.Объем           = СтрокаДанных.Объем;\n\tНоваяЕД.Коэффициент     = СтрокаДанных.Коэффициент;\n\t\t\t\t\n\tНоваяЕД.Владелец \t\t= Владелец;  \n\tНоваяЕД.Записать(); \n\n\tВозврат НоваяЕД.Ссылка;\n\nКонецФункции"
  },
  {
    "title": "Проверка справочника или документа на модифицированность",
    "description": "Проверка справочника или документа на модифицированность",
    "code_snippet": "Функция ОбъектМодифицирован(Объект)\n\tМетаданныеОбъекта = Объект.Метаданные();\n\tЕсли Метаданные.Справочники.Содержит(МетаданныеОбъекта) Тогда\n\t\tВид = \"Справочник\";\n\tИначеЕсли Метаданные.Документы.Содержит(МетаданныеОбъекта) Тогда\n\t\tВид = \"Документ\";\n\tИначе\n\t\tВызватьИсключение СтрШаблон(\n\t\t\tНСтр(\"ru='Проверка модифицированности для объекта %1 не предусмотрена.'\"),\n\t\t\tМетаданныеОбъекта\n\t\t);\n\tКонецЕсли;\n\t\n\tЗапрос = Новый Запрос(\n\t\"ВЫБРАТЬ\n\t|\t*\n\t|ИЗ\n\t|\t\" + Вид + \".\" + МетаданныеОбъекта.Имя + \"\n\t|ГДЕ\n\t|\tСсылка = &Ссылка\");\n\tЗапрос.УстановитьПараметр(\"Ссылка\", Объект.Ссылка);\n\t\n\tРезультатЗапроса = Запрос.Выполнить();\n\tВозврат ПроверитьМодифицированностьРеквизитов(Объект, РезультатЗапроса, \"\");\nКонецФункции\n\nФункция ПроверитьМодифицированностьРеквизитов(Объект, РезультатЗапроса, Префикс)\n\tНеобрабатываемыеРеквизиты = СтрРазделить(\"Ссылка,НомерСтроки\", \",\");\n\t\n\tВыборка = РезультатЗапроса.Выбрать();\n\tНомерСтроки = 0;\n\tПока Выборка.Следующий() Цикл\n\t\tТабличнаяЧасть = ?(Не ПустаяСтрока(Префикс), Объект[Префикс], Неопределено); \n\t\tЕсли ТабличнаяЧасть <> Неопределено И Выборка.Количество() <> ТабличнаяЧасть.Количество() Тогда\n\t\t\tВозврат Истина;\n\t\tКонецЕсли;\n\t\t\n\t\tНомерСтроки = НомерСтроки + 1;\n\t\tДля каждого Колонка Из РезультатЗапроса.Колонки Цикл\n\t\t\tЕсли НеобрабатываемыеРеквизиты.Найти(Колонка.Имя) <> Неопределено Тогда\n\t\t\t\tПродолжить;\n\t\t\tКонецЕсли;\n\t\t\t\n\t\t\tЗначениеДоРедактирования = Выборка[Колонка.Имя];\n\t\t\tТипЗначения = ТипЗнч(ЗначениеДоРедактирования);\n\t\t\tЕсли ТипЗначения = Тип(\"ХранилищеЗначения\") Тогда\n\t\t\t\t// ХранилищеЗначения не проверяем.\n\t\t\t\tПродолжить;\n\t\t\tИначеЕсли ТипЗначения = Тип(\"РезультатЗапроса\") Тогда\n\t\t\t\tЕсли ПроверитьМодифицированностьРеквизитов(Объект, ЗначениеДоРедактирования, Колонка.Имя) Тогда\n\t\t\t\t\tВозврат Истина;\n\t\t\t\tКонецЕсли;\n\t\t\tИначе\n\t\t\t\tЗначениеПослеРедактирования = ?(ТабличнаяЧасть = Неопределено,\n\t\t\t\t\tОбъект[Колонка.Имя],\n\t\t\t\t\tТабличнаяЧасть[НомерСтроки - 1][Колонка.Имя]\n\t\t\t\t);\n\t\t\t\tЕсли ЗначениеДоРедактирования <> ЗначениеПослеРедактирования Тогда\n\t\t\t\t\tВозврат Истина;\n\t\t\t\tКонецЕсли;\n\t\t\tКонецЕсли;\n\t\tКонецЦикла;\n\tКонецЦикла;\n\t\n\tВозврат Ложь;\nКонецФункции"
  },
  {
    "title": "Копирование файлов",
    "description": "Копирование файлов",
    "code_snippet": "Процедура СкопироватьФайлы(Знач Источник, Знач Приемник)\n\tКаталогПриемник = Новый Файл(Приемник);\n\tЕсли Не КаталогПриемник.Существует() Тогда\n\t\tСоздатьКаталог(КаталогПриемник.ПолноеИмя);\n\tКонецЕсли;\n\t\n\tФайлы = НайтиФайлы(Источник, \"*.*\", Ложь);\n\tДля каждого Файл Из Файлы Цикл\n\t\tПолноеИмяПриемника = КаталогПриемник.ПолноеИмя + \"\\\" + Файл.Имя;\n\t\tЕсли Файл.ЭтоКаталог() Тогда\n\t\t\tСкопироватьФайлы(Файл.ПолноеИмя, ПолноеИмяПриемника);\n\t\tИначе\n\t\t\tКопироватьФайл(Файл.ПолноеИмя, ПолноеИмяПриемника);\n\t\tКонецЕсли;\n\tКонецЦикла;\nКонецПроцедуры\n\nАсинх Процедура СкопироватьФайлыАсинх(Знач Источник, Знач Приемник)\n\tКаталогПриемник = Новый Файл(Приемник);\n\tЕсли Не Ждать КаталогПриемник.СуществуетАсинх() Тогда\n\t\tЖдать СоздатьКаталогАсинх(КаталогПриемник.ПолноеИмя);\n\tКонецЕсли;\n\t\n\tФайлы = Ждать НайтиФайлыАсинх(Источник, \"*.*\", Ложь);\n\tДля каждого Файл Из Файлы Цикл\n\t\tПолноеИмяПриемника = КаталогПриемник.ПолноеИмя + \"\\\" + Файл.Имя;\n\t\tЕсли Файл.ЭтоКаталог() Тогда\n\t\t\tСкопироватьФайлы(Файл.ПолноеИмя, ПолноеИмяПриемника);\n\t\tИначе\n\t\t\tЖдать КопироватьФайлАсинх(Файл.ПолноеИмя, ПолноеИмяПриемника);\n\t\tКонецЕсли;\n\tКонецЦикла;\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура НачатьКопированиеФайлов(Знач Источник, Знач Приемник, ОповещениеОЗавершении = Неопределено)\n\tКонтекст = Новый Структура;\n\tКонтекст.Вставить(\"Источник\", Источник);\n\tКонтекст.Вставить(\"Приемник\", Приемник);\n\tКонтекст.Вставить(\"ОповещениеОЗавершении\", ОповещениеОЗавершении);\n\tКаталогПриемник = Новый Файл(Приемник);\n\tОповещение = Новый ОписаниеОповещения(\"ПроверкаСуществованияКаталогаЗавершение\", ЭтотОбъект, Контекст);\n\tКаталогПриемник.НачатьПроверкуСуществования(Оповещение);\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ПроверкаСуществованияКаталогаЗавершение(Существует, Контекст) Экспорт\n\tЕсли Не Существует Тогда\n\t\tОповещение = Новый ОписаниеОповещения(\"СозданиеКаталогаЗавершение\", ЭтотОбъект, Контекст);\n\t\tНачатьСозданиеКаталога(Оповещение, Контекст.Приемник);\n\tИначе\n\t\tНачатьПоискФайловВИсточнике(Контекст);\n\tКонецЕсли;\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура СозданиеКаталогаЗавершение(ИмяКаталога, Контекст) Экспорт\n\tНачатьПоискФайловВИсточнике(Контекст);\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура НачатьПоискФайловВИсточнике(Контекст) Экспорт\n\tОповещение = Новый ОписаниеОповещения(\"ПоискФайловЗавершение\", ЭтотОбъект, Контекст);\n\tНачатьПоискФайлов(Оповещение, Контекст.Источник, \"*.*\", Ложь);\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ПоискФайловЗавершение(Файлы, Контекст) Экспорт\n\tКонтекст.Вставить(\"Файлы\", Файлы);\n\tНачатьКопированиеФайлаИзИсточника(Контекст);\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура НачатьКопированиеФайлаИзИсточника(Контекст) Экспорт\n\tЕсли Контекст.Файлы.Количество() = 0 Тогда\n\t\tЕсли Контекст.ОповещениеОЗавершении <> Неопределено Тогда\n\t\t\tВыполнитьОбработкуОповещения(Контекст.ОповещениеОЗавершении, Истина);\n\t\tКонецЕсли;\n\t\tВозврат;\n\tКонецЕсли;\n\t\n\tФайл = Контекст.Файлы[0];\n\tОповещение = Новый ОписаниеОповещения(\"ПроверкаЭтоКаталогЗавершение\", ЭтотОбъект, Контекст);\n\tФайл.НачатьПроверкуЭтоКаталог(Оповещение);\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ПроверкаЭтоКаталогЗавершение(ЭтоКаталог, Контекст) Экспорт\n\tПолноеИмяПриемника = Контекст.Приемник + \"\\\" + Контекст.Файлы[0].Имя;\n\tОповещение = Новый ОписаниеОповещения(\"КопированиеФайлаЗавершение\", ЭтотОбъект, Контекст);\n\t\n\tЕсли ЭтоКаталог Тогда\n\t\tНачатьКопированиеФайлов(Контекст.Файлы[0].ПолноеИмя, ПолноеИмяПриемника, Оповещение);\n\tИначе\n\t\tНачатьКопированиеФайла(Оповещение, Контекст.Файлы[0].ПолноеИмя, ПолноеИмяПриемника);\n\tКонецЕсли;\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура КопированиеФайлаЗавершение(Файл, Контекст) Экспорт\n\tКонтекст.Файлы.Удалить(0);\n\tНачатьКопированиеФайлаИзИсточника(Контекст);\nКонецПроцедуры"
  },
  {
    "title": "Функция сравнения значений (рекурсивно)",
    "description": "Функция сравнения значений (рекурсивно)",
    "code_snippet": "// Сравнивает значение с эталоном. Удобно использовать \n// для тестирования\n//\n// Параметры:\n//\tЗначение - Произвольный - значение, которое надо сравнить с эталонным\n//\tЭталон - Произвольный - эталонное значение, с которым будет сравниваться Значение\n//  ВызыватьИсключение - Булево, Строка - вызвать исключение если значение не соответствует эталону\n//\t\t\t\t\t\t\t\t          Если задана строка - она будт использована при вызове исключения в качестве первой строки\n// \t\t\t\t\t\t\t\t\t\t  (не обязательный) - по умолчанию Ложь (не вызывать)\n//\tСтрогоеСравнение - Булево - тип сравнения по умолчанию. \n//\t\t\t\t\t\t\t\tЛожь - проверять только наличие элементов эталона в значении\n//\t\t\t\t\t\t\t\tИстина - проверять полное соответствие значения эталону\n//\t\t\t\t\t\t\t\t(не обязательный) - по умолчанию Ложь\n//\tСтрогоеСравнениеМассивов - Булево, Неопределено - тип сравнения для массивов. Если Неопределено\n//\t\t\t\t\t\t\t\t\t\t\t\t\t используется параметр СтрогоеСравнение\n//\t\t\t\t\t\t\t\t\t\t\t\t\t (не обязательный) - по умолчание Неопределено\n//\tСтрогоеСравнениеСтруктур - Булево, Неопределено - тип сравнения для структур. Если Неопределено\n//\t\t\t\t\t\t\t\t\t\t\t\t\t используется параметр СтрогоеСравнение\n//\t\t\t\t\t\t\t\t\t\t\t\t\t (не обязательный) - по умолчание Неопределено\n//\tСтрогоеСравнениеСоответствий - Булево, Неопределено - тип сравнения для соответствий. Если Неопределено\n//\t\t\t\t\t\t\t\t\t\t\t\t\t используется параметр СтрогоеСравнение\n//\t\t\t\t\t\t\t\t\t\t\t\t\t (не обязательный) - по умолчание Неопределено\n//\n// Возвращаемое значение:\n//\tБулево, Строка - Истина - значение соответствует эталону\n//\t\t\t \t\tСтрока - описание несоответствия\n//\nФункция СравнитьЗначения(Значение, Эталон, ВызыватьИсключение=Ложь, СтрогоеСравнение=Ложь, СтрогоеСравнениеМассивов=Неопределено, СтрогоеСравнениеСтруктур=Неопределено, СтрогоеСравнениеСоответствий=Неопределено) Экспорт\n\t\n\tЕсли ТипЗнч(Значение) <> ТипЗнч(Эталон) Тогда\n\t\tРезультат = СтрШаблон(\"Тип значения: %1 не равен типу эталона: %2\", ТипЗнч(Значение), ТипЗнч(Эталон));\n\tИначеЕсли ТипЗнч(Значение) = Тип(\"Массив\") Тогда\n\t\t#Область СравнениеМассивов\n\t\tЕсли Значение.Количество() < Эталон.Количество() Тогда\n\t\t\tРезультат = СтрШаблон(\"Количество элементов в массиве (%1) меньше чем в эталоне (%2)\", Значение.Количество(), Эталон.Количество());\n\t\tИначеЕсли ?(СтрогоеСравнениеМассивов = Неопределено, СтрогоеСравнение, СтрогоеСравнениеМассивов) Тогда\n\t\t\t// Сравнить строго\n\t\t\tРезультат = Истина;\n\t\t\tЕсли Значение.Количество() <> Эталон.Количество() Тогда\n\t\t\t\tРезультат = СтрШаблон(\"Количество элементов в массиве (%1) не равно количеству в эталоне (%2)\", Значение.Количество(), Эталон.Количество());;\n\t\t\tИначе\n\t\t\t\tДля Индекс = 0 По Значение.Количество()-1 Цикл\n\t\t\t\t\tРезультатСравнения = СравнитьЗначения(Значение[Индекс], Эталон[Индекс], Ложь, СтрогоеСравнение, СтрогоеСравнениеМассивов, СтрогоеСравнениеСтруктур, СтрогоеСравнениеСоответствий);\n\t\t\t\t\tЕсли РезультатСравнения <> Истина  Тогда\n\t\t\t\t\t\tРезультат = СтрШаблон(\"Ошибка в элементе [%1]:\n\t\t\t\t\t\t\t\t|\", Индекс) + РезультатСравнения;\n\t\t\t\t\t\tПрервать;\n\t\t\t\t\tКонецЕсли;\n\t\t\t\tКонецЦикла;\n\t\t\tКонецЕсли;\n\t\tИначе\n\t\t\t// Сравнить не строго\n\t\t\tРезультат = Истина;\n\t\t\tИндекс = 0;\n\t\t\tДля Каждого ЭлементЭталона Из Эталон Цикл\n\t\t\t\tНайденЭлементЗначения = Ложь;\n\t\t\t\tДля Каждого ЭлементЗначения Из Значение Цикл\n\t\t\t\t\tЕсли Истина = СравнитьЗначения(ЭлементЗначения, ЭлементЭталона, Ложь, СтрогоеСравнение, СтрогоеСравнениеМассивов, СтрогоеСравнениеСтруктур, СтрогоеСравнениеСоответствий) Тогда\n\t\t\t\t\t\tНайденЭлементЗначения = Истина;\n\t\t\t\t\t\tПрервать;\n\t\t\t\t\tКонецЕсли;\n\t\t\t\tКонецЦикла;\n\t\t\t\tЕсли Не НайденЭлементЗначения Тогда\n\t\t\t\t\tРезультат = СтрШаблон(\"Элемент эталона [%1] не найден в массиве\", Индекс);\n\t\t\t\t\tПрервать;\n\t\t\t\tКонецЕсли; \n\t\t\t\tИндекс = Индекс + 1;\n\t\t\tКонецЦикла;\n\t\tКонецЕсли;        \n\t\t#КонецОбласти\n\tИначеЕсли ТипЗнч(Значение) = Тип(\"Структура\") Тогда\n\t\t#Область СравнениеСтруктур\n        Результат = Истина;\n\t\tЕсли Значение.Количество() < Эталон.Количество() Тогда\n\t\t\tРезультат = СтрШаблон(\"Количество полей в структуре (%1) меньше чем в эталоне (%2)\", Значение.Количество(), Эталон.Количество());\n\t\tИначеЕсли Истина\n\t\t\t\tИ ?(СтрогоеСравнениеСтруктур = Неопределено, СтрогоеСравнение, СтрогоеСравнениеСтруктур) \n\t\t\t\tИ Значение.Количество() <> Эталон.Количество() \n\t\t\tТогда \n\t\t\tРезультат = СтрШаблон(\"Количество полей в структуре (%1) не равно количеству в эталоне (%2)\", Значение.Количество(), Эталон.Количество());;\n\t\tИначе\n\t\t\tДля Каждого Элемент Из Эталон Цикл\n\t\t\t\tЕсли Значение.Свойство(Элемент.Ключ) Тогда\n\t\t\t\t\tРезультатСравнения = СравнитьЗначения(Значение[Элемент.Ключ], Элемент.Значение, Ложь, СтрогоеСравнение, СтрогоеСравнениеМассивов, СтрогоеСравнениеСтруктур, СтрогоеСравнениеСоответствий);\n\t\t\t\t\tЕсли РезультатСравнения <> Истина Тогда\n\t\t\t\t\t\tРезультат = СтрШаблон(\"Ошибка в поле %1:\n\t\t\t\t\t\t\t\t|\", Элемент.Ключ) + РезультатСравнения;\n\t\t\t\t\t\tПрервать;\n\t\t\t\t\tКонецЕсли;\n\t\t\t\tИначе\n\t\t\t\t\tРезультат = СтрШаблон(\"Поле %1 отсутсвует в структуре\", Элемент.Ключ);\n\t\t\t\tКонецЕсли;\n\t\t\tКонецЦикла;\n\t\tКонецЕсли;\n\t\t#КонецОбласти\n\tИначеЕсли ТипЗнч(Значение) = Тип(\"Соответствие\") Тогда\n\t\t#Область СравнениеСоответствий\n        Результат = Истина;\n\t\tЕсли Значение.Количество() < Эталон.Количество() Тогда\n\t\t\tРезультат = СтрШаблон(\"Количество записей в соответствии (%1) меньше чем в эталоне (%2)\", Значение.Количество(), Эталон.Количество());\n\t\tИначеЕсли Истина\n\t\t\t\tИ ?(СтрогоеСравнениеСоответствий = Неопределено, СтрогоеСравнение, СтрогоеСравнениеСоответствий) \n\t\t\t\tИ Значение.Количество() <> Эталон.Количество() \n\t\t\tТогда \n\t\t\tРезультат = СтрШаблон(\"Количество записей в соответствии (%1) не равно количеству в эталоне (%2)\", Значение.Количество(), Эталон.Количество());;\n\t\tИначе\n\t\t\tДля Каждого Элемент Из Эталон Цикл \n\t\t\t\tРезультатСравнения = СравнитьЗначения(Значение[Элемент.Ключ], Элемент.Значение, Ложь, СтрогоеСравнение, СтрогоеСравнениеМассивов, СтрогоеСравнениеСтруктур, СтрогоеСравнениеСоответствий);\n\t\t\t\tЕсли РезультатСравнения <> Истина Тогда\n\t\t\t\t\tРезультат = СтрШаблон(\"Ошибка в записи %1:\n\t\t\t\t\t\t\t|\", Элемент.Ключ) + РезультатСравнения;\n\t\t\t\t\tПрервать;\n\t\t\t\tКонецЕсли;\n\t\t\tКонецЦикла;   \n\t\tКонецЕсли;\n\t\t#КонецОбласти\n\tИначе               \n\t\tЕсли Значение <> Эталон Тогда\n\t\t\tРезультат = СтрШаблон(\"Значение (%1) не равно эталону (%2)\", Значение, Эталон);\n\t\tИначе\n\t\t\tРезультат = Истина;\n\t\tКонецЕсли;\n\tКонецЕсли;\n\t\n\tЕсли Результат <> Истина Тогда    \n\t\tЕсли ВызыватьИсключение = Истина Тогда\n\t\t\tВызватьИсключение Результат;  \n\t\tИначеЕсли ВызыватьИсключение <> Ложь Тогда\n\t\t\tВызватьИсключение ВызыватьИсключение + \"\n\t\t\t\t|\" + Результат; \n\t\tКонецЕсли;\n\tКонецЕсли;\n\t\n\tВозврат Результат;\nКонецФункции"
  },
  {
    "title": "История пользователя не обновляется, при программном добавлении события",
    "description": "История пользователя не обновляется, при программном добавлении события",
    "code_snippet": "ИсторияРаботыПользователя.Добавить(ПолучитьНавигационнуюСсылку(СсылкаНаФайл));\n\nИсторияРаботыПользователя.Получить()\n\nОрфографическая ошибка в нибудь: нибудь"
  },
  {
    "title": "Внешняя обработка с несколькими командами, добавляемая в регламентные задания",
    "description": "Внешняя обработка с несколькими командами, добавляемая в регламентные задания",
    "code_snippet": "#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда\n\n#Область СлужебныйПрограммныйИнтерфейс\n\nФункция СведенияОВнешнейОбработке() Экспорт\n\t\n\tПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(\"2.3.6.121\");\n\tПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка();\n\t\n\tПараметрыРегистрации.Наименование = \"Наименование обработки\"; // Как она будет написана в списке обработок\n\tПараметрыРегистрации.Версия = \"1.01.001\";\n\tПараметрыРегистрации.БезопасныйРежим = Ложь;\n\tПараметрыРегистрации.Информация = \"Текст описания обработки и команд\";\n\t\n\t//ПараметрыРегистрации.Назначение.Добавить(\"\");\n\t\n\tТипКомандыВызовСерверногоМетода = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\n\t\n\tДобавитьКоманду(ПараметрыРегистрации.Команды, \"Обработка 1 с параметром 1\", \"Обработка_1_Параметр_1\", ТипКомандыВызовСерверногоМетода, Истина);\n\tДобавитьКоманду(ПараметрыРегистрации.Команды, \"Обработка 1 с параметром 10\", \"Обработка_1_Параметр_10\", ТипКомандыВызовСерверногоМетода, Истина);\n\tДобавитьКоманду(ПараметрыРегистрации.Команды, \"Обработка 2 с параметром 1\", \"Обработка_1_Параметр_1\", ТипКомандыВызовСерверногоМетода, Истина);\n\t\n\tВозврат ПараметрыРегистрации;\n\t\nКонецФункции\n\nПроцедура ВыполнитьКоманду(ИмяКоманды) Экспорт\n\t\n\tЕсли ИмяКоманды = \"Обработка_1_Параметр_1\" Тогда\n\t\t\n\t\tПроцедураКоманды_1()\n\t\t\n\tИначеЕсли ИмяКоманды = \"Обработка_1_Параметр_10\" Тогда\n\t\t\n\t\tПроцедураКоманды_1(10)\n\t\t\n\tИначеЕсли ИмяКоманды = \"Обработка_2_Параметр_1\" Тогда\n\t\t\n\t\tДатаОбработки = НачалоДня(ТекущаяДатаСеанса());\n\t\t\n\t\tПроцедураКоманды_2(ДатаОбработки, 1)\n\t\t\n\tКонецЕсли;\n\t\nКонецПроцедуры\n\n#КонецОбласти\n\n#Область СлужебныеПроцедурыИФункции\n\nПроцедура ПроцедураКоманды_1(КоличествоДокументов = 1)\n\t// Тело процедуры\nКонецПроцедуры\n\nПроцедура ПроцедураКоманды_2(ДатаПроверки, КоличествоДокументов = 1)\n\t// Тело процедуры\nКонецПроцедуры\n\n//\n\nПроцедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование, ПоказыватьОповещение = Ложь, Модификатор = \"\")\n\tНоваяКоманда = ТаблицаКоманд.Добавить();\n\tНоваяКоманда.Представление = Представление;\n\tНоваяКоманда.Идентификатор = Идентификатор;\n\tНоваяКоманда.Использование = Использование;\n\tНоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;\n\tНоваяКоманда.Модификатор = Модификатор;\nКонецПроцедуры\n\n#КонецОбласти\n\n#Иначе\nВызватьИсключение НСтр(\"ru = 'Недопустимый вызов объекта на клиенте.'\");\n#КонецЕсли"
  },
  {
    "title": "Проверки объекта на изменения",
    "description": "Проверки объекта на изменения",
    "code_snippet": "Функция ОбъектМодифицирован(Объект, ПроверятьТабличныеЧасти = Истина, ПроверятьСтандартные = Истина) \r\n    \r\n\tСсылка = Объект.Ссылка;\r\n\tМетаданное = Ссылка.Метаданные();\r\n    \r\n\tДля каждого Реквизит из Метаданное.Реквизиты Цикл\r\n\t\tЕсли Объект[Реквизит.Имя] <> Ссылка[Реквизит.Имя] Тогда\r\n\t\t\tВозврат Истина;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n    \r\n\tЕсли ПроверятьСтандартные Тогда\r\n\t\tДля каждого Реквизит из Метаданное.СтандартныеРеквизиты Цикл\r\n\t\t\tЕсли Объект[Реквизит.Имя] <> Ссылка[Реквизит.Имя] Тогда\r\n\t\t\t\tВозврат Истина;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n    \r\n    \r\n    Если ПроверятьТабличныеЧасти Тогда\r\n        Для каждого ТЧ из Метаданное.ТабличныеЧасти Цикл\r\n            \r\n            Если Объект[ТЧ.Имя].Количество() <> Ссылка[ТЧ.Имя].Количество() Тогда\r\n                Возврат Истина;\r\n            КонецЕсли;\r\n                        \r\n            Для Индекс = 0 по Объект[ТЧ.Имя].Количество()-1 Цикл\r\n                ОбъектСтрокаТЧ = Объект[ТЧ.Имя][Индекс];\r\n                СсылкаСтрокаТЧ = Ссылка[ТЧ.Имя][Индекс];\r\n                Для каждого РеквизитТЧ из ТЧ.Реквизиты Цикл\r\n                    Если ОбъектСтрокаТЧ[РеквизитТЧ.Имя] <> СсылкаСтрокаТЧ[РеквизитТЧ.Имя] Тогда\r\n                        Возврат Истина;\r\n                    КонецЕсли;\r\n                КонецЦикла;\r\n            КонецЦикла;\r\n            \r\n        КонецЦикла;        \r\n    КонецЕсли;\r\n    \r\n    Возврат Ложь;\r\n    \r\nКонецФункции\n\nФункция ОбъектМодифицирован(Объект, ПроверятьТабличныеЧасти = Истина, ПроверятьСтандартные = Истина) \r\n    \r\n\tСсылка = Объект.Ссылка;\r\n\tМетаданное = Ссылка.Метаданные();\r\n    \r\n\tДля каждого Реквизит из Метаданное.Реквизиты Цикл\r\n\t\tЕсли Объект[Реквизит.Имя] <> Ссылка[Реквизит.Имя] Тогда\r\n\t\t\tВозврат Истина;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n    \r\n\tЕсли ПроверятьСтандартные Тогда\r\n\t\tДля каждого Реквизит из Метаданное.СтандартныеРеквизиты Цикл\r\n\t\t\tЕсли Объект[Реквизит.Имя] <> Ссылка[Реквизит.Имя] Тогда\r\n\t\t\t\tВозврат Истина;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n    \r\n    \r\n    Если ПроверятьТабличныеЧасти Тогда\r\n        Для каждого ТЧ из Метаданное.ТабличныеЧасти Цикл\r\n            \r\n            Если Объект[ТЧ.Имя].Количество() <> Ссылка[ТЧ.Имя].Количество() Тогда\r\n                Возврат Истина;\r\n            КонецЕсли;\r\n                        \r\n            Для Индекс = 0 по Объект[ТЧ.Имя].Количество()-1 Цикл\r\n                ОбъектСтрокаТЧ = Объект[ТЧ.Имя][Индекс];\r\n                СсылкаСтрокаТЧ = Ссылка[ТЧ.Имя][Индекс];\r\n                Для каждого РеквизитТЧ из ТЧ.Реквизиты Цикл\r\n                    Если ОбъектСтрокаТЧ[РеквизитТЧ.Имя] <> СсылкаСтрокаТЧ[РеквизитТЧ.Имя] Тогда\r\n                        Возврат Истина;\r\n                    КонецЕсли;\r\n                КонецЦикла;\r\n            КонецЦикла;\r\n            \r\n        КонецЦикла;        \r\n    КонецЕсли;\r\n    \r\n    Возврат Ложь;\r\n    \r\nКонецФункции\n\n{1} Высокая цикломатическая сложность: 20"
  },
  {
    "title": "Добавляем подменю со статусами в командную панель",
    "description": "Добавляем подменю со статусами в командную панель",
    "code_snippet": "#Область  ОбработчикиСобытий\r\n \r\n &НаСервере\r\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\r\n\tДобавитьЭлементыНаФорму();\r\nКонецПроцедуры\r\n\r\n#КонецОбласти  \r\n\r\n#Область  ВспомогательныеПроцедурыИФункции\r\n\r\n&НаСервере\r\nПроцедура ДобавитьЭлементыНаФорму()\r\n\t\r\n\t// 1.0. Добавляем на форму группу с видом Подменю: \"__ГруппаСтатус\";\r\n\tЕсли Элементы.Найти(\"__ГруппаСтатус\") = Неопределено Тогда\r\n\t\tНоваяГруппа = Элементы.Добавить(\"__ГруппаСтатус\", Тип(\"ГруппаФормы\"), ЭтотОбъект.КоманднаяПанель);\r\n\t\tНоваяГруппа.Заголовок = \"Установить статус\";\r\n\t\tНоваяГруппа.Вид = ВидГруппыФормы.Подменю; \r\n\t\t\r\n\t\tНоваяГруппа.ЦветРамки = WebЦвета.Черный;\r\n\t\tНоваяГруппа.ЦветФона = Новый Цвет(81, 103, 188);\r\n\t\tНоваяГруппа.ЦветТекстаЗаголовка = WebЦвета.Белый;\r\n\t\t\r\n\t\tНоваяГруппа.ШрифтЗаголовка = Новый Шрифт(, , Истина, , , , );\r\n\tКонецЕсли;\t\r\n\t\r\n\t//Элементы.Переместить(Элементы.__ГруппаСтатус, ЭтотОбъект.КоманднаяПанель, ЭтотОбъект.КоманднаяПанель.ПодчиненныеЭлементы.ФормаОбновить);\r\n\t// 1.1. Добавляем реквизит формы \"__АдресВоВременномХранилище\" (соответствие ИмяКоманды --- СсылкаНаЭлементСправочникаСтатусыКлиентов);\r\n\t//Для хранения адреса во временном хранилище, где хранится соответствие \"ИмяКоманды, СсылкаНаЭлементСправочникаСтатусыКлиентов\"\r\n\tЕсли Элементы.Найти(\"__АдресВременногоХранилища\") = Неопределено Тогда\r\n\t\tТипСтрока = Новый ОписаниеТипов(\"Строка\");\r\n\t\tРеквизитТекст = Новый РеквизитФормы(\"__АдресВременногоХранилища\", ТипСтрока);\r\n\t\tДобавляемыеРеквизиты = Новый Массив;\r\n\t\tДобавляемыеРеквизиты.Добавить(РеквизитТекст);\r\n\t\tИзменитьРеквизиты(ДобавляемыеРеквизиты);\r\n\tКонецЕсли;\r\n\t\r\n\t//1.2. Получаем статусы заказов поставщиков;\r\n\t// Справочник ---\tСтатусыКлиентов;\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tСтатусыКлиентов.Ссылка КАК Ссылка,\r\n\t\t|\tСтатусыКлиентов.Наименование КАК Наименование\r\n\t\t|ИЗ\r\n\t\t|\tСправочник.СтатусыКлиентов КАК СтатусыКлиентов\";\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборка = РезультатЗапроса.Выбрать();\r\n\t\r\n\tСоответствиеИменКомандСсылок = Новый Соответствие;\r\n\t\r\n\tПока Выборка.Следующий() Цикл\r\n\r\n\t\tНаименованиеСтатусаБезПробелов = СокрЛП(СтрЗаменить(Выборка.Наименование, \" \", \"\"));\r\n\r\n\t\t//1.3. Создаем команду;\r\n\t\tЕсли Команды.Найти(\"__УстановитьСтатус\" + НаименованиеСтатусаБезПробелов) = Неопределено Тогда\r\n\t\t\tНоваяКоманда = Команды.Добавить(\"__УстановитьСтатус\" + НаименованиеСтатусаБезПробелов);\r\n\t\t\tНоваяКоманда.Действие = \"ИзменитьСтатус\";\r\n\t\tКонецЕсли;\r\n\r\n\t\t//1.4. Создаем элемент формы;\r\n\t\tЕсли Элементы.Найти(\"__ИзменитьСтатус\" + НаименованиеСтатусаБезПробелов) = Неопределено Тогда\r\n\t\t\tНоваяКнопка = Элементы.Добавить(\"__ИзменитьСтатус\" + НаименованиеСтатусаБезПробелов, Тип(\"КнопкаФормы\"), Элементы.__ГруппаСтатус);\r\n\t\t\tНоваяКнопка.ИмяКоманды = \"__УстановитьСтатус\" + НаименованиеСтатусаБезПробелов; \r\n\t\t\tНоваяКнопка.Заголовок = Выборка.Наименование;\r\n\t\tКонецЕсли;\r\n\r\n\t\tСоответствиеИменКомандСсылок.Вставить(\"__УстановитьСтатус\" + НаименованиеСтатусаБезПробелов, Выборка.Ссылка);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t//1.5.  Сохраняем во временное хранилище СоответствиеИменКомандСсылок; \r\n\tНовыйУникальныйИдентификатор = Новый УникальныйИдентификатор();\r\n\tАдресВоВременномХранилище = ПоместитьВоВременноеХранилище(СоответствиеИменКомандСсылок, НовыйУникальныйИдентификатор);\r\n\t//1.6. Записываем адрес во временном хранилище в реквизит формы;\r\n\tЭтотОбъект.__АдресВременногоХранилища = АдресВоВременномХранилище;\t\r\n\t\r\nКонецПроцедуры // ДобавитьЭлементыНаФорму()\r\n\r\n&НаКлиенте\r\nПроцедура ИзменитьСтатус(Команда)\r\n\t\r\n\tВыбранныеКлиенты = Элементы.Список.ВыделенныеСтроки;\r\n\tЕсли ВыбранныеКлиенты <> Неопределено Тогда\r\n\t\t//1.7. Получаем из временного хранилища СоответствиеИменКомандСсылок; \r\n\t\tСоответствиеИменКомандСсылок = ПолучитьИзВременногоХранилища(ЭтотОбъект.__АдресВременногоХранилища);\r\n\t\t//1.8. Получаем выбранный статус;\r\n\t\tВыбранныйСтатус = СоответствиеИменКомандСсылок.Получить(Команда.Имя);\r\n\t\tИзменитьСтатусНаСервере(ВыбранныйСтатус, ВыбранныеКлиенты);\r\n\tКонецЕсли;\r\n\t//1.9. Оповещаем списки об изменении;\r\n\tОповеститьОбИзменении(Тип(\"СправочникСсылка.СтатусыКлиентов\"));\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ИзменитьСтатусНаСервере(ВыбранныйСтатус, ВыбранныеКлиентыМассив)\r\n\t\r\n\tДля каждого ТекущийКлиент Из ВыбранныеКлиентыМассив Цикл\r\n\t\tЕсли ТекущийКлиент.СтатусКлиента = ВыбранныйСтатус Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tОбъектКлиент = ТекущийКлиент.ПолучитьОбъект();\r\n\t\tОбъектКлиент.СтатусКлиента = ВыбранныйСтатус;\r\n\t\tОбъектКлиент.Записать();   \r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\r\n\r\n#КонецОбласти\n\n#Область  ОбработчикиСобытий\r\n \r\n &НаСервере\r\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\r\n\tДобавитьЭлементыНаФорму();\r\nКонецПроцедуры\r\n\r\n#КонецОбласти  \r\n\r\n#Область  ВспомогательныеПроцедурыИФункции\r\n\r\n&НаСервере\r\nПроцедура ДобавитьЭлементыНаФорму()\r\n\t\r\n\t// 1.0. Добавляем на форму группу с видом Подменю: \"__ГруппаСтатус\";\r\n\tЕсли Элементы.Найти(\"__ГруппаСтатус\") = Неопределено Тогда\r\n\t\tНоваяГруппа = Элементы.Добавить(\"__ГруппаСтатус\", Тип(\"ГруппаФормы\"), ЭтотОбъект.КоманднаяПанель);\r\n\t\tНоваяГруппа.Заголовок = \"Установить статус\";\r\n\t\tНоваяГруппа.Вид = ВидГруппыФормы.Подменю; \r\n\t\t\r\n\t\tНоваяГруппа.ЦветРамки = WebЦвета.Черный;\r\n\t\tНоваяГруппа.ЦветФона = Новый Цвет(81, 103, 188);\r\n\t\tНоваяГруппа.ЦветТекстаЗаголовка = WebЦвета.Белый;\r\n\t\t\r\n\t\tНоваяГруппа.ШрифтЗаголовка = Новый Шрифт(, , Истина, , , , );\r\n\tКонецЕсли;\t\r\n\t\r\n\t//Элементы.Переместить(Элементы.__ГруппаСтатус, ЭтотОбъект.КоманднаяПанель, ЭтотОбъект.КоманднаяПанель.ПодчиненныеЭлементы.ФормаОбновить);\r\n\t// 1.1. Добавляем реквизит формы \"__АдресВоВременномХранилище\" (соответствие ИмяКоманды --- СсылкаНаЭлементСправочникаСтатусыКлиентов);\r\n\t//Для хранения адреса во временном хранилище, где хранится соответствие \"ИмяКоманды, СсылкаНаЭлементСправочникаСтатусыКлиентов\"\r\n\tЕсли Элементы.Найти(\"__АдресВременногоХранилища\") = Неопределено Тогда\r\n\t\tТипСтрока = Новый ОписаниеТипов(\"Строка\");\r\n\t\tРеквизитТекст = Новый РеквизитФормы(\"__АдресВременногоХранилища\", ТипСтрока);\r\n\t\tДобавляемыеРеквизиты = Новый Массив;\r\n\t\tДобавляемыеРеквизиты.Добавить(РеквизитТекст);\r\n\t\tИзменитьРеквизиты(ДобавляемыеРеквизиты);\r\n\tКонецЕсли;\r\n\t\r\n\t//1.2. Получаем статусы заказов поставщиков;\r\n\t// Справочник ---\tСтатусыКлиентов;\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tСтатусыКлиентов.Ссылка КАК Ссылка,\r\n\t\t|\tСтатусыКлиентов.Наименование КАК Наименование\r\n\t\t|ИЗ\r\n\t\t|\tСправочник.СтатусыКлиентов КАК СтатусыКлиентов\";\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборка = РезультатЗапроса.Выбрать();\r\n\t\r\n\tСоответствиеИменКомандСсылок = Новый Соответствие;\r\n\t\r\n\tПока Выборка.Следующий() Цикл\r\n\r\n\t\tНаименованиеСтатусаБезПробелов = СокрЛП(СтрЗаменить(Выборка.Наименование, \" \", \"\"));\r\n\r\n\t\t//1.3. Создаем команду;\r\n\t\tЕсли Команды.Найти(\"__УстановитьСтатус\" + НаименованиеСтатусаБезПробелов) = Неопределено Тогда\r\n\t\t\tНоваяКоманда = Команды.Добавить(\"__УстановитьСтатус\" + НаименованиеСтатусаБезПробелов);\r\n\t\t\tНоваяКоманда.Действие = \"ИзменитьСтатус\";\r\n\t\tКонецЕсли;\r\n\r\n\t\t//1.4. Создаем элемент формы;\r\n\t\tЕсли Элементы.Найти(\"__ИзменитьСтатус\" + НаименованиеСтатусаБезПробелов) = Неопределено Тогда\r\n\t\t\tНоваяКнопка = Элементы.Добавить(\"__ИзменитьСтатус\" + НаименованиеСтатусаБезПробелов, Тип(\"КнопкаФормы\"), Элементы.__ГруппаСтатус);\r\n\t\t\tНоваяКнопка.ИмяКоманды = \"__УстановитьСтатус\" + НаименованиеСтатусаБезПробелов; \r\n\t\t\tНоваяКнопка.Заголовок = Выборка.Наименование;\r\n\t\tКонецЕсли;\r\n\r\n\t\tСоответствиеИменКомандСсылок.Вставить(\"__УстановитьСтатус\" + НаименованиеСтатусаБезПробелов, Выборка.Ссылка);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t//1.5.  Сохраняем во временное хранилище СоответствиеИменКомандСсылок; \r\n\tНовыйУникальныйИдентификатор = Новый УникальныйИдентификатор();\r\n\tАдресВоВременномХранилище = ПоместитьВоВременноеХранилище(СоответствиеИменКомандСсылок, НовыйУникальныйИдентификатор);\r\n\t//1.6. Записываем адрес во временном хранилище в реквизит формы;\r\n\tЭтотОбъект.__АдресВременногоХранилища = АдресВоВременномХранилище;\t\r\n\t\r\nКонецПроцедуры // ДобавитьЭлементыНаФорму()\r\n\r\n&НаКлиенте\r\nПроцедура ИзменитьСтатус(Команда)\r\n\t\r\n\tВыбранныеКлиенты = Элементы.Список.ВыделенныеСтроки;\r\n\tЕсли ВыбранныеКлиенты <> Неопределено Тогда\r\n\t\t//1.7. Получаем из временного хранилища СоответствиеИменКомандСсылок; \r\n\t\tСоответствиеИменКомандСсылок = ПолучитьИзВременногоХранилища(ЭтотОбъект.__АдресВременногоХранилища);\r\n\t\t//1.8. Получаем выбранный статус;\r\n\t\tВыбранныйСтатус = СоответствиеИменКомандСсылок.Получить(Команда.Имя);\r\n\t\tИзменитьСтатусНаСервере(ВыбранныйСтатус, ВыбранныеКлиенты);\r\n\tКонецЕсли;\r\n\t//1.9. Оповещаем списки об изменении;\r\n\tОповеститьОбИзменении(Тип(\"СправочникСсылка.СтатусыКлиентов\"));\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ИзменитьСтатусНаСервере(ВыбранныйСтатус, ВыбранныеКлиентыМассив)\r\n\t\r\n\tДля каждого ТекущийКлиент Из ВыбранныеКлиентыМассив Цикл\r\n\t\tЕсли ТекущийКлиент.СтатусКлиента = ВыбранныйСтатус Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tОбъектКлиент = ТекущийКлиент.ПолучитьОбъект();\r\n\t\tОбъектКлиент.СтатусКлиента = ВыбранныйСтатус;\r\n\t\tОбъектКлиент.Записать();   \r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\r\n\r\n#КонецОбласти"
  },
  {
    "title": "Программная установка условного оформления (УО) поля динамического списка",
    "description": "Программная установка условного оформления (УО) поля динамического списка",
    "code_snippet": "Процедура НазваниеПроцедуры(УсловноеОформление, ТаблицаЗначений = Неопределено, НомерПриОтображении = Неопределено, Цвет = Неопределено) Экспорт\r\n\t\r\n\tЕсли  УсловноеОформление.Элементы.Количество() = 0  Тогда\r\n\t\t//ПриСозданииНаСервере => Перед вызовом функции чистим Элементы УО:  УсловноеОформление.Элементы.Очистить();\r\n\t\t//Секция: Какое условное оформление нужно задать при генерации формы на сервере?\r\n\t\tДля каждого Строка Из ТаблицаЗначений Цикл\r\n\t\t\r\n\t\t\tЭлементОформления \t= УсловноеОформление.Элементы.Добавить();  \r\n\t\t\t\r\n\t\t\tЭлементОтбора = ЭлементОформления.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n\t\t\tЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"Список.НомерПриОтображении\");\r\n\t\t\tЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно;\r\n\t\t\tЭлементОтбора.ПравоеЗначение = Строка.НомерПриОтображении;\r\n\t\t\tЭлементОтбора.Использование = Истина;\r\n\t\t\t\r\n\t\t\tОформляемоеПоле = ЭлементОформления.Поля.Элементы.Добавить(); \r\n\t\t\tОформляемоеПоле.Поле = Новый ПолеКомпоновкиДанных(\"Оформление\");\r\n\t\t\tОформляемоеПоле.Использование = Истина; \r\n\t\t\t\r\n                        //можем настроить любой параметр =>\r\n\t\t\tЭлементОформления.Оформление.УстановитьЗначениеПараметра(\"ЦветФона\", Строка.ЦветСтатуса); \r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\t//ПриИзменении цвета пользователем интерактивно;\r\n\t        //Секция: Какое условное оформление нужно задать при изменении элемента, установлении нового статуса, выполнении \r\n                //условия и т.п.\t\r\n\t\t\r\n\t\tДля каждого ЭлементУО Из УсловноеОформление.Элементы Цикл\r\n\t\t\tЕсли СтрНайти(ЭлементУО.Отбор, НомерПриОтображении) > 0 Тогда\r\n\t\t\t\tЭлементУО.Оформление.УстановитьЗначениеПараметра(\"ЦветФона\", Цвет); \r\n\t\t\tКонецЕсли;\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЕсли;\r\n\r\nКонецПроцедуры // ()\n\nПроцедура НазваниеПроцедуры(УсловноеОформление, ТаблицаЗначений = Неопределено, НомерПриОтображении = Неопределено, Цвет = Неопределено) Экспорт\r\n\t\r\n\tЕсли  УсловноеОформление.Элементы.Количество() = 0  Тогда\r\n\t\t//ПриСозданииНаСервере => Перед вызовом функции чистим Элементы УО:  УсловноеОформление.Элементы.Очистить();\r\n\t\t//Секция: Какое условное оформление нужно задать при генерации формы на сервере?\r\n\t\tДля каждого Строка Из ТаблицаЗначений Цикл\r\n\t\t\r\n\t\t\tЭлементОформления \t= УсловноеОформление.Элементы.Добавить();  \r\n\t\t\t\r\n\t\t\tЭлементОтбора = ЭлементОформления.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n\t\t\tЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"Список.НомерПриОтображении\");\r\n\t\t\tЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно;\r\n\t\t\tЭлементОтбора.ПравоеЗначение = Строка.НомерПриОтображении;\r\n\t\t\tЭлементОтбора.Использование = Истина;\r\n\t\t\t\r\n\t\t\tОформляемоеПоле = ЭлементОформления.Поля.Элементы.Добавить(); \r\n\t\t\tОформляемоеПоле.Поле = Новый ПолеКомпоновкиДанных(\"Оформление\");\r\n\t\t\tОформляемоеПоле.Использование = Истина; \r\n\t\t\t\r\n                        //можем настроить любой параметр =>\r\n\t\t\tЭлементОформления.Оформление.УстановитьЗначениеПараметра(\"ЦветФона\", Строка.ЦветСтатуса); \r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\t//ПриИзменении цвета пользователем интерактивно;\r\n\t        //Секция: Какое условное оформление нужно задать при изменении элемента, установлении нового статуса, выполнении \r\n                //условия и т.п.\t\r\n\t\t\r\n\t\tДля каждого ЭлементУО Из УсловноеОформление.Элементы Цикл\r\n\t\t\tЕсли СтрНайти(ЭлементУО.Отбор, НомерПриОтображении) > 0 Тогда\r\n\t\t\t\tЭлементУО.Оформление.УстановитьЗначениеПараметра(\"ЦветФона\", Цвет); \r\n\t\t\tКонецЕсли;\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЕсли;\r\n\r\nКонецПроцедуры // ()\n\nОрфографическая ошибка в засчет: засчет\r\nОрфографическая ошибка в офомления: офомления\r\nОрфографическая ошибка в хотелки: хотелки"
  },
  {
    "title": "Определение границы запрета изменения данных в УПП",
    "description": "Определение границы запрета изменения данных в УПП",
    "code_snippet": "СоответствиеГраницЗапрета = ПараметрыСеанса.ГраницыЗапретаИзмененияДанных.Получить();\r\nГраницаПериода = СоответствиеГраницЗапрета[Организация.Ссылка];\r\n\t\r\n// Если дата запрета по организации не определена, то используется основная дата запрета для пользователя\r\nЕсли НЕ ЗначениеЗаполнено(ГраницаПериода) Тогда\r\n    ГраницаПериода = СоответствиеГраницЗапрета[Справочники.Организации.ПустаяСсылка()];    \r\nКонецЕсли;\r\n\r\n// Если основная дата запрета для пользователя не определена, то используется общая дата запрета\r\nЕсли НЕ ЗначениеЗаполнено(ГраницаПериода) Тогда\r\n    ГраницаПериода = СоответствиеГраницЗапрета[\"ОбщаяДатаЗапретаРедактирования\"];\r\nКонецЕсли;\n\nСоответствиеГраницЗапрета = ПараметрыСеанса.ГраницыЗапретаИзмененияДанных.Получить();\r\nГраницаПериода = СоответствиеГраницЗапрета[Организация.Ссылка];\r\n\t\r\n// Если дата запрета по организации не определена, то используется основная дата запрета для пользователя\r\nЕсли НЕ ЗначениеЗаполнено(ГраницаПериода) Тогда\r\n    ГраницаПериода = СоответствиеГраницЗапрета[Справочники.Организации.ПустаяСсылка()];    \r\nКонецЕсли;\r\n\r\n// Если основная дата запрета для пользователя не определена, то используется общая дата запрета\r\nЕсли НЕ ЗначениеЗаполнено(ГраницаПериода) Тогда\r\n    ГраницаПериода = СоответствиеГраницЗапрета[\"ОбщаяДатаЗапретаРедактирования\"];\r\nКонецЕсли;\n\n{11} Переменной ГраницаПериода присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Заполнение информации о Контрагенте по ИНН через сервис api-fns.ru",
    "description": "Заполнение информации о Контрагенте по ИНН через сервис api-fns.ru",
    "code_snippet": "&НаКлиенте\r\nПроцедура ЗаполнитьПоИНН(Команда)\r\n\r\n\t //Проверка заполнения ИНН;\r\n\t Если НЕ ЗначениеЗаполнено(Объект.ИНН) Тогда\r\n\t\t \r\n\t\t Сообщение = Новый СообщениеПользователю;\r\n\t\t Сообщение.Текст = \"Значение реквизита не заполнено !\";\r\n\t\t Сообщение.Поле = \"ИНН\";\r\n\t\t Сообщение.Сообщить();\r\n\t\t Возврат;    \r\n\t\t \r\n\t КонецЕсли;\r\n\t \r\n\t //Создаем HTTPS-соединение, GET-запрос;\r\n\t hostname \t\t= \"api-fns.ru\";\r\n\t APIkey\t\t\t= \"СЮДА ВВОДИМ АПИ КЛЮЧ\";\r\n\t resourse \t\t= СтрШаблон(\"/api/egr?req=%1&key=%2+\", Объект.ИНН, APIkey);\r\n\t \r\n\t httpconn \t\t= Новый HTTPСоединение(hostname ,,,,, 5, Новый ЗащищенноеСоединениеOpenSSL());\r\n\t httprequest \t        = Новый HTTPЗапрос(resourse);\r\n\t \r\n\t Ответ = Неопределено;\r\n\t \r\n\tПопытка\r\n\t\r\n\t\tОтвет = httpconn.Получить(httprequest); \r\n\t\r\n\tИсключение\r\n\t\t\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \"Не удалось выполнить http запрос, код состояния:\" + Ответ.КодСостояния;\r\n\t\tСообщение.Сообщить();\r\n\t\tВозврат; \r\n\t\t\r\n\tКонецПопытки;\t\r\n\t\r\n\t//чтение ответа HTTP-сервера;\r\n\tСведенияJSON = Неопределено;\r\n\tПопытка\r\n\t\t\r\n\t\tЧтениеJSON = Новый ЧтениеJSON;\r\n\t\tЧтениеJSON.УстановитьСтроку(Ответ.ПолучитьТелоКакСтроку(КодировкаТекста.UTF8));\r\n\t\t\r\n\t\tСведенияJSON = ПрочитатьJSON(ЧтениеJSON, Истина);   \r\n\t\t\r\n\tИсключение \r\n\t\t\r\n\t\tВозврат;  \r\n\t\t\r\n\tКонецПопытки;\r\n\t\r\n\t//достаем из соответствия необходимую информацию;\t\r\n\tПопытка\r\n\t\tПолученноеЗначениеКПП \t\t\t\t= СведенияJSON[\"items\"][0][\"ЮЛ\"][\"КПП\"];\t\r\n\t\tПолученноеЗначениеНаименование \t        = СведенияJSON[\"items\"][0][\"ЮЛ\"][\"НаимСокрЮЛ\"];\t\r\n\t\tПолученноеЗначениеЮрЛицо \t\t\t=  СведенияJSON[\"items\"][0][\"ЮЛ\"][\"Адрес\"][\"АдресПолн\"];\r\n\tИсключение  \r\n\t\tСообщение \t\t= Новый СообщениеПользователю;\r\n\t\tСообщение.Текст \t= \"Произошла ошибка! Перепроверьте введенную информацию\";\r\n\t\tСообщение.Сообщить();\r\n\t\tВозврат;\r\n\tКонецПопытки;\r\n\t//произвольное кол-во реквизитов;\r\n\t\r\n\t//делаем проверку на расхождение полученных данных и данных контрагента;\r\n\tЕсли Объект.КПП <> ПолученноеЗначениеКПП \r\n\t\t\tИЛИ Объект.Наименование <> ПолученноеЗначениеНаименование \r\n\t\t\tИЛИ Объект.Наименование <> ПолученноеЗначениеНаименование Тогда\r\n\t\t\t\r\n\t\t//если расхождение есть, задаем вопрос:\t\r\n\t\tТекстВопроса = \"Для ИНН \"+ Объект.ИНН +\r\n\t\t\" в государственном реестре плательщиков соответствует юридическое лицо со следующими реквизитами:\r\n\t\t|\r\n\t\t|Наименование: \" + ПолученноеЗначениеНаименование + \"\r\n\t\t|КПП                : \" + ПолученноеЗначениеКПП + \"\r\n\t\t|ЮрАдрес\t\t: \" + ПолученноеЗначениеЮрЛицо + \"\r\n\t\t|Установить данные реквизиты для текущего контрагента?\";\r\n\t\t\r\n\t\tОтвет = Вопрос(ТекстВопроса, РежимДиалогаВопрос.ДаНет); \r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли  Ответ = КодВозвратаДиалога.Нет Тогда\r\n\t\t\r\n\t\tВозврат;\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tОбъект.КПП = ПолученноеЗначениеКПП;\r\n\t\tОбъект.Наименование = ПолученноеЗначениеНаименование;\r\n\t\t\r\n\t\tЮрАдресЗначение =  ПолучитьВидКонтактнойИнформацииЮрАдрес();\r\n\t\tСтруктураОтбора = Новый Структура(\"Вид\", ЮрАдресЗначение);\r\n\t\t\r\n\t\tМассивЗначений = Объект.КонтактнаяИнформация.НайтиСтроки(СтруктураОтбора);\r\n\t\t\r\n\t\tЕсли МассивЗначений.Количество() <> 0 Тогда\r\n\t\t   Объект.КонтактнаяИнформация.Удалить(МассивЗначений[0]);\r\n\t\tКонецЕсли;\r\n\t\r\n\t\tНоваяСтрокаТЧ = Объект.КонтактнаяИнформация.Добавить();\r\n\t\tНоваяСтрокаТЧ.Тип = ПолучитьТипКонтактнойИнформации();\r\n\t\tНоваяСтрокаТЧ.Вид = ЮрАдресЗначение;\r\n\t\tНоваяСтрокаТЧ.Значение = ПолученноеЗначениеЮрЛицо;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\n//вспомогательные функции;\r\n&НаСервереБезКонтекста\r\nФункция ПолучитьВидКонтактнойИнформацииЮрАдрес()\r\n\tВозврат Справочники.ВидыКонтактнойИнформации.ЮридическийАдресКонтрагента;\r\nКонецФункции // ()\r\n\r\n&НаСервереБезКонтекста\r\nФункция ПолучитьТипКонтактнойИнформации()\r\n\tВозврат Перечисления.ТипыКонтактнойИнформации.Адрес;\r\nКонецФункции // ()\n\n&НаКлиенте\r\nПроцедура ЗаполнитьПоИНН(Команда)\r\n\r\n\t //Проверка заполнения ИНН;\r\n\t Если НЕ ЗначениеЗаполнено(Объект.ИНН) Тогда\r\n\t\t \r\n\t\t Сообщение = Новый СообщениеПользователю;\r\n\t\t Сообщение.Текст = \"Значение реквизита не заполнено !\";\r\n\t\t Сообщение.Поле = \"ИНН\";\r\n\t\t Сообщение.Сообщить();\r\n\t\t Возврат;    \r\n\t\t \r\n\t КонецЕсли;\r\n\t \r\n\t //Создаем HTTPS-соединение, GET-запрос;\r\n\t hostname \t\t= \"api-fns.ru\";\r\n\t APIkey\t\t\t= \"СЮДА ВВОДИМ АПИ КЛЮЧ\";\r\n\t resourse \t\t= СтрШаблон(\"/api/egr?req=%1&key=%2+\", Объект.ИНН, APIkey);\r\n\t \r\n\t httpconn \t\t= Новый HTTPСоединение(hostname ,,,,, 5, Новый ЗащищенноеСоединениеOpenSSL());\r\n\t httprequest \t        = Новый HTTPЗапрос(resourse);\r\n\t \r\n\t Ответ = Неопределено;\r\n\t \r\n\tПопытка\r\n\t\r\n\t\tОтвет = httpconn.Получить(httprequest); \r\n\t\r\n\tИсключение\r\n\t\t\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \"Не удалось выполнить http запрос, код состояния:\" + Ответ.КодСостояния;\r\n\t\tСообщение.Сообщить();\r\n\t\tВозврат; \r\n\t\t\r\n\tКонецПопытки;\t\r\n\t\r\n\t//чтение ответа HTTP-сервера;\r\n\tСведенияJSON = Неопределено;\r\n\tПопытка\r\n\t\t\r\n\t\tЧтениеJSON = Новый ЧтениеJSON;\r\n\t\tЧтениеJSON.УстановитьСтроку(Ответ.ПолучитьТелоКакСтроку(КодировкаТекста.UTF8));\r\n\t\t\r\n\t\tСведенияJSON = ПрочитатьJSON(ЧтениеJSON, Истина);   \r\n\t\t\r\n\tИсключение \r\n\t\t\r\n\t\tВозврат;  \r\n\t\t\r\n\tКонецПопытки;\r\n\t\r\n\t//достаем из соответствия необходимую информацию;\t\r\n\tПопытка\r\n\t\tПолученноеЗначениеКПП \t\t\t\t= СведенияJSON[\"items\"][0][\"ЮЛ\"][\"КПП\"];\t\r\n\t\tПолученноеЗначениеНаименование \t        = СведенияJSON[\"items\"][0][\"ЮЛ\"][\"НаимСокрЮЛ\"];\t\r\n\t\tПолученноеЗначениеЮрЛицо \t\t\t=  СведенияJSON[\"items\"][0][\"ЮЛ\"][\"Адрес\"][\"АдресПолн\"];\r\n\tИсключение  \r\n\t\tСообщение \t\t= Новый СообщениеПользователю;\r\n\t\tСообщение.Текст \t= \"Произошла ошибка! Перепроверьте введенную информацию\";\r\n\t\tСообщение.Сообщить();\r\n\t\tВозврат;\r\n\tКонецПопытки;\r\n\t//произвольное кол-во реквизитов;\r\n\t\r\n\t//делаем проверку на расхождение полученных данных и данных контрагента;\r\n\tЕсли Объект.КПП <> ПолученноеЗначениеКПП \r\n\t\t\tИЛИ Объект.Наименование <> ПолученноеЗначениеНаименование \r\n\t\t\tИЛИ Объект.Наименование <> ПолученноеЗначениеНаименование Тогда\r\n\t\t\t\r\n\t\t//если расхождение есть, задаем вопрос:\t\r\n\t\tТекстВопроса = \"Для ИНН \"+ Объект.ИНН +\r\n\t\t\" в государственном реестре плательщиков соответствует юридическое лицо со следующими реквизитами:\r\n\t\t|\r\n\t\t|Наименование: \" + ПолученноеЗначениеНаименование + \"\r\n\t\t|КПП                : \" + ПолученноеЗначениеКПП + \"\r\n\t\t|ЮрАдрес\t\t: \" + ПолученноеЗначениеЮрЛицо + \"\r\n\t\t|Установить данные реквизиты для текущего контрагента?\";\r\n\t\t\r\n\t\tОтвет = Вопрос(ТекстВопроса, РежимДиалогаВопрос.ДаНет); \r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли  Ответ = КодВозвратаДиалога.Нет Тогда\r\n\t\t\r\n\t\tВозврат;\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tОбъект.КПП = ПолученноеЗначениеКПП;\r\n\t\tОбъект.Наименование = ПолученноеЗначениеНаименование;\r\n\t\t\r\n\t\tЮрАдресЗначение =  ПолучитьВидКонтактнойИнформацииЮрАдрес();\r\n\t\tСтруктураОтбора = Новый Структура(\"Вид\", ЮрАдресЗначение);\r\n\t\t\r\n\t\tМассивЗначений = Объект.КонтактнаяИнформация.НайтиСтроки(СтруктураОтбора);\r\n\t\t\r\n\t\tЕсли МассивЗначений.Количество() <> 0 Тогда\r\n\t\t   Объект.КонтактнаяИнформация.Удалить(МассивЗначений[0]);\r\n\t\tКонецЕсли;\r\n\t\r\n\t\tНоваяСтрокаТЧ = Объект.КонтактнаяИнформация.Добавить();\r\n\t\tНоваяСтрокаТЧ.Тип = ПолучитьТипКонтактнойИнформации();\r\n\t\tНоваяСтрокаТЧ.Вид = ЮрАдресЗначение;\r\n\t\tНоваяСтрокаТЧ.Значение = ПолученноеЗначениеЮрЛицо;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\n//вспомогательные функции;\r\n&НаСервереБезКонтекста\r\nФункция ПолучитьВидКонтактнойИнформацииЮрАдрес()\r\n\tВозврат Справочники.ВидыКонтактнойИнформации.ЮридическийАдресКонтрагента;\r\nКонецФункции // ()\r\n\r\n&НаСервереБезКонтекста\r\nФункция ПолучитьТипКонтактнойИнформации()\r\n\tВозврат Перечисления.ТипыКонтактнойИнформации.Адрес;\r\nКонецФункции // ()\n\nОрфографическая ошибка в редирект: редирект\r\nОрфографическая ошибка в hostname (найдено 2): hostname\r\nОрфографическая ошибка в resourse (найдено 2): resourse\r\nОрфографическая ошибка в httpconn (найдено 2): httpconn\r\nОрфографическая ошибка в httprequest (найдено 2): httprequest"
  },
  {
    "title": "Преобразование Объекта ДеревоЗначений в Объект ТаблицаЗначений",
    "description": "Преобразование Объекта ДеревоЗначений в Объект ТаблицаЗначений",
    "code_snippet": "&НаСервере\r\nФункция ДеревоЗначенийВТаблицуЗначений(Знач ДеревоЗначений)\r\n\t\r\n\tТаблицаТоваров = Новый ТаблицаЗначений;\r\n\t\r\n\t//заполним колонки;\r\n\tДля каждого Колонка Из ДеревоЗначений.Колонки Цикл\r\n\t\tТаблицаТоваров.Колонки.Добавить(Колонка.Имя); \r\n\tКонецЦикла;\r\n\t\r\n\t//произведем вызов вспомогательной рекурсивной функции;\r\n\tДля каждого Строка Из ДеревоЗначений.Строки Цикл\r\n\t\tРекурсивноеЗаполнениеТаблицыЗначений(ТаблицаТоваров, Строка);\r\n\tКонецЦикла;   \r\n\t\t\r\n\tВозврат ТаблицаТоваров;\r\n\t\r\nКонецФункции // ()\r\n\r\n&НаСервере\r\nПроцедура РекурсивноеЗаполнениеТаблицыЗначений(ТаблицаЗначений, СтрокаДерева)\r\n\t\r\n\t//условие выхода из рекурсии;\r\n\tЕсли СтрокаДерева.Строки.Количество () = 0 Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;  \r\n\t\r\n\tДля каждого Строка Из СтрокаДерева.Строки Цикл\r\n\t\t\r\n\t\tНоваяСтрока = ТаблицаЗначений.Добавить();\r\n\t\tДля каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\t\tНоваяСтрока[Колонка.Имя] = Строка[Колонка.Имя];\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tРекурсивноеЗаполнениеТаблицыЗначений(ТаблицаЗначений, Строка);   \r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры // ()\n\n&НаСервере\r\nФункция ДеревоЗначенийВТаблицуЗначений(Знач ДеревоЗначений)\r\n\t\r\n\tТаблицаТоваров = Новый ТаблицаЗначений;\r\n\t\r\n\t//заполним колонки;\r\n\tДля каждого Колонка Из ДеревоЗначений.Колонки Цикл\r\n\t\tТаблицаТоваров.Колонки.Добавить(Колонка.Имя); \r\n\tКонецЦикла;\r\n\t\r\n\t//произведем вызов вспомогательной рекурсивной функции;\r\n\tДля каждого Строка Из ДеревоЗначений.Строки Цикл\r\n\t\tРекурсивноеЗаполнениеТаблицыЗначений(ТаблицаТоваров, Строка);\r\n\tКонецЦикла;   \r\n\t\t\r\n\tВозврат ТаблицаТоваров;\r\n\t\r\nКонецФункции // ()\r\n\r\n&НаСервере\r\nПроцедура РекурсивноеЗаполнениеТаблицыЗначений(ТаблицаЗначений, СтрокаДерева)\r\n\t\r\n\t//условие выхода из рекурсии;\r\n\tЕсли СтрокаДерева.Строки.Количество () = 0 Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;  \r\n\t\r\n\tДля каждого Строка Из СтрокаДерева.Строки Цикл\r\n\t\t\r\n\t\tНоваяСтрока = ТаблицаЗначений.Добавить();\r\n\t\tДля каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\t\tНоваяСтрока[Колонка.Имя] = Строка[Колонка.Имя];\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tРекурсивноеЗаполнениеТаблицыЗначений(ТаблицаЗначений, Строка);   \r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры // ()\n\n&НаСервере\nПроцедура РекурсивноеЗаполнениеТЗ(ТаблицаЗначений, СтрокаДерева)\n\t\n\t//Добавление родительской строки\n\tНоваяСтрока = ТаблицаЗначений.Добавить();\n\tДля Каждого Колонка Из ТаблицаЗначений.Колонки Цикл\n\t\tНоваяСтрока[Колонка.Имя] = СтрокаДерева[Колонка.Имя]\n\tКонецЦикла;\n\t\n\t//Рекурсивно добавляем строки\n\tДля Каждого Строка Из СтрокаДерева.Строки Цикл\n\t\tРекурсивноеЗаполнениеТЗ(ТаблицаЗначений, Строка);\n\tКонецЦикла;\n\t\nКонецПроцедуры"
  },
  {
    "title": "Работа с универсальными коллекциями данных",
    "description": "Работа с универсальными коллекциями данных",
    "code_snippet": "&НаСервере\r\nФункция ТаблицаЗначенийВМассивСтруктур(Знач ТаблицаЗначений)  Экспорт\r\n\r\n\tМассивСтруктур = Новый Массив;\r\n\t\r\n\tМассивНаименованийКолонок = Новый Массив; \r\n\t\r\n\tДля каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tЕсли  МассивНаименованийКолонок.Найти(Колонка.Имя) = Неопределено Тогда\r\n\t\t\tМассивНаименованийКолонок.Добавить(Колонка.Имя);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля каждого Строка Из ТаблицаЗначений Цикл\r\n\t\t\r\n\t\tНоваяСтруктура = Новый Структура;\r\n\t\tДля каждого ЭлементМассива Из МассивНаименованийКолонок Цикл\r\n\t\t\tНоваяСтруктура.Вставить(ЭлементМассива, Строка[ЭлементМассива]);\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tМассивСтруктур.Добавить(НоваяСтруктура);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат МассивСтруктур;\r\n\t\r\nКонецФункции // ()\n\n&НаСервере\r\nФункция ТаблицаЗначенийВМассивСтруктур(Знач ТаблицаЗначений)  Экспорт\r\n\r\n\tМассивСтруктур = Новый Массив;\r\n\t\r\n\tМассивНаименованийКолонок = Новый Массив; \r\n\t\r\n\tДля каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tЕсли  МассивНаименованийКолонок.Найти(Колонка.Имя) = Неопределено Тогда\r\n\t\t\tМассивНаименованийКолонок.Добавить(Колонка.Имя);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля каждого Строка Из ТаблицаЗначений Цикл\r\n\t\t\r\n\t\tНоваяСтруктура = Новый Структура;\r\n\t\tДля каждого ЭлементМассива Из МассивНаименованийКолонок Цикл\r\n\t\t\tНоваяСтруктура.Вставить(ЭлементМассива, Строка[ЭлементМассива]);\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tМассивСтруктур.Добавить(НоваяСтруктура);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат МассивСтруктур;\r\n\t\r\nКонецФункции // ()"
  },
  {
    "title": "Unicode decode",
    "description": "Unicode decode",
    "code_snippet": "Функция UnicodeEncode(Строка) Экспорт\r\n\t\r\n\tРезультат = Строка; \r\n\t\r\n\tСписокСимволов = Новый СписокЗначений;\r\n\tСписокСимволов.Добавить(\"\\u0430\", \"а\");\r\n\tСписокСимволов.Добавить(\"\\u0431\", \"б\");\r\n\tСписокСимволов.Добавить(\"\\u0432\", \"в\");\r\n\tСписокСимволов.Добавить(\"\\u0433\", \"г\");\r\n\tСписокСимволов.Добавить(\"\\u0434\", \"д\");\r\n\tСписокСимволов.Добавить(\"\\u0435\", \"е\");\r\n\tСписокСимволов.Добавить(\"\\u0451\", Символ(1105));\r\n\tСписокСимволов.Добавить(\"\\u0436\", \"ж\");\r\n\tСписокСимволов.Добавить(\"\\u0437\", \"з\");\r\n\tСписокСимволов.Добавить(\"\\u0438\", \"и\");\r\n\tСписокСимволов.Добавить(\"\\u0439\", \"й\");\r\n\tСписокСимволов.Добавить(\"\\u043a\", \"к\");\r\n\tСписокСимволов.Добавить(\"\\u043b\", \"л\");\r\n\tСписокСимволов.Добавить(\"\\u043c\", \"м\");\r\n\tСписокСимволов.Добавить(\"\\u043d\", \"н\");\r\n\tСписокСимволов.Добавить(\"\\u043e\", \"о\");\r\n\tСписокСимволов.Добавить(\"\\u043f\", \"п\");\r\n\tСписокСимволов.Добавить(\"\\u0440\", \"р\");\r\n\tСписокСимволов.Добавить(\"\\u0441\", \"с\");\r\n\tСписокСимволов.Добавить(\"\\u0442\", \"т\");\r\n\tСписокСимволов.Добавить(\"\\u0443\", \"у\");\r\n\tСписокСимволов.Добавить(\"\\u0444\", \"ф\");\r\n\tСписокСимволов.Добавить(\"\\u0445\", \"х\");\r\n\tСписокСимволов.Добавить(\"\\u0446\", \"ц\");\r\n\tСписокСимволов.Добавить(\"\\u0447\", \"ч\");\r\n\tСписокСимволов.Добавить(\"\\u0448\", \"ш\");\r\n\tСписокСимволов.Добавить(\"\\u0448\", \"щ\");\r\n\tСписокСимволов.Добавить(\"\\u044a\", \"ъ\");\r\n\tСписокСимволов.Добавить(\"\\u044b\", \"ы\");\r\n\tСписокСимволов.Добавить(\"\\u044c\", \"ь\");\r\n\tСписокСимволов.Добавить(\"\\u044d\", \"э\");\r\n\tСписокСимволов.Добавить(\"\\u044e\", \"ю\");\r\n\tСписокСимволов.Добавить(\"\\u044f\", \"я\");\r\n\t\r\n\tСписокСимволов.Добавить(\"\\u0410\", \"А\");\r\n\tСписокСимволов.Добавить(\"\\u0411\", \"Б\");\r\n\tСписокСимволов.Добавить(\"\\u0412\", \"В\");\r\n\tСписокСимволов.Добавить(\"\\u0413\", \"Г\");\r\n\tСписокСимволов.Добавить(\"\\u0414\", \"Д\");\r\n\tСписокСимволов.Добавить(\"\\u0415\", \"Е\");\r\n\tСписокСимволов.Добавить(\"\\u0401\", Символ(1025));\r\n\tСписокСимволов.Добавить(\"\\u0416\", \"Ж\");\r\n\tСписокСимволов.Добавить(\"\\u0417\", \"З\");\r\n\tСписокСимволов.Добавить(\"\\u0418\", \"И\");\r\n\tСписокСимволов.Добавить(\"\\u0419\", \"Й\");\r\n\tСписокСимволов.Добавить(\"\\u041a\", \"К\");\r\n\tСписокСимволов.Добавить(\"\\u041b\", \"Л\");\r\n\tСписокСимволов.Добавить(\"\\u041c\", \"М\");\r\n\tСписокСимволов.Добавить(\"\\u041d\", \"Н\");\r\n\tСписокСимволов.Добавить(\"\\u041e\", \"О\");\r\n\tСписокСимволов.Добавить(\"\\u041f\", \"П\");\r\n\tСписокСимволов.Добавить(\"\\u0420\", \"Р\");\r\n\tСписокСимволов.Добавить(\"\\u0421\", \"С\");\r\n\tСписокСимволов.Добавить(\"\\u0422\", \"Т\");\r\n\tСписокСимволов.Добавить(\"\\u0423\", \"У\");\r\n\tСписокСимволов.Добавить(\"\\u0424\", \"Ф\");\r\n\tСписокСимволов.Добавить(\"\\u0425\", \"Х\");\r\n\tСписокСимволов.Добавить(\"\\u0426\", \"Ц\");\r\n\tСписокСимволов.Добавить(\"\\u0427\", \"Ч\");\r\n\tСписокСимволов.Добавить(\"\\u0428\", \"Ш\");\r\n\tСписокСимволов.Добавить(\"\\u0428\", \"Щ\");\r\n\tСписокСимволов.Добавить(\"\\u042a\", \"Ъ\");\r\n\tСписокСимволов.Добавить(\"\\u042b\", \"Ы\");\r\n\tСписокСимволов.Добавить(\"\\u042c\", \"Ь\");\r\n\tСписокСимволов.Добавить(\"\\u042d\", \"Э\");\r\n\tСписокСимволов.Добавить(\"\\u042e\", \"Ю\");\r\n\tСписокСимволов.Добавить(\"\\u042f\", \"Я\");\r\n\t\r\n\t\r\n\tСписокСимволов.Добавить(\"\\u0022\", \"'\");\r\n\t\r\n\tСписокСимволов.Добавить(\"\\u003E\", \">\");\r\n\tСписокСимволов.Добавить(\"\\u003е\", \">\");\r\n\t\r\n\tСписокСимволов.Добавить(\"\\u003C\", \"<\");\r\n\tСписокСимволов.Добавить(\"\\u003c\", \"<\");\r\n\t\r\n\tДля Каждого текЭлемент Из СписокСимволов Цикл\r\n\t\t\r\n\t\tРезультат = СтрЗаменить(Результат,текЭлемент.Значение, текЭлемент.Представление);\t\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\r\n\t\r\nФункция UnicodeEncode2(Строка) Экспорт \r\n    Результат = \"\";\r\n    Попытка\r\n        //регулярное выражение\r\n\r\n        Колекция = Новый Массив; //РегВыр.Execute(Строка);\r\n        Для Каждого Элемент Из Колекция Цикл\r\n            Если СтрДЛина(Элемент.value) = 1 Тогда\r\n                Продолжить;\r\n            КонецЕсли;        \r\n            \r\n            КодСимвола = ПереводЧислаИз16в10(Сред(ВРег(Элемент.value), 2));\r\n            Символ = Символ(КодСимвола);\r\n            Строка = СтрЗаменить(Строка, \"\\\" + Элемент.value, Символ); \r\n        КонецЦикла;\r\n        Результат = Строка; //СтрЗаменить(Строка, \"<br \\/>\", \"\");\r\n    Исключение\r\n        Результат = Строка;\r\n        Сообщить(\"Ошибка преобразования из Unicode\", СтатусСообщения.Информация);\r\n    КонецПопытки;\r\n    \r\n    Возврат Результат;\r\nКонецФункции\r\n\r\nФункция ПереводЧислаИз16в10(Знач Значение)\r\n\t    \r\n\t    \tСтруктураЧисел = Новый Соответствие;\r\n\t\tСтруктураЧисел.Вставить(\"0\", 0);\r\n\t\tСтруктураЧисел.Вставить(\"1\", 1);\r\n\t\tСтруктураЧисел.Вставить(\"2\", 2);\r\n\t\tСтруктураЧисел.Вставить(\"3\", 3);\r\n\t\tСтруктураЧисел.Вставить(\"4\", 4);\r\n\t\tСтруктураЧисел.Вставить(\"5\", 5);\r\n\t\tСтруктураЧисел.Вставить(\"6\", 6);\r\n\t\tСтруктураЧисел.Вставить(\"7\", 7);\r\n\t\tСтруктураЧисел.Вставить(\"8\", 8);\r\n\t\tСтруктураЧисел.Вставить(\"9\", 9);\r\n\t\tСтруктураЧисел.Вставить(\"A\", 10);\r\n\t\tСтруктураЧисел.Вставить(\"B\", 11);\r\n\t\tСтруктураЧисел.Вставить(\"C\", 12);\r\n\t\tСтруктураЧисел.Вставить(\"D\", 13);\r\n\t\tСтруктураЧисел.Вставить(\"E\", 14);\r\n\t\tСтруктураЧисел.Вставить(\"F\", 15);\r\n\t    \r\n\t    \r\n\t    Результат = 0;\r\n\t    \r\n\t    //перевод значения в строку\r\n\r\n\t    Если ТипЗнч(Значение) <> Тип(\"Строка\") Тогда\r\n\t        Значение = СокрЛП(Строка(Значение));\r\n\t    КонецЕсли;\r\n\t    \r\n\t    МаксРазрядЦелых = 0;\r\n\t    МаксРазрядЦелых = СтрДлина(Значение) - 1;\r\n\t    \r\n\t    н = МаксРазрядЦелых;\r\n\t    Ин = 1;\r\n\t    Пока н >= 0 Цикл\r\n\t        ТекЗначение = СтруктураЧисел.Получить(Сред(Значение, Ин, 1)) * Pow(16, н);\r\n\t        Результат = Результат + ТекЗначение;\r\n\t        н = н - 1;\r\n\t        Ин = Ин + 1;\r\n\t    КонецЦикла;\r\n\t    \r\n\t    Возврат Результат;\r\n\tКонецФункции\n\nФункция UnicodeEncode(Строка) Экспорт\r\n\t\r\n\tРезультат = Строка; \r\n\t\r\n\tСписокСимволов = Новый СписокЗначений;\r\n\tСписокСимволов.Добавить(\"\\u0430\", \"а\");\r\n\tСписокСимволов.Добавить(\"\\u0431\", \"б\");\r\n\tСписокСимволов.Добавить(\"\\u0432\", \"в\");\r\n\tСписокСимволов.Добавить(\"\\u0433\", \"г\");\r\n\tСписокСимволов.Добавить(\"\\u0434\", \"д\");\r\n\tСписокСимволов.Добавить(\"\\u0435\", \"е\");\r\n\tСписокСимволов.Добавить(\"\\u0451\", Символ(1105));\r\n\tСписокСимволов.Добавить(\"\\u0436\", \"ж\");\r\n\tСписокСимволов.Добавить(\"\\u0437\", \"з\");\r\n\tСписокСимволов.Добавить(\"\\u0438\", \"и\");\r\n\tСписокСимволов.Добавить(\"\\u0439\", \"й\");\r\n\tСписокСимволов.Добавить(\"\\u043a\", \"к\");\r\n\tСписокСимволов.Добавить(\"\\u043b\", \"л\");\r\n\tСписокСимволов.Добавить(\"\\u043c\", \"м\");\r\n\tСписокСимволов.Добавить(\"\\u043d\", \"н\");\r\n\tСписокСимволов.Добавить(\"\\u043e\", \"о\");\r\n\tСписокСимволов.Добавить(\"\\u043f\", \"п\");\r\n\tСписокСимволов.Добавить(\"\\u0440\", \"р\");\r\n\tСписокСимволов.Добавить(\"\\u0441\", \"с\");\r\n\tСписокСимволов.Добавить(\"\\u0442\", \"т\");\r\n\tСписокСимволов.Добавить(\"\\u0443\", \"у\");\r\n\tСписокСимволов.Добавить(\"\\u0444\", \"ф\");\r\n\tСписокСимволов.Добавить(\"\\u0445\", \"х\");\r\n\tСписокСимволов.Добавить(\"\\u0446\", \"ц\");\r\n\tСписокСимволов.Добавить(\"\\u0447\", \"ч\");\r\n\tСписокСимволов.Добавить(\"\\u0448\", \"ш\");\r\n\tСписокСимволов.Добавить(\"\\u0448\", \"щ\");\r\n\tСписокСимволов.Добавить(\"\\u044a\", \"ъ\");\r\n\tСписокСимволов.Добавить(\"\\u044b\", \"ы\");\r\n\tСписокСимволов.Добавить(\"\\u044c\", \"ь\");\r\n\tСписокСимволов.Добавить(\"\\u044d\", \"э\");\r\n\tСписокСимволов.Добавить(\"\\u044e\", \"ю\");\r\n\tСписокСимволов.Добавить(\"\\u044f\", \"я\");\r\n\t\r\n\tСписокСимволов.Добавить(\"\\u0410\", \"А\");\r\n\tСписокСимволов.Добавить(\"\\u0411\", \"Б\");\r\n\tСписокСимволов.Добавить(\"\\u0412\", \"В\");\r\n\tСписокСимволов.Добавить(\"\\u0413\", \"Г\");\r\n\tСписокСимволов.Добавить(\"\\u0414\", \"Д\");\r\n\tСписокСимволов.Добавить(\"\\u0415\", \"Е\");\r\n\tСписокСимволов.Добавить(\"\\u0401\", Символ(1025));\r\n\tСписокСимволов.Добавить(\"\\u0416\", \"Ж\");\r\n\tСписокСимволов.Добавить(\"\\u0417\", \"З\");\r\n\tСписокСимволов.Добавить(\"\\u0418\", \"И\");\r\n\tСписокСимволов.Добавить(\"\\u0419\", \"Й\");\r\n\tСписокСимволов.Добавить(\"\\u041a\", \"К\");\r\n\tСписокСимволов.Добавить(\"\\u041b\", \"Л\");\r\n\tСписокСимволов.Добавить(\"\\u041c\", \"М\");\r\n\tСписокСимволов.Добавить(\"\\u041d\", \"Н\");\r\n\tСписокСимволов.Добавить(\"\\u041e\", \"О\");\r\n\tСписокСимволов.Добавить(\"\\u041f\", \"П\");\r\n\tСписокСимволов.Добавить(\"\\u0420\", \"Р\");\r\n\tСписокСимволов.Добавить(\"\\u0421\", \"С\");\r\n\tСписокСимволов.Добавить(\"\\u0422\", \"Т\");\r\n\tСписокСимволов.Добавить(\"\\u0423\", \"У\");\r\n\tСписокСимволов.Добавить(\"\\u0424\", \"Ф\");\r\n\tСписокСимволов.Добавить(\"\\u0425\", \"Х\");\r\n\tСписокСимволов.Добавить(\"\\u0426\", \"Ц\");\r\n\tСписокСимволов.Добавить(\"\\u0427\", \"Ч\");\r\n\tСписокСимволов.Добавить(\"\\u0428\", \"Ш\");\r\n\tСписокСимволов.Добавить(\"\\u0428\", \"Щ\");\r\n\tСписокСимволов.Добавить(\"\\u042a\", \"Ъ\");\r\n\tСписокСимволов.Добавить(\"\\u042b\", \"Ы\");\r\n\tСписокСимволов.Добавить(\"\\u042c\", \"Ь\");\r\n\tСписокСимволов.Добавить(\"\\u042d\", \"Э\");\r\n\tСписокСимволов.Добавить(\"\\u042e\", \"Ю\");\r\n\tСписокСимволов.Добавить(\"\\u042f\", \"Я\");\r\n\t\r\n\t\r\n\tСписокСимволов.Добавить(\"\\u0022\", \"'\");\r\n\t\r\n\tСписокСимволов.Добавить(\"\\u003E\", \">\");\r\n\tСписокСимволов.Добавить(\"\\u003е\", \">\");\r\n\t\r\n\tСписокСимволов.Добавить(\"\\u003C\", \"<\");\r\n\tСписокСимволов.Добавить(\"\\u003c\", \"<\");\r\n\t\r\n\tДля Каждого текЭлемент Из СписокСимволов Цикл\r\n\t\t\r\n\t\tРезультат = СтрЗаменить(Результат,текЭлемент.Значение, текЭлемент.Представление);\t\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\r\n\t\r\nФункция UnicodeEncode2(Строка) Экспорт \r\n    Результат = \"\";\r\n    Попытка\r\n        //регулярное выражение\r\n\r\n        Колекция = Новый Массив; //РегВыр.Execute(Строка);\r\n        Для Каждого Элемент Из Колекция Цикл\r\n            Если СтрДЛина(Элемент.value) = 1 Тогда\r\n                Продолжить;\r\n            КонецЕсли;        \r\n            \r\n            КодСимвола = ПереводЧислаИз16в10(Сред(ВРег(Элемент.value), 2));\r\n            Символ = Символ(КодСимвола);\r\n            Строка = СтрЗаменить(Строка, \"\\\" + Элемент.value, Символ); \r\n        КонецЦикла;\r\n        Результат = Строка; //СтрЗаменить(Строка, \"<br \\/>\", \"\");\r\n    Исключение\r\n        Результат = Строка;\r\n        Сообщить(\"Ошибка преобразования из Unicode\", СтатусСообщения.Информация);\r\n    КонецПопытки;\r\n    \r\n    Возврат Результат;\r\nКонецФункции\r\n\r\nФункция ПереводЧислаИз16в10(Знач Значение)\r\n\t    \r\n\t    \tСтруктураЧисел = Новый Соответствие;\r\n\t\tСтруктураЧисел.Вставить(\"0\", 0);\r\n\t\tСтруктураЧисел.Вставить(\"1\", 1);\r\n\t\tСтруктураЧисел.Вставить(\"2\", 2);\r\n\t\tСтруктураЧисел.Вставить(\"3\", 3);\r\n\t\tСтруктураЧисел.Вставить(\"4\", 4);\r\n\t\tСтруктураЧисел.Вставить(\"5\", 5);\r\n\t\tСтруктураЧисел.Вставить(\"6\", 6);\r\n\t\tСтруктураЧисел.Вставить(\"7\", 7);\r\n\t\tСтруктураЧисел.Вставить(\"8\", 8);\r\n\t\tСтруктураЧисел.Вставить(\"9\", 9);\r\n\t\tСтруктураЧисел.Вставить(\"A\", 10);\r\n\t\tСтруктураЧисел.Вставить(\"B\", 11);\r\n\t\tСтруктураЧисел.Вставить(\"C\", 12);\r\n\t\tСтруктураЧисел.Вставить(\"D\", 13);\r\n\t\tСтруктураЧисел.Вставить(\"E\", 14);\r\n\t\tСтруктураЧисел.Вставить(\"F\", 15);\r\n\t    \r\n\t    \r\n\t    Результат = 0;\r\n\t    \r\n\t    //перевод значения в строку\r\n\r\n\t    Если ТипЗнч(Значение) <> Тип(\"Строка\") Тогда\r\n\t        Значение = СокрЛП(Строка(Значение));\r\n\t    КонецЕсли;\r\n\t    \r\n\t    МаксРазрядЦелых = 0;\r\n\t    МаксРазрядЦелых = СтрДлина(Значение) - 1;\r\n\t    \r\n\t    н = МаксРазрядЦелых;\r\n\t    Ин = 1;\r\n\t    Пока н >= 0 Цикл\r\n\t        ТекЗначение = СтруктураЧисел.Получить(Сред(Значение, Ин, 1)) * Pow(16, н);\r\n\t        Результат = Результат + ТекЗначение;\r\n\t        н = н - 1;\r\n\t        Ин = Ин + 1;\r\n\t    КонецЦикла;\r\n\t    \r\n\t    Возврат Результат;\r\n\tКонецФункции\n\n{146} Переменной МаксРазрядЦелых присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в юникоде (найдено 2): юникоде\r\nОрфографическая ошибка в вспом: вспом\r\nОрфографическая ошибка в Колекция (найдено 2): Колекция\n\nФункция ПереводЧислаИз16в10(Знач Число16)\n\tЦифры16 = \"0123456789ABCDEF\";\n\tРезультат = 0;\n\tДля Сч = 1 По СтрДлина(Число16) Цикл\n\t\tЦифра10 = СтрНайти(Цифры16, Сред(Число16, Сч, 1)) - 1;\n\t\tРезультат = Результат * 16 + Цифра10;\n\tКонецЦикла;\t\n\tВозврат Результат;\nКонецФункции\n\nФункция ПереводЧислаИз16в10(Знач Число16)\n\tВозврат ЧислоИзШестнадцатеричнойСтроки(\"0x\" + Число16)\nКонецФункции\n\nФункция UnicodeEncode(Строка)\n\tЧтениеJSON = Новый ЧтениеJSON;\n\tЧтениеJSON.УстановитьСтроку(\"\"\"\" + Строка + \"\"\"\");\n\tВозврат ПрочитатьJSON(ЧтениеJSON)\nКонецФункции"
  },
  {
    "title": "1с83. Шаблон кода для программной установки условного оформления поля динамического списка",
    "description": "1с83. Шаблон кода для программной установки условного оформления поля динамического списка",
    "code_snippet": "&НаКлиенте\r\nПроцедура УстановитьУсловноеОформлениеДляПоляСрокаГодности()\r\n\t\r\n\tЭлементОформления = СписокПартийДС.УсловноеОформление.Элементы.Добавить();\r\n\tЭлементОформления.Использование = Истина;\r\n\t\r\n\tПолеОформления = ЭлементОформления.Поля.Элементы.Добавить();\r\n\tПолеОформления.Использование = Истина;\r\n\tПолеОформления.Поле = Новый ПолеКомпоновкиДанных(\"ГоденДо\");\r\n\tПолеОформления = ЭлементОформления.Поля.Элементы.Добавить();\r\n\tПолеОформления.Использование = Истина;\r\n\t\r\n\tЭлементОтбора = ЭлементОформления.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n\tЭлементОтбора.Использование = истина;\r\n\tЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Меньше;\r\n\tЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"ГоденДо\");\r\n\tЭлементОтбора.ПравоеЗначение = ТекущаяДата() - 23668200;\r\n\t\r\n\tОформление = ЭлементОформления.Оформление;\r\n\tОформление.УстановитьЗначениеПараметра(Новый ПараметрКомпоновкиДанных(\"ЦветФона\"), WebЦвета.Коралловый);\r\n\t\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура УстановитьУсловноеОформлениеДляПоляСрокаГодности()\r\n\t\r\n\tЭлементОформления = СписокПартийДС.УсловноеОформление.Элементы.Добавить();\r\n\tЭлементОформления.Использование = Истина;\r\n\t\r\n\tПолеОформления = ЭлементОформления.Поля.Элементы.Добавить();\r\n\tПолеОформления.Использование = Истина;\r\n\tПолеОформления.Поле = Новый ПолеКомпоновкиДанных(\"ГоденДо\");\r\n\tПолеОформления = ЭлементОформления.Поля.Элементы.Добавить();\r\n\tПолеОформления.Использование = Истина;\r\n\t\r\n\tЭлементОтбора = ЭлементОформления.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n\tЭлементОтбора.Использование = истина;\r\n\tЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Меньше;\r\n\tЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"ГоденДо\");\r\n\tЭлементОтбора.ПравоеЗначение = ТекущаяДата() - 23668200;\r\n\t\r\n\tОформление = ЭлементОформления.Оформление;\r\n\tОформление.УстановитьЗначениеПараметра(Новый ПараметрКомпоновкиДанных(\"ЦветФона\"), WebЦвета.Коралловый);\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Получить нужные поля элемента справочника в виде структуры",
    "description": "Получить нужные поля элемента справочника в виде структуры",
    "code_snippet": "// Функция - Получить нужные поля элемента (без табличных частей)\n//\n// Параметры:\n//  пСсылка\t\t - Ссылка - Ссылка на элемент справочника\n//  СписокПолей\t - Строка - Список полей разделенных запятой\n// \n// Возврат:\n//  Структура - Структура с заполненными значениями запрошенных полей\n//\nФункция ПолучитьНужныеПоляЭлемента(пСсылка, СписокПолей = \"\") Экспорт\n\n\tТЗ = \"ВЫБРАТЬ ПЕРВЫЕ 1\n\t\t|\tТекСправочник.Ссылка КАК Ссылка{ТекстПоляЗапроса}\n\t\t|ИЗ\n\t\t|\tСправочник.ТекСправочник AS ТекСправочник\n\t\t|ГДЕ\n\t\t|\tТекСправочник.Ссылка = &Ссылка\";\n\tТекстШаблона = \",\n\t\t|\tТекСправочник.%1 КАК %1\";\n\tМассивСписокПолей = СтрРазделить(СписокПолей, \",\");\n\tДобавленныеПоля = Новый Массив;\n\tТекстПоляЗапроса = \"\";\n\tДля Каждого ТекПоле Из МассивСписокПолей Цикл\n\t\tТекПоле = СокрЛП(ТекПоле);\n\t\tЕсли ТекПоле = \"Ссылка\" Тогда Продолжить КонецЕсли; // Поле уже есть в запросе\n\t\tЕсли ДобавленныеПоля.Найти(ТекПоле) Тогда Продолжить КонецЕсли;\n\t\tДобавленныеПоля.Добавить(ТекПоле);\n\t\tТекСтр = СтрШаблон(ТекстШаблона, ТекПоле);\n\t\tТекстПоляЗапроса = ТекстПоляЗапроса + ТекСтр\n\tКонецЦикла;\n\tТЗ = СтрЗаменить(ТЗ, \"{ТекстПоляЗапроса}\", ТекстПоляЗапроса);\n\n\tЗапрос = Новый Запрос(ТЗ);\n\tЗапрос.УстановитьПараметр(\"Ссылка\", пСсылка);\n\n\tВыборка = Запрос.Выполнить().Выгрузить();\n\tРезультат = Новый Структура;\n\tДля Каждого ТекКолонка Из Выборка.Колонки Цикл\n\t\tРезультат.Вставить(ТекКолонка.Имя, Выборка[0][ТекКолонка.Имя])\n\tКонецЦикла;\n\n\tВозврат Результат\n\nКонецФункции\n\n&НаСервере\nФункция ПолучитьНужныеПоляЭлемента(пСсылка, Знач СписокПолей = \"\") Экспорт\n\t\n  ИмяМетаданных = пСсылка.Метаданные().Имя;\n\t\n\t// Добавляем реквизиты если не передали СписокПолей \n\tЕсли ПустаяСтрока(СписокПолей) Тогда\t\t\n\t\t\n\t\t// Стандартные\n\t\tДля каждого Реквизит из Справочники[ИмяМетаданных].ПустаяСсылка().Метаданные().СтандартныеРеквизиты Цикл\t\n\t\t\tСписокПолей = СписокПолей+Реквизит.Имя+\",\";\t\t\n\t\tКонецЦикла;       \n\t\t\n\t\t// Общие реквизиты\t\n\t\tДля каждого Реквизит из Справочники[ИмяМетаданных].ПустаяСсылка().Метаданные().Реквизиты Цикл\n\t\t  СписокПолей = СписокПолей+Реквизит.Имя+\",\";\t\n\t\tКонецЦикла;\t\n\n\tКонецЕсли;\n\t\n\tТЗ = \"ВЫБРАТЬ ПЕРВЫЕ 1\n\t\t|\tСпр.Ссылка КАК Ссылка\n\t\t|ИЗ\n\t\t|\tСправочник.\"+ИмяМетаданных+\" AS Спр\n\t\t|ГДЕ\n\t\t|\tСпр.Ссылка = &Ссылка\";          \n\t\n\tРезультат = Новый Структура;\n\tмнСтроки = СтрЗаменить(СписокПолей,\",\",Символы.ПС); \n\t\n\tДля Стр=1 По СтрЧислоСтрок(мнСтроки) Цикл\n\t\tТекПоле = СтрПолучитьСтроку(мнСтроки, Стр); \n\t\t\n\t\tЕсли НЕ ПустаяСтрока(ТекПоле) Тогда\n\t\t\tРезультат.Вставить(ТекПоле, Неопределено);\n\t\tКонецЕсли;  \n\t\t\n\tКонецЦикла;\n\t\n\tЕсли Результат.Количество() = 0 Тогда\n\t\tВозврат Результат;\n\tКонецЕсли;\n\t\n\tЗапрос = Новый Запрос(ТЗ);\n\tЗапрос.УстановитьПараметр(\"Ссылка\", пСсылка);\n\n\tТаб = Запрос.Выполнить().Выгрузить();                 \n\t\n\tЗаполнитьЗначенияСвойств(Результат, Таб[0].Ссылка);\n\t\n\tВозврат Результат\n\nКонецФункции"
  },
  {
    "title": "Получить даты за период в запросе",
    "description": "Получить даты за период в запросе",
    "code_snippet": "// Возвращает текст запроса, или добавляет запрос во временную таблицу, или возвращает результат запроса, или таблицу значений с результатом запроса.\r\n// Следует указать истина только в одном из следующих параметров:\r\n// - ПолучитьТекстЗапроса\r\n// - ПолучитьРезультатЗапроса\r\n// - ПолучитьТаблицуЗначений.\r\n// \r\n// Параметры:\r\n//  НачалоПериода              - Дата - начало периода отсчета.\r\n//  КонецПериода               - Дата - конец периода отсчета включительно.\r\n//  Шаг                        - Число - шаг вывода дат в днях.\r\n//  ПолучитьПоследнююДату      - Булево - признак вывода последнего дня, если тот не попадает по шагу.\r\n//  ИмяКолонкиПериод           - Строка - имя колонки с датами.\r\n//  ПолучитьКолонкуШаг         - Булево - признак получения колонки шага, используемой для отладки.\r\n//  ИмяКолонкиШаг              - Строка - имя колонки с шагом.\r\n//  ПолучитьТекстЗапроса       - Булево - возврат текста запроса.\r\n//  ДобавитьВоВременныеТаблицы - Булево - добавление запроса во временную таблицу.\r\n//  МенеджерВременныхТаблиц    - МенеджерВременныхТаблиц - менеджер временных таблиц.\r\n//  ИмяВременнойТаблицы        - Строка - имя временной таблицы.\r\n//  ПолучитьРезультатЗапроса   - Булево - получить результат запроса.\r\n//  ПолучитьТаблицуЗначений    - Булево - получить таблицу значений с результатом запроса.\r\n//  УничтожитьВТ               - Булево - если истина, в конце запроса будут уничтеженны промежуточные временные таблицы.\r\n//                                                                         \r\n// Возвращаемое значение:\r\n//  - Строка            - если ПолучитьТекстЗапроса истина. \r\n//\t- Временная таблица - если ДобавитьВоВременныеТаблицы истина. \r\n//\t- Результат запрос  - если ПолучитьРезультатЗапроса истина.\r\n//\t- Таблица значений  - если ПолучитьТаблицуЗначений истина.\r\n//\r\nФункция ПолучитьДатыЗаПериодВЗапросе(НачалоПериода = Неопределено, КонецПериода = Неопределено, Шаг = 1, ПолучитьПоследнююДату = Ложь,\r\n\t\t\t\t\t\t\t\t\t\tИмяКолонкиПериод = \"Период\", ПолучитьКолонкуШаг = Ложь, ИмяКолонкиШаг = \"Шаг\",\r\n\t\t\t\t\t\t\t\t\t\tПолучитьТекстЗапроса = Ложь, ДобавитьВоВременныеТаблицы = Ложь, МенеджерВременныхТаблиц = Неопределено,\r\n\t\t\t\t\t\t\t\t\t\tИмяВременнойТаблицы = \"#ДатыЗаПериод\", ПолучитьРезультатЗапроса = Ложь, ПолучитьТаблицуЗначений = Ложь,\r\n\t\t\t\t\t\t\t\t\t\tУничтожитьВТ = Истина) Экспорт\r\n\t\t\t\t\t\t\t\t\t\t\r\n\tТекстЗапроса = \r\n\t\t\"ВЫБРАТЬ 0 КАК Цифра\r\n\t\t|ПОМЕСТИТЬ Цифры\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 1\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 2\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 3\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 4\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 5\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 6\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 7\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 8\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 9\r\n\t\t|;\r\n\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tДОБАВИТЬКДАТЕ(&НачалоПериода, ДЕНЬ, СписокДней.Дней) КАК Период\r\n\t\t|ПОМЕСТИТЬ НужныйПериод\r\n\t\t|ИЗ\r\n\t\t|\t(ВЫБРАТЬ\r\n\t\t|\t\tСотниТысяч.Цифра * 100000 + ДесяткиТысяч.Цифра * 10000 + Тысячи.Цифра * 1000 + Сотни.Цифра * 100 + Десятки.Цифра * 10 + Единицы.Цифра КАК Дней\r\n\t\t|\tИЗ\r\n\t\t|\t\tЦифры КАК СотниТысяч\r\n\t\t|\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Цифры КАК ДесяткиТысяч\r\n\t\t|\t\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Цифры КАК Тысячи\r\n\t\t|\t\t\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Цифры КАК Сотни\r\n\t\t|\t\t\t\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Цифры КАК Десятки\r\n\t\t|\t\t\t\t\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Цифры КАК Единицы\r\n\t\t|\t\t\t\t\t\t\tПО (Десятки.Цифра * 10 <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\t\t\t\t\t\t\t\tИ (Единицы.Цифра <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\t\t\t\t\t\tПО (Сотни.Цифра * 100 <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\t\t\t\t\tПО (Тысячи.Цифра * 1000 <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\t\t\t\tПО (ДесяткиТысяч.Цифра * 10000 <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\t\t\tПО (СотниТысяч.Цифра * 100000 <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\tГДЕ\r\n\t\t|\t\tСотниТысяч.Цифра * 100000 + ДесяткиТысяч.Цифра * 10000 + Тысячи.Цифра * 1000 + Сотни.Цифра * 100 + Десятки.Цифра * 10 + Единицы.Цифра <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ)) КАК СписокДней\r\n\t\t|;\r\n\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tНужныйПериод1.Период КАК Период,\r\n\t\t|\tСУММА(1) + (&Шаг - 1) КАК Шаг\r\n\t\t|ПОМЕСТИТЬ ПериодДоОбрезания\r\n\t\t|ИЗ\r\n\t\t|\tНужныйПериод КАК НужныйПериод1\r\n\t\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ НужныйПериод КАК НужныйПериод2\r\n\t\t|\t\tПО НужныйПериод1.Период >= НужныйПериод2.Период\r\n\t\t|\r\n\t\t|СГРУППИРОВАТЬ ПО\r\n\t\t|\tНужныйПериод1.Период\r\n\t\t|;\r\n\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tПериодДоОбрезания.Период КАК Период,\r\n\t\t|\tПериодДоОбрезания.Шаг КАК Шаг\r\n\t\t|ПОМЕСТИТЬ ПериодПлюсПоследняяДата\r\n\t\t|ИЗ\r\n\t\t|\tПериодДоОбрезания КАК ПериодДоОбрезания\r\n\t\t|ГДЕ\r\n\t\t|\tПериодДоОбрезания.Шаг / &Шаг = (ВЫРАЗИТЬ(ПериодДоОбрезания.Шаг / &Шаг КАК ЧИСЛО(10, 0)))\r\n\t\t|\r\n\t\t|СГРУППИРОВАТЬ ПО\r\n\t\t|\tПериодДоОбрезания.Период,\r\n\t\t|\tПериодДоОбрезания.Шаг\r\n\t\t|\r\n\t\t|ОБЪЕДИНИТЬ ВСЕ\r\n\t\t|\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\t&КонецПериода,\r\n\t\t|\tNULL\r\n\t\t|;\r\n\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tПериодПлюсПоследняяДата.Период КАК \" + ИмяКолонкиПериод\r\n\t\t +\r\n\t\t \t?(ПолучитьКолонкуШаг,\",\r\n\t\t\t\t\t\t\t\t |\tСУММА(ПериодПлюсПоследняяДата.Шаг) КАК \" + ИмяКолонкиШаг, \"\")\r\n\t\t+\r\n\t\t\t?(ДобавитьВоВременныеТаблицы, \"\r\n\t\t\t\t\t\t\t\t\t\t  |ПОМЕСТИТЬ \" + ИмяВременнойТаблицы, \"\")\r\n\t\t+\r\n\t\t\"\r\n\t\t|ИЗ\r\n\t\t|\tПериодПлюсПоследняяДата КАК ПериодПлюсПоследняяДата\r\n\t\t|\"\r\n\t\t +\r\n\t\t    ?(ПолучитьПоследнююДату,\"ГДЕ\r\n\t\t\t\t\t\t\t\t\t|    НЕ ПериодПлюсПоследняяДата.Шаг ЕСТЬ NULL\r\n\t\t\t\t\t\t\t\t\t|\", \"\")\r\n\t\t +\r\n\t\t\"СГРУППИРОВАТЬ ПО\r\n\t\t|\tПериодПлюсПоследняяДата.Период\r\n\t\t|\"\r\n\t\t +\r\n\t\t \t?(УничтожитьВТ, \";\r\n\t\t\t\t\t\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t\t\t\t\t|УНИЧТОЖИТЬ Цифры\r\n\t\t\t\t\t\t\t|; \r\n\t\t\t\t\t\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t\t\t\t\t|УНИЧТОЖИТЬ НужныйПериод\r\n\t\t\t\t\t\t\t|;\r\n\t\t\t\t\t\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t\t\t\t\t|УНИЧТОЖИТЬ ПериодДоОбрезания\r\n\t\t\t\t\t\t\t|;\r\n\t\t\t\t\t\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t\t\t\t\t|УНИЧТОЖИТЬ ПериодПлюсПоследняяДата \", \"\");\t\t\t\t\t\t\t\t\t\t\r\n\r\n\tЕсли ПолучитьТекстЗапроса Тогда\r\n\t\tВозврат ТекстЗапроса;\r\n\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\tЕсли НачалоПериода = Неопределено Тогда\r\n\t\tНачалоПериода = ТекущаяДатаСеанса();\r\n\tКонецЕсли; \r\n\t\r\n\tЕсли КонецПериода = Неопределено Тогда\r\n\t\tКонецПериода = ТекущаяДатаСеанса();\r\n\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\tЗапрос       = Новый Запрос;\r\n\tЗапрос.Текст = ТекстЗапроса; \r\n\t\r\n\tЕсли ДобавитьВоВременныеТаблицы Тогда\r\n\t\tЗапрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tКонецЕсли;\r\n\t                                          \r\n\tЗапрос.УстановитьПараметр(\"КонецПериода\",  НачалоДня(КонецПериода));\r\n\tЗапрос.УстановитьПараметр(\"НачалоПериода\", НачалоДня(НачалоПериода));\r\n\tЗапрос.УстановитьПараметр(\"Шаг\",           Шаг);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\r\n\tЕсли ПолучитьРезультатЗапроса Тогда\r\n\t\tВозврат РезультатЗапроса;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ПолучитьТаблицуЗначений Тогда\r\n\t\tВозврат РезультатЗапроса.Выгрузить();\r\n\tКонецЕсли;\r\n\t\t\t\r\nКонецФункции\n\n// Возвращает текст запроса, или добавляет запрос во временную таблицу, или возвращает результат запроса, или таблицу значений с результатом запроса.\r\n// Следует указать истина только в одном из следующих параметров:\r\n// - ПолучитьТекстЗапроса\r\n// - ПолучитьРезультатЗапроса\r\n// - ПолучитьТаблицуЗначений.\r\n// \r\n// Параметры:\r\n//  НачалоПериода              - Дата - начало периода отсчета.\r\n//  КонецПериода               - Дата - конец периода отсчета включительно.\r\n//  Шаг                        - Число - шаг вывода дат в днях.\r\n//  ПолучитьПоследнююДату      - Булево - признак вывода последнего дня, если тот не попадает по шагу.\r\n//  ИмяКолонкиПериод           - Строка - имя колонки с датами.\r\n//  ПолучитьКолонкуШаг         - Булево - признак получения колонки шага, используемой для отладки.\r\n//  ИмяКолонкиШаг              - Строка - имя колонки с шагом.\r\n//  ПолучитьТекстЗапроса       - Булево - возврат текста запроса.\r\n//  ДобавитьВоВременныеТаблицы - Булево - добавление запроса во временную таблицу.\r\n//  МенеджерВременныхТаблиц    - МенеджерВременныхТаблиц - менеджер временных таблиц.\r\n//  ИмяВременнойТаблицы        - Строка - имя временной таблицы.\r\n//  ПолучитьРезультатЗапроса   - Булево - получить результат запроса.\r\n//  ПолучитьТаблицуЗначений    - Булево - получить таблицу значений с результатом запроса.\r\n//  УничтожитьВТ               - Булево - если истина, в конце запроса будут уничтеженны промежуточные временные таблицы.\r\n//                                                                         \r\n// Возвращаемое значение:\r\n//  - Строка            - если ПолучитьТекстЗапроса истина. \r\n//\t- Временная таблица - если ДобавитьВоВременныеТаблицы истина. \r\n//\t- Результат запрос  - если ПолучитьРезультатЗапроса истина.\r\n//\t- Таблица значений  - если ПолучитьТаблицуЗначений истина.\r\n//\r\nФункция ПолучитьДатыЗаПериодВЗапросе(НачалоПериода = Неопределено, КонецПериода = Неопределено, Шаг = 1, ПолучитьПоследнююДату = Ложь,\r\n\t\t\t\t\t\t\t\t\t\tИмяКолонкиПериод = \"Период\", ПолучитьКолонкуШаг = Ложь, ИмяКолонкиШаг = \"Шаг\",\r\n\t\t\t\t\t\t\t\t\t\tПолучитьТекстЗапроса = Ложь, ДобавитьВоВременныеТаблицы = Ложь, МенеджерВременныхТаблиц = Неопределено,\r\n\t\t\t\t\t\t\t\t\t\tИмяВременнойТаблицы = \"#ДатыЗаПериод\", ПолучитьРезультатЗапроса = Ложь, ПолучитьТаблицуЗначений = Ложь,\r\n\t\t\t\t\t\t\t\t\t\tУничтожитьВТ = Истина) Экспорт\r\n\t\t\t\t\t\t\t\t\t\t\r\n\tТекстЗапроса = \r\n\t\t\"ВЫБРАТЬ 0 КАК Цифра\r\n\t\t|ПОМЕСТИТЬ Цифры\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 1\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 2\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 3\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 4\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 5\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 6\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 7\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 8\r\n\t\t|ОБЪЕДИНИТЬ ВЫБРАТЬ 9\r\n\t\t|;\r\n\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tДОБАВИТЬКДАТЕ(&НачалоПериода, ДЕНЬ, СписокДней.Дней) КАК Период\r\n\t\t|ПОМЕСТИТЬ НужныйПериод\r\n\t\t|ИЗ\r\n\t\t|\t(ВЫБРАТЬ\r\n\t\t|\t\tСотниТысяч.Цифра * 100000 + ДесяткиТысяч.Цифра * 10000 + Тысячи.Цифра * 1000 + Сотни.Цифра * 100 + Десятки.Цифра * 10 + Единицы.Цифра КАК Дней\r\n\t\t|\tИЗ\r\n\t\t|\t\tЦифры КАК СотниТысяч\r\n\t\t|\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Цифры КАК ДесяткиТысяч\r\n\t\t|\t\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Цифры КАК Тысячи\r\n\t\t|\t\t\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Цифры КАК Сотни\r\n\t\t|\t\t\t\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Цифры КАК Десятки\r\n\t\t|\t\t\t\t\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Цифры КАК Единицы\r\n\t\t|\t\t\t\t\t\t\tПО (Десятки.Цифра * 10 <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\t\t\t\t\t\t\t\tИ (Единицы.Цифра <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\t\t\t\t\t\tПО (Сотни.Цифра * 100 <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\t\t\t\t\tПО (Тысячи.Цифра * 1000 <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\t\t\t\tПО (ДесяткиТысяч.Цифра * 10000 <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\t\t\tПО (СотниТысяч.Цифра * 100000 <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ))\r\n\t\t|\tГДЕ\r\n\t\t|\t\tСотниТысяч.Цифра * 100000 + ДесяткиТысяч.Цифра * 10000 + Тысячи.Цифра * 1000 + Сотни.Цифра * 100 + Десятки.Цифра * 10 + Единицы.Цифра <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ)) КАК СписокДней\r\n\t\t|;\r\n\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tНужныйПериод1.Период КАК Период,\r\n\t\t|\tСУММА(1) + (&Шаг - 1) КАК Шаг\r\n\t\t|ПОМЕСТИТЬ ПериодДоОбрезания\r\n\t\t|ИЗ\r\n\t\t|\tНужныйПериод КАК НужныйПериод1\r\n\t\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ НужныйПериод КАК НужныйПериод2\r\n\t\t|\t\tПО НужныйПериод1.Период >= НужныйПериод2.Период\r\n\t\t|\r\n\t\t|СГРУППИРОВАТЬ ПО\r\n\t\t|\tНужныйПериод1.Период\r\n\t\t|;\r\n\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tПериодДоОбрезания.Период КАК Период,\r\n\t\t|\tПериодДоОбрезания.Шаг КАК Шаг\r\n\t\t|ПОМЕСТИТЬ ПериодПлюсПоследняяДата\r\n\t\t|ИЗ\r\n\t\t|\tПериодДоОбрезания КАК ПериодДоОбрезания\r\n\t\t|ГДЕ\r\n\t\t|\tПериодДоОбрезания.Шаг / &Шаг = (ВЫРАЗИТЬ(ПериодДоОбрезания.Шаг / &Шаг КАК ЧИСЛО(10, 0)))\r\n\t\t|\r\n\t\t|СГРУППИРОВАТЬ ПО\r\n\t\t|\tПериодДоОбрезания.Период,\r\n\t\t|\tПериодДоОбрезания.Шаг\r\n\t\t|\r\n\t\t|ОБЪЕДИНИТЬ ВСЕ\r\n\t\t|\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\t&КонецПериода,\r\n\t\t|\tNULL\r\n\t\t|;\r\n\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tПериодПлюсПоследняяДата.Период КАК \" + ИмяКолонкиПериод\r\n\t\t +\r\n\t\t \t?(ПолучитьКолонкуШаг,\",\r\n\t\t\t\t\t\t\t\t |\tСУММА(ПериодПлюсПоследняяДата.Шаг) КАК \" + ИмяКолонкиШаг, \"\")\r\n\t\t+\r\n\t\t\t?(ДобавитьВоВременныеТаблицы, \"\r\n\t\t\t\t\t\t\t\t\t\t  |ПОМЕСТИТЬ \" + ИмяВременнойТаблицы, \"\")\r\n\t\t+\r\n\t\t\"\r\n\t\t|ИЗ\r\n\t\t|\tПериодПлюсПоследняяДата КАК ПериодПлюсПоследняяДата\r\n\t\t|\"\r\n\t\t +\r\n\t\t    ?(ПолучитьПоследнююДату,\"ГДЕ\r\n\t\t\t\t\t\t\t\t\t|    НЕ ПериодПлюсПоследняяДата.Шаг ЕСТЬ NULL\r\n\t\t\t\t\t\t\t\t\t|\", \"\")\r\n\t\t +\r\n\t\t\"СГРУППИРОВАТЬ ПО\r\n\t\t|\tПериодПлюсПоследняяДата.Период\r\n\t\t|\"\r\n\t\t +\r\n\t\t \t?(УничтожитьВТ, \";\r\n\t\t\t\t\t\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t\t\t\t\t|УНИЧТОЖИТЬ Цифры\r\n\t\t\t\t\t\t\t|; \r\n\t\t\t\t\t\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t\t\t\t\t|УНИЧТОЖИТЬ НужныйПериод\r\n\t\t\t\t\t\t\t|;\r\n\t\t\t\t\t\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t\t\t\t\t|УНИЧТОЖИТЬ ПериодДоОбрезания\r\n\t\t\t\t\t\t\t|;\r\n\t\t\t\t\t\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t\t\t\t\t|УНИЧТОЖИТЬ ПериодПлюсПоследняяДата \", \"\");\t\t\t\t\t\t\t\t\t\t\r\n\r\n\tЕсли ПолучитьТекстЗапроса Тогда\r\n\t\tВозврат ТекстЗапроса;\r\n\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\tЕсли НачалоПериода = Неопределено Тогда\r\n\t\tНачалоПериода = ТекущаяДатаСеанса();\r\n\tКонецЕсли; \r\n\t\r\n\tЕсли КонецПериода = Неопределено Тогда\r\n\t\tКонецПериода = ТекущаяДатаСеанса();\r\n\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\tЗапрос       = Новый Запрос;\r\n\tЗапрос.Текст = ТекстЗапроса; \r\n\t\r\n\tЕсли ДобавитьВоВременныеТаблицы Тогда\r\n\t\tЗапрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tКонецЕсли;\r\n\t                                          \r\n\tЗапрос.УстановитьПараметр(\"КонецПериода\",  НачалоДня(КонецПериода));\r\n\tЗапрос.УстановитьПараметр(\"НачалоПериода\", НачалоДня(НачалоПериода));\r\n\tЗапрос.УстановитьПараметр(\"Шаг\",           Шаг);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\r\n\tЕсли ПолучитьРезультатЗапроса Тогда\r\n\t\tВозврат РезультатЗапроса;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ПолучитьТаблицуЗначений Тогда\r\n\t\tВозврат РезультатЗапроса.Выгрузить();\r\n\tКонецЕсли;\r\n\t\t\t\r\nКонецФункции\n\n{29} Не все части функции возвращают значение\r\nОрфографическая ошибка в уничтеженны: уничтеженны"
  },
  {
    "title": "Условное оформление",
    "description": "Условное оформление",
    "code_snippet": "// Устанавливает Элемент УсловноеОформление\n// 1) создает ЭлементУО \t\t(УсловноеОформление.Элементы; \tесли не ПустаяСтрока(Представление) - пробует подобрать существующий)\n// 2) создает ЭлементОформления (ЭлементУО.Поля.Элементы; \t\tесли ЭлементУО подобран - не создает)\n// 3) создает ЭлементОтбора \t(ЭлементУО.Отбор.Элементы; \t\tпробует сначала подобрать существующий по ПутьКДаннымПоля и ВидСравнения=ВСписке - в таком случае дополняет ПравоеЗначение) \n// СДЕЛАНО вынесено в срксСерверныйОбщий из документ.ПеремещениеТоваров.Формы.ФормаДокумента\n// Доступность: Сервер \n//\n// Параметры:   \n// Форма - ФормаКлиентскогоПриложения, Произвольный - Коллекция с реквизитом УсловноеОформление типа Тип(\"УсловноеОформлениеКомпоновкиДанных\")\n// Элемент - ТаблицаФормы\n// Представление - Строка - произвольное человекочитаемое имя УсловноеОформление.Элементы[N].Имя\n// Параметр - Строка - Имя параметра который нужно оформлять, напр. \"ЦветФона\", или \"Шрифт\"\n// Значение - Произвольный - Значение которое нужно установить параметру, напр. Новый Шрифт(...) или Новый Цвет(...)\n// ПутьКДаннымПоля - Строка - Путь к данным на форме для отбора по условию , напр. \"Объект.Товары.Номенклатура\"\n// ВидСравнения - ВидСравненияКомпоновкиДанных\n// ПравоеЗначение - Произвольный - данные с которыми сравнивать, напр. Справочники.Номенклатура.НайтиПОНаименованию(\"Пакет\")\n// Действие - Число - 0 = просто создать/подобрать (отборы будут дополнены), 1 = заменить (т.е. удалить и создать заново, в т.ч. отборы), 2 = удалить (и не создавать),\n// \t\t\t\t\t  3 = исключить ПравоеЗначение из отбора, но не удалять само оформление. Нужно для удобной смены отборов\nПроцедура УстановитьЭлементУсловногоОформления(Форма, Элемент, Представление = \"\", Параметр = Неопределено, Значение = Неопределено, ПутьКДаннымПоля = Неопределено, ВидСравнения = Неопределено, Знач ПравоеЗначение = Неопределено, Действие = 0) Экспорт \n\t\n\t//ОН = срксСерверныйОбщий;       \n\t//Если Форма = Неопределено Тогда // для исп. в форме, как рекомендуют разработчики https://its.1c.ru/db/v8std/content/710/hdoc \n\t//\tФорма = ЭтаФорма\n\t//КонецЕсли;\n\t\n\t// Инициализация параметров оформления и отбора\n\tЕсли ПутьКДаннымПоля = Неопределено ИЛИ Не СтрНайти(ПутьКДаннымПоля, Элемент.ПутьКДанным) Тогда\n\t\tПутьКДаннымПоля = Элемент.ПутьКДанным + \".\" + ?(ЗначениеЗаполнено(ПутьКДаннымПоля), ПутьКДаннымПоля, \"НомерСтроки\")\n\tКонецЕсли;\n\tЕсли ВидСравнения = Неопределено Тогда\n\t\tВидСравнения = ВидСравненияКомпоновкиДанных.ВСписке  \n\tИначеЕсли ТипЗнч(ВидСравнения) = Тип(\"Строка\") Тогда\n\t\tВидСравнения = ВидСравненияКомпоновкиДанных[ВидСравнения]\n\tКонецЕсли;  \n\tЕсли ПравоеЗначение = Неопределено Тогда\n\t\tПравоеЗначение = 1\t\n\tКонецЕсли;\n\t\n\tЕсли Параметр = Неопределено Тогда\n\t\tПараметр = \"ЦветФона\";\n\t\tЗначение = ЦветаСтиля.ЦветАктивности; \n\tКонецЕсли; \n\tЕсли Значение = Неопределено Тогда\n\t\tЗначение = ЦветаСтиля.ЦветАктивности; \n\tКонецЕсли;\n\t\n\t// Подбор/создание элемента условного оформления\n\tЕсли Не ПустаяСтрока(Представление) Тогда Для Каждого _ Из Форма.УсловноеОформление.Элементы Цикл Если _.Представление = Представление Тогда\n\t\tЭлементУсловногоОформления\t= _;    \n\t\tЕсли Действие > 0 Тогда \n\t\t\tЕсли Действие < 3 Тогда\n\t\t\t\tФорма.УсловноеОформление.Элементы.Удалить(ЭлементУсловногоОформления); \n\t\t\tИначеЕсли Действие = 3 Тогда\n\t\t\t\t_ПравоеЗначение = ЭлементУсловногоОформления.Отбор.Элементы[0].ПравоеЗначение;\t\n\t\t\t\tЕсли ТипЗнч(_ПравоеЗначение) = Тип(\"СписокЗначений\") Тогда\n\t\t\t\t\t_НайденныйЭлемент = _ПравоеЗначение.НайтиПоЗначению(ПравоеЗначение);\n\t\t\t\t\tЕсли _НайденныйЭлемент <> Неопределено Тогда\n\t\t\t\t\t    _ПравоеЗначение.Удалить(_НайденныйЭлемент);\n\t\t\t\t\tКонецЕсли;\n\t\t\t\tКонецЕсли;\n\t\t\tКонецЕсли;\n\t\t\tЕсли Действие = 1 Тогда\n\t\t\t\tУстановитьЭлементУсловногоОформления(Элемент, Представление, параметр, Значение, ПутьКДаннымполя, ВидСравнения, ПравоеЗначение)\t\n\t\t\tКонецЕсли;\n\t\t\tВозврат;\n\t\tКонецЕсли;\n\t\tДобавитьОформление \t\t\t= Ложь; \n\t\tПрервать;\n\tКонецЕсли КонецЦикла КонецЕсли;\n\tЕсли Действие > 1 Тогда\n\t\tВозврат\n\tКонецЕсли;\n\tЕсли ЭлементУсловногоОформления = Неопределено Тогда\n\t\tЭлементУсловногоОформления \t= Форма.УсловноеОформление.Элементы.Добавить();  \n\t\tЭлементУсловногоОформления.Представление = Представление;\n\t\tДобавитьОформление \t\t\t= Истина;\n\tКонецЕсли;\n\t \n\t// добавляет элемент к оформлению (напр. элементы.Товары)\n\tЕсли ДобавитьОформление Тогда\n\t\tЭлементОформления \t\t\t= ЭлементУсловногоОформления.Поля.Элементы.Добавить();\n\t\tЭлементОформления.Поле \t\t= Новый ПолеКомпоновкиДанных(Элемент.Имя);  \n\t\tЭлементОформления.Использование = Истина;\n\tКонецЕсли;\n\t// добавляет отбор (напр. по номеру строки из списка)\n\tДобавитьОтбор = Истина;\n\tДля Каждого _ Из ЭлементУсловногоОформления.Отбор.Элементы Цикл \n\t\tЕсли строка(_.ЛевоеЗначение) = ПутьКДаннымПоля И\n\t\t\t _.ВидСравнения\t = ВидСравнения И\n\t\t\t ВидСравнения\t = ВидСравненияКомпоновкиДанных.ВСписке\n\t\tТогда \n\t\t\tЕсли _.ПравоеЗначение.НайтиПоЗначению(ПравоеЗначение) = Неопределено Тогда\n\t\t    \t_.ПравоеЗначение \t= Массив(_.ПравоеЗначение, ПравоеЗначение);\n\t\t\tКонецЕсли;                                                              \n\t\t\tДобавитьОтбор\t\t\t= Ложь;\n\t\t\tПрервать;\n\t\tКонецЕсли;\n\tКонецЦикла;  \n\tЕсли ДобавитьОтбор Тогда  \n\t\tЭлементОтбора\t\t\t\t= ЭлементУсловногоОформления.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\n\t\tЭлементОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных(ПутьКДаннымПоля);\n\t\tЭлементОтбора.ВидСравнения   = ВидСравнения;    \n\t\tЭлементОтбора.ПравоеЗначение = ?(ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСписке И Не ТипЗнч(ПравоеЗначение) = Тип(\"СписокЗначений\"), Массив(Новый СписокЗначений, ПравоеЗначение), ПравоеЗначение);\n\t\tЭлементОтбора.Использование  = Истина; \n\tКонецЕсли;\n\n\tЭлементУсловногоОформления.Оформление.УстановитьЗначениеПараметра(Параметр, Значение);\n\n\t//ЭлементУсловногоОформления.РежимОтображения = РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Недоступный;\n\t//ЭлементУсловногоОформления.ИдентификаторПользовательскойНастройки = \"Предустановленный\";\n\t//ЭлементУсловногоОформления.Представление = НСтр(\"en='By status color';ru='По цвету статуса '\");\n\t//ЭлементУсловногоОформления.Использование = Истина; \n\t\nКонецПроцедуры"
  },
  {
    "title": "Открыть отчет СКД с передачей параметров и отборами",
    "description": "Открыть отчет СКД с передачей параметров и отборами",
    "code_snippet": "// Открывает отчет на СКД с передачей параметров и отборов\r\n//\r\n// Параметры:\r\n//  ЭтаФорма\t\t\t\t\t - ФормаКлиентскогоПриложения - Форма клиентского приложения \r\n//  ФормаОтчета\t\t\t\t\t - Строка - Путь к форме отчета, например: \"Отчет.ТестовыйОтчёт.Форма\" \r\n//  Параметры\t\t\t\t\t - Структура - Ключ- имя параметра, значение- присваиваемое значение\r\n//  Отборы\t\t\t\t\t\t - Массив структур - Структура вида: Новый Структура(\"ИмяОтбора, Значение, ВидСравнения\", ИмяОтбора, Значение, ВидСравнения) \r\n//  СформироватьПриОткрытии\t\t - Булево - Признак формировании отчета при открытии \r\n//  КлючВарианта\t\t\t\t - Строка - Ключ варианта отчета, который следует открыть\r\n//  ПользовательскиеНастройки\t - Пользовательские настройки отчета - КомпоновщикНастроек.ПользовательскиеНастройки \r\n//\r\nПроцедура КомандаОткрытьОтчётСОтбором(ЭтаФорма, ФормаОтчета, Параметры = Неопределено, Отборы = Неопределено,\r\n\t          СформироватьПриОткрытии = Истина, КлючВарианта = Неопределено, ПользовательскиеНастройки = Неопределено) Экспорт\r\n\t\t\r\n\tФормаОтчёта = ПолучитьФорму(ФормаОтчета);\r\n\tКомпоновщикНастроек = ФормаОтчёта.Отчет.КомпоновщикНастроек;\r\n\t\r\n\tДля Каждого Парам Из Параметры Цикл \r\n\t\tУстановитьПользовательскийПараметрСКД(КомпоновщикНастроек, Парам.Ключ, Парам.Значение);\t\r\n\tКонецЦикла;\t\r\n\t\r\n\tДля Каждого Отбор Из Отборы Цикл \r\n\t\tУстановитьПользовательскийОтборСКД(КомпоновщикНастроек, Отбор.ИмяОтбора, Отбор.Значение, Отбор.ВидСравнения);\t\r\n\tКонецЦикла;\r\n\t\r\n\tПараметрыФормы = Новый Структура();\r\n\tПараметрыФормы.Вставить(\"СформироватьПриОткрытии\", СформироватьПриОткрытии);\r\n\tЕсли КлючВарианта <> Неопределено Тогда\r\n\t\tПараметрыФормы.Вставить(\"КлючВарианта\", КлючВарианта);\t\t\r\n\tКонецЕсли;  \r\n\tПараметрыФормы.Вставить(\"ПользовательскиеНастройки\", ?(ПользовательскиеНастройки <> Неопределено, ПользовательскиеНастройки,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  КомпоновщикНастроек.ПользовательскиеНастройки)); \r\n\t\r\n\tОткрытьФорму(ФормаОтчета, ПараметрыФормы, ЭтаФорма);\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура УстановитьПользовательскийПараметрСКД(КомпоновщикНастроек, ИмяПараметра, Значение)\r\n\t\r\n\tПерем ПараметрДанных, Настройки, ПользовательскиеНастройки, ПользовательскийПараметр;\r\n\t\r\n\tНастройки = КомпоновщикНастроек.Настройки;\r\n\t\r\n\tПараметрДанных = Настройки.ПараметрыДанных.Элементы.Найти(ИмяПараметра);\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ПараметрДанных.ИдентификаторПользовательскойНастройки) Тогда\r\n\t\t\r\n\t\tПользовательскиеНастройки = КомпоновщикНастроек.ПользовательскиеНастройки;\r\n\t\tПользовательскийПараметр = ПользовательскиеНастройки.Элементы.Найти(ПараметрДанных.ИдентификаторПользовательскойНастройки);\r\n\t\tПользовательскийПараметр.Использование = Истина;\r\n\t\tПользовательскийПараметр.Значение = Значение;\r\n\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура УстановитьПользовательскийОтборСКД(КомпоновщикНастроек, ИмяОтбора, Значение, ВидСравнения = Неопределено)\r\n\t\r\n\tПерем\tПолеКД, Элем, ЭлементОтбора, Настройки, \r\n\t\t\tПользовательскиеНастройки, ПользовательскийОтбор;\r\n\t\r\n\tНастройки = КомпоновщикНастроек.Настройки;\r\n\t\r\n\tПолеКД = Новый ПолеКомпоновкиДанных(ИмяОтбора);\r\n\t\r\n\tДля Каждого Элем Из Настройки.Отбор.Элементы Цикл\r\n\t\t\r\n\t\tЕсли Элем.ЛевоеЗначение = ПолеКД Тогда\r\n\t\t\tЭлементОтбора = Элем;\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли ЭлементОтбора = Неопределено Тогда\r\n\t\tВозврат;\t\t\r\n\tКонецЕсли;\t\t\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ЭлементОтбора.ИдентификаторПользовательскойНастройки) Тогда\r\n\t\t\r\n\t\tПользовательскиеНастройки = КомпоновщикНастроек.ПользовательскиеНастройки;\r\n \t\tПользовательскийОтбор = ПользовательскиеНастройки.Элементы.Найти(ЭлементОтбора.ИдентификаторПользовательскойНастройки);\r\n\t\tПользовательскийОтбор.Использование = (Значение <> Неопределено);\r\n\t\tПользовательскийОтбор.ВидСравнения = ?(ВидСравнения <> Неопределено, ВидСравнения, ВидСравненияКомпоновкиДанных.Равно); \r\n\t\tПользовательскийОтбор.ПравоеЗначение  = Значение;\r\n\r\n\tКонецЕсли;\r\n\r\nКонецПроцедуры\n\n// Открывает отчет на СКД с передачей параметров и отборов\r\n//\r\n// Параметры:\r\n//  ЭтаФорма\t\t\t\t\t - ФормаКлиентскогоПриложения - Форма клиентского приложения \r\n//  ФормаОтчета\t\t\t\t\t - Строка - Путь к форме отчета, например: \"Отчет.ТестовыйОтчёт.Форма\" \r\n//  Параметры\t\t\t\t\t - Структура - Ключ- имя параметра, значение- присваиваемое значение\r\n//  Отборы\t\t\t\t\t\t - Массив структур - Структура вида: Новый Структура(\"ИмяОтбора, Значение, ВидСравнения\", ИмяОтбора, Значение, ВидСравнения) \r\n//  СформироватьПриОткрытии\t\t - Булево - Признак формировании отчета при открытии \r\n//  КлючВарианта\t\t\t\t - Строка - Ключ варианта отчета, который следует открыть\r\n//  ПользовательскиеНастройки\t - Пользовательские настройки отчета - КомпоновщикНастроек.ПользовательскиеНастройки \r\n//\r\nПроцедура КомандаОткрытьОтчётСОтбором(ЭтаФорма, ФормаОтчета, Параметры = Неопределено, Отборы = Неопределено,\r\n\t          СформироватьПриОткрытии = Истина, КлючВарианта = Неопределено, ПользовательскиеНастройки = Неопределено) Экспорт\r\n\t\t\r\n\tФормаОтчёта = ПолучитьФорму(ФормаОтчета);\r\n\tКомпоновщикНастроек = ФормаОтчёта.Отчет.КомпоновщикНастроек;\r\n\t\r\n\tДля Каждого Парам Из Параметры Цикл \r\n\t\tУстановитьПользовательскийПараметрСКД(КомпоновщикНастроек, Парам.Ключ, Парам.Значение);\t\r\n\tКонецЦикла;\t\r\n\t\r\n\tДля Каждого Отбор Из Отборы Цикл \r\n\t\tУстановитьПользовательскийОтборСКД(КомпоновщикНастроек, Отбор.ИмяОтбора, Отбор.Значение, Отбор.ВидСравнения);\t\r\n\tКонецЦикла;\r\n\t\r\n\tПараметрыФормы = Новый Структура();\r\n\tПараметрыФормы.Вставить(\"СформироватьПриОткрытии\", СформироватьПриОткрытии);\r\n\tЕсли КлючВарианта <> Неопределено Тогда\r\n\t\tПараметрыФормы.Вставить(\"КлючВарианта\", КлючВарианта);\t\t\r\n\tКонецЕсли;  \r\n\tПараметрыФормы.Вставить(\"ПользовательскиеНастройки\", ?(ПользовательскиеНастройки <> Неопределено, ПользовательскиеНастройки,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  КомпоновщикНастроек.ПользовательскиеНастройки)); \r\n\t\r\n\tОткрытьФорму(ФормаОтчета, ПараметрыФормы, ЭтаФорма);\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура УстановитьПользовательскийПараметрСКД(КомпоновщикНастроек, ИмяПараметра, Значение)\r\n\t\r\n\tПерем ПараметрДанных, Настройки, ПользовательскиеНастройки, ПользовательскийПараметр;\r\n\t\r\n\tНастройки = КомпоновщикНастроек.Настройки;\r\n\t\r\n\tПараметрДанных = Настройки.ПараметрыДанных.Элементы.Найти(ИмяПараметра);\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ПараметрДанных.ИдентификаторПользовательскойНастройки) Тогда\r\n\t\t\r\n\t\tПользовательскиеНастройки = КомпоновщикНастроек.ПользовательскиеНастройки;\r\n\t\tПользовательскийПараметр = ПользовательскиеНастройки.Элементы.Найти(ПараметрДанных.ИдентификаторПользовательскойНастройки);\r\n\t\tПользовательскийПараметр.Использование = Истина;\r\n\t\tПользовательскийПараметр.Значение = Значение;\r\n\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура УстановитьПользовательскийОтборСКД(КомпоновщикНастроек, ИмяОтбора, Значение, ВидСравнения = Неопределено)\r\n\t\r\n\tПерем\tПолеКД, Элем, ЭлементОтбора, Настройки, \r\n\t\t\tПользовательскиеНастройки, ПользовательскийОтбор;\r\n\t\r\n\tНастройки = КомпоновщикНастроек.Настройки;\r\n\t\r\n\tПолеКД = Новый ПолеКомпоновкиДанных(ИмяОтбора);\r\n\t\r\n\tДля Каждого Элем Из Настройки.Отбор.Элементы Цикл\r\n\t\t\r\n\t\tЕсли Элем.ЛевоеЗначение = ПолеКД Тогда\r\n\t\t\tЭлементОтбора = Элем;\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли ЭлементОтбора = Неопределено Тогда\r\n\t\tВозврат;\t\t\r\n\tКонецЕсли;\t\t\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ЭлементОтбора.ИдентификаторПользовательскойНастройки) Тогда\r\n\t\t\r\n\t\tПользовательскиеНастройки = КомпоновщикНастроек.ПользовательскиеНастройки;\r\n \t\tПользовательскийОтбор = ПользовательскиеНастройки.Элементы.Найти(ЭлементОтбора.ИдентификаторПользовательскойНастройки);\r\n\t\tПользовательскийОтбор.Использование = (Значение <> Неопределено);\r\n\t\tПользовательскийОтбор.ВидСравнения = ?(ВидСравнения <> Неопределено, ВидСравнения, ВидСравненияКомпоновкиДанных.Равно); \r\n\t\tПользовательскийОтбор.ПравоеЗначение  = Значение;\r\n\r\n\tКонецЕсли;\r\n\r\nКонецПроцедуры"
  },
  {
    "title": "Преобразование строки в число",
    "description": "Преобразование строки в число",
    "code_snippet": "// функция преобразует строку в число, примеры:\r\n// 315 руб. = 315\r\n// 1 007,30 м2 (квадратный метр) = 1007,3\r\n// -12.5% = -12,5\r\n// ,05 = 0,05\r\n// пустая строка или пробелы = 0\r\nФункция грв_СтрокаВЧисло(Знач СтрокаЧисло) Экспорт\r\n\t\r\n\tРезультат = \"\";\r\n\tДля Индекс = 1 По СтрДлина(СтрокаЧисло) Цикл\r\n\t\tСимвол = Сред(СтрокаЧисло, Индекс, 1);\r\n\t\tКодСимвола = КодСимвола(Символ);\r\n\t\tЕсли ((КодСимвола >= 48 И КодСимвола <= 57) Или (Символ = \"-\" И Индекс = 1) Или (Символ = \",\") Или (Символ = \".\") Или (Символ = \" \") Или (КодСимвола = 160)) Тогда\r\n\t\t\tЕсли КодСимвола <> 32 И КодСимвола <> 160 Тогда\r\n\t\t\t\tРезультат = Результат + Символ;\r\n\t\t\tКонецЕсли; \r\n\t\tИначе\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tРезультат = СтроковыеФункцииКлиентСервер.СтрокаВЧисло(Результат);\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\n// функция преобразует строку в число, примеры:\r\n// 315 руб. = 315\r\n// 1 007,30 м2 (квадратный метр) = 1007,3\r\n// -12.5% = -12,5\r\n// ,05 = 0,05\r\n// пустая строка или пробелы = 0\r\nФункция грв_СтрокаВЧисло(Знач СтрокаЧисло) Экспорт\r\n\t\r\n\tРезультат = \"\";\r\n\tДля Индекс = 1 По СтрДлина(СтрокаЧисло) Цикл\r\n\t\tСимвол = Сред(СтрокаЧисло, Индекс, 1);\r\n\t\tКодСимвола = КодСимвола(Символ);\r\n\t\tЕсли ((КодСимвола >= 48 И КодСимвола <= 57) Или (Символ = \"-\" И Индекс = 1) Или (Символ = \",\") Или (Символ = \".\") Или (Символ = \" \") Или (КодСимвола = 160)) Тогда\r\n\t\t\tЕсли КодСимвола <> 32 И КодСимвола <> 160 Тогда\r\n\t\t\t\tРезультат = Результат + Символ;\r\n\t\t\tКонецЕсли; \r\n\t\tИначе\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tРезультат = СтроковыеФункцииКлиентСервер.СтрокаВЧисло(Результат);\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nОписаниеТипа = Новый ОписаниеТипов(\"Число\");\n\t\tРезультат = ОписаниеТипа.ПривестиЗначение(СтрокаЧисло);"
  },
  {
    "title": "Как запустить скрипт VBS с правами администратора",
    "description": "Как запустить скрипт VBS с правами администратора",
    "code_snippet": "If Not WScript.Arguments.Named.Exists(\"elevate\") Then\n  CreateObject(\"Shell.Application\").ShellExecute WScript.FullName _\n    , \"\"\"\" & WScript.ScriptFullName & \"\"\" /elevate\", \"\", \"runas\", 1\n  WScript.Quit\nEnd If"
  },
  {
    "title": "Получить количество строк динамического списка",
    "description": "Получить количество строк динамического списка",
    "code_snippet": "// Возвращает количество строк динамического списка\r\n//\r\n// Параметры:\r\n//  ЭтаФорма - ФормаКлиентскогоПриложения - Форма клиентского приложения\r\n//  Список\t - строка - имя динамического списка\r\n// \r\n// Возвращаемое значение:\r\n//  Строка - количество строк в динамическом списке \r\n//\r\nФункция ПосчитатьКоличествоВДинамСписке(ЭтаФорма, Список) Экспорт\r\n\t\r\n\tСхема = ЭтаФорма.Элементы[Список].ПолучитьИсполняемуюСхемуКомпоновкиДанных();\r\n\tНастройки = ЭтаФорма.Элементы[Список].ПолучитьИсполняемыеНастройкиКомпоновкиДанных();\r\n\t\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных();\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(Схема, Настройки, , , Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = МакетКомпоновки.НаборыДанных.НаборДанныхДинамическогоСписка.Запрос;\r\n\t\r\n\tПозВыбратьНачало = СтрНайти(Запрос.Текст, \"ВЫБРАТЬ \", НаправлениеПоиска.СКонца);\r\n\tПока НЕ ПозВыбратьНачало = 1\r\n\t\tи НЕ Сред(Запрос.Текст, ПозВыбратьНачало - 1, 1) = Символы.ПС Цикл\r\n\t\tПозВыбратьНачало = СтрНайти(Запрос.Текст, \"ВЫБРАТЬ \", НаправлениеПоиска.СКонца, ПозВыбратьНачало - 1);\r\n\tКонецЦикла;\r\n\tПозВыбратьКонец = СтрНайти(Запрос.Текст, Символы.ПС,, ПозВыбратьНачало);\r\n\t\r\n\tСтрокаВЫБРАТЬ = Лев(Запрос.Текст, ПозВыбратьКонец);\r\n\tСтрокаИз = Сред(Запрос.Текст, СтрНайти(Запрос.Текст, Символы.ПС + \"ИЗ\" + Символы.ПС,, ПозВыбратьКонец));\r\n\t\r\n\tЕсли СтрНайти(СтрокаИз, Символы.ПС + \"СГРУППИРОВАТЬ\") Тогда\r\n\t\tСтрокаИз = Лев(СтрокаИз, СтрНайти(СтрокаИз, Символы.ПС + \"СГРУППИРОВАТЬ\"));\r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос.Текст = СтрокаВЫБРАТЬ + \"Количество(*) КАК Кол\" + СтрокаИз;\r\n\tЕсли СтрНайти(Запрос.Текст, Символы.ПС + \"УПОРЯДОЧИТЬ ПО\",, ПозВыбратьКонец) Тогда\r\n\t\tЗапрос.Текст = Лев(Запрос.Текст, СтрНайти(Запрос.Текст, Символы.ПС + \"УПОРЯДОЧИТЬ ПО\",, ПозВыбратьКонец));\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого парам из МакетКомпоновки.ЗначенияПараметров Цикл\r\n\t\tЗапрос.УстановитьПараметр(парам.Имя, парам.Значение);\r\n\tКонецЦикла;\r\n\t\r\n\tПопытка\r\n\t\tРезультат = Запрос.Выполнить();\r\n\tИсключение\r\n\t\tЗаписьЖурналаРегистрации(\"КоличествоВСписке в Списке \" + ЭтаФорма.ИмяФормы, УровеньЖурналаРегистрации.Ошибка,,, ОписаниеОшибки());\r\n\tКонецПопытки;\r\n\t\r\n\tВыборка = Результат.Выбрать();\r\n\tВыборка.Следующий();\r\n\t\r\n\tВозврат Выборка.Кол;\r\n\t\r\nКонецФункции\n\n// Возвращает количество строк динамического списка\r\n//\r\n// Параметры:\r\n//  ЭтаФорма - ФормаКлиентскогоПриложения - Форма клиентского приложения\r\n//  Список\t - строка - имя динамического списка\r\n// \r\n// Возвращаемое значение:\r\n//  Строка - количество строк в динамическом списке \r\n//\r\nФункция ПосчитатьКоличествоВДинамСписке(ЭтаФорма, Список) Экспорт\r\n\t\r\n\tСхема = ЭтаФорма.Элементы[Список].ПолучитьИсполняемуюСхемуКомпоновкиДанных();\r\n\tНастройки = ЭтаФорма.Элементы[Список].ПолучитьИсполняемыеНастройкиКомпоновкиДанных();\r\n\t\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных();\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(Схема, Настройки, , , Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = МакетКомпоновки.НаборыДанных.НаборДанныхДинамическогоСписка.Запрос;\r\n\t\r\n\tПозВыбратьНачало = СтрНайти(Запрос.Текст, \"ВЫБРАТЬ \", НаправлениеПоиска.СКонца);\r\n\tПока НЕ ПозВыбратьНачало = 1\r\n\t\tи НЕ Сред(Запрос.Текст, ПозВыбратьНачало - 1, 1) = Символы.ПС Цикл\r\n\t\tПозВыбратьНачало = СтрНайти(Запрос.Текст, \"ВЫБРАТЬ \", НаправлениеПоиска.СКонца, ПозВыбратьНачало - 1);\r\n\tКонецЦикла;\r\n\tПозВыбратьКонец = СтрНайти(Запрос.Текст, Символы.ПС,, ПозВыбратьНачало);\r\n\t\r\n\tСтрокаВЫБРАТЬ = Лев(Запрос.Текст, ПозВыбратьКонец);\r\n\tСтрокаИз = Сред(Запрос.Текст, СтрНайти(Запрос.Текст, Символы.ПС + \"ИЗ\" + Символы.ПС,, ПозВыбратьКонец));\r\n\t\r\n\tЕсли СтрНайти(СтрокаИз, Символы.ПС + \"СГРУППИРОВАТЬ\") Тогда\r\n\t\tСтрокаИз = Лев(СтрокаИз, СтрНайти(СтрокаИз, Символы.ПС + \"СГРУППИРОВАТЬ\"));\r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос.Текст = СтрокаВЫБРАТЬ + \"Количество(*) КАК Кол\" + СтрокаИз;\r\n\tЕсли СтрНайти(Запрос.Текст, Символы.ПС + \"УПОРЯДОЧИТЬ ПО\",, ПозВыбратьКонец) Тогда\r\n\t\tЗапрос.Текст = Лев(Запрос.Текст, СтрНайти(Запрос.Текст, Символы.ПС + \"УПОРЯДОЧИТЬ ПО\",, ПозВыбратьКонец));\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого парам из МакетКомпоновки.ЗначенияПараметров Цикл\r\n\t\tЗапрос.УстановитьПараметр(парам.Имя, парам.Значение);\r\n\tКонецЦикла;\r\n\t\r\n\tПопытка\r\n\t\tРезультат = Запрос.Выполнить();\r\n\tИсключение\r\n\t\tЗаписьЖурналаРегистрации(\"КоличествоВСписке в Списке \" + ЭтаФорма.ИмяФормы, УровеньЖурналаРегистрации.Ошибка,,, ОписаниеОшибки());\r\n\tКонецПопытки;\r\n\t\r\n\tВыборка = Результат.Выбрать();\r\n\tВыборка.Следующий();\r\n\t\r\n\tВозврат Выборка.Кол;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Восстановить положение окна программно",
    "description": "Восстановить положение окна программно",
    "code_snippet": "Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)\r\n    ЭтаФорма.ИмяСохраненияПоложенияОкна = Новый УникальныйИдентификатор();\r\nКонецПроцедуры\n\nПроцедура ПередОткрытием(Отказ, СтандартнаяОбработка)\r\n    ЭтаФорма.ИмяСохраненияПоложенияОкна = Новый УникальныйИдентификатор();\r\nКонецПроцедуры"
  },
  {
    "title": "Общая форма для вывода сообщений пользователю в HTML",
    "description": "Общая форма для вывода сообщений пользователю в HTML",
    "code_snippet": "СтруктураПараметров = Новый Структура(\"Заголовок, ТекстСообщения\");\n\tСтруктураПараметров.Заголовок = \"Заключено договоров за месяц\";\n\tHTML = \"\n\t\t|<style>\n\t\t|.xl68 {background:#D9E1F2;text-align:left;font-weight:700;}\n\t\t|</style>\n\t\t|<table border=1 cellpadding=2 cellspacing=0 style='border-collapse:collapse;'>\n\t\t| <tr align=center style='background:#D9E1F2'>\n\t\t|  <th style='background:white'>19.7.<br>О заключенных договорах</th>\n\t\t|  <th>1. Жилые помещения</th>\n\t\t|  <th>2. Нежилые помещения</th>\n\t\t|  <th>3. Машино-места</th>\n\t\t| </tr>\n\t\t| <tr align=right>\n\t\t|  <td class=xl68>19.7.1 Количество договоров</td>\n\t\t|  <td>%1</td>\n\t\t|  <td>%2</td>\n\t\t|  <td>%3</td>\n\t\t| </tr>\n\t\t| <tr align=right>\n\t\t|  <td class=xl68>19.7.2 Площади объектов</td>\n\t\t|  <td>%4</td>\n\t\t|  <td>%5</td>\n\t\t|  <td>%6</td>\n\t\t| </tr>\n\t\t| <tr align=right>\n\t\t|  <td class=xl68>19.7.3 Цена договоров</td>\n\t\t|  <td>%7</td>\n\t\t|  <td>%8</td>\n\t\t|  <td>%9</td>\n\t\t| </tr>\n\t\t|</table>\";\n\t\n\tСтруктураПараметров.ТекстСообщения = СтрШаблон(HTML, м[0], м[1], м[2], м[3], м[4], м[5], м[6], м[7], м[8]);\n\tОткрытьФорму(\"ОбщаяФорма.HTMLСообщение\", СтруктураПараметров);\n\n&НаСервере\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\n\t\n\tЗаголовок = Параметры.Заголовок;\n\tТекстСообщения = \"<html><body><table height=100% align=center><tr><td>\" + Параметры.ТекстСообщения + \"</td></tr></table></body></html>\";\n\t\nКонецПроцедуры\n\nСодержимое = \"<h1>Сообщение с тегами HTML</h1>\";\n\tФормаПросмотраHTML = Обработки.ДокументооборотСКонтролирующимиОрганами.ПолучитьФорму(\"ПросмотрHTML\");\n\t//ФормаПросмотраHTML.ИмяФайла = \"\";\n\tФормаПросмотраHTML.Содержимое = Содержимое;\n\tФормаПросмотраHTML.ОткрытьМодально();"
  },
  {
    "title": "Функция преобразует Массив из структур в ТаблицуЗначений",
    "description": "Функция преобразует Массив из структур в ТаблицуЗначений",
    "code_snippet": "&НаСервереБезКонтекста\r\nФункция ПреобразоватьМассивВТаблицуЗначений(мсДанные) \r\n    \r\n    тзДанные = Новый ТаблицаЗначений;\r\n    \r\n    Для Каждого ЭлементМассива Из мсДанные Цикл\r\n\t\t\r\n\t\tЕсли тзДанные.Колонки.Количество() = 0 Тогда\r\n            Для Каждого ЗначениеСтруктуры Из ЭлементМассива Цикл\r\n                тзДанные.Колонки.Добавить(ЗначениеСтруктуры.Ключ);\r\n            КонецЦикла;\r\n        КонецЕсли;\r\n        \r\n        НоваяСтрока = тзДанные.Добавить();\r\n        Для Каждого ЗначениеСтруктуры Из ЭлементМассива Цикл\r\n            НоваяСтрока[ЗначениеСтруктуры.Ключ] = ЗначениеСтруктуры.Значение;\r\n        КонецЦикла;\r\n    КонецЦикла;\r\n    \r\n    Возврат тзДанные;\r\n    \r\nКонецФункции\n\n&НаСервереБезКонтекста\r\nФункция ПреобразоватьМассивВТаблицуЗначений(мсДанные) \r\n    \r\n    тзДанные = Новый ТаблицаЗначений;\r\n    \r\n    Для Каждого ЭлементМассива Из мсДанные Цикл\r\n\t\t\r\n\t\tЕсли тзДанные.Колонки.Количество() = 0 Тогда\r\n            Для Каждого ЗначениеСтруктуры Из ЭлементМассива Цикл\r\n                тзДанные.Колонки.Добавить(ЗначениеСтруктуры.Ключ);\r\n            КонецЦикла;\r\n        КонецЕсли;\r\n        \r\n        НоваяСтрока = тзДанные.Добавить();\r\n        Для Каждого ЗначениеСтруктуры Из ЭлементМассива Цикл\r\n            НоваяСтрока[ЗначениеСтруктуры.Ключ] = ЗначениеСтруктуры.Значение;\r\n        КонецЦикла;\r\n    КонецЦикла;\r\n    \r\n    Возврат тзДанные;\r\n    \r\nКонецФункции"
  },
  {
    "title": "Прибавить рабочие дни к дате (Запрос)",
    "description": "Прибавить рабочие дни к дате (Запрос)",
    "code_snippet": "ВЫБРАТЬ РАЗЛИЧНЫЕ ПЕРВЫЕ 1000000\r\n\tКалендарь.ДатаКалендаря КАК ДатаКалендаря\r\nПОМЕСТИТЬ БанковскиеДниКалендаря\r\nИЗ\r\n\tРегистрСведений.РегламентированныйПроизводственныйКалендарь КАК Календарь\r\nГДЕ\r\n\t(Календарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Рабочий)\r\n\t\t\tИЛИ Календарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Предпраздничный))\r\n\r\nУПОРЯДОЧИТЬ ПО\r\n\tКалендарь.ДатаКалендаря\r\n\r\nИНДЕКСИРОВАТЬ ПО\r\n\tКалендарь.ДатаКалендаря\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tДАТАВРЕМЯ(2022, 4, 1) КАК ДатаДокумента,\r\n\t5 КАК ДнейОтсрочки\r\nПОМЕСТИТЬ ТаблицаОплат\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ\r\n\tДАТАВРЕМЯ(2022, 4, 9),\r\n\t7\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tОплаты.ДатаДокумента КАК ДатаДокумента,\r\n\tОплаты.ДнейОтсрочки КАК ДнейОтсрочки,\r\n\tКалендарь.ДатаКалендаря КАК ДатаОплаты\r\nИЗ\r\n\tТаблицаОплат КАК Оплаты\r\n\t\tЛЕВОЕ СОЕДИНЕНИЕ БанковскиеДниКалендаря КАК Календарь\r\n\t\tПО ((Календарь.ДатаКалендаря, Оплаты.ДнейОтсрочки) В\r\n\t\t\t\t(ВЫБРАТЬ\r\n\t\t\t\t\tВыборка.ДатаКалендаря КАК ДатаКалендаря,\r\n\t\t\t\t\tСУММА(1) КАК НомерРабочегоДня\r\n\t\t\t\tИЗ\r\n\t\t\t\t\tБанковскиеДниКалендаря КАК Выборка ЛЕВОЕ СОЕДИНЕНИЕ БанковскиеДниКалендаря КАК ПодВыборка\r\n\t\t\t\t\t\tПО\r\n\t\t\t\t\t\t\tПодВыборка.ДатаКалендаря > Оплаты.ДатаДокумента\r\n\t\t\t\t\t\t\t\tИ ПодВыборка.ДатаКалендаря <= Выборка.ДатаКалендаря\r\n\t\t\t\tГДЕ\r\n\t\t\t\t\tВыборка.ДатаКалендаря > Оплаты.ДатаДокумента\r\n\t\t\t\tСГРУППИРОВАТЬ ПО\r\n\t\t\t\t\t\t\tВыборка.ДатаКалендаря))\n\nВЫБРАТЬ РАЗЛИЧНЫЕ ПЕРВЫЕ 1000000\r\n\tКалендарь.ДатаКалендаря КАК ДатаКалендаря\r\nПОМЕСТИТЬ БанковскиеДниКалендаря\r\nИЗ\r\n\tРегистрСведений.РегламентированныйПроизводственныйКалендарь КАК Календарь\r\nГДЕ\r\n\t(Календарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Рабочий)\r\n\t\t\tИЛИ Календарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Предпраздничный))\r\n\r\nУПОРЯДОЧИТЬ ПО\r\n\tКалендарь.ДатаКалендаря\r\n\r\nИНДЕКСИРОВАТЬ ПО\r\n\tКалендарь.ДатаКалендаря\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tДАТАВРЕМЯ(2022, 4, 1) КАК ДатаДокумента,\r\n\t5 КАК ДнейОтсрочки\r\nПОМЕСТИТЬ ТаблицаОплат\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ\r\n\tДАТАВРЕМЯ(2022, 4, 9),\r\n\t7\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tОплаты.ДатаДокумента КАК ДатаДокумента,\r\n\tОплаты.ДнейОтсрочки КАК ДнейОтсрочки,\r\n\tКалендарь.ДатаКалендаря КАК ДатаОплаты\r\nИЗ\r\n\tТаблицаОплат КАК Оплаты\r\n\t\tЛЕВОЕ СОЕДИНЕНИЕ БанковскиеДниКалендаря КАК Календарь\r\n\t\tПО ((Календарь.ДатаКалендаря, Оплаты.ДнейОтсрочки) В\r\n\t\t\t\t(ВЫБРАТЬ\r\n\t\t\t\t\tВыборка.ДатаКалендаря КАК ДатаКалендаря,\r\n\t\t\t\t\tСУММА(1) КАК НомерРабочегоДня\r\n\t\t\t\tИЗ\r\n\t\t\t\t\tБанковскиеДниКалендаря КАК Выборка ЛЕВОЕ СОЕДИНЕНИЕ БанковскиеДниКалендаря КАК ПодВыборка\r\n\t\t\t\t\t\tПО\r\n\t\t\t\t\t\t\tПодВыборка.ДатаКалендаря > Оплаты.ДатаДокумента\r\n\t\t\t\t\t\t\t\tИ ПодВыборка.ДатаКалендаря <= Выборка.ДатаКалендаря\r\n\t\t\t\tГДЕ\r\n\t\t\t\t\tВыборка.ДатаКалендаря > Оплаты.ДатаДокумента\r\n\t\t\t\tСГРУППИРОВАТЬ ПО\r\n\t\t\t\t\t\t\tВыборка.ДатаКалендаря))\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Сравнить ТЗ",
    "description": "Сравнить ТЗ",
    "code_snippet": "// Предварительно надо отсортировать обе таблицы по одному и тому же уникальному ключу\r\n\tСтрВнутр_СтараяТЗ = ЗначениеВСтрокуВнутр(тзСтарыеПартииГТД.Скопировать());\r\n\tСтрВнутр_НоваяТЗ  = ЗначениеВСтрокуВнутр(тзНовыеПартииГТД.Скопировать());\r\n\r\n\tЕсли СтрВнутр_СтараяТЗ <> СтрВнутр_НоваяТЗ Тогда\n\n// Предварительно надо отсортировать обе таблицы по одному и тому же уникальному ключу\r\n\tСтрВнутр_СтараяТЗ = ЗначениеВСтрокуВнутр(тзСтарыеПартииГТД.Скопировать());\r\n\tСтрВнутр_НоваяТЗ  = ЗначениеВСтрокуВнутр(тзНовыеПартииГТД.Скопировать());\r\n\r\n\tЕсли СтрВнутр_СтараяТЗ <> СтрВнутр_НоваяТЗ Тогда"
  },
  {
    "title": "Транспонировать таблицу значений",
    "description": "Транспонировать таблицу значений",
    "code_snippet": "Функция ТранспонироватьТЗ(ТЗ)\r\n   \r\n\tТЗ2 = Новый ТаблицаЗначений;\r\n\tМассив = ТЗ.ВыгрузитьКолонку(ТЗ.Колонки[0]); // первая колонка содержит названия новых колонок\r\n\tТЗ2.Колонки.Добавить(ТЗ.Колонки[0].Имя); // старые названия колонок сохраним в первой колонке\r\n\t\r\n\tДля Каждого Значения из Массив Цикл\r\n\t\tТЗ2.Колонки.Добавить(СокрЛП(Значения));\r\n\tКонецЦикла;\r\n\t\r\n\tДля Сч = 1 По ТЗ.Колонки.Количество() - 1 Цикл\r\n\t\tТЗ2.Добавить();\r\n\t\tТЗ2[Сч - 1][ТЗ.Колонки[0].Имя] = ТЗ.Колонки[Сч].Имя;\r\n\tКонецЦикла;\r\n\t\r\n\tСчетчикСтрок = -1;\r\n\tДля каждого стр из Тз Цикл\r\n\t\tСчетчикСтрок = СчетчикСтрок + 1;\r\n\t\tМас = Новый Массив;\r\n\t\tДля Сч = 1 По ТЗ.Колонки.Количество() - 1 Цикл\r\n\t\t\tМас.Вставить(Сч - 1, стр[Сч]);\r\n\t\tКонецЦикла;\r\n\t\tТЗ2.ЗагрузитьКолонку(Мас, ТЗ2.Колонки[СчетчикСтрок + 1]);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат ТЗ2;\r\n   \r\nКонецФункции\n\nФункция ТранспонироватьТЗ(ТЗ)\r\n   \r\n\tТЗ2 = Новый ТаблицаЗначений;\r\n\tМассив = ТЗ.ВыгрузитьКолонку(ТЗ.Колонки[0]); // первая колонка содержит названия новых колонок\r\n\tТЗ2.Колонки.Добавить(ТЗ.Колонки[0].Имя); // старые названия колонок сохраним в первой колонке\r\n\t\r\n\tДля Каждого Значения из Массив Цикл\r\n\t\tТЗ2.Колонки.Добавить(СокрЛП(Значения));\r\n\tКонецЦикла;\r\n\t\r\n\tДля Сч = 1 По ТЗ.Колонки.Количество() - 1 Цикл\r\n\t\tТЗ2.Добавить();\r\n\t\tТЗ2[Сч - 1][ТЗ.Колонки[0].Имя] = ТЗ.Колонки[Сч].Имя;\r\n\tКонецЦикла;\r\n\t\r\n\tСчетчикСтрок = -1;\r\n\tДля каждого стр из Тз Цикл\r\n\t\tСчетчикСтрок = СчетчикСтрок + 1;\r\n\t\tМас = Новый Массив;\r\n\t\tДля Сч = 1 По ТЗ.Колонки.Количество() - 1 Цикл\r\n\t\t\tМас.Вставить(Сч - 1, стр[Сч]);\r\n\t\tКонецЦикла;\r\n\t\tТЗ2.ЗагрузитьКолонку(Мас, ТЗ2.Колонки[СчетчикСтрок + 1]);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат ТЗ2;\r\n   \r\nКонецФункции"
  },
  {
    "title": "Выгрузить динамический список в таблицу значений",
    "description": "Выгрузить динамический список в таблицу значений",
    "code_snippet": "&НаСервере\r\nФункция ПолучитьТЗизДинамическогоСписка()\r\n\r\n\tСхема = Элементы.Сделки.ПолучитьИсполняемуюСхемуКомпоновкиДанных();\r\n\tНастройки = Элементы.Сделки.ПолучитьИсполняемыеНастройкиКомпоновкиДанных();\r\n\t\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных();\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(Схема, Настройки, , , Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\t\r\n\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки);\r\n\t\r\n\tТабЗначений = Новый ТаблицаЗначений;\r\n\t\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\tПроцессорВывода.УстановитьОбъект(ТабЗначений);\r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновки, Истина);\r\n\t\r\n\tВозврат ТабЗначений;\r\n\r\nКонецФункции\n\n&НаСервере\r\nФункция ПолучитьТЗизДинамическогоСписка()\r\n\r\n\tСхема = Элементы.Сделки.ПолучитьИсполняемуюСхемуКомпоновкиДанных();\r\n\tНастройки = Элементы.Сделки.ПолучитьИсполняемыеНастройкиКомпоновкиДанных();\r\n\t\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных();\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(Схема, Настройки, , , Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\t\r\n\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки);\r\n\t\r\n\tТабЗначений = Новый ТаблицаЗначений;\r\n\t\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\tПроцессорВывода.УстановитьОбъект(ТабЗначений);\r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновки, Истина);\r\n\t\r\n\tВозврат ТабЗначений;\r\n\r\nКонецФункции"
  },
  {
    "title": "Простое добавление колонки в Динамический список",
    "description": "Простое добавление колонки в Динамический список",
    "code_snippet": "&НаСервере\r\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\r\n\t\r\n\tЧастиЗапроса = СтрРазделить(Список.ТекстЗапроса, \",\");\r\n\tЧастиЗапроса.Вставить(1, \"СправочникКонтрагенты.ПометкаУдаления\");\r\n\tСписок.ТекстЗапроса = СтрСоединить(ЧастиЗапроса, \",\");\r\n\t\r\n\tНовыйЭлемент  = Элементы.Добавить(\"СписокПометкаУдаления\", Тип(\"ПолеФормы\"), Элементы.Список);\r\n\tНовыйЭлемент.Вид = ВидПоляФормы.ПолеФлажка;      \r\n\tНовыйЭлемент.ПутьКДанным = \"Список.ПометкаУдаления\";\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\r\n\t\r\n\tЧастиЗапроса = СтрРазделить(Список.ТекстЗапроса, \",\");\r\n\tЧастиЗапроса.Вставить(1, \"СправочникКонтрагенты.ПометкаУдаления\");\r\n\tСписок.ТекстЗапроса = СтрСоединить(ЧастиЗапроса, \",\");\r\n\t\r\n\tНовыйЭлемент  = Элементы.Добавить(\"СписокПометкаУдаления\", Тип(\"ПолеФормы\"), Элементы.Список);\r\n\tНовыйЭлемент.Вид = ВидПоляФормы.ПолеФлажка;      \r\n\tНовыйЭлемент.ПутьКДанным = \"Список.ПометкаУдаления\";\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Передача менеджера временных таблиц в СКД",
    "description": "Передача менеджера временных таблиц в СКД",
    "code_snippet": "ВЫБОР КОГДА Ложь Тогда ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)\n    КОГДА Ложь ТОГДА ЗНАЧЕНИЕ(Справочник.МестаХранения.ПустаяСсылка)\nИНАЧЕ вт.пп\n\nВЫБРАТЬ РАЗРЕШЕННЫЕ\n\tНачисления.Сотрудник КАК Сотрудник,\n\tНачисления.НачислениеУдержание КАК ВидРасчета,\n\tНачисления.Сумма КАК Сумма,\n\tЕСТЬNULL(КадровыеДанные.Подразделение, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)) КАК Подразделение,\n\tЕСТЬNULL(КадровыеДанные.Должность, ЗНАЧЕНИЕ(Справочник.Должности.ПустаяСсылка)) КАК Должность,\n\tЕСТЬNULL(КадровыеДанные.ГрафикРаботы, ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)) КАК ГрафикРаботы,\n\tЕСТЬNULL(КадровыеДанные.ВидЗанятости, ЗНАЧЕНИЕ(Перечисление.ВидыЗанятости.ПустаяСсылка)) КАК ВидЗанятости\nИЗ\n\tРегистрНакопления.НачисленияУдержанияПоСотрудникам КАК Начисления\n\t\tЛЕВОЕ СОЕДИНЕНИЕ ВТКадровыеДанныеСотрудников КАК КадровыеДанные\n\t\tПО Начисления.Сотрудник = КадровыеДанные.Сотрудник\n\t\t\tИ Начисления.Период = КадровыеДанные.Период\nГДЕ\n\tНачисления.Период = &МесяцНачисления\n\nПроцедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\n    \n    СтандартнаяОбработка = Ложь;\n\t\tНастройки = КомпоновщикНастроек.ПолучитьНастройки();\n    МесяцНачисления = Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(\"МесяцНачисления\")).Значение;\n    \n    // Создаем МВТ\n    МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\n    \n    // Здесь наполняем МВТ данными\n    КадровыеДанные = КадровыйУчет.КадровыеДанныеСотрудников(Истина,, \"Подразделение, Должность, ГрафикРаботы, ВидЗанятости\", МесяцНачисления);\n    ЗарплатаКадры.СоздатьВТПоТаблицеЗначений(МенеджерВременныхТаблиц, КадровыеДанные, \"ВТКадровыеДанныеСотрудников\", Истина);\n    \n    КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\n    МакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, КомпоновщикНастроек.ПолучитьНастройки(), ДанныеРасшифровки,, Тип(\"ГенераторМакетаКомпоновкиДанных\"));\n    \n    // Здесь его используем\n    ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;\n    ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновкиДанных,, ДанныеРасшифровки, Истина,, МенеджерВременныхТаблиц);\n    \n    ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\n    ПроцессорВывода.УстановитьДокумент(ДокументРезультат);\n    ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);\n    \nКонецПроцедуры"
  },
  {
    "title": "Ввод по строке вхождением с доп параметрами и подсветкой вхождения",
    "description": "Ввод по строке вхождением с доп параметрами и подсветкой вхождения",
    "code_snippet": "//Параметры.ДопУсловияПоиска - строка - значение подставится в параметры запроса\n// Пример: Справочники.ПодразделенияОрганизаций.ПолучитьДанныеВыбора(Новый Структура(\"СтрокаПоиска, ВводПоСтрокеРасширенный, ДопУсловияПоиска\",\n//\t\tСтрокаПоиска, Истина, \n//\t\t\"И ПодразделенияОрганизаций.ПометкаУдаления = Ложь \n//\t\t|И ПодразделенияОрганизаций.КОРВ_ЭтоГруппаПодразделения = Ложь\n//\t\t|И ПодразделенияОрганизаций.Расформировано = Ложь\"))\n&После(\"ОбработкаПолученияДанныхВыбора\")\nПроцедура КОРВ_ОбработкаПолученияДанныхВыбора(ДанныеВыбора, Параметры, СтандартнаяОбработка)\n\t\n\tСтрокаПоиска = СтрЗаменить(Параметры.СтрокаПоиска, \"\"\"\", \"\"); // нормализация\n\t\n\tЕсли СтрокаПоиска <> \"\" И Параметры.Свойство(\"ВводПоСтрокеРасширенный\") Тогда\n\t\t\n\t\tМаксимумСтрокРезультата = 10;\n\t\t\n\t\tМассивСловПоиска     = СтрРазделить(СтрокаПоиска, \" \", Ложь);\n\t\tКоличествоСловПоиска = МассивСловПоиска.Количество();\n\t\t\n\t\tЕсли КоличествоСловПоиска > 0 Тогда\n\t\t\t\n\t\t\tМассивСоединенияУсловий    = Новый Массив;\n\t\t\tМассивСоединенияПриоритета = Новый Массив;\n\t\t\tСтандартнаяОбработка       = Ложь;\n\t\t\tСписокВыбора               = Новый СписокЗначений;\n\t\t\tЗапрос                     = Новый Запрос;\n\t\t\t\n\t\t\tЕсли Параметры.Свойство(\"ДопУсловияПоиска\") Тогда\t\t\t\t\n\t\t\t\t МассивСоединенияУсловий.Добавить(Параметры.ДопУсловияПоиска);\n\t\t\tКонецЕсли;\n\t\t\t\n\t\t\tЕсли Параметры.Свойство(\"ПараметрыЗапроса\") Тогда\t\t\t\t\n\t\t\t\tДля Каждого Парам Из Параметры.ПараметрыЗапроса Цикл \n\t\t\t\t\tЗапрос.Параметры.Вставить(Парам.Ключ, Парам.Значение);\n\t\t\t\tКонецЦикла;\n\t\t\tКонецЕсли;\n\t\t\t\n\t\t\tДля НомерСловаПоиска = 1 По КоличествоСловПоиска Цикл\n\t\t\t\t\n\t\t\t\tСловоПоиска      = МассивСловПоиска[НомерСловаПоиска - 1];\n\t\t\t\tДлинаСловаПоиска = СтрДлина(СловоПоиска);\n\t\t\t\t\n\t\t\t\tЗапрос.УстановитьПараметр(\"СловоПоиска\" + НомерСловаПоиска, \"%\" + СловоПоиска + \"%\");\n\t\t\t\t\n\t\t\t\tМассивСоединенияУсловий.Добавить(\"\n\t\t\t\t|\tИ (ПодразделенияОрганизаций.Наименование ПОДОБНО &СловоПоиска\" + НомерСловаПоиска + \"\n\t\t\t\t|  ИЛИ ПодразделенияОрганизаций.Код ПОДОБНО &СловоПоиска\" + НомерСловаПоиска + \")\");\n\t\t\t\t\n\t\t\t\tМассивСоединенияПриоритета.Добавить(СтрШаблон(\"\n\t\t\t\t|\t\tКОГДА ПОДСТРОКА(ПодразделенияОрганизаций.Наименование, 1, %1) = \"\"%2\"\"\n\t\t\t\t|\t\t  ТОГДА %3\", Формат(ДлинаСловаПоиска, \"ЧГ=\"), СловоПоиска, НомерСловаПоиска));\n\t\t\t\t\n\t\t\tКонецЦикла;\n\t\t\t\n\t\t\tПриоритетСортировки = СтрСоединить(МассивСоединенияПриоритета);\n\t\t\tУсловияПоиска       = СтрСоединить(МассивСоединенияУсловий,\"\");\n\t\t\t\n\t\t\tМассивСоединенияЗапроса = Новый Массив;\n\t\t\t\n\t\t\tМассивСоединенияЗапроса.Добавить(\"ВЫБРАТЬ ПЕРВЫЕ \");\n\t\t\tМассивСоединенияЗапроса.Добавить(МаксимумСтрокРезультата);\n\t\t\tМассивСоединенияЗапроса.Добавить(\"\n\t\t\t\t\t\t\t\t\t\t\t|\tПодразделенияОрганизаций.Ссылка КАК Ссылка,\n\t\t\t\t\t\t\t\t\t\t\t|\tПодразделенияОрганизаций.Код КАК Код,\n\t\t\t\t\t\t\t\t\t\t\t|\tПодразделенияОрганизаций.Наименование КАК Наименование,\n\t\t\t\t\t\t\t\t\t\t\t|\tПодразделенияОрганизаций.ПометкаУдаления КАК ПометкаУдаления,\n\t\t\t\t\t\t\t\t\t\t\t|\tВЫБОР\");\n\t\t\tМассивСоединенияЗапроса.Добавить(ПриоритетСортировки);\n\t\t\tМассивСоединенияЗапроса.Добавить(\"\n\t\t\t\t\t\t\t\t\t\t\t|\t\tИНАЧЕ 9\n\t\t\t\t\t\t\t\t\t\t\t|\tКОНЕЦ КАК ПриоритетСортировки\n\t\t\t\t\t\t\t\t\t\t\t|ИЗ\n\t\t\t\t\t\t\t\t\t\t\t|\tСправочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций\n\t\t\t\t\t\t\t\t\t\t\t|ГДЕ\n\t\t\t\t\t\t\t\t\t\t\t|\tИСТИНА \");\n\t\t\tМассивСоединенияЗапроса.Добавить(УсловияПоиска);\n\t\t\tМассивСоединенияЗапроса.Добавить(\"\n\t\t\t\t\t\t\t\t\t\t\t|УПОРЯДОЧИТЬ ПО\n\t\t\t\t\t\t\t\t\t\t\t|\tПриоритетСортировки, Наименование\");\n\t\t\t\n\t\t\tЗапрос.Текст = СтрСоединить(МассивСоединенияЗапроса);\n\t\t\t\n\t\t\tВыборка = Запрос.Выполнить().Выбрать(); \n\t\t\t\n\t\t\tПока Выборка.Следующий() Цикл\n\t\t\t\t\n\t\t\t\tСписокВыбора.Добавить(Новый Структура(\"Значение, ПометкаУдаления\", Выборка.Ссылка, Выборка.ПометкаУдаления), ПодсветитьСлова(Выборка.Наименование + \n\t\t\t\t\t\t\t\t\t\t\" (\" + Выборка.Код + \")\", МассивСловПоиска));\n\t\t\t\t\n\t\t\tКонецЦикла;\n\t\t\t\n\t\t\tДанныеВыбора = СписокВыбора;\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\tКонецЕсли; \n\t\nКонецПроцедуры\n\nФункция ПодсветитьСлова(ИсходнаяСтрока, МассивСловПодсветки, Знач ШрифтПодсветки = Неопределено, Знач ЦветПодсветки = Неопределено)\n\t\n\tМассивРезультирующихСтрок = Новый Массив;\n\t\n\tЕсли ШрифтПодсветки = Неопределено Тогда\n\t\tШрифтПодсветки = Новый Шрифт(,, Истина); // жирный\n\tКонецЕсли;\n\t\n\tЕсли ЦветПодсветки = Неопределено Тогда\n\t\tЦветПодсветки = Новый Цвет(0, 153, 0); // светло-зеленый из стандартной подсветки ввода по строке\n\tКонецЕсли;\n\t\n\tИсходнаяСтрокаНормализованная = НРег(ИсходнаяСтрока); // нормализация\n\tДлинаИсходнойСтроки = СтрДлина(ИсходнаяСтрокаНормализованная);\n\t\n\t// получим список диапазонов символов для подсветки\n\tСписокДиапазонов = Новый СписокЗначений;\n\tДля НомерСлова = 1 По МассивСловПодсветки.Количество() Цикл\n\t\tСловоПодсветки     = НРег(МассивСловПодсветки[НомерСлова - 1]); // нормализация\n\t\tПозицияНачалаСлова = 1;\n\t\tДлинаСлова         = СтрДлина(СловоПодсветки);\n\t\tПока ПозицияНачалаСлова <> 0 И ПозицияНачалаСлова <= ДлинаИсходнойСтроки Цикл\n\t\t\tПозицияНачалаСлова = СтрНайти(ИсходнаяСтрокаНормализованная, СловоПодсветки, , ПозицияНачалаСлова);\n\t\t\tЕсли ПозицияНачалаСлова > 0 Тогда\n\t\t\t\tМассивДиапазона = Новый Массив;\n\t\t\t\tМассивДиапазона.Добавить(ПозицияНачалаСлова);\n\t\t\t\tМассивДиапазона.Добавить(ПозицияНачалаСлова + ДлинаСлова - 1);\n\t\t\t\tСписокДиапазонов.Добавить(МассивДиапазона, Формат(ПозицияНачалаСлова, \"ЧЦ=3; ЧВН=\"));\n\t\t\t\tПозицияНачалаСлова = ПозицияНачалаСлова + ДлинаСлова;\n\t\t\tКонецЕсли;\n\t\tКонецЦикла;\n\tКонецЦикла;\n\t\n\t// отсортируем список диапазонов по возрастанию начал диапазонов\n\tСписокДиапазонов.СортироватьПоПредставлению();\n\t\n\t// сформируем массив результирующих строк с разным оформлением (подсветкой)\n\tСтартоваяПозиция = 1;\n\tДля Каждого ЭлементДиапазона Из СписокДиапазонов Цикл\n\t\tНачалоДиапазона = ЭлементДиапазона.Значение[0];\n\t\tКонецДиапазона  = ЭлементДиапазона.Значение[1];\n\t\tЕсли НачалоДиапазона > СтартоваяПозиция Тогда // часть строки без подсветки\n\t\t\tЧастьБезВыделения = Сред(ИсходнаяСтрока, СтартоваяПозиция, НачалоДиапазона - СтартоваяПозиция);\n\t\t\tМассивРезультирующихСтрок.Добавить(Новый ФорматированнаяСтрока(ЧастьБезВыделения));\n\t\t\tСтартоваяПозиция = НачалоДиапазона;\n\t\tКонецЕсли;\n\t\tЕсли КонецДиапазона >= СтартоваяПозиция Тогда // часть строки с подсветкой\n\t\t\tЧастьВыделяемая = Сред(ИсходнаяСтрока, СтартоваяПозиция, КонецДиапазона - СтартоваяПозиция + 1);\n\t\t\tМассивРезультирующихСтрок.Добавить(Новый ФорматированнаяСтрока(ЧастьВыделяемая, ШрифтПодсветки, ЦветПодсветки));\n\t\t\tСтартоваяПозиция = КонецДиапазона + 1;\n\t\tКонецЕсли;\n\tКонецЦикла;\n\t\n\tЕсли СтартоваяПозиция <= ДлинаИсходнойСтроки Тогда // \"хвост\" без выделения\n\t\tХвост = Сред(ИсходнаяСтрока, СтартоваяПозиция, ДлинаИсходнойСтроки - СтартоваяПозиция + 1);\n\t\tМассивРезультирующихСтрок.Добавить(Новый ФорматированнаяСтрока(Хвост));\n\tКонецЕсли;\n\t\n\tВозврат Новый ФорматированнаяСтрока(МассивРезультирующихСтрок);\n\t\nКонецФункции\n\n&НаКлиенте\nПроцедура КОРВ_КОРВ_ПодразделениеАвтоПодборПосле(Элемент, Текст, ДанныеВыбора, ПараметрыПолученияДанных, Ожидание, СтандартнаяОбработка)\n\tСтандартнаяОбработка = Ложь;\n\tДанныеВыбора = ПолучитьДанныеВыбораРасширенные(Текст);\nКонецПроцедуры\n\n&НаСервереБезКонтекста\nФункция ПолучитьДанныеВыбораРасширенные(СтрокаПоиска)\n\t\n\tВозврат Справочники.ПодразделенияОрганизаций.ПолучитьДанныеВыбора(Новый Структура(\"СтрокаПоиска, ВводПоСтрокеРасширенный, ДопУсловияПоиска\",\n\t\tСтрокаПоиска, Истина, \n\t\t\"И ПодразделенияОрганизаций.ПометкаУдаления = Ложь И ПодразделенияОрганизаций.КОРВ_ЭтоГруппаПодразделения = Ложь\n\t\t|И ПодразделенияОрганизаций.Расформировано = Ложь\"));\n\t\nКонецФункции"
  },
  {
    "title": "Получить web-cсылку на объект метаданных",
    "description": "Получить web-cсылку на объект метаданных",
    "code_snippet": "Функция ПолучитьWebСсылкуНаОбъект(Объект) Экспорт\n\n\tНавСсылка = ПолучитьНавигационнуюСсылку(Объект);\n\tДлинаСтроки = СтрДлина(НавСсылка);\n\tПозицияРеф \t= СтрНайти(НавСсылка, \"?ref\");\n\tНавСсылка \t= Прав(НавСсылка, ДлинаСтроки - ПозицияРеф + 1) + \"#\" + Лев(НавСсылка, ПозицияРеф - 1);\n\tСтрокаСоединения = СтрокаСоединенияИнформационнойБазы();\n\tsrv = НСтр(СтрокаСоединения, \"Srvr\");\n\tref = НСтр(СтрокаСоединения, \"Ref\");\n\tНавСсылка \t= \"e1c://server/\"+ srv + \"/\" + ref + НавСсылка;\t\t\n\tВозврат НавСсылка;\n\t\nКонецФункции\n\nПолучитьВнешнююНавигационнуюСсылку(, ПолучитьНавигационнуюСсылку(СсылкаНаОбъект));"
  },
  {
    "title": "Фильтрация таблицы значений",
    "description": "Фильтрация таблицы значений",
    "code_snippet": "// ТаблицаОтборов - Таблица значений с колонками\r\n// ИмяОтбора - Строка\r\n// ВидСравнения - ВидСравнения\r\n// Значение - Any\r\n// Возвращает отфильтрованную таблицу значений\r\n\r\nФункция ОтфильтроватьТаблицуЗначений(ТаблицаЗначенийДляФильтрации, ТаблицаОтборов)\r\n\r\n\tПостроитель                = Новый ПостроительЗапроса;\r\n\tПостроитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТаблицаЗначенийДляФильтрации);\r\n\r\n\tДля Каждого СтрокаКоллекции Из ТаблицаОтборов Цикл\r\n\t\tОтбор                     = Построитель.Отбор.Добавить(СтрокаКоллекции.ИмяОтбора);\r\n\t\tОтбор.ВидСравнения        = СтрокаКоллекции.ВидСравнения;\r\n\t\tОтбор.Использование       = Истина;\r\n\t\tОтбор.Значение            = СтрокаКоллекции.Значение;\r\n\tКонецЦикла;\r\n\r\n\tВозврат Построитель.Результат.Выгрузить();\r\n\r\nКонецФункции\n\n// ТаблицаОтборов - Таблица значений с колонками\r\n// ИмяОтбора - Строка\r\n// ВидСравнения - ВидСравнения\r\n// Значение - Any\r\n// Возвращает отфильтрованную таблицу значений\r\n\r\nФункция ОтфильтроватьТаблицуЗначений(ТаблицаЗначенийДляФильтрации, ТаблицаОтборов)\r\n\r\n\tПостроитель                = Новый ПостроительЗапроса;\r\n\tПостроитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТаблицаЗначенийДляФильтрации);\r\n\r\n\tДля Каждого СтрокаКоллекции Из ТаблицаОтборов Цикл\r\n\t\tОтбор                     = Построитель.Отбор.Добавить(СтрокаКоллекции.ИмяОтбора);\r\n\t\tОтбор.ВидСравнения        = СтрокаКоллекции.ВидСравнения;\r\n\t\tОтбор.Использование       = Истина;\r\n\t\tОтбор.Значение            = СтрокаКоллекции.Значение;\r\n\tКонецЦикла;\r\n\r\n\tВозврат Построитель.Результат.Выгрузить();\r\n\r\nКонецФункции"
  },
  {
    "title": "Определить это Linux или Windows",
    "description": "Определить это Linux или Windows",
    "code_snippet": "СистемнаяИнформация = Новый СистемнаяИнформация;\r\nЭтоLinux = СистемнаяИнформация.ТипПлатформы = ТипПлатформы.Linux_x86 ИЛИ СистемнаяИнформация.ТипПлатформы.Linux_x86_64;\n\nСистемнаяИнформация = Новый СистемнаяИнформация;\r\nЭтоLinux = СистемнаяИнформация.ТипПлатформы = ТипПлатформы.Linux_x86 ИЛИ СистемнаяИнформация.ТипПлатформы.Linux_x86_64;\n\n{2} Переменной ЭтоLinux присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Раскрасить код",
    "description": "Раскрасить код",
    "code_snippet": "//Вспомогательная, используется в \"РаскраситьКод1С8\"\r\nПроцедура ДобавитьСлово(Код, Слово, ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, ТипСлова=Неопределено)\r\n    Если ПустаяСтрока(Слово) Тогда\r\n        Код = Код + СтрЗаменить(СтрЗаменить(СтрЗаменить(Слово, \" \", \" \"), Символы.НПП, \" \"), Символы.Таб, \"    \");\r\n        Возврат;\r\n    ИначеЕсли ТипСлова=Неопределено Тогда\r\n        нсл = НРег(СокрП(Слово));\r\n        Если Найти(СписокКлючевыхСлов, нсл)>0 Тогда\r\n            ТипСлова = \"<keywrd>\";\r\n        ИначеЕсли Слово = \"0\" или мОписаниеТипаЧисло.ПривестиЗначение(Слово)<>0 Тогда\r\n            ТипСлова = \"<num>\";\r\n        Иначе\r\n            ТипСлова = \"<text>\";\r\n            ЭтоЧисло = Истина;\r\n            Для сч=1 по СтрДлина(нсл) Цикл\r\n                ТекСимв=Сред(нсл, сч, 1);\r\n                Если Найти(ДопустимыеЗнаки, ТекСимв)=0 Тогда\r\n                    ТипСлова=\"<unwn>\";\r\n                    Прервать;\r\n                ИначеЕсли ТекСимв<>\"0\" Тогда\r\n                    ЭтоЧисло = Ложь;\r\n                КонецЕсли;\r\n            КонецЦикла;\r\n            Если ЭтоЧисло Тогда\r\n                ТипСлова = \"<num>\";\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    Код = Код + ?(ТекТипСлова=ТипСлова, \"\", ТипСлова) + СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(Слово, \"<\", \"<\"), \">\", \">\"), \" \", \" \"), Символы.НПП, \" \"), Символы.Таб, \"    \");\r\n    ТекТипСлова = ТипСлова;\r\n    Слово = \"\";\r\nКонецПроцедуры\r\n\r\n//Реализует функционал \"Оформить фрагмент кода\"\r\nФункция РаскраситьКод1С8(ТекстКод) Экспорт\r\n    мОписаниеТипаЧисло = Новый ОписаниеТипов(\"Число\");\r\n    Таб = Символы.Таб;\r\n    НПП = Символы.НПП;\r\n    ДопустимыеЗнаки = \"абвгдеёжзийклмнопрстуфхцчшщъыьэюя0123456789abcdefghijklmnopqrstyvwxyz_\";\r\n    СписокКлючевыхСлов = \"асинх|async|ждать|await|if|если|then|тогда|elsif|иначеесли|else|иначе|endif|конецесли|do|цикл|for|для|to|по|each|каждого|in|из|while|пока|enddo|конеццикла|procedure|процедура|endprocedure|конецпроцедуры|function|функция|endfunction|конецфункции|var|перем|export|экспорт|goto|перейти|and|и|or|или|not|не|val|знач|break|прервать|continue|продолжить|return|возврат|try|попытка|except|исключение|endtry|конецпопытки|raise|вызватьисключение|false|ложь|true|истина|undefined|неопределено|null|new|новый|execute|выполнить|\";\r\n    Ответ = \"<span style=\"\"text-align: left; font-family: courier new,courier; color: blue; font-size: 10pt; white-space: pre; display: inline-block; \"\"><font>\";\r\n    ТекТипСлова = \"<text>\";\r\n    Для нс=1 По СтрЧислоСтрок(ТекстКод) Цикл\r\n        ТекСтрока = СокрП(СтрПолучитьСтроку(ТекстКод, нс));\r\n        дл = СтрДлина(ТекСтрока);\r\n        сч = 0;\r\n        ТекСлово = \"\";\r\n        КодНеНачался = Истина;\r\n        Пока сч<дл Цикл\r\n            сч = сч + 1;\r\n            ТекущийСимвол = Сред(ТекСтрока, сч, 1);\r\n            Если КодНеНачался Тогда\r\n                Если ТекущийСимвол=\" \" Или ТекущийСимвол=Таб Или ТекущийСимвол=НПП Тогда\r\n                    //ТекущийСимвол = ?(ТекущийСимвол=\" \" или ТекущийСимвол=НПП, \" \", \"    \");\r\n                    Ответ = Ответ + ТекущийСимвол;\r\n                    Продолжить;\r\n                ИначеЕсли ТекущийСимвол=\"#\" или ТекущийСимвол=\"&\" Тогда\r\n                    ТекСлово = \"\";\r\n                    ДобавитьСлово(Ответ, Сред(ТекСтрока, сч), ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, \"<dir>\");\r\n                    Прервать;\r\n                КонецЕсли;\r\n            КонецЕсли;\r\n            КодНеНачался = Ложь;            \r\n            Если ТекущийСимвол=\" \" Или ТекущийСимвол=Таб Или ТекущийСимвол=НПП Тогда\r\n                Если КодНеНачался Тогда\r\n                    Ответ = Ответ + ТекущийСимвол;\r\n                    Продолжить;\r\n                КонецЕсли;\r\n                //ТекущийСимвол = ?(ТекущийСимвол=\" \" или ТекущийСимвол=НПП, \" \", \"    \");\r\n                ДобавитьСлово(Ответ, ТекСлово+ТекущийСимвол, ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло);\r\n                ТекСлово = \"\";\r\n                Продолжить;\r\n            ИначеЕсли Найти(\"():;.,=+-*<>?[]%/\", ТекущийСимвол) > 0 Тогда\r\n                ДобавитьСлово(Ответ, ТекСлово, ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло);\r\n                ТекСлово = \"\";\r\n                //Проверяем на комментарий\r\n                Если ТекущийСимвол=\"/\" и Сред(ТекСтрока, сч+1, 1)=\"/\" Тогда\r\n                    ТекСлово = \"\";\r\n                    ДобавитьСлово(Ответ, СокрП(Сред(ТекСтрока, сч)), ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, \"<cmnt>\");\r\n                    Прервать;\r\n                КонецЕсли;    \r\n                ДобавитьСлово(Ответ, ТекущийСимвол, ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, \"<symb>\");\r\n                Продолжить;\r\n            ИначеЕсли ТекущийСимвол=\"\"\"\" или ТекущийСимвол=\"|\" Тогда\r\n                ДобавитьСлово(Ответ, ТекСлово, ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло);\r\n                // найти закрывающую кавычку\r\n                нач = сч;\r\n                сч = сч + 1;\r\n                СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                Пока сч<дл Цикл\r\n                    сч = сч + 1;\r\n                    ТекущийСимвол = СледующийСимвол;\r\n                    СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                    Если ТекущийСимвол=\"\"\"\" Тогда\r\n                        Если СледующийСимвол=\"\"\"\" Тогда\r\n                            сч = сч + 1;\r\n                            СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                        Иначе\r\n                            Прервать;\r\n                        КонецЕсли;\r\n                    КонецЕсли;\r\n                КонецЦикла;\r\n                ТекСлово = \"\";\r\n                ДобавитьСлово(Ответ, Сред(ТекСтрока, нач, сч-нач), ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, \"<str>\");\r\n                сч = сч - 1;\r\n                Продолжить;\r\n            ИначеЕсли ТекущийСимвол=\"'\" Тогда\r\n                нач = сч;\r\n                сч = сч + 1;\r\n                СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                Пока сч<дл Цикл\r\n                    сч = сч + 1;\r\n                    ТекущийСимвол = СледующийСимвол;\r\n                    СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                    Если ТекущийСимвол=\"'\" Тогда\r\n                        Если СледующийСимвол=\"'\" Тогда\r\n                            сч = сч + 1;\r\n                            СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                        Иначе\r\n                            Прервать;\r\n                        КонецЕсли;\r\n                    КонецЕсли;\r\n                КонецЦикла;\r\n                ТекСлово = \"\";\r\n                ДобавитьСлово(Ответ, Сред(ТекСтрока, нач, сч-нач), ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, \"<str>\");\r\n                сч = сч - 1;\r\n                Продолжить;\r\n            КонецЕсли;\r\n            ТекСлово = ТекСлово + ТекущийСимвол;\r\n        КонецЦикла;\r\n        Если Не ПустаяСтрока(ТекСлово) Тогда\r\n            ДобавитьСлово(Ответ,СокрП(ТекСлово), ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло);\r\n        КонецЕсли;\r\n        Ответ = Ответ + \"\";\r\n    КонецЦикла;    \r\n    Ответ = Ответ + Символы.ПС+\"</font></span>\";\r\n    Ответ = СтрЗаменить(Ответ, \"<keywrd>\", \"</font><font color=red>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<text>\", \"</font><font color=blue>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<str>\", \"</font><font color=black>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<num>\", \"</font><font color=black>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<unwn>\", \"</font><font color=black>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<symb>\", \"</font><font color=red>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<cmnt>\", \"</font><font color=green>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<dir>\", \"</font><font color=brown>\");    \r\n    Ответ = СтрЗаменить(Ответ, Символы.Таб, \"    \");\r\n    Возврат Ответ;\r\nКонецФункции\n\n//Вспомогательная, используется в \"РаскраситьКод1С8\"\r\nПроцедура ДобавитьСлово(Код, Слово, ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, ТипСлова=Неопределено)\r\n    Если ПустаяСтрока(Слово) Тогда\r\n        Код = Код + СтрЗаменить(СтрЗаменить(СтрЗаменить(Слово, \" \", \" \"), Символы.НПП, \" \"), Символы.Таб, \"    \");\r\n        Возврат;\r\n    ИначеЕсли ТипСлова=Неопределено Тогда\r\n        нсл = НРег(СокрП(Слово));\r\n        Если Найти(СписокКлючевыхСлов, нсл)>0 Тогда\r\n            ТипСлова = \"<keywrd>\";\r\n        ИначеЕсли Слово = \"0\" или мОписаниеТипаЧисло.ПривестиЗначение(Слово)<>0 Тогда\r\n            ТипСлова = \"<num>\";\r\n        Иначе\r\n            ТипСлова = \"<text>\";\r\n            ЭтоЧисло = Истина;\r\n            Для сч=1 по СтрДлина(нсл) Цикл\r\n                ТекСимв=Сред(нсл, сч, 1);\r\n                Если Найти(ДопустимыеЗнаки, ТекСимв)=0 Тогда\r\n                    ТипСлова=\"<unwn>\";\r\n                    Прервать;\r\n                ИначеЕсли ТекСимв<>\"0\" Тогда\r\n                    ЭтоЧисло = Ложь;\r\n                КонецЕсли;\r\n            КонецЦикла;\r\n            Если ЭтоЧисло Тогда\r\n                ТипСлова = \"<num>\";\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    Код = Код + ?(ТекТипСлова=ТипСлова, \"\", ТипСлова) + СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(Слово, \"<\", \"<\"), \">\", \">\"), \" \", \" \"), Символы.НПП, \" \"), Символы.Таб, \"    \");\r\n    ТекТипСлова = ТипСлова;\r\n    Слово = \"\";\r\nКонецПроцедуры\r\n\r\n//Реализует функционал \"Оформить фрагмент кода\"\r\nФункция РаскраситьКод1С8(ТекстКод) Экспорт\r\n    мОписаниеТипаЧисло = Новый ОписаниеТипов(\"Число\");\r\n    Таб = Символы.Таб;\r\n    НПП = Символы.НПП;\r\n    ДопустимыеЗнаки = \"абвгдеёжзийклмнопрстуфхцчшщъыьэюя0123456789abcdefghijklmnopqrstyvwxyz_\";\r\n    СписокКлючевыхСлов = \"асинх|async|ждать|await|if|если|then|тогда|elsif|иначеесли|else|иначе|endif|конецесли|do|цикл|for|для|to|по|each|каждого|in|из|while|пока|enddo|конеццикла|procedure|процедура|endprocedure|конецпроцедуры|function|функция|endfunction|конецфункции|var|перем|export|экспорт|goto|перейти|and|и|or|или|not|не|val|знач|break|прервать|continue|продолжить|return|возврат|try|попытка|except|исключение|endtry|конецпопытки|raise|вызватьисключение|false|ложь|true|истина|undefined|неопределено|null|new|новый|execute|выполнить|\";\r\n    Ответ = \"<span style=\"\"text-align: left; font-family: courier new,courier; color: blue; font-size: 10pt; white-space: pre; display: inline-block; \"\"><font>\";\r\n    ТекТипСлова = \"<text>\";\r\n    Для нс=1 По СтрЧислоСтрок(ТекстКод) Цикл\r\n        ТекСтрока = СокрП(СтрПолучитьСтроку(ТекстКод, нс));\r\n        дл = СтрДлина(ТекСтрока);\r\n        сч = 0;\r\n        ТекСлово = \"\";\r\n        КодНеНачался = Истина;\r\n        Пока сч<дл Цикл\r\n            сч = сч + 1;\r\n            ТекущийСимвол = Сред(ТекСтрока, сч, 1);\r\n            Если КодНеНачался Тогда\r\n                Если ТекущийСимвол=\" \" Или ТекущийСимвол=Таб Или ТекущийСимвол=НПП Тогда\r\n                    //ТекущийСимвол = ?(ТекущийСимвол=\" \" или ТекущийСимвол=НПП, \" \", \"    \");\r\n                    Ответ = Ответ + ТекущийСимвол;\r\n                    Продолжить;\r\n                ИначеЕсли ТекущийСимвол=\"#\" или ТекущийСимвол=\"&\" Тогда\r\n                    ТекСлово = \"\";\r\n                    ДобавитьСлово(Ответ, Сред(ТекСтрока, сч), ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, \"<dir>\");\r\n                    Прервать;\r\n                КонецЕсли;\r\n            КонецЕсли;\r\n            КодНеНачался = Ложь;            \r\n            Если ТекущийСимвол=\" \" Или ТекущийСимвол=Таб Или ТекущийСимвол=НПП Тогда\r\n                Если КодНеНачался Тогда\r\n                    Ответ = Ответ + ТекущийСимвол;\r\n                    Продолжить;\r\n                КонецЕсли;\r\n                //ТекущийСимвол = ?(ТекущийСимвол=\" \" или ТекущийСимвол=НПП, \" \", \"    \");\r\n                ДобавитьСлово(Ответ, ТекСлово+ТекущийСимвол, ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло);\r\n                ТекСлово = \"\";\r\n                Продолжить;\r\n            ИначеЕсли Найти(\"():;.,=+-*<>?[]%/\", ТекущийСимвол) > 0 Тогда\r\n                ДобавитьСлово(Ответ, ТекСлово, ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло);\r\n                ТекСлово = \"\";\r\n                //Проверяем на комментарий\r\n                Если ТекущийСимвол=\"/\" и Сред(ТекСтрока, сч+1, 1)=\"/\" Тогда\r\n                    ТекСлово = \"\";\r\n                    ДобавитьСлово(Ответ, СокрП(Сред(ТекСтрока, сч)), ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, \"<cmnt>\");\r\n                    Прервать;\r\n                КонецЕсли;    \r\n                ДобавитьСлово(Ответ, ТекущийСимвол, ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, \"<symb>\");\r\n                Продолжить;\r\n            ИначеЕсли ТекущийСимвол=\"\"\"\" или ТекущийСимвол=\"|\" Тогда\r\n                ДобавитьСлово(Ответ, ТекСлово, ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло);\r\n                // найти закрывающую кавычку\r\n                нач = сч;\r\n                сч = сч + 1;\r\n                СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                Пока сч<дл Цикл\r\n                    сч = сч + 1;\r\n                    ТекущийСимвол = СледующийСимвол;\r\n                    СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                    Если ТекущийСимвол=\"\"\"\" Тогда\r\n                        Если СледующийСимвол=\"\"\"\" Тогда\r\n                            сч = сч + 1;\r\n                            СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                        Иначе\r\n                            Прервать;\r\n                        КонецЕсли;\r\n                    КонецЕсли;\r\n                КонецЦикла;\r\n                ТекСлово = \"\";\r\n                ДобавитьСлово(Ответ, Сред(ТекСтрока, нач, сч-нач), ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, \"<str>\");\r\n                сч = сч - 1;\r\n                Продолжить;\r\n            ИначеЕсли ТекущийСимвол=\"'\" Тогда\r\n                нач = сч;\r\n                сч = сч + 1;\r\n                СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                Пока сч<дл Цикл\r\n                    сч = сч + 1;\r\n                    ТекущийСимвол = СледующийСимвол;\r\n                    СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                    Если ТекущийСимвол=\"'\" Тогда\r\n                        Если СледующийСимвол=\"'\" Тогда\r\n                            сч = сч + 1;\r\n                            СледующийСимвол = Сред(ТекСтрока, сч, 1);\r\n                        Иначе\r\n                            Прервать;\r\n                        КонецЕсли;\r\n                    КонецЕсли;\r\n                КонецЦикла;\r\n                ТекСлово = \"\";\r\n                ДобавитьСлово(Ответ, Сред(ТекСтрока, нач, сч-нач), ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло, \"<str>\");\r\n                сч = сч - 1;\r\n                Продолжить;\r\n            КонецЕсли;\r\n            ТекСлово = ТекСлово + ТекущийСимвол;\r\n        КонецЦикла;\r\n        Если Не ПустаяСтрока(ТекСлово) Тогда\r\n            ДобавитьСлово(Ответ,СокрП(ТекСлово), ТекТипСлова, СписокКлючевыхСлов, ДопустимыеЗнаки, мОписаниеТипаЧисло);\r\n        КонецЕсли;\r\n        Ответ = Ответ + \"\";\r\n    КонецЦикла;    \r\n    Ответ = Ответ + Символы.ПС+\"</font></span>\";\r\n    Ответ = СтрЗаменить(Ответ, \"<keywrd>\", \"</font><font color=red>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<text>\", \"</font><font color=blue>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<str>\", \"</font><font color=black>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<num>\", \"</font><font color=black>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<unwn>\", \"</font><font color=black>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<symb>\", \"</font><font color=red>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<cmnt>\", \"</font><font color=green>\");\r\n    Ответ = СтрЗаменить(Ответ, \"<dir>\", \"</font><font color=brown>\");    \r\n    Ответ = СтрЗаменить(Ответ, Символы.Таб, \"    \");\r\n    Возврат Ответ;\r\nКонецФункции\n\nОрфографическая ошибка в keywrd (найдено 2): keywrd\r\nОрфографическая ошибка в unwn (найдено 2): unwn\r\nОрфографическая ошибка в абвгдеёжзийклмнопрстуфхцчшщъыьэюя0123456789abcdefghijklmnopqrstyvwxyz_: абвгдеёжзийклмнопрстуфхцчшщъыьэюя\r\nОрфографическая ошибка в асинх: асинх\r\nОрфографическая ошибка в endprocedure: endprocedure\r\nОрфографическая ошибка в endtry: endtry\r\nОрфографическая ошибка в конецпопытки: конецпопытки\r\nОрфографическая ошибка в cmnt (найдено 2): cmnt\r\nОрфографическая ошибка в symb (найдено 2): symb"
  },
  {
    "title": "Формат даты в СКД",
    "description": "Формат даты в СКД",
    "code_snippet": ""
  },
  {
    "title": "Генератор обработчиков оповещения",
    "description": "Скрипт для TurboConf реализует вставку в текст модуля конструкцию создания нового описания оповещения, а также саму процедуру-обработчик для него.",
    "code_snippet": ""
  },
  {
    "title": "Объединение табличных документов",
    "description": "Объединение табличных документов",
    "code_snippet": "&После(\"Печать\")\nПроцедура ДопПечать_Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода)\n\t\n\tЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, \"РасходныйОрдер\") Тогда\n\t\t\n\t\tТабДок1 = ПечатьРасходногоОрдераНаТовары(МассивОбъектов, ОбъектыПечати);\n\t\tТабДок2 = Обработки.ДопПечать_ПечатьРасходногоОрдераИЗаданияНаОтбор.СформироватьРасходныйОрдерИЗаданиеНаОтбор(МассивОбъектов, ОбъектыПечати, ПараметрыПечати);\n\t\t\n\t\t\n\t\tДобавитьТабличныйДокумент(ТабДок1, ТабДок2);\n\t\t\n\t\tУправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(\n\t\t\tКоллекцияПечатныхФорм,\n\t\t\t\"РасходныйОрдер\",\n\t\t\tНСтр(\"ru = 'Расходный ордер на товары'\"),\n\t\t\tТабДок1);\n\t\t\t\t\n\tКонецЕсли;\n\t\t\nКонецПроцедуры\n\nТабДок1 = ПечатьРасходногоОрдераНаТовары(МассивОбъектов, ОбъектыПечати);\n        ТабДок2 = Обработки.ДопПечать_ПечатьРасходногоОрдераИЗаданияНаОтбор.СформироватьРасходныйОрдерИЗаданиеНаОтбор(МассивОбъектов, ОбъектыПечати, ПараметрыПечати);\n        \n        ТабДок = Новый ТабличныйДокумент;\n            \n        ТабДок.Вывести(ТабДок1);\n        ТабДок.Вывести(ТабДок2);"
  },
  {
    "title": "Добавление контекста к сообщению об ошибке в ЖР (Журнале регистрации)",
    "description": "Добавление контекста к сообщению об ошибке в ЖР (Журнале регистрации)",
    "code_snippet": "Попытка\n\t\t// оборачиваемый код\n\tИсключение                                                         \n\t\tПоляКонтекста = Новый Массив;\n\t\t// ++ Этот кусок заменяется нужными полями\n\t\tПоляКонтекста.Добавить(\"Ссылка\");\n\t\tПоляКонтекста.Добавить(\"Наименование\");\n\t\t//--\n\t\t\n\t\tСтрокаШаблона = Новый Массив;\n\t\tДля Каждого Строка Из ПоляКонтекста Цикл\n\t\t\tСтрокаШаблона.Добавить(СтрШаблон(\"%1 = <[%1]>\", Строка));\n\t\tКонецЦикла;                         \n\t\tСтрокаШаблона = СтрСоединить(СтрокаШаблона);\n\t\t\n\t\tСтруктураПараметров = Новый Структура;\n\t\tДля Каждого тмпПОле из ПоляКонтекста Цикл\n\t\t\tСтруктураПараметров.Вставить(тмпПОле);\n\t\tКонецЦикла;\n\t\t\n\t\t// Если у вас хитрее - заменить получение контекста на более сложное\n\t\t// Если стразу структура - можно не создавать, но если выборка, строка ТЗ и тд, то нужно \n\t\t// преобразовать в струкутуру, так как внутри будет перебор свойств циклом.\n\t\tЗаполнитьЗначенияСвойств(СтруктураПараметров, Выборка);\n\n\t\t// изменить заполнение вспомогательных полей на то, что нужно\n\t\tЖурналРегистрации.ДобавитьСообщениеДляЖурналаРегистрации(\n\t\t  \"Отлаживаемая ошибка\", \n\t\t  УровеньЖурналаРегистрации.Ошибка,\n\t\t  ,\n\t\t  ,                                               \n\t\t  \n\t\t  СтроковыеФункцииКлиентСервер.ВставитьПараметрыВСтроку(СтрокаШаблона, СтруктураПараметров)\n\t\t );\n\t\tВызватьИсключение; // мы не обрабатываем исключение, только обогащаем контекстом в ЖР перед падением\n\t\tКонецПопытки;"
  },
  {
    "title": "Преобразование unixtime в 1С Дата (Unix Time Stamp)",
    "description": "Преобразование unixtime в 1С Дата (Unix Time Stamp)",
    "code_snippet": "Дата1С = дата(1970,1,1,1,0,0) + 637746530810000000;\n\nДата1С = дата(1970,1,1,1,0,0) + 637746530810000000/1000;\n\nОрфографическая ошибка в unixtime (найдено 2): unixtime\r\nОрфографическая ошибка в конвертнуть: конвертнуть"
  },
  {
    "title": "Библиотека программного редактирования управляемых форм",
    "description": "Библиотека программного редактирования управляемых форм",
    "code_snippet": "// Добавляет новую команду формы. Дополнительно можно сразу разместить кнопку на форме\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  ИмяКоманды  - Строка - имя новой команды формы\r\n//\r\n//  ДействиеКоманды  - Строка - имя обработчика для команды\r\n//\r\n//  ИмяГруппы  - Строка - имя родительского элемента, если необходимо разместить команду на форме\r\n//\t\t\t   - Неопределено - если нужно только создать новую команду\r\n//\t\t\t\t\t\t\t\tПо умолчанию команда размещается в корне формы\r\n//\r\n//  ВидКнопки  - ВидКнопкиФормы   - вид кнопки формы. По умолчанию ОбычнаяКнопка или КнопкаКоманднойПанели,\r\n//\t\t\t\t\t\t\t\t\t\t\t\t\t\tзависит от родителя\r\n//\r\n//  Заголовок  - Строка  - заголовок кнопки формы. Не обязательный\r\n//\r\n//  ПоместитьПеред  - Строка - имя элемента, перед которым необходимо разместить кнопку формы. Не обязательный\r\n//\r\n//  Картинка  - Картинка - картинка кнопки формы. Не обязательный\r\n//\r\n//  ОтображениеКнопки  - ОтображениеКнопки - вариант отражение кнопки на форме. Учитывается только если\r\n//\t\t\t\t\t\t\t\t\t\t\t\tзаполнен параметр Картинка. Не обязательный\r\n//\r\nПроцедура ДобавитьРазместитьКомандуФормы(Форма, ИмяКоманды, ДействиеКоманды, ИмяГруппы = \"\", ВидКнопки = Неопределено,\r\n\t\t\t\t\t\t\t\t\t\tЗаголовок = \"\", ПоместитьПеред = \"\",\r\n\t\t\t\t\t\t\t\t\t\tКартинка = Неопределено, ОтображениеКнопки = Неопределено,\r\n\t\t\t\t\t\t\t\t\t\tДоступность = Истина) Экспорт\r\n\r\n\tКоманда = Форма.Команды.Добавить(ИмяКоманды);\r\n\tКоманда.Действие = ДействиеКоманды;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(Заголовок) Тогда\r\n\t\tКоманда.Заголовок = Заголовок;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли Картинка <> Неопределено Тогда\r\n\t\r\n\t\tКоманда.Картинка = Картинка;\r\n\t\t\r\n\t\tЕсли ОтображениеКнопки <> Неопределено Тогда\r\n\t\t\tКоманда.Отображение = ОтображениеКнопки;\r\n\t\tКонецЕсли;\r\n\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ИмяГруппы = Неопределено Тогда\r\n\t\tВозврат;\t\r\n\tИначеЕсли ЗначениеЗаполнено(ИмяГруппы) Тогда\r\n\t\tЭлементРодитель = Форма.Элементы[ИмяГруппы];\r\n\tИначе\r\n\t\tЭлементРодитель = Форма;\r\n\tКонецЕсли;\r\n\t\r\n\tКнопкаФормы = Форма.Элементы.Добавить(ИмяКоманды, Тип(\"КнопкаФормы\"), ЭлементРодитель);\r\n\tКнопкаФормы.ИмяКоманды = ИмяКоманды;\r\n\tКнопкаФормы.Доступность = Доступность;\r\n\t\r\n\tЕсли ВидКнопки <> Неопределено Тогда\r\n\t\tКнопкаФормы.Вид = ВидКнопки;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ПоместитьПеред) Тогда\r\n\t\tФорма.Элементы.Переместить(КнопкаФормы, ЭлементРодитель, Форма.Элементы[ПоместитьПеред]);\t\r\n\tКонецЕсли; \t\t\r\n\r\nКонецПроцедуры        \r\n\r\n// Добавляет новый реквизит формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  ИмяРеквизита  - Строка - имя нового реквизита формы\r\n//\r\n//  ТипРеквизита  - ОписаниеТипов - тип реквизита. По умолчанию строка\r\n//\r\n//  ЗаголовокРеквизита  - Строка - отображаемый текст реквизита. Не обязательный\r\n//\r\n//  Путь  - Строка  - путь к создаваемому реквизиту. Не включает имя реквизита. Не обязательный\r\n//\r\n//  СохраняемыеДанные  - Булево  - если реквизит содержит сохраняемые данные. По умолчанию Ложь\r\n//\r\n//  РодительЭлемента  - Строка - имя родителя элемента формы,\r\n//\t\t\t\t\t\t\t\tесли дополнительно необходимо разместить на форме. Не обязательный\r\n//\r\n//  ИмяЭлемента  - Строка - если заполнен параметр РодительЭлемента, то дополнительно можно указать имя элемента формы.\r\n//\t\t\t\t\t\t\tПо умолчанию именем будет ИмяРеквизита\r\n//\r\nПроцедура ДобавитьРеквизитФормы(Форма, ИмяРеквизита, ТипРеквизита, ЗаголовокРеквизита = \"\", Путь = \"\",\r\n\t\t\t\t\t\t\tСохраняемыеДанные = Ложь, РодительЭлемента = \"\", ИмяЭлемента = \"\") Экспорт\r\n\r\n\tСтруктураРеквизита = Новый Структура;\r\n\tСтруктураРеквизита.Вставить(\"ИмяРеквизита\", ИмяРеквизита);\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ТипРеквизита) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"ТипРеквизита\", ТипРеквизита);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ЗаголовокРеквизита) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"ЗаголовокРеквизита\", ЗаголовокРеквизита);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(Путь) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"Путь\", Путь);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(СохраняемыеДанные) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"СохраняемыеДанные\", СохраняемыеДанные);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(РодительЭлемента) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"РодительЭлемента\", РодительЭлемента);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ИмяЭлемента) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"ИмяЭлемента\", ИмяЭлемента);\r\n\tКонецЕсли;\r\n\t\r\n\tМассивРеквизитов = Новый Массив;\r\n\tМассивРеквизитов.Добавить(СтруктураРеквизита);\r\n\t\r\n\tДобавитьРеквизитыФормы(Форма, МассивРеквизитов);\r\n\t\t\t\t\t\t\t\t\r\nКонецПроцедуры \r\n\r\n// Добавляет новые реквизиты формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  МассивРеквизитов  - Массив структур - содержит:\r\n//     *ИмяРеквизита  - Строка - имя нового реквизита формы\r\n//     *ТипРеквизита  - ОписаниеТипов - тип реквизита. По умолчанию строка неограниченной длины\r\n//     *ЗаголовокРеквизита  - Строка - отображаемый текст реквизита. Не обязательный\r\n//     *Путь  - Строка  - путь к создаваемому реквизиту. Не включает имя реквизита. Не обязательный\r\n//     *СохраняемыеДанные  - Булево  - если реквизит содержит сохраняемые данные. По умолчанию Ложь\r\n//     *РодительЭлемента  - Строка - имя родителя элемента формы,\r\n//\t   *ИмяЭлемента  - Строка - если заполнен параметр РодительЭлемента, то дополнительно можно указать имя элемента формы.\r\n//\t\t\t\t\t\t\tПо умолчанию именем будет ИмяРеквизита\r\n//\r\nПроцедура ДобавитьРеквизитыФормы(Форма, МассивРеквизитов) Экспорт\r\n\r\n\tДобавляемыеРеквизиты \t= Новый Массив;\r\n\tРеквизитыДляРазмещения \t= Новый Массив;\r\n\t\r\n\tДля каждого ОписаниеРеквизита Из МассивРеквизитов Цикл\r\n\t\t\r\n\t\tИмяРеквизита = ОписаниеРеквизита.ИмяРеквизита;\r\n\t\t\r\n\t\tЕсли ОписаниеРеквизита.Свойство(\"ТипРеквизита\") Тогда\r\n\t\t\tТипРеквизита = ОписаниеРеквизита.ТипРеквизита;\t\r\n\t\tИначе\r\n\t\t\tТипРеквизита = Новый ОписаниеТипов(\"Строка\");\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЗаголовокРеквизита = \"\";\r\n\t\t\r\n\t\tЕсли ОписаниеРеквизита.Свойство(\"ЗаголовокРеквизита\") Тогда\r\n\t\t\tЗаголовокРеквизита = ОписаниеРеквизита.ЗаголовокРеквизита;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tПуть = \"\";\t\r\n\t\t\r\n\t\tЕсли ОписаниеРеквизита.Свойство(\"Путь\") Тогда\r\n\t\t\tПуть = ОписаниеРеквизита.Путь;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tСохраняемыеДанные = Ложь;\t\r\n\t\t\r\n\t\tЕсли ОписаниеРеквизита.Свойство(\"СохраняемыеДанные\") Тогда\r\n\t\t\tСохраняемыеДанные = ОписаниеРеквизита.СохраняемыеДанные;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tРеквизитФормы = Новый РеквизитФормы(ИмяРеквизита, ТипРеквизита, Путь, ЗаголовокРеквизита, СохраняемыеДанные);\r\n\t\t\r\n\t\tДобавляемыеРеквизиты.Добавить(РеквизитФормы);\r\n\t\t\r\n\t\t//+ Дополнительное размещение реквизитов на форме\r\n\t\tЕсли ОписаниеРеквизита.Свойство(\"РодительЭлемента\") Тогда\r\n\t\t\r\n\t\t\tСтруктураЭлемента = Новый Структура;\r\n\t\t\tСтруктураЭлемента.Вставить(\"ИмяГруппы\", ОписаниеРеквизита.РодительЭлемента);\r\n\t\t\t\r\n\t\t\tЕсли ОписаниеРеквизита.Свойство(\"Путь\") Тогда\r\n\t\t\t\tШаблон = \"%1.%2\";\r\n\t\t\t\tПутьКДанным = СтрШаблон(Шаблон, ОписаниеРеквизита.Путь, ИмяРеквизита); \t\r\n\t\t\tИначе\r\n\t\t\t\tПутьКДанным = ИмяРеквизита;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tСтруктураЭлемента.Вставить(\"ПутьКДанным\", ПутьКДанным);\r\n\t\t\t\r\n\t\t\tИмяЭлемента = ИмяРеквизита;\r\n\t\t\t\r\n\t\t\tЕсли ОписаниеРеквизита.Свойство(\"ИмяЭлемента\") Тогда\r\n\t\t\t\tИмяЭлемента = ОписаниеРеквизита.ИмяЭлемента;\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tСтруктураРеквизитов = Новый Структура;\r\n\t\t\tСтруктураРеквизитов.Вставить(ИмяЭлемента, СтруктураЭлемента);\r\n\t\t\t\r\n\t\t\tРеквизитыДляРазмещения.Добавить(СтруктураРеквизитов);\r\n\t\t\r\n\t\tКонецЕсли;\r\n\t\t//- Дополнительное размещение реквизитов на форме\r\n\t\r\n\tКонецЦикла;\r\n\t\r\n\tФорма.ИзменитьРеквизиты(ДобавляемыеРеквизиты);\r\n\tРазместитьРеквизитыНаФорме(Форма, РеквизитыДляРазмещения);\r\n\t\t\t\t\t\t\t\t\r\nКонецПроцедуры\r\n\r\n// Добавляет в дерево элементов формы существующие реквизиты объекта и формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  МассивРеквизитов  - Массив структур - содержит:\r\n//     * Имя  - Имя добавляемого реквизита\r\n//     * Значение - Структура - содержит (все свойства не обязательные):\r\n//        ** ИмяГруппы \t\t\t- Строка - имя элемента родителя\r\n//        ** ПутьКДанным\t\t- Строка - путь к данным. Если не указано, то будет Объект.<ИмяРеквизита>\r\n//        ** ВидПоляФормы\t\t- ВидПоляФормы - вид поля формы. По умолчанию ПолеВвода\r\n//        ** Видимость \t\t\t- Булево - значение свойства Видимость\r\n//        ** ТолькоПросмотр \t- Булево - значение свойства ТолькоПросмотр\r\n//        ** Доступность \t\t- Булево - значение свойства Доступность\r\n//        ** ПоместитьПеред\t\t- Строка - имя элемента, перед которым необходимо разместить\r\n//        ** ОбработкаСобытий \t- Массив структур - содержит:\r\n//           *** Событие \t- Строка - имя события элемента\r\n//           *** Действие \t- Строка - имя процедуры исполнителя события\r\n//\r\nПроцедура РазместитьРеквизитыНаФорме(Форма, МассивРеквизитов) Экспорт\r\n\r\n\tДля каждого ТекРеквизит Из МассивРеквизитов Цикл\r\n\t\t\r\n\t\tИмяРеквизита \t\t= ТекРеквизит.Имя;\r\n\t\tПараметрыРеквизита \t= ТекРеквизит.Значение;\r\n\t\t\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ИмяГруппы\") Тогда\r\n\t\t\tЭлементРодитель = Форма.Элементы[ПараметрыРеквизита.ИмяГруппы];\t\r\n\t\tИначе\r\n\t\t\tЭлементРодитель = Форма;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЭлемент = Форма.Элементы.Добавить(ИмяРеквизита, Тип(\"ПолеФормы\"), ЭлементРодитель);\r\n\t\t\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ПутьКДанным\") Тогда\r\n\t\t\tЭлемент.ПутьКДанным = ПараметрыРеквизита.ПутьКДанным;\r\n\t\tИначе \r\n\t\t\tЭлемент.ПутьКДанным = \"Объект.\" + ИмяРеквизита;\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ВидПоляФормы\") Тогда\t\t\r\n\t\t\tЭлемент.Вид = ПараметрыРеквизита.ВидПоляФормы;\t\r\n\t\tИначе\r\n\t\t\tЭлемент.Вид = ВидПоляФормы.ПолеВвода;\r\n\t\tКонецЕсли;                               \t\r\n\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"Видимость\") Тогда\r\n\t\t\tЭлемент.Видимость = ПараметрыРеквизита.Видимость;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ТолькоПросмотр\") Тогда\r\n\t\t\tЭлемент.ТолькоПросмотр = ПараметрыРеквизита.ТолькоПросмотр;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"Доступность\") Тогда\r\n\t\t\tЭлемент.Доступность = ПараметрыРеквизита.Доступность;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ПоместитьПеред\") Тогда\r\n\t\t\tФорма.Элементы.Переместить(Элемент, ЭлементРодитель, Форма.Элементы[ПараметрыРеквизита.ПоместитьПеред]);\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\t//--- обработчики событий\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ОбработкаСобытий\")\r\n\t\t\tИ ТипЗнч(ПараметрыРеквизита.ОбработкаСобытий) = Тип(\"Массив\") Тогда\r\n\t\t\t\r\n\t\t\tДля каждого ТекСобытие Из ПараметрыРеквизита.ОбработкаСобытий Цикл\r\n\t\t\t\tЭлемент.УстановитьДействие(ТекСобытие.Событие, ТекСобытие.Действие);\t\t\r\n\t\t\tКонецЦикла; \t\t\t\r\n\t\t\t\r\n\t\tКонецЕсли; \r\n\t\t\r\n\tКонецЦикла; \t\r\n\t\r\nКонецПроцедуры\r\n\r\n// Добавляет в дерево элементов формы существующие реквизиты объекта и формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  Имя  - Имя добавляемого реквизита\r\n//  ИмяГруппы \t\t\t- Строка - имя элемента родителя\r\n//  ПутьКДанным\t\t- Строка - путь к данным. Если не указано, то будет Объект.<ИмяРеквизита>\r\n//  ВидПоляФормы\t\t- ВидПоляФормы - вид поля формы. По умолчанию ПолеВвода\r\n//  Видимость \t\t\t- Булево - значение свойства Видимость\r\n//  ТолькоПросмотр \t- Булево - значение свойства ТолькоПросмотр\r\n//  Доступность \t\t- Булево - значение свойства Доступность\r\n//  ПоместитьПеред\t\t- Строка - имя элемента, перед которым необходимо разместить\r\n//  ОбработкаСобытий \t- Массив структур - содержит:\r\n//   * Событие \t- Строка - имя события элемента\r\n//   * Действие \t- Строка - имя процедуры исполнителя события \r\n//  ТипЭлемента     - Поле формы или например Таблица формы, по умолчанию тип поле формы\r\n//\r\nПроцедура РазместитьРеквизитНаФорме(Форма, Имя, ИмяГруппы = \"\", ПутьКДанным = \"\", ПутьКДаннымПодвала = \"\", ПВидПоляФормы = неопределено, Видимость = Истина,\r\n\t\t\t\t\t\t\t\t\tТолькоПросмотр = Ложь, Доступность = Истина, ПоместитьПеред = \"\", ОбработкаСобытий = неопределено, Заголовок = \"\") Экспорт\r\n\r\n\t//Для каждого ТекРеквизит Из МассивРеквизитов Цикл\r\n\t\t\r\n\t\tУстановитьПривилегированныйРежим(Истина);\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ИмяГруппы) Тогда\r\n\t\t\tЭлементРодитель = Форма.Элементы[ИмяГруппы];\t\r\n\t\tИначе\r\n\t\t\tЭлементРодитель = Форма;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t\r\n\t\tЭлемент = Форма.Элементы.Добавить(Имя, Тип(\"ПолеФормы\"), ЭлементРодитель);\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Заголовок) Тогда\r\n\t\t\tЭлемент.Заголовок = Заголовок;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ПутьКДанным) Тогда\r\n\t\t\tЭлемент.ПутьКДанным = ПутьКДанным;\r\n\t\tИначе \r\n\t\t\tЭлемент.ПутьКДанным = \"Объект.\" + Имя;\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ПутьКДаннымПодвала) Тогда\r\n\t\t\tЭлемент.ПутьКДаннымПодвала = ПутьКДаннымПодвала;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ПВидПоляФормы <> неопределено Тогда\t\t\r\n\t\t\tЭлемент.Вид = ПВидПоляФормы;\t\r\n\t\tИначе\r\n\t\t\tЭлемент.Вид = ВидПоляФормы.ПолеВвода;\r\n\t\tКонецЕсли;                               \t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Видимость) Тогда\r\n\t\t\tЭлемент.Видимость = Видимость;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ТолькоПросмотр) Тогда\r\n\t\t\tЭлемент.ТолькоПросмотр = ТолькоПросмотр;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Доступность) Тогда\r\n\t\t\tЭлемент.Доступность = Доступность;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ПоместитьПеред) Тогда\r\n\t\t\tФорма.Элементы.Переместить(Элемент, ЭлементРодитель, Форма.Элементы[ПоместитьПеред]);\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\t//--- обработчики событий\r\n\t\tЕсли ОбработкаСобытий <> неопределено\r\n\t\t\tИ ТипЗнч(ОбработкаСобытий) = Тип(\"Массив\") Тогда\r\n\t\t\t\r\n\t\t\tДля каждого ТекСобытие Из ОбработкаСобытий Цикл\r\n\t\t\t\tЭлемент.УстановитьДействие(ТекСобытие.Событие, ТекСобытие.Действие);\t\t\r\n\t\t\tКонецЦикла; \t\t\t\r\n\t\t\t\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t//КонецЦикла; \t\r\n\t\r\nКонецПроцедуры\r\n\r\n// Устанавливает обработчик события для элемента формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  ИмяЭлемента  - Строка - имя элемента формы\r\n//\r\n//  Событие  - Строка - имя события элемента\r\n//\r\n//  Действие  - Строка - имя процедуры исполнителя события\r\n//\r\nПроцедура УстановитьСобытиеЭлементаФормы(Форма, ИмяЭлемента, Событие, Действие) Экспорт\r\n\r\n\tЭлемент = Форма.Элементы[ИмяЭлемента];\r\n\tЭлемент.УстановитьДействие(Событие, Действие);\t\t\r\n\r\nКонецПроцедуры\r\n\r\n// Добавляет в дерево элементов формы новую группу\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  ИмяГруппы  - Строка - имя новой группы\r\n//\r\n//  РодительГруппы  - Строка - родитель группы. Не обязательно\r\n//\r\n//  ВидГруппы  - ВидГруппыФормы - вид группы. По умолчанию ОбычнаяГруппа\r\n//\r\n//  Группировка  - ГруппировкаПодчиненныхЭлементовФормы  - вариант группировки. По умолчанию ГоризонтальнаяЕслиВозможно\r\n//\r\n//  ОтображатьЗаголовок  - Булево - значение свойства ОтображатьЗаголовок группы. По умолчанию Ложь\r\n//\r\n//  Заголовок  - Строка - заголовок группы. По умолчанию заголовок пустой\r\n//\r\nПроцедура ДобавитьГруппуНаФорму(Форма, ИмяГруппы, РодительГруппы = \"\",\r\n\t\t\t\t\t\t\t\tВидГруппы = Неопределено,\r\n\t\t\t\t\t\t\t\tГруппировка = Неопределено,\r\n\t\t\t\t\t\t\t\tОтображатьЗаголовок = Ложь,\r\n\t\t\t\t\t\t\t\tЗаголовок = Неопределено,\r\n\t\t\t\t\t\t\t\tОбъединенная = Истина,\r\n\t\t\t\t\t\t\t\tПоместитьПеред = \"\") Экспорт\r\n\r\n\tЕсли НЕ ПустаяСтрока(РодительГруппы) Тогда\r\n\t\tЭлементРодитель = Форма.Элементы[РодительГруппы];\t\r\n\tИначе\r\n\t\tЭлементРодитель = Форма;\r\n\tКонецЕсли;\r\n\t\r\n\tГруппаФормы = Форма.Элементы.Добавить(ИмяГруппы, Тип(\"ГруппаФормы\"), ЭлементРодитель);\r\n\t\r\n\tГруппаФормы.Вид \t\t\t\t= ?(ВидГруппы = Неопределено, ВидГруппыФормы.ОбычнаяГруппа, ВидГруппы);\r\n\tГруппаФормы.Группировка \t\t= ?(Группировка = Неопределено,\r\n\t\t\t\t\t\t\t\t\t\tГруппировкаПодчиненныхЭлементовФормы.ГоризонтальнаяЕслиВозможно,\r\n\t\t\t\t\t\t\t\t\t\tГруппировка);\r\n\tГруппаФормы.ОтображатьЗаголовок = ОтображатьЗаголовок;\r\n\tГруппаФормы.Заголовок = Заголовок;\r\n\tЕсли ВидГруппы = ВидГруппыФормы.ОбычнаяГруппа Тогда\r\n\t\tГруппаФормы.Объединенная = Объединенная; \r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ПоместитьПеред) Тогда\r\n\t\tФорма.Элементы.Переместить(ГруппаФормы, Форма.Элементы[РодительГруппы], Форма.Элементы[ПоместитьПеред]);\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\n// Добавляет в дерево элементов формы существующие реквизиты объекта и формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  Имя  - Имя добавляемого реквизита\r\n//  ИмяГруппы \t\t\t- Строка - имя элемента родителя\r\n//  ПутьКДанным\t\t- Строка - путь к данным. Если не указано, то будет Объект.<ИмяРеквизита>\r\n//  ВидПоляФормы\t\t- ВидПоляФормы - вид поля формы. По умолчанию ПолеВвода\r\n//  Видимость \t\t\t- Булево - значение свойства Видимость\r\n//  ТолькоПросмотр \t- Булево - значение свойства ТолькоПросмотр\r\n//  Доступность \t\t- Булево - значение свойства Доступность\r\n//  ПоместитьПеред\t\t- Строка - имя элемента, перед которым необходимо разместить\r\n//  ОбработкаСобытий \t- Массив структур - содержит:\r\n//   * Событие \t- Строка - имя события элемента\r\n//   * Действие \t- Строка - имя процедуры исполнителя события \r\n//  ТипЭлемента     - Поле формы или например Таблица формы, по умолчанию тип поле формы\r\n//\r\nПроцедура РазместитьТаблицуНаФорме(Форма, Имя, ИмяГруппы = \"\", ПутьКДанным = \"\", Видимость = Истина, ТолькоПросмотр = Ложь, \r\n\t\t\t\t\t\t\tДоступность = Истина, ПоместитьПеред = \"\", ОбработкаСобытий = неопределено, Подвал = Ложь) Экспорт\r\n\r\n\t\t\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ИмяГруппы) Тогда\r\n\t\t\tЭлементРодитель = Форма.Элементы[ИмяГруппы];\t\r\n\t\tИначе\r\n\t\t\tЭлементРодитель = Форма;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t\r\n\t\tЭлемент = Форма.Элементы.Добавить(Имя, Тип(\"ТаблицаФормы\"), ЭлементРодитель);\r\n\t\t\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ПутьКДанным) Тогда\r\n\t\t\tЭлемент.ПутьКДанным = ПутьКДанным;\r\n\t\tИначе \r\n\t\t\tЭлемент.ПутьКДанным = \"Объект.\" + Имя;\r\n\t\tКонецЕсли;                               \t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Видимость) Тогда\r\n\t\t\tЭлемент.Видимость = Видимость;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ТолькоПросмотр) Тогда\r\n\t\t\tЭлемент.ТолькоПросмотр = ТолькоПросмотр;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Доступность) Тогда\r\n\t\t\tЭлемент.Доступность = Доступность;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ПоместитьПеред) Тогда\r\n\t\t\tФорма.Элементы.Переместить(Элемент, ЭлементРодитель, Форма.Элементы[ПоместитьПеред]);\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЭлемент.Подвал = Подвал;\r\n\t\t\r\n\t\t//--- обработчики событий\r\n\t\tЕсли ОбработкаСобытий <> неопределено\r\n\t\t\tИ ТипЗнч(ОбработкаСобытий) = Тип(\"Массив\") Тогда\r\n\t\t\t\r\n\t\t\tДля каждого ТекСобытие Из ОбработкаСобытий Цикл\r\n\t\t\t\tЭлемент.УстановитьДействие(ТекСобытие.Событие, ТекСобытие.Действие);\t\t\r\n\t\t\tКонецЦикла; \t\t\t\r\n\t\t\t\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t//КонецЦикла; \t\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура СозданиеДинамическогоСписка(\r\n\tФорма,                                      //Тип форма -  Форма документа\r\n\tИмяСписка = \"Список\", \t\t\t\t\t\t//тип строка - имя будущего списка на форме и реквизита\r\n\tТекстЗапроса = \"\", \t\t\t\t\t\t\t//тип строка - запрос, если он не указан, необходимо указать таблицу\r\n\tМассивКолонок,                  \t\t\t//тип массив - массив создаваемых колонок, значения тип строка. Пример: \"Д,ДоговораКонтрагента\" значит будет создана колонка\r\n\t\t\t\t\t\t\t\t\t\t\t\t//\t\t\t\tс заголовком \"Д\" и колонкой списка \"ДоговораКонтрагента\". Если указать просто \"ДоговораКонтрагента\", \r\n\t\t\t\t\t\t\t\t\t\t\t\t//\t\t\t\tзаголовок будет идентичен заголовку по умолчанию типа \"Договор контрагента\".\r\n\tСписокДействий = Неопределено,  \t\t\t//типа структура - структура содержит действия (свойства) динамического списка, можно указать только те которые необходимы.\r\n\t\t\t\t\t\t\t\t\t\t\t\t//\t\t\t\tпример: СписокДействий = Новый Структура(\"Выбор,ПриАктивизацииСтроки\",\"СписокВыбор\",\"СписокПриАктивизацииСтроки\")\r\n\tТаблицаСписка = \"\",\t\t\t\t\t\t\t//тип строка - содержит имя основной таблицы, пример: \"Документ.РеализацияТоваровУслуг\"\t\r\n\tДобавитьВ = \"\",                 \t\t\t//тип строка - имя элемента на который будет размещен список, если пустое, тогда добавляется на форму\r\n\tВставитьПеред = \"\",             \t\t\t//тип строка - имя элемента перед которым будет размещен список, если пустое, будет просто добавлен в конец\r\n\tСвояКоманднаяПанель = ЛОЖЬ,     \t\t\t//тип булево - если ИСТИНА, скрывает стандартную панель и создает свою пустую для будущего наполнения ИмяСписка+\"КоманднаяПанель2\"\r\n\tПараметрыЗапроса = Неопределено) Экспорт \t//тип структура - содержит перечень параметров, если они используются в запросе.\r\n\t\r\n\t//Защита от дурака\r\n\tЕсли ТекстЗапроса = \"\" И ТаблицаСписка = \"\" Тогда Сообщить(\"Ошибка формирования динамического списка, укажите запрос или таблицу\"); Возврат; КонецЕсли;\r\n\t\r\n\tЭлементы = Форма.Элементы;\r\n\t\r\n\t//Создаем свою командную панель, тот случай когда я не нашел способа снять галочку \"Автозаполнение\"\r\n\tЕсли СвояКоманднаяПанель Тогда\r\n\t\tЕсли ВставитьПеред = \"\" Тогда\r\n\t\t\tГруппаДинамическогоСписка  = Элементы.Добавить(\"Группа\" + ИмяСписка + \"CоСвоейКоманднойПанелью\",Тип(\"ГруппаФормы\"),?(ДобавитьВ = \"\",Форма,Форма.Элементы[ДобавитьВ]));\r\n\t\tИначе\r\n\t\t\tГруппаДинамическогоСписка  = Элементы.Вставить(\"Группа\" + ИмяСписка + \"CоСвоейКоманднойПанелью\",Тип(\"ГруппаФормы\"),?(ДобавитьВ = \"\",Форма,Форма.Элементы[ДобавитьВ]),Форма.Элементы[ВставитьПеред]);\t\t\t\r\n\t\tКонецЕсли;\r\n\t\tГруппаДинамическогоСписка.Вид = ВидГруппыФормы.ОбычнаяГруппа;\r\n\t\tГруппаДинамическогоСписка.ОтображатьЗаголовок = Ложь;\r\n\t\tГруппаДинамическогоСписка.Отображение = ОтображениеОбычнойГруппы.Нет;\r\n\t\tГруппаДинамическогоСписка.Группировка = ГруппировкаПодчиненныхЭлементовФормы.Вертикальная;\r\n\t\tКоманднаяПанельСписка  = Элементы.Добавить(ИмяСписка + \"КоманднаяПанель2\",Тип(\"ГруппаФормы\"),ГруппаДинамическогоСписка);\r\n\t\tКоманднаяПанельСписка.Вид = ВидГруппыФормы.КоманднаяПанель;\t\t\t\r\n\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\r\n\t//Создаем реквизит формы\r\n\tТипыРеквизита = Новый Массив;                             \r\n\tТипыРеквизита.Добавить(Тип(\"ДинамическийСписок\"));\r\n\tОписаниеТиповДляРеквизита = Новый ОписаниеТипов(ТипыРеквизита); \r\n\tДинамическийСписок = Новый РеквизитФормы(ИмяСписка, ОписаниеТиповДляРеквизита,,\"\",ЛОЖЬ); //Имя реквизита\r\n\tДобавляемыеРеквизиты = Новый Массив;\r\n\tДобавляемыеРеквизиты.Добавить(ДинамическийСписок);        \r\n\t\r\n\t//Задаем свойства реквизиту\r\n\tФорма.ИзменитьРеквизиты(ДобавляемыеРеквизиты);        \r\n\tРеквизитДинамическийСписок = Форма[ИмяСписка]; //Имя реквизита\r\n\tЕсли ТекстЗапроса = \"\" Тогда\r\n\t\tРеквизитДинамическийСписок.ПроизвольныйЗапрос = ЛОЖЬ;\r\n\t\tРеквизитДинамическийСписок.ОсновнаяТаблица = ТаблицаСписка;\r\n\tИначе\r\n\t\tРеквизитДинамическийСписок.ПроизвольныйЗапрос = ИСТИНА;\r\n\t\tРеквизитДинамическийСписок.ТекстЗапроса = ТекстЗапроса;\r\n\t\tЕсли ТаблицаСписка <> \"\" Тогда РеквизитДинамическийСписок.ОсновнаяТаблица = ТаблицаСписка; КонецЕсли;\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t//Заполняем параметры если они были указаны\r\n\tЕсли ПараметрыЗапроса <> Неопределено Тогда\r\n\t\tДля Каждого Параметра из ПараметрыЗапроса Цикл\r\n\t\t\tРеквизитДинамическийСписок.Параметры.УстановитьЗначениеПараметра(Параметра.Ключ,Параметра.Значение);\t\r\n\t\tКонецЦикла;\t\t \r\n\tКонецЕсли;\r\n\t\r\n\t//Размещаем реквизит на форме\r\n\tЕсли ЛОЖЬ\r\n\t\tИЛИ ВставитьПеред = \"\" \r\n\t\tИЛИ СвояКоманднаяПанель //Если своя командная панель тогда нет логики уже в параметре ВставитьПеред\r\n\t\tТогда\r\n\t\tТаблицаФормы = Элементы.Добавить(ИмяСписка,Тип(\"ТаблицаФормы\"),?(СвояКоманднаяПанель,ГруппаДинамическогоСписка,?(ДобавитьВ = \"\",Форма,Форма.Элементы[ДобавитьВ])));\r\n\tИначе\r\n\t\tТаблицаФормы = Элементы.Вставить(ИмяСписка,Тип(\"ТаблицаФормы\"),?(ДобавитьВ = \"\",Форма,Форма.Элементы[ДобавитьВ]),Форма.Элементы[ВставитьПеред]);\t\r\n\tКонецЕсли;\t\t\r\n\tТаблицаФормы.ПутьКДанным = ИмяСписка; //Имя реквизита \r\n\t\r\n\t//Если своя панель тогда скрываем стандартную\r\n\tЕсли СвояКоманднаяПанель Тогда\r\n\t\tЭлементы[ИмяСписка].ПоложениеКоманднойПанели = ПоложениеКоманднойПанелиЭлементаФормы.Нет;\r\n\tКонецЕсли;\r\n\r\n\t//Создание колонок на основание МассивКолонок\r\n\tДля Каждого Элемента Из МассивКолонок Цикл\r\n\t\tПараметрыКолонки = СтрЗаменить(Элемента,\",\",Символы.ПС);\r\n\t\tЕсли СтрЧислоСтрок(ПараметрыКолонки) > 1 Тогда\r\n\t\t\tЗаголовок = СтрПолучитьСтроку(ПараметрыКолонки, 1);\r\n\t\t\tИмяКолонки = СтрПолучитьСтроку(ПараметрыКолонки, 2);\r\n\t\tИначе\r\n\t\t\tЗаголовок = \"\";\r\n\t\t\tИмяКолонки = ПараметрыКолонки; \r\n\t\tКонецЕсли;\t\r\n\t\tНоваяКолонкаТаблицы = Элементы.Добавить(ИмяСписка + ИмяКолонки, Тип(\"ПолеФормы\"), ТаблицаФормы);\r\n\t\tЕсли Заголовок <> \"\" Тогда НоваяКолонкаТаблицы.Заголовок = Заголовок; КонецЕсли;\r\n\t\tНоваяКолонкаТаблицы.ПутьКДанным = ИмяСписка + \".\" + ИмяКолонки; \t\r\n\tКонецЦикла;\r\n\t\r\n\t//Задаем действия (События) на основание СписокДействий, если он определен\r\n\tЕсли СписокДействий <> Неопределено Тогда \t\r\n\t\tПереченьСвойств = \"ПриИзменении\r\n\t\t\t\t\t\t|Выбор\r\n\t\t\t\t\t\t|ПриАктивизацииСтроки\r\n\t\t\t\t\t\t|ВыборЗначения\r\n\t\t\t\t\t\t|ПриАктивизацииПоля\r\n\t\t\t\t\t\t|ПриАктивизацииЯчейки\r\n\t\t\t\t\t\t|ПередНачаломДобавления\r\n\t\t\t\t\t\t|ПередНачаломИзменения\r\n\t\t\t\t\t\t|ПередУдалением\r\n\t\t\t\t\t\t|ПриНачалеРедактирования\r\n\t\t\t\t\t\t|ПередОкончаниемРедактирования\r\n\t\t\t\t\t\t|ПриОкончанииРедактирования\r\n\t\t\t\t\t\t|ОбработкаВыбора\r\n\t\t\t\t\t\t|ПередРазворачиванием\r\n\t\t\t\t\t\t|ПередСворачиванием\r\n\t\t\t\t\t\t|ПослеУдаления\r\n\t\t\t\t\t\t|ПриСменеТекущегоРодителя\r\n\t\t\t\t\t\t|ОбработкаЗаписиНового\r\n\t\t\t\t\t\t|ПриСохраненииПользовательскихНастроекНаСервере\r\n\t\t\t\t\t\t|ПередЗагрузкойПользовательскихНастроекНаСервере\r\n\t\t\t\t\t\t|ПриЗагрузкеПользовательскихНастроекНаСервере\r\n\t\t\t\t\t\t|ПриОбновленииСоставаПользовательскихНастроекНаСервере\r\n\t\t\t\t\t\t|ОбработкаЗапросаОбновления\r\n\t\t\t\t\t\t|ПриПолученииДанныхНаСервере\r\n\t\t\t\t\t\t|НачалоПеретаскивания\r\n\t\t\t\t\t\t|ПроверкаПеретаскивания\r\n\t\t\t\t\t\t|ОкончаниеПеретаскивания\r\n\t\t\t\t\t\t|Перетаскивание\";\r\n\t\tДля Счетчик = 1 по 28 Цикл\r\n\t\t\tИмяСвойства = СтрПолучитьСтроку(ПереченьСвойств, Счетчик);\r\n\t\t\tЭлементы[ИмяСписка].УстановитьДействие(ИмяСвойства,?(СписокДействий.Свойство(ИмяСвойства),СписокДействий[ИмяСвойства],\"\"));\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\t\r\n\r\nКонецПроцедуры \r\n\r\n// Изменяет свойства элементов формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  ИмяЭлемента  - Строка - имя элемента формы\r\n//\r\n//  ИмяСвойства  - Строка - имя свойства элемента\r\n//\r\n//  ЗначениеСвойства  - Произвольный - значение свойства элемента\r\n//\r\nПроцедура ИзменитьСвойствоЭлементаФормы(Форма, ИмяЭлемента, ИмяСвойства, ЗначениеСвойства) Экспорт\r\n\r\n\tЭлемент = Форма.Элементы[ИмяЭлемента];\r\n\tЭлемент[ИмяСвойства] = ЗначениеСвойства;\r\n\t\r\nКонецПроцедуры\n\n// Добавляет новую команду формы. Дополнительно можно сразу разместить кнопку на форме\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  ИмяКоманды  - Строка - имя новой команды формы\r\n//\r\n//  ДействиеКоманды  - Строка - имя обработчика для команды\r\n//\r\n//  ИмяГруппы  - Строка - имя родительского элемента, если необходимо разместить команду на форме\r\n//\t\t\t   - Неопределено - если нужно только создать новую команду\r\n//\t\t\t\t\t\t\t\tПо умолчанию команда размещается в корне формы\r\n//\r\n//  ВидКнопки  - ВидКнопкиФормы   - вид кнопки формы. По умолчанию ОбычнаяКнопка или КнопкаКоманднойПанели,\r\n//\t\t\t\t\t\t\t\t\t\t\t\t\t\tзависит от родителя\r\n//\r\n//  Заголовок  - Строка  - заголовок кнопки формы. Не обязательный\r\n//\r\n//  ПоместитьПеред  - Строка - имя элемента, перед которым необходимо разместить кнопку формы. Не обязательный\r\n//\r\n//  Картинка  - Картинка - картинка кнопки формы. Не обязательный\r\n//\r\n//  ОтображениеКнопки  - ОтображениеКнопки - вариант отражение кнопки на форме. Учитывается только если\r\n//\t\t\t\t\t\t\t\t\t\t\t\tзаполнен параметр Картинка. Не обязательный\r\n//\r\nПроцедура ДобавитьРазместитьКомандуФормы(Форма, ИмяКоманды, ДействиеКоманды, ИмяГруппы = \"\", ВидКнопки = Неопределено,\r\n\t\t\t\t\t\t\t\t\t\tЗаголовок = \"\", ПоместитьПеред = \"\",\r\n\t\t\t\t\t\t\t\t\t\tКартинка = Неопределено, ОтображениеКнопки = Неопределено,\r\n\t\t\t\t\t\t\t\t\t\tДоступность = Истина) Экспорт\r\n\r\n\tКоманда = Форма.Команды.Добавить(ИмяКоманды);\r\n\tКоманда.Действие = ДействиеКоманды;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(Заголовок) Тогда\r\n\t\tКоманда.Заголовок = Заголовок;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли Картинка <> Неопределено Тогда\r\n\t\r\n\t\tКоманда.Картинка = Картинка;\r\n\t\t\r\n\t\tЕсли ОтображениеКнопки <> Неопределено Тогда\r\n\t\t\tКоманда.Отображение = ОтображениеКнопки;\r\n\t\tКонецЕсли;\r\n\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ИмяГруппы = Неопределено Тогда\r\n\t\tВозврат;\t\r\n\tИначеЕсли ЗначениеЗаполнено(ИмяГруппы) Тогда\r\n\t\tЭлементРодитель = Форма.Элементы[ИмяГруппы];\r\n\tИначе\r\n\t\tЭлементРодитель = Форма;\r\n\tКонецЕсли;\r\n\t\r\n\tКнопкаФормы = Форма.Элементы.Добавить(ИмяКоманды, Тип(\"КнопкаФормы\"), ЭлементРодитель);\r\n\tКнопкаФормы.ИмяКоманды = ИмяКоманды;\r\n\tКнопкаФормы.Доступность = Доступность;\r\n\t\r\n\tЕсли ВидКнопки <> Неопределено Тогда\r\n\t\tКнопкаФормы.Вид = ВидКнопки;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ПоместитьПеред) Тогда\r\n\t\tФорма.Элементы.Переместить(КнопкаФормы, ЭлементРодитель, Форма.Элементы[ПоместитьПеред]);\t\r\n\tКонецЕсли; \t\t\r\n\r\nКонецПроцедуры        \r\n\r\n// Добавляет новый реквизит формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  ИмяРеквизита  - Строка - имя нового реквизита формы\r\n//\r\n//  ТипРеквизита  - ОписаниеТипов - тип реквизита. По умолчанию строка\r\n//\r\n//  ЗаголовокРеквизита  - Строка - отображаемый текст реквизита. Не обязательный\r\n//\r\n//  Путь  - Строка  - путь к создаваемому реквизиту. Не включает имя реквизита. Не обязательный\r\n//\r\n//  СохраняемыеДанные  - Булево  - если реквизит содержит сохраняемые данные. По умолчанию Ложь\r\n//\r\n//  РодительЭлемента  - Строка - имя родителя элемента формы,\r\n//\t\t\t\t\t\t\t\tесли дополнительно необходимо разместить на форме. Не обязательный\r\n//\r\n//  ИмяЭлемента  - Строка - если заполнен параметр РодительЭлемента, то дополнительно можно указать имя элемента формы.\r\n//\t\t\t\t\t\t\tПо умолчанию именем будет ИмяРеквизита\r\n//\r\nПроцедура ДобавитьРеквизитФормы(Форма, ИмяРеквизита, ТипРеквизита, ЗаголовокРеквизита = \"\", Путь = \"\",\r\n\t\t\t\t\t\t\tСохраняемыеДанные = Ложь, РодительЭлемента = \"\", ИмяЭлемента = \"\") Экспорт\r\n\r\n\tСтруктураРеквизита = Новый Структура;\r\n\tСтруктураРеквизита.Вставить(\"ИмяРеквизита\", ИмяРеквизита);\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ТипРеквизита) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"ТипРеквизита\", ТипРеквизита);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ЗаголовокРеквизита) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"ЗаголовокРеквизита\", ЗаголовокРеквизита);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(Путь) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"Путь\", Путь);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(СохраняемыеДанные) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"СохраняемыеДанные\", СохраняемыеДанные);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(РодительЭлемента) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"РодительЭлемента\", РодительЭлемента);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ИмяЭлемента) Тогда\r\n\t\tСтруктураРеквизита.Вставить(\"ИмяЭлемента\", ИмяЭлемента);\r\n\tКонецЕсли;\r\n\t\r\n\tМассивРеквизитов = Новый Массив;\r\n\tМассивРеквизитов.Добавить(СтруктураРеквизита);\r\n\t\r\n\tДобавитьРеквизитыФормы(Форма, МассивРеквизитов);\r\n\t\t\t\t\t\t\t\t\r\nКонецПроцедуры \r\n\r\n// Добавляет новые реквизиты формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  МассивРеквизитов  - Массив структур - содержит:\r\n//     *ИмяРеквизита  - Строка - имя нового реквизита формы\r\n//     *ТипРеквизита  - ОписаниеТипов - тип реквизита. По умолчанию строка неограниченной длины\r\n//     *ЗаголовокРеквизита  - Строка - отображаемый текст реквизита. Не обязательный\r\n//     *Путь  - Строка  - путь к создаваемому реквизиту. Не включает имя реквизита. Не обязательный\r\n//     *СохраняемыеДанные  - Булево  - если реквизит содержит сохраняемые данные. По умолчанию Ложь\r\n//     *РодительЭлемента  - Строка - имя родителя элемента формы,\r\n//\t   *ИмяЭлемента  - Строка - если заполнен параметр РодительЭлемента, то дополнительно можно указать имя элемента формы.\r\n//\t\t\t\t\t\t\tПо умолчанию именем будет ИмяРеквизита\r\n//\r\nПроцедура ДобавитьРеквизитыФормы(Форма, МассивРеквизитов) Экспорт\r\n\r\n\tДобавляемыеРеквизиты \t= Новый Массив;\r\n\tРеквизитыДляРазмещения \t= Новый Массив;\r\n\t\r\n\tДля каждого ОписаниеРеквизита Из МассивРеквизитов Цикл\r\n\t\t\r\n\t\tИмяРеквизита = ОписаниеРеквизита.ИмяРеквизита;\r\n\t\t\r\n\t\tЕсли ОписаниеРеквизита.Свойство(\"ТипРеквизита\") Тогда\r\n\t\t\tТипРеквизита = ОписаниеРеквизита.ТипРеквизита;\t\r\n\t\tИначе\r\n\t\t\tТипРеквизита = Новый ОписаниеТипов(\"Строка\");\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЗаголовокРеквизита = \"\";\r\n\t\t\r\n\t\tЕсли ОписаниеРеквизита.Свойство(\"ЗаголовокРеквизита\") Тогда\r\n\t\t\tЗаголовокРеквизита = ОписаниеРеквизита.ЗаголовокРеквизита;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tПуть = \"\";\t\r\n\t\t\r\n\t\tЕсли ОписаниеРеквизита.Свойство(\"Путь\") Тогда\r\n\t\t\tПуть = ОписаниеРеквизита.Путь;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tСохраняемыеДанные = Ложь;\t\r\n\t\t\r\n\t\tЕсли ОписаниеРеквизита.Свойство(\"СохраняемыеДанные\") Тогда\r\n\t\t\tСохраняемыеДанные = ОписаниеРеквизита.СохраняемыеДанные;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tРеквизитФормы = Новый РеквизитФормы(ИмяРеквизита, ТипРеквизита, Путь, ЗаголовокРеквизита, СохраняемыеДанные);\r\n\t\t\r\n\t\tДобавляемыеРеквизиты.Добавить(РеквизитФормы);\r\n\t\t\r\n\t\t//+ Дополнительное размещение реквизитов на форме\r\n\t\tЕсли ОписаниеРеквизита.Свойство(\"РодительЭлемента\") Тогда\r\n\t\t\r\n\t\t\tСтруктураЭлемента = Новый Структура;\r\n\t\t\tСтруктураЭлемента.Вставить(\"ИмяГруппы\", ОписаниеРеквизита.РодительЭлемента);\r\n\t\t\t\r\n\t\t\tЕсли ОписаниеРеквизита.Свойство(\"Путь\") Тогда\r\n\t\t\t\tШаблон = \"%1.%2\";\r\n\t\t\t\tПутьКДанным = СтрШаблон(Шаблон, ОписаниеРеквизита.Путь, ИмяРеквизита); \t\r\n\t\t\tИначе\r\n\t\t\t\tПутьКДанным = ИмяРеквизита;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tСтруктураЭлемента.Вставить(\"ПутьКДанным\", ПутьКДанным);\r\n\t\t\t\r\n\t\t\tИмяЭлемента = ИмяРеквизита;\r\n\t\t\t\r\n\t\t\tЕсли ОписаниеРеквизита.Свойство(\"ИмяЭлемента\") Тогда\r\n\t\t\t\tИмяЭлемента = ОписаниеРеквизита.ИмяЭлемента;\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tСтруктураРеквизитов = Новый Структура;\r\n\t\t\tСтруктураРеквизитов.Вставить(ИмяЭлемента, СтруктураЭлемента);\r\n\t\t\t\r\n\t\t\tРеквизитыДляРазмещения.Добавить(СтруктураРеквизитов);\r\n\t\t\r\n\t\tКонецЕсли;\r\n\t\t//- Дополнительное размещение реквизитов на форме\r\n\t\r\n\tКонецЦикла;\r\n\t\r\n\tФорма.ИзменитьРеквизиты(ДобавляемыеРеквизиты);\r\n\tРазместитьРеквизитыНаФорме(Форма, РеквизитыДляРазмещения);\r\n\t\t\t\t\t\t\t\t\r\nКонецПроцедуры\r\n\r\n// Добавляет в дерево элементов формы существующие реквизиты объекта и формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  МассивРеквизитов  - Массив структур - содержит:\r\n//     * Имя  - Имя добавляемого реквизита\r\n//     * Значение - Структура - содержит (все свойства не обязательные):\r\n//        ** ИмяГруппы \t\t\t- Строка - имя элемента родителя\r\n//        ** ПутьКДанным\t\t- Строка - путь к данным. Если не указано, то будет Объект.<ИмяРеквизита>\r\n//        ** ВидПоляФормы\t\t- ВидПоляФормы - вид поля формы. По умолчанию ПолеВвода\r\n//        ** Видимость \t\t\t- Булево - значение свойства Видимость\r\n//        ** ТолькоПросмотр \t- Булево - значение свойства ТолькоПросмотр\r\n//        ** Доступность \t\t- Булево - значение свойства Доступность\r\n//        ** ПоместитьПеред\t\t- Строка - имя элемента, перед которым необходимо разместить\r\n//        ** ОбработкаСобытий \t- Массив структур - содержит:\r\n//           *** Событие \t- Строка - имя события элемента\r\n//           *** Действие \t- Строка - имя процедуры исполнителя события\r\n//\r\nПроцедура РазместитьРеквизитыНаФорме(Форма, МассивРеквизитов) Экспорт\r\n\r\n\tДля каждого ТекРеквизит Из МассивРеквизитов Цикл\r\n\t\t\r\n\t\tИмяРеквизита \t\t= ТекРеквизит.Имя;\r\n\t\tПараметрыРеквизита \t= ТекРеквизит.Значение;\r\n\t\t\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ИмяГруппы\") Тогда\r\n\t\t\tЭлементРодитель = Форма.Элементы[ПараметрыРеквизита.ИмяГруппы];\t\r\n\t\tИначе\r\n\t\t\tЭлементРодитель = Форма;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЭлемент = Форма.Элементы.Добавить(ИмяРеквизита, Тип(\"ПолеФормы\"), ЭлементРодитель);\r\n\t\t\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ПутьКДанным\") Тогда\r\n\t\t\tЭлемент.ПутьКДанным = ПараметрыРеквизита.ПутьКДанным;\r\n\t\tИначе \r\n\t\t\tЭлемент.ПутьКДанным = \"Объект.\" + ИмяРеквизита;\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ВидПоляФормы\") Тогда\t\t\r\n\t\t\tЭлемент.Вид = ПараметрыРеквизита.ВидПоляФормы;\t\r\n\t\tИначе\r\n\t\t\tЭлемент.Вид = ВидПоляФормы.ПолеВвода;\r\n\t\tКонецЕсли;                               \t\r\n\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"Видимость\") Тогда\r\n\t\t\tЭлемент.Видимость = ПараметрыРеквизита.Видимость;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ТолькоПросмотр\") Тогда\r\n\t\t\tЭлемент.ТолькоПросмотр = ПараметрыРеквизита.ТолькоПросмотр;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"Доступность\") Тогда\r\n\t\t\tЭлемент.Доступность = ПараметрыРеквизита.Доступность;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\t\t\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ПоместитьПеред\") Тогда\r\n\t\t\tФорма.Элементы.Переместить(Элемент, ЭлементРодитель, Форма.Элементы[ПараметрыРеквизита.ПоместитьПеред]);\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\t//--- обработчики событий\r\n\t\tЕсли ПараметрыРеквизита.Свойство(\"ОбработкаСобытий\")\r\n\t\t\tИ ТипЗнч(ПараметрыРеквизита.ОбработкаСобытий) = Тип(\"Массив\") Тогда\r\n\t\t\t\r\n\t\t\tДля каждого ТекСобытие Из ПараметрыРеквизита.ОбработкаСобытий Цикл\r\n\t\t\t\tЭлемент.УстановитьДействие(ТекСобытие.Событие, ТекСобытие.Действие);\t\t\r\n\t\t\tКонецЦикла; \t\t\t\r\n\t\t\t\r\n\t\tКонецЕсли; \r\n\t\t\r\n\tКонецЦикла; \t\r\n\t\r\nКонецПроцедуры\r\n\r\n// Добавляет в дерево элементов формы существующие реквизиты объекта и формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  Имя  - Имя добавляемого реквизита\r\n//  ИмяГруппы \t\t\t- Строка - имя элемента родителя\r\n//  ПутьКДанным\t\t- Строка - путь к данным. Если не указано, то будет Объект.<ИмяРеквизита>\r\n//  ВидПоляФормы\t\t- ВидПоляФормы - вид поля формы. По умолчанию ПолеВвода\r\n//  Видимость \t\t\t- Булево - значение свойства Видимость\r\n//  ТолькоПросмотр \t- Булево - значение свойства ТолькоПросмотр\r\n//  Доступность \t\t- Булево - значение свойства Доступность\r\n//  ПоместитьПеред\t\t- Строка - имя элемента, перед которым необходимо разместить\r\n//  ОбработкаСобытий \t- Массив структур - содержит:\r\n//   * Событие \t- Строка - имя события элемента\r\n//   * Действие \t- Строка - имя процедуры исполнителя события \r\n//  ТипЭлемента     - Поле формы или например Таблица формы, по умолчанию тип поле формы\r\n//\r\nПроцедура РазместитьРеквизитНаФорме(Форма, Имя, ИмяГруппы = \"\", ПутьКДанным = \"\", ПутьКДаннымПодвала = \"\", ПВидПоляФормы = неопределено, Видимость = Истина,\r\n\t\t\t\t\t\t\t\t\tТолькоПросмотр = Ложь, Доступность = Истина, ПоместитьПеред = \"\", ОбработкаСобытий = неопределено, Заголовок = \"\") Экспорт\r\n\r\n\t//Для каждого ТекРеквизит Из МассивРеквизитов Цикл\r\n\t\t\r\n\t\tУстановитьПривилегированныйРежим(Истина);\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ИмяГруппы) Тогда\r\n\t\t\tЭлементРодитель = Форма.Элементы[ИмяГруппы];\t\r\n\t\tИначе\r\n\t\t\tЭлементРодитель = Форма;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t\r\n\t\tЭлемент = Форма.Элементы.Добавить(Имя, Тип(\"ПолеФормы\"), ЭлементРодитель);\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Заголовок) Тогда\r\n\t\t\tЭлемент.Заголовок = Заголовок;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ПутьКДанным) Тогда\r\n\t\t\tЭлемент.ПутьКДанным = ПутьКДанным;\r\n\t\tИначе \r\n\t\t\tЭлемент.ПутьКДанным = \"Объект.\" + Имя;\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ПутьКДаннымПодвала) Тогда\r\n\t\t\tЭлемент.ПутьКДаннымПодвала = ПутьКДаннымПодвала;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ПВидПоляФормы <> неопределено Тогда\t\t\r\n\t\t\tЭлемент.Вид = ПВидПоляФормы;\t\r\n\t\tИначе\r\n\t\t\tЭлемент.Вид = ВидПоляФормы.ПолеВвода;\r\n\t\tКонецЕсли;                               \t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Видимость) Тогда\r\n\t\t\tЭлемент.Видимость = Видимость;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ТолькоПросмотр) Тогда\r\n\t\t\tЭлемент.ТолькоПросмотр = ТолькоПросмотр;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Доступность) Тогда\r\n\t\t\tЭлемент.Доступность = Доступность;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ПоместитьПеред) Тогда\r\n\t\t\tФорма.Элементы.Переместить(Элемент, ЭлементРодитель, Форма.Элементы[ПоместитьПеред]);\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\t//--- обработчики событий\r\n\t\tЕсли ОбработкаСобытий <> неопределено\r\n\t\t\tИ ТипЗнч(ОбработкаСобытий) = Тип(\"Массив\") Тогда\r\n\t\t\t\r\n\t\t\tДля каждого ТекСобытие Из ОбработкаСобытий Цикл\r\n\t\t\t\tЭлемент.УстановитьДействие(ТекСобытие.Событие, ТекСобытие.Действие);\t\t\r\n\t\t\tКонецЦикла; \t\t\t\r\n\t\t\t\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t//КонецЦикла; \t\r\n\t\r\nКонецПроцедуры\r\n\r\n// Устанавливает обработчик события для элемента формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  ИмяЭлемента  - Строка - имя элемента формы\r\n//\r\n//  Событие  - Строка - имя события элемента\r\n//\r\n//  Действие  - Строка - имя процедуры исполнителя события\r\n//\r\nПроцедура УстановитьСобытиеЭлементаФормы(Форма, ИмяЭлемента, Событие, Действие) Экспорт\r\n\r\n\tЭлемент = Форма.Элементы[ИмяЭлемента];\r\n\tЭлемент.УстановитьДействие(Событие, Действие);\t\t\r\n\r\nКонецПроцедуры\r\n\r\n// Добавляет в дерево элементов формы новую группу\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  ИмяГруппы  - Строка - имя новой группы\r\n//\r\n//  РодительГруппы  - Строка - родитель группы. Не обязательно\r\n//\r\n//  ВидГруппы  - ВидГруппыФормы - вид группы. По умолчанию ОбычнаяГруппа\r\n//\r\n//  Группировка  - ГруппировкаПодчиненныхЭлементовФормы  - вариант группировки. По умолчанию ГоризонтальнаяЕслиВозможно\r\n//\r\n//  ОтображатьЗаголовок  - Булево - значение свойства ОтображатьЗаголовок группы. По умолчанию Ложь\r\n//\r\n//  Заголовок  - Строка - заголовок группы. По умолчанию заголовок пустой\r\n//\r\nПроцедура ДобавитьГруппуНаФорму(Форма, ИмяГруппы, РодительГруппы = \"\",\r\n\t\t\t\t\t\t\t\tВидГруппы = Неопределено,\r\n\t\t\t\t\t\t\t\tГруппировка = Неопределено,\r\n\t\t\t\t\t\t\t\tОтображатьЗаголовок = Ложь,\r\n\t\t\t\t\t\t\t\tЗаголовок = Неопределено,\r\n\t\t\t\t\t\t\t\tОбъединенная = Истина,\r\n\t\t\t\t\t\t\t\tПоместитьПеред = \"\") Экспорт\r\n\r\n\tЕсли НЕ ПустаяСтрока(РодительГруппы) Тогда\r\n\t\tЭлементРодитель = Форма.Элементы[РодительГруппы];\t\r\n\tИначе\r\n\t\tЭлементРодитель = Форма;\r\n\tКонецЕсли;\r\n\t\r\n\tГруппаФормы = Форма.Элементы.Добавить(ИмяГруппы, Тип(\"ГруппаФормы\"), ЭлементРодитель);\r\n\t\r\n\tГруппаФормы.Вид \t\t\t\t= ?(ВидГруппы = Неопределено, ВидГруппыФормы.ОбычнаяГруппа, ВидГруппы);\r\n\tГруппаФормы.Группировка \t\t= ?(Группировка = Неопределено,\r\n\t\t\t\t\t\t\t\t\t\tГруппировкаПодчиненныхЭлементовФормы.ГоризонтальнаяЕслиВозможно,\r\n\t\t\t\t\t\t\t\t\t\tГруппировка);\r\n\tГруппаФормы.ОтображатьЗаголовок = ОтображатьЗаголовок;\r\n\tГруппаФормы.Заголовок = Заголовок;\r\n\tЕсли ВидГруппы = ВидГруппыФормы.ОбычнаяГруппа Тогда\r\n\t\tГруппаФормы.Объединенная = Объединенная; \r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ПоместитьПеред) Тогда\r\n\t\tФорма.Элементы.Переместить(ГруппаФормы, Форма.Элементы[РодительГруппы], Форма.Элементы[ПоместитьПеред]);\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\n// Добавляет в дерево элементов формы существующие реквизиты объекта и формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  Имя  - Имя добавляемого реквизита\r\n//  ИмяГруппы \t\t\t- Строка - имя элемента родителя\r\n//  ПутьКДанным\t\t- Строка - путь к данным. Если не указано, то будет Объект.<ИмяРеквизита>\r\n//  ВидПоляФормы\t\t- ВидПоляФормы - вид поля формы. По умолчанию ПолеВвода\r\n//  Видимость \t\t\t- Булево - значение свойства Видимость\r\n//  ТолькоПросмотр \t- Булево - значение свойства ТолькоПросмотр\r\n//  Доступность \t\t- Булево - значение свойства Доступность\r\n//  ПоместитьПеред\t\t- Строка - имя элемента, перед которым необходимо разместить\r\n//  ОбработкаСобытий \t- Массив структур - содержит:\r\n//   * Событие \t- Строка - имя события элемента\r\n//   * Действие \t- Строка - имя процедуры исполнителя события \r\n//  ТипЭлемента     - Поле формы или например Таблица формы, по умолчанию тип поле формы\r\n//\r\nПроцедура РазместитьТаблицуНаФорме(Форма, Имя, ИмяГруппы = \"\", ПутьКДанным = \"\", Видимость = Истина, ТолькоПросмотр = Ложь, \r\n\t\t\t\t\t\t\tДоступность = Истина, ПоместитьПеред = \"\", ОбработкаСобытий = неопределено, Подвал = Ложь) Экспорт\r\n\r\n\t\t\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ИмяГруппы) Тогда\r\n\t\t\tЭлементРодитель = Форма.Элементы[ИмяГруппы];\t\r\n\t\tИначе\r\n\t\t\tЭлементРодитель = Форма;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t\r\n\t\tЭлемент = Форма.Элементы.Добавить(Имя, Тип(\"ТаблицаФормы\"), ЭлементРодитель);\r\n\t\t\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ПутьКДанным) Тогда\r\n\t\t\tЭлемент.ПутьКДанным = ПутьКДанным;\r\n\t\tИначе \r\n\t\t\tЭлемент.ПутьКДанным = \"Объект.\" + Имя;\r\n\t\tКонецЕсли;                               \t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Видимость) Тогда\r\n\t\t\tЭлемент.Видимость = Видимость;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ТолькоПросмотр) Тогда\r\n\t\t\tЭлемент.ТолькоПросмотр = ТолькоПросмотр;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Доступность) Тогда\r\n\t\t\tЭлемент.Доступность = Доступность;\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\t\t\r\n\t\tЕсли ЗначениеЗаполнено(ПоместитьПеред) Тогда\r\n\t\t\tФорма.Элементы.Переместить(Элемент, ЭлементРодитель, Форма.Элементы[ПоместитьПеред]);\t\r\n\t\tКонецЕсли; \t\t\r\n\t\t\r\n\t\tЭлемент.Подвал = Подвал;\r\n\t\t\r\n\t\t//--- обработчики событий\r\n\t\tЕсли ОбработкаСобытий <> неопределено\r\n\t\t\tИ ТипЗнч(ОбработкаСобытий) = Тип(\"Массив\") Тогда\r\n\t\t\t\r\n\t\t\tДля каждого ТекСобытие Из ОбработкаСобытий Цикл\r\n\t\t\t\tЭлемент.УстановитьДействие(ТекСобытие.Событие, ТекСобытие.Действие);\t\t\r\n\t\t\tКонецЦикла; \t\t\t\r\n\t\t\t\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t//КонецЦикла; \t\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура СозданиеДинамическогоСписка(\r\n\tФорма,                                      //Тип форма -  Форма документа\r\n\tИмяСписка = \"Список\", \t\t\t\t\t\t//тип строка - имя будущего списка на форме и реквизита\r\n\tТекстЗапроса = \"\", \t\t\t\t\t\t\t//тип строка - запрос, если он не указан, необходимо указать таблицу\r\n\tМассивКолонок,                  \t\t\t//тип массив - массив создаваемых колонок, значения тип строка. Пример: \"Д,ДоговораКонтрагента\" значит будет создана колонка\r\n\t\t\t\t\t\t\t\t\t\t\t\t//\t\t\t\tс заголовком \"Д\" и колонкой списка \"ДоговораКонтрагента\". Если указать просто \"ДоговораКонтрагента\", \r\n\t\t\t\t\t\t\t\t\t\t\t\t//\t\t\t\tзаголовок будет идентичен заголовку по умолчанию типа \"Договор контрагента\".\r\n\tСписокДействий = Неопределено,  \t\t\t//типа структура - структура содержит действия (свойства) динамического списка, можно указать только те которые необходимы.\r\n\t\t\t\t\t\t\t\t\t\t\t\t//\t\t\t\tпример: СписокДействий = Новый Структура(\"Выбор,ПриАктивизацииСтроки\",\"СписокВыбор\",\"СписокПриАктивизацииСтроки\")\r\n\tТаблицаСписка = \"\",\t\t\t\t\t\t\t//тип строка - содержит имя основной таблицы, пример: \"Документ.РеализацияТоваровУслуг\"\t\r\n\tДобавитьВ = \"\",                 \t\t\t//тип строка - имя элемента на который будет размещен список, если пустое, тогда добавляется на форму\r\n\tВставитьПеред = \"\",             \t\t\t//тип строка - имя элемента перед которым будет размещен список, если пустое, будет просто добавлен в конец\r\n\tСвояКоманднаяПанель = ЛОЖЬ,     \t\t\t//тип булево - если ИСТИНА, скрывает стандартную панель и создает свою пустую для будущего наполнения ИмяСписка+\"КоманднаяПанель2\"\r\n\tПараметрыЗапроса = Неопределено) Экспорт \t//тип структура - содержит перечень параметров, если они используются в запросе.\r\n\t\r\n\t//Защита от дурака\r\n\tЕсли ТекстЗапроса = \"\" И ТаблицаСписка = \"\" Тогда Сообщить(\"Ошибка формирования динамического списка, укажите запрос или таблицу\"); Возврат; КонецЕсли;\r\n\t\r\n\tЭлементы = Форма.Элементы;\r\n\t\r\n\t//Создаем свою командную панель, тот случай когда я не нашел способа снять галочку \"Автозаполнение\"\r\n\tЕсли СвояКоманднаяПанель Тогда\r\n\t\tЕсли ВставитьПеред = \"\" Тогда\r\n\t\t\tГруппаДинамическогоСписка  = Элементы.Добавить(\"Группа\" + ИмяСписка + \"CоСвоейКоманднойПанелью\",Тип(\"ГруппаФормы\"),?(ДобавитьВ = \"\",Форма,Форма.Элементы[ДобавитьВ]));\r\n\t\tИначе\r\n\t\t\tГруппаДинамическогоСписка  = Элементы.Вставить(\"Группа\" + ИмяСписка + \"CоСвоейКоманднойПанелью\",Тип(\"ГруппаФормы\"),?(ДобавитьВ = \"\",Форма,Форма.Элементы[ДобавитьВ]),Форма.Элементы[ВставитьПеред]);\t\t\t\r\n\t\tКонецЕсли;\r\n\t\tГруппаДинамическогоСписка.Вид = ВидГруппыФормы.ОбычнаяГруппа;\r\n\t\tГруппаДинамическогоСписка.ОтображатьЗаголовок = Ложь;\r\n\t\tГруппаДинамическогоСписка.Отображение = ОтображениеОбычнойГруппы.Нет;\r\n\t\tГруппаДинамическогоСписка.Группировка = ГруппировкаПодчиненныхЭлементовФормы.Вертикальная;\r\n\t\tКоманднаяПанельСписка  = Элементы.Добавить(ИмяСписка + \"КоманднаяПанель2\",Тип(\"ГруппаФормы\"),ГруппаДинамическогоСписка);\r\n\t\tКоманднаяПанельСписка.Вид = ВидГруппыФормы.КоманднаяПанель;\t\t\t\r\n\tКонецЕсли;\r\n\t\t\t\t\t\t\t\t\t\r\n\t//Создаем реквизит формы\r\n\tТипыРеквизита = Новый Массив;                             \r\n\tТипыРеквизита.Добавить(Тип(\"ДинамическийСписок\"));\r\n\tОписаниеТиповДляРеквизита = Новый ОписаниеТипов(ТипыРеквизита); \r\n\tДинамическийСписок = Новый РеквизитФормы(ИмяСписка, ОписаниеТиповДляРеквизита,,\"\",ЛОЖЬ); //Имя реквизита\r\n\tДобавляемыеРеквизиты = Новый Массив;\r\n\tДобавляемыеРеквизиты.Добавить(ДинамическийСписок);        \r\n\t\r\n\t//Задаем свойства реквизиту\r\n\tФорма.ИзменитьРеквизиты(ДобавляемыеРеквизиты);        \r\n\tРеквизитДинамическийСписок = Форма[ИмяСписка]; //Имя реквизита\r\n\tЕсли ТекстЗапроса = \"\" Тогда\r\n\t\tРеквизитДинамическийСписок.ПроизвольныйЗапрос = ЛОЖЬ;\r\n\t\tРеквизитДинамическийСписок.ОсновнаяТаблица = ТаблицаСписка;\r\n\tИначе\r\n\t\tРеквизитДинамическийСписок.ПроизвольныйЗапрос = ИСТИНА;\r\n\t\tРеквизитДинамическийСписок.ТекстЗапроса = ТекстЗапроса;\r\n\t\tЕсли ТаблицаСписка <> \"\" Тогда РеквизитДинамическийСписок.ОсновнаяТаблица = ТаблицаСписка; КонецЕсли;\t\t\r\n\tКонецЕсли;\r\n\t\r\n\t//Заполняем параметры если они были указаны\r\n\tЕсли ПараметрыЗапроса <> Неопределено Тогда\r\n\t\tДля Каждого Параметра из ПараметрыЗапроса Цикл\r\n\t\t\tРеквизитДинамическийСписок.Параметры.УстановитьЗначениеПараметра(Параметра.Ключ,Параметра.Значение);\t\r\n\t\tКонецЦикла;\t\t \r\n\tКонецЕсли;\r\n\t\r\n\t//Размещаем реквизит на форме\r\n\tЕсли ЛОЖЬ\r\n\t\tИЛИ ВставитьПеред = \"\" \r\n\t\tИЛИ СвояКоманднаяПанель //Если своя командная панель тогда нет логики уже в параметре ВставитьПеред\r\n\t\tТогда\r\n\t\tТаблицаФормы = Элементы.Добавить(ИмяСписка,Тип(\"ТаблицаФормы\"),?(СвояКоманднаяПанель,ГруппаДинамическогоСписка,?(ДобавитьВ = \"\",Форма,Форма.Элементы[ДобавитьВ])));\r\n\tИначе\r\n\t\tТаблицаФормы = Элементы.Вставить(ИмяСписка,Тип(\"ТаблицаФормы\"),?(ДобавитьВ = \"\",Форма,Форма.Элементы[ДобавитьВ]),Форма.Элементы[ВставитьПеред]);\t\r\n\tКонецЕсли;\t\t\r\n\tТаблицаФормы.ПутьКДанным = ИмяСписка; //Имя реквизита \r\n\t\r\n\t//Если своя панель тогда скрываем стандартную\r\n\tЕсли СвояКоманднаяПанель Тогда\r\n\t\tЭлементы[ИмяСписка].ПоложениеКоманднойПанели = ПоложениеКоманднойПанелиЭлементаФормы.Нет;\r\n\tКонецЕсли;\r\n\r\n\t//Создание колонок на основание МассивКолонок\r\n\tДля Каждого Элемента Из МассивКолонок Цикл\r\n\t\tПараметрыКолонки = СтрЗаменить(Элемента,\",\",Символы.ПС);\r\n\t\tЕсли СтрЧислоСтрок(ПараметрыКолонки) > 1 Тогда\r\n\t\t\tЗаголовок = СтрПолучитьСтроку(ПараметрыКолонки, 1);\r\n\t\t\tИмяКолонки = СтрПолучитьСтроку(ПараметрыКолонки, 2);\r\n\t\tИначе\r\n\t\t\tЗаголовок = \"\";\r\n\t\t\tИмяКолонки = ПараметрыКолонки; \r\n\t\tКонецЕсли;\t\r\n\t\tНоваяКолонкаТаблицы = Элементы.Добавить(ИмяСписка + ИмяКолонки, Тип(\"ПолеФормы\"), ТаблицаФормы);\r\n\t\tЕсли Заголовок <> \"\" Тогда НоваяКолонкаТаблицы.Заголовок = Заголовок; КонецЕсли;\r\n\t\tНоваяКолонкаТаблицы.ПутьКДанным = ИмяСписка + \".\" + ИмяКолонки; \t\r\n\tКонецЦикла;\r\n\t\r\n\t//Задаем действия (События) на основание СписокДействий, если он определен\r\n\tЕсли СписокДействий <> Неопределено Тогда \t\r\n\t\tПереченьСвойств = \"ПриИзменении\r\n\t\t\t\t\t\t|Выбор\r\n\t\t\t\t\t\t|ПриАктивизацииСтроки\r\n\t\t\t\t\t\t|ВыборЗначения\r\n\t\t\t\t\t\t|ПриАктивизацииПоля\r\n\t\t\t\t\t\t|ПриАктивизацииЯчейки\r\n\t\t\t\t\t\t|ПередНачаломДобавления\r\n\t\t\t\t\t\t|ПередНачаломИзменения\r\n\t\t\t\t\t\t|ПередУдалением\r\n\t\t\t\t\t\t|ПриНачалеРедактирования\r\n\t\t\t\t\t\t|ПередОкончаниемРедактирования\r\n\t\t\t\t\t\t|ПриОкончанииРедактирования\r\n\t\t\t\t\t\t|ОбработкаВыбора\r\n\t\t\t\t\t\t|ПередРазворачиванием\r\n\t\t\t\t\t\t|ПередСворачиванием\r\n\t\t\t\t\t\t|ПослеУдаления\r\n\t\t\t\t\t\t|ПриСменеТекущегоРодителя\r\n\t\t\t\t\t\t|ОбработкаЗаписиНового\r\n\t\t\t\t\t\t|ПриСохраненииПользовательскихНастроекНаСервере\r\n\t\t\t\t\t\t|ПередЗагрузкойПользовательскихНастроекНаСервере\r\n\t\t\t\t\t\t|ПриЗагрузкеПользовательскихНастроекНаСервере\r\n\t\t\t\t\t\t|ПриОбновленииСоставаПользовательскихНастроекНаСервере\r\n\t\t\t\t\t\t|ОбработкаЗапросаОбновления\r\n\t\t\t\t\t\t|ПриПолученииДанныхНаСервере\r\n\t\t\t\t\t\t|НачалоПеретаскивания\r\n\t\t\t\t\t\t|ПроверкаПеретаскивания\r\n\t\t\t\t\t\t|ОкончаниеПеретаскивания\r\n\t\t\t\t\t\t|Перетаскивание\";\r\n\t\tДля Счетчик = 1 по 28 Цикл\r\n\t\t\tИмяСвойства = СтрПолучитьСтроку(ПереченьСвойств, Счетчик);\r\n\t\t\tЭлементы[ИмяСписка].УстановитьДействие(ИмяСвойства,?(СписокДействий.Свойство(ИмяСвойства),СписокДействий[ИмяСвойства],\"\"));\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\t\r\n\r\nКонецПроцедуры \r\n\r\n// Изменяет свойства элементов формы\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - изменяемая форма\r\n//\r\n//  ИмяЭлемента  - Строка - имя элемента формы\r\n//\r\n//  ИмяСвойства  - Строка - имя свойства элемента\r\n//\r\n//  ЗначениеСвойства  - Произвольный - значение свойства элемента\r\n//\r\nПроцедура ИзменитьСвойствоЭлементаФормы(Форма, ИмяЭлемента, ИмяСвойства, ЗначениеСвойства) Экспорт\r\n\r\n\tЭлемент = Форма.Элементы[ИмяЭлемента];\r\n\tЭлемент[ИмяСвойства] = ЗначениеСвойства;\r\n\t\r\nКонецПроцедуры\n\n{656} Переменной Элемент присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Форматирование кода",
    "description": "Форматирование кода 1С для TurboConf: Установка отступов, сдвигов, приведение к каноническому написанию.",
    "code_snippet": ""
  },
  {
    "title": "Переключатель активной задачи",
    "description": "Возможность вести список задач для установки активной задачи в TurboConf",
    "code_snippet": ""
  },
  {
    "title": "coloratos",
    "description": "Библиотека для OneScript для цветного вывода в консоль",
    "code_snippet": ""
  },
  {
    "title": "tablereader",
    "description": "Реализация объекта для чтения xlsx книг.",
    "code_snippet": ""
  },
  {
    "title": "fzy",
    "description": "Позволяет осуществлять нечеткий поиск по коллекциям 1С, таким как Массив, Структура, Соответствие, ТаблицаЗначений.",
    "code_snippet": ""
  },
  {
    "title": "Выбор файла управляемое приложение",
    "description": "Выбор файла управляемое приложение",
    "code_snippet": "&НаКлиенте\r\nПроцедура ЗагрузитьФайл(Команда)\r\n\t\r\n\tДиалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);\r\n\tДиалог.Фильтр \t\t\t= НСтр(\"ru=’Книга Excel 97 (*.xls)|*.xls|Книга Excel 2007 (*.xlsx)|*.xlsx'\");\r\n\tДиалог.Заголовок \t\t= НСтр(\"ru=’Выберите файл Excel'\");\r\n\tОповещениеЗавершения \t= Новый ОписаниеОповещения(\"ВыборФайлаЗавершение\", ЭтотОбъект);\r\n\t\r\n\tДиалог.Показать(ОповещениеЗавершения);\r\n\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ВыборФайлаЗавершение(ВыбранныеФайлы, ДополнительныеПараметры) Экспорт\r\n\t\r\n\tЕсли ВыбранныеФайлы <> Неопределено Тогда\r\n\t\t\r\n\t\tПутьКФайлу = ВыбранныеФайлы[0];\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура ЗагрузитьФайл(Команда)\r\n\t\r\n\tДиалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);\r\n\tДиалог.Фильтр \t\t\t= НСтр(\"ru=’Книга Excel 97 (*.xls)|*.xls|Книга Excel 2007 (*.xlsx)|*.xlsx'\");\r\n\tДиалог.Заголовок \t\t= НСтр(\"ru=’Выберите файл Excel'\");\r\n\tОповещениеЗавершения \t= Новый ОписаниеОповещения(\"ВыборФайлаЗавершение\", ЭтотОбъект);\r\n\t\r\n\tДиалог.Показать(ОповещениеЗавершения);\r\n\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура ВыборФайлаЗавершение(ВыбранныеФайлы, ДополнительныеПараметры) Экспорт\r\n\t\r\n\tЕсли ВыбранныеФайлы <> Неопределено Тогда\r\n\t\t\r\n\t\tПутьКФайлу = ВыбранныеФайлы[0];\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\n{18} Переменной ПутьКФайлу присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Универсальная процедура проверки на дубли строк в табличной части документа",
    "description": "Универсальная процедура проверки на дубли строк в табличной части документа",
    "code_snippet": "Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)\n\t\t\n\tЕсли Запасы.Количество() = 0 Тогда\n\t\tВозврат;\n\tКонецЕсли;\n\t\n\tПроверитьДублиСтрок(Ссылка, \"Запасы\", \"Номенклатура, АлгоритмФормированияШК,Регион\", Отказ);\n\nКонецПроцедуры\n\n//Процедура проверяет наличие в ТЧ дублей строк по указанным реквизитам\n//ДокументСсылка       - ссылка на проверяемый документ\n//ИмяТабЧасти          - имя проверяемой табличной части (строка)\n//ПроверяемыеРеквизиты - перечень проверяемых реквизитов (строка, реквизиты разделяются запятой) \n Процедура ПроверитьДублиСтрок(ДокументСсылка,ИмяТабЧасти,ПроверяемыеРеквизиты,Отказ)\n \n\tТаблицаДокумента = ДокументСсылка[ИмяТабЧасти].Выгрузить();\n\tТаблицаДокумента.Колонки.Добавить(\"КвоПроверкаДублей\"); \n\tТаблицаДокумента.ЗаполнитьЗначения(1, \"КвоПроверкаДублей\");\n\t\n\tТаблицаДокумента.Свернуть(ПроверяемыеРеквизиты,\"КвоПроверкаДублей\");\n\t\n\tДля Каждого ТекущаяСтрока Из ТаблицаДокумента Цикл \n\t\tЕсли ТекущаяСтрока.КвоПроверкаДублей > 1 Тогда\n\t\t\tРеквизитыДляСообщения = \"\";\n\t\t\tСтр = СокрЛП(ПроверяемыеРеквизиты);\n\t\t\tПока Найти(Стр,\",\") > 0 Цикл\n\t\t\t\tНаимРеквизита = СокрЛП(Лев(Стр,Найти(Стр,\",\") - 1));\n\t\t\t\tСтр = Прав(Стр,СтрДлина(Стр) - Найти(Стр,\",\"));\n\t\t\t\tРеквизитыДляСообщения = РеквизитыДляСообщения+ТекущаяСтрока[НаимРеквизита]+\", \";\n\t\t\tКонецЦикла; \n\t\t\tРеквизитыДляСообщения = РеквизитыДляСообщения+ТекущаяСтрока[СокрЛП(Стр)];\n\t\t\t\n\t\t\tСообщение = Новый СообщениеПользователю;\n\t\t\tСообщение.Текст = \"В разделе \" + ТекущаяСтрока.Раздел + \" встречается одинаковый номер строки \" + ТекущаяСтрока.НомерСтрокиВОтчете + \", сохранение невозможно\";\n\t\t\tСообщение.Сообщить();\n\t\t\t\n\t\t\tОтказ = Истина;\n\t\tКонецЕсли; \n\tКонецЦикла;\n \n КонецПроцедуры"
  },
  {
    "title": "anti_swagger",
    "description": "Конвертор OpenAPI Specification (OAS)",
    "code_snippet": ""
  },
  {
    "title": "Получить выделенные строки списка (с сохранением выделения)",
    "description": "Получить выделенные строки списка (с сохранением выделения)",
    "code_snippet": "&НаКлиенте\nФункция ПолучитьЭлементыПоВыделеннымСтрокам(ВыбЭлемент, ПолеСсылка) Экспорт\n\tМассивЭлементов = Новый Массив();\n\tВыдСтроки = Новый Массив();\n\t\n\tДля Каждого текСтр Из ВыбЭлемент.ВыделенныеСтроки Цикл\n\t\tВыдСтроки.Добавить(ТекСтр);\n\tКонецЦикла;\n\t\n\tДля Каждого ТекВыд Из ВыдСтроки Цикл\n\t\tВыбЭлемент.ТекущаяСтрока = ТекВыд;\n\t\tСсылкаНаЭлемент = ВыбЭлемент.ТекущиеДанные[ПолеСсылка];\t\t\t\n\t\tМассивЭлементов.Добавить(СсылкаНаЭлемент);\n\tКонецЦикла;\n\t\n\tДля Каждого ТекВыд Из ВыдСтроки Цикл\n\t\tВыбЭлемент.ВыделенныеСтроки.Добавить(ТекВыд);\n\tКонецЦикла;\n\t\n\tВозврат МассивЭлементов;\nКонецФункции"
  },
  {
    "title": "Печать своей печатной формы (без использования команды)",
    "description": "Печать своей печатной формы (без использования команды)",
    "code_snippet": "//////////////////////////////////////////////////// Кнопка вызова печати\n\nМассивОбъектов = Новый Массив;\nМассивОбъектов.Добавить(СсылкаНаДокументИлиСправочник);\n\t\nПараметрыПечать = Новый Структура;\nПараметрыПечать.Вставить(\"ЗаголовокФормы\", СсылкаНаДокументИлиСправочник);\n\t\nУправлениеПечатьюКлиент.ВыполнитьКомандуПечати(\"ПУТЬ_К_МОДУЛЮ_МЕНЕДЖЕРА_ОБЪЕКТА_ПЕЧАТИ\", \"ИМЯ_МАКЕТА\", МассивОбъектов, Неопределено, ПараметрыПечать);\n\n//////////////////////////////////////////////////// Модуль менеджера объекта печати\n\nПроцедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\n\t\t\n\tЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, \"ИМЯ_МАКЕТА\") Тогда\t\t\n\t\tУправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(\n\t\tКоллекцияПечатныхФорм,\n\t\t\"ИМЯ_МАКЕТА\",\n\t\t\"СИНОНИМ_МАКЕТА\",\n\t\tПечатнаяФорма(МассивОбъектов));\n\tКонецЕсли;\n\t\nКонецПроцедуры\n\nФункция ПечатнаяФорма(МассивОбъектов)\n\t\n\tТабличныйДокумент = Новый ТабличныйДокумент;\n\tТабличныйДокумент.АвтоМасштаб = Истина;\n\tТабличныйДокумент.ИмяПараметровПечати = \"ПАРАМЕТРЫ_ПЕЧАТИ_ИМЯ\";\n\t\n\tМакет = ПолучитьМакет(\"Макет\");\n\t\n\tОбластьМакета = Макет.ПолучитьОбласть(\"ОсновнаяОбласть\");\n\t\n\tТабличныйДокумент.Вывести(ОбластьМакета);\n\t\n\tВозврат ТабличныйДокумент;\n\t\nКонецФункции"
  },
  {
    "title": "СКД. Вывод данных из Таблицы значений",
    "description": "СКД. Вывод данных из Таблицы значений",
    "code_snippet": "Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\r\n\t\r\n\tСтандартнаяОбработка = Ложь;\r\n\t\r\n\tНастройкиКомпоновки = КомпоновщикНастроек.ПолучитьНастройки();\r\n\tСхемаКомпоновки = ПолучитьМакет(\"ОсновнаяСхемаКомпоновкиДанных\");\t\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновки, НастройкиКомпоновки);\r\n\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\tВнешниеИсточники = Новый Структура(\"Данные\", ТЗ());\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки, ВнешниеИсточники);\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n\tПроцессорВывода.УстановитьДокумент(ДокументРезультат);\r\n\tДокументРезультат = ПроцессорВывода.Вывести(ПроцессорКомпоновки);\t\r\n\t\r\nКонецПроцедуры\n\nПроцедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\r\n\t\r\n\tСтандартнаяОбработка = Ложь;\r\n\t\r\n\tНастройкиКомпоновки = КомпоновщикНастроек.ПолучитьНастройки();\r\n\tСхемаКомпоновки = ПолучитьМакет(\"ОсновнаяСхемаКомпоновкиДанных\");\t\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновки, НастройкиКомпоновки);\r\n\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\tВнешниеИсточники = Новый Структура(\"Данные\", ТЗ());\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки, ВнешниеИсточники);\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n\tПроцессорВывода.УстановитьДокумент(ДокументРезультат);\r\n\tДокументРезультат = ПроцессорВывода.Вывести(ПроцессорКомпоновки);\t\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Проверка на роль пользователя",
    "description": "Проверка на роль пользователя",
    "code_snippet": "Функция ЕстьРоль(ИмяРоли, Пользователь = Неопределено) Экспорт\r\n\r\n\tЕсли Пользователь = Неопределено Тогда\r\n\t\tПользователь = ПользователиКлиентСервер.ТекущийПользователь();\r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ РАЗРЕШЕННЫЕ\r\n\t\t|\t1 \r\n\t\t|ИЗ\r\n\t\t|\tСправочник.ГруппыДоступа.Пользователи КАК ГруппыДоступаПользователи\r\n\t\t|\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ПрофилиГруппДоступа.Роли КАК ПрофилиГруппДоступаРоли\r\n\t\t|\t\tПО ГруппыДоступаПользователи.Ссылка.Профиль = ПрофилиГруппДоступаРоли.Ссылка\r\n\t\t|ГДЕ\r\n\t\t|\tПрофилиГруппДоступаРоли.Роль.Имя = &Роль\r\n\t\t|\tИ ГруппыДоступаПользователи.Пользователь = &Пользователь\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"Пользователь\", Пользователь);\r\n\tЗапрос.УстановитьПараметр(\"Роль\", ИмяРоли);\r\n\t\r\n\tУстановитьПривилегированныйРежим(Истина);\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\tУстановитьПривилегированныйРежим(Ложь);\r\n\t\r\n\tЕсли РезультатЗапроса.Пустой() Тогда\r\n\t\tВозврат Ложь;\t\t\r\n\tИначе\t\r\n\t\tВозврат Истина;\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции\n\nФункция ЕстьРоль(ИмяРоли, Пользователь = Неопределено) Экспорт\r\n\r\n\tЕсли Пользователь = Неопределено Тогда\r\n\t\tПользователь = ПользователиКлиентСервер.ТекущийПользователь();\r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ РАЗРЕШЕННЫЕ\r\n\t\t|\t1 \r\n\t\t|ИЗ\r\n\t\t|\tСправочник.ГруппыДоступа.Пользователи КАК ГруппыДоступаПользователи\r\n\t\t|\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ПрофилиГруппДоступа.Роли КАК ПрофилиГруппДоступаРоли\r\n\t\t|\t\tПО ГруппыДоступаПользователи.Ссылка.Профиль = ПрофилиГруппДоступаРоли.Ссылка\r\n\t\t|ГДЕ\r\n\t\t|\tПрофилиГруппДоступаРоли.Роль.Имя = &Роль\r\n\t\t|\tИ ГруппыДоступаПользователи.Пользователь = &Пользователь\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"Пользователь\", Пользователь);\r\n\tЗапрос.УстановитьПараметр(\"Роль\", ИмяРоли);\r\n\t\r\n\tУстановитьПривилегированныйРежим(Истина);\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\tУстановитьПривилегированныйРежим(Ложь);\r\n\t\r\n\tЕсли РезультатЗапроса.Пустой() Тогда\r\n\t\tВозврат Ложь;\t\t\r\n\tИначе\t\r\n\t\tВозврат Истина;\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Цены на дату документа продажи",
    "description": "Цены на дату документа продажи",
    "code_snippet": "ВЫБРАТЬ\n    Продажи.Период,\n    Продажи.Контрагент,\n    Продажи.Номенклатура,\n    Продажи.КоличествоОборот КАК Количество,\n    Продажи.СтоимостьОборот КАК Стоимость,\n    ЦеныНоменклатуры.Цена\nИЗ\n    РегистрНакопления.Продажи.Обороты(&НачалоПериода, &КонецПериода, День, ) КАК Продажи\n        ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры КАК ЦеныНоменклатуры\n        ПО Продажи.Номенклатура = ЦеныНоменклатуры.Номенклатура\n            И (ЦеныНоменклатуры.ТипЦен = &ТипЦен)\n            И (ЦеныНоменклатуры.Период В\n                (ВЫБРАТЬ МАКСИМУМ(Цены.Период)\n                ИЗ\n                    РегистрСведений.ЦеныНоменклатуры КАК Цены\n                ГДЕ\n                    Цены.Период <= Продажи.Период\n                    И Цены.Номенклатура = Продажи.Номенклатура\n                    И Цены.ТипЦен = &ТипЦен\n))\n\nВЫБРАТЬ\n    Цены.Период,\n    Цены.Номенклатура,\n    Цены.Цена\nПОМЕСТИТЬ ВТЦены\nИЗ РегистрСведений.ЦеныНоменклатуры КАК Цены\nГДЕ Цены.ТипЦен = &ТипЦен И Цены.Период > &НачалоПериода И Цены.Период <= &КонецПериода\n\nОБЪЕДИНИТЬ ВСЕ\n\nВЫБРАТЬ\n    &НачалоПериода,\n    Цены.Номенклатура,\n    Цены.Цена\nИЗ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(&НачалоПериода, ТипЦен = &ТипЦен) КАК Цены\n\n;\n\nВЫБРАТЬ\n    Продажи.Период,\n    Продажи.Контрагент,\n    Продажи.Номенклатура,\n    Продажи.КоличествоОборот КАК Количество,\n    Продажи.СтоимостьОборот КАК Стоимость,\n    ЦеныНоменклатуры.Цена\nИЗ\n    РегистрНакопления.Продажи.Обороты(&НачалоПериода, &КонецПериода, День, ) КАК Продажи\n        ЛЕВОЕ СОЕДИНЕНИЕ ВТЦены КАК ЦеныНоменклатуры\n        ПО Продажи.Номенклатура = ЦеныНоменклатуры.Номенклатура\n            И (ЦеныНоменклатуры.Период В\n                (ВЫБРАТЬ МАКСИМУМ(Цены.Период)\n                ИЗ\n                    ВТЦены КАК Цены\n                ГДЕ\n                    Цены.Период <= Продажи.Период\n                    И Цены.Номенклатура = Продажи.Номенклатура))"
  },
  {
    "title": "Пересекаются ли два интервала",
    "description": "Пересекаются ли два интервала",
    "code_snippet": "Пересекаются = Ложь;\r\nЕсли Макс(Начало1, Начало2) < Мин(Конец1, Конец2) Тогда\r\n    Пересекаются = Истина;\r\nКонецЕсли;\n\nПересекаются = Ложь;\r\nЕсли Макс(Начало1, Начало2) < Мин(Конец1, Конец2) Тогда\r\n    Пересекаются = Истина;\r\nКонецЕсли;\n\n{3} Переменной Пересекаются присвоено значение, но оно нигде не используется\n\nПересекаются = Макс(Начало1, Начало2) < Мин(Конец1, Конец2)"
  },
  {
    "title": "Программно свернуть все уровни группировок табличного документа",
    "description": "Программно свернуть все уровни группировок табличного документа",
    "code_snippet": "КоличествоУровней = ЭлементыФормы.ПолеТабличногоДокумента1.КоличествоУровнейГруппировокСтрок() - 1;\r\nДля Уровень = 1 По КоличествоУровней  Цикл\r\n    ЭлементыФормы.ПолеТабличногоДокумента1.ПоказатьУровеньГруппировокСтрок(КоличествоУровней - Уровень);\r\nКонецЦикла;\r\n\r\nКоличествоУровней = ЭлементыФормы.ПолеТабличногоДокумента1.КоличествоУровнейГруппировокКолонок() - 1;\r\nДля Уровень = 1 По КоличествоУровней Цикл\r\n    ЭлементыФормы.ПолеТабличногоДокумента1.ПоказатьУровеньГруппировокКолонок(КоличествоУровней - Уровень);\r\nКонецЦикла;\n\nКоличествоУровней = ЭлементыФормы.ПолеТабличногоДокумента1.КоличествоУровнейГруппировокСтрок() - 1;\r\nДля Уровень = 1 По КоличествоУровней  Цикл\r\n    ЭлементыФормы.ПолеТабличногоДокумента1.ПоказатьУровеньГруппировокСтрок(КоличествоУровней - Уровень);\r\nКонецЦикла;\r\n\r\nКоличествоУровней = ЭлементыФормы.ПолеТабличногоДокумента1.КоличествоУровнейГруппировокКолонок() - 1;\r\nДля Уровень = 1 По КоличествоУровней Цикл\r\n    ЭлементыФормы.ПолеТабличногоДокумента1.ПоказатьУровеньГруппировокКолонок(КоличествоУровней - Уровень);\r\nКонецЦикла;"
  },
  {
    "title": "Выделение текущей строки в отчете",
    "description": "Выделение текущей строки в отчете",
    "code_snippet": "&НаКлиенте\nПерем ДанныеВыделенныхСтрок;\n\n&НаКлиенте\nПроцедура ОтчетТабличныйДокументПриАктивизации(Элемент)\n    // Делаем через обработчик ожидания, чтобы дать возможность выделить несколько строк,\n    // т.к. событие срабатывает сразу при выделении первой ячейки.\n    ПодключитьОбработчикОжидания(\"ВыделитьТеущиеСтроки\", 0.1, Истина);\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ВыделитьТеущиеСтроки()\n    // 1. Найдём строки, где выделены ячейки\n    ТекВерх = ОтчетТабличныйДокумент.ТекущаяОбласть.Верх;\n    ТекНиз = ОтчетТабличныйДокумент.ТекущаяОбласть.Низ;\n    ОбластьТекСтроки = ОтчетТабличныйДокумент.Область(ТекНиз,,ТекВерх);\n    \n    // 2. Скинем предыдущее обведение в состояние до нашего вмешательства\n    Если ДанныеВыделенныхСтрок <> Неопределено Тогда\n        //2.1. Если выделенные строки не менялись - ничего не делаем\n        Если ТекВерх = ДанныеВыделенныхСтрок.Верх И ТекНиз = ДанныеВыделенныхСтрок.Низ Тогда\n            Возврат;\n        КонецЕсли;\n        \n        // 2.2. Вернём назад верхнюю границу\n        // Обнаружена багофича, что если строке целиком вернуть толщину, которая была у неё изначально, то результат будет отличаться от начального.\n        // Изначально для колонок идущих правее последней колонки (т.е. с номером больше, чем ШиринаТаблицы) Границы не отображаются.\n        // Но после установки новой границы, начнёт отображаться. Поэтому сначала полностью стираем границу, которую мы установили выделением,\n        // потом для колонок отчёта (с первой по ШиринаТаблицы) возвращаем сохранённую границу.\n        // Альтернативный вариант - можно выделять не всю строку, а только колонки с первой по ШиринаТаблицы - но он кажется менее функциональным и интуитивно понятным.\n        \n        НевидимаяЛиния = Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.НетЛинии);\n        СтрокаВерх = ОтчетТабличныйДокумент.Область(ДанныеВыделенныхСтрок.Верх,, ДанныеВыделенныхСтрок.Верх);\n        СтрокаВерх.ГраницаСверху = НевидимаяЛиния;\n        \n        ОбластьВерх = ОтчетТабличныйДокумент.Область(ДанныеВыделенныхСтрок.Верх, 1, ДанныеВыделенныхСтрок.Верх, ОтчетТабличныйДокумент.ШиринаТаблицы);\n        Если ДанныеВыделенныхСтрок.ГраницаСверху <> Неопределено Тогда\n            ОбластьВерх.ГраницаСверху = ДанныеВыделенныхСтрок.ГраницаСверху;\n        Иначе\n            Для Каждого НастройкиЯчейки Из ДанныеВыделенныхСтрок.УникальныеНастройкиГраницыВерх Цикл\n                ТекЯчейкаВерх = ОтчетТабличныйДокумент.Область(ДанныеВыделенныхСтрок.Верх, НастройкиЯчейки.НомерКолонки,\n                        ДанныеВыделенныхСтрок.Верх, НастройкиЯчейки.НомерКолонки);\n                ТекЯчейкаВерх.ГраницаСверху = НастройкиЯчейки.ГраницаСверху;\n            КонецЦикла;\n        КонецЕсли;\n        \n        // 2.3. Вернём назад нижнюю границу\n        СтрокаНиз = ОтчетТабличныйДокумент.Область(ДанныеВыделенныхСтрок.Низ,, ДанныеВыделенныхСтрок.Низ);\n        СтрокаНиз.ГраницаСнизу = НевидимаяЛиния;\n        \n        ОбластьНиз = ОтчетТабличныйДокумент.Область(ДанныеВыделенныхСтрок.Низ, 1, ДанныеВыделенныхСтрок.Низ, ОтчетТабличныйДокумент.ШиринаТаблицы);\n        Если ДанныеВыделенныхСтрок.ГраницаСнизу <> Неопределено Тогда\n            ОбластьНиз.ГраницаСнизу = ДанныеВыделенныхСтрок.ГраницаСнизу;\n        Иначе\n            Для Каждого НастройкиЯчейки Из ДанныеВыделенныхСтрок.УникальныеНастройкиГраницыНиз Цикл\n                ТекЯчейкаНиз = ОтчетТабличныйДокумент.Область(ДанныеВыделенныхСтрок.Низ, НастройкиЯчейки.НомерКолонки,\n                        ДанныеВыделенныхСтрок.Низ, НастройкиЯчейки.НомерКолонки);\n                ТекЯчейкаНиз.ГраницаСнизу = НастройкиЯчейки.ГраницаСнизу;\n            КонецЦикла;\n        КонецЕсли;\n    КонецЕсли;\n        \n    // 3. При выделении всего документа, дальнейшие действия не требуются.\n    // Более того, если не сделать эту проверку, то дальше упадём с ошибкой, при попытке получения ячейки с координатами (0,х,0,х)\n    ВыделенВесьТабДок = ТекВерх = 0 Или ТекНиз = 0;\n    Если ВыделенВесьТабДок Тогда\n        // обработка выделенных строк на прошлом шаге для случая, когда ВыделенВесьТабДок = Истина, инициирует событие ПриАктивизации.\n        // Чтобы не заходить в бесконечный цикл, очистим данные выделенных строк.\n        ДанныеВыделенныхСтрок = Неопределено;\n        Возврат;\n    КонецЕсли;\n    \n    // 4. Запомним текущие значения обведённости строк\n    ДанныеВыделенныхСтрок = Новый Структура;\n    ДанныеВыделенныхСтрок.Вставить(\"Верх\", ТекВерх);\n    ДанныеВыделенныхСтрок.Вставить(\"Низ\", ТекНиз);\n    ДанныеВыделенныхСтрок.Вставить(\"ГраницаСверху\", ОбластьТекСтроки.ГраницаСверху);\n    ДанныеВыделенныхСтрок.Вставить(\"ГраницаСнизу\", ОбластьТекСтроки.ГраницаСнизу);\n    \n    // В общем случае у разных ячеек строки могут быть разные настройки Границ (настройки обведения)\n    // и чтобы вернуть их назад, их надо запомнить.\n    // Свойство ГраницаСверху (и все остальные границы) для области будет иметь значение неопределено,\n    // если для разных ячеек области у этой границы будут отличаться толщина или тип границы\n    // Отмечу, что ЦветРамки при этом, может отличаться, и на Границы это никак не повлияет,\n    // т.к. ЦветРамки является самостоятельным свойством области, как и сама Граница.\n    \n    УникальныеНастройкиГраницыВерх = Новый Массив;\n    ДанныеВыделенныхСтрок.Вставить(\"УникальныеНастройкиГраницыВерх\", УникальныеНастройкиГраницыВерх);\n    Если ОбластьТекСтроки.ГраницаСверху = Неопределено Тогда\n        Для НомерКолонки = 1 По ОтчетТабличныйДокумент.ШиринаТаблицы Цикл\n            НастройкиЯчейки = Новый Структура(\"НомерКолонки, ГраницаСверху\");\n            НастройкиЯчейки.НомерКолонки = НомерКолонки;\n            \n            ЯчейкаВерх = ОтчетТабличныйДокумент.Область(ТекВерх, НомерКолонки, ТекВерх, НомерКолонки);\n            НастройкиЯчейки.ГраницаСверху = ЯчейкаВерх.ГраницаСверху;\n            \n            УникальныеНастройкиГраницыВерх.Добавить(НастройкиЯчейки);\n        КонецЦикла;\n    КонецЕсли;\n    \n    УникальныеНастройкиГраницыНиз = Новый Массив;\n    ДанныеВыделенныхСтрок.Вставить(\"УникальныеНастройкиГраницыНиз\", УникальныеНастройкиГраницыНиз);\n    Если ОбластьТекСтроки.ГраницаСнизу = Неопределено Тогда\n        Для НомерКолонки = 1 По ОтчетТабличныйДокумент.ШиринаТаблицы Цикл\n            НастройкиЯчейки = Новый Структура(\"НомерКолонки, ГраницаСнизу\");\n            НастройкиЯчейки.НомерКолонки = НомерКолонки;\n            \n            ЯчейкаНиз = ОтчетТабличныйДокумент.Область(ТекНиз, НомерКолонки, ТекНиз, НомерКолонки);\n            НастройкиЯчейки.ГраницаСнизу = ЯчейкаНиз.ГраницаСнизу;\n            \n            УникальныеНастройкиГраницыНиз.Добавить(НастройкиЯчейки);\n        КонецЦикла;\n    КонецЕсли;\n    \n    // 5. Обведём текущие строки сверху и снизу самой толстой линией.\n    // Ограничения (встречаются крайне редко): если строка уже обведена самой толстой линией, то при установке курсора на ней, ничего не изменится.\n    // Избавиться от этого без побочных эффектов невозможно, потому что,\n    // если в таком случае наоборот убирать обведение, то строка перестанет выделяться на фоне остальных строк.\n    // Логика подсказывает, что выделенных строк в отчёте должно быть меньшинство, иначе теряется смысл их выделения.\n    // Поэтому даже если на практике и встретится такой отчёт (а вероятность этого мала),\n    // то выделение текущей строки в нём всё равно будет приносить, тот результат, которого мы и добивались.\n    НаибольшаяВозможнаяТолщинаЛинии = 3;//ограничение платформы\n    Линия = Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, НаибольшаяВозможнаяТолщинаЛинии);\n    \n    СтрокаВерх = ОтчетТабличныйДокумент.Область(ТекВерх,,ТекВерх);\n    СтрокаВерх.ГраницаСверху = Линия;\n    \n    СтрокаНиз = ОтчетТабличныйДокумент.Область(ТекНиз,,ТекНиз);\n    СтрокаНиз.ГраницаСнизу = Линия;\nКонецПроцедуры"
  },
  {
    "title": "Как сохранять и восстанавливать настройки системы компоновки данных",
    "description": "Как сохранять и восстанавливать настройки системы компоновки данных",
    "code_snippet": "//Сохранение настроек в файл может быть выполнено следующим образом (листинг 6.40):\r\n//Листинг 6.40. Сохранение настроек\r\nПроцедура СохранитьНастройки(Кнопка)\r\n\r\n    Настройки  = ОтчетОбъект.КомпоновщикНастроек.Настройки;\r\n    НовыйСXDTO = Новый СериализаторXDTO(ФабрикаXDTO);\r\n    Путь = СокрЛП(Константы.ПутьДоФайлов.Получить());\r\n\r\n    Запись = Новый ЗаписьXML;\r\n    \r\n    Запись.ОткрытьФайл(Путь + \"\\config.xml\");\r\n    Запись.ЗаписатьОбъявлениеXML();\r\n    \r\n    НовыйСXDTO.ЗаписатьXML(Запись, Настройки, НазначениеТипаXML.Явное, ФормаXML.Элемент);\r\n    \r\n    Запись.Закрыть();\r\n\r\nКонецПроцедуры\r\n\r\n//Восстановление настроек из файла может быть выполнено следующим образом (листинг 6.41):\r\n//Листинг 6.41. Восстановление настроек\r\nПроцедура ВосстановитьНастройки(Кнопка)\r\n\r\n    Чтение = Новый ЧтениеXML;\r\n    НовыйСXDTO = Новый СериализаторXDTO(ФабрикаXDTO);\r\n    Путь = СокрЛП(Константы.ПутьДоФайлов.Получить());\r\n    \r\n    Чтение.ОткрытьФайл(Путь + \"\\config.xml\");\r\n    \r\n    Настройки = НовыйСXDTO.ПрочитатьXML(Чтение);\r\n    \r\n    ОтчетОбъект.КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);\r\n\r\nКонецПроцедуры\r\n\r\n//В константе ПутьДоФайлов хранится путь до файла сохраняемых (восстанавливаемых) настроек.\r\n\r\n//(с) Простые примеры разработки\n\n//Сохранение настроек в файл может быть выполнено следующим образом (листинг 6.40):\r\n//Листинг 6.40. Сохранение настроек\r\nПроцедура СохранитьНастройки(Кнопка)\r\n\r\n    Настройки  = ОтчетОбъект.КомпоновщикНастроек.Настройки;\r\n    НовыйСXDTO = Новый СериализаторXDTO(ФабрикаXDTO);\r\n    Путь = СокрЛП(Константы.ПутьДоФайлов.Получить());\r\n\r\n    Запись = Новый ЗаписьXML;\r\n    \r\n    Запись.ОткрытьФайл(Путь + \"\\config.xml\");\r\n    Запись.ЗаписатьОбъявлениеXML();\r\n    \r\n    НовыйСXDTO.ЗаписатьXML(Запись, Настройки, НазначениеТипаXML.Явное, ФормаXML.Элемент);\r\n    \r\n    Запись.Закрыть();\r\n\r\nКонецПроцедуры\r\n\r\n//Восстановление настроек из файла может быть выполнено следующим образом (листинг 6.41):\r\n//Листинг 6.41. Восстановление настроек\r\nПроцедура ВосстановитьНастройки(Кнопка)\r\n\r\n    Чтение = Новый ЧтениеXML;\r\n    НовыйСXDTO = Новый СериализаторXDTO(ФабрикаXDTO);\r\n    Путь = СокрЛП(Константы.ПутьДоФайлов.Получить());\r\n    \r\n    Чтение.ОткрытьФайл(Путь + \"\\config.xml\");\r\n    \r\n    Настройки = НовыйСXDTO.ПрочитатьXML(Чтение);\r\n    \r\n    ОтчетОбъект.КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);\r\n\r\nКонецПроцедуры\r\n\r\n//В константе ПутьДоФайлов хранится путь до файла сохраняемых (восстанавливаемых) настроек.\r\n\r\n//(с) Простые примеры разработки\n\nОрфографическая ошибка в config (найдено 2): config"
  },
  {
    "title": "Добавить водяной знак (изображение) в табличный документ",
    "description": "Добавить водяной знак (изображение) в табличный документ",
    "code_snippet": "// ТабДок уже должен быть сформирован на момент добавления изображения поверх текста\r\n\r\nРисунок = ТабДок.Рисунки.Добавить(ТипРисункаТабличногоДокумента.Картинка);\r\n\t\r\n// Высота и ширина заданы по желанию, можете задать свои значения.\r\nРисунок.Картинка = БиблиотекаКартинок.Успешно; // Взял любую картинку из конфы для демонстрации. Фон должен быть прозрачный\r\nРисунок.Высота = 25;\r\nРисунок.Ширина = 25;   \r\nРисунок.ЦветФона = Новый Цвет(); // Необходимо, чтобы 1С не заливала фон по умолчанию\r\n\t\r\n// Расположить рисунок по центру изображения\r\n\t\r\nРисунок.Верх = ТабДок.ВысотаТаблицы/2;\r\nРисунок.Лево = ТабДок.ШиринаТаблицы/2 + Рисунок.Ширина/2;\n\n// ТабДок уже должен быть сформирован на момент добавления изображения поверх текста\r\n\r\nРисунок = ТабДок.Рисунки.Добавить(ТипРисункаТабличногоДокумента.Картинка);\r\n\t\r\n// Высота и ширина заданы по желанию, можете задать свои значения.\r\nРисунок.Картинка = БиблиотекаКартинок.Успешно; // Взял любую картинку из конфы для демонстрации. Фон должен быть прозрачный\r\nРисунок.Высота = 25;\r\nРисунок.Ширина = 25;   \r\nРисунок.ЦветФона = Новый Цвет(); // Необходимо, чтобы 1С не заливала фон по умолчанию\r\n\t\r\n// Расположить рисунок по центру изображения\r\n\t\r\nРисунок.Верх = ТабДок.ВысотаТаблицы/2;\r\nРисунок.Лево = ТабДок.ШиринаТаблицы/2 + Рисунок.Ширина/2;\n\nОрфографическая ошибка в конфы: конфы"
  },
  {
    "title": "csv",
    "description": "Чтение csv в оскрипте",
    "code_snippet": ""
  },
  {
    "title": "Отправка почты с вложением БСП",
    "description": "Отправка почты с вложением БСП",
    "code_snippet": "Функция ОтправитьТабличныйДокументЭлектроннойПочтойКакPDF(УчетнаяЗаписьПочтыОтправителя, ПочтаПолучателя, ТекстПисьма, ТемаПисьма, АдресТабличногоДокументаВоВременномХранилище)\r\n\r\nОтправлено = Ложь;\r\n\t\r\n\tЕсли УчетнаяЗаписьПочтыОтправителя = Неопределено Или УчетнаяЗаписьПочтыОтправителя.Пустая() Тогда\r\n\t\t\r\n\t\tВозврат Отправлено;\t\t\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tТабДок = ПолучитьИзВременногоХранилища(АдресФайлаВоВременномХранилище);\r\n\t\r\n\tПотокФайла = Новый ПотокВПамяти();\r\n\tТабДок.Записать(ПотокФайла, ТипФайлаТабличногоДокумента.PDF);\r\n\t\r\n\tДвоичныеДанныеФайла = ПотокФайла.ЗакрытьИПолучитьДвоичныеДанные();\r\n\t\r\n\tВременноеХранилищеФайла = ПоместитьВоВременноеХранилище(ДвоичныеДанныеФайла, Новый УникальныйИдентификатор);\r\n\t\r\n\tВложения = Новый Массив;\r\n\t\r\n\tОписаниеВложения = Новый Структура(\"Представление, АдресВоВременномХранилище\", ТекстПисьма + \".pdf\", ВременноеХранилищеФайла);\r\n\t\r\n\tВложения.Добавить(ОписаниеВложения);\r\n\t\r\n\tПараметрыПисьма = Новый Структура;\r\n\tПараметрыПисьма.Вставить(\"Кому\", ПочтаПолучателя);\r\n\tПараметрыПисьма.Вставить(\"Тема\", ТемаПисьма);\r\n\tПараметрыПисьма.Вставить(\"Тело\", ТекстПисьма);\r\n\tПараметрыПисьма.Вставить(\"ТипТекста\", \"ПростойТекст\");\r\n\tПараметрыПисьма.Вставить(\"Вложения\", Вложения);\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\tИдентификатор = РаботаСПочтовымиСообщениями.ОтправитьПочтовоеСообщение(УчетнаяЗаписьПочтыОтправителя, ПараметрыПисьма);\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Идентификатор) Тогда\r\n\t\t\t\r\n\t\t\tОтправлено = Истина;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tЗаписьЖурналаРегистрации(\"Отправка письма \" + ПочтаПолучателя, УровеньЖурналаРегистрации.Ошибка,,,ОписаниеОшибки());\r\n\t\t\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат Отправлено;\r\n\r\nКонецФункции\n\nФункция ОтправитьТабличныйДокументЭлектроннойПочтойКакPDF(УчетнаяЗаписьПочтыОтправителя, ПочтаПолучателя, ТекстПисьма, ТемаПисьма, АдресТабличногоДокументаВоВременномХранилище)\r\n\r\nОтправлено = Ложь;\r\n\t\r\n\tЕсли УчетнаяЗаписьПочтыОтправителя = Неопределено Или УчетнаяЗаписьПочтыОтправителя.Пустая() Тогда\r\n\t\t\r\n\t\tВозврат Отправлено;\t\t\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tТабДок = ПолучитьИзВременногоХранилища(АдресФайлаВоВременномХранилище);\r\n\t\r\n\tПотокФайла = Новый ПотокВПамяти();\r\n\tТабДок.Записать(ПотокФайла, ТипФайлаТабличногоДокумента.PDF);\r\n\t\r\n\tДвоичныеДанныеФайла = ПотокФайла.ЗакрытьИПолучитьДвоичныеДанные();\r\n\t\r\n\tВременноеХранилищеФайла = ПоместитьВоВременноеХранилище(ДвоичныеДанныеФайла, Новый УникальныйИдентификатор);\r\n\t\r\n\tВложения = Новый Массив;\r\n\t\r\n\tОписаниеВложения = Новый Структура(\"Представление, АдресВоВременномХранилище\", ТекстПисьма + \".pdf\", ВременноеХранилищеФайла);\r\n\t\r\n\tВложения.Добавить(ОписаниеВложения);\r\n\t\r\n\tПараметрыПисьма = Новый Структура;\r\n\tПараметрыПисьма.Вставить(\"Кому\", ПочтаПолучателя);\r\n\tПараметрыПисьма.Вставить(\"Тема\", ТемаПисьма);\r\n\tПараметрыПисьма.Вставить(\"Тело\", ТекстПисьма);\r\n\tПараметрыПисьма.Вставить(\"ТипТекста\", \"ПростойТекст\");\r\n\tПараметрыПисьма.Вставить(\"Вложения\", Вложения);\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\tИдентификатор = РаботаСПочтовымиСообщениями.ОтправитьПочтовоеСообщение(УчетнаяЗаписьПочтыОтправителя, ПараметрыПисьма);\r\n\t\t\r\n\t\tЕсли ЗначениеЗаполнено(Идентификатор) Тогда\r\n\t\t\t\r\n\t\t\tОтправлено = Истина;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tЗаписьЖурналаРегистрации(\"Отправка письма \" + ПочтаПолучателя, УровеньЖурналаРегистрации.Ошибка,,,ОписаниеОшибки());\r\n\t\t\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат Отправлено;\r\n\r\nКонецФункции"
  },
  {
    "title": "Скопировать содержимое документа из Источник в Приемник",
    "description": "Скопировать содержимое документа из Источник в Приемник",
    "code_snippet": "&НаСервере\r\nПроцедура СкопироватьСодержимоеДокумента(Приемник, Источник, Исключения=\"\")\r\n\tПопытка\r\n\t\tМетаданныеДокумента = Источник.Метаданные();\r\n\tИсключение\r\n\t\tМетаданныеДокумента = Приемник.Метаданные();\r\n\tКонецПопытки;\r\n\t//: Приемник = Документы.ЧекККМ.СоздатьДокумент();\r\n\t\r\n\t// Удалим из строки исключений наименования свойств, которые отсутствуют в реквизитах документа\r\n\tИсключения_ = ОбработатьСтрокуРеквизитов(Исключения, МетаданныеДокумента.Реквизиты);\r\n\t\r\n\tЗаполнитьЗначенияСвойств(Приемник, Источник, , Исключения_);\r\n\t\r\n\tДля Каждого ТекТЧ Из МетаданныеДокумента.ТабличныеЧасти Цикл\r\n\t\tТекТЧИмя = ТекТЧ.Имя;\r\n\t\t\r\n\t\t// Удалим из строки исключений наименования свойств, которые отсутствуют в реквизитах табличной части\r\n\t\tИсключения_ = ОбработатьСтрокуРеквизитов(Исключения, МетаданныеДокумента.ТабличныеЧасти[ТекТЧИмя].Реквизиты);\r\n\t\t\r\n\t\tПриемник[ТекТЧИмя].Очистить();\r\n\t\tДля Каждого ТекСтрИсточника Из Источник[ТекТЧИмя] Цикл\r\n\t\t\tНоваяСтрокаПриемника = Приемник[ТекТЧИмя].Добавить();\r\n\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрокаПриемника, ТекСтрИсточника, , Исключения_)\r\n\t\tКонецЦикла\r\n\tКонецЦикла\r\nКонецПроцедуры\r\n\r\nФункция ОбработатьСтрокуРеквизитов(СтрокаРеквизитов, РеквизитыМетаданные)\r\n\t\r\n\tРезультат = Новый Массив;\r\n\tМассивРеквизитов = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(СтрокаРеквизитов, \",\");\r\n\tДля Каждого ТекРеквизит ИЗ МассивРеквизитов Цикл\r\n\t\tЕсли РеквизитыМетаданные.Найти(ТекРеквизит) = Неопределено Тогда Продолжить КонецЕсли;\r\n\t\tРезультат.Добавить(ТекРеквизит)\r\n\tКонецЦикла;\r\n\tРезультат = ?(Результат.Количество()>0, СтрСоединить(Результат, \",\"), \"\");\r\n\t\r\n\tВозврат Результат\r\n\t\r\nКонецФункции\n\n&НаСервере\r\nПроцедура СкопироватьСодержимоеДокумента(Приемник, Источник, Исключения=\"\")\r\n\tПопытка\r\n\t\tМетаданныеДокумента = Источник.Метаданные();\r\n\tИсключение\r\n\t\tМетаданныеДокумента = Приемник.Метаданные();\r\n\tКонецПопытки;\r\n\t//: Приемник = Документы.ЧекККМ.СоздатьДокумент();\r\n\t\r\n\t// Удалим из строки исключений наименования свойств, которые отсутствуют в реквизитах документа\r\n\tИсключения_ = ОбработатьСтрокуРеквизитов(Исключения, МетаданныеДокумента.Реквизиты);\r\n\t\r\n\tЗаполнитьЗначенияСвойств(Приемник, Источник, , Исключения_);\r\n\t\r\n\tДля Каждого ТекТЧ Из МетаданныеДокумента.ТабличныеЧасти Цикл\r\n\t\tТекТЧИмя = ТекТЧ.Имя;\r\n\t\t\r\n\t\t// Удалим из строки исключений наименования свойств, которые отсутствуют в реквизитах табличной части\r\n\t\tИсключения_ = ОбработатьСтрокуРеквизитов(Исключения, МетаданныеДокумента.ТабличныеЧасти[ТекТЧИмя].Реквизиты);\r\n\t\t\r\n\t\tПриемник[ТекТЧИмя].Очистить();\r\n\t\tДля Каждого ТекСтрИсточника Из Источник[ТекТЧИмя] Цикл\r\n\t\t\tНоваяСтрокаПриемника = Приемник[ТекТЧИмя].Добавить();\r\n\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрокаПриемника, ТекСтрИсточника, , Исключения_)\r\n\t\tКонецЦикла\r\n\tКонецЦикла\r\nКонецПроцедуры\r\n\r\nФункция ОбработатьСтрокуРеквизитов(СтрокаРеквизитов, РеквизитыМетаданные)\r\n\t\r\n\tРезультат = Новый Массив;\r\n\tМассивРеквизитов = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(СтрокаРеквизитов, \",\");\r\n\tДля Каждого ТекРеквизит ИЗ МассивРеквизитов Цикл\r\n\t\tЕсли РеквизитыМетаданные.Найти(ТекРеквизит) = Неопределено Тогда Продолжить КонецЕсли;\r\n\t\tРезультат.Добавить(ТекРеквизит)\r\n\tКонецЦикла;\r\n\tРезультат = ?(Результат.Количество()>0, СтрСоединить(Результат, \",\"), \"\");\r\n\t\r\n\tВозврат Результат\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Навигация по областям",
    "description": "Выполняет быстрый поиск и переход между областями кода.",
    "code_snippet": ""
  },
  {
    "title": "Сервер 1С в дата-центре. Курс",
    "description": "Как за день собрать и запустить крутую машину для сервера 1С в дата центре",
    "code_snippet": ""
  },
  {
    "title": "Проверить наличие колонки в таблице значений, когда нет доступа к самой таблице и методу Найти у коллекции Колонки",
    "description": "Проверить наличие колонки в таблице значений, когда нет доступа к самой таблице и методу Найти у коллекции Колонки",
    "code_snippet": "Функция ЕстьЛиКолонкаВСтрокеТЗ(ИмяКолонки, СтрокаТаблицыЗначений)\r\n\tУИД = Новый УникальныйИдентификатор(); \r\n\tВременнаяСтруктура = Новый Структура(ИмяКолонки, УИД); \r\n\tЗаполнитьЗначенияСвойств(ВременнаяСтруктура, СтрокаТаблицыЗначений); \r\n\tВозврат ВременнаяСтруктура[ИмяКолонки] <> УИД;\r\nКонецФункции\n\nФункция ЕстьЛиКолонкаВСтрокеТЗ(ИмяКолонки, СтрокаТаблицыЗначений)\r\n\tУИД = Новый УникальныйИдентификатор(); \r\n\tВременнаяСтруктура = Новый Структура(ИмяКолонки, УИД); \r\n\tЗаполнитьЗначенияСвойств(ВременнаяСтруктура, СтрокаТаблицыЗначений); \r\n\tВозврат ВременнаяСтруктура[ИмяКолонки] <> УИД;\r\nКонецФункции"
  },
  {
    "title": "Защита кода 1С. Основные методы защиты конфигураций и обработок",
    "description": "Защита кода 1С. Основные методы защиты конфигураций и обработокЛайфхаки 1С",
    "code_snippet": ""
  },
  {
    "title": "cli-selector",
    "description": "Интерактивный выбор значений в консоли",
    "code_snippet": ""
  },
  {
    "title": "Прогресс с помощью СКД на обычных формах",
    "description": "Прогресс с помощью СКД на обычных формах",
    "code_snippet": "//УПРАВЛЕНИЕ ИНДИКАТОРОМ//\nФункция ИнициализироватьИндикатор(ПраваяГраница) Экспорт\n  НастройкаИндикатора = Новый Структура;\n  //установка параметров для вывода прецентов\n  ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\n  ПроцессорВывода.ОтображатьПроцентВывода = Истина;\n  ЭлементПроцессора = Новый ЭлементРезультатаКомпоновкиДанных;\n  Шаг = ?(ПраваяГраница = 0, 0, 100 / ПраваяГраница);\n  ТекПроцент = 0;\n  ПроцессорВывода.НачатьВывод();\n  \n  НастройкаИндикатора.Вставить(\"ПроцессорВывода\", ПроцессорВывода);\n  НастройкаИндикатора.Вставить(\"ЭлементПроцессора\", ЭлементПроцессора);\n  НастройкаИндикатора.Вставить(\"Шаг\", Шаг);\n  НастройкаИндикатора.Вставить(\"ТекПроцент\", ТекПроцент);\n  \n  Возврат НастройкаИндикатора; \nКонецФункции\n\nПроцедура СдвинутьИндикатор(НастройкаИндикатора) Экспорт \n  Если ТипЗнч(НастройкаИндикатора) <> Тип(\"Структура\") Тогда\n    Возврат;\n  КонецЕсли;\n  \n  //получаем переменные\n  ТекПроцент = НастройкаИндикатора.ТекПроцент;\n  Шаг = НастройкаИндикатора.Шаг;\n  ЭлементПроцессора = НастройкаИндикатора.ЭлементПроцессора;\n  ПроцессорВывода = НастройкаИндикатора.ПроцессорВывода;\n  \n  \n  //вывод процента\n  ТекПроцент = ТекПроцент + Шаг;\n  ЭлементПроцессора.ПроцентВывода = ТекПроцент;\n  ПроцессорВывода.ВывестиЭлемент(ЭлементПроцессора);\n  \n  НастройкаИндикатора.Вставить(\"ПроцессорВывода\", ПроцессорВывода);\n  НастройкаИндикатора.Вставить(\"ЭлементПроцессора\", ЭлементПроцессора);\n  НастройкаИндикатора.Вставить(\"Шаг\", Шаг);\n  НастройкаИндикатора.Вставить(\"ТекПроцент\", ТекПроцент);\nКонецПроцедуры\n\nПроцедура ДеАктивироватьИндикатор(НастройкаИндикатора) Экспорт \n  ПроцессорВывода = НастройкаИндикатора.ПроцессорВывода;\n  \n  ПроцессорВывода.ЗакончитьВывод();\n  ПроцессорВывода = Неопределено;\n\n  НастройкаИндикатора = Неопределено;\nКонецПроцедуры"
  },
  {
    "title": "Получаем состав плана обмена с признаком регистрации",
    "description": "Получаем состав плана обмена с признаком регистрации",
    "code_snippet": "Функция ПолучитьСписокПланаОбмена(стрИмяПланаОбмена)\n\t\nВыбранныйПланОбмена = Метаданные.ПланыОбмена[стрИмяПланаОбмена];\n  \n тзПланОбменаСостав = Новый ТаблицаЗначений;\n тзПланОбменаСостав.Колонки.Добавить(\"ОбъектКонфигурации\", , \"Объект конфигурации\");\n тзПланОбменаСостав.Колонки.Добавить(\"Регистрация\", , \"Регистрация\");\n \n Состав = ВыбранныйПланОбмена.Состав;\n \n  Для каждого Элемент Из Состав Цикл\n\t \n\t Стр = тзПланОбменаСостав.Добавить();\n\t Стр.Регистрация = Элемент.АвтоРегистрация;\n\t Стр.ОбъектКонфигурации = Элемент.Метаданные.ПолноеИмя();\n\t \n КонецЦикла;\n \n тзПланОбменаСостав.Сортировать(\"ОбъектКонфигурации\");\n Возврат тзПланОбменаСостав;\nКонецФункции"
  },
  {
    "title": "Добавление данных по регистру в документ \"Перенос данных\" в ЗУП",
    "description": "Добавление данных по регистру в документ \"Перенос данных\" в ЗУП",
    "code_snippet": "&НаСервере\r\nПроцедура ДелоНаСервере()\r\n\t\r\n\tДок = Документы.ПереносДанных.СоздатьДокумент();\t\r\n\tДок.Дата = ТекущаяДата();\r\n\tДок.ПериодРегистрации = Период.ДатаНачала;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tНачислениеЗарплатыНачисления.Сотрудник КАК Сотрудник,\r\n\t\t|\tНачислениеЗарплатыНачисления.ОтработаноДней КАК ОтработаноДней,\r\n\t\t|\tНачислениеЗарплатыНачисления.ОтработаноЧасов КАК ОтработаноЧасов,\r\n\t\t|\tНачислениеЗарплатыНачисления.Ссылка КАК Ссылка,\r\n\t\t|\tНачислениеЗарплатыНачисления.ДатаНачала КАК ДатаНачала,\r\n\t\t|\tНачислениеЗарплатыНачисления.Подразделение.ГоловнаяОрганизация КАК ПодразделениеГоловнаяОрганизация,\r\n\t\t|\tНачислениеЗарплатыНачисления.Сотрудник.ФизическоеЛицо КАК СотрудникФизическоеЛицо,\r\n\t\t|\tНачислениеЗарплатыНачисления.Подразделение КАК Подразделение,\r\n\t\t|\tНачислениеЗарплатыНачисления.Сотрудник.ГоловнойСотрудник КАК СотрудникГоловнойСотрудник\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ВидыЗанятостиСотрудников.СрезПоследних(, ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятости.Подработка)) КАК ВидыЗанятостиСотрудниковСрезПоследних\r\n\t\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплаты.Начисления КАК НачислениеЗарплатыНачисления\r\n\t\t|\t\tПО ВидыЗанятостиСотрудниковСрезПоследних.Сотрудник = НачислениеЗарплатыНачисления.Сотрудник\r\n\t\t|ГДЕ\r\n\t\t|\tНачислениеЗарплатыНачисления.ОтработаноДней > 0\r\n\t\t|\tИ НачислениеЗарплатыНачисления.Начисление.Код <> \"\"РК\"\"\r\n\t\t|\tИ ВидыЗанятостиСотрудниковСрезПоследних.ДействуетДо >= НачислениеЗарплатыНачисления.ДатаНачала\r\n\t\t|\tИ НачислениеЗарплатыНачисления.Ссылка.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ДатаНачала\", Период.ДатаНачала);\r\n\tЗапрос.УстановитьПараметр(\"ДатаОкончания\", Период.ДатаОкончания);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tДокументОбъект = Док;\r\n\t\r\n\tНз = ДокументОбъект.Движения.ДанныеОВремениДляРасчетаСреднегоОбщий;\r\n\tРег = ДокументОбъект.ТаблицаРегистров.Добавить();\r\n\tРег.Имя = \"ДанныеОВремениДляРасчетаСреднегоОбщий\";\r\n\tДокументОбъект.Ответственный = ПользователиКлиентСервер.ТекущийПользователь();\r\n\t\t\t\r\n\tВыборка = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока Выборка.Следующий() Цикл\r\n\t\tСтрокаНз = Нз.Добавить();\r\n\t\tСтрокаНз.Период = Выборка.ДатаНачала;\r\n\t\tСтрокаНз.Активность = Истина;\r\n\t\tСтрокаНз.Сотрудник = Выборка.СотрудникГоловнойСотрудник;\r\n\t\tСтрокаНз.ПорядокРасчета = Перечисления.ПорядокРасчетаСреднегоЗаработкаОбщий.Постановление2010;\r\n\t\tСтрокаНз.ОтработаноДней = Выборка.ОтработаноДней;\r\n\t\tСтрокаНз.ОтработаноЧасов = Выборка.ОтработаноЧасов;\t\r\n\tКонецЦикла;\r\n\t\t\r\n\tДокументОбъект.Записать(РежимЗаписиДокумента.Запись);\r\n\tСообщение = Новый СообщениеПользователю();\r\n\tСообщение.Текст = \"Создан документ \" + ДокументОбъект;\r\n\tСообщение.КлючДанных = ДокументОбъект.Ссылка;\r\n\tСообщение.ПутьКДанным = \"Объект\";\r\n\tСообщение.Сообщить();\t\r\n\t\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ДелоНаСервере()\r\n\t\r\n\tДок = Документы.ПереносДанных.СоздатьДокумент();\t\r\n\tДок.Дата = ТекущаяДата();\r\n\tДок.ПериодРегистрации = Период.ДатаНачала;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tНачислениеЗарплатыНачисления.Сотрудник КАК Сотрудник,\r\n\t\t|\tНачислениеЗарплатыНачисления.ОтработаноДней КАК ОтработаноДней,\r\n\t\t|\tНачислениеЗарплатыНачисления.ОтработаноЧасов КАК ОтработаноЧасов,\r\n\t\t|\tНачислениеЗарплатыНачисления.Ссылка КАК Ссылка,\r\n\t\t|\tНачислениеЗарплатыНачисления.ДатаНачала КАК ДатаНачала,\r\n\t\t|\tНачислениеЗарплатыНачисления.Подразделение.ГоловнаяОрганизация КАК ПодразделениеГоловнаяОрганизация,\r\n\t\t|\tНачислениеЗарплатыНачисления.Сотрудник.ФизическоеЛицо КАК СотрудникФизическоеЛицо,\r\n\t\t|\tНачислениеЗарплатыНачисления.Подразделение КАК Подразделение,\r\n\t\t|\tНачислениеЗарплатыНачисления.Сотрудник.ГоловнойСотрудник КАК СотрудникГоловнойСотрудник\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ВидыЗанятостиСотрудников.СрезПоследних(, ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятости.Подработка)) КАК ВидыЗанятостиСотрудниковСрезПоследних\r\n\t\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплаты.Начисления КАК НачислениеЗарплатыНачисления\r\n\t\t|\t\tПО ВидыЗанятостиСотрудниковСрезПоследних.Сотрудник = НачислениеЗарплатыНачисления.Сотрудник\r\n\t\t|ГДЕ\r\n\t\t|\tНачислениеЗарплатыНачисления.ОтработаноДней > 0\r\n\t\t|\tИ НачислениеЗарплатыНачисления.Начисление.Код <> \"\"РК\"\"\r\n\t\t|\tИ ВидыЗанятостиСотрудниковСрезПоследних.ДействуетДо >= НачислениеЗарплатыНачисления.ДатаНачала\r\n\t\t|\tИ НачислениеЗарплатыНачисления.Ссылка.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ДатаНачала\", Период.ДатаНачала);\r\n\tЗапрос.УстановитьПараметр(\"ДатаОкончания\", Период.ДатаОкончания);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tДокументОбъект = Док;\r\n\t\r\n\tНз = ДокументОбъект.Движения.ДанныеОВремениДляРасчетаСреднегоОбщий;\r\n\tРег = ДокументОбъект.ТаблицаРегистров.Добавить();\r\n\tРег.Имя = \"ДанныеОВремениДляРасчетаСреднегоОбщий\";\r\n\tДокументОбъект.Ответственный = ПользователиКлиентСервер.ТекущийПользователь();\r\n\t\t\t\r\n\tВыборка = РезультатЗапроса.Выбрать();\r\n\t\r\n\tПока Выборка.Следующий() Цикл\r\n\t\tСтрокаНз = Нз.Добавить();\r\n\t\tСтрокаНз.Период = Выборка.ДатаНачала;\r\n\t\tСтрокаНз.Активность = Истина;\r\n\t\tСтрокаНз.Сотрудник = Выборка.СотрудникГоловнойСотрудник;\r\n\t\tСтрокаНз.ПорядокРасчета = Перечисления.ПорядокРасчетаСреднегоЗаработкаОбщий.Постановление2010;\r\n\t\tСтрокаНз.ОтработаноДней = Выборка.ОтработаноДней;\r\n\t\tСтрокаНз.ОтработаноЧасов = Выборка.ОтработаноЧасов;\t\r\n\tКонецЦикла;\r\n\t\t\r\n\tДокументОбъект.Записать(РежимЗаписиДокумента.Запись);\r\n\tСообщение = Новый СообщениеПользователю();\r\n\tСообщение.Текст = \"Создан документ \" + ДокументОбъект;\r\n\tСообщение.КлючДанных = ДокументОбъект.Ссылка;\r\n\tСообщение.ПутьКДанным = \"Объект\";\r\n\tСообщение.Сообщить();\t\r\n\t\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Получить список принтеров",
    "description": "Получить список принтеров",
    "code_snippet": "&НаКлиенте\r\nФункция ПолучитьМассивПринтеров()\r\n    \r\n    МассивПринтеров = Новый Массив;\r\n\r\n    Попытка\r\n        objWMIService = ПолучитьCOMОбъект(\"winmgmts:\\\\.\\root\\CIMV2\"); \r\n    Исключение\r\n        ТекстСообщения = НСтр(\"ru = 'Список принтеров не доступен!'\");\r\n        ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстСообщения);\r\n        Возврат МассивПринтеров;\r\n    КонецПопытки;\r\n    \r\n    Выборка = objWMIService.ExecQuery(\"SELECT * FROM Win32_Printer\",,48);   \r\n    \r\n    Для Каждого objItem Из Выборка Цикл  \r\n        МассивПринтеров.Добавить(objItem.Caption);\r\n    КонецЦикла;\r\n    \r\n    Возврат МассивПринтеров;\r\nКонецФункции\n\n&НаКлиенте\r\nФункция ПолучитьМассивПринтеров()\r\n    \r\n    МассивПринтеров = Новый Массив;\r\n\r\n    Попытка\r\n        objWMIService = ПолучитьCOMОбъект(\"winmgmts:\\\\.\\root\\CIMV2\"); \r\n    Исключение\r\n        ТекстСообщения = НСтр(\"ru = 'Список принтеров не доступен!'\");\r\n        ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстСообщения);\r\n        Возврат МассивПринтеров;\r\n    КонецПопытки;\r\n    \r\n    Выборка = objWMIService.ExecQuery(\"SELECT * FROM Win32_Printer\",,48);   \r\n    \r\n    Для Каждого objItem Из Выборка Цикл  \r\n        МассивПринтеров.Добавить(objItem.Caption);\r\n    КонецЦикла;\r\n    \r\n    Возврат МассивПринтеров;\r\nКонецФункции\n\nОрфографическая ошибка в winmgmts: winmgmts\n\nСписокПринтеров = Новый СписокЗначений;\n\nПринтеры = Новый COMОбъект(\"WScript.Network\");\n\nPrn = Принтеры.EnumPrinterConnections();\n\nнн = 0;\n\nКоличествоПринтеров = Prn.Count() - 1;\n\nПока нн < КоличествоПринтеров Цикл\n    СписокПринтеров.Добавить(Prn.Item(нн + 1));\n    нн = нн + 2;\nКонецЦикла;"
  },
  {
    "title": "Индикатор отчета для Обычных форм",
    "description": "Индикатор отчета для Обычных форм",
    "code_snippet": "Процедура СформироватьОтчет(Кнопка)\r\n    Элем = ЭлементыФормы.Добавить(Тип(\"Индикатор\"), \"Инд1\", Истина);\r\n    Элем.Верх = ЭтаФорма.Высота - 20;\r\n    Элем.Высота = 25;\r\n    Элем.Ширина = 150;\r\n    Элем.ОтображатьПроценты = Истина;\r\n    Элем.МинимальноеЗначение = 1;\r\n    Элем.МаксимальноеЗначение = 100;\r\n    Состояние( \"Выводим данные отчета\");\r\n    \r\n    Для сч = 1 по 100 Цикл\r\n        Для ф=1 по 1000 Цикл\r\n           //спим\r\n \r\n        КонецЦикла;\r\n       //ваш алгоритм обновления индикатора\r\n \r\n        Элем.Значение = сч;        \r\n        ЭтаФорма.Обновить();\r\n    КонецЦикла;\r\n    \r\n    ЭлементыФормы.Удалить(Элем);\r\nКонецПроцедуры\n\nПроцедура СформироватьОтчет(Кнопка)\r\n    Элем = ЭлементыФормы.Добавить(Тип(\"Индикатор\"), \"Инд1\", Истина);\r\n    Элем.Верх = ЭтаФорма.Высота - 20;\r\n    Элем.Высота = 25;\r\n    Элем.Ширина = 150;\r\n    Элем.ОтображатьПроценты = Истина;\r\n    Элем.МинимальноеЗначение = 1;\r\n    Элем.МаксимальноеЗначение = 100;\r\n    Состояние( \"Выводим данные отчета\");\r\n    \r\n    Для сч = 1 по 100 Цикл\r\n        Для ф=1 по 1000 Цикл\r\n           //спим\r\n \r\n        КонецЦикла;\r\n       //ваш алгоритм обновления индикатора\r\n \r\n        Элем.Значение = сч;        \r\n        ЭтаФорма.Обновить();\r\n    КонецЦикла;\r\n    \r\n    ЭлементыФормы.Удалить(Элем);\r\nКонецПроцедуры\n\nДля ф=1 по 1000 Цикл\n\t //спим\n\nКонецЦикла;"
  },
  {
    "title": "Как узнать, чем занято место на диске (Windows)",
    "description": "Как узнать, чем занято место на диске (Windows)",
    "code_snippet": ""
  },
  {
    "title": "Общие элементы массивов",
    "description": "Общие элементы массивов",
    "code_snippet": "Функция ОбщиеЭлементыМассивов(Массив1, Массив2)\r\n\r\n\tРезультат = Новый Массив;\r\n\t\r\n\tДля каждого ЭлементМассива Из Массив1 Цикл\r\n\t\tЕсли Массив2.Найти(ЭлементМассива) <> Неопределено И\r\n\t\t\t\tРезультат.Найти(ЭлементМассива) = Неопределено Тогда\r\n\t\t\tРезультат.Добавить(ЭлементМассива);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\r\nКонецФункции // ОбщиеЭлементыМассивов()\n\nФункция ОбщиеЭлементыМассивов(Массив1, Массив2)\r\n\r\n\tРезультат = Новый Массив;\r\n\t\r\n\tДля каждого ЭлементМассива Из Массив1 Цикл\r\n\t\tЕсли Массив2.Найти(ЭлементМассива) <> Неопределено И\r\n\t\t\t\tРезультат.Найти(ЭлементМассива) = Неопределено Тогда\r\n\t\t\tРезультат.Добавить(ЭлементМассива);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\r\nКонецФункции // ОбщиеЭлементыМассивов()\n\nФункция ОбщиеЭлементыМассивов(Массив1, Массив2)\n\n\tРезультат = Новый Массив;\n\t\n\tДля каждого ЭлементМассива Из Массив1 Цикл\n\t\tЕсли Массив2.Найти(ЭлементМассива) <> Неопределено И\n\t\t\t\tРезультат.Найти(ЭлементМассива) = Неопределено Тогда\n\t\t\tРезультат.Добавить(ЭлементМассива);\n\t\tКонецЕсли;\n\tКонецЦикла;\n\t\n\tВозврат Результат;\n\nКонецФункции // ОбщиеЭлементыМассивов()"
  },
  {
    "title": "Ключ менеджера записи регистра сведений",
    "description": "Ключ менеджера записи регистра сведений",
    "code_snippet": "// Возвращает ключ менеджера записи регистра сведений на основе данных измерений\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/33\r\n// \r\n// Параметры:\r\n//  ДанныеЗаписи\t- РегистрСведенийМенеджерЗаписи, Структура, Произвольный - коллекция с данными записи\r\n//  ИмяРегистра\t\t- Строка - Имя регистра. Если не передано, то метаданные регистра берутся из ДанныеЗаписи\r\n// \r\n// Возвращаемое значение:\r\n//  РегистрСведенийКлючЗаписи\r\n//\r\n// Пример:\r\n//\r\n//\tДанныеЗаписи = Новый Структура;\r\n//\tДанныеЗаписи.Вставить(\"Измерение\", \"Тест\");\r\n//\r\n//\tРезультат = КлючМенеджераЗаписиРегистраСведений(\r\n//\t\tДанныеЗаписи, Метаданные.РегистрыСведений.ЖЧТ_РегистрСведений.Имя);\r\n//\r\nФункция КлючМенеджераЗаписиРегистраСведений(Знач ДанныеЗаписи, Знач ИмяРегистра = \"\") Экспорт\r\n\t\r\n\tЕсли ПустаяСтрока(ИмяРегистра) Тогда\r\n\t\tМетаданныеРегистра = Метаданные.НайтиПоТипу(ТипЗнч(ДанныеЗаписи));\r\n\tИначе\r\n\t\tМетаданныеРегистра = Метаданные.РегистрыСведений[ИмяРегистра];\r\n\tКонецЕсли;\r\n\t\r\n\tЗначенияКлюча = Новый Структура(\"Период\", '00010101');\r\n\t\r\n\tДля Каждого ОписаниеИзмерения Из МетаданныеРегистра.Измерения Цикл\r\n\t\tЗначенияКлюча.Вставить(ОписаниеИзмерения.Имя);\r\n\tКонецЦикла;\r\n\t\r\n\tЗаполнитьЗначенияСвойств(ЗначенияКлюча, ДанныеЗаписи);\r\n\t\r\n\tВозврат РегистрыСведений[МетаданныеРегистра.Имя].СоздатьКлючЗаписи(ЗначенияКлюча);\r\n\t\r\nКонецФункции\n\n// Возвращает ключ менеджера записи регистра сведений на основе данных измерений\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/33\r\n// \r\n// Параметры:\r\n//  ДанныеЗаписи\t- РегистрСведенийМенеджерЗаписи, Структура, Произвольный - коллекция с данными записи\r\n//  ИмяРегистра\t\t- Строка - Имя регистра. Если не передано, то метаданные регистра берутся из ДанныеЗаписи\r\n// \r\n// Возвращаемое значение:\r\n//  РегистрСведенийКлючЗаписи\r\n//\r\n// Пример:\r\n//\r\n//\tДанныеЗаписи = Новый Структура;\r\n//\tДанныеЗаписи.Вставить(\"Измерение\", \"Тест\");\r\n//\r\n//\tРезультат = КлючМенеджераЗаписиРегистраСведений(\r\n//\t\tДанныеЗаписи, Метаданные.РегистрыСведений.ЖЧТ_РегистрСведений.Имя);\r\n//\r\nФункция КлючМенеджераЗаписиРегистраСведений(Знач ДанныеЗаписи, Знач ИмяРегистра = \"\") Экспорт\r\n\t\r\n\tЕсли ПустаяСтрока(ИмяРегистра) Тогда\r\n\t\tМетаданныеРегистра = Метаданные.НайтиПоТипу(ТипЗнч(ДанныеЗаписи));\r\n\tИначе\r\n\t\tМетаданныеРегистра = Метаданные.РегистрыСведений[ИмяРегистра];\r\n\tКонецЕсли;\r\n\t\r\n\tЗначенияКлюча = Новый Структура(\"Период\", '00010101');\r\n\t\r\n\tДля Каждого ОписаниеИзмерения Из МетаданныеРегистра.Измерения Цикл\r\n\t\tЗначенияКлюча.Вставить(ОписаниеИзмерения.Имя);\r\n\tКонецЦикла;\r\n\t\r\n\tЗаполнитьЗначенияСвойств(ЗначенияКлюча, ДанныеЗаписи);\r\n\t\r\n\tВозврат РегистрыСведений[МетаданныеРегистра.Имя].СоздатьКлючЗаписи(ЗначенияКлюча);\r\n\t\r\nКонецФункции"
  },
  {
    "title": "1С Django. Личный кабинет контрагента. Курс",
    "description": "Разработай мини-сайт на современном фреймворке Django для оформления заказов контрагентами в 1С",
    "code_snippet": ""
  },
  {
    "title": "coveragebsl",
    "description": "Внешняя компонента замера покрытия для 1С:Предприятия и OneScript",
    "code_snippet": ""
  },
  {
    "title": "Добавить таблицу в менеджер временных таблиц",
    "description": "Добавить таблицу в менеджер временных таблиц",
    "code_snippet": "// Добавляет таблицу в менеджер временных таблиц\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/31\r\n// \r\n// Параметры:\r\n//  МенеджерВременныхТаблиц\t - МенеджерВременныхТаблиц - Менеджер, в который нужно добавить таблицу\r\n//  ИмяТаблицы\t\t\t\t - Строка - Имя временной таблицы\r\n//  ДанныеТаблицы\t\t\t - ТаблицаЗначений - Данные таблицы\r\n//\r\n// Пример:\r\n//\tДобавитьТаблицуВМенеджерВременныхТаблиц(Запрос.МенеджерВременныхТаблиц, \"ВТ_ТЗ\", ТаблицаЗначений);\r\n//\r\nПроцедура ДобавитьТаблицуВМенеджерВременныхТаблиц(Знач МенеджерВременныхТаблиц, Знач ИмяТаблицы, Знач ДанныеТаблицы) Экспорт\r\n\t\r\n\tТекстЗапроса = \"ВЫБРАТЬ * ПОМЕСТИТЬ %1 ИЗ &ТЗ КАК ТЗ\";\r\n\tТекстЗапроса = СтрШаблон(ТекстЗапроса, ИмяТаблицы);\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tЗапрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tЗапрос.УстановитьПараметр(\"ТЗ\", ДанныеТаблицы);\r\n\tЗапрос.Выполнить();\r\n\t\r\nКонецПроцедуры\n\n// Добавляет таблицу в менеджер временных таблиц\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/31\r\n// \r\n// Параметры:\r\n//  МенеджерВременныхТаблиц\t - МенеджерВременныхТаблиц - Менеджер, в который нужно добавить таблицу\r\n//  ИмяТаблицы\t\t\t\t - Строка - Имя временной таблицы\r\n//  ДанныеТаблицы\t\t\t - ТаблицаЗначений - Данные таблицы\r\n//\r\n// Пример:\r\n//\tДобавитьТаблицуВМенеджерВременныхТаблиц(Запрос.МенеджерВременныхТаблиц, \"ВТ_ТЗ\", ТаблицаЗначений);\r\n//\r\nПроцедура ДобавитьТаблицуВМенеджерВременныхТаблиц(Знач МенеджерВременныхТаблиц, Знач ИмяТаблицы, Знач ДанныеТаблицы) Экспорт\r\n\t\r\n\tТекстЗапроса = \"ВЫБРАТЬ * ПОМЕСТИТЬ %1 ИЗ &ТЗ КАК ТЗ\";\r\n\tТекстЗапроса = СтрШаблон(ТекстЗапроса, ИмяТаблицы);\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tЗапрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tЗапрос.УстановитьПараметр(\"ТЗ\", ДанныеТаблицы);\r\n\tЗапрос.Выполнить();\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Узнать версию платформы",
    "description": "Узнать версию платформы",
    "code_snippet": "СисИнфо = Новый СистемнаяИнформация;\r\n\r\nЕсли Лев(СисИнфо.ВерсияПриложения, 3) = \"8.2\" Тогда\r\n\tV8Com = Новый COMОбъект(\"V82.Application\");\r\nИначе\r\n\tV8Com = Новый COMОбъект(\"V83.Application\");\r\nКонецЕсли;\n\nСисИнфо = Новый СистемнаяИнформация;\r\n\r\nЕсли Лев(СисИнфо.ВерсияПриложения, 3) = \"8.2\" Тогда\r\n\tV8Com = Новый COMОбъект(\"V82.Application\");\r\nИначе\r\n\tV8Com = Новый COMОбъект(\"V83.Application\");\r\nКонецЕсли;\n\n{6} Переменной V8Com присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Проверка изменения полей регистра сведений ПередЗаписью, кеширование средствами БСП",
    "description": "Проверка изменения полей регистра сведений ПередЗаписью, кеширование средствами БСП",
    "code_snippet": "Процедура ПередЗаписью(Отказ, Замещение)\r\n\t\r\n\tЕсли ОбменДанными.Загрузка Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли; \r\n\t\r\n\tИмяИсточника = ОбщегоНазначения.КонтрольнаяСуммаСтрокой(Новый Структура(\"Пользователь, Отборы\", ИмяПользователя(), Отбор.Задача.Значение));\r\n\t\r\n\tЕсли ЭтотОбъект.Количество() = 0 Тогда\r\n\t\t\r\n\t\tОбщегоНазначения.СкопироватьВБуферОбмена(ПолучитьНачальныеДанные(Отбор.Задача.Значение), ИмяИсточника);\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tБуферОбмена = ОбщегоНазначения.СтрокиИзБуфераОбмена();\r\n\t\tЕсли БуферОбмена.Источник = ИмяИсточника Тогда // новая запись\r\n\t\t\tНачальныеДанные = БуферОбмена.Данные;\r\n\t\tИначе\r\n\t\t\tНачальныеДанные = Неопределено;\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tТекущаяДата = ТекущаяДата();\r\n\t\t\r\n\t\tДля каждого Запись Из ЭтотОбъект Цикл\r\n\t\t\t\r\n\t\t\tТекНачальныеДанные = ?(НачальныеДанные = Неопределено, Неопределено, НачальныеДанные.Найти(Запись.Задача, \"Задача\"));\r\n\t\t\t\r\n\t\t\tЕсли ТекНачальныеДанные = Неопределено Тогда // запись создана\r\n\t\t\t\tЗапись.ДатаСоздания = ТекущаяДата;\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли; \r\n\t\t\t\r\n\t\t\tЕсли ЗначениеЗаполнено(Запись.Ссылка)\r\n\t\t\t\tИ НЕ Запись.Ссылка = ТекНачальныеДанные.Ссылка Тогда // получена новая ссылка\r\n\t\t\t\tЗапись.ДатаПолученияСсылки = ТекущаяДата;\r\n\t\t\tКонецЕсли; \r\n\t\t\t\r\n\t\tКонецЦикла; \r\n\t\t\r\n\t\t// очистим буфер обмена\r\n\t\tОбщегоНазначения.СкопироватьВБуферОбмена(Неопределено, ИмяИсточника);\r\n\t\t\r\n\tКонецЕсли; \r\n\t\r\nКонецПроцедуры\r\n\r\nФункция ПолучитьНачальныеДанные(Задачи)\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\"ВЫБРАТЬ\r\n\t|\t*\r\n\t|ИЗ\r\n\t|\tРегистрСведений.ЗадачиДляОбмена КАК ЗадачиДляОбмена\r\n\t|ГДЕ\r\n\t|\tЗадачиДляОбмена.Задача В (&Задачи)\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"Задачи\", Отбор.Задача.Значение);\r\n\t\r\n\tВозврат Запрос.Выполнить().Выгрузить();\r\n\t\r\nКонецФункции\n\nПроцедура ПередЗаписью(Отказ, Замещение)\r\n\t\r\n\tЕсли ОбменДанными.Загрузка Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли; \r\n\t\r\n\tИмяИсточника = ОбщегоНазначения.КонтрольнаяСуммаСтрокой(Новый Структура(\"Пользователь, Отборы\", ИмяПользователя(), Отбор.Задача.Значение));\r\n\t\r\n\tЕсли ЭтотОбъект.Количество() = 0 Тогда\r\n\t\t\r\n\t\tОбщегоНазначения.СкопироватьВБуферОбмена(ПолучитьНачальныеДанные(Отбор.Задача.Значение), ИмяИсточника);\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tБуферОбмена = ОбщегоНазначения.СтрокиИзБуфераОбмена();\r\n\t\tЕсли БуферОбмена.Источник = ИмяИсточника Тогда // новая запись\r\n\t\t\tНачальныеДанные = БуферОбмена.Данные;\r\n\t\tИначе\r\n\t\t\tНачальныеДанные = Неопределено;\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tТекущаяДата = ТекущаяДата();\r\n\t\t\r\n\t\tДля каждого Запись Из ЭтотОбъект Цикл\r\n\t\t\t\r\n\t\t\tТекНачальныеДанные = ?(НачальныеДанные = Неопределено, Неопределено, НачальныеДанные.Найти(Запись.Задача, \"Задача\"));\r\n\t\t\t\r\n\t\t\tЕсли ТекНачальныеДанные = Неопределено Тогда // запись создана\r\n\t\t\t\tЗапись.ДатаСоздания = ТекущаяДата;\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли; \r\n\t\t\t\r\n\t\t\tЕсли ЗначениеЗаполнено(Запись.Ссылка)\r\n\t\t\t\tИ НЕ Запись.Ссылка = ТекНачальныеДанные.Ссылка Тогда // получена новая ссылка\r\n\t\t\t\tЗапись.ДатаПолученияСсылки = ТекущаяДата;\r\n\t\t\tКонецЕсли; \r\n\t\t\t\r\n\t\tКонецЦикла; \r\n\t\t\r\n\t\t// очистим буфер обмена\r\n\t\tОбщегоНазначения.СкопироватьВБуферОбмена(Неопределено, ИмяИсточника);\r\n\t\t\r\n\tКонецЕсли; \r\n\t\r\nКонецПроцедуры\r\n\r\nФункция ПолучитьНачальныеДанные(Задачи)\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\"ВЫБРАТЬ\r\n\t|\t*\r\n\t|ИЗ\r\n\t|\tРегистрСведений.ЗадачиДляОбмена КАК ЗадачиДляОбмена\r\n\t|ГДЕ\r\n\t|\tЗадачиДляОбмена.Задача В (&Задачи)\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"Задачи\", Отбор.Задача.Значение);\r\n\t\r\n\tВозврат Запрос.Выполнить().Выгрузить();\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Разложить массив по типам объектов",
    "description": "Разложить массив по типам объектов",
    "code_snippet": "Функция РазложитьМассивПоТипамОбъектов(МассивОбъектов)\r\n\tСтруктураТипов \t= Новый Структура;\r\n\t\r\n\tДля Каждого Объект Из МассивОбъектов Цикл\r\n\t\t\r\n\t\tМетаданныеДокумента = Метаданные.НайтиПоТипу(ТипЗнч(Объект));\r\n\t\tЕсли МетаданныеДокумента <> Неопределено Тогда\r\n\t\r\n\t\t\tИмяДокумента = МетаданныеДокумента.Имя;\r\n\t\t\tЕсли НЕ СтруктураТипов.Свойство(ИмяДокумента) Тогда\r\n\t\t\t\tМассивДокументов \t= Новый Массив;\r\n\t\t\t\tСтруктураТипов.Вставить(ИмяДокумента, МассивДокументов);\r\n\t\t\tКонецЕсли;\r\n\t\t\tСтруктураТипов[ИмяДокумента].Добавить(Объект);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат СтруктураТипов;\r\n\t\r\nКонецФункции\n\nФункция РазложитьМассивПоТипамОбъектов(МассивОбъектов)\r\n\tСтруктураТипов \t= Новый Структура;\r\n\t\r\n\tДля Каждого Объект Из МассивОбъектов Цикл\r\n\t\t\r\n\t\tМетаданныеДокумента = Метаданные.НайтиПоТипу(ТипЗнч(Объект));\r\n\t\tЕсли МетаданныеДокумента <> Неопределено Тогда\r\n\t\r\n\t\t\tИмяДокумента = МетаданныеДокумента.Имя;\r\n\t\t\tЕсли НЕ СтруктураТипов.Свойство(ИмяДокумента) Тогда\r\n\t\t\t\tМассивДокументов \t= Новый Массив;\r\n\t\t\t\tСтруктураТипов.Вставить(ИмяДокумента, МассивДокументов);\r\n\t\t\tКонецЕсли;\r\n\t\t\tСтруктураТипов[ИмяДокумента].Добавить(Объект);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат СтруктураТипов;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Пустые колонки таблицы значений",
    "description": "Пустые колонки таблицы значений",
    "code_snippet": "// Возвращает имена колонок таблицы, по которым во всех строках пустые значения\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/30\r\n// \r\n// Параметры:\r\n//  ТаблицаЗначений - ТаблицаЗначений - Таблица, в которой нужно найти пустые колонки\r\n// \r\n// Возвращаемое значение:\r\n//  Массив из Строка - Коллекция имен пустых колонок \r\n//\r\n// Пример:\r\n// \tТЗ = Новый ТаблицаЗначений;\r\n// \tТЗ.Колонки.Добавить(\"К1\");\r\n// \tТЗ.Колонки.Добавить(\"К2\");\r\n// \tТЗ.Добавить();\r\n// \t\r\n// \tРезультат = ПустыеКолонкиТаблицыЗначений(ТЗ); //\"К1,К2\"\r\n// \t\r\n// \tТЗ[0].К1 = 1;\r\n// \tРезультат = ПустыеКолонкиТаблицыЗначений(ТЗ); //\"К2\"\r\n// \t\r\n// \tТЗ[0].К2 = 1;\r\n// \tРезультат = ПустыеКолонкиТаблицыЗначений(ТЗ); //\"\"\r\n//\r\nФункция ПустыеКолонкиТаблицыЗначений(Знач ТаблицаЗначений) Экспорт\r\n\t\r\n\tРезультат = Новый Массив; // Массив из Строка\r\n\tДля Каждого ТекущаяКолонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tРезультат.Добавить(ТекущаяКолонка.Имя);\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого ТекущиеДанные Из ТаблицаЗначений Цикл\r\n\t\t\r\n\t\tЗаполненныеКолонки = Новый Массив; // Массив из Строка\r\n\t\tДля Каждого ИмяКолонки Из Результат Цикл\r\n\t\t\t\r\n\t\t\tЕсли ЗначениеЗаполнено(ТекущиеДанные[ИмяКолонки]) Тогда\r\n\t\t\t\tЗаполненныеКолонки.Добавить(ИмяКолонки);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tДля Каждого ЗаполненнаяКолонка Из ЗаполненныеКолонки Цикл\r\n\t\t\tРезультат.Удалить(Результат.Найти(ЗаполненнаяКолонка));\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tЕсли НЕ ЗначениеЗаполнено(Результат) Тогда\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\r\nКонецФункции\n\n// Возвращает имена колонок таблицы, по которым во всех строках пустые значения\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/30\r\n// \r\n// Параметры:\r\n//  ТаблицаЗначений - ТаблицаЗначений - Таблица, в которой нужно найти пустые колонки\r\n// \r\n// Возвращаемое значение:\r\n//  Массив из Строка - Коллекция имен пустых колонок \r\n//\r\n// Пример:\r\n// \tТЗ = Новый ТаблицаЗначений;\r\n// \tТЗ.Колонки.Добавить(\"К1\");\r\n// \tТЗ.Колонки.Добавить(\"К2\");\r\n// \tТЗ.Добавить();\r\n// \t\r\n// \tРезультат = ПустыеКолонкиТаблицыЗначений(ТЗ); //\"К1,К2\"\r\n// \t\r\n// \tТЗ[0].К1 = 1;\r\n// \tРезультат = ПустыеКолонкиТаблицыЗначений(ТЗ); //\"К2\"\r\n// \t\r\n// \tТЗ[0].К2 = 1;\r\n// \tРезультат = ПустыеКолонкиТаблицыЗначений(ТЗ); //\"\"\r\n//\r\nФункция ПустыеКолонкиТаблицыЗначений(Знач ТаблицаЗначений) Экспорт\r\n\t\r\n\tРезультат = Новый Массив; // Массив из Строка\r\n\tДля Каждого ТекущаяКолонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tРезультат.Добавить(ТекущаяКолонка.Имя);\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого ТекущиеДанные Из ТаблицаЗначений Цикл\r\n\t\t\r\n\t\tЗаполненныеКолонки = Новый Массив; // Массив из Строка\r\n\t\tДля Каждого ИмяКолонки Из Результат Цикл\r\n\t\t\t\r\n\t\t\tЕсли ЗначениеЗаполнено(ТекущиеДанные[ИмяКолонки]) Тогда\r\n\t\t\t\tЗаполненныеКолонки.Добавить(ИмяКолонки);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tДля Каждого ЗаполненнаяКолонка Из ЗаполненныеКолонки Цикл\r\n\t\t\tРезультат.Удалить(Результат.Найти(ЗаполненнаяКолонка));\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tЕсли НЕ ЗначениеЗаполнено(Результат) Тогда\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\r\nКонецФункции"
  },
  {
    "title": "Проверить что переменная соответствует заданному типу",
    "description": "Проверить что переменная соответствует заданному типу",
    "code_snippet": "чАртикул = 100000000000;\r\nТипДанныхДолженБыть  = Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(10, 0, ДопустимыйЗнак.Неотрицательный));\r\n\r\nРезультатПриведения  = ТипДанныхДолженБыть.ПривестиЗначение(чАртикул);\r\n\r\nбулПроверка = РезультатПриведения = чАртикул;\n\nчАртикул = 100000000000;\r\nТипДанныхДолженБыть  = Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(10, 0, ДопустимыйЗнак.Неотрицательный));\r\n\r\nРезультатПриведения  = ТипДанныхДолженБыть.ПривестиЗначение(чАртикул);\r\n\r\nбулПроверка = РезультатПриведения = чАртикул;\n\n{6} Переменной булПроверка присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Как получить атрибут ХМЛ",
    "description": "Как получить атрибут ХМЛ",
    "code_snippet": "Х = СоздатьОбъект(\"Msxml2.DOMDocument.6.0\");\nх.async = 0;\nх.load(\"http://\"+ айпиООО +\"/opt/out/ReplyFormA\");\nСписок= х.selectNodes(\"//url\");\n\t\t\t\nДля ии=0 По Список.length-1  Цикл\t\t\n\t\t\t  сообщить( Список.item(ии).SelectSingleNode(\"@timestamp\").text);\t\t\n\t\t\t\t//или\n\t\t\t\tсообщить( Список.item(ии).getattribute(\"timestamp\"));\t\t\t\t\t\nКонецЦикла;\n\n//список только атрибутов\nСписок= х.selectNodes(\"//url/@timestamp\");\n\t\t\t\nДля ии=0 По Список.length-1  Цикл\t\t\n\t\t\t  сообщить( Список.item(ии).text);\t\t\t\t\t\t\t\t\nКонецЦикла;"
  },
  {
    "title": "Отображает PDF документ в HTML поле на форме через WebKit",
    "description": "Отображает PDF документ в HTML поле на форме через WebKit",
    "code_snippet": "//Процедура отображает PDF документ в HTML поле на форме через WebKit:\r\n//\r\n// Параметры:\r\n//  HTMLДокумент - Поле HTML документа - поле, в которое надо вывести pdf.\r\n// \r\n//\tДвоичныеДанные - Двоичные данные - pdf документ.\r\n//\r\nПроцедура ОтобразитьPDF(HTMLДокумент, ДвоичныеДанные) Экспорт\r\n\t\r\n\tСтрокаPDFФайла = ПолучитьBase64СтрокуИзДвоичныхДанных(ДвоичныеДанные);\r\n\t\r\n\tHTMLДокумент = \"<!DOCTYPE html>\r\n\t\t\t\t|<html>\r\n\t\t\t\t|\t<head>\r\n\t\t\t\t|\t\t<meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=UTF-8\"\" />\r\n\t\t\t\t|\t\t<meta name=\"\"viewport\"\" content=\"\"width=device-width, initial-scale = 1.0, maximum-scale = 1.0, user-scalable=no\"\">\r\n\t\t\t\t|\t\t<script src=\"\"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js\"\"></script>\r\n\t\t\t\t|\t\t<script src=\"\"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js\"\"></script>\r\n\t\t\t\t|\t\t<canvas id=\"\"the-canvas\"\"></canvas>\r\n\t\t\t\t|\t\t<script>\r\n\t\t\t\t|\t\t\tvar currPage = 1; //Pages are 1-based not 0-based\r\n\t\t\t\t|\t\t\tvar numPages = 0;\r\n\t\t\t\t|\t\t\tvar thePDF = null;\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\tvar loadingTask = pdfjsLib.getDocument({data: atob(`\" + СтрокаPDFФайла + \"`)});\r\n\t\t\t\t|\t\t\tloadingTask.promise.then(function(pdf) {\r\n\t\t\t\t|\t\t\t       \r\n\t\t\t\t|\t\t\t     thePDF = pdf;\r\n\t\t\t\t|\t\t\t     numPages = pdf.numPages;\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t     pdf.getPage(1).then(handlePages);                      \r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t     function handlePages(page) { \r\n\t\t\t\t|\t\t\t        var scale = 1.5;\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t        var viewport = page.getViewport({scale: scale});\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t        var canvas = document.createElement( \"\"canvas\"\" );\r\n\t\t\t\t|\t\t\t        canvas.style.display = \"\"block\"\";\r\n\t\t\t\t|\t\t\t        var context = canvas.getContext('2d');\r\n\t\t\t\t|\t\t\t        canvas.height = viewport.height;\r\n\t\t\t\t|\t\t\t        canvas.width = viewport.width;\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t        var renderContext = {\r\n\t\t\t\t|\t\t\t              canvasContext: context,\r\n\t\t\t\t|\t\t\t              viewport: viewport\r\n\t\t\t\t|\t\t\t        };\r\n\t\t\t\t|\t\t\t        var renderTask = page.render(renderContext);\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t         document.body.appendChild( canvas );\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t        currPage++;\r\n\t\t\t\t|\t\t\t        if ( thePDF !== null && currPage <= numPages )\r\n\t\t\t\t|\t\t\t        {\r\n\t\t\t\t|\t\t\t            thePDF.getPage( currPage ).then( handlePages );\r\n\t\t\t\t|\t\t\t        }\r\n\t\t\t\t|\t\t\t       };\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t});\r\n\t\t\t\t|\t\t</script>\r\n\t\t\t\t|\t</body>\r\n\t\t\t\t|</html>\";\r\n\t\r\nКонецПроцедуры\n\n//Процедура отображает PDF документ в HTML поле на форме через WebKit:\r\n//\r\n// Параметры:\r\n//  HTMLДокумент - Поле HTML документа - поле, в которое надо вывести pdf.\r\n// \r\n//\tДвоичныеДанные - Двоичные данные - pdf документ.\r\n//\r\nПроцедура ОтобразитьPDF(HTMLДокумент, ДвоичныеДанные) Экспорт\r\n\t\r\n\tСтрокаPDFФайла = ПолучитьBase64СтрокуИзДвоичныхДанных(ДвоичныеДанные);\r\n\t\r\n\tHTMLДокумент = \"<!DOCTYPE html>\r\n\t\t\t\t|<html>\r\n\t\t\t\t|\t<head>\r\n\t\t\t\t|\t\t<meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=UTF-8\"\" />\r\n\t\t\t\t|\t\t<meta name=\"\"viewport\"\" content=\"\"width=device-width, initial-scale = 1.0, maximum-scale = 1.0, user-scalable=no\"\">\r\n\t\t\t\t|\t\t<script src=\"\"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js\"\"></script>\r\n\t\t\t\t|\t\t<script src=\"\"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js\"\"></script>\r\n\t\t\t\t|\t\t<canvas id=\"\"the-canvas\"\"></canvas>\r\n\t\t\t\t|\t\t<script>\r\n\t\t\t\t|\t\t\tvar currPage = 1; //Pages are 1-based not 0-based\r\n\t\t\t\t|\t\t\tvar numPages = 0;\r\n\t\t\t\t|\t\t\tvar thePDF = null;\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\tvar loadingTask = pdfjsLib.getDocument({data: atob(`\" + СтрокаPDFФайла + \"`)});\r\n\t\t\t\t|\t\t\tloadingTask.promise.then(function(pdf) {\r\n\t\t\t\t|\t\t\t       \r\n\t\t\t\t|\t\t\t     thePDF = pdf;\r\n\t\t\t\t|\t\t\t     numPages = pdf.numPages;\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t     pdf.getPage(1).then(handlePages);                      \r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t     function handlePages(page) { \r\n\t\t\t\t|\t\t\t        var scale = 1.5;\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t        var viewport = page.getViewport({scale: scale});\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t        var canvas = document.createElement( \"\"canvas\"\" );\r\n\t\t\t\t|\t\t\t        canvas.style.display = \"\"block\"\";\r\n\t\t\t\t|\t\t\t        var context = canvas.getContext('2d');\r\n\t\t\t\t|\t\t\t        canvas.height = viewport.height;\r\n\t\t\t\t|\t\t\t        canvas.width = viewport.width;\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t        var renderContext = {\r\n\t\t\t\t|\t\t\t              canvasContext: context,\r\n\t\t\t\t|\t\t\t              viewport: viewport\r\n\t\t\t\t|\t\t\t        };\r\n\t\t\t\t|\t\t\t        var renderTask = page.render(renderContext);\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t         document.body.appendChild( canvas );\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t        currPage++;\r\n\t\t\t\t|\t\t\t        if ( thePDF !== null && currPage <= numPages )\r\n\t\t\t\t|\t\t\t        {\r\n\t\t\t\t|\t\t\t            thePDF.getPage( currPage ).then( handlePages );\r\n\t\t\t\t|\t\t\t        }\r\n\t\t\t\t|\t\t\t       };\r\n\t\t\t\t|\t\t\t\r\n\t\t\t\t|\t\t\t});\r\n\t\t\t\t|\t\t</script>\r\n\t\t\t\t|\t</body>\r\n\t\t\t\t|</html>\";\r\n\t\r\nКонецПроцедуры\n\nОрфографическая ошибка в charset: charset\r\nОрфографическая ошибка в viewport (найдено 6): viewport\r\nОрфографическая ошибка в scalable: scalable\r\nОрфографическая ошибка в currPage (найдено 4): curr\r\nОрфографическая ошибка в pdfjsLib: pdfjs\r\nОрфографическая ошибка в atob: atob\r\nОрфографическая ошибка в getViewport: Viewport"
  },
  {
    "title": "Показать вопрос",
    "description": "Показать вопрос",
    "code_snippet": "&НаКлиенте\r\nПроцедура КомандаСпроситьУПользователя(Команда)\r\n\t\r\n\tОповещение = Новый ОписаниеОповещения(\"КомандаСпроситьУПользователяЗавершение\", ЭтаФорма, Неопределено);\r\n\tТекстВопроса = \"Будет выполнено некое действие. Продолжить?\";\r\n\tПоказатьВопрос(Оповещение, ТекстВопроса, РежимДиалогаВопрос.ДаНет);\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура КомандаСпроситьУПользователяЗавершение(Результат, ДополнительныеПараметры = Неопределено) Экспорт\r\n\t\r\n\tЕсли Результат = КодВозвратаДиалога.Нет Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n        // Сделать что нужно\r\n\t\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура КомандаСпроситьУПользователя(Команда)\r\n\t\r\n\tОповещение = Новый ОписаниеОповещения(\"КомандаСпроситьУПользователяЗавершение\", ЭтаФорма, Неопределено);\r\n\tТекстВопроса = \"Будет выполнено некое действие. Продолжить?\";\r\n\tПоказатьВопрос(Оповещение, ТекстВопроса, РежимДиалогаВопрос.ДаНет);\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура КомандаСпроситьУПользователяЗавершение(Результат, ДополнительныеПараметры = Неопределено) Экспорт\r\n\t\r\n\tЕсли Результат = КодВозвратаДиалога.Нет Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n        // Сделать что нужно\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Вопрос перед закрытием конфигуратора",
    "description": "Вопрос перед закрытием конфигуратора",
    "code_snippet": ""
  },
  {
    "title": "Типизировать Колонки",
    "description": "Типизировать Колонки",
    "code_snippet": "// Находит колонки с произвольным типом и заменяет их на типизированные\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/34\r\n// \r\n// Параметры:\r\n//  ТаблицаЗначений\t - ТаблицаЗначений - Таблица, колонки которой необходимо типизировать\r\n//  \r\n// Пример:\r\n// \tТЗ = Новый ТаблицаЗначений;\r\n// \tТЗ.Колонки.Добавить(\"К1\");\r\n// \tТЗ.Добавить().К1 = 1;\r\n// \tТЗ.Добавить().К1 = 2;\r\n// \tТипизироватьКолонки(ТЗ);\r\n// \tСообщить(ТЗ.Колонки.К1.ТипЗначения); //Число\r\n//  \r\nПроцедура ТипизироватьКолонки(Знач ТаблицаЗначений) Экспорт\r\n\t\r\n\t//Определяем колонки с произвольным типом\r\n\tОбрабатываемыеКолонки = Новый Массив; // Массив из КолонкаТаблицыЗначений\r\n\tДля Каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tЕсли Колонка.ТипЗначения.Типы().Количество() = 0 Тогда\r\n\t\t\tОбрабатываемыеКолонки.Добавить(Колонка);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tКоличествоОбрабатываемыхКолонок = ОбрабатываемыеКолонки.Количество();\r\n\tЕсли КоличествоОбрабатываемыхКолонок = 0 Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n\t//Сохраняем содержащиеся в колонках значения и запоминаем их типы\r\n\tЗначенияСтрокКолонок = Новый Массив(КоличествоОбрабатываемыхКолонок); // Массив из Массив\r\n\tТипыЗначенийКолонок = Новый Массив(КоличествоОбрабатываемыхКолонок); // Массив из Массив\r\n\tДля Каждого СтрокаТаблицы Из ТаблицаЗначений Цикл\r\n\t\t\r\n\t\tДля Индекс = 0 По КоличествоОбрабатываемыхКолонок - 1 Цикл\r\n\t\t\t\r\n\t\t\tКолонка = ОбрабатываемыеКолонки[Индекс];\r\n\t\t\tТипыЗначений = ТипыЗначенийКолонок[Индекс]; // Массив из Тип\r\n\t\t\tЕсли ТипыЗначений = Неопределено Тогда\r\n\t\t\t\tТипыЗначений = Новый Массив;\r\n\t\t\t\tТипыЗначенийКолонок[Индекс] = ТипыЗначений;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tЗначенияКолонки = ЗначенияСтрокКолонок[Индекс]; // Массив из Неопределено\r\n\t\t\tЕсли ЗначенияКолонки = Неопределено Тогда\r\n\t\t\t\tЗначенияКолонки = Новый Массив;\r\n\t\t\t\tЗначенияСтрокКолонок[Индекс] = ЗначенияКолонки;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tТекущееЗначение = СтрокаТаблицы[Колонка.Имя]; // Произвольный\r\n\t\t\t\r\n\t\t\tЗначенияКолонки.Добавить(ТекущееЗначение);\t\t\t\r\n\t\t\t\r\n\t\t\tТипЗначения = ТипЗнч(СтрокаТаблицы[Колонка.Имя]);\r\n\t\t\tЕсли ТипыЗначений.Найти(ТипЗначения) = Неопределено Тогда\r\n\t\t\t\tТипыЗначений.Добавить(ТипЗначения);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t//Типизируем колонки\r\n\tДля Индекс = 0 По КоличествоОбрабатываемыхКолонок - 1 Цикл\r\n\t\t\t\r\n\t\tИмяКолонки = ОбрабатываемыеКолонки[Индекс].Имя;\r\n\t\t\r\n\t\tИзменитьТипКолонки(ТаблицаЗначений, ИмяКолонки, \r\n\t\t\tНовый ОписаниеТипов(ТипыЗначенийКолонок[Индекс]), ЗначенияСтрокКолонок[Индекс]);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\r\n\r\n// Изменить тип колонки.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/34\r\n//  \r\n// Параметры:\r\n//  ТаблицаЗначений - ТаблицаЗначений - Таблица значений\r\n//  ИмяКолонки - Строка - Имя колонки\r\n//  НовыйТип - ОписаниеТипов - Новый тип\r\n//  ЗначенияКолонки - Массив из Неопределено - Значения колонки\r\n//\r\n// Пример:\r\n//  ТЗ = Новый ТаблицаЗначений;\r\n//  ТЗ.Колонки.Добавить(\"К1\");\r\n//  ТЗ.Добавить().К1 = \"2\";\r\n//  ТЗ.Добавить().К1 = \"тест\";\r\n//  ТЗ.Добавить().К1 = 2;\r\n//\r\n//\tИзменитьТипКолонки(ТЗ, \"К1\", Новый ОписаниеТипов(\"Число\"));\r\n//\r\n//\t//Значения К1 в ТЗ: 2, 0, 2\r\n//\t\r\nПроцедура ИзменитьТипКолонки(Знач ТаблицаЗначений, Знач ИмяКолонки, Знач НовыйТип, Знач ЗначенияКолонки = Неопределено) Экспорт\r\n\t\r\n\tСтараяКолонка = ТаблицаЗначений.Колонки.Найти(ИмяКолонки);\r\n\tЕсли ЗначенияКолонки = Неопределено Тогда\r\n\t\tЗначенияКолонки = ТаблицаЗначений.ВыгрузитьКолонку(СтараяКолонка)\r\n\tКонецЕсли;\r\n\t\r\n\tВременноеНазвание = \"Колонка_\" + СтрЗаменить(Строка(Новый УникальныйИдентификатор()), \"-\", \"\");\r\n\t\r\n\tНоваяКолонка = ТаблицаЗначений.Колонки.Добавить(ВременноеНазвание, \r\n\t\tНовыйТип, СтараяКолонка.Заголовок, СтараяКолонка.Ширина);\r\n\t\r\n\tТаблицаЗначений.ЗагрузитьКолонку(ЗначенияКолонки, НоваяКолонка);\r\n\t\r\n\tТаблицаЗначений.Колонки.Удалить(ИмяКолонки);\r\n\t\r\n\tНоваяКолонка.Имя = ИмяКолонки;\r\n\t\r\nКонецПроцедуры\n\n// Находит колонки с произвольным типом и заменяет их на типизированные\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/34\r\n// \r\n// Параметры:\r\n//  ТаблицаЗначений\t - ТаблицаЗначений - Таблица, колонки которой необходимо типизировать\r\n//  \r\n// Пример:\r\n// \tТЗ = Новый ТаблицаЗначений;\r\n// \tТЗ.Колонки.Добавить(\"К1\");\r\n// \tТЗ.Добавить().К1 = 1;\r\n// \tТЗ.Добавить().К1 = 2;\r\n// \tТипизироватьКолонки(ТЗ);\r\n// \tСообщить(ТЗ.Колонки.К1.ТипЗначения); //Число\r\n//  \r\nПроцедура ТипизироватьКолонки(Знач ТаблицаЗначений) Экспорт\r\n\t\r\n\t//Определяем колонки с произвольным типом\r\n\tОбрабатываемыеКолонки = Новый Массив; // Массив из КолонкаТаблицыЗначений\r\n\tДля Каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tЕсли Колонка.ТипЗначения.Типы().Количество() = 0 Тогда\r\n\t\t\tОбрабатываемыеКолонки.Добавить(Колонка);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tКоличествоОбрабатываемыхКолонок = ОбрабатываемыеКолонки.Количество();\r\n\tЕсли КоличествоОбрабатываемыхКолонок = 0 Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n\t//Сохраняем содержащиеся в колонках значения и запоминаем их типы\r\n\tЗначенияСтрокКолонок = Новый Массив(КоличествоОбрабатываемыхКолонок); // Массив из Массив\r\n\tТипыЗначенийКолонок = Новый Массив(КоличествоОбрабатываемыхКолонок); // Массив из Массив\r\n\tДля Каждого СтрокаТаблицы Из ТаблицаЗначений Цикл\r\n\t\t\r\n\t\tДля Индекс = 0 По КоличествоОбрабатываемыхКолонок - 1 Цикл\r\n\t\t\t\r\n\t\t\tКолонка = ОбрабатываемыеКолонки[Индекс];\r\n\t\t\tТипыЗначений = ТипыЗначенийКолонок[Индекс]; // Массив из Тип\r\n\t\t\tЕсли ТипыЗначений = Неопределено Тогда\r\n\t\t\t\tТипыЗначений = Новый Массив;\r\n\t\t\t\tТипыЗначенийКолонок[Индекс] = ТипыЗначений;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tЗначенияКолонки = ЗначенияСтрокКолонок[Индекс]; // Массив из Неопределено\r\n\t\t\tЕсли ЗначенияКолонки = Неопределено Тогда\r\n\t\t\t\tЗначенияКолонки = Новый Массив;\r\n\t\t\t\tЗначенияСтрокКолонок[Индекс] = ЗначенияКолонки;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tТекущееЗначение = СтрокаТаблицы[Колонка.Имя]; // Произвольный\r\n\t\t\t\r\n\t\t\tЗначенияКолонки.Добавить(ТекущееЗначение);\t\t\t\r\n\t\t\t\r\n\t\t\tТипЗначения = ТипЗнч(СтрокаТаблицы[Колонка.Имя]);\r\n\t\t\tЕсли ТипыЗначений.Найти(ТипЗначения) = Неопределено Тогда\r\n\t\t\t\tТипыЗначений.Добавить(ТипЗначения);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t//Типизируем колонки\r\n\tДля Индекс = 0 По КоличествоОбрабатываемыхКолонок - 1 Цикл\r\n\t\t\t\r\n\t\tИмяКолонки = ОбрабатываемыеКолонки[Индекс].Имя;\r\n\t\t\r\n\t\tИзменитьТипКолонки(ТаблицаЗначений, ИмяКолонки, \r\n\t\t\tНовый ОписаниеТипов(ТипыЗначенийКолонок[Индекс]), ЗначенияСтрокКолонок[Индекс]);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\r\n\r\n// Изменить тип колонки.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/34\r\n//  \r\n// Параметры:\r\n//  ТаблицаЗначений - ТаблицаЗначений - Таблица значений\r\n//  ИмяКолонки - Строка - Имя колонки\r\n//  НовыйТип - ОписаниеТипов - Новый тип\r\n//  ЗначенияКолонки - Массив из Неопределено - Значения колонки\r\n//\r\n// Пример:\r\n//  ТЗ = Новый ТаблицаЗначений;\r\n//  ТЗ.Колонки.Добавить(\"К1\");\r\n//  ТЗ.Добавить().К1 = \"2\";\r\n//  ТЗ.Добавить().К1 = \"тест\";\r\n//  ТЗ.Добавить().К1 = 2;\r\n//\r\n//\tИзменитьТипКолонки(ТЗ, \"К1\", Новый ОписаниеТипов(\"Число\"));\r\n//\r\n//\t//Значения К1 в ТЗ: 2, 0, 2\r\n//\t\r\nПроцедура ИзменитьТипКолонки(Знач ТаблицаЗначений, Знач ИмяКолонки, Знач НовыйТип, Знач ЗначенияКолонки = Неопределено) Экспорт\r\n\t\r\n\tСтараяКолонка = ТаблицаЗначений.Колонки.Найти(ИмяКолонки);\r\n\tЕсли ЗначенияКолонки = Неопределено Тогда\r\n\t\tЗначенияКолонки = ТаблицаЗначений.ВыгрузитьКолонку(СтараяКолонка)\r\n\tКонецЕсли;\r\n\t\r\n\tВременноеНазвание = \"Колонка_\" + СтрЗаменить(Строка(Новый УникальныйИдентификатор()), \"-\", \"\");\r\n\t\r\n\tНоваяКолонка = ТаблицаЗначений.Колонки.Добавить(ВременноеНазвание, \r\n\t\tНовыйТип, СтараяКолонка.Заголовок, СтараяКолонка.Ширина);\r\n\t\r\n\tТаблицаЗначений.ЗагрузитьКолонку(ЗначенияКолонки, НоваяКолонка);\r\n\t\r\n\tТаблицаЗначений.Колонки.Удалить(ИмяКолонки);\r\n\t\r\n\tНоваяКолонка.Имя = ИмяКолонки;\r\n\t\r\nКонецПроцедуры\n\nОписаниеКолонки.Значения = ТаблицаЗначений.ВыгрузитьКолонку(0);\n\nОписаниеКолонки.Значения = ТаблицаЗначений.ВыгрузитьКолонку(Колонка.Имя);"
  },
  {
    "title": "Вызов процедур или функций модуля объекта из модуля формы",
    "description": "Вызов процедур или функций модуля объекта из модуля формы",
    "code_snippet": "&НаСервере\r\nПроцедура ПодключитьсяНаСервере()\r\n\t\r\n\tТекОбъект = РеквизитФормыВЗначение(\"Объект\");//Для отчета \"Отчет\"\r\n\tТекОбъект.ЭкспортныйВызовИзМодуляОбъекта();\r\n\t\r\n\t//если содержимое Объект поменялось и нужно обновить его на форме, то делаем:\r\n\tЗначениеВРеквизитФормы(ТекОбъект, \"Объект\");\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ПодключитьсяНаСервере()\r\n\t\r\n\tТекОбъект = РеквизитФормыВЗначение(\"Объект\");//Для отчета \"Отчет\"\r\n\tТекОбъект.ЭкспортныйВызовИзМодуляОбъекта();\r\n\t\r\n\t//если содержимое Объект поменялось и нужно обновить его на форме, то делаем:\r\n\tЗначениеВРеквизитФормы(ТекОбъект, \"Объект\");\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\nПерем ОбработкаОбъект;\n&НаСервере\nФункция ОбработкаОбъект()\n  Если ОбработкаОбъект = Неопределено Тогда    \n    СтруктураОбработки = ПолучитьИзВременногоХранилища(Объект.ОбщийКонтекстКлиентСервер.АдресОбработкаОбъект);    \n    Если СтруктураОбработки <> Неопределено Тогда\n      ОбработкаОбъект = СтруктураОбработки.ОбработкаОбъект;\n    КонецЕсли;    \n    Если ОбработкаОбъект = Неопределено Тогда      \n      ОбработкаОбъект = РеквизитФормыВЗначение(\"Объект\");\n      Попытка\n        ПоместитьВоВременноеХранилище(Новый Структура(\"ОбработкаОбъект\", ОбработкаОбъект), Объект.ОбщийКонтекстКлиентСервер.АдресОбработкаОбъект);\n      Исключение\n      КонецПопытки;      \n    Иначе\n      ОбработкаОбъект.ОбщийКонтекстКлиентСервер = Объект.ОбщийКонтекстКлиентСервер;\n    КонецЕсли;    \n  КонецЕсли;    \n  Возврат ОбработкаОбъект;  \nКонецФункции"
  },
  {
    "title": "Скриншот сеанса средствами 1С",
    "description": "Скриншот сеанса средствами 1С",
    "code_snippet": "// Процедура сохраняет скриншот текущего сеанса пользователя по переданному адресу\r\n// Работает начиная с версии 8.3.17.\r\n//\r\n// Параметры:\r\n//  ПолныйПуть\t - Строка\t - Полный путь к файлу\r\n//\r\n&НаКлиенте\r\nПроцедура СохранитьСкриншотСеанса(ПолныйПуть = \"\")\r\n\t\r\n\t#Если НЕ ВебКлиент Тогда\r\n\t\r\n\tВременныйФайл = ПолучитьИмяВременногоФайла(\".zip\");\r\n\t\r\n\tОтчетОбОшибке = Новый ОтчетОбОшибке(ИнформацияОбОшибке());\r\n\tОтчетОбОшибке.Записать(ВременныйФайл, Ложь);\r\n\t\r\n\tКаталогФайлов = КаталогВременныхФайлов() + СтрЗаменить(Новый УникальныйИдентификатор, \"-\", \"\");\r\n\tЧтениеАрхива  = Новый ЧтениеZipФайла(ВременныйФайл);\r\n\tЧтениеАрхива.ИзвлечьВсе(КаталогФайлов, РежимВосстановленияПутейФайловZIP.НеВосстанавливать);\r\n\t\r\n\tПутьСкриншота = КаталогФайлов + \"\\screenshot.png\";\r\n\tКопироватьФайл(ПутьСкриншота, ПолныйПуть);\r\n\t\r\n\tУдалитьФайлы(ВременныйФайл);\r\n\tУдалитьФайлы(КаталогФайлов);\r\n\t\r\n\t#КонецЕсли\r\n\t\r\nКонецПроцедуры\n\n// Процедура сохраняет скриншот текущего сеанса пользователя по переданному адресу\r\n// Работает начиная с версии 8.3.17.\r\n//\r\n// Параметры:\r\n//  ПолныйПуть\t - Строка\t - Полный путь к файлу\r\n//\r\n&НаКлиенте\r\nПроцедура СохранитьСкриншотСеанса(ПолныйПуть = \"\")\r\n\t\r\n\t#Если НЕ ВебКлиент Тогда\r\n\t\r\n\tВременныйФайл = ПолучитьИмяВременногоФайла(\".zip\");\r\n\t\r\n\tОтчетОбОшибке = Новый ОтчетОбОшибке(ИнформацияОбОшибке());\r\n\tОтчетОбОшибке.Записать(ВременныйФайл, Ложь);\r\n\t\r\n\tКаталогФайлов = КаталогВременныхФайлов() + СтрЗаменить(Новый УникальныйИдентификатор, \"-\", \"\");\r\n\tЧтениеАрхива  = Новый ЧтениеZipФайла(ВременныйФайл);\r\n\tЧтениеАрхива.ИзвлечьВсе(КаталогФайлов, РежимВосстановленияПутейФайловZIP.НеВосстанавливать);\r\n\t\r\n\tПутьСкриншота = КаталогФайлов + \"\\screenshot.png\";\r\n\tКопироватьФайл(ПутьСкриншота, ПолныйПуть);\r\n\t\r\n\tУдалитьФайлы(ВременныйФайл);\r\n\tУдалитьФайлы(КаталогФайлов);\r\n\t\r\n\t#КонецЕсли\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Не переносите код таким образом",
    "description": "Не переносите код таким образом",
    "code_snippet": ""
  },
  {
    "title": "Колонки результата запроса",
    "description": "Колонки результата запроса",
    "code_snippet": "Запрос  = Новый Запрос(\"ВЫБРАТЬ 1\");\nКолонки = Запрос.Выполнить().Колонки;\n\nСообщить(Колонки.Получить(0).ТипЗначения);\n//Сообщение: Null, Число\n\nЗапрос      = Новый Запрос(\"ВЫБРАТЬ 1 КАК Поле\");\nВыгрузка    = Запрос.Выполнить().Выгрузить();\nНоваяСтрока = Выгрузка.Добавить();\n\nСообщить(ТипЗнч(НоваяСтрока.Поле));\n//Сообщение: Неопределено"
  },
  {
    "title": "Вопрос. Стоит ли мне учить 1С для дальнейшего потом заработка",
    "description": "Вопрос. Стоит ли мне учить 1С для дальнейшего потом заработка",
    "code_snippet": ""
  },
  {
    "title": "Запрос 1С",
    "description": "Запрос 1С",
    "code_snippet": "ВЫБРАТЬ\n\tТоварыНаСкладахОстатки.Номенклатура,\n\tТоварыНаСкладахОстатки.КоличествоОстаток,\n\tЕстьNULL(ЗакупкиОбороты.КоличествоОборот, \"Нет закупок\") КАК КоличествоЗакупок,\n\tЕстьNULL(ПродажиОбороты.КоличествоОборот, \"Нет продаж\") КАК КоличествоПродаж\nИЗ\n\tРегистрНакопления.ТоварыНаСкладах.Остатки КАК ТоварыНаСкладахОстатки\n\t\tЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.Закупки.Обороты КАК ЗакупкиОбороты\n\t\t\tЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.Продажи.Обороты КАК ПродажиОбороты\n\t\t\tПО ЗакупкиОбороты.Номенклатура = ПродажиОбороты.Номенклатура\n\t\tПО ТоварыНаСкладахОстатки.Номенклатура = ЗакупкиОбороты.Номенклатура"
  },
  {
    "title": "Получить данные временной таблицы",
    "description": "Получить данные временной таблицы",
    "code_snippet": "//Функция возвращает содержимое временной таблицы в запросе по индексу\r\n//\r\n// Параметры:\r\n//  Запрос - Запрос - исполняемый запрос\r\n//  ИндексПакета - Число – индекс временной таблицы\r\n//\r\n// Возвращаемое значение: \r\n//  - Таблица значений - таблица значений с содержимым временной таблицы.\r\n// \r\nФункция ПолучитьДанныеВременнойТаблицы(Запрос, ИндексПакета) Экспорт\r\n\tВозврат Запрос.ВыполнитьПакетСПромежуточнымиДанными()[ИндексПакета].Выгрузить();\r\nКонецФункции\n\n//Функция возвращает содержимое временной таблицы в запросе по индексу\r\n//\r\n// Параметры:\r\n//  Запрос - Запрос - исполняемый запрос\r\n//  ИндексПакета - Число – индекс временной таблицы\r\n//\r\n// Возвращаемое значение: \r\n//  - Таблица значений - таблица значений с содержимым временной таблицы.\r\n// \r\nФункция ПолучитьДанныеВременнойТаблицы(Запрос, ИндексПакета) Экспорт\r\n\tВозврат Запрос.ВыполнитьПакетСПромежуточнымиДанными()[ИндексПакета].Выгрузить();\r\nКонецФункции"
  },
  {
    "title": "Шпаргалка по горячим клавишам для разработчика 1С",
    "description": "Шпаргалка по горячим клавишам для разработчика 1С",
    "code_snippet": ""
  },
  {
    "title": "Как узнать какая программа блокирует файл",
    "description": "Как узнать какая программа блокирует файлБубен админа",
    "code_snippet": ""
  },
  {
    "title": "Замеряет скорость выполнения запроса и получает его выгрузки",
    "description": "Замеряет скорость выполнения запроса и получает его выгрузки",
    "code_snippet": "// Замеряет скорость выполнения запроса и получает его выгрузки\r\n// Возвращает результат анализа запроса и полученные данные. При этом переданный объект запроса не выполняется\r\n// Удобно использовать в отладке для анализа запроса прямо с установленными параметрами и МВТ\r\n// Функция будет поддерживаться и обновляться на FastCode: https://fastcode.im/Templates/7426\r\n//\r\n// 1. Выбирает все данные из менеджера временных таблиц\r\n// 2. Создает копию запроса с новым менеджером таблиц\r\n// 3. Выполняет копию запроса в разрезе пакетов\r\n// 4. Замеряет скорость выполнения каждого пакета\r\n// 5. Выбирает данные результатов выполнения\r\n// 6. Возвращает результат анализа запроса\r\n//\r\n// Параметры:\r\n//  ВходящийЗапрос  - Запрос - Анализируемый запрос\r\n//\r\n// Возвращаемое значение:\r\n//   Таблица значений   - результат анализа\r\n//\r\nФункция ВыполнитьЗапросСАналитикой(ВходящийЗапрос) Экспорт\r\n\t\r\n\tДанныеПакетов = Новый ТаблицаЗначений;\r\n\t\r\n\tДанныеПакетов.Колонки.Добавить(\"НомерСтроки\" , Новый ОписаниеТипов(\"Число\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"Тип\"         , Новый ОписаниеТипов(\"Строка\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"ИмяТаблицы\"  , Новый ОписаниеТипов(\"Строка\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"Миллисекунды\", Новый ОписаниеТипов(\"Число\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"Записей\"     , Новый ОписаниеТипов(\"Число\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"ЕстьДанные\"  , Новый ОписаниеТипов(\"Булево\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"Данные\"      , Новый ОписаниеТипов(\"ТаблицаЗначений\"));\r\n\t\r\n\tДанныеПакетов.Индексы.Добавить(\"ИмяТаблицы\");\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\r\n\t\r\n\tЕсли ВходящийЗапрос.МенеджерВременныхТаблиц <> Неопределено Тогда\r\n\t\t\r\n\t\tДля Каждого ВременнаяТаблица Из ВходящийЗапрос.МенеджерВременныхТаблиц.Таблицы Цикл\r\n\t\t\t\r\n\t\t\tВыбираемыеПоля = Новый Массив;\r\n\t\t\tДля Каждого ОписаниеКолонки Из ВременнаяТаблица.Колонки Цикл\r\n\t\t\t\tВыбираемыеПоля.Добавить(ОписаниеКолонки.Имя);\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tЗапрос.Текст = СтрШаблон(\"ВЫБРАТЬ %1 ПОМЕСТИТЬ %2 ИЗ &ВременнаяТаблица КАК ВТ\", \r\n\t\t\tСтрСоединить(ВыбираемыеПоля, \",\"), ВременнаяТаблица.ПолноеИмя);\r\n\t\t\t\r\n\t\t\tДанныеВременнойТаблицы = ВременнаяТаблица.ПолучитьДанные().Выгрузить();\r\n\t\t\tЗапрос.УстановитьПараметр(\"ВременнаяТаблица\", ДанныеВременнойТаблицы);\r\n\t\t\t\r\n\t\t\tЗапрос.Выполнить();\r\n\t\t\t\r\n\t\t\tОписаниеПакета = ДанныеПакетов.Добавить();\r\n\t\t\tОписаниеПакета.ИмяТаблицы  = ВременнаяТаблица.ПолноеИмя;\r\n\t\t\tОписаниеПакета.Данные      = ДанныеВременнойТаблицы;\r\n\t\t\tОписаниеПакета.ЕстьДанные  = Истина;\r\n\t\t\tОписаниеПакета.Тип = \"Таблица менеджера\";\r\n\t\t\t\r\n\t\t\tЗапрос.Текст = \"\";\r\n\t\t\tЗапрос.Параметры.Удалить(\"ВременнаяТаблица\");\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого КлючИЗначение Из ВходящийЗапрос.Параметры Цикл\r\n\t\tЗапрос.УстановитьПараметр(КлючИЗначение.Ключ, КлючИЗначение.Значение);\r\n\tКонецЦикла;\r\n\t\r\n\tСхемаЗапроса = Новый СхемаЗапроса;\r\n\tСхемаЗапроса.УстановитьТекстЗапроса(ВходящийЗапрос.Текст);\r\n\tДля Каждого ПакетЗапроса Из СхемаЗапроса.ПакетЗапросов Цикл\r\n\t\t\r\n\t\tОписаниеПакета = ДанныеПакетов.Добавить();\r\n\t\t\r\n\t\tЕсли ТипЗнч(ПакетЗапроса) = Тип(\"ЗапросУничтоженияТаблицыСхемыЗапроса\") Тогда\r\n\t\t\t\r\n\t\t\tЗапрос.Текст = \"УНИЧТОЖИТЬ \" + ПакетЗапроса.ИмяТаблицы;\r\n\t\t\tОписаниеПакета.ЕстьДанные  = Ложь;\r\n\t\t\tОписаниеПакета.ИмяТаблицы = Запрос.Текст;\r\n\t\t\tОписаниеПакета.Тип = \"Уничтожение\";\r\n\t\t\t\r\n\t\tИначе\r\n\t\t\t\r\n\t\t\tОписаниеПакета.ЕстьДанные  = Истина;\r\n\t\t\tЕсли ПустаяСтрока(ПакетЗапроса.ТаблицаДляПомещения) Тогда\r\n\t\t\t\tОписаниеПакета.Тип = \"Выборка\";\r\n\t\t\tИначе\r\n\t\t\t\tОписаниеПакета.Тип = \"Помещение\";\r\n\t\t\t\tСуществующийПакет  = ДанныеПакетов.Найти(ПакетЗапроса.ТаблицаДляПомещения, \"ИмяТаблицы\");\r\n\t\t\t\tЕсли СуществующийПакет <> Неопределено Тогда\r\n\t\t\t\t\tЗапрос.Текст = \"УНИЧТОЖИТЬ \" + ПакетЗапроса.ТаблицаДляПомещения;\r\n\t\t\t\t\tЗапрос.Выполнить();\r\n\t\t\t\t\tДанныеПакетов.Удалить(СуществующийПакет);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tОписаниеПакета.ИмяТаблицы = ПакетЗапроса.ТаблицаДляПомещения;\r\n\t\t\t\r\n\t\t\tЗапрос.Текст = ПакетЗапроса.ПолучитьТекстЗапроса();\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tНачалоЗамера    = ТекущаяУниверсальнаяДатаВМиллисекундах();\r\n\t\tРезультатЗапрос = Запрос.Выполнить();\r\n\t\tКонецЗамера     = ТекущаяУниверсальнаяДатаВМиллисекундах();\r\n\t\t\r\n\t\tОписаниеПакета.Данные       = ДанныеВременнойТаблицы;\r\n\t\tОписаниеПакета.Миллисекунды = КонецЗамера-НачалоЗамера;\r\n\t\t\r\n\t\tЕсли ОписаниеПакета.ЕстьДанные Тогда\r\n\t\t\tЕсли ОписаниеПакета.Тип = \"Выборка\" Тогда\r\n\t\t\t\tДанныеПакета = РезультатЗапрос.Выгрузить();\r\n\t\t\tИначе\r\n\t\t\t\tДанныеПакета = Запрос.МенеджерВременныхТаблиц.Таблицы.Найти(ОписаниеПакета.ИмяТаблицы).ПолучитьДанные().Выгрузить();\r\n\t\t\tКонецЕсли;\r\n\t\t\tОписаниеПакета.Данные = ДанныеПакета;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tДля НомерСтроки = 1 По ДанныеПакетов.Количество() Цикл\r\n\t\tОписаниеПакета = ДанныеПакетов[НомерСтроки-1];\r\n\t\tОписаниеПакета.НомерСтроки = НомерСтроки;\r\n\t\tЕсли ОписаниеПакета.ЕстьДанные Тогда\r\n\t\t\tОписаниеПакета.Записей = ОписаниеПакета.Данные.Количество();\r\n\t\t\tЕсли ОписаниеПакета.Записей = 0 Тогда\r\n\t\t\t\tОписаниеПакета.ЕстьДанные = Ложь;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат ДанныеПакетов;\r\n\t\r\nКонецФункции\n\n// Замеряет скорость выполнения запроса и получает его выгрузки\r\n// Возвращает результат анализа запроса и полученные данные. При этом переданный объект запроса не выполняется\r\n// Удобно использовать в отладке для анализа запроса прямо с установленными параметрами и МВТ\r\n// Функция будет поддерживаться и обновляться на FastCode: https://fastcode.im/Templates/7426\r\n//\r\n// 1. Выбирает все данные из менеджера временных таблиц\r\n// 2. Создает копию запроса с новым менеджером таблиц\r\n// 3. Выполняет копию запроса в разрезе пакетов\r\n// 4. Замеряет скорость выполнения каждого пакета\r\n// 5. Выбирает данные результатов выполнения\r\n// 6. Возвращает результат анализа запроса\r\n//\r\n// Параметры:\r\n//  ВходящийЗапрос  - Запрос - Анализируемый запрос\r\n//\r\n// Возвращаемое значение:\r\n//   Таблица значений   - результат анализа\r\n//\r\nФункция ВыполнитьЗапросСАналитикой(ВходящийЗапрос) Экспорт\r\n\t\r\n\tДанныеПакетов = Новый ТаблицаЗначений;\r\n\t\r\n\tДанныеПакетов.Колонки.Добавить(\"НомерСтроки\" , Новый ОписаниеТипов(\"Число\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"Тип\"         , Новый ОписаниеТипов(\"Строка\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"ИмяТаблицы\"  , Новый ОписаниеТипов(\"Строка\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"Миллисекунды\", Новый ОписаниеТипов(\"Число\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"Записей\"     , Новый ОписаниеТипов(\"Число\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"ЕстьДанные\"  , Новый ОписаниеТипов(\"Булево\"));\r\n\tДанныеПакетов.Колонки.Добавить(\"Данные\"      , Новый ОписаниеТипов(\"ТаблицаЗначений\"));\r\n\t\r\n\tДанныеПакетов.Индексы.Добавить(\"ИмяТаблицы\");\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\r\n\t\r\n\tЕсли ВходящийЗапрос.МенеджерВременныхТаблиц <> Неопределено Тогда\r\n\t\t\r\n\t\tДля Каждого ВременнаяТаблица Из ВходящийЗапрос.МенеджерВременныхТаблиц.Таблицы Цикл\r\n\t\t\t\r\n\t\t\tВыбираемыеПоля = Новый Массив;\r\n\t\t\tДля Каждого ОписаниеКолонки Из ВременнаяТаблица.Колонки Цикл\r\n\t\t\t\tВыбираемыеПоля.Добавить(ОписаниеКолонки.Имя);\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tЗапрос.Текст = СтрШаблон(\"ВЫБРАТЬ %1 ПОМЕСТИТЬ %2 ИЗ &ВременнаяТаблица КАК ВТ\", \r\n\t\t\tСтрСоединить(ВыбираемыеПоля, \",\"), ВременнаяТаблица.ПолноеИмя);\r\n\t\t\t\r\n\t\t\tДанныеВременнойТаблицы = ВременнаяТаблица.ПолучитьДанные().Выгрузить();\r\n\t\t\tЗапрос.УстановитьПараметр(\"ВременнаяТаблица\", ДанныеВременнойТаблицы);\r\n\t\t\t\r\n\t\t\tЗапрос.Выполнить();\r\n\t\t\t\r\n\t\t\tОписаниеПакета = ДанныеПакетов.Добавить();\r\n\t\t\tОписаниеПакета.ИмяТаблицы  = ВременнаяТаблица.ПолноеИмя;\r\n\t\t\tОписаниеПакета.Данные      = ДанныеВременнойТаблицы;\r\n\t\t\tОписаниеПакета.ЕстьДанные  = Истина;\r\n\t\t\tОписаниеПакета.Тип = \"Таблица менеджера\";\r\n\t\t\t\r\n\t\t\tЗапрос.Текст = \"\";\r\n\t\t\tЗапрос.Параметры.Удалить(\"ВременнаяТаблица\");\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tДля Каждого КлючИЗначение Из ВходящийЗапрос.Параметры Цикл\r\n\t\tЗапрос.УстановитьПараметр(КлючИЗначение.Ключ, КлючИЗначение.Значение);\r\n\tКонецЦикла;\r\n\t\r\n\tСхемаЗапроса = Новый СхемаЗапроса;\r\n\tСхемаЗапроса.УстановитьТекстЗапроса(ВходящийЗапрос.Текст);\r\n\tДля Каждого ПакетЗапроса Из СхемаЗапроса.ПакетЗапросов Цикл\r\n\t\t\r\n\t\tОписаниеПакета = ДанныеПакетов.Добавить();\r\n\t\t\r\n\t\tЕсли ТипЗнч(ПакетЗапроса) = Тип(\"ЗапросУничтоженияТаблицыСхемыЗапроса\") Тогда\r\n\t\t\t\r\n\t\t\tЗапрос.Текст = \"УНИЧТОЖИТЬ \" + ПакетЗапроса.ИмяТаблицы;\r\n\t\t\tОписаниеПакета.ЕстьДанные  = Ложь;\r\n\t\t\tОписаниеПакета.ИмяТаблицы = Запрос.Текст;\r\n\t\t\tОписаниеПакета.Тип = \"Уничтожение\";\r\n\t\t\t\r\n\t\tИначе\r\n\t\t\t\r\n\t\t\tОписаниеПакета.ЕстьДанные  = Истина;\r\n\t\t\tЕсли ПустаяСтрока(ПакетЗапроса.ТаблицаДляПомещения) Тогда\r\n\t\t\t\tОписаниеПакета.Тип = \"Выборка\";\r\n\t\t\tИначе\r\n\t\t\t\tОписаниеПакета.Тип = \"Помещение\";\r\n\t\t\t\tСуществующийПакет  = ДанныеПакетов.Найти(ПакетЗапроса.ТаблицаДляПомещения, \"ИмяТаблицы\");\r\n\t\t\t\tЕсли СуществующийПакет <> Неопределено Тогда\r\n\t\t\t\t\tЗапрос.Текст = \"УНИЧТОЖИТЬ \" + ПакетЗапроса.ТаблицаДляПомещения;\r\n\t\t\t\t\tЗапрос.Выполнить();\r\n\t\t\t\t\tДанныеПакетов.Удалить(СуществующийПакет);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tОписаниеПакета.ИмяТаблицы = ПакетЗапроса.ТаблицаДляПомещения;\r\n\t\t\t\r\n\t\t\tЗапрос.Текст = ПакетЗапроса.ПолучитьТекстЗапроса();\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tНачалоЗамера    = ТекущаяУниверсальнаяДатаВМиллисекундах();\r\n\t\tРезультатЗапрос = Запрос.Выполнить();\r\n\t\tКонецЗамера     = ТекущаяУниверсальнаяДатаВМиллисекундах();\r\n\t\t\r\n\t\tОписаниеПакета.Данные       = ДанныеВременнойТаблицы;\r\n\t\tОписаниеПакета.Миллисекунды = КонецЗамера-НачалоЗамера;\r\n\t\t\r\n\t\tЕсли ОписаниеПакета.ЕстьДанные Тогда\r\n\t\t\tЕсли ОписаниеПакета.Тип = \"Выборка\" Тогда\r\n\t\t\t\tДанныеПакета = РезультатЗапрос.Выгрузить();\r\n\t\t\tИначе\r\n\t\t\t\tДанныеПакета = Запрос.МенеджерВременныхТаблиц.Таблицы.Найти(ОписаниеПакета.ИмяТаблицы).ПолучитьДанные().Выгрузить();\r\n\t\t\tКонецЕсли;\r\n\t\t\tОписаниеПакета.Данные = ДанныеПакета;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tДля НомерСтроки = 1 По ДанныеПакетов.Количество() Цикл\r\n\t\tОписаниеПакета = ДанныеПакетов[НомерСтроки-1];\r\n\t\tОписаниеПакета.НомерСтроки = НомерСтроки;\r\n\t\tЕсли ОписаниеПакета.ЕстьДанные Тогда\r\n\t\t\tОписаниеПакета.Записей = ОписаниеПакета.Данные.Количество();\r\n\t\t\tЕсли ОписаниеПакета.Записей = 0 Тогда\r\n\t\t\t\tОписаниеПакета.ЕстьДанные = Ложь;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат ДанныеПакетов;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Добавить или обновить колонку",
    "description": "Добавить или обновить колонку",
    "code_snippet": "// Добавляет новую колонку или обновляет существующую\r\n// Если колонка уже есть, то обновляет свойства Заголовок и Ширина\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/23\r\n// \r\n// Параметры:\r\n//  ТаблицаЗначений  - ТаблицаЗначений - Таблица значений, в которую нужно добавить колонку\r\n//  Имя              - Строка - Имя колонки\r\n//  Тип              - ОписаниеТипов, Неопределено - Объект, описывающий допустимые типы значений для колонки. \r\n//                 Если параметр не указан, в колонке можно будет хранить значение любого типа.\r\n//  Заголовок        - Строка, Неопределено - Заголовок колонки таблицы значений.\r\n//                 Используется при визуальном отображении таблицы значений.\r\n//  Ширина           - Число, Неопределено - Ширина колонки в символах.\r\n//                 Используется при визуальном отображении таблицы значений.\r\n//\r\n// Возвращаемое значение:\r\n//   КолонкаТаблицыЗначений - добавленная (или найденная) колонка \r\n//\r\n// Пример:\r\n// \tТЗ = Новая ТаблицаЗначений;\r\n// \tК1 = ОбновленнаяКолонкаТаблицы(ТЗ, \"К1\"); //ТЗ.Колонки.Количество() = 1\r\n// \tК2 = ОбновленнаяКолонкаТаблицы(ТЗ, \"К2\"); //ТЗ.Колонки.Количество() = 2\r\n// \tК1 = ОбновленнаяКолонкаТаблицы(ТЗ, \"К1\"); //ТЗ.Колонки.Количество() = 2\r\n//\r\nФункция ОбновленнаяКолонкаТаблицы(Знач ТаблицаЗначений, Знач Имя, \r\n\tЗнач Тип = Неопределено, Знач Заголовок = Неопределено, Знач Ширина = Неопределено) Экспорт\r\n\t\r\n\tКолонка\t= ТаблицаЗначений.Колонки.Найти(Имя);\r\n\tЕсли Колонка = Неопределено Тогда\r\n\t\tКолонка\t= ТаблицаЗначений.Колонки.Добавить(Имя, Тип);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли Заголовок <> Неопределено Тогда\r\n\t\tКолонка.Заголовок\t= Заголовок;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли Ширина <> Неопределено Тогда\r\n\t\tКолонка.Ширина\t= Ширина;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Колонка;\r\n\t\r\nКонецФункции\n\n// Добавляет новую колонку или обновляет существующую\r\n// Если колонка уже есть, то обновляет свойства Заголовок и Ширина\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/23\r\n// \r\n// Параметры:\r\n//  ТаблицаЗначений  - ТаблицаЗначений - Таблица значений, в которую нужно добавить колонку\r\n//  Имя              - Строка - Имя колонки\r\n//  Тип              - ОписаниеТипов, Неопределено - Объект, описывающий допустимые типы значений для колонки. \r\n//                 Если параметр не указан, в колонке можно будет хранить значение любого типа.\r\n//  Заголовок        - Строка, Неопределено - Заголовок колонки таблицы значений.\r\n//                 Используется при визуальном отображении таблицы значений.\r\n//  Ширина           - Число, Неопределено - Ширина колонки в символах.\r\n//                 Используется при визуальном отображении таблицы значений.\r\n//\r\n// Возвращаемое значение:\r\n//   КолонкаТаблицыЗначений - добавленная (или найденная) колонка \r\n//\r\n// Пример:\r\n// \tТЗ = Новая ТаблицаЗначений;\r\n// \tК1 = ОбновленнаяКолонкаТаблицы(ТЗ, \"К1\"); //ТЗ.Колонки.Количество() = 1\r\n// \tК2 = ОбновленнаяКолонкаТаблицы(ТЗ, \"К2\"); //ТЗ.Колонки.Количество() = 2\r\n// \tК1 = ОбновленнаяКолонкаТаблицы(ТЗ, \"К1\"); //ТЗ.Колонки.Количество() = 2\r\n//\r\nФункция ОбновленнаяКолонкаТаблицы(Знач ТаблицаЗначений, Знач Имя, \r\n\tЗнач Тип = Неопределено, Знач Заголовок = Неопределено, Знач Ширина = Неопределено) Экспорт\r\n\t\r\n\tКолонка\t= ТаблицаЗначений.Колонки.Найти(Имя);\r\n\tЕсли Колонка = Неопределено Тогда\r\n\t\tКолонка\t= ТаблицаЗначений.Колонки.Добавить(Имя, Тип);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли Заголовок <> Неопределено Тогда\r\n\t\tКолонка.Заголовок\t= Заголовок;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли Ширина <> Неопределено Тогда\r\n\t\tКолонка.Ширина\t= Ширина;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Колонка;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Добавить отбор построителя",
    "description": "Добавить отбор построителя",
    "code_snippet": "// Возвращает новый элемент отбора построителя\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/17\r\n// \r\n// Параметры:\r\n//  Построитель    - ПостроительЗапроса, ПостроительОтчета - Построитель, в которой необходимо добавить элемент отбора\r\n//  ПолеОтбора     - Строка - Имя поля отбора\r\n//  ЗначениеОтбора - Произвольный\r\n//                 - Массив из Произвольный\r\n//                 - ФиксированныйМассив из Произвольный\r\n//  ВидОтбора      - Строка, ВидСравнения - Вид сравнения отбор в виде строки\r\n//                 Если Неопределено, то для списков будет ВСписке, а для остальных Равно\r\n//\r\n// Возвращаемое значение:\r\n//   ЭлементОтбора\r\n//   \r\n// Пример:\r\n// \tЭлементОтбора = Построитель_ДобавитьОтбор(Построитель, \"Код\", \"123\");\r\n// \tЭлементОтбора = Построитель_ДобавитьОтбор(Построитель, \"Номер\", 1, \"Больше\");\r\n// \tЭлементОтбора = Построитель_ДобавитьОтбор(Построитель, \"Ссылка\", МассивСсылок);\r\n//   \r\nФункция Построитель_ДобавитьОтбор(Знач Построитель, Знач ПолеОтбора, Знач ЗначениеОтбора, Знач ВидОтбора = Неопределено) Экспорт\r\n\t\r\n    ЭлементОтбора = Построитель.Отбор.Добавить(ПолеОтбора);\r\n    ЭлементОтбора.Использование = Истина;\r\n\t\r\n\tЕсли ТипЗнч(ЗначениеОтбора) = Тип(\"Массив\") \r\n\t\tИЛИ ТипЗнч(ЗначениеОтбора) = Тип(\"ФиксированныйМассив\") Тогда\r\n\t\tУстанавливаемоеЗначение = Новый СписокЗначений; //СписокЗначений из Неопределено\r\n\t\tДля Каждого Значение Из ЗначениеОтбора Цикл\r\n\t\t\tУстанавливаемоеЗначение.Добавить(Значение);\r\n\t\tКонецЦикла;\r\n\t\tЭтоСписок = Истина;\r\n\tИначе\r\n\t\t УстанавливаемоеЗначение = ЗначениеОтбора; //@skip-check statement-type-change\r\n\t\t ЭтоСписок = (ТипЗнч(ЗначениеОтбора) = Тип(\"СписокЗначений\"));\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ВидОтбора = Неопределено Тогда\r\n\t\tЭлементОтбора.ВидСравнения = ?(ЭтоСписок, ВидСравнения.ВСписке, ВидСравнения.Равно);\r\n\tИначеЕсли ТипЗнч(ВидОтбора) = Тип(\"ВидСравнения\") Тогда\r\n\t\tЭлементОтбора.ВидСравнения = ВидОтбора;\r\n\tИначе\r\n\t\tЭлементОтбора.ВидСравнения = ВидСравнения[Строка(ВидОтбора)]; //@skip-check statement-type-change\r\n\tКонецЕсли;\r\n\t\r\n\tЭлементОтбора.Значение = УстанавливаемоеЗначение;\r\n\t\r\n\tВозврат ЭлементОтбора;\r\n\t\r\nКонецФункции\n\n// Возвращает новый элемент отбора построителя\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/17\r\n// \r\n// Параметры:\r\n//  Построитель    - ПостроительЗапроса, ПостроительОтчета - Построитель, в которой необходимо добавить элемент отбора\r\n//  ПолеОтбора     - Строка - Имя поля отбора\r\n//  ЗначениеОтбора - Произвольный\r\n//                 - Массив из Произвольный\r\n//                 - ФиксированныйМассив из Произвольный\r\n//  ВидОтбора      - Строка, ВидСравнения - Вид сравнения отбор в виде строки\r\n//                 Если Неопределено, то для списков будет ВСписке, а для остальных Равно\r\n//\r\n// Возвращаемое значение:\r\n//   ЭлементОтбора\r\n//   \r\n// Пример:\r\n// \tЭлементОтбора = Построитель_ДобавитьОтбор(Построитель, \"Код\", \"123\");\r\n// \tЭлементОтбора = Построитель_ДобавитьОтбор(Построитель, \"Номер\", 1, \"Больше\");\r\n// \tЭлементОтбора = Построитель_ДобавитьОтбор(Построитель, \"Ссылка\", МассивСсылок);\r\n//   \r\nФункция Построитель_ДобавитьОтбор(Знач Построитель, Знач ПолеОтбора, Знач ЗначениеОтбора, Знач ВидОтбора = Неопределено) Экспорт\r\n\t\r\n    ЭлементОтбора = Построитель.Отбор.Добавить(ПолеОтбора);\r\n    ЭлементОтбора.Использование = Истина;\r\n\t\r\n\tЕсли ТипЗнч(ЗначениеОтбора) = Тип(\"Массив\") \r\n\t\tИЛИ ТипЗнч(ЗначениеОтбора) = Тип(\"ФиксированныйМассив\") Тогда\r\n\t\tУстанавливаемоеЗначение = Новый СписокЗначений; //СписокЗначений из Неопределено\r\n\t\tДля Каждого Значение Из ЗначениеОтбора Цикл\r\n\t\t\tУстанавливаемоеЗначение.Добавить(Значение);\r\n\t\tКонецЦикла;\r\n\t\tЭтоСписок = Истина;\r\n\tИначе\r\n\t\t УстанавливаемоеЗначение = ЗначениеОтбора; //@skip-check statement-type-change\r\n\t\t ЭтоСписок = (ТипЗнч(ЗначениеОтбора) = Тип(\"СписокЗначений\"));\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ВидОтбора = Неопределено Тогда\r\n\t\tЭлементОтбора.ВидСравнения = ?(ЭтоСписок, ВидСравнения.ВСписке, ВидСравнения.Равно);\r\n\tИначеЕсли ТипЗнч(ВидОтбора) = Тип(\"ВидСравнения\") Тогда\r\n\t\tЭлементОтбора.ВидСравнения = ВидОтбора;\r\n\tИначе\r\n\t\tЭлементОтбора.ВидСравнения = ВидСравнения[Строка(ВидОтбора)]; //@skip-check statement-type-change\r\n\tКонецЕсли;\r\n\t\r\n\tЭлементОтбора.Значение = УстанавливаемоеЗначение;\r\n\t\r\n\tВозврат ЭлементОтбора;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Свернуть табличную часть",
    "description": "Свернуть табличную часть",
    "code_snippet": "// Сворачивает табличную часть по всем колонкам (Числовые колонки при этом суммируются). \r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/22\r\n//\r\n// Параметры:\r\n//  ТабличнаяЧасть - ТабличнаяЧасть - ТЧ объекта, которую нужно свернуть\r\n//\r\n// Пример:\r\n// \tСвернутьТабличнуюЧасть(ЭтотОбъект.ТабличнаяЧасть);\r\n// \t//Строки свернуться по значениям колонок, числовые при этом просуммируются\r\n//\r\nПроцедура СвернутьТабличнуюЧасть(Знач ТабличнаяЧасть) Экспорт\r\n\t\r\n\tРесурсы = Новый Массив; // Массив из Строка\r\n\tИзмерения = Новый Массив; // Массив из Строка\r\n\t\r\n\tМетаданныеТабличнойЧасти = Метаданные.НайтиПоТипу(ТипЗнч(ТабличнаяЧасть)); // ОбъектМетаданныхТабличнаяЧасть\r\n\tДля Каждого МетаданныеКолонки Из МетаданныеТабличнойЧасти.Реквизиты Цикл\r\n\t\tИмяКолонки = МетаданныеКолонки.Имя;\r\n\t\tЕсли МетаданныеКолонки.Тип.СодержитТип(Тип(\"Число\")) Тогда\r\n\t\t\tРесурсы.Добавить(ИмяКолонки);\r\n\t\tИначе\r\n\t\t\tИзмерения.Добавить(ИмяКолонки);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tИменаИзмерений = СтрСоединить(Измерения, \",\");\r\n\tИменаРесурсов = СтрСоединить(Ресурсы, \",\");\r\n\t\r\n\tТабличнаяЧасть.Свернуть(ИменаИзмерений, ИменаРесурсов);\r\n\t\r\nКонецПроцедуры\n\n// Сворачивает табличную часть по всем колонкам (Числовые колонки при этом суммируются). \r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/22\r\n//\r\n// Параметры:\r\n//  ТабличнаяЧасть - ТабличнаяЧасть - ТЧ объекта, которую нужно свернуть\r\n//\r\n// Пример:\r\n// \tСвернутьТабличнуюЧасть(ЭтотОбъект.ТабличнаяЧасть);\r\n// \t//Строки свернуться по значениям колонок, числовые при этом просуммируются\r\n//\r\nПроцедура СвернутьТабличнуюЧасть(Знач ТабличнаяЧасть) Экспорт\r\n\t\r\n\tРесурсы = Новый Массив; // Массив из Строка\r\n\tИзмерения = Новый Массив; // Массив из Строка\r\n\t\r\n\tМетаданныеТабличнойЧасти = Метаданные.НайтиПоТипу(ТипЗнч(ТабличнаяЧасть)); // ОбъектМетаданныхТабличнаяЧасть\r\n\tДля Каждого МетаданныеКолонки Из МетаданныеТабличнойЧасти.Реквизиты Цикл\r\n\t\tИмяКолонки = МетаданныеКолонки.Имя;\r\n\t\tЕсли МетаданныеКолонки.Тип.СодержитТип(Тип(\"Число\")) Тогда\r\n\t\t\tРесурсы.Добавить(ИмяКолонки);\r\n\t\tИначе\r\n\t\t\tИзмерения.Добавить(ИмяКолонки);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tИменаИзмерений = СтрСоединить(Измерения, \",\");\r\n\tИменаРесурсов = СтрСоединить(Ресурсы, \",\");\r\n\t\r\n\tТабличнаяЧасть.Свернуть(ИменаИзмерений, ИменаРесурсов);\r\n\t\r\nКонецПроцедуры\n\nОрфографическая ошибка в просуммируются: просуммируются"
  },
  {
    "title": "Таблица значений по полному имени метаданных",
    "description": "Таблица значений по полному имени метаданных",
    "code_snippet": "// Возвращает описание таблицы значений по полному имени таблицы базы данных\r\n// Например \"Справочник.Валюты\" или \"РегистрСведений.КурсыВалют\"\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/21\r\n//\r\n// Параметры:\r\n//  ПолноеИмя  - Строка - Полное имя таблицы базы данных\r\n//\r\n// Возвращаемое значение:\r\n//   ТаблицаЗначений\r\n//\r\nФункция СтруктураТаблицыБазы(Знач ПолноеИмя) Экспорт\r\n\t\r\n\tТекстЗапроса = СтрШаблон(\"ВЫБРАТЬ ПЕРВЫЕ 0 * ИЗ %1\", ПолноеИмя);\r\n\tСхемаЗапроса = Новый СхемаЗапроса();\r\n\tСхемаЗапроса.УстановитьТекстЗапроса(ТекстЗапроса);\r\n\t\r\n\tРезультат = Новый ТаблицаЗначений();\r\n\tДля Каждого Колонка Из СхемаЗапроса.ПакетЗапросов.Получить(0).Колонки Цикл\r\n\t\t\r\n\t\tВременнаяСтруктура = Новый Структура(\"Колонки\", Неопределено);\r\n\t\tЗаполнитьЗначенияСвойств(ВременнаяСтруктура, Колонка);\r\n\t\tЕсли ЗначениеЗаполнено(ВременнаяСтруктура.Колонки) Тогда\r\n\t\t\tТипЗначения = Новый ОписаниеТипов(\"ТаблицаЗначений\");\r\n\t\tИначе\r\n\t\t\tТипЗначения = Колонка.ТипЗначения;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tРезультат.Колонки.Добавить(Колонка.Псевдоним, ТипЗначения);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\n// Возвращает описание таблицы значений по полному имени таблицы базы данных\r\n// Например \"Справочник.Валюты\" или \"РегистрСведений.КурсыВалют\"\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/21\r\n//\r\n// Параметры:\r\n//  ПолноеИмя  - Строка - Полное имя таблицы базы данных\r\n//\r\n// Возвращаемое значение:\r\n//   ТаблицаЗначений\r\n//\r\nФункция СтруктураТаблицыБазы(Знач ПолноеИмя) Экспорт\r\n\t\r\n\tТекстЗапроса = СтрШаблон(\"ВЫБРАТЬ ПЕРВЫЕ 0 * ИЗ %1\", ПолноеИмя);\r\n\tСхемаЗапроса = Новый СхемаЗапроса();\r\n\tСхемаЗапроса.УстановитьТекстЗапроса(ТекстЗапроса);\r\n\t\r\n\tРезультат = Новый ТаблицаЗначений();\r\n\tДля Каждого Колонка Из СхемаЗапроса.ПакетЗапросов.Получить(0).Колонки Цикл\r\n\t\t\r\n\t\tВременнаяСтруктура = Новый Структура(\"Колонки\", Неопределено);\r\n\t\tЗаполнитьЗначенияСвойств(ВременнаяСтруктура, Колонка);\r\n\t\tЕсли ЗначениеЗаполнено(ВременнаяСтруктура.Колонки) Тогда\r\n\t\t\tТипЗначения = Новый ОписаниеТипов(\"ТаблицаЗначений\");\r\n\t\tИначе\r\n\t\t\tТипЗначения = Колонка.ТипЗначения;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tРезультат.Колонки.Добавить(Колонка.Псевдоним, ТипЗначения);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Этот тип является менеджером записи регистра сведений",
    "description": "Этот тип является менеджером записи регистра сведений",
    "code_snippet": "// Является ли переданный тип менеджером записи регистра сведений\r\n// К сожалению, либо этот вариант, либо тупо проверка представления типа\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/25\r\n// \r\n// Параметры:\r\n//  ТипЗначения - Тип\r\n//\r\n// Возвращаемое значение:\r\n//   Булево\r\nФункция ЭтоМенеджерЗаписиРегистраСведений(Знач ТипЗначения) Экспорт\r\n    \r\n    ОбъектМетаданных = Метаданные.НайтиПоТипу(ТипЗначения);\r\n\tЕсли ТипЗнч(ОбъектМетаданных) = Тип(\"ОбъектМетаданных\") И Метаданные.РегистрыСведений.Содержит(ОбъектМетаданных) Тогда\r\n\t\tТипМенеджераЗаписи = Тип(\"РегистрСведенийМенеджерЗаписи.\" + ОбъектМетаданных.Имя);\r\n        ЭтоМенеджерЗаписи  = (ТипМенеджераЗаписи = ТипЗначения);\r\n    Иначе\r\n        ЭтоМенеджерЗаписи  = Ложь;\r\n    КонецЕсли;\r\n    \r\n    Возврат ЭтоМенеджерЗаписи;\r\n    \r\nКонецФункции\n\n// Является ли переданный тип менеджером записи регистра сведений\r\n// К сожалению, либо этот вариант, либо тупо проверка представления типа\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/25\r\n// \r\n// Параметры:\r\n//  ТипЗначения - Тип\r\n//\r\n// Возвращаемое значение:\r\n//   Булево\r\nФункция ЭтоМенеджерЗаписиРегистраСведений(Знач ТипЗначения) Экспорт\r\n    \r\n    ОбъектМетаданных = Метаданные.НайтиПоТипу(ТипЗначения);\r\n\tЕсли ТипЗнч(ОбъектМетаданных) = Тип(\"ОбъектМетаданных\") И Метаданные.РегистрыСведений.Содержит(ОбъектМетаданных) Тогда\r\n\t\tТипМенеджераЗаписи = Тип(\"РегистрСведенийМенеджерЗаписи.\" + ОбъектМетаданных.Имя);\r\n        ЭтоМенеджерЗаписи  = (ТипМенеджераЗаписи = ТипЗначения);\r\n    Иначе\r\n        ЭтоМенеджерЗаписи  = Ложь;\r\n    КонецЕсли;\r\n    \r\n    Возврат ЭтоМенеджерЗаписи;\r\n    \r\nКонецФункции\n\nВозврат ?( НЕ Метаданные.РегистрыСведений.Содержит(Метаданные.НайтиПоТипу(ТипЗначения)), Ложь\n, ЭтоМенеджерЗаписи = (Тип(\"РегистрСведенийМенеджерЗаписи.\" + Метаданные.НайтиПоТипу(ТипЗначения).Имя) = ТипЗначения) );"
  },
  {
    "title": "Таблица Значений Без Null",
    "description": "Таблица Значений Без Null",
    "code_snippet": "// Функция возвращает копию переданной таблицы значений, но исключая из всех колонок тип Null\r\n// Бывает полезна для обработки выгрузки запроса, в котором у каждой колонки есть тип Null\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/24\r\n// \r\n// Параметры:\r\n//  ТаблицаЗначений - ТаблицаЗначений\r\n//\r\n// Возвращаемое значение:\r\n//   ТаблицаЗначений - Таблица без Null\r\n//\r\n// Пример:\r\n// \tВыгрузкаЗапроса = Запрос.Выполнить().Выгрузить(); //Все колонки содержат тип Null\r\n// \tВыгрузкаБезNull = ТаблицаЗначенийБезNull(ВыгрузкаЗапроса); //Колонки без типа Null\r\n//\r\nФункция ТаблицаЗначенийБезNull(Знач ТаблицаЗначений) Экспорт\r\n\t\r\n\tНоваяТаблица = Новый ТаблицаЗначений;\r\n\tДля Каждого ТекущаяКолонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tОписаниеТипа = Новый ОписаниеТипов(ТекущаяКолонка.ТипЗначения, , \"NULL\");\r\n        НоваяТаблица.Колонки.Добавить(ТекущаяКолонка.Имя, ОписаниеТипа,\r\n\t\t\tТекущаяКолонка.Заголовок, ТекущаяКолонка.Ширина);\r\n    КонецЦикла;\r\n\t\r\n\tДля Каждого ТекущаяСтрока Из ТаблицаЗначений Цикл\r\n        ЗаполнитьЗначенияСвойств(НоваяТаблица.Добавить(), ТекущаяСтрока);\r\n    КонецЦикла;\r\n    \r\n    Возврат НоваяТаблица;\r\n\r\nКонецФункции\n\n// Функция возвращает копию переданной таблицы значений, но исключая из всех колонок тип Null\r\n// Бывает полезна для обработки выгрузки запроса, в котором у каждой колонки есть тип Null\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/24\r\n// \r\n// Параметры:\r\n//  ТаблицаЗначений - ТаблицаЗначений\r\n//\r\n// Возвращаемое значение:\r\n//   ТаблицаЗначений - Таблица без Null\r\n//\r\n// Пример:\r\n// \tВыгрузкаЗапроса = Запрос.Выполнить().Выгрузить(); //Все колонки содержат тип Null\r\n// \tВыгрузкаБезNull = ТаблицаЗначенийБезNull(ВыгрузкаЗапроса); //Колонки без типа Null\r\n//\r\nФункция ТаблицаЗначенийБезNull(Знач ТаблицаЗначений) Экспорт\r\n\t\r\n\tНоваяТаблица = Новый ТаблицаЗначений;\r\n\tДля Каждого ТекущаяКолонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tОписаниеТипа = Новый ОписаниеТипов(ТекущаяКолонка.ТипЗначения, , \"NULL\");\r\n        НоваяТаблица.Колонки.Добавить(ТекущаяКолонка.Имя, ОписаниеТипа,\r\n\t\t\tТекущаяКолонка.Заголовок, ТекущаяКолонка.Ширина);\r\n    КонецЦикла;\r\n\t\r\n\tДля Каждого ТекущаяСтрока Из ТаблицаЗначений Цикл\r\n        ЗаполнитьЗначенияСвойств(НоваяТаблица.Добавить(), ТекущаяСтрока);\r\n    КонецЦикла;\r\n    \r\n    Возврат НоваяТаблица;\r\n\r\nКонецФункции"
  },
  {
    "title": "Пустое значение типа (Новый Объект)",
    "description": "Пустое значение типа (Новый Объект)",
    "code_snippet": "// Возвращает новый объект переданного типа.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/20\r\n//  \r\n// Параметры:\r\n//  Тип - Строка, Тип - Тип или имя типа\r\n// \r\n// Возвращаемое значение:\r\n//  Произвольный\r\n//\r\n// Примеры:\r\n// \tРезультат = НовыйОбъект(\"Структура\");\r\n// \tРезультат = НовыйОбъект(\"УсловноеОформлениеКомпоновкиДанных\");\r\n// \tРезультат = НовыйОбъект(\"HTTPОтвет\");\r\n//\r\nФункция НовыйОбъект(Знач Тип) Экспорт\r\n\t\r\n\tТипы = Неопределено;\r\n\tЕсли ТипЗнч(Тип) = Тип(\"Тип\") Тогда\r\n\t\tТипы = Новый Массив; // Массив из Тип\r\n\t\tТипы.Добавить(Тип);\r\n\tИначе\r\n\t\tТипы = Тип;\r\n\tКонецЕсли;\r\n\t\r\n\tОписаниеТипа = Новый ОписаниеТипов(Типы);\r\n\t\r\n\tВозврат ОписаниеТипа.ПривестиЗначение();\r\n\t\r\nКонецФункции\n\n// Возвращает новый объект переданного типа.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/20\r\n//  \r\n// Параметры:\r\n//  Тип - Строка, Тип - Тип или имя типа\r\n// \r\n// Возвращаемое значение:\r\n//  Произвольный\r\n//\r\n// Примеры:\r\n// \tРезультат = НовыйОбъект(\"Структура\");\r\n// \tРезультат = НовыйОбъект(\"УсловноеОформлениеКомпоновкиДанных\");\r\n// \tРезультат = НовыйОбъект(\"HTTPОтвет\");\r\n//\r\nФункция НовыйОбъект(Знач Тип) Экспорт\r\n\t\r\n\tТипы = Неопределено;\r\n\tЕсли ТипЗнч(Тип) = Тип(\"Тип\") Тогда\r\n\t\tТипы = Новый Массив; // Массив из Тип\r\n\t\tТипы.Добавить(Тип);\r\n\tИначе\r\n\t\tТипы = Тип;\r\n\tКонецЕсли;\r\n\t\r\n\tОписаниеТипа = Новый ОписаниеТипов(Типы);\r\n\t\r\n\tВозврат ОписаниеТипа.ПривестиЗначение();\r\n\t\r\nКонецФункции"
  },
  {
    "title": "В Конфигураторе, между редактором формы и текстом модуля, можно быстро переключаться без помощи мыши",
    "description": "В Конфигураторе, между редактором формы и текстом модуля, можно быстро переключаться без помощи мышиЛайфхаки 1С",
    "code_snippet": ""
  },
  {
    "title": "Обслуживание ИБ на PostgreSQL с использованием 1С-Обновлятора",
    "description": "Обслуживание ИБ на PostgreSQL с использованием 1С-ОбновлятораБубен админа",
    "code_snippet": ""
  },
  {
    "title": "Дополнительное документирование модулей",
    "description": "Тегами, подобными DoxyGen документируем модуль, получаем подсказку во время разработки.",
    "code_snippet": ""
  },
  {
    "title": "Чтение параметров http-запроса в формате x-www-form-urlencoded в соответствие",
    "description": "Чтение параметров http-запроса в формате x-www-form-urlencoded в соответствие",
    "code_snippet": "Функция ПолучитьПараметрыКакСоответствие(Тело)Экспорт\r\n\t\r\n\tРезультат = Новый Соответствие;\r\n\tТело = РаскодироватьСтроку(Тело, СпособКодированияСтроки.КодировкаURL, \"UTF-8\");\r\n\tТело = СтрЗаменить(Тело, \"+\", \" \");\r\n\tПарметрыЗначения = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Тело, \"&\");\r\n\tДля Каждого Пар Из ПарметрыЗначения Цикл\r\n\t\tмПар = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Пар, \"=\");\r\n\t\tЕсли мПар.Количество() > 1 Тогда\r\n\t\t\tСущЗначениеПараметра = Результат.Получить(мПар[0]);\r\n\t\t\t\r\n\t\t\t//Если в структуре нет такого параметра, просто его добавляем.\r\n\t\t\tЕсли СущЗначениеПараметра = Неопределено Тогда \r\n\t\t\t\tРезультат.Вставить(мПар[0], мПар[1]);\r\n\t\t\tИначе\r\n\t\t\t\t//Если такой параметр есть и значени его находится в массиве, то добавляем\r\n\t\t\t\t//текущий параметр в массив.\r\n\t\t\t\tЕсли ТипЗнч(СущЗначениеПараметра) = Тип(\"Массив\") Тогда \r\n\t\t\t\t\tСущЗначениеПараметра.Добавить(мПар[1]);\r\n\t\t\t\t\tРезультат.Вставить(мПар[0], СущЗначениеПараметра);\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Если это второе значение параметра, то добавляем уже существующее и текущее\r\n\t\t\t\t\t//значение в массив.\t\r\n\t\t\t\tИначе \r\n\t\t\t\t\tМассивЗначЭтогоПараметра = Новый Массив();\r\n\t\t\t\t\tМассивЗначЭтогоПараметра.Добавить(СущЗначениеПараметра);\r\n\t\t\t\t\tМассивЗначЭтогоПараметра.Добавить(мПар[1]);\r\n\t\t\t\t\tРезультат.Вставить(мПар[0], МассивЗначЭтогоПараметра);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nФункция ПолучитьПараметрыКакСоответствие(Тело)Экспорт\r\n\t\r\n\tРезультат = Новый Соответствие;\r\n\tТело = РаскодироватьСтроку(Тело, СпособКодированияСтроки.КодировкаURL, \"UTF-8\");\r\n\tТело = СтрЗаменить(Тело, \"+\", \" \");\r\n\tПарметрыЗначения = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Тело, \"&\");\r\n\tДля Каждого Пар Из ПарметрыЗначения Цикл\r\n\t\tмПар = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Пар, \"=\");\r\n\t\tЕсли мПар.Количество() > 1 Тогда\r\n\t\t\tСущЗначениеПараметра = Результат.Получить(мПар[0]);\r\n\t\t\t\r\n\t\t\t//Если в структуре нет такого параметра, просто его добавляем.\r\n\t\t\tЕсли СущЗначениеПараметра = Неопределено Тогда \r\n\t\t\t\tРезультат.Вставить(мПар[0], мПар[1]);\r\n\t\t\tИначе\r\n\t\t\t\t//Если такой параметр есть и значени его находится в массиве, то добавляем\r\n\t\t\t\t//текущий параметр в массив.\r\n\t\t\t\tЕсли ТипЗнч(СущЗначениеПараметра) = Тип(\"Массив\") Тогда \r\n\t\t\t\t\tСущЗначениеПараметра.Добавить(мПар[1]);\r\n\t\t\t\t\tРезультат.Вставить(мПар[0], СущЗначениеПараметра);\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Если это второе значение параметра, то добавляем уже существующее и текущее\r\n\t\t\t\t\t//значение в массив.\t\r\n\t\t\t\tИначе \r\n\t\t\t\t\tМассивЗначЭтогоПараметра = Новый Массив();\r\n\t\t\t\t\tМассивЗначЭтогоПараметра.Добавить(СущЗначениеПараметра);\r\n\t\t\t\t\tМассивЗначЭтогоПараметра.Добавить(мПар[1]);\r\n\t\t\t\t\tРезультат.Вставить(мПар[0], МассивЗначЭтогоПараметра);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в ПарметрыЗначения (найдено 2): Парметры\r\nОрфографическая ошибка в значени: значени"
  },
  {
    "title": "Чтение параметров http-запроса в формате x-www-form-urlencoded в структуру",
    "description": "Чтение параметров http-запроса в формате x-www-form-urlencoded в структуру",
    "code_snippet": "Функция ПолучитьПараметры(Тело)Экспорт\r\n\t\r\n\tРезультат = Новый Структура;\r\n\tТело = РаскодироватьСтроку(Тело, СпособКодированияСтроки.КодировкаURL, \"UTF-8\");\r\n\tТело = СтрЗаменить(Тело, \"+\", \" \");\r\n\tПарметрыЗначения = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Тело, \"&\");\r\n\tДля Каждого Пар Из ПарметрыЗначения Цикл\r\n\t\t\r\n\t\tмПар = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Пар, \"=\");\r\n\t\tЕсли мПар.Количество() > 1 Тогда\r\n\t\t\tСущЗначениеПараметра = \"\";\r\n\t\t\t\r\n\t\t\tПопытка\r\n\t\t\t\tРезультат.Свойство(мПар[0], СущЗначениеПараметра);\r\n\t\t\tИсключение\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецПопытки;\r\n\t\t\t\r\n\t\t\t//Если в структуре нет такого параметра, просто его добавляем.\r\n\t\t\tЕсли ПустаяСтрока(СущЗначениеПараметра) Тогда \r\n\t\t\t\tРезультат.Вставить(мПар[0], мПар[1]);\r\n\t\t\tИначе\r\n\t\t\t\t\r\n\t\t\t\t//Если такой параметр есть и значени его находится в массиве, то добавляем\r\n\t\t\t\t//текущий параметр в массив.\r\n\t\t\t\tЕсли ТипЗнч(СущЗначениеПараметра) = Тип(\"Массив\") Тогда \r\n\t\t\t\t\tСущЗначениеПараметра.Добавить(мПар[1]);\r\n\t\t\t\t\tРезультат.Вставить(мПар[0], СущЗначениеПараметра);\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Если это второе значение параметра, то добавляем уже существующее и текущее\r\n\t\t\t\t\t//значение в массив.\t\r\n\t\t\t\tИначе \r\n\t\t\t\t\tМассивЗначЭтогоПараметра = Новый Массив();\r\n\t\t\t\t\tМассивЗначЭтогоПараметра.Добавить(СущЗначениеПараметра);\r\n\t\t\t\t\tМассивЗначЭтогоПараметра.Добавить(мПар[1]);\r\n\t\t\t\t\tРезультат.Вставить(мПар[0], МассивЗначЭтогоПараметра);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\tИначеЕсли мПар.Количество() = 1 Тогда\r\n\t\t\tЕсли Не Результат.Свойство(мПар[0]) Тогда\r\n\t\t\t\tРезультат.Вставить(мПар[0], \"\");\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nФункция ПолучитьПараметры(Тело)Экспорт\r\n\t\r\n\tРезультат = Новый Структура;\r\n\tТело = РаскодироватьСтроку(Тело, СпособКодированияСтроки.КодировкаURL, \"UTF-8\");\r\n\tТело = СтрЗаменить(Тело, \"+\", \" \");\r\n\tПарметрыЗначения = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Тело, \"&\");\r\n\tДля Каждого Пар Из ПарметрыЗначения Цикл\r\n\t\t\r\n\t\tмПар = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Пар, \"=\");\r\n\t\tЕсли мПар.Количество() > 1 Тогда\r\n\t\t\tСущЗначениеПараметра = \"\";\r\n\t\t\t\r\n\t\t\tПопытка\r\n\t\t\t\tРезультат.Свойство(мПар[0], СущЗначениеПараметра);\r\n\t\t\tИсключение\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецПопытки;\r\n\t\t\t\r\n\t\t\t//Если в структуре нет такого параметра, просто его добавляем.\r\n\t\t\tЕсли ПустаяСтрока(СущЗначениеПараметра) Тогда \r\n\t\t\t\tРезультат.Вставить(мПар[0], мПар[1]);\r\n\t\t\tИначе\r\n\t\t\t\t\r\n\t\t\t\t//Если такой параметр есть и значени его находится в массиве, то добавляем\r\n\t\t\t\t//текущий параметр в массив.\r\n\t\t\t\tЕсли ТипЗнч(СущЗначениеПараметра) = Тип(\"Массив\") Тогда \r\n\t\t\t\t\tСущЗначениеПараметра.Добавить(мПар[1]);\r\n\t\t\t\t\tРезультат.Вставить(мПар[0], СущЗначениеПараметра);\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Если это второе значение параметра, то добавляем уже существующее и текущее\r\n\t\t\t\t\t//значение в массив.\t\r\n\t\t\t\tИначе \r\n\t\t\t\t\tМассивЗначЭтогоПараметра = Новый Массив();\r\n\t\t\t\t\tМассивЗначЭтогоПараметра.Добавить(СущЗначениеПараметра);\r\n\t\t\t\t\tМассивЗначЭтогоПараметра.Добавить(мПар[1]);\r\n\t\t\t\t\tРезультат.Вставить(мПар[0], МассивЗначЭтогоПараметра);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\tИначеЕсли мПар.Количество() = 1 Тогда\r\n\t\t\tЕсли Не Результат.Свойство(мПар[0]) Тогда\r\n\t\t\t\tРезультат.Вставить(мПар[0], \"\");\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в urlencoded: urlencoded\r\nОрфографическая ошибка в РаскодироватьСтроку: Раскодировать\r\nОрфографическая ошибка в ПарметрыЗначения (найдено 2): Парметры\r\nОрфографическая ошибка в значени: значени"
  },
  {
    "title": "Для веб-сервера IIS можно использовать бесплатные SSL сертификаты Let's Encrypt с автоматическим обновлением",
    "description": "Для веб-сервера IIS можно использовать бесплатные SSL сертификаты Let's Encrypt с автоматическим обновлениемБубен админа",
    "code_snippet": ""
  },
  {
    "title": "Разбить число на Кусочки",
    "description": "Разбить число на Кусочки",
    "code_snippet": "Функция РазбитьНаКусочки(ОбщееКоличество, ОднаЧасть) Экспорт\r\n\tЧастей = Цел(ОбщееКоличество / ОднаЧасть) + ?(ОбщееКоличество % ОднаЧасть > 0, 1, 0);\r\n\r\n\tЧастное = ОбщееКоличество / Частей;\r\n\tМаксКусок = Цел(Частное) + ?(ОбщееКоличество % Частей > 0, 1, 0);\r\n\tОстаток = ОбщееКоличество % МаксКусок;\r\n\r\n\tМассив = Новый Массив;\r\n\r\n\tЕсли Остаток > 0 Тогда\r\n\t\tОдинКусок = МаксКусок - 1;\r\n\t\tМеньшегоКолва = МаксКусок - Остаток;\r\n\t\tДля ъ = 1 по МеньшегоКолва Цикл\r\n\t\t\tМассив.Добавить(ОдинКусок);\r\n\t\tКонецЦикла;\r\n\tИначе\r\n\t\tъ = 1;\r\n\tКонецЕсли;\r\n\r\n\tОдинКусок = МаксКусок;\r\n\tъъ = ъ;\r\n\tДля ъ = ъъ по Частей Цикл\r\n\t\tМассив.Вставить(0, ОдинКусок);\r\n\tКонецЦикла;\r\n\r\n//\tВсегоВМассиве = 0;\r\n//\tДля Каждого Элем из Массив Цикл\r\n//\t\tВсегоВМассиве = ВсегоВМассиве + Элем;\r\n//\tКонецЦикла;\r\n\r\n\tВозврат Массив;\r\nКонецФункции  // РазбитьНаКусочки\r\n\r\nФункция РазбитьСписокТоваров(Знач списТоваров, МаксТоваров = 150)\r\n\t#Если Сервер И Не Сервер Тогда  // для типизации в конфигураторе\r\n\t\tсписТоваров = Новый СписокЗначений;\r\n\t#КонецЕсли\r\n\r\n\tмТовары = списТоваров.ВыгрузитьЗначения();\r\n\r\n\tКоличествоТоваров = мТовары.Количество();\r\n\tмКусочки = РазбитьНаКусочки(КоличествоТоваров, МаксТоваров);\r\n\r\n\tммТовары = Новый Массив;\r\n\tДля Каждого ЧислоТоваров Из мКусочки Цикл\r\n\t\tмПодСписок = Новый Массив;\r\n\t\tДля ъ = 1 По ЧислоТоваров Цикл\r\n\t\t\tмПодСписок.Добавить(мТовары[0]);\r\n\t\t\tмТовары.Удалить(0);\r\n\t\tКонецЦикла;\r\n\r\n\t\tммТовары.Добавить(мПодСписок);\r\n\tКонецЦикла;\r\n\r\n\tВозврат ммТовары;\r\nКонецФункции  // РазбитьСписокТоваров\n\nФункция РазбитьНаКусочки(ОбщееКоличество, ОднаЧасть) Экспорт\r\n\tЧастей = Цел(ОбщееКоличество / ОднаЧасть) + ?(ОбщееКоличество % ОднаЧасть > 0, 1, 0);\r\n\r\n\tЧастное = ОбщееКоличество / Частей;\r\n\tМаксКусок = Цел(Частное) + ?(ОбщееКоличество % Частей > 0, 1, 0);\r\n\tОстаток = ОбщееКоличество % МаксКусок;\r\n\r\n\tМассив = Новый Массив;\r\n\r\n\tЕсли Остаток > 0 Тогда\r\n\t\tОдинКусок = МаксКусок - 1;\r\n\t\tМеньшегоКолва = МаксКусок - Остаток;\r\n\t\tДля ъ = 1 по МеньшегоКолва Цикл\r\n\t\t\tМассив.Добавить(ОдинКусок);\r\n\t\tКонецЦикла;\r\n\tИначе\r\n\t\tъ = 1;\r\n\tКонецЕсли;\r\n\r\n\tОдинКусок = МаксКусок;\r\n\tъъ = ъ;\r\n\tДля ъ = ъъ по Частей Цикл\r\n\t\tМассив.Вставить(0, ОдинКусок);\r\n\tКонецЦикла;\r\n\r\n//\tВсегоВМассиве = 0;\r\n//\tДля Каждого Элем из Массив Цикл\r\n//\t\tВсегоВМассиве = ВсегоВМассиве + Элем;\r\n//\tКонецЦикла;\r\n\r\n\tВозврат Массив;\r\nКонецФункции  // РазбитьНаКусочки\r\n\r\nФункция РазбитьСписокТоваров(Знач списТоваров, МаксТоваров = 150)\r\n\t#Если Сервер И Не Сервер Тогда  // для типизации в конфигураторе\r\n\t\tсписТоваров = Новый СписокЗначений;\r\n\t#КонецЕсли\r\n\r\n\tмТовары = списТоваров.ВыгрузитьЗначения();\r\n\r\n\tКоличествоТоваров = мТовары.Количество();\r\n\tмКусочки = РазбитьНаКусочки(КоличествоТоваров, МаксТоваров);\r\n\r\n\tммТовары = Новый Массив;\r\n\tДля Каждого ЧислоТоваров Из мКусочки Цикл\r\n\t\tмПодСписок = Новый Массив;\r\n\t\tДля ъ = 1 По ЧислоТоваров Цикл\r\n\t\t\tмПодСписок.Добавить(мТовары[0]);\r\n\t\t\tмТовары.Удалить(0);\r\n\t\tКонецЦикла;\r\n\r\n\t\tммТовары.Добавить(мПодСписок);\r\n\tКонецЦикла;\r\n\r\n\tВозврат ммТовары;\r\nКонецФункции  // РазбитьСписокТоваров\n\nОрфографическая ошибка в списТоваров (найдено 3): спис"
  },
  {
    "title": "Заполнение формы объекта без записи в БД",
    "description": "Заполнение формы объекта без записи в БД",
    "code_snippet": "&НаКлиенте\r\nПроцедура ОткрытьФормуНового(Команда)\r\n\t\r\n\tФорма = ПолучитьФорму(\"Документ.ПродажаТоваровУслуг.Форма.ФормаДокумента\");\r\n\tДанныеФормы = Форма.Объект;\r\n\tЗаполнитьНаСервере(ДанныеФормы);\r\n\tКопироватьДанныеФормы(ДанныеФормы, Форма.Объект);\r\n\tФорма.Открыть();\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ЗаполнитьНаСервере(НовыйОбъект)\r\n\tНовыйОбъект.Контрагент = Справочники.Контрагенты.НайтиПоКоду(\"000000005\"); \r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура ОткрытьФормуНового(Команда)\r\n\t\r\n\tФорма = ПолучитьФорму(\"Документ.ПродажаТоваровУслуг.Форма.ФормаДокумента\");\r\n\tДанныеФормы = Форма.Объект;\r\n\tЗаполнитьНаСервере(ДанныеФормы);\r\n\tКопироватьДанныеФормы(ДанныеФормы, Форма.Объект);\r\n\tФорма.Открыть();\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ЗаполнитьНаСервере(НовыйОбъект)\r\n\tНовыйОбъект.Контрагент = Справочники.Контрагенты.НайтиПоКоду(\"000000005\"); \r\nКонецПроцедуры"
  },
  {
    "title": "Пауза в любой ОС",
    "description": "Пауза в любой ОС",
    "code_snippet": "//Процедуру нужно расположить в общем модуле с включенными флагами \"Сервер\" и \"Вызов сервера\"\r\nПроцедура Пауза(КоличествоСекунд) Экспорт\r\n\t\r\n\tЕсли ТипЗнч(КоличествоСекунд) <> Тип(\"Число\") ИЛИ КоличествоСекунд = 0 Тогда\r\n\t\tВозврат; // Чтобы не произошло бесконечной паузы (зависания)\r\n\tКонецЕсли; \r\n\t\r\n\tФоновоеЗадание = ПолучитьТекущийСеансИнформационнойБазы().ПолучитьФоновоеЗадание(); // Для проверки, работаем ли мы в фоновом задании\r\n\t\r\n\tЕсли ФоновоеЗадание = Неопределено Тогда\r\n\t\t\r\n\t\t// Алгоритм запуска фонового задания и ожидания завершения по времени\r\n\t\t\r\n\t\tПараметры = Новый Массив(1);\r\n\t\tПараметры.Установить(0, КоличествоСекунд);\r\n\t\tИмяМетода = \"_ФоновоеЗадание.Пауза\"; // Полное имя метода текущей процедуры, с указанием общего модуля\r\n\t\t\r\n\t\t// Запускаем фоновое задание без использования расширений конфигурации (снижаем нагрузку на сервер)\r\n\t\tФоновоеЗадание = РасширенияКонфигурации.ВыполнитьФоновоеЗаданиеБезРасширений(ИмяМетода, Параметры);\r\n\t\t\r\n\tКонецЕсли; \r\n\t\r\n\tФоновоеЗадание.ОжидатьЗавершенияВыполнения(КоличествоСекунд);\r\n\t\r\nКонецПроцедуры\n\n//Процедуру нужно расположить в общем модуле с включенными флагами \"Сервер\" и \"Вызов сервера\"\r\nПроцедура Пауза(КоличествоСекунд) Экспорт\r\n\t\r\n\tЕсли ТипЗнч(КоличествоСекунд) <> Тип(\"Число\") ИЛИ КоличествоСекунд = 0 Тогда\r\n\t\tВозврат; // Чтобы не произошло бесконечной паузы (зависания)\r\n\tКонецЕсли; \r\n\t\r\n\tФоновоеЗадание = ПолучитьТекущийСеансИнформационнойБазы().ПолучитьФоновоеЗадание(); // Для проверки, работаем ли мы в фоновом задании\r\n\t\r\n\tЕсли ФоновоеЗадание = Неопределено Тогда\r\n\t\t\r\n\t\t// Алгоритм запуска фонового задания и ожидания завершения по времени\r\n\t\t\r\n\t\tПараметры = Новый Массив(1);\r\n\t\tПараметры.Установить(0, КоличествоСекунд);\r\n\t\tИмяМетода = \"_ФоновоеЗадание.Пауза\"; // Полное имя метода текущей процедуры, с указанием общего модуля\r\n\t\t\r\n\t\t// Запускаем фоновое задание без использования расширений конфигурации (снижаем нагрузку на сервер)\r\n\t\tФоновоеЗадание = РасширенияКонфигурации.ВыполнитьФоновоеЗаданиеБезРасширений(ИмяМетода, Параметры);\r\n\t\t\r\n\tКонецЕсли; \r\n\t\r\n\tФоновоеЗадание.ОжидатьЗавершенияВыполнения(КоличествоСекунд);\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Инициализировать Форму Выбора",
    "description": "Инициализировать Форму Выбора",
    "code_snippet": "// Настраивает форму списка так, чтобы она стала формой выбора.\r\n// Позволяет полноценно использовать одну форму как в качестве основной формы списка, так и формы выбора\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - управляемая форма\r\n//  ИмяЭлемента  - Строка - Имя элемента динамического списка\r\n//\r\nПроцедура ИнициализироватьФормуВыбора(Форма, ИмяЭлемента = \"Список\") Экспорт\r\n\t\r\n\tЭлементФормы = Форма.Элементы.Найти(ИмяЭлемента);\r\n\tЭлементФормы.РежимВыбора = (Форма.Параметры.РежимВыбора = Истина);\r\n\tЭлементФормы.МножественныйВыбор = (Форма.Параметры.МножественныйВыбор = Истина);\r\n\t\r\n\tЕсли ЭлементФормы.РежимВыбора И НЕ ЗначениеЗаполнено(Форма.КлючНазначенияИспользования) Тогда\r\n\t\tСтандартныеПодсистемыСервер.УстановитьКлючНазначенияФормы(Форма, \"РежимВыбора\");\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\n// Настраивает форму списка так, чтобы она стала формой выбора.\r\n// Позволяет полноценно использовать одну форму как в качестве основной формы списка, так и формы выбора\r\n//\r\n// Параметры:\r\n//  Форма  - ФормаКлиентскогоПриложения - управляемая форма\r\n//  ИмяЭлемента  - Строка - Имя элемента динамического списка\r\n//\r\nПроцедура ИнициализироватьФормуВыбора(Форма, ИмяЭлемента = \"Список\") Экспорт\r\n\t\r\n\tЭлементФормы = Форма.Элементы.Найти(ИмяЭлемента);\r\n\tЭлементФормы.РежимВыбора = (Форма.Параметры.РежимВыбора = Истина);\r\n\tЭлементФормы.МножественныйВыбор = (Форма.Параметры.МножественныйВыбор = Истина);\r\n\t\r\n\tЕсли ЭлементФормы.РежимВыбора И НЕ ЗначениеЗаполнено(Форма.КлючНазначенияИспользования) Тогда\r\n\t\tСтандартныеПодсистемыСервер.УстановитьКлючНазначенияФормы(Форма, \"РежимВыбора\");\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Поиск количества ссылок на объект по измерениям в регистрах",
    "description": "Поиск количества ссылок на объект по измерениям в регистрах",
    "code_snippet": "Процедура НайтиСсылкуНаОрганизациюВРегистрахИзмеренияхРН (ОбъектДляПоиска, ТипОбъекта)\r\n\r\nДля Каждого Регистр Из Метаданные.РегистрыНакопления Цикл\r\n\t\r\n\tДля Каждого Измерение Из Регистр.Измерения Цикл\r\n\t\t\r\n\t\tМассивТипов = Новый Массив;\r\n\t\tМассивТипов.Добавить(ТипОбъекта);\r\n\t\t\r\n\t\tЕсли Измерение.Тип = Новый ОписаниеТипов(МассивТипов) Тогда\r\n\t\t\t\r\n\t\t\tИмяРегистра = Регистр.Имя;\r\n\t\t\tИмяИзмерения = Измерение.Имя;\r\n\t\t\t\r\n\t\t\tЗапрос = Новый Запрос;\r\n\t\t\tЗапрос.Текст = \"ВЫБРАТЬ\r\n\t\t\t|\t\" + ИмяРегистра + \".\" + ИмяИзмерения + \",\r\n\t\t\t|\tСУММА(1) КАК КоличествоЗаписей\r\n\t\t\t|ИЗ\r\n\t\t\t|\tРегистрНакопления.\" + ИмяРегистра + \" КАК \" + ИмяРегистра + \"\r\n\t\t\t|ГДЕ\r\n\t\t\t|  \" + ИмяРегистра + \".\" + ИмяИзмерения + \" = &ИскомыйОбъект\" + \"\r\n\t\t\t|СГРУППИРОВАТЬ ПО\r\n\t\t\t|\t\" + ИмяРегистра + \".\" + ИмяИзмерения + \"\";\r\n\t\t\tЗапрос.УстановитьПараметр(\"ИскомыйОбъект\", ТипОбъекта);\r\n\t\t\tРезультат = Запрос.Выполнить().Выбрать();\r\n\t\t\tВыборка = Запрос.Выполнить().Выбрать();\r\n\t\t\t\r\n\t\t\tЕсли Выборка.Следующий() Тогда\r\n\t\t\t\tСообщить(\"В РН \" + ИмяРегистра + \" существует \" + Строка(Выборка.КоличествоЗаписей) + \" записей\"); \t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\nКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\nПроцедура НайтиСсылкуНаОрганизациюВРегистрахИзмеренияхРН (ОбъектДляПоиска, ТипОбъекта)\r\n\r\nДля Каждого Регистр Из Метаданные.РегистрыНакопления Цикл\r\n\t\r\n\tДля Каждого Измерение Из Регистр.Измерения Цикл\r\n\t\t\r\n\t\tМассивТипов = Новый Массив;\r\n\t\tМассивТипов.Добавить(ТипОбъекта);\r\n\t\t\r\n\t\tЕсли Измерение.Тип = Новый ОписаниеТипов(МассивТипов) Тогда\r\n\t\t\t\r\n\t\t\tИмяРегистра = Регистр.Имя;\r\n\t\t\tИмяИзмерения = Измерение.Имя;\r\n\t\t\t\r\n\t\t\tЗапрос = Новый Запрос;\r\n\t\t\tЗапрос.Текст = \"ВЫБРАТЬ\r\n\t\t\t|\t\" + ИмяРегистра + \".\" + ИмяИзмерения + \",\r\n\t\t\t|\tСУММА(1) КАК КоличествоЗаписей\r\n\t\t\t|ИЗ\r\n\t\t\t|\tРегистрНакопления.\" + ИмяРегистра + \" КАК \" + ИмяРегистра + \"\r\n\t\t\t|ГДЕ\r\n\t\t\t|  \" + ИмяРегистра + \".\" + ИмяИзмерения + \" = &ИскомыйОбъект\" + \"\r\n\t\t\t|СГРУППИРОВАТЬ ПО\r\n\t\t\t|\t\" + ИмяРегистра + \".\" + ИмяИзмерения + \"\";\r\n\t\t\tЗапрос.УстановитьПараметр(\"ИскомыйОбъект\", ТипОбъекта);\r\n\t\t\tРезультат = Запрос.Выполнить().Выбрать();\r\n\t\t\tВыборка = Запрос.Выполнить().Выбрать();\r\n\t\t\t\r\n\t\t\tЕсли Выборка.Следующий() Тогда\r\n\t\t\t\tСообщить(\"В РН \" + ИмяРегистра + \" существует \" + Строка(Выборка.КоличествоЗаписей) + \" записей\"); \t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\nКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Многопоточная пометка удаления документов по организации за период",
    "description": "Многопоточная пометка удаления документов по организации за период",
    "code_snippet": "Процедура ВыполнитьУдалениеДокументов(НачальнаяДата, КонечнаяДата, Организация) Экспорт\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"НачальнаяДата\", НачальнаяДата);\t\t\t   \r\n\tЗапрос.УстановитьПараметр(\"КонечнаяДата\", КонечнаяДата);\r\n\tЗапрос.УстановитьПараметр(\"Организация\", Организация);\r\n\t\r\n\tДля Каждого МетаДокумент из Метаданные.Документы Цикл\r\n\t\t\r\n\t\tОбработкаПрерыванияПользователя();\r\n\t\t\r\n\t\tЕсли МетаДокумент.Реквизиты.Найти(\"Организация\") = Неопределено Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\t\tЗапрос.Текст = \"ВЫБРАТЬ\r\n\t\t|\tУдаляемыйДокумент.Ссылка\r\n\t\t|ИЗ\r\n\t\t|\tДокумент.ЧекККМ КАК УдаляемыйДокумент\r\n\t\t|ГДЕ\r\n\t\t|\tУдаляемыйДокумент.Дата МЕЖДУ &НачальнаяДата И &КонечнаяДата\r\n\t\t|\tИ УдаляемыйДокумент.Организация = &Организация\r\n\t\t|\tИ НЕ УдаляемыйДокумент.ПометкаУдаления\r\n\t\t|\r\n\t\t|УПОРЯДОЧИТЬ ПО\r\n\t\t|\tУдаляемыйДокумент.Дата\";\r\n\t\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"ЧекККМ\", МетаДокумент.Имя);\r\n\t\tВыборка = Запрос.Выполнить().Выбрать;\r\n\t\t\r\n\t\tЕсли Не Выборка.Количество() Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\t\tМассивДокументов = Новый Массив;\r\n\t\t\r\n\t\tМассивФЗ = Новый Массив;\r\n\t\tКоличествоЗаданий = 20; // количество фоновых заданий для каждого вида документа \r\n\t\tКоличествоДанныхДляЗадания = 800; // количество документов, обрабатываемых одним фоновым заданием\r\n\t\tМассивДанныхЗадания = Новый Массив;\r\n\t\tПока Выборка.Следующий() Цикл\r\n\t\t\tМассивДанныхЗадания.Добавить(Выборка.Ссылка);\r\n\t\t\t// если набралось достаточно документов для запуска ФЗ - идем дальше\r\n\t\t\tЕсли МассивДанныхЗадания.Количество() = КоличествоДанныхДляЗадания Тогда\r\n\t\t\t\t// проверяем есть ли свободные ФЗ, иначе ждем\r\n\t\t\t\tПока МассивФЗ.Количество() = КоличествоЗаданий Цикл\r\n\t\t\t\t\tДля Каждого ФЗ ИЗ МассивФЗ Цикл\r\n\t\t\t\t\t\tОтборФЗ = Новый Структура;\r\n\t\t\t\t\t\tОтборФЗ.Вставить(\"УникальныйИдентификатор\", ФЗ); \r\n\t\t\t\t\t\tМассивАктивныхЗаданий = ФоновыеЗадания.ПолучитьФоновыеЗадания(ОтборФЗ);\r\n\t\t\t\t\t\tДля Каждого Задание Из МассивАктивныхЗаданий Цикл\r\n\t\t\t\t\t\t\tЕсли НЕ Задание.Состояние = СостояниеФоновогоЗадания.Активно Тогда\r\n\t\t\t\t\t\t\t\tМассивФЗ.Удалить(МассивФЗ.Найти(ФЗ));\r\n\t\t\t\t\t\t\t\tПрервать; // выйдем из \"бесконечного\" цикла, когда хотя бы одно из заданий закончилось\r\n\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\tКонецЦикла;\r\n\t\t\t\t\tКонецЦикла; \r\n\t\t\t\tКонецЦикла;\r\n\t\t\t\t// запускаем ФЗ\r\n\t\t\t\tМассивПараметров = Новый Массив;\r\n\t\t\t\tМассивПараметров.Добавить(МассивДанныхЗадания);\r\n\t\t\t\tФЗ = ФоновыеЗадания.Выполнить(\"СлужебныйМодуль.УдалитьДокументы\", МассивПараметров, Новый УникальныйИдентификатор);\r\n\t\t\t\tМассивФЗ.Добавить(ФЗ.УникальныйИдентификатор);\r\n\t\t\t\tМассивДанныхЗадания = Новый Массив;\r\n\t\t\tКонецЕсли; // КоличествоДанныхДляЗадания\r\n\t\tКонецЦикла;\r\n\t\t// если не дошли до ограничения по количеству документов в ФЗ - запускаем единственное\r\n\t\tЕсли МассивДанныхЗадания.Количество() > 0 Тогда\r\n\t\t\tМассивПараметров = Новый Массив;\r\n\t\t\tМассивПараметров.Добавить(МассивДанныхЗадания);\r\n\t\t\tФЗ = ФоновыеЗадания.Выполнить(\"СлужебныйМодуль.УдалитьДокументы\", МассивПараметров, Новый УникальныйИдентификатор);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\t //по документам из метаданных\r\n\t\r\nКонецПроцедуры\r\n\r\n// Процедура общего модуля для запуска фонового задания\r\nПроцедура УдалитьДокументы(СтруктураПараметров) Экспорт\r\n\t\r\n\tДля Каждого Документ Из СтруктураПараметров Цикл\r\n\t\tДокументОбъект = Документ.Ссылка.ПолучитьОбъект();\r\n\t\tДокументОбъект.УстановитьПометкуУдаления(Истина);\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\nПроцедура ВыполнитьУдалениеДокументов(НачальнаяДата, КонечнаяДата, Организация) Экспорт\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"НачальнаяДата\", НачальнаяДата);\t\t\t   \r\n\tЗапрос.УстановитьПараметр(\"КонечнаяДата\", КонечнаяДата);\r\n\tЗапрос.УстановитьПараметр(\"Организация\", Организация);\r\n\t\r\n\tДля Каждого МетаДокумент из Метаданные.Документы Цикл\r\n\t\t\r\n\t\tОбработкаПрерыванияПользователя();\r\n\t\t\r\n\t\tЕсли МетаДокумент.Реквизиты.Найти(\"Организация\") = Неопределено Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\t\tЗапрос.Текст = \"ВЫБРАТЬ\r\n\t\t|\tУдаляемыйДокумент.Ссылка\r\n\t\t|ИЗ\r\n\t\t|\tДокумент.ЧекККМ КАК УдаляемыйДокумент\r\n\t\t|ГДЕ\r\n\t\t|\tУдаляемыйДокумент.Дата МЕЖДУ &НачальнаяДата И &КонечнаяДата\r\n\t\t|\tИ УдаляемыйДокумент.Организация = &Организация\r\n\t\t|\tИ НЕ УдаляемыйДокумент.ПометкаУдаления\r\n\t\t|\r\n\t\t|УПОРЯДОЧИТЬ ПО\r\n\t\t|\tУдаляемыйДокумент.Дата\";\r\n\t\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"ЧекККМ\", МетаДокумент.Имя);\r\n\t\tВыборка = Запрос.Выполнить().Выбрать;\r\n\t\t\r\n\t\tЕсли Не Выборка.Количество() Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\t\tМассивДокументов = Новый Массив;\r\n\t\t\r\n\t\tМассивФЗ = Новый Массив;\r\n\t\tКоличествоЗаданий = 20; // количество фоновых заданий для каждого вида документа \r\n\t\tКоличествоДанныхДляЗадания = 800; // количество документов, обрабатываемых одним фоновым заданием\r\n\t\tМассивДанныхЗадания = Новый Массив;\r\n\t\tПока Выборка.Следующий() Цикл\r\n\t\t\tМассивДанныхЗадания.Добавить(Выборка.Ссылка);\r\n\t\t\t// если набралось достаточно документов для запуска ФЗ - идем дальше\r\n\t\t\tЕсли МассивДанныхЗадания.Количество() = КоличествоДанныхДляЗадания Тогда\r\n\t\t\t\t// проверяем есть ли свободные ФЗ, иначе ждем\r\n\t\t\t\tПока МассивФЗ.Количество() = КоличествоЗаданий Цикл\r\n\t\t\t\t\tДля Каждого ФЗ ИЗ МассивФЗ Цикл\r\n\t\t\t\t\t\tОтборФЗ = Новый Структура;\r\n\t\t\t\t\t\tОтборФЗ.Вставить(\"УникальныйИдентификатор\", ФЗ); \r\n\t\t\t\t\t\tМассивАктивныхЗаданий = ФоновыеЗадания.ПолучитьФоновыеЗадания(ОтборФЗ);\r\n\t\t\t\t\t\tДля Каждого Задание Из МассивАктивныхЗаданий Цикл\r\n\t\t\t\t\t\t\tЕсли НЕ Задание.Состояние = СостояниеФоновогоЗадания.Активно Тогда\r\n\t\t\t\t\t\t\t\tМассивФЗ.Удалить(МассивФЗ.Найти(ФЗ));\r\n\t\t\t\t\t\t\t\tПрервать; // выйдем из \"бесконечного\" цикла, когда хотя бы одно из заданий закончилось\r\n\t\t\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\tКонецЦикла;\r\n\t\t\t\t\tКонецЦикла; \r\n\t\t\t\tКонецЦикла;\r\n\t\t\t\t// запускаем ФЗ\r\n\t\t\t\tМассивПараметров = Новый Массив;\r\n\t\t\t\tМассивПараметров.Добавить(МассивДанныхЗадания);\r\n\t\t\t\tФЗ = ФоновыеЗадания.Выполнить(\"СлужебныйМодуль.УдалитьДокументы\", МассивПараметров, Новый УникальныйИдентификатор);\r\n\t\t\t\tМассивФЗ.Добавить(ФЗ.УникальныйИдентификатор);\r\n\t\t\t\tМассивДанныхЗадания = Новый Массив;\r\n\t\t\tКонецЕсли; // КоличествоДанныхДляЗадания\r\n\t\tКонецЦикла;\r\n\t\t// если не дошли до ограничения по количеству документов в ФЗ - запускаем единственное\r\n\t\tЕсли МассивДанныхЗадания.Количество() > 0 Тогда\r\n\t\t\tМассивПараметров = Новый Массив;\r\n\t\t\tМассивПараметров.Добавить(МассивДанныхЗадания);\r\n\t\t\tФЗ = ФоновыеЗадания.Выполнить(\"СлужебныйМодуль.УдалитьДокументы\", МассивПараметров, Новый УникальныйИдентификатор);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\t //по документам из метаданных\r\n\t\r\nКонецПроцедуры\r\n\r\n// Процедура общего модуля для запуска фонового задания\r\nПроцедура УдалитьДокументы(СтруктураПараметров) Экспорт\r\n\t\r\n\tДля Каждого Документ Из СтруктураПараметров Цикл\r\n\t\tДокументОбъект = Документ.Ссылка.ПолучитьОбъект();\r\n\t\tДокументОбъект.УстановитьПометкуУдаления(Истина);\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\nОрфографическая ошибка в многопоточность: многопоточность"
  },
  {
    "title": "В EDT можно выбрать схему горячих клавиш как в Конфигураторе",
    "description": "В EDT можно выбрать схему горячих клавиш как в КонфигуратореЛайфхаки 1С",
    "code_snippet": ""
  },
  {
    "title": "Попытка проведения и записи документа в одной процедуре",
    "description": "Попытка проведения и записи документа в одной процедуре",
    "code_snippet": "// Выполняет попытку проведения и записи документа\r\n//\r\n// Параметры:\r\n//  ДокументОбъект\t \t\t- ДокументОбъект \t- документ, который необходимо провести или записать\r\n//  ПредставлениеДокумента\t- ЛюбаяСсылка, Строка\t\t\t- ссылка или представление ссылки на документ для вывода в сообщение\r\n//  Отказ\t\t\t \t\t- Булево \t\t\t- признак ошибки при попытке записи (документ не проведен и не записан)\r\n//\r\nПроцедура ЗафиксироватьДокумент(ДокументОбъект, Знач ПредставлениеДокумента, Отказ)\r\n\t\r\n\tДокументЗафиксирован = Ложь;\r\n\t\r\n\tПопытка\r\n\t\tЕсли ДокументОбъект.ПроверитьЗаполнение() Тогда\r\n\t\t\tДокументОбъект.Записать(РежимЗаписиДокумента.Проведение);\r\n\t\t\tДокументЗафиксирован = Истина;\r\n\t\tИначе\r\n\t\t\tВызватьИсключение \"Обнаружены ошибки при проверке заполнения.\";\r\n\t\tКонецЕсли; \r\n\tИсключение\r\n\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(\"Не удалось провести документ \" + ПредставлениеДокумента + \": \" + Символы.ПС + КраткоеПредставлениеОшибки(ИнформацияОбОшибке()));\r\n\tКонецПопытки;\r\n\t\r\n\tЕсли НЕ ДокументЗафиксирован Тогда\r\n\t\tПопытка\r\n\t\t\tДокументОбъект.Записать(?(ДокументОбъект.Проведен, РежимЗаписиДокумента.ОтменаПроведения, РежимЗаписиДокумента.Запись));\r\n\t\t\tДокументЗафиксирован = Истина;\r\n\t\tИсключение\r\n\t\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(\"Не удалось записать документ \" + ПредставлениеДокумента + \": \" + Символы.ПС + КраткоеПредставлениеОшибки(ИнформацияОбОшибке()));\r\n\t\tКонецПопытки;\r\n\tКонецЕсли; \r\n\t\r\n\tОтказ = Отказ ИЛИ НЕ ДокументЗафиксирован; \r\n\t\r\nКонецПроцедуры\n\n// Выполняет попытку проведения и записи документа\r\n//\r\n// Параметры:\r\n//  ДокументОбъект\t \t\t- ДокументОбъект \t- документ, который необходимо провести или записать\r\n//  ПредставлениеДокумента\t- ЛюбаяСсылка, Строка\t\t\t- ссылка или представление ссылки на документ для вывода в сообщение\r\n//  Отказ\t\t\t \t\t- Булево \t\t\t- признак ошибки при попытке записи (документ не проведен и не записан)\r\n//\r\nПроцедура ЗафиксироватьДокумент(ДокументОбъект, Знач ПредставлениеДокумента, Отказ)\r\n\t\r\n\tДокументЗафиксирован = Ложь;\r\n\t\r\n\tПопытка\r\n\t\tЕсли ДокументОбъект.ПроверитьЗаполнение() Тогда\r\n\t\t\tДокументОбъект.Записать(РежимЗаписиДокумента.Проведение);\r\n\t\t\tДокументЗафиксирован = Истина;\r\n\t\tИначе\r\n\t\t\tВызватьИсключение \"Обнаружены ошибки при проверке заполнения.\";\r\n\t\tКонецЕсли; \r\n\tИсключение\r\n\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(\"Не удалось провести документ \" + ПредставлениеДокумента + \": \" + Символы.ПС + КраткоеПредставлениеОшибки(ИнформацияОбОшибке()));\r\n\tКонецПопытки;\r\n\t\r\n\tЕсли НЕ ДокументЗафиксирован Тогда\r\n\t\tПопытка\r\n\t\t\tДокументОбъект.Записать(?(ДокументОбъект.Проведен, РежимЗаписиДокумента.ОтменаПроведения, РежимЗаписиДокумента.Запись));\r\n\t\t\tДокументЗафиксирован = Истина;\r\n\t\tИсключение\r\n\t\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(\"Не удалось записать документ \" + ПредставлениеДокумента + \": \" + Символы.ПС + КраткоеПредставлениеОшибки(ИнформацияОбОшибке()));\r\n\t\tКонецПопытки;\r\n\tКонецЕсли; \r\n\t\r\n\tОтказ = Отказ ИЛИ НЕ ДокументЗафиксирован; \r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Шаблон ПриКомпоновкеРезультата Программное формирование",
    "description": "Шаблон ПриКомпоновкеРезультата Программное формирование",
    "code_snippet": "Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\r\n\t\r\n\t//отказ от стандартного формирования\r\n\tСтандартнаяОбработка = Ложь;\r\n\t\r\n\t//1. получение схемы компановки данных\r\n\tСхемаКомпановки = ПолучитьМакет(\"ОсновнаяСхемаКомпоновкиДанных\");\r\n\t\r\n\t//2. получение настроек компановки данных\r\n\tНастройкиКомпановки = КомпоновщикНастроек.ПолучитьНастройки();\r\n\t\r\n\t//3. Получение макета компановки данных\r\n\tКомпановщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;    \r\n\tМакетКомпановки = КомпановщикМакета.Выполнить(СхемаКомпановки, НастройкиКомпановки, ДанныеРасшифровки);\r\n\t\r\n\t//4.Компановка данных\r\n\tПроцессорКомпоновки = новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпановки, , ДанныеРасшифровки, Истина);\r\n\t\r\n\t//5. вывод результата компановки в табдок\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n\tПроцессорВывода.УстановитьДокумент(ДокументРезультат);\r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновки);\r\n\t\r\n\t//6. вывод результата компановки в дерево или таблицу значений\r\n\t//ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\t//ДеревоЗнч = новый ДеревоЗначений;\r\n\t//ПроцессорВывода.УстановитьОбъект(ДеревоЗнч);\r\n\t//ПроцессорВывода.Вывести(ПроцессорКомпоновки);\r\n\t\r\nКонецПроцедуры\n\nПроцедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\r\n\t\r\n\t//отказ от стандартного формирования\r\n\tСтандартнаяОбработка = Ложь;\r\n\t\r\n\t//1. получение схемы компановки данных\r\n\tСхемаКомпановки = ПолучитьМакет(\"ОсновнаяСхемаКомпоновкиДанных\");\r\n\t\r\n\t//2. получение настроек компановки данных\r\n\tНастройкиКомпановки = КомпоновщикНастроек.ПолучитьНастройки();\r\n\t\r\n\t//3. Получение макета компановки данных\r\n\tКомпановщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;    \r\n\tМакетКомпановки = КомпановщикМакета.Выполнить(СхемаКомпановки, НастройкиКомпановки, ДанныеРасшифровки);\r\n\t\r\n\t//4.Компановка данных\r\n\tПроцессорКомпоновки = новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпановки, , ДанныеРасшифровки, Истина);\r\n\t\r\n\t//5. вывод результата компановки в табдок\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n\tПроцессорВывода.УстановитьДокумент(ДокументРезультат);\r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновки);\r\n\t\r\n\t//6. вывод результата компановки в дерево или таблицу значений\r\n\t//ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\t//ДеревоЗнч = новый ДеревоЗначений;\r\n\t//ПроцессорВывода.УстановитьОбъект(ДеревоЗнч);\r\n\t//ПроцессорВывода.Вывести(ПроцессорКомпоновки);\r\n\t\r\nКонецПроцедуры\n\nОрфографическая ошибка в компановки (найдено 5): компановки\r\nОрфографическая ошибка в СхемаКомпановки (найдено 2): Компановки\r\nОрфографическая ошибка в НастройкиКомпановки (найдено 2): Компановки\r\nОрфографическая ошибка в КомпановщикМакета (найдено 2): Компановщик\r\nОрфографическая ошибка в МакетКомпановки (найдено 2): Компановки\r\nОрфографическая ошибка в Компановка: Компановка"
  },
  {
    "title": "1с82. Прикрепление файла к документу. Обычное приложение",
    "description": "1с82. Прикрепление файла к документу. Обычное приложение",
    "code_snippet": "Процедура ПрикрепитьФайлНажатие(Элемент)\r\n\t\r\n\tРежим = РежимДиалогаВыбораФайла.Открытие;\r\n\t\r\n\tДиалогОткрытия = Новый ДиалогВыбораФайла(Режим);\r\n\tДиалогОткрытия.ПолноеИмяФайла = \"\";\r\n\tФильтр = \"Текст, *.pdf|*.pdf\";\r\n\tДиалогОткрытия.Фильтр = Фильтр;\r\n\tДиалогОткрытия.МножественныйВыбор = Истина;\r\n\tДиалогОткрытия.Заголовок = \"Выберите файлы\";\r\n\tЕсли ДиалогОткрытия.Выбрать() Тогда\r\n\t\tМассивВыбранныхФайлов = ДиалогОткрытия.ВыбранныеФайлы;\r\n\t\tДля Каждого ИмяВыбранногоФайла Из МассивВыбранныхФайлов Цикл\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tВыбранныйФайл = Новый Файл(ИмяВыбранногоФайла);\r\n\t\t\t\r\n\t\t\tЕсли ЭтотОбъект.Ссылка = Неопределено Тогда\r\n\t\t\t\tВозврат;\r\n\t\t\tИначе\r\n\t\t\t\tДокументСсылка    = ЭтотОбъект.Ссылка;\t\r\n\t\t\t\tУИДДокумента       = ДокументСсылка.УникальныйИдентификатор();\t\t\r\n\t\t\t\tКаталогНаДиске = Новый Файл(\"\\\\SERVER\\file_storage\\\" + Строка(УИДДокумента));\r\n\t\t\t\tЕсли КаталогНаДиске.Существует() Тогда\r\n\t\t\t\t\tПутьКФайлуИсточнику = \"\";\r\n\t\t\t\t\tКопироватьФайл(ВыбранныйФайл.ПолноеИмя, КаталогНаДиске.ПолноеИмя + \"\\\" + ВыбранныйФайл.Имя);\r\n\t\t\t\tИначе\r\n\t\t\t\t\tСоздатьКаталог(\"\\\\SERVER\\file_storage\\\" + Строка(УИДДокумента));\r\n\t\t\t\t\tКаталогНаДиске = Новый Файл(\"\\\\SERVER\\file_storage\\\" + Строка(УИДДокумента));\r\n\t\t\t\t\tЕсли КаталогНаДиске.Существует() Тогда\r\n\t\t\t\t\t\tКопироватьФайл(ВыбранныйФайл.ПолноеИмя, КаталогНаДиске.ПолноеИмя + \"\\\" + ВыбранныйФайл.Имя);\r\n\t\t\t\t\tКонецЕсли;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\tИначе\r\n\t\tПредупреждение(\"Нет выбранных файлов!\");\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\nПроцедура ПрикрепитьФайлНажатие(Элемент)\r\n\t\r\n\tРежим = РежимДиалогаВыбораФайла.Открытие;\r\n\t\r\n\tДиалогОткрытия = Новый ДиалогВыбораФайла(Режим);\r\n\tДиалогОткрытия.ПолноеИмяФайла = \"\";\r\n\tФильтр = \"Текст, *.pdf|*.pdf\";\r\n\tДиалогОткрытия.Фильтр = Фильтр;\r\n\tДиалогОткрытия.МножественныйВыбор = Истина;\r\n\tДиалогОткрытия.Заголовок = \"Выберите файлы\";\r\n\tЕсли ДиалогОткрытия.Выбрать() Тогда\r\n\t\tМассивВыбранныхФайлов = ДиалогОткрытия.ВыбранныеФайлы;\r\n\t\tДля Каждого ИмяВыбранногоФайла Из МассивВыбранныхФайлов Цикл\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tВыбранныйФайл = Новый Файл(ИмяВыбранногоФайла);\r\n\t\t\t\r\n\t\t\tЕсли ЭтотОбъект.Ссылка = Неопределено Тогда\r\n\t\t\t\tВозврат;\r\n\t\t\tИначе\r\n\t\t\t\tДокументСсылка    = ЭтотОбъект.Ссылка;\t\r\n\t\t\t\tУИДДокумента       = ДокументСсылка.УникальныйИдентификатор();\t\t\r\n\t\t\t\tКаталогНаДиске = Новый Файл(\"\\\\SERVER\\file_storage\\\" + Строка(УИДДокумента));\r\n\t\t\t\tЕсли КаталогНаДиске.Существует() Тогда\r\n\t\t\t\t\tПутьКФайлуИсточнику = \"\";\r\n\t\t\t\t\tКопироватьФайл(ВыбранныйФайл.ПолноеИмя, КаталогНаДиске.ПолноеИмя + \"\\\" + ВыбранныйФайл.Имя);\r\n\t\t\t\tИначе\r\n\t\t\t\t\tСоздатьКаталог(\"\\\\SERVER\\file_storage\\\" + Строка(УИДДокумента));\r\n\t\t\t\t\tКаталогНаДиске = Новый Файл(\"\\\\SERVER\\file_storage\\\" + Строка(УИДДокумента));\r\n\t\t\t\t\tЕсли КаталогНаДиске.Существует() Тогда\r\n\t\t\t\t\t\tКопироватьФайл(ВыбранныйФайл.ПолноеИмя, КаталогНаДиске.ПолноеИмя + \"\\\" + ВыбранныйФайл.Имя);\r\n\t\t\t\t\tКонецЕсли;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\tИначе\r\n\t\tПредупреждение(\"Нет выбранных файлов!\");\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "NuxtJS + 1C. Личный кабинет контрагента. Курс",
    "description": "Разработай мини-сайт на современном фреймворке NuxtJS для оформления заказов контрагентами!",
    "code_snippet": ""
  },
  {
    "title": "Выполнение функции произвольным кодом (Выполнить)",
    "description": "Выполнение функции произвольным кодом (Выполнить)",
    "code_snippet": "Функция ВычислитьФункцию(Знач ПроизвольныйКод) Экспорт\r\n  \r\n  Результат = Неопределено;\r\n  \r\n  Выполнить(ПроизвольныйКод);\r\n  \r\n  Если Результат = Неопределено Тогда\r\n    ВызватьИсключение \"Не присвоено значение результата (Результат = Неопределено).\";\r\n  КонецЕсли; \r\n  \r\n  Возврат Результат;\r\n  \r\nКонецФункции\n\nФункция ВычислитьФункцию(Знач ПроизвольныйКод) Экспорт\r\n  \r\n  Результат = Неопределено;\r\n  \r\n  Выполнить(ПроизвольныйКод);\r\n  \r\n  Если Результат = Неопределено Тогда\r\n    ВызватьИсключение \"Не присвоено значение результата (Результат = Неопределено).\";\r\n  КонецЕсли; \r\n  \r\n  Возврат Результат;\r\n  \r\nКонецФункции\n\n{7} Условие всегда Истина\r\n{11} Функция всегда возвращает одно и тоже значение"
  },
  {
    "title": "Упорядочивание (сортировка) массива",
    "description": "Упорядочивание (сортировка) массива",
    "code_snippet": "// Сортирует массив через методы объекта \"СписокЗначений\".\r\n// Внимание: в результате сортировки меняется исходный (передаваемый в функцию) массив.\r\n//\r\n// Метод не требует смены контекста исполнения кода (подходит для размещения в клиент-серверном общем модуле).\r\n//\r\n// В подавляющем большинстве случаев достаточно использовать метод как процедуру.\r\n// Метод реализован в виде функции для:\r\n// - удобства вычисления выражения (результата сортировки) в отладчике\r\n// - возможности инициализации (получения) копии результата на вызывающей стороне в той же строке, что и сам вызов\r\n// .\r\n//\r\n// Параметры:\r\n//  МассивДляУпорядочивания - Массив - Массив элементов, которые необходимо упорядочить (по значению или по представлению).\r\n//                                     Внимание: в результате сортировки меняется исходный (передаваемый в функцию) массив.\r\n//  ПорядокСортировки - Строка - \"Возр\" или \"Убыв\" (в любом регистре, т.е. регистр не важен).\r\n//  СортироватьПоЗначению - Булево - Если Ложь, то сортировать по представлению.\r\n// \r\n// Возвращаемое значение:\r\n//  Массив - упорядоченный массив.\r\n//\r\nФункция УпорядочитьМассив(МассивДляУпорядочивания, Знач ПорядокСортировки = \"Возр\", Знач СортироватьПоЗначению = Истина) Экспорт\r\n\r\n\tлПорядокСортировки = НаправлениеСортировки.Возр;\r\n\tЕсли НРег(ПорядокСортировки) = НРег(\"Убыв\") Тогда\r\n\t\tлПорядокСортировки = НаправлениеСортировки.Убыв;\r\n\tКонецЕсли;\r\n\t\r\n\tСЗ = Новый СписокЗначений;\r\n\tСЗ.ЗагрузитьЗначения(МассивДляУпорядочивания);\r\n\tЕсли СортироватьПоЗначению Тогда\r\n\t\tСЗ.СортироватьПоЗначению(лПорядокСортировки);\r\n\tИначе\r\n\t\tСЗ.СортироватьПоПредставлению(лПорядокСортировки);\r\n\tКонецЕсли;\r\n\tМассивДляУпорядочивания = СЗ.ВыгрузитьЗначения();\r\n\t\r\n\tВозврат МассивДляУпорядочивания;\r\n\r\nКонецФункции\n\n// Сортирует массив через методы объекта \"СписокЗначений\".\r\n// Внимание: в результате сортировки меняется исходный (передаваемый в функцию) массив.\r\n//\r\n// Метод не требует смены контекста исполнения кода (подходит для размещения в клиент-серверном общем модуле).\r\n//\r\n// В подавляющем большинстве случаев достаточно использовать метод как процедуру.\r\n// Метод реализован в виде функции для:\r\n// - удобства вычисления выражения (результата сортировки) в отладчике\r\n// - возможности инициализации (получения) копии результата на вызывающей стороне в той же строке, что и сам вызов\r\n// .\r\n//\r\n// Параметры:\r\n//  МассивДляУпорядочивания - Массив - Массив элементов, которые необходимо упорядочить (по значению или по представлению).\r\n//                                     Внимание: в результате сортировки меняется исходный (передаваемый в функцию) массив.\r\n//  ПорядокСортировки - Строка - \"Возр\" или \"Убыв\" (в любом регистре, т.е. регистр не важен).\r\n//  СортироватьПоЗначению - Булево - Если Ложь, то сортировать по представлению.\r\n// \r\n// Возвращаемое значение:\r\n//  Массив - упорядоченный массив.\r\n//\r\nФункция УпорядочитьМассив(МассивДляУпорядочивания, Знач ПорядокСортировки = \"Возр\", Знач СортироватьПоЗначению = Истина) Экспорт\r\n\r\n\tлПорядокСортировки = НаправлениеСортировки.Возр;\r\n\tЕсли НРег(ПорядокСортировки) = НРег(\"Убыв\") Тогда\r\n\t\tлПорядокСортировки = НаправлениеСортировки.Убыв;\r\n\tКонецЕсли;\r\n\t\r\n\tСЗ = Новый СписокЗначений;\r\n\tСЗ.ЗагрузитьЗначения(МассивДляУпорядочивания);\r\n\tЕсли СортироватьПоЗначению Тогда\r\n\t\tСЗ.СортироватьПоЗначению(лПорядокСортировки);\r\n\tИначе\r\n\t\tСЗ.СортироватьПоПредставлению(лПорядокСортировки);\r\n\tКонецЕсли;\r\n\tМассивДляУпорядочивания = СЗ.ВыгрузитьЗначения();\r\n\t\r\n\tВозврат МассивДляУпорядочивания;\r\n\r\nКонецФункции"
  },
  {
    "title": "ВЫБРАТЬ ПЕРВЫЕ для СКД",
    "description": "ВЫБРАТЬ ПЕРВЫЕ для СКД",
    "code_snippet": "// Подставляет в последний пакет набора данных запроса конструкцию ВЫБРАТЬ ПЕРВЫЕ N\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/16\r\n// \r\n// Параметры:\r\n//  НаборДанных  - НаборДанныхЗапросСхемыКомпоновкиДанных - Набор данных СКД\r\n//  КоличествоПолучаемыхЗаписей  - Число, Неопределено - Количество получаемых записей. \r\n//\t\tСоответствует ключевому слову ПЕРВЫЕ языка запросов.\r\n//\t\tЕсли Неопределено, ограничение на количество выбираемых записей отсутствует.\r\n//\r\n// Пример:\r\n//  КоличествоЗаписей = НастройкиКомпоновки.ПараметрыДанных.НайтиЗначениеПараметра(\"ВыбратьПервые\").Значение;\r\n//  УстановитьКоличествоПолучаемыхЗаписейНабораДанных(СхемаКомпоновкиДанных.НаборыДанных.Получить(0), КоличествоЗаписей);\r\n//\r\nПроцедура УстановитьКоличествоПолучаемыхЗаписейНабораДанных(Знач НаборДанных, Знач КоличествоПолучаемыхЗаписей) Экспорт\r\n\t\r\n\tСхемаЗапроса = Новый СхемаЗапроса();\r\n\tСхемаЗапроса.РежимКомпоновкиДанных = Истина;\r\n\tСхемаЗапроса.УстановитьТекстЗапроса(НаборДанных.Запрос);\r\n\tПоследнийПакет = СхемаЗапроса.ПакетЗапросов.Получить(СхемаЗапроса.ПакетЗапросов.Количество() - 1);\r\n\tПоследнийПакет.Операторы.Получить(0).КоличествоПолучаемыхЗаписей = КоличествоПолучаемыхЗаписей;\r\n\t\r\n\tНаборДанных.Запрос = СхемаЗапроса.ПолучитьТекстЗапроса();\r\n\t\t\r\nКонецПроцедуры\n\n// Подставляет в последний пакет набора данных запроса конструкцию ВЫБРАТЬ ПЕРВЫЕ N\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/16\r\n// \r\n// Параметры:\r\n//  НаборДанных  - НаборДанныхЗапросСхемыКомпоновкиДанных - Набор данных СКД\r\n//  КоличествоПолучаемыхЗаписей  - Число, Неопределено - Количество получаемых записей. \r\n//\t\tСоответствует ключевому слову ПЕРВЫЕ языка запросов.\r\n//\t\tЕсли Неопределено, ограничение на количество выбираемых записей отсутствует.\r\n//\r\n// Пример:\r\n//  КоличествоЗаписей = НастройкиКомпоновки.ПараметрыДанных.НайтиЗначениеПараметра(\"ВыбратьПервые\").Значение;\r\n//  УстановитьКоличествоПолучаемыхЗаписейНабораДанных(СхемаКомпоновкиДанных.НаборыДанных.Получить(0), КоличествоЗаписей);\r\n//\r\nПроцедура УстановитьКоличествоПолучаемыхЗаписейНабораДанных(Знач НаборДанных, Знач КоличествоПолучаемыхЗаписей) Экспорт\r\n\t\r\n\tСхемаЗапроса = Новый СхемаЗапроса();\r\n\tСхемаЗапроса.РежимКомпоновкиДанных = Истина;\r\n\tСхемаЗапроса.УстановитьТекстЗапроса(НаборДанных.Запрос);\r\n\tПоследнийПакет = СхемаЗапроса.ПакетЗапросов.Получить(СхемаЗапроса.ПакетЗапросов.Количество() - 1);\r\n\tПоследнийПакет.Операторы.Получить(0).КоличествоПолучаемыхЗаписей = КоличествоПолучаемыхЗаписей;\r\n\t\r\n\tНаборДанных.Запрос = СхемаЗапроса.ПолучитьТекстЗапроса();\r\n\t\t\r\nКонецПроцедуры"
  },
  {
    "title": "Авторские комментарии (с поддержкой EDT)",
    "description": "Пример скрипта с адаптацией под EDT",
    "code_snippet": ""
  },
  {
    "title": "Разные параметры ориентации для разных страниц печатной формы в БСП",
    "description": "Разные параметры ориентации для разных страниц печатной формы в БСП",
    "code_snippet": "Процедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\r\n\t\r\n\tСтруктураТипов = ОбщегоНазначенияУТ.СоответствиеМассивовПоТипамОбъектов(МассивОбъектов);\r\n\t\r\n\tПечатнаяФорма = УправлениеПечатью.СведенияОПечатнойФорме(КоллекцияПечатныхФорм, \"ext_ТОРГ2_АктОРасхожденияхПослеПриемки\");\r\n\tЕсли ПечатнаяФорма <> Неопределено Тогда\r\n\t\tМассивТабличныхДокументов = СформироватьПечатнуюФормуТорг2(СтруктураТипов, ОбъектыПечати, ПараметрыВывода);\r\n        //в массив возвращаем столько частей печатной формы, сколько нужно, задав для каждой ориентацию и масштаб\r\n\t\tДля К = 1 По МассивТабличныхДокументов.Количество() Цикл\r\n\t\t\tНоваяСтрока = КоллекцияПечатныхФорм.Добавить();\r\n\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, ПечатнаяФорма);\r\n\t\t\tНоваяСтрока.ТабличныйДокумент = МассивТабличныхДокументов[К-1];\r\n\t\t\tНоваяСтрока.ИмяМакета = НоваяСтрока.ИмяМакета + К;\r\n\t\t\tНоваяСтрока.ИмяВРЕГ = НоваяСтрока.ИмяВРЕГ + К;\r\n\t\t\tНоваяСтрока.СинонимМакета = СтрШаблон(НСтр(\"ru = 'ТОРГ-2 [%1 из %2]'\"), К, МассивТабличныхДокументов.Количество());\r\n\t\tКонецЦикла; \r\n\t\tКоллекцияПечатныхФорм.Удалить(ПечатнаяФорма);\r\n\tКонецЕсли;\r\n\t\r\n\tФормированиеПечатныхФорм.ЗаполнитьПараметрыОтправки(ПараметрыВывода.ПараметрыОтправки, МассивОбъектов, КоллекцияПечатныхФорм);\r\n\r\nКонецПроцедуры\n\nПроцедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\r\n\t\r\n\tСтруктураТипов = ОбщегоНазначенияУТ.СоответствиеМассивовПоТипамОбъектов(МассивОбъектов);\r\n\t\r\n\tПечатнаяФорма = УправлениеПечатью.СведенияОПечатнойФорме(КоллекцияПечатныхФорм, \"ext_ТОРГ2_АктОРасхожденияхПослеПриемки\");\r\n\tЕсли ПечатнаяФорма <> Неопределено Тогда\r\n\t\tМассивТабличныхДокументов = СформироватьПечатнуюФормуТорг2(СтруктураТипов, ОбъектыПечати, ПараметрыВывода);\r\n        //в массив возвращаем столько частей печатной формы, сколько нужно, задав для каждой ориентацию и масштаб\r\n\t\tДля К = 1 По МассивТабличныхДокументов.Количество() Цикл\r\n\t\t\tНоваяСтрока = КоллекцияПечатныхФорм.Добавить();\r\n\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, ПечатнаяФорма);\r\n\t\t\tНоваяСтрока.ТабличныйДокумент = МассивТабличныхДокументов[К-1];\r\n\t\t\tНоваяСтрока.ИмяМакета = НоваяСтрока.ИмяМакета + К;\r\n\t\t\tНоваяСтрока.ИмяВРЕГ = НоваяСтрока.ИмяВРЕГ + К;\r\n\t\t\tНоваяСтрока.СинонимМакета = СтрШаблон(НСтр(\"ru = 'ТОРГ-2 [%1 из %2]'\"), К, МассивТабличныхДокументов.Количество());\r\n\t\tКонецЦикла; \r\n\t\tКоллекцияПечатныхФорм.Удалить(ПечатнаяФорма);\r\n\tКонецЕсли;\r\n\t\r\n\tФормированиеПечатныхФорм.ЗаполнитьПараметрыОтправки(ПараметрыВывода.ПараметрыОтправки, МассивОбъектов, КоллекцияПечатныхФорм);\r\n\r\nКонецПроцедуры"
  },
  {
    "title": "RegEx1CAddin - внешняя компонента для выполнения регулярных выражений RegEx в 1С",
    "description": "Внешняя Native API компонента для выполнения регулярных выражений на платформе 1С:Предприятие 8. Поддерживает Windows, Linux, MacOS, Android, Chrome",
    "code_snippet": ""
  },
  {
    "title": "Опциональное выполнение метода в фоновом задании (БСП)",
    "description": "Опциональное выполнение метода в фоновом задании (БСП)",
    "code_snippet": "Процедура ВыполнитьВыгрузку(ВидВыгрузки, МестоВызова, ИсточникСсылка, ВФоне = Ложь, Отказ = Ложь) Экспорт\r\n\t\r\n\tЕсли НЕ ЗначениеЗаполнено(ИсточникСсылка) Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ВФоне Тогда\r\n\t\t\r\n\t\tДлительныеОперации.ВыполнитьПроцедуру(, \"БизнесПроцессыСлужебный.ПолучитьВыборкуИВыгрузить\", ВидВыгрузки, МестоВызова, ИсточникСсылка);\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tБизнесПроцессыСлужебный.ПолучитьВыборкуИВыгрузить(ВидВыгрузки, МестоВызова, ИсточникСсылка);\r\n\t\t\r\n\tКонецЕсли; \r\n\t\r\nКонецПроцедуры\n\nПроцедура ВыполнитьВыгрузку(ВидВыгрузки, МестоВызова, ИсточникСсылка, ВФоне = Ложь, Отказ = Ложь) Экспорт\r\n\t\r\n\tЕсли НЕ ЗначениеЗаполнено(ИсточникСсылка) Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ВФоне Тогда\r\n\t\t\r\n\t\tДлительныеОперации.ВыполнитьПроцедуру(, \"БизнесПроцессыСлужебный.ПолучитьВыборкуИВыгрузить\", ВидВыгрузки, МестоВызова, ИсточникСсылка);\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tБизнесПроцессыСлужебный.ПолучитьВыборкуИВыгрузить(ВидВыгрузки, МестоВызова, ИсточникСсылка);\r\n\t\t\r\n\tКонецЕсли; \r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Получить каталог \"Мои документы\"",
    "description": "Получить каталог \"Мои документы\"",
    "code_snippet": "ИмяОбработки = ЭтотОбъект.Метаданные().ПолноеИмя();\r\n\tКаталогСохранения = ХранилищеНастроекДанныхФорм.Загрузить(ИмяОбработки, \"КаталогСохранения\");\r\n\tЕсли ПустаяСтрока(КаталогСохранения) Тогда\r\n\t\tWSS = Новый COMОбъект(\"WScript.Shell\");\r\n\t\tКаталогСохранения = WSS.SpecialFolders().Item(\"MyDocuments\");\r\n\t\tWSS = Неопределено;\r\n\tКонецЕсли;\n\nИмяОбработки = ЭтотОбъект.Метаданные().ПолноеИмя();\r\n\tКаталогСохранения = ХранилищеНастроекДанныхФорм.Загрузить(ИмяОбработки, \"КаталогСохранения\");\r\n\tЕсли ПустаяСтрока(КаталогСохранения) Тогда\r\n\t\tWSS = Новый COMОбъект(\"WScript.Shell\");\r\n\t\tКаталогСохранения = WSS.SpecialFolders().Item(\"MyDocuments\");\r\n\t\tWSS = Неопределено;\r\n\tКонецЕсли;\n\n{5} Переменной КаталогСохранения присвоено значение, но оно нигде не используется\r\n{6} Переменной WSS присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Записать() на форме объекта",
    "description": "Записать() на форме объекта",
    "code_snippet": "// Записывает объект формы. Возвращает признак успеха. \r\n// Нужен для обхода недокументированного поведения платформы, описанного в https://infostart.ru/1c/articles/1396380/?ref=1159\r\n//  В СП описано, что метод формы Записать() возвращает признак успеха. \r\n//  Однако, если в ПередЗаписью() произойдёт Отказ, тогда метод падает в ошибку, которая фиксируется в ЖР.\r\n//  Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/26\r\n//\r\n// Параметры:\r\n//  Форма - ФормаКлиентскогоПриложения - Форма, объект которой нужно записать\r\n//  ПараметрыЗаписи  - Структура - ПараметрыЗаписи метода Записать() формы\r\n//  СообщитьПриИсключении - булево - нужно ли сообщать ОписаниеОшибки() при возникновении исключения\r\n//\r\n// Возвращаемое значение:\r\n//   Булево   - Истина - успешно записан; Ложь - в противном случае.\r\n//\r\nФункция ЗаписатьФорму(Форма, ПараметрыЗаписи, СообщитьПриИсключении = Истина) Экспорт\r\n\t\r\n\tПопытка\r\n\t\t//@skip-check dynamic-access-method-not-found\r\n\t\tЗаписанУспешно = Форма.Записать(ПараметрыЗаписи); //Булево\r\n\tИсключение\r\n\t    ЗаписанУспешно = Ложь;\r\n\t\tЕсли СообщитьПриИсключении Тогда\r\n\t\t\tСообщениеПользователю = Новый СообщениеПользователю();\r\n\t\t\tСообщениеПользователю.Текст = ОписаниеОшибки();\r\n\t\t\tСообщениеПользователю.Сообщить();\r\n\t\tКонецЕсли;\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат ЗаписанУспешно;\r\n\t\r\nКонецФункции\n\n// Записывает объект формы. Возвращает признак успеха. \r\n// Нужен для обхода недокументированного поведения платформы, описанного в https://infostart.ru/1c/articles/1396380/?ref=1159\r\n//  В СП описано, что метод формы Записать() возвращает признак успеха. \r\n//  Однако, если в ПередЗаписью() произойдёт Отказ, тогда метод падает в ошибку, которая фиксируется в ЖР.\r\n//  Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/26\r\n//\r\n// Параметры:\r\n//  Форма - ФормаКлиентскогоПриложения - Форма, объект которой нужно записать\r\n//  ПараметрыЗаписи  - Структура - ПараметрыЗаписи метода Записать() формы\r\n//  СообщитьПриИсключении - булево - нужно ли сообщать ОписаниеОшибки() при возникновении исключения\r\n//\r\n// Возвращаемое значение:\r\n//   Булево   - Истина - успешно записан; Ложь - в противном случае.\r\n//\r\nФункция ЗаписатьФорму(Форма, ПараметрыЗаписи, СообщитьПриИсключении = Истина) Экспорт\r\n\t\r\n\tПопытка\r\n\t\t//@skip-check dynamic-access-method-not-found\r\n\t\tЗаписанУспешно = Форма.Записать(ПараметрыЗаписи); //Булево\r\n\tИсключение\r\n\t    ЗаписанУспешно = Ложь;\r\n\t\tЕсли СообщитьПриИсключении Тогда\r\n\t\t\tСообщениеПользователю = Новый СообщениеПользователю();\r\n\t\t\tСообщениеПользователю.Текст = ОписаниеОшибки();\r\n\t\t\tСообщениеПользователю.Сообщить();\r\n\t\tКонецЕсли;\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат ЗаписанУспешно;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Код для очистки ранее созданной номенклатуры",
    "description": "Код для очистки ранее созданной номенклатуры",
    "code_snippet": "&НаСервере\n\nПроцедура ДобавлениеНовыхТоваровНаСервере()\n\tГСЧ=Новый ГенераторСлучайныхЧисел;\n\tДля Счетчик=1 По 100 Цикл\n\t\tЕсли Счетчик<=25 Тогда\n\t\t\tГруппа=Справочники.Номенклатура.НайтиПоНаименованию(\"Летние\");\n\t\tИначеЕсли Счетчик<=50 Тогда\n\t\t\tГруппа=Справочники.Номенклатура.НайтиПоНаименованию(\"С шипами\");\n\t\tИначе\n\t\t\tГруппа=Справочники.Номенклатура.НайтиПоНаименованию(\"Липучки\");\n\t\tКонецЕсли;\n\t\tНовыйТовар=Справочники.Номенклатура.СоздатьЭлемент();\n\t\tНовыйТовар.Родитель=Группа;\n\t\tНовыйТовар.Наименование=\"Товар №\"+Счетчик;\n\t\tНовыйТовар.Склад=Справочники.Склады.Оптовый;\n\t\tНовыйТовар.ЦенаЗакупочная=ГСЧ.СлучайноеЧисло(500,2000);\n\t\tНовыйТовар.ЦенаПоступления=НовыйТовар.ЦенаЗакупочная*1.2;\n\t\tНовыйТовар.Записать();\n\tКонецЦикла;\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ДобавлениеНовыхТоваров(Команда)\n\tДобавлениеНовыхТоваровНаСервере();\nКонецПроцедуры\n\n&НаСервере\nПроцедура ОчиститьСписокНаСервере()\n\tГСЧ=Новый ГенераторСлучайныхЧисел;\n\tДля Счетчик=1 По 100 Цикл\n\t\tЕсли Счетчик<=25 Тогда\n\t\t\tГруппа=Справочники.Номенклатура.НайтиПоНаименованию(\"Летние\");\n\t\tИначеЕсли Счетчик<=50 Тогда\n\t\t\tГруппа=Справочники.Номенклатура.НайтиПоНаименованию(\"С шипами\");\n\t\tИначе\n\t\t\tГруппа=Справочники.Номенклатура.НайтиПоНаименованию(\"Липучки\");\n\t\tКонецЕсли;\n\t\tОчиститьСписок=Справочники.Номенклатура.НайтиПоНаименованию(\"Летние\");\n\t\tОчиститьСписок.Наименование=\"Товар №\";\n\t\tОчиститьСписок.Наименование.Удалить();\n\t\tОчиститьСписок.Записать();\n\tКонецЦикла;\n\t\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ОчиститьСписок(Команда)\n\tОчиститьСписокНаСервере();\nКонецПроцедуры\n\n&НаСервере\nПроцедура ОчиститьСписокНаСервере()\n\tВыборка = Справочники.Номенклатура.Выбрать();\n\tПока Выборка.Следующий() Цикл\n\t\tЕсли НЕ Выборка.ЭтоГруппа Тогда\n\t\t\tОб = Выборка.ПолучитьОбъект();\n\t\t\tОб.Удалить();\n\t\tКонецЕсли;\n\tКонецЦикла;\nКонецПроцедуры"
  },
  {
    "title": "Как войти в справочник или документ которого нет в меню",
    "description": "Как войти в справочник или документ которого нет в менюЛайфхаки 1С",
    "code_snippet": ""
  },
  {
    "title": "Отбор при начале выбора",
    "description": "Отбор при начале выбора",
    "code_snippet": "&НаКлиенте\nПроцедура МагазинНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)\n\n    СтандартнаяОбработка = Ложь;\n\n    фиксНастройки = Новый НастройкиКомпоновкиДанных;\n\n    Отбор = фиксНастройки.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\n    Отбор.ЛевоеЗначение    = Новый ПолеКомпоновкиДанных(\"Ссылка\");\n    Отбор.ВидСравнения     = ВидСравненияКомпоновкиДанных.ВСписке;\n    Отбор.ПравоеЗначение   = ПолучитьСписокЗначенийНаСервере(Элементы.ИмяТЧ.ТекущиеДанные.КакойтоРеквизит);\n    Отбор.Использование    = Истина;\n    Отбор.РежимОтображения = РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Недоступный;\n\n    ПараметрыФормы = Новый Структура;\n    ПараметрыФормы.Вставить(\"ФиксированныеНастройки\", фиксНастройки);\n\n    ОткрытьФорму(\"Справочник.Магазины.ФормаВыбора\", ПараметрыФормы, Элемент);\n\nКонецПроцедуры\n\nОрфографическая ошибка в КакойтоРеквизит: Какойто"
  },
  {
    "title": "Удалить недоступные отборы",
    "description": "Удалить недоступные отборы",
    "code_snippet": "// Рекурсивно удаляет недоступные элементы из коллекции отборов\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/15\r\n//\r\n// Написан для статьи Как ограничить поля отбора в динамическом списке и ничего не сломать: \r\n// https://infostart.ru/public/1226445/?ref=1159\r\n//\r\n// Параметры:\r\n//  Коллекция  - КоллекцияЭлементовПользовательскихНастроекКомпоновкиДанных, КоллекцияЭлементовОтбораКомпоновкиДанных - Коллекция элементов отбора.\r\n//  ДоступныеПоляОтбора  - Неопределено, ДоступныеПоляКомпоновкиДанных - Список доступных полей отбора. При первоначальном вызове не передаётся.\r\n//\r\n// Пример:\r\n//\tСписок.УстановитьОграниченияИспользованияВОтборе(ЗапрещенныеВОтбореПоля);\r\n//\tУдалитьНедоступныеОтборы(Список.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы);\r\n//    \r\nПроцедура УдалитьНедоступныеОтборы(Знач Коллекция, Знач ДоступныеПоляОтбора = Неопределено) Экспорт\r\n\t\r\n\tУдаляемыеЭлементы = Новый Массив; // Массив из ЭлементОтбораКомпоновкиДанных\r\n\t\r\n\tДля Каждого ТекущиеДанные Из Коллекция Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(ТекущиеДанные) = Тип(\"ОтборКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tУдалитьНедоступныеОтборы(ТекущиеДанные.Элементы, ТекущиеДанные.ДоступныеПоляОтбора);\r\n\t\t\t\r\n\t\tИначеЕсли ТипЗнч(ТекущиеДанные) = Тип(\"ГруппаЭлементовОтбораКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tУдалитьНедоступныеОтборы(ТекущиеДанные.Элементы, ДоступныеПоляОтбора);\r\n\t\t\t                 \r\n\t\tИначеЕсли ТипЗнч(ТекущиеДанные) = Тип(\"ЭлементОтбораКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tЕсли НЕ ТекущиеДанные.Использование Тогда\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tДля Каждого ИмяСвойства Из СтрРазделить(\"ЛевоеЗначение,ПравоеЗначение\",\",\") Цикл\r\n\t\t\t\t\r\n\t\t\t\tТекущееПоле = ТекущиеДанные[ИмяСвойства]; // ПолеКомпоновкиДанных\r\n\t\t\t\tЕсли ТипЗнч(ТекущееПоле) = Тип(\"ПолеКомпоновкиДанных\") \r\n\t\t\t\t\tИ ДоступныеПоляОтбора.НайтиПоле(ТекущееПоле) = Неопределено Тогда\r\n\t\t\t\t\t\r\n\t\t\t\t\tУдаляемыеЭлементы.Добавить(ТекущиеДанные);\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\t\t\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого УдаляемыйЭлемент Из УдаляемыеЭлементы Цикл\r\n\t\tКоллекция.Удалить(УдаляемыйЭлемент);\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n// Рекурсивно удаляет недоступные элементы из коллекции отборов\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/15\r\n//\r\n// Написан для статьи Как ограничить поля отбора в динамическом списке и ничего не сломать: \r\n// https://infostart.ru/public/1226445/?ref=1159\r\n//\r\n// Параметры:\r\n//  Коллекция  - КоллекцияЭлементовПользовательскихНастроекКомпоновкиДанных, КоллекцияЭлементовОтбораКомпоновкиДанных - Коллекция элементов отбора.\r\n//  ДоступныеПоляОтбора  - Неопределено, ДоступныеПоляКомпоновкиДанных - Список доступных полей отбора. При первоначальном вызове не передаётся.\r\n//\r\n// Пример:\r\n//\tСписок.УстановитьОграниченияИспользованияВОтборе(ЗапрещенныеВОтбореПоля);\r\n//\tУдалитьНедоступныеОтборы(Список.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы);\r\n//    \r\nПроцедура УдалитьНедоступныеОтборы(Знач Коллекция, Знач ДоступныеПоляОтбора = Неопределено) Экспорт\r\n\t\r\n\tУдаляемыеЭлементы = Новый Массив; // Массив из ЭлементОтбораКомпоновкиДанных\r\n\t\r\n\tДля Каждого ТекущиеДанные Из Коллекция Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(ТекущиеДанные) = Тип(\"ОтборКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tУдалитьНедоступныеОтборы(ТекущиеДанные.Элементы, ТекущиеДанные.ДоступныеПоляОтбора);\r\n\t\t\t\r\n\t\tИначеЕсли ТипЗнч(ТекущиеДанные) = Тип(\"ГруппаЭлементовОтбораКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tУдалитьНедоступныеОтборы(ТекущиеДанные.Элементы, ДоступныеПоляОтбора);\r\n\t\t\t                 \r\n\t\tИначеЕсли ТипЗнч(ТекущиеДанные) = Тип(\"ЭлементОтбораКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tЕсли НЕ ТекущиеДанные.Использование Тогда\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tДля Каждого ИмяСвойства Из СтрРазделить(\"ЛевоеЗначение,ПравоеЗначение\",\",\") Цикл\r\n\t\t\t\t\r\n\t\t\t\tТекущееПоле = ТекущиеДанные[ИмяСвойства]; // ПолеКомпоновкиДанных\r\n\t\t\t\tЕсли ТипЗнч(ТекущееПоле) = Тип(\"ПолеКомпоновкиДанных\") \r\n\t\t\t\t\tИ ДоступныеПоляОтбора.НайтиПоле(ТекущееПоле) = Неопределено Тогда\r\n\t\t\t\t\t\r\n\t\t\t\t\tУдаляемыеЭлементы.Добавить(ТекущиеДанные);\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\t\t\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого УдаляемыйЭлемент Из УдаляемыеЭлементы Цикл\r\n\t\tКоллекция.Удалить(УдаляемыйЭлемент);\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Быстрое удаление строк в таблице значений",
    "description": "Быстрое удаление строк в таблице значений",
    "code_snippet": "РабочаяТаблица = РабочаяТаблица.Скопировать(Новый Структура(\"КУдалению\", Ложь))\n\nРабочаяТаблица = РабочаяТаблица.Скопировать(Новый Структура(\"КУдалению\", Ложь))\n\n{1} Переменной РабочаяТаблица присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Получить всех родителей элемента",
    "description": "Получить всех родителей элемента",
    "code_snippet": "// Возвращает всех родителей элемента, согласно рекомендациям на ИТС:\r\n// см. https://its.1c.ru/db/metod8dev/content/2659/hdoc\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/14\r\n// \r\n// Параметры:\r\n//  Ссылка  - СправочникСсылка, ПланВидовХарактеристикСсылка - Ссылка на элемент, родителей которого нужно найти\r\n//  КоличествоВыбираемыхЗаПорцию  - Число - Количество выбираемых родителей за одно выполнение запроса. \r\n//\t\tИспользуется минимальное число из переданного и ограничения количества уровней в конфигураторе\r\n//\r\n// Возвращаемое значение:\r\n//   Массив из СправочникСсылка, ПланВидовХарактеристикСсылка - массив с родителями элемента\r\n//   \r\n// Пример:\r\n//   \r\n//   Результат = РодителиЭлемента(ЭлементБазы);\r\n//   //Результат - массив с ссылками на родителей элемента\r\n//   \r\nФункция РодителиЭлемента(Знач Ссылка, Знач КоличествоВыбираемыхЗаПорцию = 5) Экспорт\r\n\t\r\n\tРодителиЭлемента = Новый Массив; // Массив из см. РодителиЭлемента.Ссылка\r\n\tЕсли НЕ ЗначениеЗаполнено(Ссылка) Тогда\r\n\t\tВозврат РодителиЭлемента;\r\n\tКонецЕсли;\r\n\t\r\n\tМетаданныеЭлемента = Ссылка.Метаданные();\r\n\tЕсли МетаданныеЭлемента.ОграничиватьКоличествоУровней Тогда\r\n\t\tКоличествоВыбираемыхЗаПорцию = Мин(КоличествоВыбираемыхЗаПорцию, МетаданныеЭлемента.КоличествоУровней);\r\n\tКонецЕсли;\r\n\t\r\n\tВыбираемыеПоля = Новый Массив; // Массив из Строка\r\n\tВыбираемоеПоле = \"Родитель\";\r\n\tДля НомерРодителя = 1 По КоличествоВыбираемыхЗаПорцию Цикл\r\n\t\tВыбираемыеПоля.Добавить(ВыбираемоеПоле);\r\n\t\tВыбираемоеПоле = ВыбираемоеПоле + \".Родитель\";\r\n\tКонецЦикла;\r\n\t\r\n\tТекстЗапроса = \"ВЫБРАТЬ %1 ИЗ %2 ГДЕ Ссылка = &ТекущийЭлемент\";\r\n\tТекстЗапроса = СтрШаблон(ТекстЗапроса, СтрСоединить(ВыбираемыеПоля, \",\"), МетаданныеЭлемента.ПолноеИмя());\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\t\r\n\tТекущийЭлемент = Ссылка;\r\n\tПока ЗначениеЗаполнено(ТекущийЭлемент) Цикл\r\n\t\t\r\n\t\tЗапрос.УстановитьПараметр(\"ТекущийЭлемент\", ТекущийЭлемент); \r\n\t\tРезультат = Запрос.Выполнить(); //@skip-check query-in-loop\r\n\t\tЕсли Результат.Пустой() Тогда \r\n\t\t\tПрервать; \r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tВыборка = Результат.Выбрать(); \r\n\t\tВыборка.Следующий(); \r\n\t\tДля НомерКолонки = 0 По Результат.Колонки.Количество() - 1 Цикл \r\n\t\t\tТекущийЭлемент = Выборка[НомерКолонки]; // см. РодителиЭлемента.Ссылка\r\n\t\t\tЕсли ЗначениеЗаполнено(ТекущийЭлемент) Тогда \r\n\t\t\t\tРодителиЭлемента.Добавить(ТекущийЭлемент);\r\n\t\t\tИначе \r\n\t\t\t\tПрервать;\r\n\t\t\tКонецЕсли; \r\n\t\tКонецЦикла; \r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат РодителиЭлемента;\r\n\t\r\nКонецФункции\n\n// Возвращает всех родителей элемента, согласно рекомендациям на ИТС:\r\n// см. https://its.1c.ru/db/metod8dev/content/2659/hdoc\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/14\r\n// \r\n// Параметры:\r\n//  Ссылка  - СправочникСсылка, ПланВидовХарактеристикСсылка - Ссылка на элемент, родителей которого нужно найти\r\n//  КоличествоВыбираемыхЗаПорцию  - Число - Количество выбираемых родителей за одно выполнение запроса. \r\n//\t\tИспользуется минимальное число из переданного и ограничения количества уровней в конфигураторе\r\n//\r\n// Возвращаемое значение:\r\n//   Массив из СправочникСсылка, ПланВидовХарактеристикСсылка - массив с родителями элемента\r\n//   \r\n// Пример:\r\n//   \r\n//   Результат = РодителиЭлемента(ЭлементБазы);\r\n//   //Результат - массив с ссылками на родителей элемента\r\n//   \r\nФункция РодителиЭлемента(Знач Ссылка, Знач КоличествоВыбираемыхЗаПорцию = 5) Экспорт\r\n\t\r\n\tРодителиЭлемента = Новый Массив; // Массив из см. РодителиЭлемента.Ссылка\r\n\tЕсли НЕ ЗначениеЗаполнено(Ссылка) Тогда\r\n\t\tВозврат РодителиЭлемента;\r\n\tКонецЕсли;\r\n\t\r\n\tМетаданныеЭлемента = Ссылка.Метаданные();\r\n\tЕсли МетаданныеЭлемента.ОграничиватьКоличествоУровней Тогда\r\n\t\tКоличествоВыбираемыхЗаПорцию = Мин(КоличествоВыбираемыхЗаПорцию, МетаданныеЭлемента.КоличествоУровней);\r\n\tКонецЕсли;\r\n\t\r\n\tВыбираемыеПоля = Новый Массив; // Массив из Строка\r\n\tВыбираемоеПоле = \"Родитель\";\r\n\tДля НомерРодителя = 1 По КоличествоВыбираемыхЗаПорцию Цикл\r\n\t\tВыбираемыеПоля.Добавить(ВыбираемоеПоле);\r\n\t\tВыбираемоеПоле = ВыбираемоеПоле + \".Родитель\";\r\n\tКонецЦикла;\r\n\t\r\n\tТекстЗапроса = \"ВЫБРАТЬ %1 ИЗ %2 ГДЕ Ссылка = &ТекущийЭлемент\";\r\n\tТекстЗапроса = СтрШаблон(ТекстЗапроса, СтрСоединить(ВыбираемыеПоля, \",\"), МетаданныеЭлемента.ПолноеИмя());\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\t\r\n\tТекущийЭлемент = Ссылка;\r\n\tПока ЗначениеЗаполнено(ТекущийЭлемент) Цикл\r\n\t\t\r\n\t\tЗапрос.УстановитьПараметр(\"ТекущийЭлемент\", ТекущийЭлемент); \r\n\t\tРезультат = Запрос.Выполнить(); //@skip-check query-in-loop\r\n\t\tЕсли Результат.Пустой() Тогда \r\n\t\t\tПрервать; \r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tВыборка = Результат.Выбрать(); \r\n\t\tВыборка.Следующий(); \r\n\t\tДля НомерКолонки = 0 По Результат.Колонки.Количество() - 1 Цикл \r\n\t\t\tТекущийЭлемент = Выборка[НомерКолонки]; // см. РодителиЭлемента.Ссылка\r\n\t\t\tЕсли ЗначениеЗаполнено(ТекущийЭлемент) Тогда \r\n\t\t\t\tРодителиЭлемента.Добавить(ТекущийЭлемент);\r\n\t\t\tИначе \r\n\t\t\t\tПрервать;\r\n\t\t\tКонецЕсли; \r\n\t\tКонецЦикла; \r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат РодителиЭлемента;\r\n\t\r\nКонецФункции\n\n&НаСервереБезКонтекста\nФункция РодителиЭлемента(Знач СсылкаНаЭлемент)\n\t\t\n\t\tРодителиЭлемента = Новый Массив;\n\n\t\tПока ЗначениеЗаполнено(СсылкаНаЭлемент.Родитель) Цикл\n\t\t\tРодителиЭлемента.Вставить(0, СсылкаНаЭлемент.Родитель);\n\t\t\tСсылкаНаЭлемент = СсылкаНаЭлемент.Родитель;\n\t\tКонецЦикла;\n\t\t\n\t\tВозврат РодителиЭлемента;\n\t\t\nКонецФункции;"
  },
  {
    "title": "Обновить список документов - аналог кнопки F5",
    "description": "Обновить список документов - аналог кнопки F5",
    "code_snippet": "ОповеститьОбИзменении(Тип(\"ДокументСсылка.РаботаВВыходныеИПраздничныеДни\"));\n\nОповеститьОбИзменении(Тип(\"ДокументСсылка.РаботаВВыходныеИПраздничныеДни\"));"
  },
  {
    "title": "Удаление повторяющихся символов в начале или конце текста",
    "description": "Удаление повторяющихся символов в начале или конце текста",
    "code_snippet": "//Например, чтобы удалить любое количество точек в конце строки, можно воспользоваться выражением:\r\nСтрЗаменить(СокрП(СтрЗаменить(ИсходнаяСтрока, \".\", \" \")), \" \", \".\")\r\n\r\n//Правда, если исходная строка изначально содержит пробелы, то результат будет неправильным. В этом случае предварительно требуется заменить пробелы каким-либо редким сочетанием символов, а после преобразования выполнить обратную замену.\r\n\r\nСтрЗаменить(СтрЗаменить(СокрП(СтрЗаменить(СтрЗаменить(ИсходнаяСтрока, \" \", Символы.НПП), \".\", \" \")), \" \", \".\"), Символы.НПП, \" \")\n\n//Например, чтобы удалить любое количество точек в конце строки, можно воспользоваться выражением:\r\nСтрЗаменить(СокрП(СтрЗаменить(ИсходнаяСтрока, \".\", \" \")), \" \", \".\")\r\n\r\n//Правда, если исходная строка изначально содержит пробелы, то результат будет неправильным. В этом случае предварительно требуется заменить пробелы каким-либо редким сочетанием символов, а после преобразования выполнить обратную замену.\r\n\r\nСтрЗаменить(СтрЗаменить(СокрП(СтрЗаменить(СтрЗаменить(ИсходнаяСтрока, \" \", Символы.НПП), \".\", \" \")), \" \", \".\"), Символы.НПП, \" \")"
  },
  {
    "title": "Подсистема \"Инструменты разработчика\" для 1С 8.2 и 8.3",
    "description": "Продукт представляет собой интегрированный в подсистему набор мощных инструментов разработчика на платформе 1С 8. Почти все они выполнены на обычных формах и потому работают только в толстых клиентах. Подсистема получила награду \"Лучшая разработка\" на конференции Infostart Event Evolution 2013.",
    "code_snippet": ""
  },
  {
    "title": "Определение, вместится ли текст в ячейку табличного документа",
    "description": "Определение, вместится ли текст в ячейку табличного документа",
    "code_snippet": "//Функция для определения вместится ли текст в ячейку:\r\n//\r\n// Параметры:\r\n//  пОбласть -Область табличного документа- Область табличного документа, которую надо проверить на вместимости.\r\n//\t\"пОбласть = пТабДок.Области.ТекстЗаготовки;\". \"ТекстЗаготовки\" имя ячейки.\r\n//\r\n//  Для возможности использования этого метода необходимо соблюдать следующие условия:\r\n// \r\n//\tпТабДок - Табличный документ - Табличный документ, в котором происходит проверка.\r\n//  \"пТабДок = Макет.ПолучитьОбласть(\"ТекстЗаготовки\");\"\r\n//\r\n//  пТекст - Строка - Проверяемый текст.\r\n//\r\n//\t1. Необходимо как-нибудь назвать область.\r\n//\t2. Заполнение области = Текст, а не Параметр или Шаблон.\r\n//\tВо всяком случае, я ничего простого не придумал. И так как жизнь это усложняет не сильно не стал заморачиваться из-за этого.\r\n//\t3. Размещение текста (Параметр ячейки) = Перенос. Вот это нужно обязательно! Размещение текста програмно поставить можно, но эффект от изменения,\r\n//\tнасколько я понял, появляется только после отображения табличного документа с этой ячейкой.\r\n//\r\n// Возвращаемое значение:\r\n//  Булево.\r\n//\r\nФункция ТекстУмещаетсяВЯчейке(пОбласть, пТабДок, пТекст) Экспорт\r\n\t\r\n\tВысотаДо = ВысотаОбластиВмм(пОбласть, пТабДок);\r\n\t\r\n\t// Скопируем область в новый табличный документ.\r\n\t// И там уже будем играть с её свойствами.\r\n\tВремТабДок = Новый ТабличныйДокумент;\r\n\tВремТабДок.Вывести(пТабДок);\r\n\tВремОбласть = ВремТабДок.Область(пОбласть.Имя);\r\n\t\r\n\tВремОбласть.АвтоВысотаСтроки = Истина;\r\n\tВремОбласть.ВысотаСтроки     = 0;\r\n\t\r\n\tВремОбласть.Текст = пТекст + \"Щ\"; // Для исключения ситуаций вида \"на грани переноса\"\r\n\tВысотаПосле       = ВысотаОбластиВмм(ВремОбласть, ВремТабДок);\r\n\t\r\n\tВозврат ВысотаДо >= ВысотаПосле;\r\n\t\r\nКонецФункции\r\n\r\n\r\n//Функция возвращает высоту области таб. документа в мм\r\n//\r\n// Параметры:\r\n// пОбласть - Область табличного документа -  Область табличного документа которую надо проверить.\r\n// \r\n// пТабДок - Табличный документ - Табличный документ, в котором происходит проверка.\r\n//\r\n// Возвращаемое значение:\r\n// число.\r\n//\r\nФункция ВысотаОбластиВмм(пОбласть, пТабДок)\r\n    \r\n    Надпись = пТабДок.Рисунки.Добавить(ТипРисункаТабличногоДокумента.Текст);    \r\n    Надпись.Расположить(пОбласть);    \r\n    Высота = Надпись.Высота;    \r\n    пТабДок.Рисунки.Удалить(Надпись);\r\n    \r\n    Возврат(Высота);\r\n    \r\nКонецФункции\n\n//Функция для определения вместится ли текст в ячейку:\r\n//\r\n// Параметры:\r\n//  пОбласть -Область табличного документа- Область табличного документа, которую надо проверить на вместимости.\r\n//\t\"пОбласть = пТабДок.Области.ТекстЗаготовки;\". \"ТекстЗаготовки\" имя ячейки.\r\n//\r\n//  Для возможности использования этого метода необходимо соблюдать следующие условия:\r\n// \r\n//\tпТабДок - Табличный документ - Табличный документ, в котором происходит проверка.\r\n//  \"пТабДок = Макет.ПолучитьОбласть(\"ТекстЗаготовки\");\"\r\n//\r\n//  пТекст - Строка - Проверяемый текст.\r\n//\r\n//\t1. Необходимо как-нибудь назвать область.\r\n//\t2. Заполнение области = Текст, а не Параметр или Шаблон.\r\n//\tВо всяком случае, я ничего простого не придумал. И так как жизнь это усложняет не сильно не стал заморачиваться из-за этого.\r\n//\t3. Размещение текста (Параметр ячейки) = Перенос. Вот это нужно обязательно! Размещение текста програмно поставить можно, но эффект от изменения,\r\n//\tнасколько я понял, появляется только после отображения табличного документа с этой ячейкой.\r\n//\r\n// Возвращаемое значение:\r\n//  Булево.\r\n//\r\nФункция ТекстУмещаетсяВЯчейке(пОбласть, пТабДок, пТекст) Экспорт\r\n\t\r\n\tВысотаДо = ВысотаОбластиВмм(пОбласть, пТабДок);\r\n\t\r\n\t// Скопируем область в новый табличный документ.\r\n\t// И там уже будем играть с её свойствами.\r\n\tВремТабДок = Новый ТабличныйДокумент;\r\n\tВремТабДок.Вывести(пТабДок);\r\n\tВремОбласть = ВремТабДок.Область(пОбласть.Имя);\r\n\t\r\n\tВремОбласть.АвтоВысотаСтроки = Истина;\r\n\tВремОбласть.ВысотаСтроки     = 0;\r\n\t\r\n\tВремОбласть.Текст = пТекст + \"Щ\"; // Для исключения ситуаций вида \"на грани переноса\"\r\n\tВысотаПосле       = ВысотаОбластиВмм(ВремОбласть, ВремТабДок);\r\n\t\r\n\tВозврат ВысотаДо >= ВысотаПосле;\r\n\t\r\nКонецФункции\r\n\r\n\r\n//Функция возвращает высоту области таб. документа в мм\r\n//\r\n// Параметры:\r\n// пОбласть - Область табличного документа -  Область табличного документа которую надо проверить.\r\n// \r\n// пТабДок - Табличный документ - Табличный документ, в котором происходит проверка.\r\n//\r\n// Возвращаемое значение:\r\n// число.\r\n//\r\nФункция ВысотаОбластиВмм(пОбласть, пТабДок)\r\n    \r\n    Надпись = пТабДок.Рисунки.Добавить(ТипРисункаТабличногоДокумента.Текст);    \r\n    Надпись.Расположить(пОбласть);    \r\n    Высота = Надпись.Высота;    \r\n    пТабДок.Рисунки.Удалить(Надпись);\r\n    \r\n    Возврат(Высота);\r\n    \r\nКонецФункции\n\nОрфографическая ошибка в нибудь: нибудь\r\nОрфографическая ошибка в заморачиваться: заморачиваться\r\nОрфографическая ошибка в програмно: програмно"
  },
  {
    "title": "1С RabbitMQ. Вебинар от Алексея Лустина",
    "description": "Научись создавать систему обмена сообщениями 1С RabbitMQ за 5 часов",
    "code_snippet": ""
  },
  {
    "title": "Вывести все доступные поля СКД",
    "description": "Вывести все доступные поля СКД",
    "code_snippet": "// Выводит в коллекцию выбранных полей СКД все доступные поля.\r\n// Метод иерархический, для вызова достаточно передать коллекцию выбранных полей, которые нужно заполнить.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/18\r\n//\r\n// Параметры:\r\n//\r\n//  ВыбранныеПоляКомпоновки  - ВыбранныеПоляКомпоновкиДанных, КоллекцияВыбранныхПолейКомпоновкиДанных  - \r\n//\t\t\t\t\t\tВыбранные поля компоновки, которые необходимо заполнить\r\n//\r\n//  КоллекцияДоступныхПолей  - Неопределено, ДоступныеПоляКомпоновкиДанных - \r\n//\t\t\t\t\t\tПараметр для иерархических вызовов процедуры из себя самой же. \r\n//\t\t\t\t\t\tПри использовании передавать не нужно.\r\n//\r\n// Пример:\r\n//  ВывестиВсеДоступныеПоляВыбора(Настройки.Выбор); //Выводит все доступные поля\r\n//\r\nПроцедура ВывестиВсеДоступныеПоляВыбора(Знач ВыбранныеПоляКомпоновки, Знач КоллекцияДоступныхПолей = Неопределено) Экспорт\r\n\t\r\n\tЕсли КоллекцияДоступныхПолей = Неопределено Тогда\r\n\t\tКоллекцияДоступныхПолей = ВыбранныеПоляКомпоновки.ДоступныеПоляВыбора;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ТипЗнч(ВыбранныеПоляКомпоновки) = Тип(\"ВыбранныеПоляКомпоновкиДанных\") Тогда\r\n\t\tКоллекцияВыбранныхПолей = ВыбранныеПоляКомпоновки.Элементы;\r\n\tИначе\r\n\t\tКоллекцияВыбранныхПолей = ВыбранныеПоляКомпоновки;\r\n\tКонецЕсли;\r\n\t\r\n\tТекущийРодитель = Новый Структура(\"Родитель\", Неопределено);\r\n\tЗаполнитьЗначенияСвойств(ТекущийРодитель, КоллекцияДоступныхПолей);\r\n\tТекущийРодитель = ТекущийРодитель.Родитель;\r\n\t\r\n\tДля Каждого ДоступноеПолеВыбора Из КоллекцияДоступныхПолей.Элементы Цикл\r\n\t\t\r\n\t\tЕсли ДоступноеПолеВыбора.Папка Тогда\r\n\t\t\tВыбранноеПоле = КоллекцияВыбранныхПолей.Добавить(Тип(\"ГруппаВыбранныхПолейКомпоновкиДанных\"));\r\n\t\t\tВывестиВсеДоступныеПоляВыбора(ВыбранноеПоле.Элементы, ДоступноеПолеВыбора);\r\n\t\tИначе\r\n\t\t\tВыбранноеПоле = КоллекцияВыбранныхПолей.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЗаполнитьЗначенияСвойств(ВыбранноеПоле, ДоступноеПолеВыбора, \"Поле,Заголовок\");\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n// Выводит в коллекцию выбранных полей СКД все доступные поля.\r\n// Метод иерархический, для вызова достаточно передать коллекцию выбранных полей, которые нужно заполнить.\r\n// Источник: https://github.com/SeiOkami/CollectionMethodsOneS/issues/18\r\n//\r\n// Параметры:\r\n//\r\n//  ВыбранныеПоляКомпоновки  - ВыбранныеПоляКомпоновкиДанных, КоллекцияВыбранныхПолейКомпоновкиДанных  - \r\n//\t\t\t\t\t\tВыбранные поля компоновки, которые необходимо заполнить\r\n//\r\n//  КоллекцияДоступныхПолей  - Неопределено, ДоступныеПоляКомпоновкиДанных - \r\n//\t\t\t\t\t\tПараметр для иерархических вызовов процедуры из себя самой же. \r\n//\t\t\t\t\t\tПри использовании передавать не нужно.\r\n//\r\n// Пример:\r\n//  ВывестиВсеДоступныеПоляВыбора(Настройки.Выбор); //Выводит все доступные поля\r\n//\r\nПроцедура ВывестиВсеДоступныеПоляВыбора(Знач ВыбранныеПоляКомпоновки, Знач КоллекцияДоступныхПолей = Неопределено) Экспорт\r\n\t\r\n\tЕсли КоллекцияДоступныхПолей = Неопределено Тогда\r\n\t\tКоллекцияДоступныхПолей = ВыбранныеПоляКомпоновки.ДоступныеПоляВыбора;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ТипЗнч(ВыбранныеПоляКомпоновки) = Тип(\"ВыбранныеПоляКомпоновкиДанных\") Тогда\r\n\t\tКоллекцияВыбранныхПолей = ВыбранныеПоляКомпоновки.Элементы;\r\n\tИначе\r\n\t\tКоллекцияВыбранныхПолей = ВыбранныеПоляКомпоновки;\r\n\tКонецЕсли;\r\n\t\r\n\tТекущийРодитель = Новый Структура(\"Родитель\", Неопределено);\r\n\tЗаполнитьЗначенияСвойств(ТекущийРодитель, КоллекцияДоступныхПолей);\r\n\tТекущийРодитель = ТекущийРодитель.Родитель;\r\n\t\r\n\tДля Каждого ДоступноеПолеВыбора Из КоллекцияДоступныхПолей.Элементы Цикл\r\n\t\t\r\n\t\tЕсли ДоступноеПолеВыбора.Папка Тогда\r\n\t\t\tВыбранноеПоле = КоллекцияВыбранныхПолей.Добавить(Тип(\"ГруппаВыбранныхПолейКомпоновкиДанных\"));\r\n\t\t\tВывестиВсеДоступныеПоляВыбора(ВыбранноеПоле.Элементы, ДоступноеПолеВыбора);\r\n\t\tИначе\r\n\t\t\tВыбранноеПоле = КоллекцияВыбранныхПолей.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЗаполнитьЗначенияСвойств(ВыбранноеПоле, ДоступноеПолеВыбора, \"Поле,Заголовок\");\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n{31} Переменной ТекущийРодитель присвоено значение, но оно нигде не используется"
  },
  {
    "title": "\"Использовать в качестве значения поле\" программно",
    "description": "\"Использовать в качестве значения поле\" программно",
    "code_snippet": "&НаКлиенте\nПроцедура УсловияОтбораПриНачалеРедактирования(Элемент, НоваяСтрока, Копирование)\n\t\n\tЕсли НЕ НоваяСтрока ИЛИ Копирование Тогда\n\t\tВозврат;\n\tКонецЕсли;\n\t\n\tТекущаяСтрока = Элемент.ТекущаяСтрока;\n\tЕсли ТекущаяСтрока = Неопределено Тогда\n\t\tВозврат;\n\tКонецЕсли;\n\t\n\tЭлементОтбора = КомпоновщикНастроек.Настройки.Отбор.ПолучитьОбъектПоИдентификатору(ТекущаяСтрока);\n\tЕсли ТипЗнч(ЭлементОтбора) <> Тип(\"ЭлементОтбораКомпоновкиДанных\") Тогда\n\t\tВозврат;\n\tКонецЕсли;\n\t\n\tЭлементОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных(\"\");\n\tЭлементОтбора.ПравоеЗначение = Новый ПолеКомпоновкиДанных(\"\");\n\t\nКонецПроцедуры"
  },
  {
    "title": "1С + Kafka. Вебинар от Алексея Лустина",
    "description": "Научись создавать систему обмена сообщениями для 1С на Apache Kafka за 5 часов",
    "code_snippet": ""
  },
  {
    "title": "Актуальные символы препроцессора",
    "description": "Актуальные символы препроцессора",
    "code_snippet": "&НаКлиентеНаСервере\r\nФункция АктуальныеСимволыПрепроцессора() Экспорт\r\n    \r\n    Результат = новый Массив;\r\n    \r\n    #Если НаКлиенте Тогда\r\n        Результат.Добавить(\"НаКлиенте\");\r\n    #КонецЕсли\r\n    \r\n    #Если НаСервере Тогда\r\n        Результат.Добавить(\"НаСервере\");\r\n    #КонецЕсли\r\n    \r\n    #Если Клиент Тогда\r\n        Результат.Добавить(\"Клиент\");\r\n    #КонецЕсли\r\n    \r\n    #Если Сервер Тогда\r\n        Результат.Добавить(\"Сервер\");\r\n    #КонецЕсли\r\n    \r\n    #Если МобильноеПриложениеКлиент Тогда\r\n        Результат.Добавить(\"МобильноеПриложениеКлиент\");\r\n    #КонецЕсли\r\n    \r\n    #Если МобильноеПриложениеСервер Тогда\r\n        Результат.Добавить(\"МобильноеПриложениеСервер\");\r\n    #КонецЕсли\r\n    \r\n    #Если МобильныйКлиент Тогда\r\n        Результат.Добавить(\"МобильныйКлиент\");\r\n    #КонецЕсли\r\n    \r\n    #Если ТолстыйКлиентОбычноеПриложение Тогда\r\n        Результат.Добавить(\"ТолстыйКлиентОбычноеПриложение\");\r\n    #КонецЕсли\r\n        \r\n    #Если ТолстыйКлиентУправляемоеПриложение Тогда\r\n        Результат.Добавить(\"ТолстыйКлиентУправляемоеПриложение\");\r\n    #КонецЕсли\r\n    \r\n    #Если ВнешнееСоединение Тогда\r\n        Результат.Добавить(\"ВнешнееСоединение\");\r\n    #КонецЕсли\r\n    \r\n    #Если ТонкийКлиент  Тогда\r\n        Результат.Добавить(\"ТонкийКлиент\");\r\n    #КонецЕсли\r\n    \r\n    #Если ВебКлиент  Тогда\r\n        Результат.Добавить(\"ВебКлиент\");\r\n    #КонецЕсли\r\n    \r\n    Возврат Результат;\r\n\r\nКонецФункции\n\n&НаКлиентеНаСервере\r\nФункция АктуальныеСимволыПрепроцессора() Экспорт\r\n    \r\n    Результат = новый Массив;\r\n    \r\n    #Если НаКлиенте Тогда\r\n        Результат.Добавить(\"НаКлиенте\");\r\n    #КонецЕсли\r\n    \r\n    #Если НаСервере Тогда\r\n        Результат.Добавить(\"НаСервере\");\r\n    #КонецЕсли\r\n    \r\n    #Если Клиент Тогда\r\n        Результат.Добавить(\"Клиент\");\r\n    #КонецЕсли\r\n    \r\n    #Если Сервер Тогда\r\n        Результат.Добавить(\"Сервер\");\r\n    #КонецЕсли\r\n    \r\n    #Если МобильноеПриложениеКлиент Тогда\r\n        Результат.Добавить(\"МобильноеПриложениеКлиент\");\r\n    #КонецЕсли\r\n    \r\n    #Если МобильноеПриложениеСервер Тогда\r\n        Результат.Добавить(\"МобильноеПриложениеСервер\");\r\n    #КонецЕсли\r\n    \r\n    #Если МобильныйКлиент Тогда\r\n        Результат.Добавить(\"МобильныйКлиент\");\r\n    #КонецЕсли\r\n    \r\n    #Если ТолстыйКлиентОбычноеПриложение Тогда\r\n        Результат.Добавить(\"ТолстыйКлиентОбычноеПриложение\");\r\n    #КонецЕсли\r\n        \r\n    #Если ТолстыйКлиентУправляемоеПриложение Тогда\r\n        Результат.Добавить(\"ТолстыйКлиентУправляемоеПриложение\");\r\n    #КонецЕсли\r\n    \r\n    #Если ВнешнееСоединение Тогда\r\n        Результат.Добавить(\"ВнешнееСоединение\");\r\n    #КонецЕсли\r\n    \r\n    #Если ТонкийКлиент  Тогда\r\n        Результат.Добавить(\"ТонкийКлиент\");\r\n    #КонецЕсли\r\n    \r\n    #Если ВебКлиент  Тогда\r\n        Результат.Добавить(\"ВебКлиент\");\r\n    #КонецЕсли\r\n    \r\n    Возврат Результат;\r\n\r\nКонецФункции"
  },
  {
    "title": "Создание регламентного задания из внешней обработки",
    "description": "Создание регламентного задания из внешней обработки",
    "code_snippet": "// Функция возвращает сведения о внешней обработке.\r\nФункция СведенияОВнешнейОбработке() Экспорт\r\n\t\r\n    ПараметрыРегистрации = Новый Структура;\r\n    ПараметрыРегистрации.Вставить(\"Вид\", \"ДополнительнаяОбработка\");\r\n\r\n    ПараметрыРегистрации.Вставить(\"Наименование\", \"Демо обработка\");\r\n    ПараметрыРегистрации.Вставить(\"Версия\", \"1.0\");\r\n    ПараметрыРегистрации.Вставить(\"БезопасныйРежим\", Истина);\r\n    ПараметрыРегистрации.Вставить(\"Информация\", \"Демо обработка\");\r\n    ТаблицаКоманд = ПолучитьТаблицуКоманд();\r\n    ДобавитьКоманду(ТаблицаКоманд,\r\n    \"Демо обработка\",\r\n    \"Идентификатор\",\r\n    \"ВызовСерверногоМетода\",\r\n    Истина,\"\");\r\n    ПараметрыРегистрации.Вставить(\"Команды\", ТаблицаКоманд);\r\n    Возврат ПараметрыРегистрации;\r\n\t\r\nКонецФункции\r\n\r\n\r\nФункция ПолучитьТаблицуКоманд()\r\n    Команды = Новый ТаблицаЗначений;\r\n    Команды.Колонки.Добавить(\"Представление\", Новый ОписаниеТипов(\"Строка\"));\r\n    Команды.Колонки.Добавить(\"Идентификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n    Команды.Колонки.Добавить(\"Использование\", Новый ОписаниеТипов(\"Строка\"));\r\n    Команды.Колонки.Добавить(\"ПоказыватьОповещение\", Новый ОписаниеТипов(\"Булево\"));\r\n    Команды.Колонки.Добавить(\"Модификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n    Возврат Команды;\r\nКонецФункции\r\n\r\n\r\nПроцедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование, ПоказыватьОповещение = Ложь, Модификатор = \"\")\r\n    НоваяКоманда = ТаблицаКоманд.Добавить();\r\n    НоваяКоманда.Представление = Представление;\r\n    НоваяКоманда.Идентификатор = Идентификатор;\r\n    НоваяКоманда.Использование = Использование;\r\n    НоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;\r\n    НоваяКоманда.Модификатор = Модификатор;\r\nКонецПроцедуры\r\n\r\n\r\nПроцедура ВыполнитьКоманду(Идентификатор, ОбъектыНазначения) Экспорт\r\n\t\r\n\t// Тело процедуры\r\n\t\t\t\t\t\r\nКонецПроцедуры\n\n// Функция возвращает сведения о внешней обработке.\r\nФункция СведенияОВнешнейОбработке() Экспорт\r\n\t\r\n    ПараметрыРегистрации = Новый Структура;\r\n    ПараметрыРегистрации.Вставить(\"Вид\", \"ДополнительнаяОбработка\");\r\n\r\n    ПараметрыРегистрации.Вставить(\"Наименование\", \"Демо обработка\");\r\n    ПараметрыРегистрации.Вставить(\"Версия\", \"1.0\");\r\n    ПараметрыРегистрации.Вставить(\"БезопасныйРежим\", Истина);\r\n    ПараметрыРегистрации.Вставить(\"Информация\", \"Демо обработка\");\r\n    ТаблицаКоманд = ПолучитьТаблицуКоманд();\r\n    ДобавитьКоманду(ТаблицаКоманд,\r\n    \"Демо обработка\",\r\n    \"Идентификатор\",\r\n    \"ВызовСерверногоМетода\",\r\n    Истина,\"\");\r\n    ПараметрыРегистрации.Вставить(\"Команды\", ТаблицаКоманд);\r\n    Возврат ПараметрыРегистрации;\r\n\t\r\nКонецФункции\r\n\r\n\r\nФункция ПолучитьТаблицуКоманд()\r\n    Команды = Новый ТаблицаЗначений;\r\n    Команды.Колонки.Добавить(\"Представление\", Новый ОписаниеТипов(\"Строка\"));\r\n    Команды.Колонки.Добавить(\"Идентификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n    Команды.Колонки.Добавить(\"Использование\", Новый ОписаниеТипов(\"Строка\"));\r\n    Команды.Колонки.Добавить(\"ПоказыватьОповещение\", Новый ОписаниеТипов(\"Булево\"));\r\n    Команды.Колонки.Добавить(\"Модификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n    Возврат Команды;\r\nКонецФункции\r\n\r\n\r\nПроцедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование, ПоказыватьОповещение = Ложь, Модификатор = \"\")\r\n    НоваяКоманда = ТаблицаКоманд.Добавить();\r\n    НоваяКоманда.Представление = Представление;\r\n    НоваяКоманда.Идентификатор = Идентификатор;\r\n    НоваяКоманда.Использование = Использование;\r\n    НоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;\r\n    НоваяКоманда.Модификатор = Модификатор;\r\nКонецПроцедуры\r\n\r\n\r\nПроцедура ВыполнитьКоманду(Идентификатор, ОбъектыНазначения) Экспорт\r\n\t\r\n\t// Тело процедуры\r\n\t\t\t\t\t\r\nКонецПроцедуры"
  },
  {
    "title": "Отслеживание трека почта России",
    "description": "Отслеживание трека почта России",
    "code_snippet": "Орфографическая ошибка в парсить: парсить\r\nОрфографическая ошибка в вообщем: вообщем"
  },
  {
    "title": "Расчет ручной скидки &НаСервере",
    "description": "Расчет ручной скидки &НаСервере",
    "code_snippet": "//добавим скидку на товары\r\nЕсли НЕ СуммаСкидки = 0 Тогда\r\n\t\t\t\r\nОграничения = Новый ТаблицаЗначений;\r\nОграничения.Колонки.Добавить(\"ЦеноваяГруппа\");\r\nОграничения.Колонки.Добавить(\"СуммаБезСкидки\");\r\nОграничения.Колонки.Добавить(\"СуммаРучнойСкидки\");\r\nОграничения.Колонки.Добавить(\"СуммаАвтоматическойСкидки\");\r\nОграничения.Колонки.Добавить(\"МаксимальныйПроцентРучнойСкидки\");\r\nОграничения.Колонки.Добавить(\"МаксимальныйПроцентРучнойНаценки\");\r\nОграничения.Колонки.Добавить(\"МаксимальнаяСуммаРучнойСкидки\");\r\nОграничения.Колонки.Добавить(\"МаксимальнаяСуммаРучнойНаценки\");\r\n\t\t\t\r\nСтрОграничения \t\t\t\t\t\t\t\t\t= Ограничения.Добавить();\r\nСтрОграничения.ЦеноваяГруппа \t\t\t\t\t= Справочники.ЦеновыеГруппы.ПустаяСсылка();\r\nСтрОграничения.СуммаБезСкидки                   = ЗаказКлиентаОбъект.Товары.Итог(\"Сумма\");\r\nСтрОграничения.СуммаРучнойСкидки                = 0;\r\nСтрОграничения.СуммаАвтоматическойСкидки        = 0;\r\nСтрОграничения.МаксимальныйПроцентРучнойСкидки  = 999.99;\r\nСтрОграничения.МаксимальныйПроцентРучнойНаценки\t= 999.99;\r\nСтрОграничения.МаксимальнаяСуммаРучнойСкидки\t= (ЗаказКлиентаОбъект.Товары.Итог(\"Сумма\")*999.99)/100;\r\nСтрОграничения.МаксимальнаяСуммаРучнойНаценки   = (ЗаказКлиентаОбъект.Товары.Итог(\"Сумма\")*999.99)/100;\r\n\r\nТЗ_Товары = ЗаказКлиентаОбъект.Товары.Выгрузить(); \r\nТЗ_Товары.Колонки.Добавить(\"ЦеноваяГруппа\");\r\n\r\nАдресВремХранилища = ПоместитьВоВременноеХранилище(Новый Структура(\"Ограничения, Товары, ИспользоватьОграниченияРучныхСкидок\", Ограничения, ТЗ_Товары, Ложь), Новый УникальныйИдентификатор());\r\n\r\nСкидкиНаценкиСервер.НазначитьРучнуюСкидку(ЗаказКлиентаОбъект,\"Товары\", СуммаСкидки,Ложь,Ложь,Ложь,Ложь,Неопределено,АдресВремХранилища,Ложь);\t\r\n\r\nКонецЕсли;\n\n//добавим скидку на товары\r\nЕсли НЕ СуммаСкидки = 0 Тогда\r\n\t\t\t\r\nОграничения = Новый ТаблицаЗначений;\r\nОграничения.Колонки.Добавить(\"ЦеноваяГруппа\");\r\nОграничения.Колонки.Добавить(\"СуммаБезСкидки\");\r\nОграничения.Колонки.Добавить(\"СуммаРучнойСкидки\");\r\nОграничения.Колонки.Добавить(\"СуммаАвтоматическойСкидки\");\r\nОграничения.Колонки.Добавить(\"МаксимальныйПроцентРучнойСкидки\");\r\nОграничения.Колонки.Добавить(\"МаксимальныйПроцентРучнойНаценки\");\r\nОграничения.Колонки.Добавить(\"МаксимальнаяСуммаРучнойСкидки\");\r\nОграничения.Колонки.Добавить(\"МаксимальнаяСуммаРучнойНаценки\");\r\n\t\t\t\r\nСтрОграничения \t\t\t\t\t\t\t\t\t= Ограничения.Добавить();\r\nСтрОграничения.ЦеноваяГруппа \t\t\t\t\t= Справочники.ЦеновыеГруппы.ПустаяСсылка();\r\nСтрОграничения.СуммаБезСкидки                   = ЗаказКлиентаОбъект.Товары.Итог(\"Сумма\");\r\nСтрОграничения.СуммаРучнойСкидки                = 0;\r\nСтрОграничения.СуммаАвтоматическойСкидки        = 0;\r\nСтрОграничения.МаксимальныйПроцентРучнойСкидки  = 999.99;\r\nСтрОграничения.МаксимальныйПроцентРучнойНаценки\t= 999.99;\r\nСтрОграничения.МаксимальнаяСуммаРучнойСкидки\t= (ЗаказКлиентаОбъект.Товары.Итог(\"Сумма\")*999.99)/100;\r\nСтрОграничения.МаксимальнаяСуммаРучнойНаценки   = (ЗаказКлиентаОбъект.Товары.Итог(\"Сумма\")*999.99)/100;\r\n\r\nТЗ_Товары = ЗаказКлиентаОбъект.Товары.Выгрузить(); \r\nТЗ_Товары.Колонки.Добавить(\"ЦеноваяГруппа\");\r\n\r\nАдресВремХранилища = ПоместитьВоВременноеХранилище(Новый Структура(\"Ограничения, Товары, ИспользоватьОграниченияРучныхСкидок\", Ограничения, ТЗ_Товары, Ложь), Новый УникальныйИдентификатор());\r\n\r\nСкидкиНаценкиСервер.НазначитьРучнуюСкидку(ЗаказКлиентаОбъект,\"Товары\", СуммаСкидки,Ложь,Ложь,Ложь,Ложь,Неопределено,АдресВремХранилища,Ложь);\t\r\n\r\nКонецЕсли;\n\nОрфографическая ошибка в Неопределено: Неопределено"
  },
  {
    "title": "Программное добавление элементов управления на форму (ОФ)",
    "description": "Программное добавление элементов управления на форму (ОФ)",
    "code_snippet": "Процедура МодифицироватьНоменклатураФормаЭлемента(ЭтаФорма) Экспорт\r\n     \r\n     ЭлементыФормы = ЭтаФорма.ЭлементыФормы;\r\n     ШиринаНадписи = 160;\r\n     ВерхНадписи = 5;\r\n     ЛевоНадписи = 5;\r\n     СтраницаАнализПитания = ЭлементыФормы.ПанельСвойствНоменклатуры.Страницы.Добавить(\"АнализПитания\", \"Анализ питания\");\r\n     ЭлементыФормы.ПанельСвойствНоменклатуры.ТекущаяСтраница = СтраницаАнализПитания;\r\n     НадписьГруппаПродуктовПитания = ЭтаФорма.ЭлементыФормы.Добавить(Тип(\"Надпись\"), \"НадписьГруппаПродуктовПитания\", Истина,                 ЭлементыФормы.ПанельСвойствНоменклатуры);\r\n     НадписьГруппаПродуктовПитания.Заголовок = \"Группа продуктов питания: \";\r\n     НадписьГруппаПродуктовПитания.Ширина = ШиринаНадписи;\r\n     НадписьГруппаПродуктовПитания.Верх = ВерхНадписи;\r\n     НадписьГруппаПродуктовПитания.Лево =  ЛевоНадписи;\r\n     ПолеГруппаПродуктовПитания = ЭтаФорма.ЭлементыФормы.Добавить(Тип(\"ПолеВвода\"), \"ПолеГруппаПродуктовПитания\", Истина, ЭлементыФормы.ПанельСвойствНоменклатуры);\r\n     ПолеГруппаПродуктовПитания.Данные = \"ГруппаПродуктовПитания\";\r\n     ПолеГруппаПродуктовПитания.Ширина = 150;\r\n     ПолеГруппаПродуктовПитания.Верх = ВерхНадписи;\r\n     ПолеГруппаПродуктовПитания.Лево =  ЛевоНадписи + ШиринаНадписи + 5;\r\n     ЭлементыФормы.ПанельСвойствНоменклатуры.ТекущаяСтраница = ЭлементыФормы.ПанельСвойствНоменклатуры.Страницы.Общее;\r\n     \r\nКонецПроцедуры\n\nПроцедура МодифицироватьНоменклатураФормаЭлемента(ЭтаФорма) Экспорт\r\n     \r\n     ЭлементыФормы = ЭтаФорма.ЭлементыФормы;\r\n     ШиринаНадписи = 160;\r\n     ВерхНадписи = 5;\r\n     ЛевоНадписи = 5;\r\n     СтраницаАнализПитания = ЭлементыФормы.ПанельСвойствНоменклатуры.Страницы.Добавить(\"АнализПитания\", \"Анализ питания\");\r\n     ЭлементыФормы.ПанельСвойствНоменклатуры.ТекущаяСтраница = СтраницаАнализПитания;\r\n     НадписьГруппаПродуктовПитания = ЭтаФорма.ЭлементыФормы.Добавить(Тип(\"Надпись\"), \"НадписьГруппаПродуктовПитания\", Истина,                 ЭлементыФормы.ПанельСвойствНоменклатуры);\r\n     НадписьГруппаПродуктовПитания.Заголовок = \"Группа продуктов питания: \";\r\n     НадписьГруппаПродуктовПитания.Ширина = ШиринаНадписи;\r\n     НадписьГруппаПродуктовПитания.Верх = ВерхНадписи;\r\n     НадписьГруппаПродуктовПитания.Лево =  ЛевоНадписи;\r\n     ПолеГруппаПродуктовПитания = ЭтаФорма.ЭлементыФормы.Добавить(Тип(\"ПолеВвода\"), \"ПолеГруппаПродуктовПитания\", Истина, ЭлементыФормы.ПанельСвойствНоменклатуры);\r\n     ПолеГруппаПродуктовПитания.Данные = \"ГруппаПродуктовПитания\";\r\n     ПолеГруппаПродуктовПитания.Ширина = 150;\r\n     ПолеГруппаПродуктовПитания.Верх = ВерхНадписи;\r\n     ПолеГруппаПродуктовПитания.Лево =  ЛевоНадписи + ШиринаНадписи + 5;\r\n     ЭлементыФормы.ПанельСвойствНоменклатуры.ТекущаяСтраница = ЭлементыФормы.ПанельСвойствНоменклатуры.Страницы.Общее;\r\n     \r\nКонецПроцедуры"
  },
  {
    "title": "ringos",
    "description": "Библитотека OneScript для работы с утилитой ring",
    "code_snippet": ""
  },
  {
    "title": "Подключение к базе через COM соединение и создание нового документа",
    "description": "Подключение к базе через COM соединение и создание нового документа",
    "code_snippet": "//выбираем сотрудника\r\n\r\nЗапросВ = КомСоединение.NewObject(\"Запрос\");\r\nЗапросВ.Текст = \"\r\n|ВЫБРАТЬ первые 1 \r\n|Сотрудники.Ссылка КАК Сотрудник\r\n|ИЗ\r\n|Справочник.Сотрудники КАК Сотрудники\r\n|ГДЕ\r\n|НЕ Сотрудники.СтруктураКомпании = ЗНАЧЕНИЕ(Справочник.СтруктураКомпании.ПустаяСсылка)\r\n|И Сотрудники.ФизическоеЛицо.Наименование = &ФизическоеЛицо\r\n|И Сотрудники.ПометкаУдаления = ЛОЖЬ\r\n|\";\r\n\r\nЗапросВ.УстановитьПараметр(\"ФизическоеЛицо\", СтруктураДанных.Сотрудник.Наименование);\r\n\r\ncom_Результат     = ЗапросВ.Выполнить().Выбрать();// COM объект    \r\n\r\nЕсли com_Результат.следующий() Тогда\r\n\t//нашли сотрудника\r\n\t\r\n\tcom_ТЗ_Сотрудники = com_Результат.Сотрудник;// COM объект\r\n\t\r\n\t// Получаем таблицу значений из COM-объекта\r\n\t// COMОбъект в -> строку\r\n\t// Запишем COMОбъект в строку на стороне базы-источника\r\n\t\r\n\tстр_ТЗ_Сотрудники = КомСоединение.ЗначениеВСтрокуВнутр(com_ТЗ_Сотрудники);\r\n\t\r\n\t// получим таблицу значений из строки\r\n\tТЗ_Сотрудники = ЗначениеИзСтрокиВнутр(стр_ТЗ_Сотрудники);\r\n\t\r\n\tМенеджерДокумента = КомСоединение.Документы.ЗаписьВРНФактическиеОтпуска;\r\n\tКомСоединение.УстановитьБезопасныйРежим(Ложь);\r\n\tКомСоединение.УстановитьПривилегированныйРежим(Истина);\r\n\t\r\n\tНовДок      = МенеджерДокумента.СоздатьДокумент();\r\n\tНовДок.Дата = СтруктураДанных.Период;\r\n\tНовДок.Сотрудник...\r\n\t\r\nИначе\r\n\t//соответственно не нашли\r\n\t\r\n\tcom_ТЗ_Сотрудники = Неопределено;\r\nКонецЕсли;\n\n//выбираем сотрудника\r\n\r\nЗапросВ = КомСоединение.NewObject(\"Запрос\");\r\nЗапросВ.Текст = \"\r\n|ВЫБРАТЬ первые 1 \r\n|Сотрудники.Ссылка КАК Сотрудник\r\n|ИЗ\r\n|Справочник.Сотрудники КАК Сотрудники\r\n|ГДЕ\r\n|НЕ Сотрудники.СтруктураКомпании = ЗНАЧЕНИЕ(Справочник.СтруктураКомпании.ПустаяСсылка)\r\n|И Сотрудники.ФизическоеЛицо.Наименование = &ФизическоеЛицо\r\n|И Сотрудники.ПометкаУдаления = ЛОЖЬ\r\n|\";\r\n\r\nЗапросВ.УстановитьПараметр(\"ФизическоеЛицо\", СтруктураДанных.Сотрудник.Наименование);\r\n\r\ncom_Результат     = ЗапросВ.Выполнить().Выбрать();// COM объект    \r\n\r\nЕсли com_Результат.следующий() Тогда\r\n\t//нашли сотрудника\r\n\t\r\n\tcom_ТЗ_Сотрудники = com_Результат.Сотрудник;// COM объект\r\n\t\r\n\t// Получаем таблицу значений из COM-объекта\r\n\t// COMОбъект в -> строку\r\n\t// Запишем COMОбъект в строку на стороне базы-источника\r\n\t\r\n\tстр_ТЗ_Сотрудники = КомСоединение.ЗначениеВСтрокуВнутр(com_ТЗ_Сотрудники);\r\n\t\r\n\t// получим таблицу значений из строки\r\n\tТЗ_Сотрудники = ЗначениеИзСтрокиВнутр(стр_ТЗ_Сотрудники);\r\n\t\r\n\tМенеджерДокумента = КомСоединение.Документы.ЗаписьВРНФактическиеОтпуска;\r\n\tКомСоединение.УстановитьБезопасныйРежим(Ложь);\r\n\tКомСоединение.УстановитьПривилегированныйРежим(Истина);\r\n\t\r\n\tНовДок      = МенеджерДокумента.СоздатьДокумент();\r\n\tНовДок.Дата = СтруктураДанных.Период;\r\n\tНовДок.Сотрудник...\r\n\t\r\nИначе\r\n\t//соответственно не нашли\r\n\t\r\n\tcom_ТЗ_Сотрудники = Неопределено;\r\nКонецЕсли;\n\n{39} Ожидается идентификатор\r\nОрфографическая ошибка в ЗначениеВСтрокуВнутр: Внутр\r\nОрфографическая ошибка в ЗначениеИзСтрокиВнутр: Внутр\r\nОрфографическая ошибка в Неопределено: Неопределено"
  },
  {
    "title": "Получить имя формы выбора по ссылке",
    "description": "Получить имя формы выбора по ссылке",
    "code_snippet": "&НаСервереБезКонтекста\r\nФункция ПолучитьИмяФормыВыбора(Ссылка)\r\n  \r\n\tВозврат Ссылка.Метаданные().ПолноеИмя() + \".ФормаВыбора\";\r\n\t\r\nКонецФункции\n\n&НаСервереБезКонтекста\r\nФункция ПолучитьИмяФормыВыбора(Ссылка)\r\n  \r\n\tВозврат Ссылка.Метаданные().ПолноеИмя() + \".ФормаВыбора\";\r\n\t\r\nКонецФункции"
  },
  {
    "title": "УТ 11.4. Выбрать все документы, по определенному виду номенклатуры",
    "description": "УТ 11.4. Выбрать все документы, по определенному виду номенклатуры",
    "code_snippet": "&НаСервере\r\nПроцедура ВыбратьДокументыНаСервере()\r\n\t\r\n\tТЗДокументы.Очистить();\r\n\t\r\n\tСписокИменДокументов = СформироватьСписокСТипамиДокументов();\r\n\t\r\n\tТекстЗапроса = \"\";\r\n\t\r\n\tДля каждого Вид Из СписокИменДокументов Цикл\r\n\t\t\r\n\t\tЕсли ТекстЗапроса<>\"\" Тогда\r\n\t\t\tТекстЗапроса=ТекстЗапроса+\"\r\n\t\t\t|ОБЪЕДИНИТЬ ВСЕ \";\r\n\t\tКонецЕсли;\r\n\t\t\t                           \r\n\t\tШаблон =\r\n\t\t\"ВЫБРАТЬ\r\n\t\t|  ТЧ.Ссылка КАК Ссылка,\r\n\t\t|  ТЧ.Номенклатура КАК Номенклатура\r\n\t\t|ИЗ\r\n\t\t|  Документ.ПриобретениеТоваровУслуг.Товары КАК ТЧ\r\n\t\t|ГДЕ ТЧ.Ссылка.Проведен И ТЧ.Номенклатура.ВидНоменклатуры = &ВидНоменклатуры\";\r\n\t\t\r\n\t\tТекстЗапроса = ТекстЗапроса+СтрЗаменить(Шаблон, \"ПриобретениеТоваровУслуг\", Вид);\r\n\t\t\r\n\tКонецЦикла; \t\r\n\t\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tЗапрос.УстановитьПараметр(\"ВидНоменклатуры\", ВидНоменклатуры);\t\r\n\tВыборка = Запрос.Выполнить().Выбрать();\r\n\tПока Выборка.Следующий() Цикл\r\n\t\tНоваСтрокаТЗ = ТЗДокументы.Добавить();\r\n\t\tНоваСтрокаТЗ.Документ = Выборка.Ссылка;\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция СформироватьСписокСТипамиДокументов()\r\n\t\r\n\tСписокТиповДокументов = Новый Массив;\r\n\t\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.ПриобретениеТоваровУслуг.Имя);\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.ВозвратТоваровОтКлиента.Имя);\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.ВозвратТоваровПоставщику.Имя);\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.ПеремещениеТоваров.Имя);\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.СборкаТоваров.Имя);\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.ПрочееОприходованиеТоваров.Имя);\r\n\t\r\n\tВозврат СписокТиповДокументов;\r\n\t\r\nКонецФункции\n\n&НаСервере\r\nПроцедура ВыбратьДокументыНаСервере()\r\n\t\r\n\tТЗДокументы.Очистить();\r\n\t\r\n\tСписокИменДокументов = СформироватьСписокСТипамиДокументов();\r\n\t\r\n\tТекстЗапроса = \"\";\r\n\t\r\n\tДля каждого Вид Из СписокИменДокументов Цикл\r\n\t\t\r\n\t\tЕсли ТекстЗапроса<>\"\" Тогда\r\n\t\t\tТекстЗапроса=ТекстЗапроса+\"\r\n\t\t\t|ОБЪЕДИНИТЬ ВСЕ \";\r\n\t\tКонецЕсли;\r\n\t\t\t                           \r\n\t\tШаблон =\r\n\t\t\"ВЫБРАТЬ\r\n\t\t|  ТЧ.Ссылка КАК Ссылка,\r\n\t\t|  ТЧ.Номенклатура КАК Номенклатура\r\n\t\t|ИЗ\r\n\t\t|  Документ.ПриобретениеТоваровУслуг.Товары КАК ТЧ\r\n\t\t|ГДЕ ТЧ.Ссылка.Проведен И ТЧ.Номенклатура.ВидНоменклатуры = &ВидНоменклатуры\";\r\n\t\t\r\n\t\tТекстЗапроса = ТекстЗапроса+СтрЗаменить(Шаблон, \"ПриобретениеТоваровУслуг\", Вид);\r\n\t\t\r\n\tКонецЦикла; \t\r\n\t\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tЗапрос.УстановитьПараметр(\"ВидНоменклатуры\", ВидНоменклатуры);\t\r\n\tВыборка = Запрос.Выполнить().Выбрать();\r\n\tПока Выборка.Следующий() Цикл\r\n\t\tНоваСтрокаТЗ = ТЗДокументы.Добавить();\r\n\t\tНоваСтрокаТЗ.Документ = Выборка.Ссылка;\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция СформироватьСписокСТипамиДокументов()\r\n\t\r\n\tСписокТиповДокументов = Новый Массив;\r\n\t\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.ПриобретениеТоваровУслуг.Имя);\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.ВозвратТоваровОтКлиента.Имя);\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.ВозвратТоваровПоставщику.Имя);\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.ПеремещениеТоваров.Имя);\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.СборкаТоваров.Имя);\r\n\tСписокТиповДокументов.Добавить(Метаданные.Документы.ПрочееОприходованиеТоваров.Имя);\r\n\t\r\n\tВозврат СписокТиповДокументов;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Найти значение в строке",
    "description": "Найти значение в строке",
    "code_snippet": "Орфографическая ошибка в quittDate: quitt\n\nСтруктура = Новый Структура;\n\nДля каждого ЭлементМассива из Массив Цикл\n\tПозицияРазделителя = Найти(ЭлементМассива,\"=\");\n\tКлюч = Лев(ЭлементМассива, ПозицияРазделителя - 1);\n\tЗначение = Сред(ЭлементМассива, ПозицияРазделителя + 1);\n\tСтруктура.Вставить(Ключ, Значение);\nКонецЦикла\n\nРезультат = Лев(Сред(Строка, Найти(Строка,\"uin=\") + 4), Найти(Сред(Строка, Найти(Строка,\"uin=\") + 4),\"|\")-1);\n\nФункция ЗначениеUIN (Знач ВхДанные)\n\t\n\tСтарт = СтрНайти(ВхДанные, \"uin=\");\n\tВхДанные = Сред(ВхДанные, Старт +4);\n\tФиниш = СтрНайти(ВхДанные, \"|\");\n\tВозврат Сред(ВхДанные, 1, Финиш-1);\n\t\nКонецФункции\n\nRegExp = Новый COMОбъект(\"VBScript.RegExp\");\nRegExp.MultiLine = Истина;\nRegExp.Global = Истина;\nRegExp.IgnoreCase = Истина;\nRegExp.Pattern = \"uin=(\\d+)\";\n\nПроверяемаяСтрока = \"355035|uin=18810150201111703544|TechCode=03|ruleId=18810150201111703544|quittDate=11.11.2020|\";\n\nMatches=RegExp.Execute(ПроверяемаяСтрока);\n\nЕсли Matches.Count > 0 Тогда\n\tSubMatch = Matches.Item(0);\n\tuin = SubMatch.SubMatches.Item(0);\n\tСообщить(\"uin: \" + uin);\nКонецЕсли;\n\nФункция ИзСтрокиВМассив(НачальнаяСтрока,Разделитель) Экспорт\n\t\n\tСтрокаПреобразованнаяВМногострочныйТекст     = СтрЗаменить(НачальнаяСтрока,Разделитель,Символы.ПС);\n\tТекстовыйДокументИзСтроки                    = Новый ТекстовыйДокумент;\n\tРезультат                                    = Новый СписокЗначений;\n\tТекстовыйДокументИзСтроки.УстановитьТекст(СтрокаПреобразованнаяВМногострочныйТекст);\n\tДля СчетчикСтрок = 1 по ТекстовыйДокументИзСтроки.КоличествоСтрок() цикл\n\t\tРезультат.Добавить(СокрЛП(ТекстовыйДокументИзСтроки.ПолучитьСтроку(СчетчикСтрок)));\n\tКонецЦикла;\n\tВозврат Результат;\n\t\nКонецФункции\n\nФункция мРазложитьСтрокуВМассивПодстрок(Знач Стр, Разделитель ) Экспорт\n\t\n\t//   МассивСтрок = Новый Массив();\n\tЕсли Разделитель = \" \" Тогда\n\t\tСтр = СокрЛП(Стр);\n\t\tПока 1 = 1 Цикл\n\t\t\tПоз = Найти(Стр,Разделитель);\n\t\t\t\n\t\t\tЕсли Поз = 0 Тогда\n\t\t\t\tСтрокаВМассив = СокрЛП(Стр);\n\t\t\t\t\n\t\t\t\t//   МассивСтрок.Добавить(СтрокаВМассив);\n\t\t\t\tВозврат СтрокаВМассив;\n\t\t\tКонецЕсли;\n\t\t\t\n\t\t\tСтрокаВМассив = СокрЛП(Лев(Стр,Поз-1));\n\t\t\t\n\t\t\t// МассивСтрок.Добавить(СтрокаВМассив);\n\t\t\tСтр = СокрЛ(Сред(Стр,Поз));\n\t\tКонецЦикла;\n\tИначе\n\t\tДлинаРазделителя = СтрДлина(Разделитель);\n\t\tПока 1 = 1 Цикл\n\t\t\tПоз = Найти(Стр,Разделитель);\n\t\t\t\n\t\t\t//Если Поз = 0 Тогда\n\t\t\tСтрокаВМассив = СокрЛП(Стр);\n\t\t\t\n\t\t\t//    МассивСтрок.Добавить(СтрокаВМассив);\n\t\t\t//Возврат СтрокаВМассив;\n\t\t\t//КонецЕсли;\n\t\t\t\n\t\t\tСтрокаВМассив = СокрЛП(Лев(Стр,Поз-1));\n\t\t\t\n\t\t\t// МассивСтрок.Добавить(СтрокаВМассив);\n\t\t\t//Стр = Сред(Стр,Поз+ДлинаРазделителя);\n\t\t\tВозврат СтрокаВМассив;\n\t\t\t\n\t\t\t\n\t\tКонецЦикла;\n\tКонецЕсли;\n\t\nКонецФункции"
  },
  {
    "title": "Выгрузить схему компоновки данных (скд) в файл/строку",
    "description": "Выгрузить схему компоновки данных (скд) в файл/строку",
    "code_snippet": "&НаСервере\r\nФункция СхемаКомпоновкиСтрокой(Схема) Экспорт\r\n\t\r\n\tСтрокаСхемы = \"\";\r\n\t\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\t\r\n\tПуть = ПолучитьИмяВременногоФайла(\"xml\");\r\n\t\r\n\tЗаписьXML.ОткрытьФайл(Путь);\r\n\t\r\n\tСериализаторXDTO.ЗаписатьXML(\r\n                               ЗаписьXML, \r\n                               Схема, \r\n                               \"dataComposition\", \r\n                               \"http://v8.1c.ru/8.1/data-composition-system/composition-template\");\r\n\t\r\n\tЗаписьXML.Закрыть();\r\n\t\r\n\tЧтениеТекста = Новый ЧтениеТекста(Путь);\r\n\t\r\n\tСтрокаСхемы = ЧтениеТекста.Прочитать();\r\n\t\r\n\tЧтениеТекста.Закрыть();\r\n\t\r\n\tВозврат СтрокаСхемы;\r\n\t\r\nКонецФункции\n\n&НаСервере\r\nФункция СхемаКомпоновкиСтрокой(Схема) Экспорт\r\n\t\r\n\tСтрокаСхемы = \"\";\r\n\t\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\t\r\n\tПуть = ПолучитьИмяВременногоФайла(\"xml\");\r\n\t\r\n\tЗаписьXML.ОткрытьФайл(Путь);\r\n\t\r\n\tСериализаторXDTO.ЗаписатьXML(\r\n                               ЗаписьXML, \r\n                               Схема, \r\n                               \"dataComposition\", \r\n                               \"http://v8.1c.ru/8.1/data-composition-system/composition-template\");\r\n\t\r\n\tЗаписьXML.Закрыть();\r\n\t\r\n\tЧтениеТекста = Новый ЧтениеТекста(Путь);\r\n\t\r\n\tСтрокаСхемы = ЧтениеТекста.Прочитать();\r\n\t\r\n\tЧтениеТекста.Закрыть();\r\n\t\r\n\tВозврат СтрокаСхемы;\r\n\t\r\nКонецФункции\n\n{4} Переменной СтрокаСхемы присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в СериализаторXDTO: Сериализатор"
  },
  {
    "title": "Выгрузка данных в формате CSV",
    "description": "Выгрузка данных в формате CSV",
    "code_snippet": "Процедура ВыполнитьНажатие(Команда) \r\n\tИмяФайла = \"Обмен\";\r\n\t//ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);\r\n\t//\r\n\t//ДиалогОткрытияФайла.ПолноеИмяФайла = ИмяФайла+\".csv\";\r\n\t//ДиалогОткрытияФайла.Каталог = \"C:\\Users\\Сотрудник_1С\\Desktop\\Внешние обработки\";\r\n\tРежим        = РежимДиалогаВыбораФайла.Открытие;\r\n\tДиалогВыбора = новый ДиалогВыбораФайла(Режим);\r\n\t//ДиалогВыбора.ПолноеИмяФайла = \"\";\r\n\t//Фильтр       = \"Файл данных (*.csv)|*.csv\";\r\n\t//ДиалогВыбора.Фильтр = Фильтр;\r\n\tДиалогВыбора.Заголовок = \"Выберите Каталог\";    \r\n\tЕсли ДиалогВыбора.Выбрать() Тогда\r\n\t\tИмяФайла = ДиалогВыбора.ПолноеИмяФайла;\r\n\tКонецЕсли;\r\n\t//ИмяФайла = \"C:\\Users\\Сотрудник_1С\\Desktop\\Внешние обработки\"+\"Обмен.csv\";\r\n\tВыгрузитьВCSV(ИмяФайла);\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция ВыгрузитьВCSV(имяФайлаCSV);\r\n\tразделитель = \";\";\r\n\tТаблицаЗначений = ПолучитьНоменклатуру();\r\n\t//Тут может быть любое получение данных, в моем случае номенклатура, цены, бренд и остатки\r\n\tтекст = СоздатьДанныеCSV(ТаблицаЗначений,разделитель);\r\n\tЗаписатьCSV(текст,имяФайлаCSV);\r\n\t\r\nКонецФункции\r\n\r\nФункция СоздатьДанныеCSV(ТаблицаЗначений,разделитель)\r\n\t\r\n\tтекст=\"\";\r\n\tдля каждого запись из ТаблицаЗначений Цикл\r\n\t\tесли текст=\"\" тогда\r\n\t\t\tтекст=СоздатьЗаголовкиCSV(ТаблицаЗначений,разделитель) \r\n\t\t\t+ Символы.ПС;    \r\n\t\tКонецЕсли;    \r\n\t\t\r\n\t\tсообщить(запись.Наименование);\r\n\t\tтекст = текст + запись.Код \r\n\t\t+ разделитель + запись.КодПроизводителя\r\n\t\t+ разделитель + запись.Наименование\r\n\t\t+ разделитель + запись.Цена\r\n\t\t+ разделитель + запись.Бренд\r\n\t\t+ разделитель + запись.Наличие             \r\n\t\t+ Символы.ПС;        \r\n\tКонецЦикла;\r\n\t\r\n\t//сообщить(текст);\r\n\tВозврат текст;\r\n\t\r\nКонецФункции //\r\n\r\nФункция ЗаписатьCSV(текст,имяФайла)              \r\n\tкодировка = КодировкаТекста.ANSI;\r\n\tТекстовыйФайлЗапись = Новый ЗаписьТекста(имяФайла,Кодировка);            \r\n\t//ТекстовыйФайлЗапись.ЗаписатьСтроку(текст);\r\n\tТекстовыйФайлЗапись.Записать(текст);\r\n\tТекстовыйФайлЗапись.Закрыть();    \r\n\tВозврат 0;\r\n\t\r\nКонецФункции\n\nПроцедура ВыполнитьНажатие(Команда) \r\n\tИмяФайла = \"Обмен\";\r\n\t//ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);\r\n\t//\r\n\t//ДиалогОткрытияФайла.ПолноеИмяФайла = ИмяФайла+\".csv\";\r\n\t//ДиалогОткрытияФайла.Каталог = \"C:\\Users\\Сотрудник_1С\\Desktop\\Внешние обработки\";\r\n\tРежим        = РежимДиалогаВыбораФайла.Открытие;\r\n\tДиалогВыбора = новый ДиалогВыбораФайла(Режим);\r\n\t//ДиалогВыбора.ПолноеИмяФайла = \"\";\r\n\t//Фильтр       = \"Файл данных (*.csv)|*.csv\";\r\n\t//ДиалогВыбора.Фильтр = Фильтр;\r\n\tДиалогВыбора.Заголовок = \"Выберите Каталог\";    \r\n\tЕсли ДиалогВыбора.Выбрать() Тогда\r\n\t\tИмяФайла = ДиалогВыбора.ПолноеИмяФайла;\r\n\tКонецЕсли;\r\n\t//ИмяФайла = \"C:\\Users\\Сотрудник_1С\\Desktop\\Внешние обработки\"+\"Обмен.csv\";\r\n\tВыгрузитьВCSV(ИмяФайла);\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция ВыгрузитьВCSV(имяФайлаCSV);\r\n\tразделитель = \";\";\r\n\tТаблицаЗначений = ПолучитьНоменклатуру();\r\n\t//Тут может быть любое получение данных, в моем случае номенклатура, цены, бренд и остатки\r\n\tтекст = СоздатьДанныеCSV(ТаблицаЗначений,разделитель);\r\n\tЗаписатьCSV(текст,имяФайлаCSV);\r\n\t\r\nКонецФункции\r\n\r\nФункция СоздатьДанныеCSV(ТаблицаЗначений,разделитель)\r\n\t\r\n\tтекст=\"\";\r\n\tдля каждого запись из ТаблицаЗначений Цикл\r\n\t\tесли текст=\"\" тогда\r\n\t\t\tтекст=СоздатьЗаголовкиCSV(ТаблицаЗначений,разделитель) \r\n\t\t\t+ Символы.ПС;    \r\n\t\tКонецЕсли;    \r\n\t\t\r\n\t\tсообщить(запись.Наименование);\r\n\t\tтекст = текст + запись.Код \r\n\t\t+ разделитель + запись.КодПроизводителя\r\n\t\t+ разделитель + запись.Наименование\r\n\t\t+ разделитель + запись.Цена\r\n\t\t+ разделитель + запись.Бренд\r\n\t\t+ разделитель + запись.Наличие             \r\n\t\t+ Символы.ПС;        \r\n\tКонецЦикла;\r\n\t\r\n\t//сообщить(текст);\r\n\tВозврат текст;\r\n\t\r\nКонецФункции //\r\n\r\nФункция ЗаписатьCSV(текст,имяФайла)              \r\n\tкодировка = КодировкаТекста.ANSI;\r\n\tТекстовыйФайлЗапись = Новый ЗаписьТекста(имяФайла,Кодировка);            \r\n\t//ТекстовыйФайлЗапись.ЗаписатьСтроку(текст);\r\n\tТекстовыйФайлЗапись.Записать(текст);\r\n\tТекстовыйФайлЗапись.Закрыть();    \r\n\tВозврат 0;\r\n\t\r\nКонецФункции\n\n{21} Не все части функции возвращают значение\r\n{60} Функция всегда возвращает одно и тоже значение"
  },
  {
    "title": "Вывести список пользователей с пустым паролем",
    "description": "Вывести список пользователей с пустым паролем",
    "code_snippet": "&НаСервере\r\n\r\nмПользователи = ПользователиИнформационнойБазы.ПолучитьПользователей();\r\n\t\r\nДля Каждого мПользователь Из мПользователи Цикл\r\n\r\n\tЕсли ПустаяСтрока(\r\n\t\tмПользователь.СохраняемоеЗначениеПароля)\r\n\t\tИ мПользователь.АутентификацияСтандартная Тогда\r\n\r\n\t\tСообщить(мПользователь);\r\n\r\n\tКонецЕсли;\r\n\r\nКонецЦикла;\n\n&НаСервере\r\n\r\nмПользователи = ПользователиИнформационнойБазы.ПолучитьПользователей();\r\n\t\r\nДля Каждого мПользователь Из мПользователи Цикл\r\n\r\n\tЕсли ПустаяСтрока(\r\n\t\tмПользователь.СохраняемоеЗначениеПароля)\r\n\t\tИ мПользователь.АутентификацияСтандартная Тогда\r\n\r\n\t\tСообщить(мПользователь);\r\n\r\n\tКонецЕсли;\r\n\r\nКонецЦикла;"
  },
  {
    "title": "Создание пользователя и добавление в группу доступа (БСП)",
    "description": "Создание пользователя и добавление в группу доступа (БСП)",
    "code_snippet": "&НаСервере\r\nПроцедура СоздатьПользователя(ИмяПользователя, ПолноеИмя, Пароль, ГруппаДоступа)\r\n\t\r\n\tОписаниеПользователяИБ \t\t\t\t\t\t\t\t= Пользователи.НовоеОписаниеПользователяИБ();\r\n\tОписаниеПользователяИБ.Имя \t\t\t\t\t\t\t= ИмяПользователя;\r\n\tОписаниеПользователяИБ.ПолноеИмя\t\t\t\t\t= ПолноеИмя;\r\n\tОписаниеПользователяИБ.Пароль\t\t\t\t\t\t= Пароль;\r\n\tОписаниеПользователяИБ.ПарольУстановлен\t\t\t\t= Истина;\r\n\tОписаниеПользователяИБ.ПоказыватьВСпискеВыбора\t\t= Истина;\r\n\tОписаниеПользователяИБ.АутентификацияСтандартная\t= Истина;\r\n\tОписаниеПользователяИБ.АутентификацияОС\t\t\t\t= Ложь;\r\n\t\t\t\r\n\tСоздаватьПользователяИБ = Истина;\r\n\r\n\tНачатьТранзакцию();\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\t// Создадим пользователя ИБ с заданными настройками\r\n\t\tПользователи.УстановитьСвойстваПользователяИБ(\r\n                                    ИмяПользователя, ОписаниеПользователяИБ, СоздаватьПользователяИБ);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t// Создадим пользователя в справочнике \"Пользователи\"\r\n\t\tПользовательОбъект = Справочники.Пользователи.СоздатьЭлемент();\r\n\t\t\r\n\t\tПользовательОбъект.Наименование = ОписаниеПользователяИБ.ПолноеИмя;\r\n\t\t\r\n\t\t// Установим связь пользователя ИБ и пользователя из справочника \"Пользователи\"\r\n\t\tСвойстваПользователяИБ = Новый Структура;\r\n\t\tСвойстваПользователяИБ.Вставить(\"Действие\", \"Записать\");\r\n\t\tСвойстваПользователяИБ.Вставить(\"УникальныйИдентификатор\", ОписаниеПользователяИБ.УникальныйИдентификатор);\t\r\n\t\t\r\n\t\tПользовательОбъект.ДополнительныеСвойства.Вставить(\"ОписаниеПользователяИБ\", СвойстваПользователяИБ);\r\n\t\t\r\n\t\tПользовательОбъект.Записать();\r\n\t\t\r\n\t\t\r\n\t\t// Добавим пользователя в группу доступа;\r\n\t\tГруппаДоступа  = ГруппаДоступа.ПолучитьОбъект();\r\n\t\t\r\n\t\tПользователиВГруппе = ГруппаДоступа.Пользователи.Добавить();\r\n\t\tПользователиВГруппе.Пользователь = ПользовательОбъект.Ссылка;\r\n\t\t\r\n\t\tГруппаДоступа.Записать();\t\t\r\n\t\t\r\n\t\t// Пример добавления дополнительных ролей пользователю,  \r\n\t\t// в случае если не все необходимые роли есть в группах доступа\r\n\t\t\r\n\t\t// Сначала получим свойства созданного пользователя с ролями, \r\n\t\t// которые были назначены из заданных групп доступа\r\n\t\tСвойстваСозданногоПользователяИБ = \r\n                             Пользователи.СвойстваПользователяИБ(ОписаниеПользователяИБ.УникальныйИдентификатор);\r\n\t\t\r\n\t\t// в массиве указываются названия ролей из конфигурации\r\n\t\tСвойстваСозданногоПользователяИБ.Роли.Добавить(\"ЗапускВебКлиента\");\r\n\t\tСвойстваСозданногоПользователяИБ.Роли.Добавить(\"БазовыеПраваБСП\");\r\n\t\tСвойстваСозданногоПользователяИБ.Роли.Добавить(\"ПолныеПрава\");\t\t\r\n\t\t\r\n\t\t// Отключаем флаг создания нового, так как пользователь уже создан\r\n\t\t\r\n\t\tСоздаватьПользователяИБ = Ложь;\r\n\t\t\r\n\t\tПользователи.УстановитьСвойстваПользователяИБ(\r\n                              ИмяПользователя, СвойстваСозданногоПользователяИБ, СоздаватьПользователяИБ);\r\n\t\t\r\n\t\tЗафиксироватьТранзакцию();\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tЕсли ТранзакцияАктивна() Тогда\r\n\t\t\tОтменитьТранзакцию();\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tИмяСобытия = \"Создание пользователя\";\r\n\t\t\r\n\t\tЗаписьЖурналаРегистрации(ИмяСобытия, УровеньЖурналаРегистрации.Ошибка,, ИмяПользователя, ОписаниеОшибки());\r\n\t\t\r\n\t\tСообщить(ОписаниеОшибки());\r\n\t\t\r\n\tКонецПопытки;\r\n\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура СоздатьПользователя(ИмяПользователя, ПолноеИмя, Пароль, ГруппаДоступа)\r\n\t\r\n\tОписаниеПользователяИБ \t\t\t\t\t\t\t\t= Пользователи.НовоеОписаниеПользователяИБ();\r\n\tОписаниеПользователяИБ.Имя \t\t\t\t\t\t\t= ИмяПользователя;\r\n\tОписаниеПользователяИБ.ПолноеИмя\t\t\t\t\t= ПолноеИмя;\r\n\tОписаниеПользователяИБ.Пароль\t\t\t\t\t\t= Пароль;\r\n\tОписаниеПользователяИБ.ПарольУстановлен\t\t\t\t= Истина;\r\n\tОписаниеПользователяИБ.ПоказыватьВСпискеВыбора\t\t= Истина;\r\n\tОписаниеПользователяИБ.АутентификацияСтандартная\t= Истина;\r\n\tОписаниеПользователяИБ.АутентификацияОС\t\t\t\t= Ложь;\r\n\t\t\t\r\n\tСоздаватьПользователяИБ = Истина;\r\n\r\n\tНачатьТранзакцию();\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\t// Создадим пользователя ИБ с заданными настройками\r\n\t\tПользователи.УстановитьСвойстваПользователяИБ(\r\n                                    ИмяПользователя, ОписаниеПользователяИБ, СоздаватьПользователяИБ);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t// Создадим пользователя в справочнике \"Пользователи\"\r\n\t\tПользовательОбъект = Справочники.Пользователи.СоздатьЭлемент();\r\n\t\t\r\n\t\tПользовательОбъект.Наименование = ОписаниеПользователяИБ.ПолноеИмя;\r\n\t\t\r\n\t\t// Установим связь пользователя ИБ и пользователя из справочника \"Пользователи\"\r\n\t\tСвойстваПользователяИБ = Новый Структура;\r\n\t\tСвойстваПользователяИБ.Вставить(\"Действие\", \"Записать\");\r\n\t\tСвойстваПользователяИБ.Вставить(\"УникальныйИдентификатор\", ОписаниеПользователяИБ.УникальныйИдентификатор);\t\r\n\t\t\r\n\t\tПользовательОбъект.ДополнительныеСвойства.Вставить(\"ОписаниеПользователяИБ\", СвойстваПользователяИБ);\r\n\t\t\r\n\t\tПользовательОбъект.Записать();\r\n\t\t\r\n\t\t\r\n\t\t// Добавим пользователя в группу доступа;\r\n\t\tГруппаДоступа  = ГруппаДоступа.ПолучитьОбъект();\r\n\t\t\r\n\t\tПользователиВГруппе = ГруппаДоступа.Пользователи.Добавить();\r\n\t\tПользователиВГруппе.Пользователь = ПользовательОбъект.Ссылка;\r\n\t\t\r\n\t\tГруппаДоступа.Записать();\t\t\r\n\t\t\r\n\t\t// Пример добавления дополнительных ролей пользователю,  \r\n\t\t// в случае если не все необходимые роли есть в группах доступа\r\n\t\t\r\n\t\t// Сначала получим свойства созданного пользователя с ролями, \r\n\t\t// которые были назначены из заданных групп доступа\r\n\t\tСвойстваСозданногоПользователяИБ = \r\n                             Пользователи.СвойстваПользователяИБ(ОписаниеПользователяИБ.УникальныйИдентификатор);\r\n\t\t\r\n\t\t// в массиве указываются названия ролей из конфигурации\r\n\t\tСвойстваСозданногоПользователяИБ.Роли.Добавить(\"ЗапускВебКлиента\");\r\n\t\tСвойстваСозданногоПользователяИБ.Роли.Добавить(\"БазовыеПраваБСП\");\r\n\t\tСвойстваСозданногоПользователяИБ.Роли.Добавить(\"ПолныеПрава\");\t\t\r\n\t\t\r\n\t\t// Отключаем флаг создания нового, так как пользователь уже создан\r\n\t\t\r\n\t\tСоздаватьПользователяИБ = Ложь;\r\n\t\t\r\n\t\tПользователи.УстановитьСвойстваПользователяИБ(\r\n                              ИмяПользователя, СвойстваСозданногоПользователяИБ, СоздаватьПользователяИБ);\r\n\t\t\r\n\t\tЗафиксироватьТранзакцию();\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tЕсли ТранзакцияАктивна() Тогда\r\n\t\t\tОтменитьТранзакцию();\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tИмяСобытия = \"Создание пользователя\";\r\n\t\t\r\n\t\tЗаписьЖурналаРегистрации(ИмяСобытия, УровеньЖурналаРегистрации.Ошибка,, ИмяПользователя, ОписаниеОшибки());\r\n\t\t\r\n\t\tСообщить(ОписаниеОшибки());\r\n\t\t\r\n\tКонецПопытки;\r\n\r\nКонецПроцедуры"
  },
  {
    "title": "Итоги в подвале таблицы с учетом отбора",
    "description": "Итоги в подвале таблицы с учетом отбора",
    "code_snippet": "&НаКлиенте\r\nПроцедура ОбновитьИтоги(Команда)\r\n\r\n    ДанныеТаб = Отчет.ТаблицаФормы1;\r\n\tСумма1 = 0;\r\n\tЕсли Элементы.ТаблицаФормы1.ВыделенныеСтроки.Количество() > 1 тогда\r\n\t\tДля каждого с из Элементы.ТаблицаФормы1.ВыделенныеСтроки цикл\r\n\t\t\tстр = ДанныеТаб.НайтиПоИдентификатору(с);\r\n\t\t\tСумма1 = Сумма1 + стр.СуммаЗатрат;\r\n\t\tКонецЦикла;\r\n\tИначе\r\n\t\tДля каждого стр из ДанныеТаб цикл\r\n\t\t\tЕсли Элементы.ТаблицаФормы1.ПроверитьСтроку(стр.ПолучитьИдентификатор()) тогда\r\n\t\t\t\t Сумма1 = Сумма1 + стр.СуммаЗатрат;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\tЭлементы.ТаблицаФормы1.ПодчиненныеЭлементы.ТаблицаФормы1СуммаЗатрат.ТекстПодвала = Формат(Сумма1,\"ЧДЦ=2\");\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура ОбновитьИтоги(Команда)\r\n\r\n    ДанныеТаб = Отчет.ТаблицаФормы1;\r\n\tСумма1 = 0;\r\n\tЕсли Элементы.ТаблицаФормы1.ВыделенныеСтроки.Количество() > 1 тогда\r\n\t\tДля каждого с из Элементы.ТаблицаФормы1.ВыделенныеСтроки цикл\r\n\t\t\tстр = ДанныеТаб.НайтиПоИдентификатору(с);\r\n\t\t\tСумма1 = Сумма1 + стр.СуммаЗатрат;\r\n\t\tКонецЦикла;\r\n\tИначе\r\n\t\tДля каждого стр из ДанныеТаб цикл\r\n\t\t\tЕсли Элементы.ТаблицаФормы1.ПроверитьСтроку(стр.ПолучитьИдентификатор()) тогда\r\n\t\t\t\t Сумма1 = Сумма1 + стр.СуммаЗатрат;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\tЭлементы.ТаблицаФормы1.ПодчиненныеЭлементы.ТаблицаФормы1СуммаЗатрат.ТекстПодвала = Формат(Сумма1,\"ЧДЦ=2\");\r\nКонецПроцедуры"
  },
  {
    "title": "Номер без префикса и лидирующих нулей",
    "description": "Номер без префикса и лидирующих нулей",
    "code_snippet": "Функция ЧислоСправа1(Номер)\r\n   Возврат Формат(Число(\"0\" + Сред(Номер, СтрДлина(СокрП(\r\n   СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(Номер\r\n   , \"0\", \" \"), \"1\", \" \"), \"2\", \" \"), \"3\", \" \"), \"4\", \" \"), \"5\", \" \"), \"6\", \" \"), \"7\", \" \"), \"8\", \" \"), \"9\", \" \"))) + 1)), \"ЧГ=\");\r\nКонецФункции\n\nФункция ЧислоСправа1(Номер)\r\n   Возврат Формат(Число(\"0\" + Сред(Номер, СтрДлина(СокрП(\r\n   СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(Номер\r\n   , \"0\", \" \"), \"1\", \" \"), \"2\", \" \"), \"3\", \" \"), \"4\", \" \"), \"5\", \" \"), \"6\", \" \"), \"7\", \" \"), \"8\", \" \"), \"9\", \" \"))) + 1)), \"ЧГ=\");\r\nКонецФункции"
  },
  {
    "title": "Конструктор массива (Массив = Массив(Значение1, ... , Значение20))",
    "description": "Конструктор массива (Массив = Массив(Значение1, ... , Значение20))",
    "code_snippet": "Функция Массив(\r\n    Значениеначение1=Неопределено, Значение2=Неопределено, Значение3=Неопределено, Значение4=Неопределено, Значение5=Неопределено, \r\n    Значение6=Неопределено, Значение7=Неопределено, Значение8=Неопределено, Значение9=Неопределено, Значение10=Неопределено, \r\n    Значение11=Неопределено, Значение12=Неопределено, Значение13=Неопределено, Значение14=Неопределено, Значение15=Неопределено, \r\n    Значение16=Неопределено, Значение17=Неопределено, Значение18=Неопределено, Значение19=Неопределено, Значение20=Неопределено) Экспорт\r\n    \r\n\tЕсли ТипЗначения(Значение1) = Тип(\"Массив\") Тогда\r\n\t\tМ = Значение1\t\r\n\tИначе  \r\n\t\tМ = Новый Массив();\r\n\t\tЕсли Значение1=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение1); КонецЕсли;\r\n\tКонецЕсли;\r\n    \r\n   Если Значение2=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение2); КонецЕсли; \r\n   Если Значение3=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение3); КонецЕсли; \r\n   Если Значение4=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение4); КонецЕсли; \r\n   Если Значение5=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение5); КонецЕсли; \r\n   Если Значение6=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение6); КонецЕсли; \r\n   Если Значение7=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение7); КонецЕсли; \r\n   Если Значение8=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение8); КонецЕсли; \r\n   Если Значение9=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение9); КонецЕсли; \r\n   Если Значение10=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение10); КонецЕсли; \r\n   Если Значение11=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение11); КонецЕсли; \r\n   Если Значение12=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение12); КонецЕсли; \r\n   Если Значение13=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение13); КонецЕсли; \r\n   Если Значение14=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение14); КонецЕсли; \r\n   Если Значение15=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение15); КонецЕсли; \r\n   Если Значение16=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение16); КонецЕсли; \r\n   Если Значение17=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение17); КонецЕсли; \r\n   Если Значение18=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение18); КонецЕсли; \r\n   Если Значение19=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение19); КонецЕсли; \r\n   Если Значение20=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение20); КонецЕсли;\r\n\t\r\n\tВозврат М;\r\nКонецФункции\n\nФункция Массив(\r\n    Значениеначение1=Неопределено, Значение2=Неопределено, Значение3=Неопределено, Значение4=Неопределено, Значение5=Неопределено, \r\n    Значение6=Неопределено, Значение7=Неопределено, Значение8=Неопределено, Значение9=Неопределено, Значение10=Неопределено, \r\n    Значение11=Неопределено, Значение12=Неопределено, Значение13=Неопределено, Значение14=Неопределено, Значение15=Неопределено, \r\n    Значение16=Неопределено, Значение17=Неопределено, Значение18=Неопределено, Значение19=Неопределено, Значение20=Неопределено) Экспорт\r\n    \r\n\tЕсли ТипЗначения(Значение1) = Тип(\"Массив\") Тогда\r\n\t\tМ = Значение1\t\r\n\tИначе  \r\n\t\tМ = Новый Массив();\r\n\t\tЕсли Значение1=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение1); КонецЕсли;\r\n\tКонецЕсли;\r\n    \r\n   Если Значение2=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение2); КонецЕсли; \r\n   Если Значение3=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение3); КонецЕсли; \r\n   Если Значение4=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение4); КонецЕсли; \r\n   Если Значение5=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение5); КонецЕсли; \r\n   Если Значение6=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение6); КонецЕсли; \r\n   Если Значение7=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение7); КонецЕсли; \r\n   Если Значение8=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение8); КонецЕсли; \r\n   Если Значение9=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение9); КонецЕсли; \r\n   Если Значение10=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение10); КонецЕсли; \r\n   Если Значение11=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение11); КонецЕсли; \r\n   Если Значение12=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение12); КонецЕсли; \r\n   Если Значение13=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение13); КонецЕсли; \r\n   Если Значение14=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение14); КонецЕсли; \r\n   Если Значение15=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение15); КонецЕсли; \r\n   Если Значение16=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение16); КонецЕсли; \r\n   Если Значение17=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение17); КонецЕсли; \r\n   Если Значение18=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение18); КонецЕсли; \r\n   Если Значение19=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение19); КонецЕсли; \r\n   Если Значение20=Неопределено Тогда Возврат М; Иначе М.Добавить(Значение20); КонецЕсли;\r\n\t\r\n\tВозврат М;\r\nКонецФункции\n\n{1} Высокая цикломатическая сложность: 62\r\nОрфографическая ошибка в Значениеначение1: Значениеначение\r\nОрфографическая ошибка в Неопределено (найдено 40): Неопределено"
  },
  {
    "title": "XML -> Структура/Соответствие (хмл в структуру/соответствие)",
    "description": "XML -> Структура/Соответствие (хмл в структуру/соответствие)",
    "code_snippet": "Функция ЧитатьХМЛ(XML, КакСтруктуру = Ложь) Экспорт\r\n\t\r\n\tЕсли СтрНачинаетсяС(НРег(СокрЛП(Лев(XML, 1024))), \"<\") ИЛИ НРег(Лев(XML, 5)) = \"<html\" ИЛИ НРег(Лев(XML, 14)) = \"<!doctype html\" Тогда\r\n\t\tЧтениеXML.УстановитьСтроку(XML);\r\n\tИначеЕсли НайтиФайлы(Лев(СокрЛП(XML), 260)).Количество() > 0 Тогда \r\n\t\tФайл = Новый Файл(XML);\r\n\t\tЕсли Не Файл.Существует() Тогда\r\n\t\t\tВызватьИсключение \"Файл \"\"\" + XML + \"\"\" не существует!\";\r\n\t\tКонецЕсли;\r\n\t\tФайл = \"\";\r\n\t\tЧтениеXML.ОткрытьФайл(XML);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли КакСтруктуру Тогда\r\n    \tКорень = ЧитатьКакСтруктуру(ЧтениеXML);\r\n\tИначе\r\n    \tКорень = ЧитатьКакСоответствие(ЧтениеXML);\r\n\tКонецЕсли;\r\n\t\r\n\tЧтениеXML = \"\";\r\n\t\r\n\tВозврат Корень;\r\nКонецФункции\r\n\r\nФункция ЧитатьКакСтруктуру(XML, ТипПоследнегоЭлемента = Неопределено)\r\n\tВетка = Новый Структура;\r\n\tЗначение = \"\";\r\n\t\r\n\tПока XML.Прочитать() Цикл\r\n\t\tТипУзла = XML.ТипУзла;\r\n\t\tЕсли ТипУзла = ТипУзлаXML.НачалоЭлемента Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.НачалоЭлемента;\r\n\t\t\tВременно = \"\";\r\n\t\t\tЕсли Ветка.Свойство(XML.Имя, Временно) Тогда\r\n\t\t\t\tЕсли ТипЗнч(Временно) <> Тип(\"Массив\") Тогда\r\n\t\t\t\t\tЭнЗэ = Новый Массив;\r\n\t\t\t\t\tЭнЗэ.Добавить(Временно);\r\n\t\t\t\t\tВременно = ЭнЗэ;\r\n\t\t\t\t\tЭнЗэ = \"\";\r\n\t\t\t\t\tВетка.Удалить(XML.Имя);\r\n\t\t\t\t\tВетка.Вставить(XML.Имя, Временно);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\tВременно.Добавить(ЧитатьКакСтруктуру(XML, ТипПоследнегоЭлемента));\r\n\t\t\tИначе\r\n\t\t\t\tВетка.Вставить(XML.Имя, ЧитатьКакСтруктуру(XML, ТипПоследнегоЭлемента));\r\n\t\t\tКонецЕсли;\r\n\t\tИначеЕсли ТипУзла = ТипУзлаXML.КонецЭлемента Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.КонецЭлемента;\r\n\t\t\tВозврат ?(ЗначениеЗаполнено(Ветка), Ветка, Значение);\r\n\t\tИначеЕсли ТипУзла = ТипУзлаXML.Текст И Не ТипПоследнегоЭлемента = ТипУзлаXML.Текст Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.Текст;\r\n\t\t\tЗначение = XML.Значение;\r\n\t\t\tXML.Прочитать(); //Вычитка закрывающего тега\r\n\t\t\tВозврат Значение;\r\n\t\tИначе\r\n\t\t\t// игнорируем текст вне узлов\r\n\t\t\t// можем также добавлять текст вне узлов в текст, находящийся в предыдущем узле через какой нибудь спецсимвол\r\n\t\t\t// например через Таб, код ниже:\r\n\t\t\t//Временно[Временно.ВГраница()] = Временно[Временно.ВГраница()] + Символы.Таб + XML.Значение\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Ветка;\r\nКонецФункции\r\n\r\nФункция ЧитатьКакСоответствие(XML, ТипПоследнегоЭлемента = Неопределено)\t\r\n\tВетка = Новый Соответствие;\r\n\tЗначение = \"\";\r\n\t\r\n\tПока XML.Прочитать() Цикл\r\n\t\tТипУзла = XML.ТипУзла;\r\n\t\tЕсли ТипУзла = ТипУзлаXML.НачалоЭлемента Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.НачалоЭлемента; \r\n\t\t\tИмя = XML.Имя;\r\n\t\t\tВременно = Ветка.Получить(Имя);\r\n\t\t\tЕсли Временно = Неопределено Тогда\r\n\t\t\t\tВетка.Вставить(Имя, ЧитатьКакСоответствие(XML, ТипПоследнегоЭлемента));\r\n\t\t\tИначе\r\n\t\t\t\tЕсли ТипЗнч(Временно) <> Тип(\"Массив\") Тогда\r\n\t\t\t\t\tЭнЗэ = Новый Массив;\r\n\t\t\t\t\tЭнЗэ.Добавить(Временно);\r\n\t\t\t\t\tВременно = ЭнЗэ;\r\n\t\t\t\t\tЭнЗэ = \"\";\r\n\t\t\t\t\tВетка.Удалить(Имя);\r\n\t\t\t\t\tВетка.Вставить(Имя, Временно);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\tВременно.Добавить(ЧитатьКакСоответствие(XML, ТипПоследнегоЭлемента));\r\n\t\t\tКонецЕсли;\r\n\t\tИначеЕсли ТипУзла = ТипУзлаXML.КонецЭлемента Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.КонецЭлемента;\r\n\t\t\tВозврат ?(ЗначениеЗаполнено(Ветка), Ветка, Значение);\r\n\t\tИначеЕсли ТипУзла = ТипУзлаXML.Текст И Не ТипПоследнегоЭлемента = ТипУзлаXML.Текст Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.Текст;\r\n\t\t\tЗначение = Значение + XML.Значение;\r\n\t\t\tXML.Прочитать(); //Вычитка закрывающего тега\r\n\t\t\tВозврат Значение;\r\n\t\tИначе\r\n\t\t\t// игнорируем текст вне узлов\r\n\t\t\t// можем также добавлять текст вне узлов в текст, находящийся в предыдущем узле через какой нибудь спецсимвол\r\n\t\t\t// например через Таб, код ниже:\r\n\t\t\t//Временно[Временно.ВГраница()] = Временно[Временно.ВГраница()] + Символы.Таб + XML.Значение   \t\t\t\t\t\t\r\n\t\tКонецЕсли\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Ветка;\r\nКонецФункции\n\nФункция ЧитатьХМЛ(XML, КакСтруктуру = Ложь) Экспорт\r\n\t\r\n\tЕсли СтрНачинаетсяС(НРег(СокрЛП(Лев(XML, 1024))), \"<\") ИЛИ НРег(Лев(XML, 5)) = \"<html\" ИЛИ НРег(Лев(XML, 14)) = \"<!doctype html\" Тогда\r\n\t\tЧтениеXML.УстановитьСтроку(XML);\r\n\tИначеЕсли НайтиФайлы(Лев(СокрЛП(XML), 260)).Количество() > 0 Тогда \r\n\t\tФайл = Новый Файл(XML);\r\n\t\tЕсли Не Файл.Существует() Тогда\r\n\t\t\tВызватьИсключение \"Файл \"\"\" + XML + \"\"\" не существует!\";\r\n\t\tКонецЕсли;\r\n\t\tФайл = \"\";\r\n\t\tЧтениеXML.ОткрытьФайл(XML);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли КакСтруктуру Тогда\r\n    \tКорень = ЧитатьКакСтруктуру(ЧтениеXML);\r\n\tИначе\r\n    \tКорень = ЧитатьКакСоответствие(ЧтениеXML);\r\n\tКонецЕсли;\r\n\t\r\n\tЧтениеXML = \"\";\r\n\t\r\n\tВозврат Корень;\r\nКонецФункции\r\n\r\nФункция ЧитатьКакСтруктуру(XML, ТипПоследнегоЭлемента = Неопределено)\r\n\tВетка = Новый Структура;\r\n\tЗначение = \"\";\r\n\t\r\n\tПока XML.Прочитать() Цикл\r\n\t\tТипУзла = XML.ТипУзла;\r\n\t\tЕсли ТипУзла = ТипУзлаXML.НачалоЭлемента Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.НачалоЭлемента;\r\n\t\t\tВременно = \"\";\r\n\t\t\tЕсли Ветка.Свойство(XML.Имя, Временно) Тогда\r\n\t\t\t\tЕсли ТипЗнч(Временно) <> Тип(\"Массив\") Тогда\r\n\t\t\t\t\tЭнЗэ = Новый Массив;\r\n\t\t\t\t\tЭнЗэ.Добавить(Временно);\r\n\t\t\t\t\tВременно = ЭнЗэ;\r\n\t\t\t\t\tЭнЗэ = \"\";\r\n\t\t\t\t\tВетка.Удалить(XML.Имя);\r\n\t\t\t\t\tВетка.Вставить(XML.Имя, Временно);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\tВременно.Добавить(ЧитатьКакСтруктуру(XML, ТипПоследнегоЭлемента));\r\n\t\t\tИначе\r\n\t\t\t\tВетка.Вставить(XML.Имя, ЧитатьКакСтруктуру(XML, ТипПоследнегоЭлемента));\r\n\t\t\tКонецЕсли;\r\n\t\tИначеЕсли ТипУзла = ТипУзлаXML.КонецЭлемента Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.КонецЭлемента;\r\n\t\t\tВозврат ?(ЗначениеЗаполнено(Ветка), Ветка, Значение);\r\n\t\tИначеЕсли ТипУзла = ТипУзлаXML.Текст И Не ТипПоследнегоЭлемента = ТипУзлаXML.Текст Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.Текст;\r\n\t\t\tЗначение = XML.Значение;\r\n\t\t\tXML.Прочитать(); //Вычитка закрывающего тега\r\n\t\t\tВозврат Значение;\r\n\t\tИначе\r\n\t\t\t// игнорируем текст вне узлов\r\n\t\t\t// можем также добавлять текст вне узлов в текст, находящийся в предыдущем узле через какой нибудь спецсимвол\r\n\t\t\t// например через Таб, код ниже:\r\n\t\t\t//Временно[Временно.ВГраница()] = Временно[Временно.ВГраница()] + Символы.Таб + XML.Значение\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Ветка;\r\nКонецФункции\r\n\r\nФункция ЧитатьКакСоответствие(XML, ТипПоследнегоЭлемента = Неопределено)\t\r\n\tВетка = Новый Соответствие;\r\n\tЗначение = \"\";\r\n\t\r\n\tПока XML.Прочитать() Цикл\r\n\t\tТипУзла = XML.ТипУзла;\r\n\t\tЕсли ТипУзла = ТипУзлаXML.НачалоЭлемента Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.НачалоЭлемента; \r\n\t\t\tИмя = XML.Имя;\r\n\t\t\tВременно = Ветка.Получить(Имя);\r\n\t\t\tЕсли Временно = Неопределено Тогда\r\n\t\t\t\tВетка.Вставить(Имя, ЧитатьКакСоответствие(XML, ТипПоследнегоЭлемента));\r\n\t\t\tИначе\r\n\t\t\t\tЕсли ТипЗнч(Временно) <> Тип(\"Массив\") Тогда\r\n\t\t\t\t\tЭнЗэ = Новый Массив;\r\n\t\t\t\t\tЭнЗэ.Добавить(Временно);\r\n\t\t\t\t\tВременно = ЭнЗэ;\r\n\t\t\t\t\tЭнЗэ = \"\";\r\n\t\t\t\t\tВетка.Удалить(Имя);\r\n\t\t\t\t\tВетка.Вставить(Имя, Временно);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\tВременно.Добавить(ЧитатьКакСоответствие(XML, ТипПоследнегоЭлемента));\r\n\t\t\tКонецЕсли;\r\n\t\tИначеЕсли ТипУзла = ТипУзлаXML.КонецЭлемента Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.КонецЭлемента;\r\n\t\t\tВозврат ?(ЗначениеЗаполнено(Ветка), Ветка, Значение);\r\n\t\tИначеЕсли ТипУзла = ТипУзлаXML.Текст И Не ТипПоследнегоЭлемента = ТипУзлаXML.Текст Тогда\r\n\t\t\tТипПоследнегоЭлемента = ТипУзлаXML.Текст;\r\n\t\t\tЗначение = Значение + XML.Значение;\r\n\t\t\tXML.Прочитать(); //Вычитка закрывающего тега\r\n\t\t\tВозврат Значение;\r\n\t\tИначе\r\n\t\t\t// игнорируем текст вне узлов\r\n\t\t\t// можем также добавлять текст вне узлов в текст, находящийся в предыдущем узле через какой нибудь спецсимвол\r\n\t\t\t// например через Таб, код ниже:\r\n\t\t\t//Временно[Временно.ВГраница()] = Временно[Временно.ВГраница()] + Символы.Таб + XML.Значение   \t\t\t\t\t\t\r\n\t\tКонецЕсли\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Ветка;\r\nКонецФункции\n\n{10} Переменной Файл присвоено значение, но оно нигде не используется\r\n{20} Переменной ЧтениеXML присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в doctype: doctype\r\nОрфографическая ошибка в Неопределено (найдено 3): Неопределено\r\nОрфографическая ошибка в нибудь (найдено 2): нибудь"
  },
  {
    "title": "CSV в массив из структур",
    "description": "CSV в массив из структур",
    "code_snippet": "Функция ПреобразоватьCSVвМассив(CSV)\r\n\t\r\n\tРазделитель        = Символы.Таб;\r\n\tЗаголовкиCSV       = СокрЛП(СтрПолучитьСтроку(CSV,1));\r\n\t\r\n\tDATA = Новый Массив;\r\n\tДля НомерСтроки=2 По СтрЧислоСтрок(CSV) Цикл  \r\n\t\tСтрока         = СтрПолучитьСтроку(CSV, НомерСтроки);\r\n\t\tМассивПодстрок = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Строка, Разделитель, Ложь, );\r\n\t\tСтруктура      = Новый Структура(СтрЗаменить(ЗаголовкиCSV,  Разделитель, \",\"));\r\n\t\tИнд            = 0;\r\n\t\tДля Каждого КлючЗначение Из Структура Цикл\r\n\t\t\tСтруктура[КлючЗначение.Ключ] = МассивПодстрок[Инд];\r\n\t\t\tИнд = Инд+1;\r\n\t\tКонецЦикла;\r\n\t\tDATA.Добавить(Структура);\r\n\tКонецЦикла;\r\n\t\t\r\n\tВозврат DATA;\r\n\t\t\r\nКонецФункции\n\nФункция ПреобразоватьCSVвМассив(CSV)\r\n\t\r\n\tРазделитель        = Символы.Таб;\r\n\tЗаголовкиCSV       = СокрЛП(СтрПолучитьСтроку(CSV,1));\r\n\t\r\n\tDATA = Новый Массив;\r\n\tДля НомерСтроки=2 По СтрЧислоСтрок(CSV) Цикл  \r\n\t\tСтрока         = СтрПолучитьСтроку(CSV, НомерСтроки);\r\n\t\tМассивПодстрок = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Строка, Разделитель, Ложь, );\r\n\t\tСтруктура      = Новый Структура(СтрЗаменить(ЗаголовкиCSV,  Разделитель, \",\"));\r\n\t\tИнд            = 0;\r\n\t\tДля Каждого КлючЗначение Из Структура Цикл\r\n\t\t\tСтруктура[КлючЗначение.Ключ] = МассивПодстрок[Инд];\r\n\t\t\tИнд = Инд+1;\r\n\t\tКонецЦикла;\r\n\t\tDATA.Добавить(Структура);\r\n\tКонецЦикла;\r\n\t\t\r\n\tВозврат DATA;\r\n\t\t\r\nКонецФункции"
  },
  {
    "title": "Открытие значения элемента ОФ ячейки таблицы при клике на нем",
    "description": "Открытие значения элемента ОФ ячейки таблицы при клике на нем",
    "code_snippet": "Процедура СписокВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)\r\n    Если ВыбраннаяСтрока = Неопределено Тогда\r\n        Возврат;\r\n    КонецЕсли;\r\n    \r\n    ОткрытьЗначение(ВыбраннаяСтрока[Колонка.Имя]);\r\n    СтандартнаяОбработка = Ложь;\r\nКонецПроцедуры\n\nПроцедура СписокВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)\r\n    Если ВыбраннаяСтрока = Неопределено Тогда\r\n        Возврат;\r\n    КонецЕсли;\r\n    \r\n    ОткрытьЗначение(ВыбраннаяСтрока[Колонка.Имя]);\r\n    СтандартнаяОбработка = Ложь;\r\nКонецПроцедуры\n\nОрфографическая ошибка в Неопределено: Неопределено"
  },
  {
    "title": "Пример формирования внешней печатной формы из макета Word. БСП",
    "description": "Пример формирования внешней печатной формы из макета Word. БСП",
    "code_snippet": "Функция СведенияОВнешнейОбработке() Экспорт\r\n\t\r\n\t// Стандартное описание сведений о внешней печатной форме\r\n\r\n\tПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке();\r\n\t\r\n\tПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиПечатнаяФорма();\r\n\t\r\n\tПараметрыРегистрации.БезопасныйРежим = Ложь;\r\n\tПараметрыРегистрации.Вставить(\"Версия\", \"1.0\");\r\n\tПараметрыРегистрации.Наименование = \"Название печатной формы\";\r\n\t\r\n\tПараметрыРегистрации.Назначение.Добавить(\"Справочник.ФизическиеЛица\");\r\n\t\r\n\tНоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n\tНоваяКоманда.Представление = \"Название команды\";   //Синоним\r\n\tНоваяКоманда.Идентификатор = \"НазваниеКоманды\";   //ПолноеИмя\r\n\tНоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\r\n\t\t\r\n\tВозврат ПараметрыРегистрации;\r\n\t\r\nКонецФункции\r\n\r\nПроцедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\r\n\t\r\n\t// Просто передаем управление дальше если удовлетворяет условию\r\n\r\n\tЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, \"НазваниеКоманды\") Тогда\r\n\t\tПечатьДокумента(КоллекцияПечатныхФорм, МассивОбъектов, ОбъектыПечати);\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ПечатьДокумента(КоллекцияПечатныхФорм, МассивОбъектов, ОбъектыПечати) Экспорт\r\n\t\r\n\t // Сначала получим данные а потом передадим их для заполнения макета\r\n\t\t\r\n\tМассивДанныхЗаполнения = ПолучитьДанныеДляПечатиДокумента(МассивОбъектов);\t\r\n\t\t\r\n\tВывестиДанныеДокументаВТабличныйДокумент(КоллекцияПечатныхФорм, МассивДанныхЗаполнения, ОбъектыПечати);\r\n\t\t\r\nКонецПроцедуры \r\n\r\nФункция ПолучитьДанныеДляПечатиДокумента(МассивОбъектов)\r\n\r\n\t// здесь происходит заполнение данными для ПФ\r\n\r\n\tДанные = Новый Структура;\r\n\tДанные.Вставить(\"Организация\", \"ООО \"\"Рога и копыта\"\"\");\r\n\tДанные.Вставить(\"Контрагент\", \"ИП Иванов\");\r\n\tДанные.Вставить(\"СуммаОплаты\", 10523);    \r\n\tДанные.Вставить(\"Дата\", '202110102158');  \r\n\t\r\n\tТаблицаДанных = Новый ТаблицаЗначений;\r\n\tТаблицаДанных.Колонки.Добавить(\"Номенклатура\");\r\n\tТаблицаДанных.Колонки.Добавить(\"Количество\");\r\n\tТаблицаДанных.Колонки.Добавить(\"Сумма\");\r\n\r\n\tСтрока = ТаблицаДанных.Добавить();\r\n\tСтрока.Номенклатура = \"тест\";\r\n\tСтрока.Количество = 2;\r\n\tСтрока.Сумма = 50;\r\n\t\r\n\tСтрока = ТаблицаДанных.Добавить();\r\n\tСтрока.Номенклатура = \"тест1\";\r\n\tСтрока.Количество = 3;\r\n\tСтрока.Сумма = 55;\r\n\t\r\n\tСтрока = ТаблицаДанных.Добавить();\r\n\tСтрока.Номенклатура = \"тест2\";\r\n\tСтрока.Количество = 4;\r\n\tСтрока.Сумма = 51; \r\n\t\r\n\tТаблицаДанныхВМассиве = ОбщегоНазначения.ТаблицаЗначенийВМассив(ТаблицаДанных);\r\n\t\r\n\tДанные.Вставить(\"ТаблицаДанных\", ТаблицаДанныхВМассиве);\r\n\t\r\n\tВозврат Данные;\r\n\t\r\nКонецФункции \r\n\r\nПроцедура ВывестиДанныеДокументаВТабличныйДокумент(КоллекцияПечатныхФорм, МассивДанныхЗаполнения, ОбъектыПечати)\r\n\r\n\tДвоичныеДанныеМакета = ПолучитьМакет(\"ПФ_DOC_НазваниеМакета\");\r\n\t\r\n\tЕсли ДвоичныеДанныеМакета <> Неопределено Тогда\r\n\t\t\r\n\t\t// Инициализируем печатную форму\t\r\n\t\t\r\n\t\tПечатнаяФорма = УправлениеПечатью.СведенияОПечатнойФорме(КоллекцияПечатныхФорм, \"НазваниеКоманды\");\r\n\t\t\r\n\t\t// Наличие пустого табличного документа в коллекции обязательно\r\n\t\t\r\n\t\tПечатнаяФорма.ТабличныйДокумент = Новый ТабличныйДокумент;\r\n\t\t\r\n\t\tМакет = УправлениеПечатью.ИнициализироватьМакетОфисногоДокумента(ДвоичныеДанныеМакета,Неопределено);\r\n\t\tПечатнаяФормаДокумента = УправлениеПечатью.ИнициализироватьПечатнуюФорму(Неопределено, Макет.НастройкиСтраницыМакета, Макет);\t\t\r\n\t\t\r\n\t\t// Определим какие области в документе Word хотим заполнить \r\n\t\t// Для этого у нас документ должен быть размечен конструкциями \r\n\t\t// {v8 Область.НазваниеОбласти} \r\n\t\t// {/v8 Область.НазваниеОбласти}\r\n\t\t// наличие областей обязательно\r\n\t\t\r\n\t\t// Область для заполнения обычных параметров в тексте\r\n\t\t\r\n\t\tОбластьЗаголовок = Новый Структура;\r\n\t\tОбластьЗаголовок.Вставить(\"ИмяОбласти\", \"Заголовок\");\r\n\t\tОбластьЗаголовок.Вставить(\"ТипОбласти\", \"Общая\");\r\n\t\t\r\n\t\t// Пример определения областей коллекций (таблица и нумерованный или обычный списки)\t\r\n\t\tОбластьШапкаТаблицы = Новый Структура;\r\n\t\tОбластьШапкаТаблицы.Вставить(\"ИмяОбласти\", \"ШапкаТаблицы\");\r\n\t\tОбластьШапкаТаблицы.Вставить(\"ТипОбласти\", \"Общая\");\r\n\t\t\r\n\t\tОбластьСтрокаТаблицы = Новый Структура;\r\n\t\tОбластьСтрокаТаблицы.Вставить(\"ИмяОбласти\", \"СтрокаТаблицы\");\r\n\t\tОбластьСтрокаТаблицы.Вставить(\"ТипОбласти\", \"СтрокаТаблицы\");\r\n\t\t\r\n\t\t// Область должна быть определена первым элементом списка \r\n\t\t// {v8 Область.НумерованныйСписок}\r\n\t\t// 1.{v8 Номенклатура}\r\n\t\t// {/v8 Область.НумерованныйСписок}\r\n\t\t\r\n\t\tОбластьНумерованныйСписка = Новый Структура;\r\n\t\tОбластьНумерованныйСписка.Вставить(\"ИмяОбласти\", \"НумерованныйСписок\");  \r\n\t\tОбластьНумерованныйСписка.Вставить(\"ТипОбласти\", \"Список\");\r\n\t\t\r\n\t\t// Область должна быть определена первым элементом списка \r\n\t\t// {v8 Область.МаркированныйСписок}\r\n\t\t// • {v8 Номенклатура}\r\n\t\t// {/v8 Область.МаркированныйСписок}\r\n\t\t\r\n\t\tОбластьМаркированногоСписка = Новый Структура;\r\n\t\tОбластьМаркированногоСписка.Вставить(\"ИмяОбласти\", \"МаркированныйСписок\");\r\n\t\tОбластьМаркированногоСписка.Вставить(\"ТипОбласти\", \"Список\"); \r\n\t\t\r\n\t\t// Пример определения областей колонтитулов, эти области в документе есть по умолчанию, \r\n\t\t// если колонтитулы определены в самом документе\r\n\t\t\r\n\t\tОбластьВерхнийКолонтитул = Новый Структура;\r\n\t\tОбластьВерхнийКолонтитул.Вставить(\"ИмяОбласти\", \"ВерхнийКолонтитул\");\r\n\t\tОбластьВерхнийКолонтитул.Вставить(\"ТипОбласти\", \"ВерхнийКолонтитул\");\r\n\t\t\r\n\t\tОбластьНижнийКолонтитул = Новый Структура;\r\n\t\tОбластьНижнийКолонтитул.Вставить(\"ИмяОбласти\", \"НижнийКолонтитул\");\r\n\t\tОбластьНижнийКолонтитул.Вставить(\"ТипОбласти\", \"НижнийКолонтитул\");\r\n\t\t\r\n\t\t// Передаем данные заполнения для заполнения печатной формы \r\n\t\t// Имена параметров данных заполнения должны совпадать с размеченными параметрами в документе в виде  \r\n\t\t// {v8 НазваниеПараметра}\r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьЗаголовок);\r\n\t\tУправлениеПечатью.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения, Ложь); \r\n\t\t\r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьВерхнийКолонтитул);  \r\n\t\tУправлениеПечатью.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения);\r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьНижнийКолонтитул);\r\n\t\tУправлениеПечатью.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения); \r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьШапкаТаблицы);\r\n\t\tУправлениеПечатью.ПрисоединитьОбласть(ПечатнаяФормаДокумента, Область, Ложь);\r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьСтрокаТаблицы);\r\n\t\tУправлениеПечатью.ПрисоединитьИЗаполнитьКоллекцию(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения.ТаблицаДанных); \r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьНумерованныйСписка);\r\n\t\tУправлениеПечатью.ПрисоединитьИЗаполнитьКоллекцию(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения.ТаблицаДанных);\r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьМаркированногоСписка);\r\n\t\tУправлениеПечатью.ПрисоединитьИЗаполнитьКоллекцию(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения.ТаблицаДанных);\r\n\t\t\r\n\t\t// Поместим получившийся документ в коллекцию печатных форм, в раздел ОфисныеДокументы\r\n\t\t// так БСП поймет что нужно открывать Word при формировании печатной формы\r\n\t\t\r\n\t\tАдресХранилищаОфисныйДокумент = УправлениеПечатью.СформироватьДокумент(ПечатнаяФормаДокумента);\r\n\t\tУправлениеПечатью.ОчиститьСсылки(ПечатнаяФормаДокумента, Ложь);\r\n\t\tУправлениеПечатью.ОчиститьСсылки(Макет);\r\n\t\t\r\n\t\tОфисныеДокументы = Новый Соответствие;\r\n\t\t\r\n\t\tОфисныеДокументы.Вставить(АдресХранилищаОфисныйДокумент, НСтр(\"ru = 'Название документа'\"));\r\n\t\t\r\n\t\tПечатнаяФорма.СинонимМакета    = НСтр(\"ru = 'Название документа (документ Microsoft Word)'\");\r\n\t\tПечатнаяФорма.ОфисныеДокументы = ОфисныеДокументы;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\nФункция СведенияОВнешнейОбработке() Экспорт\r\n\t\r\n\t// Стандартное описание сведений о внешней печатной форме\r\n\r\n\tПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке();\r\n\t\r\n\tПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиПечатнаяФорма();\r\n\t\r\n\tПараметрыРегистрации.БезопасныйРежим = Ложь;\r\n\tПараметрыРегистрации.Вставить(\"Версия\", \"1.0\");\r\n\tПараметрыРегистрации.Наименование = \"Название печатной формы\";\r\n\t\r\n\tПараметрыРегистрации.Назначение.Добавить(\"Справочник.ФизическиеЛица\");\r\n\t\r\n\tНоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n\tНоваяКоманда.Представление = \"Название команды\";   //Синоним\r\n\tНоваяКоманда.Идентификатор = \"НазваниеКоманды\";   //ПолноеИмя\r\n\tНоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\r\n\t\t\r\n\tВозврат ПараметрыРегистрации;\r\n\t\r\nКонецФункции\r\n\r\nПроцедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\r\n\t\r\n\t// Просто передаем управление дальше если удовлетворяет условию\r\n\r\n\tЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, \"НазваниеКоманды\") Тогда\r\n\t\tПечатьДокумента(КоллекцияПечатныхФорм, МассивОбъектов, ОбъектыПечати);\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ПечатьДокумента(КоллекцияПечатныхФорм, МассивОбъектов, ОбъектыПечати) Экспорт\r\n\t\r\n\t // Сначала получим данные а потом передадим их для заполнения макета\r\n\t\t\r\n\tМассивДанныхЗаполнения = ПолучитьДанныеДляПечатиДокумента(МассивОбъектов);\t\r\n\t\t\r\n\tВывестиДанныеДокументаВТабличныйДокумент(КоллекцияПечатныхФорм, МассивДанныхЗаполнения, ОбъектыПечати);\r\n\t\t\r\nКонецПроцедуры \r\n\r\nФункция ПолучитьДанныеДляПечатиДокумента(МассивОбъектов)\r\n\r\n\t// здесь происходит заполнение данными для ПФ\r\n\r\n\tДанные = Новый Структура;\r\n\tДанные.Вставить(\"Организация\", \"ООО \"\"Рога и копыта\"\"\");\r\n\tДанные.Вставить(\"Контрагент\", \"ИП Иванов\");\r\n\tДанные.Вставить(\"СуммаОплаты\", 10523);    \r\n\tДанные.Вставить(\"Дата\", '202110102158');  \r\n\t\r\n\tТаблицаДанных = Новый ТаблицаЗначений;\r\n\tТаблицаДанных.Колонки.Добавить(\"Номенклатура\");\r\n\tТаблицаДанных.Колонки.Добавить(\"Количество\");\r\n\tТаблицаДанных.Колонки.Добавить(\"Сумма\");\r\n\r\n\tСтрока = ТаблицаДанных.Добавить();\r\n\tСтрока.Номенклатура = \"тест\";\r\n\tСтрока.Количество = 2;\r\n\tСтрока.Сумма = 50;\r\n\t\r\n\tСтрока = ТаблицаДанных.Добавить();\r\n\tСтрока.Номенклатура = \"тест1\";\r\n\tСтрока.Количество = 3;\r\n\tСтрока.Сумма = 55;\r\n\t\r\n\tСтрока = ТаблицаДанных.Добавить();\r\n\tСтрока.Номенклатура = \"тест2\";\r\n\tСтрока.Количество = 4;\r\n\tСтрока.Сумма = 51; \r\n\t\r\n\tТаблицаДанныхВМассиве = ОбщегоНазначения.ТаблицаЗначенийВМассив(ТаблицаДанных);\r\n\t\r\n\tДанные.Вставить(\"ТаблицаДанных\", ТаблицаДанныхВМассиве);\r\n\t\r\n\tВозврат Данные;\r\n\t\r\nКонецФункции \r\n\r\nПроцедура ВывестиДанныеДокументаВТабличныйДокумент(КоллекцияПечатныхФорм, МассивДанныхЗаполнения, ОбъектыПечати)\r\n\r\n\tДвоичныеДанныеМакета = ПолучитьМакет(\"ПФ_DOC_НазваниеМакета\");\r\n\t\r\n\tЕсли ДвоичныеДанныеМакета <> Неопределено Тогда\r\n\t\t\r\n\t\t// Инициализируем печатную форму\t\r\n\t\t\r\n\t\tПечатнаяФорма = УправлениеПечатью.СведенияОПечатнойФорме(КоллекцияПечатныхФорм, \"НазваниеКоманды\");\r\n\t\t\r\n\t\t// Наличие пустого табличного документа в коллекции обязательно\r\n\t\t\r\n\t\tПечатнаяФорма.ТабличныйДокумент = Новый ТабличныйДокумент;\r\n\t\t\r\n\t\tМакет = УправлениеПечатью.ИнициализироватьМакетОфисногоДокумента(ДвоичныеДанныеМакета,Неопределено);\r\n\t\tПечатнаяФормаДокумента = УправлениеПечатью.ИнициализироватьПечатнуюФорму(Неопределено, Макет.НастройкиСтраницыМакета, Макет);\t\t\r\n\t\t\r\n\t\t// Определим какие области в документе Word хотим заполнить \r\n\t\t// Для этого у нас документ должен быть размечен конструкциями \r\n\t\t// {v8 Область.НазваниеОбласти} \r\n\t\t// {/v8 Область.НазваниеОбласти}\r\n\t\t// наличие областей обязательно\r\n\t\t\r\n\t\t// Область для заполнения обычных параметров в тексте\r\n\t\t\r\n\t\tОбластьЗаголовок = Новый Структура;\r\n\t\tОбластьЗаголовок.Вставить(\"ИмяОбласти\", \"Заголовок\");\r\n\t\tОбластьЗаголовок.Вставить(\"ТипОбласти\", \"Общая\");\r\n\t\t\r\n\t\t// Пример определения областей коллекций (таблица и нумерованный или обычный списки)\t\r\n\t\tОбластьШапкаТаблицы = Новый Структура;\r\n\t\tОбластьШапкаТаблицы.Вставить(\"ИмяОбласти\", \"ШапкаТаблицы\");\r\n\t\tОбластьШапкаТаблицы.Вставить(\"ТипОбласти\", \"Общая\");\r\n\t\t\r\n\t\tОбластьСтрокаТаблицы = Новый Структура;\r\n\t\tОбластьСтрокаТаблицы.Вставить(\"ИмяОбласти\", \"СтрокаТаблицы\");\r\n\t\tОбластьСтрокаТаблицы.Вставить(\"ТипОбласти\", \"СтрокаТаблицы\");\r\n\t\t\r\n\t\t// Область должна быть определена первым элементом списка \r\n\t\t// {v8 Область.НумерованныйСписок}\r\n\t\t// 1.{v8 Номенклатура}\r\n\t\t// {/v8 Область.НумерованныйСписок}\r\n\t\t\r\n\t\tОбластьНумерованныйСписка = Новый Структура;\r\n\t\tОбластьНумерованныйСписка.Вставить(\"ИмяОбласти\", \"НумерованныйСписок\");  \r\n\t\tОбластьНумерованныйСписка.Вставить(\"ТипОбласти\", \"Список\");\r\n\t\t\r\n\t\t// Область должна быть определена первым элементом списка \r\n\t\t// {v8 Область.МаркированныйСписок}\r\n\t\t// • {v8 Номенклатура}\r\n\t\t// {/v8 Область.МаркированныйСписок}\r\n\t\t\r\n\t\tОбластьМаркированногоСписка = Новый Структура;\r\n\t\tОбластьМаркированногоСписка.Вставить(\"ИмяОбласти\", \"МаркированныйСписок\");\r\n\t\tОбластьМаркированногоСписка.Вставить(\"ТипОбласти\", \"Список\"); \r\n\t\t\r\n\t\t// Пример определения областей колонтитулов, эти области в документе есть по умолчанию, \r\n\t\t// если колонтитулы определены в самом документе\r\n\t\t\r\n\t\tОбластьВерхнийКолонтитул = Новый Структура;\r\n\t\tОбластьВерхнийКолонтитул.Вставить(\"ИмяОбласти\", \"ВерхнийКолонтитул\");\r\n\t\tОбластьВерхнийКолонтитул.Вставить(\"ТипОбласти\", \"ВерхнийКолонтитул\");\r\n\t\t\r\n\t\tОбластьНижнийКолонтитул = Новый Структура;\r\n\t\tОбластьНижнийКолонтитул.Вставить(\"ИмяОбласти\", \"НижнийКолонтитул\");\r\n\t\tОбластьНижнийКолонтитул.Вставить(\"ТипОбласти\", \"НижнийКолонтитул\");\r\n\t\t\r\n\t\t// Передаем данные заполнения для заполнения печатной формы \r\n\t\t// Имена параметров данных заполнения должны совпадать с размеченными параметрами в документе в виде  \r\n\t\t// {v8 НазваниеПараметра}\r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьЗаголовок);\r\n\t\tУправлениеПечатью.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения, Ложь); \r\n\t\t\r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьВерхнийКолонтитул);  \r\n\t\tУправлениеПечатью.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения);\r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьНижнийКолонтитул);\r\n\t\tУправлениеПечатью.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения); \r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьШапкаТаблицы);\r\n\t\tУправлениеПечатью.ПрисоединитьОбласть(ПечатнаяФормаДокумента, Область, Ложь);\r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьСтрокаТаблицы);\r\n\t\tУправлениеПечатью.ПрисоединитьИЗаполнитьКоллекцию(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения.ТаблицаДанных); \r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьНумерованныйСписка);\r\n\t\tУправлениеПечатью.ПрисоединитьИЗаполнитьКоллекцию(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения.ТаблицаДанных);\r\n\t\t\r\n\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьМаркированногоСписка);\r\n\t\tУправлениеПечатью.ПрисоединитьИЗаполнитьКоллекцию(ПечатнаяФормаДокумента, Область, МассивДанныхЗаполнения.ТаблицаДанных);\r\n\t\t\r\n\t\t// Поместим получившийся документ в коллекцию печатных форм, в раздел ОфисныеДокументы\r\n\t\t// так БСП поймет что нужно открывать Word при формировании печатной формы\r\n\t\t\r\n\t\tАдресХранилищаОфисныйДокумент = УправлениеПечатью.СформироватьДокумент(ПечатнаяФормаДокумента);\r\n\t\tУправлениеПечатью.ОчиститьСсылки(ПечатнаяФормаДокумента, Ложь);\r\n\t\tУправлениеПечатью.ОчиститьСсылки(Макет);\r\n\t\t\r\n\t\tОфисныеДокументы = Новый Соответствие;\r\n\t\t\r\n\t\tОфисныеДокументы.Вставить(АдресХранилищаОфисныйДокумент, НСтр(\"ru = 'Название документа'\"));\r\n\t\t\r\n\t\tПечатнаяФорма.СинонимМакета    = НСтр(\"ru = 'Название документа (документ Microsoft Word)'\");\r\n\t\tПечатнаяФорма.ОфисныеДокументы = ОфисныеДокументы;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\nПроцедура ВывестиДанныеДокументаВТабличныйДокумент(КоллекцияПечатныхФорм, МассивОбъектов, ОбъектыПечати)\n\t\n\tДвоичныеДанныеМакета = ПолучитьМакет(\"ПФ_DOC\");\n\t\n\tЕсли ДвоичныеДанныеМакета <> Неопределено Тогда\n\t\tПечатнаяФорма = УправлениеПечатью.СведенияОПечатнойФорме(КоллекцияПечатныхФорм, ЭтотОбъект.Метаданные().Имя);\t\n\t\tОфисныеДокументы = Новый Соответствие;\n\t\tУстановитьПривилегированныйРежим(Истина);\n\t\tДля Каждого ОбъектСсылка из МассивОбъектов Цикл\t\n\t\t\t\n\t\t\tПечатнаяФорма.ТабличныйДокумент = Новый ТабличныйДокумент;\n\t\t\t\n\t\t\tМакет = УправлениеПечатью.ИнициализироватьМакетОфисногоДокумента(ДвоичныеДанныеМакета,Неопределено);\n\t\t\tПечатнаяФормаДокумента = УправлениеПечатью.ИнициализироватьПечатнуюФорму(Неопределено, Макет.НастройкиСтраницыМакета, Макет);\n\t\t\t\n\t\t\tОбластьЗаголовок = Новый Структура;\n\t\t\tОбластьЗаголовок.Вставить(\"ИмяОбласти\", \"Общая\");\n\t\t\tОбластьЗаголовок.Вставить(\"ТипОбласти\", \"Общая\");\n\t\t\t\n\t\t\tПараметрыЗаполнения = Новый Структура;\n\t\t\t\n\t\t\tФИО = \"Иванов ИИ\";\n\t\t\t\n\t\t\tПараметрыЗаполнения.Вставить(\"фиополные\", ФИО);\t\n\t\t\t\n\t\t\tОбласть = УправлениеПечатью.ОбластьМакета(Макет, ОбластьЗаголовок);\n\t\t\tУправлениеПечатью.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФормаДокумента, Область, ПараметрыЗаполнения, Ложь); \n\t\t\t\n\t\t\tАдресХранилищаОфисныйДокумент = УправлениеПечатью.СформироватьДокумент(ПечатнаяФормаДокумента);\n\t\t\t\n\t\t\tОфисныеДокументы.Вставить(АдресХранилищаОфисныйДокумент, КадровыеДанные.ФИО);\n\t\t\t\n\t\tКонецЦикла;\n\t\t\n\t\tПечатнаяФорма.СинонимМакета    = ФИО;   // Тут видимо не ФИО а что то общее надо, но и так работает\n\t\tПечатнаяФорма.ОфисныеДокументы = ОфисныеДокументы;\n\t\t\n\t\tУправлениеПечатью.ОчиститьСсылки(ПечатнаяФормаДокумента, Ложь);\n\t\tУправлениеПечатью.ОчиститьСсылки(Макет);\n\t\tУстановитьПривилегированныйРежим(ЛОЖЬ);   \n\t\t\n\tКонецЕсли;\nКонецПроцедуры"
  },
  {
    "title": "crs-api",
    "description": "CRS API - библиотека взаимодействия c сервером хранилищ 1С по HTTP",
    "code_snippet": ""
  },
  {
    "title": "git2sonar",
    "description": "Git2Sonar - Выгрузка истории проекта GIT в SonarQube",
    "code_snippet": ""
  },
  {
    "title": "pluck",
    "description": "Приложение pluck - получение имени метаданного 1С из файла 1С (внешний отчет, обработка).",
    "code_snippet": ""
  },
  {
    "title": "Немодально ввести значение определенного типа от пользователя",
    "description": "Немодально ввести значение определенного типа от пользователя",
    "code_snippet": "/// Как немодально ввести значение определенного\r\n/// типа от пользователя в 1с 8.3, 8.2 \r\n \r\n&НаКлиенте\r\nПроцедура КакИнтерактивноВвестиЗначениеОпределенногоТипа(Команда)\r\n \r\n    Оповещение = Новый ОписаниеОповещения(\"ПослеВводаЗначения\", \r\n      ЭтотОбъект);\t\r\n \r\n    ПоказатьВводЗначения(\r\n        Оповещение,\r\n        , // пропускаем начальное значение\r\n        \"Введите значение\",\r\n        \"Число\"\r\n    );\r\n \r\nКонецПроцедуры\r\n \r\n&НаКлиенте\r\nПроцедура ПослеВводаЗначения(Результат, Параметры) Экспорт\t\r\n \r\n    Если Не Результат = Неопределено Тогда\r\n        Сообщить(Результат);\t\t\r\n    КонецЕсли;\r\n \r\nКонецПроцедуры\n\n/// Как немодально ввести значение определенного\r\n/// типа от пользователя в 1с 8.3, 8.2 \r\n \r\n&НаКлиенте\r\nПроцедура КакИнтерактивноВвестиЗначениеОпределенногоТипа(Команда)\r\n \r\n    Оповещение = Новый ОписаниеОповещения(\"ПослеВводаЗначения\", \r\n      ЭтотОбъект);\t\r\n \r\n    ПоказатьВводЗначения(\r\n        Оповещение,\r\n        , // пропускаем начальное значение\r\n        \"Введите значение\",\r\n        \"Число\"\r\n    );\r\n \r\nКонецПроцедуры\r\n \r\n&НаКлиенте\r\nПроцедура ПослеВводаЗначения(Результат, Параметры) Экспорт\t\r\n \r\n    Если Не Результат = Неопределено Тогда\r\n        Сообщить(Результат);\t\t\r\n    КонецЕсли;\r\n \r\nКонецПроцедуры\n\nОрфографическая ошибка в Немодально: Немодально\r\nОрфографическая ошибка в немодально: немодально\r\nОрфографическая ошибка в Неопределено: Неопределено"
  },
  {
    "title": "HTML представление виджета",
    "description": "HTML представление виджета",
    "code_snippet": "// Возвращает html представление виджета.\r\n//\r\n// Параметры:\r\n//   Заголовок - Строка - html текст заголовка виджета.\r\n//   Подвал - Строка - html текст подвала виджета.\r\n//   ТелоВиджета - Строка - html текст тела виджета.\r\n//   ФонаВиджета - Строка - цвет фона виджета в виде шестнадцатеричного значения.\r\n//   ЦветРамкиТаблицы - Строка - цвет рамок таблиц в виджете, в виде шестнадцатеричного значения.\r\n//\r\n// Возвращаемое значение:\r\n//   Строка - html представление виджета.\r\n//\r\nФункция HTMLПредставлениеВиджета(\r\n\t\tЗаголовок = \"\", Подвал = \"\", ТелоВиджета, ФонаВиджета, ЦветРамкиТаблицы)\r\n\t\r\n\tHTMLТекст = \"<html><head><meta name=\"\"viewport\"\" content=\"\"viewport-fit=cover, width=device-width\"\" />\"\r\n\t\t+ СтильHTML(ЦветРамкиТаблицы)\r\n\t\t+ \"<body bgcolor=\" + ФонаВиджета + \">\";\r\n\t\t\r\n\tHTMLТекст = HTMLТекст + СтрЗаменить(\"\r\n\t|<table class=\"\"one\"\">\r\n\t|<tr><td>\r\n\t|<table class=\"\"title\"\">\r\n\t|<tr>\r\n\t|<td class=\"\"menu\"\">\r\n\t|</td>\r\n\t|<td class=\"\"title\"\">\r\n\t|<p>\t\r\n\t|\" + Заголовок + \"\r\n\t|</td>\r\n\t|</tr>\r\n\t|</table>\t\r\n\t|</td></tr>\t\r\n\t|<tr class=\"\"height100\"\"><td>\r\n\t|\" + ТелоВиджета + \"\r\n\t|</td></tr>\t\r\n\t|<tr><td>\t\r\n\t|<table>\r\n\t|<tr>\t\r\n\t|<td width=\"\"5\"\">\r\n\t|</td>\t\r\n\t|<td height=\"\"18\"\">\r\n\t|\" + Подвал + \"\r\n\t|</td>\t\r\n\t|</tr>\r\n\t|</table>\t\r\n\t|</td></tr>\t\r\n\t|</table>\t\r\n\t|</body></html>\", \"|\",\"\");\r\n\t\t\r\n\t\t\r\n\t\r\n\tУдалитьВредоносныйКодИзТекста(HTMLТекст); \r\n\t\r\n\tВозврат HTMLТекст;\r\n\t\r\nКонецФункции\r\n\r\n// Удаляет вредоносный код html из текста.\r\n//\r\n// Параметры:\r\n//   Текст - Строка - текст\r\n//\r\nПроцедура УдалитьВредоносныйКодИзТекста(Текст) Экспорт\r\n\t\r\n\tНРегТекст = НРег(Текст);\r\n\t\r\n\tМассивСтрокБезВредоносногоТекста = Новый Массив;\r\n\t\r\n\t// Удаление скриптов\r\n\tНомерСкрипта = 1;\r\n\tПозицияНачалаОбработки = 1;\r\n\t\r\n\tПока Истина Цикл\r\n\t\t\r\n\t\tПозицияНачалаОткрывающегоТегаScript = СтрНайти(НРегТекст, \"<script\",,, НомерСкрипта);\r\n\t\tПозицияНачалаЗакрывающегоТегаScript = СтрНайти(НРегТекст, \"</script\",,, НомерСкрипта);\r\n\t\t\r\n\t\tЕсли ПозицияНачалаОткрывающегоТегаScript = 0 Или ПозицияНачалаЗакрывающегоТегаScript = 0 Тогда\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tПозицияОкончанияОткрывающегоТегаScript = СтрНайти(НРегТекст, \">\",, ПозицияНачалаОткрывающегоТегаScript + 1);\r\n\t\tПозицияОкончанияЗакрывающегоТегаScript = СтрНайти(НРегТекст, \">\",, ПозицияНачалаЗакрывающегоТегаScript + 1);\r\n\t\t\r\n\t\tЕсли ПозицияОкончанияОткрывающегоТегаScript = 0 Или ПозицияОкончанияЗакрывающегоТегаScript = 0 Тогда\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t// Добавим текст до скрипта\r\n\t\tТекстДоСкрипта = Сред(Текст, ПозицияНачалаОбработки, ПозицияНачалаОткрывающегоТегаScript - ПозицияНачалаОбработки);\r\n\t\tМассивСтрокБезВредоносногоТекста.Добавить(ТекстДоСкрипта);\r\n\t\t\r\n\t\tПозицияНачалаОбработки = ПозицияОкончанияЗакрывающегоТегаScript + 1;\r\n\t\tНомерСкрипта = НомерСкрипта + 1;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли МассивСтрокБезВредоносногоТекста.Количество() > 0 Тогда\r\n\t\t\r\n\t\t// Добавим текст после последнего скрипта\r\n\t\tТекстДоСкрипта = Сред(Текст, ПозицияНачалаОбработки);\r\n\t\tМассивСтрокБезВредоносногоТекста.Добавить(ТекстДоСкрипта);\r\n\t\t\r\n\t\t// Сформируем итоговую строку без скрипта\r\n\t\tТекст = СтрСоединить(МассивСтрокБезВредоносногоТекста);\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\n// Возвращает html представление виджета.\r\n//\r\n// Параметры:\r\n//   Заголовок - Строка - html текст заголовка виджета.\r\n//   Подвал - Строка - html текст подвала виджета.\r\n//   ТелоВиджета - Строка - html текст тела виджета.\r\n//   ФонаВиджета - Строка - цвет фона виджета в виде шестнадцатеричного значения.\r\n//   ЦветРамкиТаблицы - Строка - цвет рамок таблиц в виджете, в виде шестнадцатеричного значения.\r\n//\r\n// Возвращаемое значение:\r\n//   Строка - html представление виджета.\r\n//\r\nФункция HTMLПредставлениеВиджета(\r\n\t\tЗаголовок = \"\", Подвал = \"\", ТелоВиджета, ФонаВиджета, ЦветРамкиТаблицы)\r\n\t\r\n\tHTMLТекст = \"<html><head><meta name=\"\"viewport\"\" content=\"\"viewport-fit=cover, width=device-width\"\" />\"\r\n\t\t+ СтильHTML(ЦветРамкиТаблицы)\r\n\t\t+ \"<body bgcolor=\" + ФонаВиджета + \">\";\r\n\t\t\r\n\tHTMLТекст = HTMLТекст + СтрЗаменить(\"\r\n\t|<table class=\"\"one\"\">\r\n\t|<tr><td>\r\n\t|<table class=\"\"title\"\">\r\n\t|<tr>\r\n\t|<td class=\"\"menu\"\">\r\n\t|</td>\r\n\t|<td class=\"\"title\"\">\r\n\t|<p>\t\r\n\t|\" + Заголовок + \"\r\n\t|</td>\r\n\t|</tr>\r\n\t|</table>\t\r\n\t|</td></tr>\t\r\n\t|<tr class=\"\"height100\"\"><td>\r\n\t|\" + ТелоВиджета + \"\r\n\t|</td></tr>\t\r\n\t|<tr><td>\t\r\n\t|<table>\r\n\t|<tr>\t\r\n\t|<td width=\"\"5\"\">\r\n\t|</td>\t\r\n\t|<td height=\"\"18\"\">\r\n\t|\" + Подвал + \"\r\n\t|</td>\t\r\n\t|</tr>\r\n\t|</table>\t\r\n\t|</td></tr>\t\r\n\t|</table>\t\r\n\t|</body></html>\", \"|\",\"\");\r\n\t\t\r\n\t\t\r\n\t\r\n\tУдалитьВредоносныйКодИзТекста(HTMLТекст); \r\n\t\r\n\tВозврат HTMLТекст;\r\n\t\r\nКонецФункции\r\n\r\n// Удаляет вредоносный код html из текста.\r\n//\r\n// Параметры:\r\n//   Текст - Строка - текст\r\n//\r\nПроцедура УдалитьВредоносныйКодИзТекста(Текст) Экспорт\r\n\t\r\n\tНРегТекст = НРег(Текст);\r\n\t\r\n\tМассивСтрокБезВредоносногоТекста = Новый Массив;\r\n\t\r\n\t// Удаление скриптов\r\n\tНомерСкрипта = 1;\r\n\tПозицияНачалаОбработки = 1;\r\n\t\r\n\tПока Истина Цикл\r\n\t\t\r\n\t\tПозицияНачалаОткрывающегоТегаScript = СтрНайти(НРегТекст, \"<script\",,, НомерСкрипта);\r\n\t\tПозицияНачалаЗакрывающегоТегаScript = СтрНайти(НРегТекст, \"</script\",,, НомерСкрипта);\r\n\t\t\r\n\t\tЕсли ПозицияНачалаОткрывающегоТегаScript = 0 Или ПозицияНачалаЗакрывающегоТегаScript = 0 Тогда\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tПозицияОкончанияОткрывающегоТегаScript = СтрНайти(НРегТекст, \">\",, ПозицияНачалаОткрывающегоТегаScript + 1);\r\n\t\tПозицияОкончанияЗакрывающегоТегаScript = СтрНайти(НРегТекст, \">\",, ПозицияНачалаЗакрывающегоТегаScript + 1);\r\n\t\t\r\n\t\tЕсли ПозицияОкончанияОткрывающегоТегаScript = 0 Или ПозицияОкончанияЗакрывающегоТегаScript = 0 Тогда\r\n\t\t\tПрервать;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t// Добавим текст до скрипта\r\n\t\tТекстДоСкрипта = Сред(Текст, ПозицияНачалаОбработки, ПозицияНачалаОткрывающегоТегаScript - ПозицияНачалаОбработки);\r\n\t\tМассивСтрокБезВредоносногоТекста.Добавить(ТекстДоСкрипта);\r\n\t\t\r\n\t\tПозицияНачалаОбработки = ПозицияОкончанияЗакрывающегоТегаScript + 1;\r\n\t\tНомерСкрипта = НомерСкрипта + 1;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tЕсли МассивСтрокБезВредоносногоТекста.Количество() > 0 Тогда\r\n\t\t\r\n\t\t// Добавим текст после последнего скрипта\r\n\t\tТекстДоСкрипта = Сред(Текст, ПозицияНачалаОбработки);\r\n\t\tМассивСтрокБезВредоносногоТекста.Добавить(ТекстДоСкрипта);\r\n\t\t\r\n\t\t// Сформируем итоговую строку без скрипта\r\n\t\tТекст = СтрСоединить(МассивСтрокБезВредоносногоТекста);\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\nОрфографическая ошибка в виджета (найдено 8): виджета\r\nОрфографическая ошибка в ТелоВиджета (найдено 3): Виджета\r\nОрфографическая ошибка в ФонаВиджета (найдено 3): Виджета\r\nОрфографическая ошибка в виджете: виджете\r\nОрфографическая ошибка в HTMLПредставлениеВиджета: Виджета\r\nОрфографическая ошибка в viewport (найдено 2): viewport\r\nОрфографическая ошибка в bgcolor: bgcolor"
  },
  {
    "title": "Условное оформление на обычных формах (ОФ)",
    "description": "Условное оформление на обычных формах (ОФ)",
    "code_snippet": "Процедура СписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)\r\n    ОформлениеСтроки.Ячейки.Отгружен.ЦветФона = ?(ДанныеСтроки.Отгружен, WebЦвета.СветлоРозовый, WebЦвета.БледноБирюзовый);\r\nКонецПроцедуры\n\nПроцедура СписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)\r\n    ОформлениеСтроки.Ячейки.Отгружен.ЦветФона = ?(ДанныеСтроки.Отгружен, WebЦвета.СветлоРозовый, WebЦвета.БледноБирюзовый);\r\nКонецПроцедуры"
  },
  {
    "title": "Форматирование после вставки",
    "description": "Скрипт для TurboConf, который после вставки из буфера форматирует вставляемый фрагмент кода (например, выравниваются отступы относительно окружающего кода).\n//@script_name FormatAfterPaste\n//@script_display_name Форматировать фрагмент после вставки\n//@scri...",
    "code_snippet": ""
  },
  {
    "title": "СтрШаблон (8.1, 8.2, 8.3 в режиме совместимости 8.2)",
    "description": "СтрШаблон (8.1, 8.2, 8.3 в режиме совместимости 8.2)",
    "code_snippet": "Функция _СтрШаблон_(Шаблон, Парам1 = \"\", Парам2 = \"\", Парам3 = \"\", Парам4 = \"\", Парам5 = \"\",\r\n\t\t\t\t\tПарам6 = \"\", Парам7 = \"\", Парам8 = \"\", Парам9 = \"\") экспорт\t\t\t\t\t\r\n\t\t\t\t\t\r\n\tДля Сч=1 По 9 Цикл\r\n\t\t\r\n\t\tВыполнить(\"Шаблон = СтрЗаменить(Шаблон, \"\"%\"\"+Сч, Парам\"+Сч+\")\");\r\n\t\t\r\n\tКонецЦикла; \t\t\t\t\t\t\r\n\t\r\n\tВозврат Шаблон;\r\n\t\t\r\nКонецФункции\n\nФункция _СтрШаблон_(Шаблон, Парам1 = \"\", Парам2 = \"\", Парам3 = \"\", Парам4 = \"\", Парам5 = \"\",\r\n\t\t\t\t\tПарам6 = \"\", Парам7 = \"\", Парам8 = \"\", Парам9 = \"\") экспорт\t\t\t\t\t\r\n\t\t\t\t\t\r\n\tДля Сч=1 По 9 Цикл\r\n\t\t\r\n\t\tВыполнить(\"Шаблон = СтрЗаменить(Шаблон, \"\"%\"\"+Сч, Парам\"+Сч+\")\");\r\n\t\t\r\n\tКонецЦикла; \t\t\t\t\t\t\r\n\t\r\n\tВозврат Шаблон;\r\n\t\t\r\nКонецФункции"
  },
  {
    "title": "Переменные среды (windows)",
    "description": "Переменные среды (windows)",
    "code_snippet": "// Функция - Переменные среды\r\n//\r\n// Параметры:\r\n//  Тип\t - Строка - \"System\" - переменные среды операционной системы.\r\n//\t\t\t\t\t\"User\" - переменные среды пользователя.\r\n//\t\t\t\t\t\"Volatile\" - временные переменные.\r\n//\t\t\t\t\t\"Process\" - переменные среды текущего командного окна.\r\n// \r\n// Возвращаемое значение:\r\n//   - Соответствие, содержащая переменные среды\r\n//\r\nФункция ПеременныеСреды(Тип = \"System\") Экспорт\r\n\t\r\n\tПерем Оболочка;\r\n\t\r\n\tсПеременныеСреды = Новый Соответствие;\r\n\t\r\n\tЕсли ЭтоКлиентWindows() Тогда\r\n\t\t\r\n\t\tПопытка\r\n\t\t\tОболочка = Новый COMОбъект(\"WScript.Shell\");\r\n\t\t\tКоллекцияПеременных = Оболочка.Environment(Тип);\r\n\t\tИсключение\r\n\t\t\tСообщить(\"Не удалось подключить компоненту 'WScript.Shell' по причине: \"+ОписаниеОшибки(), СтатусСообщения.ОченьВажное);\r\n\t\t\tВозврат сПеременныеСреды;\r\n\t\tКонецПопытки;\r\n\t\t\r\n\t\tДля каждого ЭлКоллекции Из КоллекцияПеременных Цикл\r\n\t\t\t\r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(ЭлКоллекции) Тогда\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли; \r\n\t\t\t\r\n\t\t\tМассивЧастей = РазложитьСтрокуВМассив(ЭлКоллекции, \"=\");\r\n\t\t\t\r\n\t\t\tЕсли МассивЧастей.Количество() = 2 Тогда\r\n\t\t\t\tсПеременныеСреды.Вставить(МассивЧастей.Получить(0), МассивЧастей.Получить(1));\r\n\t\t\tКонецЕсли; \r\n\t\t\t\r\n\t\tКонецЦикла; \r\n\t\t\r\n\t\tОболочка = Неопределено;\r\n\r\n\tКонецЕсли; \r\n\t\t\r\n\tВозврат сПеременныеСреды;\r\n\t\r\nКонецФункции\n\n// Функция - Переменные среды\r\n//\r\n// Параметры:\r\n//  Тип\t - Строка - \"System\" - переменные среды операционной системы.\r\n//\t\t\t\t\t\"User\" - переменные среды пользователя.\r\n//\t\t\t\t\t\"Volatile\" - временные переменные.\r\n//\t\t\t\t\t\"Process\" - переменные среды текущего командного окна.\r\n// \r\n// Возвращаемое значение:\r\n//   - Соответствие, содержащая переменные среды\r\n//\r\nФункция ПеременныеСреды(Тип = \"System\") Экспорт\r\n\t\r\n\tПерем Оболочка;\r\n\t\r\n\tсПеременныеСреды = Новый Соответствие;\r\n\t\r\n\tЕсли ЭтоКлиентWindows() Тогда\r\n\t\t\r\n\t\tПопытка\r\n\t\t\tОболочка = Новый COMОбъект(\"WScript.Shell\");\r\n\t\t\tКоллекцияПеременных = Оболочка.Environment(Тип);\r\n\t\tИсключение\r\n\t\t\tСообщить(\"Не удалось подключить компоненту 'WScript.Shell' по причине: \"+ОписаниеОшибки(), СтатусСообщения.ОченьВажное);\r\n\t\t\tВозврат сПеременныеСреды;\r\n\t\tКонецПопытки;\r\n\t\t\r\n\t\tДля каждого ЭлКоллекции Из КоллекцияПеременных Цикл\r\n\t\t\t\r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(ЭлКоллекции) Тогда\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли; \r\n\t\t\t\r\n\t\t\tМассивЧастей = РазложитьСтрокуВМассив(ЭлКоллекции, \"=\");\r\n\t\t\t\r\n\t\t\tЕсли МассивЧастей.Количество() = 2 Тогда\r\n\t\t\t\tсПеременныеСреды.Вставить(МассивЧастей.Получить(0), МассивЧастей.Получить(1));\r\n\t\t\tКонецЕсли; \r\n\t\t\t\r\n\t\tКонецЦикла; \r\n\t\t\r\n\t\tОболочка = Неопределено;\r\n\r\n\tКонецЕсли; \r\n\t\t\r\n\tВозврат сПеременныеСреды;\r\n\t\r\nКонецФункции\n\n{42} Переменной Оболочка присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в Неопределено: Неопределено"
  },
  {
    "title": "Чтение значения атрибута узла XML или объекта XDTO",
    "description": "Чтение значения атрибута узла XML или объекта XDTO",
    "code_snippet": "Функция ЗначениеСвойстваXDTO(ОбъектXDTO, Имя)\r\n\r\n\tВариантИмени = СтрЗаменить(Имя, \"-\", \"_\");\r\n\t\r\n\tЗначение = Неопределено;\r\n\t\r\n\tИмяПоиска = Неопределено;\r\n\t\r\n\tЕсли ТипЗнч(ОбъектXDTO) = Тип(\"ОбъектXDTO\") Тогда\r\n\t\t\r\n\t\tСвойства = ОбъектXDTO.Свойства();\r\n\t\t\r\n\t\tДля Каждого Свойство Из Свойства Цикл\r\n\t\t\t\r\n\t\t\tЕсли Врег(Свойство.Имя) = Врег(Имя) Тогда \r\n\t\t\t\t\r\n\t\t\t\tИмяПоиска = Имя;\r\n\t\t\t\t\r\n\t\t\t\tПрервать;\r\n\t\t\t\t\r\n\t\t\tИначеЕсли Врег(Свойство.Имя) = Врег(ВариантИмени) Тогда\r\n\t\t\t\t\r\n\t\t\t\tИмяПоиска = ВариантИмени;\r\n\t\t\t\t\r\n\t\t\t\tПрервать;\r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tЕсли ИмяПоиска <> Неопределено Тогда \r\n\t\t\t\r\n\t\t\tЕсли ТипЗнч(ОбъектXDTO[ИмяПоиска]) = Тип(\"СписокXDTO\") Тогда\r\n\t\t\t\t\r\n\t\t\t\tЗначение = ОбъектXDTO.ПолучитьСписок(ИмяПоиска);\r\n\t\t\t\t\r\n\t\t\tИначе\r\n\t\t\t\t\r\n\t\t\t\tЗначение = ОбъектXDTO.ПолучитьXDTO(ИмяПоиска);\r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\r\n\t\t\tЕсли ТипЗнч(Значение) = Тип(\"ЗначениеXDTO\") Тогда\r\n\t\t\t\t\r\n\t\t\t\tЗначение = Значение.Значение;\r\n\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tИначеЕсли ТипЗнч(ОбъектXDTO) = Тип(\"ЗначениеXDTO\") Тогда\r\n\t\t\r\n\t\tЗначение = ОбъектXDTO.Значение;\r\n\t\t\r\n\tКонецЕсли;\r\n\r\n\t\r\n\tВозврат Значение;\r\n\r\nКонецФункции\r\n\r\n// ИСПОЛЬЗОВАНИЕ\r\n//\r\n// На входе имеем XML. И нам нужно получить значение атрибута \"message\"\r\n\r\nСтрокаXML = \"\r\n| <response>\r\n| <payment message='Техническая ошибка'>\r\n|  <from>\r\n|    <amount>0.00</amount>\r\n|  </from>\r\n| </payment>\r\n| </response>\";\r\n\r\n// Полный процесс получения будет выглядеть так\r\n\r\nЧтениеXML = Новый ЧтениеXML(); \r\nЧтениеXML.УстановитьСтроку(СтрокаXML); \r\n\r\nДанные = ФабрикаXDTO.ПрочитатьXML(ЧтениеXML);\r\n\r\nЧтениеXML.Закрыть();\r\n\r\nПлатеж = ЗначениеСвойстваXDTO(Данные, \"payment\");\r\n\r\nЕсли Платеж <> Неопределено Тогда\r\n\t\r\n\tОшибка = ЗначениеСвойстваXDTO(Платеж, \"message\");  // Ошибка = \"Техническая ошибка\"\r\n\r\n\tСообщить(Ошибка);\r\n\r\nКонецЕсли;\n\nФункция ЗначениеСвойстваXDTO(ОбъектXDTO, Имя)\r\n\r\n\tВариантИмени = СтрЗаменить(Имя, \"-\", \"_\");\r\n\t\r\n\tЗначение = Неопределено;\r\n\t\r\n\tИмяПоиска = Неопределено;\r\n\t\r\n\tЕсли ТипЗнч(ОбъектXDTO) = Тип(\"ОбъектXDTO\") Тогда\r\n\t\t\r\n\t\tСвойства = ОбъектXDTO.Свойства();\r\n\t\t\r\n\t\tДля Каждого Свойство Из Свойства Цикл\r\n\t\t\t\r\n\t\t\tЕсли Врег(Свойство.Имя) = Врег(Имя) Тогда \r\n\t\t\t\t\r\n\t\t\t\tИмяПоиска = Имя;\r\n\t\t\t\t\r\n\t\t\t\tПрервать;\r\n\t\t\t\t\r\n\t\t\tИначеЕсли Врег(Свойство.Имя) = Врег(ВариантИмени) Тогда\r\n\t\t\t\t\r\n\t\t\t\tИмяПоиска = ВариантИмени;\r\n\t\t\t\t\r\n\t\t\t\tПрервать;\r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tЕсли ИмяПоиска <> Неопределено Тогда \r\n\t\t\t\r\n\t\t\tЕсли ТипЗнч(ОбъектXDTO[ИмяПоиска]) = Тип(\"СписокXDTO\") Тогда\r\n\t\t\t\t\r\n\t\t\t\tЗначение = ОбъектXDTO.ПолучитьСписок(ИмяПоиска);\r\n\t\t\t\t\r\n\t\t\tИначе\r\n\t\t\t\t\r\n\t\t\t\tЗначение = ОбъектXDTO.ПолучитьXDTO(ИмяПоиска);\r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\r\n\t\t\tЕсли ТипЗнч(Значение) = Тип(\"ЗначениеXDTO\") Тогда\r\n\t\t\t\t\r\n\t\t\t\tЗначение = Значение.Значение;\r\n\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tИначеЕсли ТипЗнч(ОбъектXDTO) = Тип(\"ЗначениеXDTO\") Тогда\r\n\t\t\r\n\t\tЗначение = ОбъектXDTO.Значение;\r\n\t\t\r\n\tКонецЕсли;\r\n\r\n\t\r\n\tВозврат Значение;\r\n\r\nКонецФункции\r\n\r\n// ИСПОЛЬЗОВАНИЕ\r\n//\r\n// На входе имеем XML. И нам нужно получить значение атрибута \"message\"\r\n\r\nСтрокаXML = \"\r\n| <response>\r\n| <payment message='Техническая ошибка'>\r\n|  <from>\r\n|    <amount>0.00</amount>\r\n|  </from>\r\n| </payment>\r\n| </response>\";\r\n\r\n// Полный процесс получения будет выглядеть так\r\n\r\nЧтениеXML = Новый ЧтениеXML(); \r\nЧтениеXML.УстановитьСтроку(СтрокаXML); \r\n\r\nДанные = ФабрикаXDTO.ПрочитатьXML(ЧтениеXML);\r\n\r\nЧтениеXML.Закрыть();\r\n\r\nПлатеж = ЗначениеСвойстваXDTO(Данные, \"payment\");\r\n\r\nЕсли Платеж <> Неопределено Тогда\r\n\t\r\n\tОшибка = ЗначениеСвойстваXDTO(Платеж, \"message\");  // Ошибка = \"Техническая ошибка\"\r\n\r\n\tСообщить(Ошибка);\r\n\r\nКонецЕсли;\n\nЕсли ВРег(Свойство.Имя) = Врег(Имя) Тогда \n\t\t\t\t\n\t\t\t\tИмяПоиска = Имя;\n\t\t\t\t\n\t\t\t\tПрервать;\n\t\t\t\t\n\t\t\tИначеЕсли Врег(Свойство.Имя) = Врег(ВариантИмени) Тогда\n\t\t\t\t\n\t\t\t\tИмяПоиска = ВариантИмени;\n\t\t\t\t\n\t\t\t\tПрервать;\n\t\t\t\t\n\t\t\tКонецЕсли;"
  },
  {
    "title": "Сообщение с открытием только что созданного документа",
    "description": "Сообщение с открытием только что созданного документа",
    "code_snippet": "Сообщение = Новый СообщениеПользователю();\r\n\tСообщение.Текст = \"Создан документ начисления паритетных взносов: \" + Док;\r\n\tСообщение.КлючДанных = Док.Ссылка;\r\n\tСообщение.ПутьКДанным = \"Объект\";\r\n\tСообщение.Сообщить();\n\nСообщение = Новый СообщениеПользователю();\r\n\tСообщение.Текст = \"Создан документ начисления паритетных взносов: \" + Док;\r\n\tСообщение.КлючДанных = Док.Ссылка;\r\n\tСообщение.ПутьКДанным = \"Объект\";\r\n\tСообщение.Сообщить();"
  },
  {
    "title": "Соединяем план и факт",
    "description": "Соединяем план и факт",
    "code_snippet": "ВЫБРАТЬ\n\tРасходПродуктовПоКДОбороты.Учреждение,\n\tРасходПродуктовПоКДОбороты.КатегорияДовольствующихся,\n\tРасходПродуктовПоКДОбороты.Номенклатура.ГруппаПродуктовПитания КАК ГруппаПродуктовПитания,\n\tРасходПродуктовПоКДОбороты.КоличествоОборот КАК КоличествоФакт,\n\tРасходПродуктовПоКДОбороты.СуммаОборот КАК СуммаФакт,\n\tАП_НормативыПитанияНатуральныеСрезПоследних.Количество КАК КоличествоПлан,\n\tАП_НормативыПитанияНатуральныеСрезПоследних.Сумма КАК СуммаПлан\nИЗ\n\tРегистрНакопления.РасходПродуктовПоКД.Обороты КАК РасходПродуктовПоКДОбороты\n\t\tПОЛНОЕ СОЕДИНЕНИЕ РегистрСведений.АП_НормативыПитанияНатуральные.СрезПоследних(&ДатаНорматива, ) КАК АП_НормативыПитанияНатуральныеСрезПоследних\n\t\tПО РасходПродуктовПоКДОбороты.Учреждение = АП_НормативыПитанияНатуральныеСрезПоследних.Учреждение\n\t\t\tИ РасходПродуктовПоКДОбороты.КатегорияДовольствующихся = АП_НормативыПитанияНатуральныеСрезПоследних.КатегорияДовольствующихся\n\t\t\tИ РасходПродуктовПоКДОбороты.Номенклатура.ГруппаПродуктовПитания = АП_НормативыПитанияНатуральныеСрезПоследних.ГруппаПродуктовПитания\n\nВЫБРАТЬ\n\tЕСТЬNULL(РасходПродуктовПоКДОбороты.Учреждение, АП_НормативыПитанияНатуральныеСрезПоследних.Учреждение) КАК Учреждение,\n\tЕСТЬNULL(РасходПродуктовПоКДОбороты.КатегорияДовольствующихся, АП_НормативыПитанияНатуральныеСрезПоследних.КатегорияДовольствующихся) КАК КатегорияДовольствующихся,\n\tЕСТЬNULL(РасходПродуктовПоКДОбороты.Номенклатура.ГруппаПродуктовПитания, АП_НормативыПитанияНатуральныеСрезПоследних.ГруппаПродуктовПитания) КАК ГруппаПродуктовПитания,\n\tРасходПродуктовПоКДОбороты.КоличествоОборот КАК КоличествоФакт,\n\tРасходПродуктовПоКДОбороты.СуммаОборот КАК СуммаФакт,\n\tАП_НормативыПитанияНатуральныеСрезПоследних.Количество КАК КоличествоНорма,\n\tАП_НормативыПитанияНатуральныеСрезПоследних.Сумма КАК СуммаНорма\nИЗ\n\tРегистрНакопления.РасходПродуктовПоКД.Обороты КАК РасходПродуктовПоКДОбороты\n\t\tПОЛНОЕ СОЕДИНЕНИЕ РегистрСведений.АП_НормативыПитанияНатуральные.СрезПоследних(&ДатаНорматива, ) КАК АП_НормативыПитанияНатуральныеСрезПоследних\n\t\tПО РасходПродуктовПоКДОбороты.Учреждение = АП_НормативыПитанияНатуральныеСрезПоследних.Учреждение\n\t\t\tИ РасходПродуктовПоКДОбороты.КатегорияДовольствующихся = АП_НормативыПитанияНатуральныеСрезПоследних.КатегорияДовольствующихся\n\t\t\tИ РасходПродуктовПоКДОбороты.Номенклатура.ГруппаПродуктовПитания = АП_НормативыПитанияНатуральныеСрезПоследних.ГруппаПродуктовПитания\n\nВЫБРАТЬ\n\tНормативыСрезПоследних.Учреждение КАК Учреждение,\n\tНормативыСрезПоследних.Категория КАК Категория,\n\tНормативыСрезПоследних.ГруппаПродуктов КАК ГруппаПродуктов,\n\tНормативыСрезПоследних.Количество КАК КоличествоПлан,\n\tНормативыСрезПоследних.Сумма КАК СуммаПлан,\n\tNULL КАК КоличествоФакт,\n\tNULL КАК СуммаФакт\nПОМЕСТИТЬ ВТ\nИЗ\n\tРегистрСведений.Нормативы.СрезПоследних КАК НормативыСрезПоследних\n\nОБЪЕДИНИТЬ ВСЕ\n\nВЫБРАТЬ\n\tРасходПродуктовОбороты.Учреждение,\n\tРасходПродуктовОбороты.Категория,\n\tРасходПродуктовОбороты.ГруппаПродуктов,\n\tNULL,\n\tNULL,\n\tРасходПродуктовОбороты.КоличествоОборот,\n\tРасходПродуктовОбороты.СуммаОборот\nИЗ\n\tРегистрНакопления.РасходПродуктов.Обороты КАК РасходПродуктовОбороты\n;\n\n////////////////////////////////////////////////////////////////////////////////\nВЫБРАТЬ\n\tВТ.Учреждение КАК Учреждение,\n\tВТ.Категория КАК Категория,\n\tВТ.ГруппаПродуктов КАК ГруппаПродуктов,\n\tСУММА(ВТ.КоличествоПлан) КАК КоличествоПлан,\n\tСУММА(ВТ.СуммаПлан) КАК СуммаПлан,\n\tСУММА(ВТ.КоличествоФакт) КАК КоличествоФакт,\n\tСУММА(ВТ.СуммаФакт) КАК СуммаФакт\nИЗ\n\tВТ КАК ВТ\n\nСГРУППИРОВАТЬ ПО\n\tВТ.Учреждение,\n\tВТ.Категория,\n\tВТ.ГруппаПродуктов"
  },
  {
    "title": "Обращение к имени субконто по COM",
    "description": "Обращение к имени субконто по COM",
    "code_snippet": "Субконто.PredefinedDataName\n\nСубконто.PredefinedDataName"
  },
  {
    "title": "Менеджер ссылки по менеджеру объектов",
    "description": "Менеджер ссылки по менеджеру объектов",
    "code_snippet": "Функция МенеджерСсылкиПоМенеджеруМД(МенеджерМД)\r\n    Результат = Неопределено;\r\n    \r\n    ПозицияТочки = Найти(МенеджерМД, \".\");\r\n    Результат    = Лев(МенеджерМД,   ПозицияТочки - 2) + \"Ссылка\" + Сред(МенеджерМД, ПозицияТочки);\r\n    \r\n    Возврат Результат;\r\nКонецФункции\r\n\r\n&НаСервере\r\nПроцедура МенеджерОбъектаСтрокойПриИзмененииНаСервере()\r\n    МенеджерСсылка = МенеджерСсылкиПоМенеджеруМД(Объект.МенеджерОбъектовСтрокой);\r\n    Элементы.Ссылка.ОграничениеТипа = Новый ОписаниеТипов(МенеджерСсылка);\r\nКонецПроцедуры\n\nФункция МенеджерСсылкиПоМенеджеруМД(МенеджерМД)\r\n    Результат = Неопределено;\r\n    \r\n    ПозицияТочки = Найти(МенеджерМД, \".\");\r\n    Результат    = Лев(МенеджерМД,   ПозицияТочки - 2) + \"Ссылка\" + Сред(МенеджерМД, ПозицияТочки);\r\n    \r\n    Возврат Результат;\r\nКонецФункции\r\n\r\n&НаСервере\r\nПроцедура МенеджерОбъектаСтрокойПриИзмененииНаСервере()\r\n    МенеджерСсылка = МенеджерСсылкиПоМенеджеруМД(Объект.МенеджерОбъектовСтрокой);\r\n    Элементы.Ссылка.ОграничениеТипа = Новый ОписаниеТипов(МенеджерСсылка);\r\nКонецПроцедуры\n\n{2} Переменной Результат присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Сопоставления объектов проводок в базе-приемнике БП3 по COM-соединению",
    "description": "Сопоставления объектов проводок в базе-приемнике БП3 по COM-соединению",
    "code_snippet": "Функция СчетБазы(База,КодСчета,Предопределенный = Истина)\r\n    Если Предопределенный Тогда\r\n        Результат = База.ПланыСчетов.Хозрасчетный[КодСчета];\r\n    Иначе\r\n        Результат = База.ПланыСчетов.Хозрасчетный.НайтиПоКоду(КодСчета);\r\n    КонецЕсли;\r\n    \r\n    Возврат Результат;\r\nКонецФункции\r\n\r\nФункция СубконтоБазы(База,ИмяСубконто,Предопределено = Истина,ИмяПВХСубконто = \"ВидыСубконтоХозрасчетные\")\r\n    Если Предопределено = Истина Тогда\r\n        Результат = База.ПланыВидовХарактеристик[ИмяПВХСубконто][ИмяСубконто];            \r\n    Иначе\r\n        Результат = База.ПланыВидовХарактеристик[ИмяПВХСубконто].НайтиПоНаименованию(ИмяСубконто);\r\n    КонецЕсли;\r\n    Возврат Результат;    \r\nКонецФункции\r\n\r\nПроцедура УстановитьСубконтоБазы(База,Счет, Субконто, ИмяСубконто, ЗначениеСубконто)\r\n    База.БухгалтерскийУчет.УстановитьСубконто(Счет, Субконто, ИмяСубконто, ЗначениеСубконто);\r\nКонецПроцедуры\n\nФункция СчетБазы(База,КодСчета,Предопределенный = Истина)\r\n    Если Предопределенный Тогда\r\n        Результат = База.ПланыСчетов.Хозрасчетный[КодСчета];\r\n    Иначе\r\n        Результат = База.ПланыСчетов.Хозрасчетный.НайтиПоКоду(КодСчета);\r\n    КонецЕсли;\r\n    \r\n    Возврат Результат;\r\nКонецФункции\r\n\r\nФункция СубконтоБазы(База,ИмяСубконто,Предопределено = Истина,ИмяПВХСубконто = \"ВидыСубконтоХозрасчетные\")\r\n    Если Предопределено = Истина Тогда\r\n        Результат = База.ПланыВидовХарактеристик[ИмяПВХСубконто][ИмяСубконто];            \r\n    Иначе\r\n        Результат = База.ПланыВидовХарактеристик[ИмяПВХСубконто].НайтиПоНаименованию(ИмяСубконто);\r\n    КонецЕсли;\r\n    Возврат Результат;    \r\nКонецФункции\r\n\r\nПроцедура УстановитьСубконтоБазы(База,Счет, Субконто, ИмяСубконто, ЗначениеСубконто)\r\n    База.БухгалтерскийУчет.УстановитьСубконто(Счет, Субконто, ИмяСубконто, ЗначениеСубконто);\r\nКонецПроцедуры"
  },
  {
    "title": "Проверка поля на существование",
    "description": "Проверка поля на существование",
    "code_snippet": "Если Документ.Метаданные().Реквизиты.Найти(\"ИмяРеквизита\") = Неопределено Тогда\r\n     Сообщить(\"Поле ИмяРеквизита отсутствует\");\r\nКонецЕсли;\n\nЕсли Документ.Метаданные().Реквизиты.Найти(\"ИмяРеквизита\") = Неопределено Тогда\r\n     Сообщить(\"Поле ИмяРеквизита отсутствует\");\r\nКонецЕсли;"
  },
  {
    "title": "Открытие настроек профилей безопасности в БСП",
    "description": "Открытие настроек профилей безопасности в БСП",
    "code_snippet": "РаботаВБезопасномРежимеКлиент.ОткрытьДиалогНастройкиИспользованияПрофилейБезопасности();\n\nРаботаВБезопасномРежимеКлиент.ОткрытьДиалогНастройкиИспользованияПрофилейБезопасности();"
  },
  {
    "title": "Открытие значения текущей строки колонки ТабличногоПоля на УФ",
    "description": "Открытие значения текущей строки колонки ТабличногоПоля на УФ",
    "code_snippet": "&НаКлиенте\r\nПроцедура СписокВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)\r\n    ИмяПоля = Сред(Поле.Имя,СтрДлина(Элемент.Имя) + 1);\r\n    ПоказатьЗначение(Новый ОписаниеОповещения, Элемент.ТекущиеДанные[ИмяПоля]);\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура СписокВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)\r\n    ИмяПоля = Сред(Поле.Имя,СтрДлина(Элемент.Имя) + 1);\r\n    ПоказатьЗначение(Новый ОписаниеОповещения, Элемент.ТекущиеДанные[ИмяПоля]);\r\nКонецПроцедуры"
  },
  {
    "title": "Сервер взаимодействия 1С на Python. Курс",
    "description": "Разработай сервер взаимодействия для 1C на Python за 5 часов!",
    "code_snippet": ""
  },
  {
    "title": "Создание схемы компоновки данных программно",
    "description": "Создание схемы компоновки данных программно",
    "code_snippet": "// Пример универсальной функции для создания схемы компоновки данных\r\n// Опубликовал Дмитрий Иванов (kambl) в раздел Программирование - Практика программирования\r\n// http://infostart.ru/public/575659/\r\n//\r\n// Если вам приходится часто создавать схему компоновки данных программно или вы начинающий специалист и пытаетесь разобраться, что же за зверь такой СКД, то эта статья может оказаться вам полезной. Функция создает схему компоновки с минимально необходимой структурой данных. С помощью передачи дополнительных параметров есть возможность добавления ресурсов и оформления.\r\n// Появилась необходимость часто прибегать к программному созданию схемы компоновки данных. Было принято решение написать универсальную функцию принимающую различные наборы данных и на выходе возвращающую готовую СКД. Функция на вход принимает Запрос, Текст запроса, таблицу значений и дерево значений.\r\n// Помимо набора данных функция принимает ряд необязательных параметров:\r\n//\r\n//  Структура ресурсов: содержит перечень полей ресурсов, где ключ - ИмяПоля, Значение(Строка) - Агрегатная функция (\"Сумма\", \"Среднее\", \"Количество\",  и т.д.);\r\n//  Флаг АвтоЗаполнениеДоступныхПолей;\r\n//  Строковое Имя макета оформления.\r\n//\r\n// НаборДанных (Типы: Строка, Запрос, ТаблицаЗначений, ДеревоЗначений)\r\n// Искомый набор данных\r\n//\r\n// СтруктураРесурсов (Тип: Структура) - Структура полей ресурсов, где ключ - ИмяПоля, Значение(Строка) - Агрегатная функция\r\n//\r\n// ВноситьПоляВыбора (Тип: Булево) - Флаг добавление полей набора\r\n//\r\n// ИмяСтандартногоМакетаОформления (Тип: Строка) - Имя макета оформления\r\n//\r\nФункция СоздатьСхемуКомпоновкиДанных(НаборДанных, СтруктураРесурсов = Неопределено, АвтоЗаполнениеДоступныхПолей = Истина, ИмяСтандартногоМакетаОформления = \"\")\r\n\tСКД = Новый СхемаКомпоновкиДанных;\r\n\r\n\t// Заполнение основных данных схемы\r\n\tИсточникДанных = СКД.ИсточникиДанных.Добавить();\r\n\tИсточникДанных.Имя                = \"ИсточникДанных\";\r\n\tИсточникДанных.ТипИсточникаДанных = \"Local\";\r\n\r\n\tЕсли      ТипЗнч(НаборДанных) = Тип(\"Строка\") или\r\n\t          ТипЗнч(НаборДанных) = Тип(\"Запрос\") Тогда\r\n\t\tТекущийНаборДанных = СКД.НаборыДанных.Добавить(Тип(\"НаборДанныхЗапросСхемыКомпоновкиДанных\"));\r\n\t\tТекущийНаборДанных.Имя                          = \"ОсновнойНабор\";\r\n\t\tТекущийНаборДанных.Запрос                       = ?(ТипЗнч(НаборДанных) = Тип(\"Строка\"), НаборДанных, НаборДанных.Текст);\r\n\t\tТекущийНаборДанных.ИсточникДанных               = \"ИсточникДанных\";\r\n\t\tТекущийНаборДанных.АвтоЗаполнениеДоступныхПолей = АвтоЗаполнениеДоступныхПолей;\r\n\r\n\t\tТипНабора = \"Запрос\";\r\n\tИначеЕсли ТипЗнч(НаборДанных) = Тип(\"ТаблицаЗначений\") или\r\n\t          ТипЗнч(НаборДанных) = Тип(\"ДеревоЗначений\") Тогда\r\n\t\tТекущийНаборДанных = СКД.НаборыДанных.Добавить(Тип(\"НаборДанныхОбъектСхемыКомпоновкиДанных\"));\r\n\t\tТекущийНаборДанных.Имя            = \"ОсновнойНабор\";\r\n\t\tТекущийНаборДанных.ИмяОбъекта     = \"ТаблицаИсточник\"; // связывание с внешними данными идёт именно по нему\r\n\t\tТекущийНаборДанных.ИсточникДанных = \"ИсточникДанных\";\r\n\r\n\t\tТипНабора = \"Объект\";\r\n\tИначе\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\r\n\tНастройкиПоУмолчанию = СКД.НастройкиПоУмолчанию;\r\n\r\n\t// Создание структуры.\r\n\t// Группировка, детальные записи и автовыбранное поле\r\n\tГруппировка = НастройкиПоУмолчанию.Структура.Добавить(Тип(\"ГруппировкаКомпоновкиДанных\"));\r\n\tГруппировка.Использование = Истина;\r\n\r\n\tАвтоПоле = Группировка.Выбор.Элементы.Добавить(Тип(\"АвтоВыбранноеПолеКомпоновкиДанных\"));\r\n\tАвтоПоле.Использование = Истина;\r\n\r\n\tКоллекцияКолонок = Новый ТаблицаЗначений;\r\n\tКоллекцияКолонок.Колонки.Добавить(\"Имя\");\r\n\tКоллекцияКолонок.Колонки.Добавить(\"ТипЗначения\");\r\n\tКоллекцияКолонок.Колонки.Добавить(\"Заголовок\");\r\n\r\n\tЕсли      ТипНабора = \"Запрос\" Тогда\r\n\t\tПостроительЗапроса = Новый ПостроительЗапроса;\r\n\t\tЕсли ТипЗнч(НаборДанных) = Тип(\"Строка\") Тогда\r\n\t\t\tПостроительЗапроса.Текст = СокрЛП(НаборДанных);\r\n\t\tИначе\r\n\t\t\tПостроительЗапроса.Текст = СокрЛП(НаборДанных.Текст);\r\n\t\tКонецЕсли;\r\n\t\tПостроительЗапроса.ЗаполнитьНастройки();\r\n\r\n\t\tДля Каждого ПолеОтбора Из ПостроительЗапроса.ВыбранныеПоля Цикл\r\n\t\t\tНоваяКолонка = КоллекцияКолонок.Добавить();\r\n\t\t\tНоваяКолонка.Имя         = ПолеОтбора.Имя;\r\n\t\t\tНоваяКолонка.ТипЗначения = ПостроительЗапроса.ДоступныеПоля[ПолеОтбора.ПутьКДанным].ТипЗначения;\r\n\t\t\tНоваяКолонка.Заголовок   = ПолеОтбора.Представление\r\n\t\tКонецЦикла;\r\n\tИначеЕсли ТипНабора = \"Объект\" Тогда\r\n\t\tДля Каждого Колонка Из НаборДанных.Колонки Цикл\r\n\t\t\tНоваяКолонка = КоллекцияКолонок.Добавить();\r\n\t\t\tНоваяКолонка.Имя = Колонка.Имя;\r\n\t\t\tНоваяКолонка.ТипЗначения = Колонка.ТипЗначения;\r\n\t\t\tНоваяКолонка.Заголовок = Колонка.Имя;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\r\n\t// Добавление ресурсов\r\n\tЕсли ТипЗнч(СтруктураРесурсов) = Тип(\"Структура\") Тогда\r\n\t\tДля Каждого ЭлСтруктуры Из СтруктураРесурсов Цикл\r\n\t\t\t// Проверка, а Существует ли поле ресурса среди полей набора\r\n\t\t\tЕсли КоллекцияКолонок.Найти(ЭлСтруктуры.Ключ) <> Неопределено Тогда\r\n\t\t\t\t// Проверка на правильность указания агрегатной функции\r\n\t\t\t\tЕсли      ЭлСтруктуры.Значение = \"Сумма\" ИЛИ\r\n\t\t\t\t          ЭлСтруктуры.Значение = \"Среднее\" ИЛИ\r\n\t\t\t\t          ЭлСтруктуры.Значение = \"Максимум\" ИЛИ\r\n\t\t\t\t          ЭлСтруктуры.Значение = \"Минимум\" ИЛИ\r\n\t\t\t\t          ЭлСтруктуры.Значение = \"Количество\" Тогда\r\n\t\t\t\t\tПолеРесурса             = СКД.ПоляИтога.Добавить();\r\n\t\t\t\t\tПолеРесурса.ПутьКДанным = ЭлСтруктуры.Ключ;\r\n\t\t\t\t\tПолеРесурса.Выражение   = ЭлСтруктуры.Значение + \"(\" + ЭлСтруктуры.Ключ + \")\";\r\n\t\t\t\tИначеЕсли ЭлСтруктуры.Значение = \"КоличествоРазличные\" Тогда\r\n\t\t\t\t\tПолеРесурса             = СКД.ПоляИтога.Добавить();\r\n\t\t\t\t\tПолеРесурса.ПутьКДанным = ЭлСтруктуры.Ключ;\r\n\t\t\t\t\tПолеРесурса.Выражение   = \"Количество(Различные \" + ЭлСтруктуры.Ключ + \")\";\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\r\n\t// Добавление полей в набор\r\n\tДля Каждого НоваяКолонка Из КоллекцияКолонок Цикл\r\n\t\tПолеНабора = ТекущийНаборДанных.Поля.Добавить(Тип(\"ПолеНабораДанныхСхемыКомпоновкиДанных\"));\r\n\t\tПолеНабора.Заголовок   = СокрЛП(НоваяКолонка.Заголовок);\r\n\t\tПолеНабора.Поле        = СокрЛП(НоваяКолонка.Имя);\r\n\t\tПолеНабора.ПутьКДанным = СокрЛП(НоваяКолонка.Имя);\r\n\r\n\t\t// Удалим Неопределено и NULL\r\n\t\tМассив = Новый Массив;\r\n\t\tДля Каждого ТекущийТип Из НоваяКолонка.ТипЗначения.Типы() Цикл\r\n\t\t\tЕсли ТекущийТип = Тип(\"Неопределено\") ИЛИ ТекущийТип = Тип(\"NULL\") ИЛИ\r\n\t\t\t     ТекущийТип = Неопределено ИЛИ ТекущийТип = Null Тогда\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tМассив.Добавить(ТекущийТип);\r\n\t\tКонецЦикла;\r\n\t\tПолеНабора.ТипЗначения = Новый ОписаниеТипов(Массив, НоваяКолонка.ТипЗначения.КвалификаторыЧисла,\r\n\t\t                                             НоваяКолонка.ТипЗначения.КвалификаторыСтроки,\r\n\t\t                                             НоваяКолонка.ТипЗначения.КвалификаторыДаты);\r\n\r\n\t\tВыбранноеПолеКомпоновкиДанных = НастройкиПоУмолчанию.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\tВыбранноеПолеКомпоновкиДанных.Поле          = Новый ПолеКомпоновкиДанных(ПолеНабора.ПутьКДанным);\r\n\t\tВыбранноеПолеКомпоновкиДанных.Использование = Истина;\r\n\tКонецЦикла;\r\n\r\n\t// Оформление\r\n\tЕсли не ПустаяСтрока(ИмяСтандартногоМакетаОформления) Тогда\r\n\t\tЗначениеПараметраВывода = НастройкиПоУмолчанию.ПараметрыВывода.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(\"МакетОформления\"));\r\n\t\tЗначениеПараметраВывода.Значение      = ИмяСтандартногоМакетаОформления;\r\n\t\tЗначениеПараметраВывода.Использование = Истина;\r\n\tКонецЕсли;\r\n\r\n\tВозврат СКД;\r\nКонецФункции  // СоздатьСхемуКомпоновкиДанных\n\n// Пример универсальной функции для создания схемы компоновки данных\r\n// Опубликовал Дмитрий Иванов (kambl) в раздел Программирование - Практика программирования\r\n// http://infostart.ru/public/575659/\r\n//\r\n// Если вам приходится часто создавать схему компоновки данных программно или вы начинающий специалист и пытаетесь разобраться, что же за зверь такой СКД, то эта статья может оказаться вам полезной. Функция создает схему компоновки с минимально необходимой структурой данных. С помощью передачи дополнительных параметров есть возможность добавления ресурсов и оформления.\r\n// Появилась необходимость часто прибегать к программному созданию схемы компоновки данных. Было принято решение написать универсальную функцию принимающую различные наборы данных и на выходе возвращающую готовую СКД. Функция на вход принимает Запрос, Текст запроса, таблицу значений и дерево значений.\r\n// Помимо набора данных функция принимает ряд необязательных параметров:\r\n//\r\n//  Структура ресурсов: содержит перечень полей ресурсов, где ключ - ИмяПоля, Значение(Строка) - Агрегатная функция (\"Сумма\", \"Среднее\", \"Количество\",  и т.д.);\r\n//  Флаг АвтоЗаполнениеДоступныхПолей;\r\n//  Строковое Имя макета оформления.\r\n//\r\n// НаборДанных (Типы: Строка, Запрос, ТаблицаЗначений, ДеревоЗначений)\r\n// Искомый набор данных\r\n//\r\n// СтруктураРесурсов (Тип: Структура) - Структура полей ресурсов, где ключ - ИмяПоля, Значение(Строка) - Агрегатная функция\r\n//\r\n// ВноситьПоляВыбора (Тип: Булево) - Флаг добавление полей набора\r\n//\r\n// ИмяСтандартногоМакетаОформления (Тип: Строка) - Имя макета оформления\r\n//\r\nФункция СоздатьСхемуКомпоновкиДанных(НаборДанных, СтруктураРесурсов = Неопределено, АвтоЗаполнениеДоступныхПолей = Истина, ИмяСтандартногоМакетаОформления = \"\")\r\n\tСКД = Новый СхемаКомпоновкиДанных;\r\n\r\n\t// Заполнение основных данных схемы\r\n\tИсточникДанных = СКД.ИсточникиДанных.Добавить();\r\n\tИсточникДанных.Имя                = \"ИсточникДанных\";\r\n\tИсточникДанных.ТипИсточникаДанных = \"Local\";\r\n\r\n\tЕсли      ТипЗнч(НаборДанных) = Тип(\"Строка\") или\r\n\t          ТипЗнч(НаборДанных) = Тип(\"Запрос\") Тогда\r\n\t\tТекущийНаборДанных = СКД.НаборыДанных.Добавить(Тип(\"НаборДанныхЗапросСхемыКомпоновкиДанных\"));\r\n\t\tТекущийНаборДанных.Имя                          = \"ОсновнойНабор\";\r\n\t\tТекущийНаборДанных.Запрос                       = ?(ТипЗнч(НаборДанных) = Тип(\"Строка\"), НаборДанных, НаборДанных.Текст);\r\n\t\tТекущийНаборДанных.ИсточникДанных               = \"ИсточникДанных\";\r\n\t\tТекущийНаборДанных.АвтоЗаполнениеДоступныхПолей = АвтоЗаполнениеДоступныхПолей;\r\n\r\n\t\tТипНабора = \"Запрос\";\r\n\tИначеЕсли ТипЗнч(НаборДанных) = Тип(\"ТаблицаЗначений\") или\r\n\t          ТипЗнч(НаборДанных) = Тип(\"ДеревоЗначений\") Тогда\r\n\t\tТекущийНаборДанных = СКД.НаборыДанных.Добавить(Тип(\"НаборДанныхОбъектСхемыКомпоновкиДанных\"));\r\n\t\tТекущийНаборДанных.Имя            = \"ОсновнойНабор\";\r\n\t\tТекущийНаборДанных.ИмяОбъекта     = \"ТаблицаИсточник\"; // связывание с внешними данными идёт именно по нему\r\n\t\tТекущийНаборДанных.ИсточникДанных = \"ИсточникДанных\";\r\n\r\n\t\tТипНабора = \"Объект\";\r\n\tИначе\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\r\n\tНастройкиПоУмолчанию = СКД.НастройкиПоУмолчанию;\r\n\r\n\t// Создание структуры.\r\n\t// Группировка, детальные записи и автовыбранное поле\r\n\tГруппировка = НастройкиПоУмолчанию.Структура.Добавить(Тип(\"ГруппировкаКомпоновкиДанных\"));\r\n\tГруппировка.Использование = Истина;\r\n\r\n\tАвтоПоле = Группировка.Выбор.Элементы.Добавить(Тип(\"АвтоВыбранноеПолеКомпоновкиДанных\"));\r\n\tАвтоПоле.Использование = Истина;\r\n\r\n\tКоллекцияКолонок = Новый ТаблицаЗначений;\r\n\tКоллекцияКолонок.Колонки.Добавить(\"Имя\");\r\n\tКоллекцияКолонок.Колонки.Добавить(\"ТипЗначения\");\r\n\tКоллекцияКолонок.Колонки.Добавить(\"Заголовок\");\r\n\r\n\tЕсли      ТипНабора = \"Запрос\" Тогда\r\n\t\tПостроительЗапроса = Новый ПостроительЗапроса;\r\n\t\tЕсли ТипЗнч(НаборДанных) = Тип(\"Строка\") Тогда\r\n\t\t\tПостроительЗапроса.Текст = СокрЛП(НаборДанных);\r\n\t\tИначе\r\n\t\t\tПостроительЗапроса.Текст = СокрЛП(НаборДанных.Текст);\r\n\t\tКонецЕсли;\r\n\t\tПостроительЗапроса.ЗаполнитьНастройки();\r\n\r\n\t\tДля Каждого ПолеОтбора Из ПостроительЗапроса.ВыбранныеПоля Цикл\r\n\t\t\tНоваяКолонка = КоллекцияКолонок.Добавить();\r\n\t\t\tНоваяКолонка.Имя         = ПолеОтбора.Имя;\r\n\t\t\tНоваяКолонка.ТипЗначения = ПостроительЗапроса.ДоступныеПоля[ПолеОтбора.ПутьКДанным].ТипЗначения;\r\n\t\t\tНоваяКолонка.Заголовок   = ПолеОтбора.Представление\r\n\t\tКонецЦикла;\r\n\tИначеЕсли ТипНабора = \"Объект\" Тогда\r\n\t\tДля Каждого Колонка Из НаборДанных.Колонки Цикл\r\n\t\t\tНоваяКолонка = КоллекцияКолонок.Добавить();\r\n\t\t\tНоваяКолонка.Имя = Колонка.Имя;\r\n\t\t\tНоваяКолонка.ТипЗначения = Колонка.ТипЗначения;\r\n\t\t\tНоваяКолонка.Заголовок = Колонка.Имя;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\r\n\t// Добавление ресурсов\r\n\tЕсли ТипЗнч(СтруктураРесурсов) = Тип(\"Структура\") Тогда\r\n\t\tДля Каждого ЭлСтруктуры Из СтруктураРесурсов Цикл\r\n\t\t\t// Проверка, а Существует ли поле ресурса среди полей набора\r\n\t\t\tЕсли КоллекцияКолонок.Найти(ЭлСтруктуры.Ключ) <> Неопределено Тогда\r\n\t\t\t\t// Проверка на правильность указания агрегатной функции\r\n\t\t\t\tЕсли      ЭлСтруктуры.Значение = \"Сумма\" ИЛИ\r\n\t\t\t\t          ЭлСтруктуры.Значение = \"Среднее\" ИЛИ\r\n\t\t\t\t          ЭлСтруктуры.Значение = \"Максимум\" ИЛИ\r\n\t\t\t\t          ЭлСтруктуры.Значение = \"Минимум\" ИЛИ\r\n\t\t\t\t          ЭлСтруктуры.Значение = \"Количество\" Тогда\r\n\t\t\t\t\tПолеРесурса             = СКД.ПоляИтога.Добавить();\r\n\t\t\t\t\tПолеРесурса.ПутьКДанным = ЭлСтруктуры.Ключ;\r\n\t\t\t\t\tПолеРесурса.Выражение   = ЭлСтруктуры.Значение + \"(\" + ЭлСтруктуры.Ключ + \")\";\r\n\t\t\t\tИначеЕсли ЭлСтруктуры.Значение = \"КоличествоРазличные\" Тогда\r\n\t\t\t\t\tПолеРесурса             = СКД.ПоляИтога.Добавить();\r\n\t\t\t\t\tПолеРесурса.ПутьКДанным = ЭлСтруктуры.Ключ;\r\n\t\t\t\t\tПолеРесурса.Выражение   = \"Количество(Различные \" + ЭлСтруктуры.Ключ + \")\";\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\n\r\n\t// Добавление полей в набор\r\n\tДля Каждого НоваяКолонка Из КоллекцияКолонок Цикл\r\n\t\tПолеНабора = ТекущийНаборДанных.Поля.Добавить(Тип(\"ПолеНабораДанныхСхемыКомпоновкиДанных\"));\r\n\t\tПолеНабора.Заголовок   = СокрЛП(НоваяКолонка.Заголовок);\r\n\t\tПолеНабора.Поле        = СокрЛП(НоваяКолонка.Имя);\r\n\t\tПолеНабора.ПутьКДанным = СокрЛП(НоваяКолонка.Имя);\r\n\r\n\t\t// Удалим Неопределено и NULL\r\n\t\tМассив = Новый Массив;\r\n\t\tДля Каждого ТекущийТип Из НоваяКолонка.ТипЗначения.Типы() Цикл\r\n\t\t\tЕсли ТекущийТип = Тип(\"Неопределено\") ИЛИ ТекущийТип = Тип(\"NULL\") ИЛИ\r\n\t\t\t     ТекущийТип = Неопределено ИЛИ ТекущийТип = Null Тогда\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tМассив.Добавить(ТекущийТип);\r\n\t\tКонецЦикла;\r\n\t\tПолеНабора.ТипЗначения = Новый ОписаниеТипов(Массив, НоваяКолонка.ТипЗначения.КвалификаторыЧисла,\r\n\t\t                                             НоваяКолонка.ТипЗначения.КвалификаторыСтроки,\r\n\t\t                                             НоваяКолонка.ТипЗначения.КвалификаторыДаты);\r\n\r\n\t\tВыбранноеПолеКомпоновкиДанных = НастройкиПоУмолчанию.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\tВыбранноеПолеКомпоновкиДанных.Поле          = Новый ПолеКомпоновкиДанных(ПолеНабора.ПутьКДанным);\r\n\t\tВыбранноеПолеКомпоновкиДанных.Использование = Истина;\r\n\tКонецЦикла;\r\n\r\n\t// Оформление\r\n\tЕсли не ПустаяСтрока(ИмяСтандартногоМакетаОформления) Тогда\r\n\t\tЗначениеПараметраВывода = НастройкиПоУмолчанию.ПараметрыВывода.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(\"МакетОформления\"));\r\n\t\tЗначениеПараметраВывода.Значение      = ИмяСтандартногоМакетаОформления;\r\n\t\tЗначениеПараметраВывода.Использование = Истина;\r\n\tКонецЕсли;\r\n\r\n\tВозврат СКД;\r\nКонецФункции  // СоздатьСхемуКомпоновкиДанных\n\nОрфографическая ошибка в kambl: kambl\r\nОрфографическая ошибка в автовыбранное: автовыбранное"
  },
  {
    "title": "Изменение видимости колонок табличной части по параметру свойству таблицы \"ПланыВидовРасчета\"",
    "description": "Изменение видимости колонок табличной части по параметру свойству таблицы \"ПланыВидовРасчета\"",
    "code_snippet": "&НаКлиенте\nПроцедура ТаблицаНачисленийВидРасчетаПриИзменении(Элемент)\n\t\n\t//Псевдо таблица значений = \"ТаблицаНачислений\"\n\t//Изменяемая колонка  = \"ВидРасчета\"\n\t//Постановка задачи : Если используется вид расчета у которого нету периода действия, то колонку \"Параметр\" нужно скрыть.\n\t\n\t///////////////////////////////////////////////////////////\n\t//Вариант с использованием метаданных\n\t\n\t//Условия для выбора типа данных, так как если ипользуется несколько видов расчета, при изменении процедура \"ТаблицаНачисленийВидРасчетаПриИзменении\" будет вызываться 2 раза, один после выбора типа, второй после выбора значения типа. \n\tСтрокаТабличнойЧасти = Элементы.ТаблицаНачислений.ТекущиеДанные;\n\tЕсли СтрокаТабличнойЧасти.ВидРасчета.Код = \"\" Тогда\n\t\tВозврат;\n\tКонецЕсли;\n\t\n\tИспользованиеПериодаДействия = ПроверкаМетаданные(СтрокаТабличнойЧасти.ВидРасчета);\n\t\n\tЕсли ИспользованиеПериодаДействия Тогда\n\t\tЭлементы.ТаблицаНачисленийПараметр.Видимость = Истина;\n\tИначе Элементы.ТаблицаНачисленийПараметр.Видимость = Ложь; \n\tКонецЕсли;\n\t\n\t///////////////////////////////////////////////////////////\n\t//Вариант без серверных вызовов, но каждый элементы придеться вбивать вручную\n\tМассивОбъектовБезПериодаДействия = Новый Массив; \n\tМассивОбъектовБезПериодаДействия.Добавить(\"Прогул\");\n\tВыбранноеЗначение = Элемент.ТекстРедактирования;\n\t\t\n\tЕсли НЕ МассивОбъектовБезПериодаДействия.Найти(ВыбранноеЗначение) = Неопределено Тогда\n\t\tЭлементы.ТаблицаНачисленийПараметр.Видимость = Ложь;\n\tИначе Элементы.ТаблицаНачисленийПараметр.Видимость = Истина; \n\tКонецЕсли;\n\t\n\t\nКонецПроцедуры\n\n&НаСервереБезКонтекста\nФункция ПроверкаМетаданные(Элемент)\n\n\t//На сервере, элемент формы автоматически преобразуется в объект.\n\tМетаданныеЭлемента = Элемент.Метаданные();\n\t\n\tЕсли МетаданныеЭлемента.ИспользованиеПериодаДействия Тогда \n\t\tВозврат Истина; \n\tИначе \n\t\tВозврат Ложь;    \n\tКонецЕсли;\n\t\t\nКонецФункции\n\nОрфографическая ошибка в функ: функ\r\nОрфографическая ошибка в Псевдо: Псевдо\r\nОрфографическая ошибка в придеться: придеться"
  },
  {
    "title": "Создать запись в регистре сведений",
    "description": "Создать запись в регистре сведений",
    "code_snippet": "Набор = РегистрыСведений.бит_стр_СтатусыОбъектов.СоздатьМенеджерЗаписи();\r\nНабор.ДатаИзмененияСтатуса = ТекущаяДата();\r\nНабор.Объект = Док.Ссылка;\r\nНабор.Статус = Справочники.бит_стр_СтатусыОбъектов.НайтиПоКоду(\"000000031\");\r\nНабор.Пользователь = ПараметрыСеанса.ТекущийПользователь;\r\nНабор.Записать();\n\nНабор = РегистрыСведений.бит_стр_СтатусыОбъектов.СоздатьМенеджерЗаписи();\r\nНабор.ДатаИзмененияСтатуса = ТекущаяДата();\r\nНабор.Объект = Док.Ссылка;\r\nНабор.Статус = Справочники.бит_стр_СтатусыОбъектов.НайтиПоКоду(\"000000031\");\r\nНабор.Пользователь = ПараметрыСеанса.ТекущийПользователь;\r\nНабор.Записать();"
  },
  {
    "title": "Код для переноса данных",
    "description": "Код для переноса данных",
    "code_snippet": "//Перед загрузкой данных\r\nТаблицаДокументов = Новый ТаблицаЗначений;\r\nТаблицаДокументов.Колонки.Добавить(\"Ссылка\");\r\nТаблицаДокументов.Колонки.Добавить(\"Действие\");\r\nПараметры.Вставить(\"ТаблицаДокументов\",ТаблицаДокументов);\r\n\r\n//После загрузки объекта\r\nЕсли ИмяТипаОбъекта = \"Документ\"\r\n    И Объект.Метаданные().Проведение = Метаданные.СвойстваОбъектов.Проведение.Разрешить Тогда\r\n\r\n    Если Не ОбъектНайден  Тогда\r\n        Объект.Записать();\r\n        ОбъектМодифицирован = Ложь;\r\n    КонецЕсли;\r\n\r\n    НоваяСтрока =  Параметры.ТаблицаДокументов.Добавить();\r\n    НоваяСтрока.Ссылка = Объект.Ссылка;\r\n\r\n  Если Объект.Проведен  Тогда\r\n      НоваяСтрока.Действие = \"Проведение\";\r\n  ИначеЕсли Объект.ПометкаУдаления Тогда\r\n      НоваяСтрока.Действие = \"Удаление\";\r\n  Иначе\r\n      НоваяСтрока.Действие = \"Отмена\";\r\n  КонецЕсли;\r\n  //Если ПараметрыОбъекта.Получить(\"Проведен\") Тогда\r\n  //      НоваяСтрока.Действие = \"Проведение\";\r\n  //  ИначеЕсли ПараметрыОбъекта.Получить(\"ПометкаУдаления\")  Тогда\r\n  //      НоваяСтрока.Действие = \"Удаление\";\r\n  //  Иначе\r\n  //      НоваяСтрока.Действие = \"Отмена\";\r\n  //КонецЕсли;\r\nКонецЕсли;\r\n\r\nПосле загрузки данных\r\nТекстСообщенияЗаписи = \"\";\r\nТекстСообщенияОшибки = \"\";\r\n\r\nДля каждого СтрокаТч Из Параметры.ТаблицаДокументов Цикл\r\n  \r\n  Если СтрокаТч.Действие = \"Отмена\"  И Не СтрокаТч.Ссылка.Проведен Тогда\r\n    Если СтрокаТч.Ссылка.ПометкаУдаления Тогда  //Для снятия пометки удаления\r\n      Попытка\r\n        ДокОбъект = СтрокаТч.Ссылка.ПолучитьОбъект();\r\n        ДокОбъект.ПометкаУдаления = Ложь;\r\n        ДокОбъект.Записать();\r\n      Исключение\r\n      КонецПопытки;\r\n    КонецЕсли;\r\n    \r\n    Продолжить;\r\n    \r\n  КонецЕсли;\r\n  \r\n  Если СтрокаТч.Действие = \"Проведение\" Тогда\r\n    РежимЗаписи = РежимЗаписиДокумента.Проведение;\r\n  Иначе\r\n    РежимЗаписи = РежимЗаписиДокумента.ОтменаПроведения;\r\n  КонецЕсли;\r\n  \r\n  Попытка\r\n    ДокОбъект = СтрокаТч.Ссылка.ПолучитьОбъект();\r\n    Если (СтрокаТч.Действие <> \"Удаление\" Или  СтрокаТч.Ссылка.Проведен) Тогда\r\n      ДокОбъект.Записать(РежимЗаписи);\r\n      ТекстСообщенияЗаписи = ТекстСообщенияЗаписи +?(РежимЗаписи = РежимЗаписиДокумента.Проведение,\r\n      \"Проведен \",\"Отменено проведение \")\r\n      + Строка(СтрокаТч.Ссылка) + Символы.ПС;\r\n    КонецЕсли;\r\n    \r\n    Если СтрокаТч.Действие = \"Удаление\" Тогда\r\n      ДокОбъект.ПометкаУдаления = Истина;\r\n      ДокОбъект.Записать();\r\n    ИначеЕсли СтрокаТч.Ссылка.ПометкаУдаления Тогда\r\n      ДокОбъект.ПометкаУдаления = Ложь;\r\n      ДокОбъект.Записать();\r\n    КонецЕсли;\r\n  Исключение    \r\n    \r\n    ТекстСообщенияОшибки = ТекстСообщенияОшибки + Строка(СтрокаТч.Ссылка)+ \" : \"+ОписаниеОшибки()+ Символы.ПС;\r\n    \r\n  КонецПопытки;\r\nКонецЦикла;\r\n\r\nЕсли Не ПустаяСтрока(ТекстСообщенияЗаписи) Тогда\r\n  Сообщить(ТекстСообщенияЗаписи);\r\nКонецЕсли;\r\n\r\nЕсли Не ПустаяСтрока(ТекстСообщенияОшибки) Тогда\r\n  Сообщить(\"Ошибки при отмене проведения: \"+ Символы.ПС + ТекстСообщенияОшибки);\r\nКонецЕсли;\r\nПараметры.Удалить(\"ТаблицаДокументов\");\n\n//Перед загрузкой данных\r\nТаблицаДокументов = Новый ТаблицаЗначений;\r\nТаблицаДокументов.Колонки.Добавить(\"Ссылка\");\r\nТаблицаДокументов.Колонки.Добавить(\"Действие\");\r\nПараметры.Вставить(\"ТаблицаДокументов\",ТаблицаДокументов);\r\n\r\n//После загрузки объекта\r\nЕсли ИмяТипаОбъекта = \"Документ\"\r\n    И Объект.Метаданные().Проведение = Метаданные.СвойстваОбъектов.Проведение.Разрешить Тогда\r\n\r\n    Если Не ОбъектНайден  Тогда\r\n        Объект.Записать();\r\n        ОбъектМодифицирован = Ложь;\r\n    КонецЕсли;\r\n\r\n    НоваяСтрока =  Параметры.ТаблицаДокументов.Добавить();\r\n    НоваяСтрока.Ссылка = Объект.Ссылка;\r\n\r\n  Если Объект.Проведен  Тогда\r\n      НоваяСтрока.Действие = \"Проведение\";\r\n  ИначеЕсли Объект.ПометкаУдаления Тогда\r\n      НоваяСтрока.Действие = \"Удаление\";\r\n  Иначе\r\n      НоваяСтрока.Действие = \"Отмена\";\r\n  КонецЕсли;\r\n  //Если ПараметрыОбъекта.Получить(\"Проведен\") Тогда\r\n  //      НоваяСтрока.Действие = \"Проведение\";\r\n  //  ИначеЕсли ПараметрыОбъекта.Получить(\"ПометкаУдаления\")  Тогда\r\n  //      НоваяСтрока.Действие = \"Удаление\";\r\n  //  Иначе\r\n  //      НоваяСтрока.Действие = \"Отмена\";\r\n  //КонецЕсли;\r\nКонецЕсли;\r\n\r\nПосле загрузки данных\r\nТекстСообщенияЗаписи = \"\";\r\nТекстСообщенияОшибки = \"\";\r\n\r\nДля каждого СтрокаТч Из Параметры.ТаблицаДокументов Цикл\r\n  \r\n  Если СтрокаТч.Действие = \"Отмена\"  И Не СтрокаТч.Ссылка.Проведен Тогда\r\n    Если СтрокаТч.Ссылка.ПометкаУдаления Тогда  //Для снятия пометки удаления\r\n      Попытка\r\n        ДокОбъект = СтрокаТч.Ссылка.ПолучитьОбъект();\r\n        ДокОбъект.ПометкаУдаления = Ложь;\r\n        ДокОбъект.Записать();\r\n      Исключение\r\n      КонецПопытки;\r\n    КонецЕсли;\r\n    \r\n    Продолжить;\r\n    \r\n  КонецЕсли;\r\n  \r\n  Если СтрокаТч.Действие = \"Проведение\" Тогда\r\n    РежимЗаписи = РежимЗаписиДокумента.Проведение;\r\n  Иначе\r\n    РежимЗаписи = РежимЗаписиДокумента.ОтменаПроведения;\r\n  КонецЕсли;\r\n  \r\n  Попытка\r\n    ДокОбъект = СтрокаТч.Ссылка.ПолучитьОбъект();\r\n    Если (СтрокаТч.Действие <> \"Удаление\" Или  СтрокаТч.Ссылка.Проведен) Тогда\r\n      ДокОбъект.Записать(РежимЗаписи);\r\n      ТекстСообщенияЗаписи = ТекстСообщенияЗаписи +?(РежимЗаписи = РежимЗаписиДокумента.Проведение,\r\n      \"Проведен \",\"Отменено проведение \")\r\n      + Строка(СтрокаТч.Ссылка) + Символы.ПС;\r\n    КонецЕсли;\r\n    \r\n    Если СтрокаТч.Действие = \"Удаление\" Тогда\r\n      ДокОбъект.ПометкаУдаления = Истина;\r\n      ДокОбъект.Записать();\r\n    ИначеЕсли СтрокаТч.Ссылка.ПометкаУдаления Тогда\r\n      ДокОбъект.ПометкаУдаления = Ложь;\r\n      ДокОбъект.Записать();\r\n    КонецЕсли;\r\n  Исключение    \r\n    \r\n    ТекстСообщенияОшибки = ТекстСообщенияОшибки + Строка(СтрокаТч.Ссылка)+ \" : \"+ОписаниеОшибки()+ Символы.ПС;\r\n    \r\n  КонецПопытки;\r\nКонецЦикла;\r\n\r\nЕсли Не ПустаяСтрока(ТекстСообщенияЗаписи) Тогда\r\n  Сообщить(ТекстСообщенияЗаписи);\r\nКонецЕсли;\r\n\r\nЕсли Не ПустаяСтрока(ТекстСообщенияОшибки) Тогда\r\n  Сообщить(\"Ошибки при отмене проведения: \"+ Символы.ПС + ТекстСообщенияОшибки);\r\nКонецЕсли;\r\nПараметры.Удалить(\"ТаблицаДокументов\");\n\n{13} Переменной ОбъектМодифицирован присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Групповое изменение реквизитов, вытащить дополнительный реквизит",
    "description": "Групповое изменение реквизитов, вытащить дополнительный реквизит",
    "code_snippet": "НоваяСтрока = Объект.ДополнительныеРеквизиты.Добавить();\r\nНоваяСтрока.Свойство = ПланыВидовХарактеристик.ДополнительныеРеквизитыиСведения.НайтиПоРеквизиту(\"Имя\",\"ВладелецДоговора_958efaf7394a4e97a9f12345302ffb3a\");\r\nНоваяСтрока.Значение = Справочники.Организации.НайтиПоНаименованию(\"НаименованиеКакоеХотимНайти\");\n\nНоваяСтрока = Объект.ДополнительныеРеквизиты.Добавить();\r\nНоваяСтрока.Свойство = ПланыВидовХарактеристик.ДополнительныеРеквизитыиСведения.НайтиПоРеквизиту(\"Имя\",\"ВладелецДоговора_958efaf7394a4e97a9f12345302ffb3a\");\r\nНоваяСтрока.Значение = Справочники.Организации.НайтиПоНаименованию(\"НаименованиеКакоеХотимНайти\");\n\nОрфографическая ошибка в ДополнительныеРеквизитыиСведения: Реквизитыи"
  },
  {
    "title": "Стандартное формирование выборок",
    "description": "Стандартное формирование выборок",
    "code_snippet": "Функция Наименование1(МассивОбъектов, ПараметрыПечати)\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"Ссылка\", МассивОбъектов[0]);\r\n\t\r\n\tЗапрос.Текст =\r\n\t\"ВЫБРАТЬ\r\n\t\r\n\t\r\n\tВозврат Запрос.Выполнить();\t\r\n\t\t\r\nКонецФункции\r\n\r\nФункция Наименование2(МассивОбъектов, ПараметрыПечати, ОбъектыПечати)\r\n\t\r\n\tМакет = ПолучитьМакет(\"Макет\");\r\n\t\r\n\tНастройкиПечатныхФорм = ЗарплатаКадрыПовтИсп.НастройкиПечатныхФорм();\r\n\t\r\n\tДокументРезультат = Новый ТабличныйДокумент;\r\n\t\r\n\tДокументРезультат.ИмяПараметровПечати = \"ПАРАМЕТРЫ_ПЕЧАТИ_Приказ\";\r\n\tДокументРезультат.ОриентацияСтраницы= ОриентацияСтраницы.Портрет;\r\n\tДокументРезультат.АвтоМасштаб = Истина;\r\n\t\r\n\tВалютаУчета = ЗарплатаКадры.ВалютаУчетаЗаработнойПлаты();\r\n\t\r\n\tОбластьМакета = Макет.ПолучитьОбласть(\"ОбластьМакета\");\r\n\t\r\n\t// получаем данные для печати\r\n\tДанныеДляПечати = Наименование1(МассивОбъектов, ПараметрыПечати).Выбрать();\r\n\tПервыйДокумент = Истина;\r\n\tПока ДанныеДляПечати.Следующий() Цикл\r\n\t\r\n\t//в теле пишем код для вывода\r\n\r\nКонецЦикла;\r\n\t\r\n\tВозврат ДокументРезультат;\r\n\t\r\nКонецФункции\r\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n//выборка 2////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\nФункция Наименование3(Регистратор, ПараметрыПечати)\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Регистратор.Сотрудник);\r\n\t\r\n\t\r\n\tЗапрос.Текст =\r\n\t\"ВЫБРАТЬ\r\n\t|\tКадроваяИсторияСотрудниковСрезПервых.Регистратор.ТрудовойДоговорНомер КАК РегистраторТрудовойДоговорНомер,\r\n\t|\tКадроваяИсторияСотрудниковСрезПервых.Регистратор.ТрудовойДоговорДата КАК РегистраторТрудовойДоговорДата\r\n\t|ИЗ\r\n\t|\tРегистрСведений.КадроваяИсторияСотрудников.СрезПервых КАК КадроваяИсторияСотрудниковСрезПервых\r\n\t|ГДЕ\r\n\t|\tКадроваяИсторияСотрудниковСрезПервых.Сотрудник = &Сотрудник\";\r\n\t\r\n\tВозврат Запрос.Выполнить();\t\r\n\t\t\r\nКонецФункции\r\n\r\nДанныеТД = ДанныеТрудовогоДоговора(ДанныеДляПечати.Ссылка, ПараметрыПечати).Выбрать();\r\n\t\tПока ДанныеТД.Следующий() Цикл\r\n\t\t\t ОбластьМакета.Параметры.ТрудовойДоговорДата = Формат(ДанныеТД.РегистраторТрудовойДоговорДата, \"ДЛФ=DD\");;\r\n\t\t\t ОбластьМакета.Параметры.ТрудовойДоговорНомер = ДанныеТД.РегистраторТрудовойДоговорНомер; \r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tТабНомер = ПолучитьТабельныйНомер(ДанныеДляПечати.Ссылка, ПараметрыПечати).Выбрать();\r\n\t\tПока  ТабНомер.Следующий() Цикл\r\n\t\t\t  ОбластьМакета.Параметры.ТабельныйНомер = ТабНомер.Код;\r\n\t\tКонецЦикла;\n\nФункция Наименование1(МассивОбъектов, ПараметрыПечати)\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"Ссылка\", МассивОбъектов[0]);\r\n\t\r\n\tЗапрос.Текст =\r\n\t\"ВЫБРАТЬ\r\n\t\r\n\t\r\n\tВозврат Запрос.Выполнить();\t\r\n\t\t\r\nКонецФункции\r\n\r\nФункция Наименование2(МассивОбъектов, ПараметрыПечати, ОбъектыПечати)\r\n\t\r\n\tМакет = ПолучитьМакет(\"Макет\");\r\n\t\r\n\tНастройкиПечатныхФорм = ЗарплатаКадрыПовтИсп.НастройкиПечатныхФорм();\r\n\t\r\n\tДокументРезультат = Новый ТабличныйДокумент;\r\n\t\r\n\tДокументРезультат.ИмяПараметровПечати = \"ПАРАМЕТРЫ_ПЕЧАТИ_Приказ\";\r\n\tДокументРезультат.ОриентацияСтраницы= ОриентацияСтраницы.Портрет;\r\n\tДокументРезультат.АвтоМасштаб = Истина;\r\n\t\r\n\tВалютаУчета = ЗарплатаКадры.ВалютаУчетаЗаработнойПлаты();\r\n\t\r\n\tОбластьМакета = Макет.ПолучитьОбласть(\"ОбластьМакета\");\r\n\t\r\n\t// получаем данные для печати\r\n\tДанныеДляПечати = Наименование1(МассивОбъектов, ПараметрыПечати).Выбрать();\r\n\tПервыйДокумент = Истина;\r\n\tПока ДанныеДляПечати.Следующий() Цикл\r\n\t\r\n\t//в теле пишем код для вывода\r\n\r\nКонецЦикла;\r\n\t\r\n\tВозврат ДокументРезультат;\r\n\t\r\nКонецФункции\r\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n//выборка 2////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\nФункция Наименование3(Регистратор, ПараметрыПечати)\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Регистратор.Сотрудник);\r\n\t\r\n\t\r\n\tЗапрос.Текст =\r\n\t\"ВЫБРАТЬ\r\n\t|\tКадроваяИсторияСотрудниковСрезПервых.Регистратор.ТрудовойДоговорНомер КАК РегистраторТрудовойДоговорНомер,\r\n\t|\tКадроваяИсторияСотрудниковСрезПервых.Регистратор.ТрудовойДоговорДата КАК РегистраторТрудовойДоговорДата\r\n\t|ИЗ\r\n\t|\tРегистрСведений.КадроваяИсторияСотрудников.СрезПервых КАК КадроваяИсторияСотрудниковСрезПервых\r\n\t|ГДЕ\r\n\t|\tКадроваяИсторияСотрудниковСрезПервых.Сотрудник = &Сотрудник\";\r\n\t\r\n\tВозврат Запрос.Выполнить();\t\r\n\t\t\r\nКонецФункции\r\n\r\nДанныеТД = ДанныеТрудовогоДоговора(ДанныеДляПечати.Ссылка, ПараметрыПечати).Выбрать();\r\n\t\tПока ДанныеТД.Следующий() Цикл\r\n\t\t\t ОбластьМакета.Параметры.ТрудовойДоговорДата = Формат(ДанныеТД.РегистраторТрудовойДоговорДата, \"ДЛФ=DD\");;\r\n\t\t\t ОбластьМакета.Параметры.ТрудовойДоговорНомер = ДанныеТД.РегистраторТрудовойДоговорНомер; \r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tТабНомер = ПолучитьТабельныйНомер(ДанныеДляПечати.Ссылка, ПараметрыПечати).Выбрать();\r\n\t\tПока  ТабНомер.Следующий() Цикл\r\n\t\t\t  ОбластьМакета.Параметры.ТабельныйНомер = ТабНомер.Код;\r\n\t\tКонецЦикла;"
  },
  {
    "title": "Регистрация сведений о внешнем отчете",
    "description": "Регистрация сведений о внешнем отчете",
    "code_snippet": "Функция СведенияОВнешнейОбработке() Экспорт\r\n\tПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(\"1.1.1.1\");\r\n\t\r\n\t\r\n\tПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительныйОтчет();\r\n    ПараметрыРегистрации.Версия = \"1.0\";\r\n    ПараметрыРегистрации.БезопасныйРежим = Истина;\t\r\n\tНоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n    НоваяКоманда.Представление = НСтр(\"ru = 'Платежный Календарь'\");\r\n    НоваяКоманда.Идентификатор = \"ПлатежныйКалендарь\";\r\n    НоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();\r\n    НоваяКоманда.ПоказыватьОповещение = Ложь;\r\n    //НоваяКоманда.Модификатор = \"ПФ_MXL\";\r\n\r\n    \r\n\tВозврат ПараметрыРегистрации;\r\n\r\n\t\r\nКонецФункции\n\nФункция СведенияОВнешнейОбработке() Экспорт\r\n\tПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(\"1.1.1.1\");\r\n\t\r\n\t\r\n\tПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительныйОтчет();\r\n    ПараметрыРегистрации.Версия = \"1.0\";\r\n    ПараметрыРегистрации.БезопасныйРежим = Истина;\t\r\n\tНоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n    НоваяКоманда.Представление = НСтр(\"ru = 'Платежный Календарь'\");\r\n    НоваяКоманда.Идентификатор = \"ПлатежныйКалендарь\";\r\n    НоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();\r\n    НоваяКоманда.ПоказыватьОповещение = Ложь;\r\n    //НоваяКоманда.Модификатор = \"ПФ_MXL\";\r\n\r\n    \r\n\tВозврат ПараметрыРегистрации;\r\n\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Шаблон внешней печатной формы",
    "description": "Шаблон внешней печатной формы",
    "code_snippet": "Функция СведенияОВнешнейОбработке() Экспорт\r\n\t\t\r\n\tПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке();\r\n\t\r\n\tПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиПечатнаяФорма();\r\n\t\r\n\tПараметрыРегистрации.Вставить(\"БезопасныйРежим\", Ложь);\r\n\t//ПараметрыРегистрации.ВерсияБСП = \"2.1.3.2\";\r\n\tПараметрыРегистрации.Вставить(\"Версия\", \"1.0\");\r\n\t//ПараметрыРегистрации.Вставить(\"Информация\", \"\");\r\n\t\r\n\tПараметрыРегистрации.Назначение.Добавить(\"Документ.ВедомостьНаВыплатуЗарплатыПеречислением\");\r\n\t//ПараметрыРегистрации.Назначение.Добавить(\"Документ.*\"); // все документы\r\n\t\r\n\tНоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n\tНоваяКоманда.Представление = Метаданные().Представление();   //Синоним\r\n\tНоваяКоманда.Идентификатор = Метаданные().ПолноеИмя();   //ПолноеИмя\r\n\tНоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\r\n\tНоваяКоманда.Модификатор = \"ПечатьMXL\"; // Обязательно\r\n\t\r\n\t//НоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n\t//НоваяКоманда.Представление = Метаданные().Представление();\r\n\t//НоваяКоманда.Идентификатор = Метаданные().ПолноеИмя();\r\n\t//НоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовКлиентскогоМетода();\r\n\t//\r\n\t//НоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n\t//НоваяКоманда.Представление = Метаданные().Представление();\r\n\t//НоваяКоманда.Идентификатор = Метаданные().ПолноеИмя();\r\n\t//НоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();\r\n\t\r\n\t//Разрешение = РаботаВБезопасномРежиме.РазрешениеНаИспользованиеВнешнейКомпоненты(\"ОбщийМакет.КомпонентаПечатиШтрихкодов\");\r\n  \t//ПараметрыРегистрации.Разрешения.Добавить(Разрешение);\r\n\t\r\n\tВозврат ПараметрыРегистрации;\r\n\t\r\nКонецФункции\r\n\r\n// Формирует печатные формы\r\n//\r\n// Параметры:\r\n//  МассивОбъектов  - Массив    - ссылки на объекты, которые нужно распечатать;\r\n//  КоллекцияПечатныхФорм - ТаблицаЗначений - сформированные табличные документы \r\n//                                            (выходной параметр).\r\n//  ОбъектыПечати         - СписокЗначений  - значение      - ссылка на объект;\r\n//                                            представление - имя области в которой был выведен объект\r\n//                                            (выходной параметр);\r\n//  ПараметрыВывода       - Структура       - дополнительные параметры сформированных табличных документов\r\n//                                            (выходной параметр);\r\n//\r\nПроцедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\r\n\t\r\n\tУправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, Метаданные().ПолноеИмя(), НСтр(Метаданные().Представление()), \r\n\tПечатьСписокПеречислений(МассивОбъектов, ОбъектыПечати));\t\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция ПечатьСписокПеречислений(МассивОбъектов, ОбъектыПечати)\r\n\t\r\n\tТабличныйДокумент = Новый ТабличныйДокумент;\r\n\tТабличныйДокумент.КлючПараметровПечати = Метаданные().ПолноеИмя();\r\n\r\n\tМакет = ПолучитьМакет(\"ПФ_MXL_СписокПеречисленийНаЛицевыеСчета\"); \r\n\t\r\n\t// получаем данные для печати\r\n\tВыборкаШапок = ВыборкаДляПечатиШапки(МассивОбъектов);\r\n\tВыборкаСтрок = ВыборкаДляПечатиТаблицы(МассивОбъектов);\r\n\t\r\n\tПервыйДокумент = Истина;\r\n\t\r\n\tВозврат ТабличныйДокумент;\r\n\t\r\nКонецФункции\n\nФункция СведенияОВнешнейОбработке() Экспорт\r\n\t\t\r\n\tПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке();\r\n\t\r\n\tПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиПечатнаяФорма();\r\n\t\r\n\tПараметрыРегистрации.Вставить(\"БезопасныйРежим\", Ложь);\r\n\t//ПараметрыРегистрации.ВерсияБСП = \"2.1.3.2\";\r\n\tПараметрыРегистрации.Вставить(\"Версия\", \"1.0\");\r\n\t//ПараметрыРегистрации.Вставить(\"Информация\", \"\");\r\n\t\r\n\tПараметрыРегистрации.Назначение.Добавить(\"Документ.ВедомостьНаВыплатуЗарплатыПеречислением\");\r\n\t//ПараметрыРегистрации.Назначение.Добавить(\"Документ.*\"); // все документы\r\n\t\r\n\tНоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n\tНоваяКоманда.Представление = Метаданные().Представление();   //Синоним\r\n\tНоваяКоманда.Идентификатор = Метаданные().ПолноеИмя();   //ПолноеИмя\r\n\tНоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\r\n\tНоваяКоманда.Модификатор = \"ПечатьMXL\"; // Обязательно\r\n\t\r\n\t//НоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n\t//НоваяКоманда.Представление = Метаданные().Представление();\r\n\t//НоваяКоманда.Идентификатор = Метаданные().ПолноеИмя();\r\n\t//НоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовКлиентскогоМетода();\r\n\t//\r\n\t//НоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n\t//НоваяКоманда.Представление = Метаданные().Представление();\r\n\t//НоваяКоманда.Идентификатор = Метаданные().ПолноеИмя();\r\n\t//НоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();\r\n\t\r\n\t//Разрешение = РаботаВБезопасномРежиме.РазрешениеНаИспользованиеВнешнейКомпоненты(\"ОбщийМакет.КомпонентаПечатиШтрихкодов\");\r\n  \t//ПараметрыРегистрации.Разрешения.Добавить(Разрешение);\r\n\t\r\n\tВозврат ПараметрыРегистрации;\r\n\t\r\nКонецФункции\r\n\r\n// Формирует печатные формы\r\n//\r\n// Параметры:\r\n//  МассивОбъектов  - Массив    - ссылки на объекты, которые нужно распечатать;\r\n//  КоллекцияПечатныхФорм - ТаблицаЗначений - сформированные табличные документы \r\n//                                            (выходной параметр).\r\n//  ОбъектыПечати         - СписокЗначений  - значение      - ссылка на объект;\r\n//                                            представление - имя области в которой был выведен объект\r\n//                                            (выходной параметр);\r\n//  ПараметрыВывода       - Структура       - дополнительные параметры сформированных табличных документов\r\n//                                            (выходной параметр);\r\n//\r\nПроцедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\r\n\t\r\n\tУправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, Метаданные().ПолноеИмя(), НСтр(Метаданные().Представление()), \r\n\tПечатьСписокПеречислений(МассивОбъектов, ОбъектыПечати));\t\r\n\t\r\nКонецПроцедуры\r\n\r\nФункция ПечатьСписокПеречислений(МассивОбъектов, ОбъектыПечати)\r\n\t\r\n\tТабличныйДокумент = Новый ТабличныйДокумент;\r\n\tТабличныйДокумент.КлючПараметровПечати = Метаданные().ПолноеИмя();\r\n\r\n\tМакет = ПолучитьМакет(\"ПФ_MXL_СписокПеречисленийНаЛицевыеСчета\"); \r\n\t\r\n\t// получаем данные для печати\r\n\tВыборкаШапок = ВыборкаДляПечатиШапки(МассивОбъектов);\r\n\tВыборкаСтрок = ВыборкаДляПечатиТаблицы(МассивОбъектов);\r\n\t\r\n\tПервыйДокумент = Истина;\r\n\t\r\n\tВозврат ТабличныйДокумент;\r\n\t\r\nКонецФункции\n\n{62} Переменной Макет присвоено значение, но оно нигде не используется\r\n{65} Переменной ВыборкаШапок присвоено значение, но оно нигде не используется\r\n{66} Переменной ВыборкаСтрок присвоено значение, но оно нигде не используется\r\n{68} Переменной ПервыйДокумент присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в КомпонентаПечатиШтрихкодов: Штрихкодов\n\nФункция СведенияОВнешнейОбработке() Экспорт\n  \n  ПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(\"\"2.2.3.1\"\");\n  \n  ПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиПечатнаяФорма();\n  ПараметрыРегистрации.Версия = \"1.0\";\n  //ПараметрыРегистрации.Назначение.Добавить(\"Документ.СписаниеОС\");\n  ПараметрыРегистрации.БезопасныйРежим = Истина;\n  \n  ПараметрыРегистрации.Вставить(\"Информация\", НСтр(\"ru = ''\"));\n  \n  НоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\n  НоваяКоманда.Представление = НСтр(\"ru = ''\");\n  НоваяКоманда.Идентификатор = \"\";\n  НоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\n  НоваяКоманда.ПоказыватьОповещение = Истина;\n  НоваяКоманда.Модификатор = \"ПечатьMXL\";\n  \n  //Разрешение = РаботаВБезопасномРежиме.РазрешениеНаИспользованиеВнешнейКомпоненты(\"ОбщийМакет.КомпонентаПечатиШтрихкодов\");\n  //ПараметрыРегистрации.Разрешения.Добавить(Разрешение);\n  \n  Возврат ПараметрыРегистрации;\n  \nКонецФункции\n\nПроцедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт\n  \n  Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, \"\") Тогда\n    УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(\n      КоллекцияПечатныхФорм,\n      \"\",\n      НСтр(\"ru = ''\"),\n      СформироватьПечатнуюФорму(МассивОбъектов,\n        ОбъектыПечати,\n        ПараметрыВывода,\n        Неопределено));  \n  КонецЕсли;\n    \nКонецПроцедуры\n\nФункция СформироватьПечатнуюФорму(МассивОбъектов, ОбъектыПечати, ПараметрыПечати, КомплектыПечати) Экспорт\n  \n  УстановитьПривилегированныйРежим(Истина);\n  \n  ТабличныйДокумент = Новый ТабличныйДокумент;\n  //ТабличныйДокумент.ОриентацияСтраницы  = ОриентацияСтраницы.Ландшафт;\n  ТабличныйДокумент.ИмяПараметровПечати = \"ПАРАМЕТРЫ_ПЕЧАТИ_\";\n  \n  \n  Возврат ТабличныйДокумент;\n  \nКонецФункции"
  },
  {
    "title": "Склонение слов",
    "description": "Склонение слов",
    "code_snippet": "Функция Просклонять(СклоняемыйТекст, Падеж) \r\n\tЗапрос = HTTPЗапросКСервисуСклонения(СклоняемыйТекст);\r\n\tСоединение = HTTPСоединениеСервисаСклонений();\r\n\t\r\n\tПопытка\r\n\t\tОтвет = Соединение.Получить(Запрос);\r\n\tИсключение\r\n\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(\"Ошибка склонения \" + Символы.ПС + ОписаниеОшибки());\r\n\t\tВозврат СклоняемыйТекст;\r\n\tКонецПопытки;\r\n\t\r\n\tТелоОтвета = Ответ.ПолучитьТелоКакСтроку();\r\n\tЕсли Ответ.КодСостояния <> 200 Тогда\r\n\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(\"Ошибка склонения \" + Символы.ПС + ОписаниеОшибки());\r\n\t\tВозврат СклоняемыйТекст;\r\n\tКонецЕсли;\r\n\t\r\n\tЧтениеJSON = Новый ЧтениеJSON;\r\n\tЧтениеJSON.УстановитьСтроку(ТелоОтвета);\r\n\tСтруктураОтвета = ПрочитатьJSON(ЧтениеJSON);\r\n\tЧтениеJSON.Закрыть();\r\n\t\r\n\tВозврат СтруктураОтвета[Падеж]; \r\nКонецФункции\r\n\r\nФункция HTTPЗапросКСервисуСклонения(СклоняемыйТекст)\r\n\t\r\n\tТекстЗапроса = \"/russian/declension?s=\" + СклоняемыйТекст;\r\n\t\r\n\tУстановитьПривилегированныйРежим(Истина);\r\n\tВладелецТокена = ОбщегоНазначения.ИдентификаторОбъектаМетаданных(\"РегистрСведений.СклоненияПредставленийОбъектов\");\r\n\tТокен = ОбщегоНазначения.ПрочитатьДанныеИзБезопасногоХранилища(ВладелецТокена, \"ТокенДоступаКСервисуMorpher\");\r\n\tУстановитьПривилегированныйРежим(Ложь);\r\n\r\n\tЕсли ЗначениеЗаполнено(Токен) Тогда\r\n\t\tТекстЗапроса = ТекстЗапроса + \"&token=\" + Токен;\r\n\tКонецЕсли;\r\n\t\r\n\tЗаголовки = Новый Соответствие;\r\n  \tЗаголовки.Вставить(\"User-Agent\", \"1C Enterprise 8.3\");\r\n  \tЗаголовки.Вставить(\"Accept\", \"application/json\");\r\n\tЗаголовки.Вставить(\"charset\", \"UTF-8\");\t\r\n\t\r\n\tВозврат Новый HTTPЗапрос(ТекстЗапроса, Заголовки);\r\n\t\r\nКонецФункции\r\n\r\nФункция HTTPСоединениеСервисаСклонений()\r\n\t\r\n\tАдресСервера = \"ws3.morpher.ru\";\r\n\t\r\n\tИнтернетПрокси = Неопределено;\r\n\tЕсли ОбщегоНазначения.ПодсистемаСуществует(\"СтандартныеПодсистемы.ПолучениеФайловИзИнтернета\") Тогда\r\n\t\tМодульПолучениеФайловИзИнтернетаКлиентСервер = ОбщегоНазначения.ОбщийМодуль(\"ПолучениеФайловИзИнтернетаКлиентСервер\");\r\n\t\tИнтернетПрокси = МодульПолучениеФайловИзИнтернетаКлиентСервер.ПолучитьПрокси(АдресСервера);\r\n\tКонецЕсли;\r\n\t\r\n\tТаймаут = 10;\r\n\t\r\n\tЗащищенноеСоединение = Новый ЗащищенноеСоединениеOpenSSL(, Новый СертификатыУдостоверяющихЦентровОС);\r\n\tВозврат Новый HTTPСоединение(АдресСервера, , , , ИнтернетПрокси, Таймаут, ЗащищенноеСоединение);\r\n\t\r\nКонецФункции\n\nФункция Просклонять(СклоняемыйТекст, Падеж) \r\n\tЗапрос = HTTPЗапросКСервисуСклонения(СклоняемыйТекст);\r\n\tСоединение = HTTPСоединениеСервисаСклонений();\r\n\t\r\n\tПопытка\r\n\t\tОтвет = Соединение.Получить(Запрос);\r\n\tИсключение\r\n\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(\"Ошибка склонения \" + Символы.ПС + ОписаниеОшибки());\r\n\t\tВозврат СклоняемыйТекст;\r\n\tКонецПопытки;\r\n\t\r\n\tТелоОтвета = Ответ.ПолучитьТелоКакСтроку();\r\n\tЕсли Ответ.КодСостояния <> 200 Тогда\r\n\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(\"Ошибка склонения \" + Символы.ПС + ОписаниеОшибки());\r\n\t\tВозврат СклоняемыйТекст;\r\n\tКонецЕсли;\r\n\t\r\n\tЧтениеJSON = Новый ЧтениеJSON;\r\n\tЧтениеJSON.УстановитьСтроку(ТелоОтвета);\r\n\tСтруктураОтвета = ПрочитатьJSON(ЧтениеJSON);\r\n\tЧтениеJSON.Закрыть();\r\n\t\r\n\tВозврат СтруктураОтвета[Падеж]; \r\nКонецФункции\r\n\r\nФункция HTTPЗапросКСервисуСклонения(СклоняемыйТекст)\r\n\t\r\n\tТекстЗапроса = \"/russian/declension?s=\" + СклоняемыйТекст;\r\n\t\r\n\tУстановитьПривилегированныйРежим(Истина);\r\n\tВладелецТокена = ОбщегоНазначения.ИдентификаторОбъектаМетаданных(\"РегистрСведений.СклоненияПредставленийОбъектов\");\r\n\tТокен = ОбщегоНазначения.ПрочитатьДанныеИзБезопасногоХранилища(ВладелецТокена, \"ТокенДоступаКСервисуMorpher\");\r\n\tУстановитьПривилегированныйРежим(Ложь);\r\n\r\n\tЕсли ЗначениеЗаполнено(Токен) Тогда\r\n\t\tТекстЗапроса = ТекстЗапроса + \"&token=\" + Токен;\r\n\tКонецЕсли;\r\n\t\r\n\tЗаголовки = Новый Соответствие;\r\n  \tЗаголовки.Вставить(\"User-Agent\", \"1C Enterprise 8.3\");\r\n  \tЗаголовки.Вставить(\"Accept\", \"application/json\");\r\n\tЗаголовки.Вставить(\"charset\", \"UTF-8\");\t\r\n\t\r\n\tВозврат Новый HTTPЗапрос(ТекстЗапроса, Заголовки);\r\n\t\r\nКонецФункции\r\n\r\nФункция HTTPСоединениеСервисаСклонений()\r\n\t\r\n\tАдресСервера = \"ws3.morpher.ru\";\r\n\t\r\n\tИнтернетПрокси = Неопределено;\r\n\tЕсли ОбщегоНазначения.ПодсистемаСуществует(\"СтандартныеПодсистемы.ПолучениеФайловИзИнтернета\") Тогда\r\n\t\tМодульПолучениеФайловИзИнтернетаКлиентСервер = ОбщегоНазначения.ОбщийМодуль(\"ПолучениеФайловИзИнтернетаКлиентСервер\");\r\n\t\tИнтернетПрокси = МодульПолучениеФайловИзИнтернетаКлиентСервер.ПолучитьПрокси(АдресСервера);\r\n\tКонецЕсли;\r\n\t\r\n\tТаймаут = 10;\r\n\t\r\n\tЗащищенноеСоединение = Новый ЗащищенноеСоединениеOpenSSL(, Новый СертификатыУдостоверяющихЦентровОС);\r\n\tВозврат Новый HTTPСоединение(АдресСервера, , , , ИнтернетПрокси, Таймаут, ЗащищенноеСоединение);\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в russian: russian\r\nОрфографическая ошибка в ВладелецТокена (найдено 2): Токена\r\nОрфографическая ошибка в ТокенДоступаКСервисуMorpher: Morpher\r\nОрфографическая ошибка в charset: charset\r\nОрфографическая ошибка в morpher: morpher"
  },
  {
    "title": "Открытие активизация формы",
    "description": "Открытие активизация формы",
    "code_snippet": "ПутьКФорме = \"ПланОбмена.ИмяПланаОбмена.Форма.ФормаВыгрузкиНоменклатуры\";\r\n    \r\n    ОткрываемаяФорма = ПолучитьФорму(ПутьКФорме,,,ПутьКФорме);\r\n    Если ОткрываемаяФорма.Открыта() Тогда\r\n        ОткрываемаяФорма.Активизировать();\r\n    Иначе\r\n        ОткрываемаяФорма.Открыть();\r\n    КонецЕсли;\n\nПутьКФорме = \"ПланОбмена.ИмяПланаОбмена.Форма.ФормаВыгрузкиНоменклатуры\";\r\n    \r\n    ОткрываемаяФорма = ПолучитьФорму(ПутьКФорме,,,ПутьКФорме);\r\n    Если ОткрываемаяФорма.Открыта() Тогда\r\n        ОткрываемаяФорма.Активизировать();\r\n    Иначе\r\n        ОткрываемаяФорма.Открыть();\r\n    КонецЕсли;"
  },
  {
    "title": "Функция возвращает иерархию типов свойств для ТипОбъектаXDTO",
    "description": "Функция возвращает иерархию типов свойств для ТипОбъектаXDTO",
    "code_snippet": "// Возвращает иерархию/дерево типов свойств для ТипОбъектаXDTO\n// Упрощает создание Объектов XDTO. \n// Создание объектов XDTO без использования Иерархии свойств:\n//////////////////////////////////////////////////////////////////////////////\n//  ТипДата = Фабрика.Пакеты.Получить(\"urn://egisso-ru/msg/10.06.S/1.0.6\").КорневыеСвойства.Получить(\"data\").Тип;\n//  data = Фабрика.Создать(ТипДата);\n//  ТипПакет =ТипДата.Свойства.Получить(\"package\").Тип;\n//  data.package = Фабрика.Создать(ТипПакет);\n//  data.package.packageId  = XMLСтрока(новый УникальныйИдентификатор);\n//  ТипЭлемент = ТипПакет.Свойства.Получить(\"elements\").Тип;\n//  data.package.elements =  Фабрика.Создать(ТипЭлемент);\n//  ТипФакт = ТипЭлемент.Свойства.Получить(\"fact\").Тип;\n//  data.package.elements.fact =  Фабрика.Создать(ТипФакт);\n/////////////////////////////////////////////////////////////////////////////\n// Создание объектов  XDTO с помощью Иерархии свойств:\n/////////////////////////////////////////////////////////////////////////////\n//\tКорневойТип = Фабрика.Пакеты.Получить(\"urn://egisso-ru/msg/10.06.S/1.0.6\").КорневыеСвойства.Получить(\"data\").Тип;\n//\tИерархияТипов = Новый Структура(\"data\", ИерархияТиповXDTO(КорневойТип, 20));\n//\tdata = Фабрика.Создать(ИерархияТипов.data.Тип);\n//\tdata.package = Фабрика.Создать(ИерархияТипов.data.Package.Тип);\n//\tdata.package.packageId  = XMLСтрока(новый УникальныйИдентификатор);\n//\tdata.package.elements = Фабрика.Создать(ИерархияТипов.data.package.elements.Тип);\n/////////////////////////////////////////////////////////////////////////////\n// Параметры:\n//  Тип -      ТипОбъектаXDTO\n//  ПределРекурсии  - Число - Максимальная вложенность вызовов этой рекурсивной функции\n//  Глубина  - Число -  Служебный - не заполнять. Счетчик вложенности.\n//\n// Возвращаемое значение:\n//  Структура - Содержит Тип (ТипОбъектаXDTO) и перечень иерархий структур, соответствующий набору свойства переданного типа\n//\n// Пример:\n//   КорневойТип = Фабрика.Пакеты.Получить(\"urn://egisso-ru/msg/10.06.S/1.0.6\").КорневыеСвойства.Получить(\"data\").Тип;\n//   ИерархияТипов = Новый Структура(\"data\", ИерархияТиповXDTO(КорневойТип, 20));\n//   data = Фабрика.Создать(ИерархияТипов.data.Тип);\n//   data.package = Фабрика.Создать(ИерархияТипов.data.Package.Тип);\nФункция ИерархияТиповXDTO(Тип, ПределРекурсии = Неопределено,  Глубина = 1) Экспорт\n     Если ПределРекурсии <> Неопределено Тогда\n          Если Глубина > ПределРекурсии тогда\n               ВызватьИсключение \"Превышен предел на глубину рекурсии: Глубина = \" + Глубина + \"; Предел = \" + ПределРекурсии;\n          КонецЕсли;\n     КонецЕсли;\n     Результат = Новый Структура(\"Тип\", Тип);\n     Если ТипЗнч(Тип) = Тип(\"ТипОбъектаXDTO\") Тогда\n          Для каждого Свойство из Тип.Свойства Цикл\n               Результат.Вставить(Свойство.ЛокальноеИмя, ИерархияТиповXDTO(Свойство.Тип, ПределРекурсии, Глубина + 1));\n          КонецЦикла;\n     КонецЕсли;\n     Возврат Результат;\nКонецФункции\n\nОрфографическая ошибка в egisso (найдено 3): egisso"
  },
  {
    "title": "ФабрикаXDTO",
    "description": "ФабрикаXDTO",
    "code_snippet": "package = Фабрика.Создать(Фабрика.Тип(\"urn://egisso-ru/types/package-RAF/1.0.7\", \"tPackage\"));\npackage.packageId  = XMLСтрока(новый УникальныйИдентификатор);\n//package.elements = Фабрика.Создать(Фабрика.Тип(\"urn://egisso-ru/types/package-RAF/1.0.7\", \"elements\")); //???\n\nОрфографическая ошибка в egisso (найдено 2): egisso\r\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное.\n\nТипПакет = Фабрика.Тип(\"urn://egisso-ru/types/package-RAF/1.0.7\", \"tPackage\");\npackage = Фабрика.Создать(ТипПакет);\npackage.packageId  = XMLСтрока(новый УникальныйИдентификатор);\nТипЭлемент = ТипПакет.Свойства.Получить(\"elements\").Тип;\nТипФакт = ТипЭлемент.Свойства.Получить(\"fact\").Тип;"
  },
  {
    "title": "Вывести на печать произвольную таблицу значений (ТЗ)",
    "description": "Вывести на печать произвольную таблицу значений (ТЗ)",
    "code_snippet": "//вариант 1\r\n&НаКлиенте\r\nПроцедура ВывестиНаПечать(Команда)\r\n    ТабДок = ВывестиНаПечатьНаСервере();\r\n    ТабДок.Показать();\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nФункция ВывестиНаПечатьНаСервере()\r\n    ТЗ = РеквизитФормыВЗначение(\"Реквизит1\");\r\n    ПостроительОтчета = Новый ПостроительОтчета;\r\n    ПостроительОтчета.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТЗ);\r\n    \r\n    ТабДок = Новый ТабличныйДокумент;\r\n    ПостроительОтчета.Вывести(ТабДок);\r\n    Возврат ТабДок\r\nКонецФункции\r\n\r\n//вариант 2\r\n&НаКлиенте\r\nПроцедура ВывестиНаПечать2(Команда)\r\n    ТабДок = ВывестиНаПечатьНаСервере2();\r\n    ТабДок.Показать();    \r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nФункция ВывестиНаПечатьНаСервере2()\r\n    ТЗ = РеквизитФормыВЗначение(\"Реквизит1\");\r\n    \r\n    ТабДок = Новый ТабличныйДокумент;\r\n    Сч = 1;\r\n    Для Каждого Колонка Из ТЗ.Колонки Цикл\r\n        ТабДок.Область(1, Сч).Текст = Колонка.Имя;\r\n        Сч = Сч + 1\r\n    КонецЦикла;\r\n    \r\n    КоличествоКолонок = ТЗ.Колонки.Количество();\r\n    \r\n    ТекущаяСтрока = 2;\r\n    Для Каждого Стр Из ТЗ Цикл\r\n        Для Сч = 1 По КоличествоКолонок Цикл\r\n            ТабДок.Область(ТекущаяСтрока, Сч).Текст = Стр[Сч - 1];            \r\n        КонецЦикла;\r\n        ТекущаяСтрока = ТекущаяСтрока + 1;\r\n    КонецЦикла;\r\n    \r\n    Возврат ТабДок\r\nКонецФункции\n\n//вариант 1\r\n&НаКлиенте\r\nПроцедура ВывестиНаПечать(Команда)\r\n    ТабДок = ВывестиНаПечатьНаСервере();\r\n    ТабДок.Показать();\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nФункция ВывестиНаПечатьНаСервере()\r\n    ТЗ = РеквизитФормыВЗначение(\"Реквизит1\");\r\n    ПостроительОтчета = Новый ПостроительОтчета;\r\n    ПостроительОтчета.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТЗ);\r\n    \r\n    ТабДок = Новый ТабличныйДокумент;\r\n    ПостроительОтчета.Вывести(ТабДок);\r\n    Возврат ТабДок\r\nКонецФункции\r\n\r\n//вариант 2\r\n&НаКлиенте\r\nПроцедура ВывестиНаПечать2(Команда)\r\n    ТабДок = ВывестиНаПечатьНаСервере2();\r\n    ТабДок.Показать();    \r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nФункция ВывестиНаПечатьНаСервере2()\r\n    ТЗ = РеквизитФормыВЗначение(\"Реквизит1\");\r\n    \r\n    ТабДок = Новый ТабличныйДокумент;\r\n    Сч = 1;\r\n    Для Каждого Колонка Из ТЗ.Колонки Цикл\r\n        ТабДок.Область(1, Сч).Текст = Колонка.Имя;\r\n        Сч = Сч + 1\r\n    КонецЦикла;\r\n    \r\n    КоличествоКолонок = ТЗ.Колонки.Количество();\r\n    \r\n    ТекущаяСтрока = 2;\r\n    Для Каждого Стр Из ТЗ Цикл\r\n        Для Сч = 1 По КоличествоКолонок Цикл\r\n            ТабДок.Область(ТекущаяСтрока, Сч).Текст = Стр[Сч - 1];            \r\n        КонецЦикла;\r\n        ТекущаяСтрока = ТекущаяСтрока + 1;\r\n    КонецЦикла;\r\n    \r\n    Возврат ТабДок\r\nКонецФункции"
  },
  {
    "title": "Документ Регистратор При Проверке Записи",
    "description": "Документ Регистратор При Проверке Записи",
    "code_snippet": "&После(\"ПередПроверкойЗапретаИзменения\")\nПроцедура Расш1_ПередПроверкойЗапретаИзменения(Объект, ПроверкаЗапретаИзменения, УзелПроверкиЗапретаЗагрузки, ВерсияОбъекта)\n\tТипОбъекта=ТипЗнч(ДокументРегистраторПриПроверкеЗаписи(Объект));\n\tЕсли ТипОбъекта=Тип(\"ДокументСсылка.ЗаказПоставщику\") ИЛИ ТипОбъекта=Тип(\"ДокументОбъект.ЗаказПоставщику\") Тогда\n\t\tПроверкаЗапретаИзменения=Ложь //Пропустить проверку запрета изменения данных.\n\tКонецЕсли\nКонецПроцедуры\n\nФункция ДокументРегистраторПриПроверкеЗаписи(Объект)\n\t\n\tЕсли Объект.ДополнительныеСвойства.Свойство(\"РежимЗаписи\") Тогда\n\t\tОбъектМетаданных=Метаданные.НайтиПоТипу(ТипЗнч(Объект));\n\t\tЕсли Метаданные.Документы.Содержит(ОбъектМетаданных) Тогда\n\t\t    Класс=\"Документ\"\n\t\tИначеЕсли Метаданные.РегистрыНакопления.Содержит(ОбъектМетаданных) Тогда\n\t\t\tКласс=\"РегистрыНакопления\"\n\t\tИначе //Остальное не проверяем\n\t\t    Класс=\"\"\n\t\tКонецЕсли;\t\t\n\t\t\n\t\tЕсли Класс=\"\" Тогда Возврат \"\" КонецЕсли;\n\t\t\n\t\tЕсли Класс=\"Документ\" Тогда\n\t\t\tСсылкаПроверки=Объект.Ссылка;\n\t\tИначеЕсли Класс=\"РегистрыНакопления\" Тогда\n\t\t\tСсылкаПроверки=Объект.Отбор.Регистратор.Значение;\n\t\tКонецЕсли;\n\tКонецЕсли;\n\t\n\tВозврат СсылкаПроверки\n\t\nКонецФункции"
  },
  {
    "title": "Заполнение \"пустых\" строк табличной части",
    "description": "Заполнение \"пустых\" строк табличной части",
    "code_snippet": "&НаКлиенте\r\nПроцедура Подбор(Команда)\r\n\t\r\n\tПараметрыФормы = Новый Структура(\"МножественныйВыбор, ЗакрыватьПриВыборе\",Истина,Ложь);\r\n\tОткрытьФорму(\"Справочник.Номенклатура.ФормаВыбора\",ПараметрыФормы,Элементы.ТаблицаЗначений);\r\n\t// реквизиты: \r\n\t//Таблица значение - ТаблицаЗначений ( Одна колонка \"Материал\" )\r\n\t//Команда - \" Подбор \"\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nФункция ПоискПустыхСтрок(Таблица,КоличествоЗначений)\r\n\t\r\n\tМассивПустыхСтрок = Новый Массив(); // В данном массиве будут храниться индексы пустых записей \r\n\tСчетчикПустых = 0;\r\n\t\r\n\tДля Каждого Строка Из Таблица Цикл\r\n\t\tЕсли  (НЕ ЗначениеЗаполнено(Строка.Материал)) И (СчетчикПустых<КоличествоЗначений)  Тогда  // Проверяем на заполненность значение в колонке (текущей строки) в цикле И проверяем нужно ли дальше идти по циклу, ведь нам нужно лишь определенное кол пустых строк \r\n\t\t\tСчетчикПустых = СчетчикПустых+1; \r\n\t\t\tМассивПустыхСтрок.Добавить(Таблица.Индекс(Строка)); // Если значение в определенной колонке \"пустое\", то добавляем в массив  - индекс текущей строки в цикле \r\n\t\tИначеЕсли СчетчикПустых=КоличествоЗначений Тогда // Если кол пустых строк и кол значений введенных пользователем равно, то выходим из цикла и не ищем дополнительные пустые строки \r\n\t\t\tВозврат МассивПустыхСтрок;\r\n\t\tКонецЕсли;\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат МассивПустыхСтрок; \r\n\t\r\nКонецФункции \r\n\r\n&НаКлиенте\r\nПроцедура ТаблицаЗначенийОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)\r\n\t\t\r\n\tМассивПустыхСтрок = ПоискПустыхСтрок(ТаблицаЗначений,ВыбранноеЗначение.Количество()); // передаем саму таблицу, а также Кол выбранных элементов для того, чтобы не искать все пустые строки, а лишь определенное кол\r\n\t\r\n\tДля Индекс = 0 По ВыбранноеЗначение.ВГраница() Цикл\r\n\t\tЕсли Индекс < МассивПустыхСтрок.Количество() Тогда // Если выбранных значений меньше, чем пустых строк, то ..., иначе, исключительный случай, когда все пустые строки заполнились  \r\n\t\t\tСтрока = ТаблицаЗначений.Вставить(МассивПустыхСтрок[Индекс]); // Вставляем запись вместо пустой, вытесняя пустую запись вниз ( увеличиваем индекс пустой записи на 1, так как работает функция ВСТАВИТЬ() )\r\n\t\t\tСтрока.Материал = ВыбранноеЗначение[Индекс]; // Заполняем реквизит табличной части выбранным значением \r\n\t\t\tТаблицаЗначений.Удалить(МассивПустыхСтрок[Индекс]+1); // Удаляем пустую запись, которая ниже добавленной на 1 \r\n\t\tИначе\r\n\t\t\tСтрока = ТаблицаЗначений.Добавить(); // Тот самый случай, когда кол выбранных записей больше, чем пустых строк. В этом случаи  добавляем записи в конец табличной части\r\n\t\t\tСтрока.Материал = ВыбранноеЗначение[Индекс];\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\t\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура Подбор(Команда)\r\n\t\r\n\tПараметрыФормы = Новый Структура(\"МножественныйВыбор, ЗакрыватьПриВыборе\",Истина,Ложь);\r\n\tОткрытьФорму(\"Справочник.Номенклатура.ФормаВыбора\",ПараметрыФормы,Элементы.ТаблицаЗначений);\r\n\t// реквизиты: \r\n\t//Таблица значение - ТаблицаЗначений ( Одна колонка \"Материал\" )\r\n\t//Команда - \" Подбор \"\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nФункция ПоискПустыхСтрок(Таблица,КоличествоЗначений)\r\n\t\r\n\tМассивПустыхСтрок = Новый Массив(); // В данном массиве будут храниться индексы пустых записей \r\n\tСчетчикПустых = 0;\r\n\t\r\n\tДля Каждого Строка Из Таблица Цикл\r\n\t\tЕсли  (НЕ ЗначениеЗаполнено(Строка.Материал)) И (СчетчикПустых<КоличествоЗначений)  Тогда  // Проверяем на заполненность значение в колонке (текущей строки) в цикле И проверяем нужно ли дальше идти по циклу, ведь нам нужно лишь определенное кол пустых строк \r\n\t\t\tСчетчикПустых = СчетчикПустых+1; \r\n\t\t\tМассивПустыхСтрок.Добавить(Таблица.Индекс(Строка)); // Если значение в определенной колонке \"пустое\", то добавляем в массив  - индекс текущей строки в цикле \r\n\t\tИначеЕсли СчетчикПустых=КоличествоЗначений Тогда // Если кол пустых строк и кол значений введенных пользователем равно, то выходим из цикла и не ищем дополнительные пустые строки \r\n\t\t\tВозврат МассивПустыхСтрок;\r\n\t\tКонецЕсли;\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат МассивПустыхСтрок; \r\n\t\r\nКонецФункции \r\n\r\n&НаКлиенте\r\nПроцедура ТаблицаЗначенийОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)\r\n\t\t\r\n\tМассивПустыхСтрок = ПоискПустыхСтрок(ТаблицаЗначений,ВыбранноеЗначение.Количество()); // передаем саму таблицу, а также Кол выбранных элементов для того, чтобы не искать все пустые строки, а лишь определенное кол\r\n\t\r\n\tДля Индекс = 0 По ВыбранноеЗначение.ВГраница() Цикл\r\n\t\tЕсли Индекс < МассивПустыхСтрок.Количество() Тогда // Если выбранных значений меньше, чем пустых строк, то ..., иначе, исключительный случай, когда все пустые строки заполнились  \r\n\t\t\tСтрока = ТаблицаЗначений.Вставить(МассивПустыхСтрок[Индекс]); // Вставляем запись вместо пустой, вытесняя пустую запись вниз ( увеличиваем индекс пустой записи на 1, так как работает функция ВСТАВИТЬ() )\r\n\t\t\tСтрока.Материал = ВыбранноеЗначение[Индекс]; // Заполняем реквизит табличной части выбранным значением \r\n\t\t\tТаблицаЗначений.Удалить(МассивПустыхСтрок[Индекс]+1); // Удаляем пустую запись, которая ниже добавленной на 1 \r\n\t\tИначе\r\n\t\t\tСтрока = ТаблицаЗначений.Добавить(); // Тот самый случай, когда кол выбранных записей больше, чем пустых строк. В этом случаи  добавляем записи в конец табличной части\r\n\t\t\tСтрока.Материал = ВыбранноеЗначение[Индекс];\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Функция СодержимоеАрхива() и вспомогательная функция Путь()",
    "description": "Функция СодержимоеАрхива() и вспомогательная функция Путь()",
    "code_snippet": "// Возвращает путь к распакованному архиву и его содержимое\r\n//\r\n// Параметры:\r\n//  Архив - ЧтениеZipФайла, Строка, Неопределено - Архив; Путь к архиву; Если неопределенно, то спросит путь у пользователя\r\n//  Пароль - Строка\r\n// Возвращаемое значение:\r\n//   Структура   -  содержит:\r\n//\t* ВременныйПуть - Строка - путь к папке куда будет извлечено содержимое архива\r\n//\t* Архив  - ЧтениеZipФайл\r\n// Пример:\r\n//\tНаборСхемXML = Новый НаборСхемXML;\r\n//\tСодержимоеАрхива = СодержимоеАрхива();\r\n//\tДля Каждого ЭлементАрхива из СодержимоеАрхива.Архив.Элементы Цикл\r\n//\t\tЕсли ЭлементАрхива.Расширение = \"xsd\" Тогда\r\n//\t\t\tСхемаXML = СхемаXMLИзФайла(СодержимоеАрхива.ВременныйПуть +\"/\"+ ЭлементАрхива.ПолноеИмя);\r\n//\t\t\tНаборСхемXML.Добавить(СхемаXML);\r\n//\t\tКонецЕсли;\r\n//\tКонецЦикла;\r\nФункция СодержимоеАрхива(Архив = Неопределено, Пароль = Неопределено)    Экспорт \r\n\r\n\tЕсли ТипЗнч(Архив ) = Тип(\"ЧтениеZipФайла\") Тогда\r\n\t\tАрхив = Архив;\r\n\tИначеЕсли  ТипЗнч(Архив) = Тип(\"Строка\") Тогда\r\n\t\tАрхив = Новый ЧтениеZipФайла(Архив, Пароль);\r\n\tИначеЕсли Архив = Неопределено Тогда \r\n\t\tПуть = Путь(\"Выберите архив, содержащий схемы XML:\", \"(*.zip)|*.zip\", РежимДиалогаВыбораФайла.Открытие);\r\n\t\tЕсли Путь  = Неопределено Тогда\r\n\t\t\tВозврат Неопределено;\r\n\t\tКонецЕсли;\r\n\t\tАрхив = Новый ЧтениеZipФайла(Путь, Пароль);\r\n\tИначе\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\tРезультат = Новый Структура(\"Архив\", Архив);\r\n\tРезультат.Вставить(\"ВременныйПуть\",   КаталогВременныхФайлов() + \"ZIP_\" + Формат(ТекущаяДатаСеанса(),  \"ДФ=yyyyMMddHHmmss\"));\r\n\tАрхив.ИзвлечьВсе(Результат.ВременныйПуть);\r\n\tВозврат Результат;\r\nКонецФункции // СодержимоеАрхива()\r\n\r\n// Функция - открывает диалог выбора пути, возвращает результат выбора.\r\n//\r\n// Параметры:\r\n//  Заголовок     - Строка - НПР: \"Укажите путь к базе Поставщиков\"\r\n//  Фильтр         - Строка -    НПР: \"(*.txt)|*.txt\"\r\n//  Режим         - РежимДиалогаВыбораФайла - НПР: РежимДиалогаВыбораФайла.Открытие\r\n//  ИсходныйПуть - Строка - НПР: Путь чтобы выбор начинался в определённом месте\r\n//\r\n// Возвращаемое значение:\r\n//  Строка, Неопределено -  В случае успеха Путь в виде Строки, иначе Неопределено\r\n//\r\n// Пример:\r\n//  Элемент.Значение = Путь(\"Выберите путь к файлу с данными (xls):\",\"(*.xls*)|*.xls*\", РежимДиалогаВыбораФайла.Открытие, Элемент.Значение)\r\nФункция Путь(Заголовок, Фильтр, Режим, ИсходныйПуть = Неопределено) Экспорт\r\n    Результат = Неопределено;\r\n    ДиалогОткрытияФайла  = Новый ДиалогВыбораФайла (Режим);\r\n    //выбор начнётся по исходному пути?!\r\n    Если ИсходныйПуть <> Неопределено Тогда\r\n        Если Режим =  РежимДиалогаВыбораФайла.ВыборКаталога Тогда\r\n            ДиалогОткрытияФайла.Каталог = ИсходныйПуть;\r\n        ИначеЕсли  Режим = ДиалогОткрытияФайла.ПолноеИмяФайла  Тогда\r\n            ДиалогОткрытияФайла.ПолноеИмяФайла = ИсходныйПуть;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    ДиалогОткрытияФайла.ПолноеИмяФайла     = \"\";\r\n    ДиалогОткрытияФайла.МножественныйВыбор = Ложь;\r\n    ДиалогОткрытияФайла.Заголовок          = Заголовок;\r\n    ДиалогОткрытияФайла.Фильтр = Фильтр;\r\n    Успех = ДиалогОткрытияФайла.Выбрать();\r\n    Если Успех Тогда\r\n        Если Режим = РежимДиалогаВыбораФайла.ВыборКаталога Тогда\r\n            Результат = ДиалогОткрытияФайла.Каталог;\r\n        Иначе\r\n            Результат = ДиалогОткрытияФайла.ПолноеИмяФайла;\r\n        КонецЕсли;\r\n    Иначе\r\n        Результат = Неопределено;\r\n    КонецЕсли;\r\n    Возврат Результат;\r\nКонецФункции\n\n// Возвращает путь к распакованному архиву и его содержимое\r\n//\r\n// Параметры:\r\n//  Архив - ЧтениеZipФайла, Строка, Неопределено - Архив; Путь к архиву; Если неопределенно, то спросит путь у пользователя\r\n//  Пароль - Строка\r\n// Возвращаемое значение:\r\n//   Структура   -  содержит:\r\n//\t* ВременныйПуть - Строка - путь к папке куда будет извлечено содержимое архива\r\n//\t* Архив  - ЧтениеZipФайл\r\n// Пример:\r\n//\tНаборСхемXML = Новый НаборСхемXML;\r\n//\tСодержимоеАрхива = СодержимоеАрхива();\r\n//\tДля Каждого ЭлементАрхива из СодержимоеАрхива.Архив.Элементы Цикл\r\n//\t\tЕсли ЭлементАрхива.Расширение = \"xsd\" Тогда\r\n//\t\t\tСхемаXML = СхемаXMLИзФайла(СодержимоеАрхива.ВременныйПуть +\"/\"+ ЭлементАрхива.ПолноеИмя);\r\n//\t\t\tНаборСхемXML.Добавить(СхемаXML);\r\n//\t\tКонецЕсли;\r\n//\tКонецЦикла;\r\nФункция СодержимоеАрхива(Архив = Неопределено, Пароль = Неопределено)    Экспорт \r\n\r\n\tЕсли ТипЗнч(Архив ) = Тип(\"ЧтениеZipФайла\") Тогда\r\n\t\tАрхив = Архив;\r\n\tИначеЕсли  ТипЗнч(Архив) = Тип(\"Строка\") Тогда\r\n\t\tАрхив = Новый ЧтениеZipФайла(Архив, Пароль);\r\n\tИначеЕсли Архив = Неопределено Тогда \r\n\t\tПуть = Путь(\"Выберите архив, содержащий схемы XML:\", \"(*.zip)|*.zip\", РежимДиалогаВыбораФайла.Открытие);\r\n\t\tЕсли Путь  = Неопределено Тогда\r\n\t\t\tВозврат Неопределено;\r\n\t\tКонецЕсли;\r\n\t\tАрхив = Новый ЧтениеZipФайла(Путь, Пароль);\r\n\tИначе\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\tРезультат = Новый Структура(\"Архив\", Архив);\r\n\tРезультат.Вставить(\"ВременныйПуть\",   КаталогВременныхФайлов() + \"ZIP_\" + Формат(ТекущаяДатаСеанса(),  \"ДФ=yyyyMMddHHmmss\"));\r\n\tАрхив.ИзвлечьВсе(Результат.ВременныйПуть);\r\n\tВозврат Результат;\r\nКонецФункции // СодержимоеАрхива()\r\n\r\n// Функция - открывает диалог выбора пути, возвращает результат выбора.\r\n//\r\n// Параметры:\r\n//  Заголовок     - Строка - НПР: \"Укажите путь к базе Поставщиков\"\r\n//  Фильтр         - Строка -    НПР: \"(*.txt)|*.txt\"\r\n//  Режим         - РежимДиалогаВыбораФайла - НПР: РежимДиалогаВыбораФайла.Открытие\r\n//  ИсходныйПуть - Строка - НПР: Путь чтобы выбор начинался в определённом месте\r\n//\r\n// Возвращаемое значение:\r\n//  Строка, Неопределено -  В случае успеха Путь в виде Строки, иначе Неопределено\r\n//\r\n// Пример:\r\n//  Элемент.Значение = Путь(\"Выберите путь к файлу с данными (xls):\",\"(*.xls*)|*.xls*\", РежимДиалогаВыбораФайла.Открытие, Элемент.Значение)\r\nФункция Путь(Заголовок, Фильтр, Режим, ИсходныйПуть = Неопределено) Экспорт\r\n    Результат = Неопределено;\r\n    ДиалогОткрытияФайла  = Новый ДиалогВыбораФайла (Режим);\r\n    //выбор начнётся по исходному пути?!\r\n    Если ИсходныйПуть <> Неопределено Тогда\r\n        Если Режим =  РежимДиалогаВыбораФайла.ВыборКаталога Тогда\r\n            ДиалогОткрытияФайла.Каталог = ИсходныйПуть;\r\n        ИначеЕсли  Режим = ДиалогОткрытияФайла.ПолноеИмяФайла  Тогда\r\n            ДиалогОткрытияФайла.ПолноеИмяФайла = ИсходныйПуть;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    ДиалогОткрытияФайла.ПолноеИмяФайла     = \"\";\r\n    ДиалогОткрытияФайла.МножественныйВыбор = Ложь;\r\n    ДиалогОткрытияФайла.Заголовок          = Заголовок;\r\n    ДиалогОткрытияФайла.Фильтр = Фильтр;\r\n    Успех = ДиалогОткрытияФайла.Выбрать();\r\n    Если Успех Тогда\r\n        Если Режим = РежимДиалогаВыбораФайла.ВыборКаталога Тогда\r\n            Результат = ДиалогОткрытияФайла.Каталог;\r\n        Иначе\r\n            Результат = ДиалогОткрытияФайла.ПолноеИмяФайла;\r\n        КонецЕсли;\r\n    Иначе\r\n        Результат = Неопределено;\r\n    КонецЕсли;\r\n    Возврат Результат;\r\nКонецФункции"
  },
  {
    "title": "Получить дату из строки формата YYYY-MM-DDThh:mm:ss ISO 8601",
    "description": "Получить дату из строки формата YYYY-MM-DDThh:mm:ss ISO 8601",
    "code_snippet": "Функция ПолучитьДатуВеб(СтрДата)\r\n\t\r\n\tРез = Дата(1,1,1);\r\n\t\r\n\t//2018-03-19T23:59:59\r\n\tСтрГод = Сред(СтрДата, 1, 4);\r\n\tСтрМесяц = Сред(СтрДата, 6, 2);\r\n\tСтрЧисло = Сред(СтрДата, 9, 2);\r\n\tСтрЧас = Сред(СтрДата, 12, 2);\r\n\tСтрМинута = Сред(СтрДата, 15, 2);\r\n\tСтрСекунда = Сред(СтрДата, 18, 2);\r\n\t\r\n\tПопытка\r\n\t\tРез = Дата(Число(СтрГод), Число(СтрМесяц), Число(СтрЧисло), Число(СтрЧас), Число(СтрМинута), Число(СтрСекунда));\r\n\tИсключение\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат Рез;\r\n\t\r\nКонецФункции\n\nФункция ПолучитьДатуВеб(СтрДата)\r\n\t\r\n\tРез = Дата(1,1,1);\r\n\t\r\n\t//2018-03-19T23:59:59\r\n\tСтрГод = Сред(СтрДата, 1, 4);\r\n\tСтрМесяц = Сред(СтрДата, 6, 2);\r\n\tСтрЧисло = Сред(СтрДата, 9, 2);\r\n\tСтрЧас = Сред(СтрДата, 12, 2);\r\n\tСтрМинута = Сред(СтрДата, 15, 2);\r\n\tСтрСекунда = Сред(СтрДата, 18, 2);\r\n\t\r\n\tПопытка\r\n\t\tРез = Дата(Число(СтрГод), Число(СтрМесяц), Число(СтрЧисло), Число(СтрЧас), Число(СтрМинута), Число(СтрСекунда));\r\n\tИсключение\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат Рез;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Найти с/ф полученный",
    "description": "Найти с/ф полученный",
    "code_snippet": "Функция НайтиСФПолученный(ДокументОснование) Экспорт\r\n\t\r\n\tРез = Неопределено;\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t                  |\tСчетФактураПолученныйДокументыОснования.Ссылка КАК Ссылка\r\n\t                  |ИЗ\r\n\t                  |\tДокумент.СчетФактураПолученный.ДокументыОснования КАК СчетФактураПолученныйДокументыОснования\r\n\t                  |ГДЕ\r\n\t                  |\tСчетФактураПолученныйДокументыОснования.ДокументОснование = &ДокументОснование\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ДокументОснование\", ДокументОснование);\r\n\tВыборкаЗапроса = Запрос.Выполнить().Выбрать();\r\n\tЕсли ВыборкаЗапроса.Следующий() Тогда\r\n\t\tРез = ВыборкаЗапроса.Ссылка;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Рез;\r\n\t\r\nКонецФункции\n\nФункция НайтиСФПолученный(ДокументОснование) Экспорт\r\n\t\r\n\tРез = Неопределено;\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t                  |\tСчетФактураПолученныйДокументыОснования.Ссылка КАК Ссылка\r\n\t                  |ИЗ\r\n\t                  |\tДокумент.СчетФактураПолученный.ДокументыОснования КАК СчетФактураПолученныйДокументыОснования\r\n\t                  |ГДЕ\r\n\t                  |\tСчетФактураПолученныйДокументыОснования.ДокументОснование = &ДокументОснование\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ДокументОснование\", ДокументОснование);\r\n\tВыборкаЗапроса = Запрос.Выполнить().Выбрать();\r\n\tЕсли ВыборкаЗапроса.Следующий() Тогда\r\n\t\tРез = ВыборкаЗапроса.Ссылка;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Рез;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Найти с/ф выданный",
    "description": "Найти с/ф выданный",
    "code_snippet": "Функция НайтиСФВыданный(ДокументОснование) Экспорт\r\n\t\r\n\tРез = Неопределено;\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t                  |\tСчетФактураВыданныйДокументыОснования.Ссылка КАК Ссылка\r\n\t                  |ИЗ\r\n\t                  |\tДокумент.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования\r\n\t                  |ГДЕ\r\n\t                  |\tСчетФактураВыданныйДокументыОснования.Ссылка.Проведен\r\n\t                  |\tИ СчетФактураВыданныйДокументыОснования.ДокументОснование = &ДокументОснование\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ДокументОснование\", ДокументОснование);\r\n\tВыборкаЗапроса = Запрос.Выполнить().Выбрать();\r\n\tЕсли ВыборкаЗапроса.Следующий() Тогда\r\n\t\tРез = ВыборкаЗапроса.Ссылка;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Рез;\r\n\t\r\nКонецФункции\n\nФункция НайтиСФВыданный(ДокументОснование) Экспорт\r\n\t\r\n\tРез = Неопределено;\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t                  |\tСчетФактураВыданныйДокументыОснования.Ссылка КАК Ссылка\r\n\t                  |ИЗ\r\n\t                  |\tДокумент.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования\r\n\t                  |ГДЕ\r\n\t                  |\tСчетФактураВыданныйДокументыОснования.Ссылка.Проведен\r\n\t                  |\tИ СчетФактураВыданныйДокументыОснования.ДокументОснование = &ДокументОснование\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ДокументОснование\", ДокументОснование);\r\n\tВыборкаЗапроса = Запрос.Выполнить().Выбрать();\r\n\tЕсли ВыборкаЗапроса.Следующий() Тогда\r\n\t\tРез = ВыборкаЗапроса.Ссылка;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Рез;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Строка в дату по форматной строке",
    "description": "Строка в дату по форматной строке",
    "code_snippet": "Функция СтрокаВДату(ФорматДаты, Дано, Ошибка = Ложь)\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\tТестоваяДата = Формат('00010101', \"ДФ=\" + ФорматДаты); // — необязательная проверка первого правильности параметра\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tОшибка = Истина;\r\n\t\tВозврат '00010101';\r\n\t\t\r\n\tКонецПопытки;\r\n\t\r\n\tСтруктураДаты = Новый Соответствие;\r\n\t\r\n\tДля Счетчик = 1 По СтрДлина(ФорматДаты) + 7 Цикл\r\n\t\t\r\n\t\tСтруктураДаты[Сред(ФорматДаты + \"dMyHhms\", Счетчик, 1)] = 0; // — инициализация частей даты\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tДля Счетчик = 1 По 12 Цикл\r\n\t\t\r\n\t\tДано = СтрЗаменить(Дано, Формат(Дата(1, Счетчик, 1), \"ДФ=MMММ\"), Формат(Счетчик, \"ЧЦ=4; ЧВН=\")); // — замена названий месяцев числами\r\n\t\tДано = СтрЗаменить(Дано, Формат(Дата(1, Счетчик, 1), \"ДФ=MMМ\" ), Формат(Счетчик, \"ЧЦ=3; ЧВН=\"));\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tДля Счетчик = 1 По СтрДлина(ФорматДаты) Цикл\r\n\t\t\r\n\t\tСтруктураДаты[Сред(ФорматДаты, Счетчик, 1)] = 10 * СтруктураДаты[Сред(ФорматДаты, Счетчик, 1)] + Найти(\"123456789\", Сред(Дано, Счетчик, 1)); // — накопление частей даты\r\n\t\tОшибка = Ошибка ИЛИ Найти(\"dMyHhms\", Сред(ФорматДаты, Счетчик, 1)) И НЕ Найти(\"0123456789\", Сред(Дано, Счетчик, 1)); // — необязательная проверка на цифры\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tСтруктураДаты[\"y\"] = СтруктураДаты[\"y\"] + ?(СтруктураДаты[\"y\"] < 50, 2000, ?(СтруктураДаты[\"y\"] < 100, 1900, 0)); // — дополнение двух цифр года до четырех\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\tВозврат Дата(СтруктураДаты[\"y\"], СтруктураДаты[\"M\"], СтруктураДаты[\"d\"], СтруктураДаты[\"H\"] + СтруктураДаты[\"h\"], СтруктураДаты[\"m\"], СтруктураДаты[\"s\"])\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tОшибка = Истина;\r\n\t\tВозврат '00010101';\r\n\t\t\r\n\tКонецПопытки;\r\n\t\r\nКонецФункции\n\nФункция СтрокаВДату(ФорматДаты, Дано, Ошибка = Ложь)\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\tТестоваяДата = Формат('00010101', \"ДФ=\" + ФорматДаты); // — необязательная проверка первого правильности параметра\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tОшибка = Истина;\r\n\t\tВозврат '00010101';\r\n\t\t\r\n\tКонецПопытки;\r\n\t\r\n\tСтруктураДаты = Новый Соответствие;\r\n\t\r\n\tДля Счетчик = 1 По СтрДлина(ФорматДаты) + 7 Цикл\r\n\t\t\r\n\t\tСтруктураДаты[Сред(ФорматДаты + \"dMyHhms\", Счетчик, 1)] = 0; // — инициализация частей даты\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tДля Счетчик = 1 По 12 Цикл\r\n\t\t\r\n\t\tДано = СтрЗаменить(Дано, Формат(Дата(1, Счетчик, 1), \"ДФ=MMММ\"), Формат(Счетчик, \"ЧЦ=4; ЧВН=\")); // — замена названий месяцев числами\r\n\t\tДано = СтрЗаменить(Дано, Формат(Дата(1, Счетчик, 1), \"ДФ=MMМ\" ), Формат(Счетчик, \"ЧЦ=3; ЧВН=\"));\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tДля Счетчик = 1 По СтрДлина(ФорматДаты) Цикл\r\n\t\t\r\n\t\tСтруктураДаты[Сред(ФорматДаты, Счетчик, 1)] = 10 * СтруктураДаты[Сред(ФорматДаты, Счетчик, 1)] + Найти(\"123456789\", Сред(Дано, Счетчик, 1)); // — накопление частей даты\r\n\t\tОшибка = Ошибка ИЛИ Найти(\"dMyHhms\", Сред(ФорматДаты, Счетчик, 1)) И НЕ Найти(\"0123456789\", Сред(Дано, Счетчик, 1)); // — необязательная проверка на цифры\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tСтруктураДаты[\"y\"] = СтруктураДаты[\"y\"] + ?(СтруктураДаты[\"y\"] < 50, 2000, ?(СтруктураДаты[\"y\"] < 100, 1900, 0)); // — дополнение двух цифр года до четырех\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\tВозврат Дата(СтруктураДаты[\"y\"], СтруктураДаты[\"M\"], СтруктураДаты[\"d\"], СтруктураДаты[\"H\"] + СтруктураДаты[\"h\"], СтруктураДаты[\"m\"], СтруктураДаты[\"s\"])\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tОшибка = Истина;\r\n\t\tВозврат '00010101';\r\n\t\t\r\n\tКонецПопытки;\r\n\t\r\nКонецФункции\n\n{5} Переменной ТестоваяДата присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Добавить договор",
    "description": "Добавить договор",
    "code_snippet": "&НаСервере\r\nФункция СоздатьОсновнойДоговор(Организация, Контрагент, ВидДоговора, СделатьОсновным=Ложь)\r\n\t\r\n\tНовыйДоговор = Справочники.ДоговорыКонтрагентов.СоздатьЭлемент();\r\n\tНовыйДоговор.Организация = Организация;\r\n\tНовыйДоговор.Владелец = Контрагент;\r\n\tНовыйДоговор.ВидДоговора = ВидДоговора;\r\n\tНовыйДоговор.ВалютаВзаиморасчетов = Константы.ВалютаРегламентированногоУчета.Получить();\r\n\tНовыйДоговор.Наименование = ВидДоговора;\r\n\t\r\n\tПопытка\r\n\t\tНовыйДоговор.Записать();\r\n\tИсключение\r\n\t\tТекстОшибки = СтрШаблон(\"Не удалось сохранить новый договор для контрагента %1 по виду договора %2 для организации %3\", Контрагент, ВидДоговора, Организация);\r\n\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстОшибки);\r\n\t\tВозврат Справочники.ДоговорыКонтрагентов.ПустаяСсылка();\r\n\tКонецПопытки;\r\n\t\r\n\tЕсли СделатьОсновным Тогда\r\n\t\tСтруктураПараметров = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(НовыйДоговор.Ссылка, \"Организация, ВидДоговора, Владелец\");\r\n\t\tНоваяЗапись = РегистрыСведений.ОсновныеДоговорыКонтрагента.СоздатьМенеджерЗаписи();\r\n\t\tНоваяЗапись.Организация = СтруктураПараметров.Организация;\r\n\t\tНоваяЗапись.Контрагент  = СтруктураПараметров.Владелец;\r\n\t\tНоваяЗапись.ВидДоговора = СтруктураПараметров.ВидДоговора;\r\n\t\tНоваяЗапись.Договор     = НовыйДоговор;\r\n\t\t\r\n\t\tПопытка\r\n\t\t\tНоваяЗапись.Записать(Истина);\r\n\t\tИсключение\r\n\t\t\tТекстОшибки = СтрШаблон(\"Не удалось указать договор %1 основным для контрагента %2\", НовыйДоговор, Контрагент);\r\n\t\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстОшибки);\r\n\t\tКонецПопытки;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат НовыйДоговор.Ссылка;\r\nКонецФункции\n\n&НаСервере\r\nФункция СоздатьОсновнойДоговор(Организация, Контрагент, ВидДоговора, СделатьОсновным=Ложь)\r\n\t\r\n\tНовыйДоговор = Справочники.ДоговорыКонтрагентов.СоздатьЭлемент();\r\n\tНовыйДоговор.Организация = Организация;\r\n\tНовыйДоговор.Владелец = Контрагент;\r\n\tНовыйДоговор.ВидДоговора = ВидДоговора;\r\n\tНовыйДоговор.ВалютаВзаиморасчетов = Константы.ВалютаРегламентированногоУчета.Получить();\r\n\tНовыйДоговор.Наименование = ВидДоговора;\r\n\t\r\n\tПопытка\r\n\t\tНовыйДоговор.Записать();\r\n\tИсключение\r\n\t\tТекстОшибки = СтрШаблон(\"Не удалось сохранить новый договор для контрагента %1 по виду договора %2 для организации %3\", Контрагент, ВидДоговора, Организация);\r\n\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстОшибки);\r\n\t\tВозврат Справочники.ДоговорыКонтрагентов.ПустаяСсылка();\r\n\tКонецПопытки;\r\n\t\r\n\tЕсли СделатьОсновным Тогда\r\n\t\tСтруктураПараметров = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(НовыйДоговор.Ссылка, \"Организация, ВидДоговора, Владелец\");\r\n\t\tНоваяЗапись = РегистрыСведений.ОсновныеДоговорыКонтрагента.СоздатьМенеджерЗаписи();\r\n\t\tНоваяЗапись.Организация = СтруктураПараметров.Организация;\r\n\t\tНоваяЗапись.Контрагент  = СтруктураПараметров.Владелец;\r\n\t\tНоваяЗапись.ВидДоговора = СтруктураПараметров.ВидДоговора;\r\n\t\tНоваяЗапись.Договор     = НовыйДоговор;\r\n\t\t\r\n\t\tПопытка\r\n\t\t\tНоваяЗапись.Записать(Истина);\r\n\t\tИсключение\r\n\t\t\tТекстОшибки = СтрШаблон(\"Не удалось указать договор %1 основным для контрагента %2\", НовыйДоговор, Контрагент);\r\n\t\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстОшибки);\r\n\t\tКонецПопытки;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат НовыйДоговор.Ссылка;\r\nКонецФункции"
  },
  {
    "title": "Найти основной договор",
    "description": "Найти основной договор",
    "code_snippet": "&НаСервере\r\nФункция ПолучитьОсновнойДоговор(Организация, Контрагент, ВидДоговора)\r\n\t\r\n\tРез = Справочники.ДоговорыКонтрагентов.ПустаяСсылка();\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t|\tОсновныеДоговорыКонтрагента.Договор КАК Договор\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ОсновныеДоговорыКонтрагента КАК ОсновныеДоговорыКонтрагента\r\n\t\t|ГДЕ\r\n\t\t|\tОсновныеДоговорыКонтрагента.Организация = &Организация\r\n\t\t|\tИ ОсновныеДоговорыКонтрагента.Контрагент = &Контрагент\r\n\t\t|\tИ ОсновныеДоговорыКонтрагента.ВидДоговора = &ВидДоговора\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ВидДоговора\", ВидДоговора);\r\n\tЗапрос.УстановитьПараметр(\"Контрагент\", Контрагент);\r\n\tЗапрос.УстановитьПараметр(\"Организация\", Организация);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tЕсли ВыборкаДетальныеЗаписи.Следующий() Тогда\r\n\t\tРез = ВыборкаДетальныеЗаписи.Договор;\r\n\tКонецЕсли;\r\n\t\r\n\t//если основной договор не отмечен, то поищем среди всех договоров и если по данному виду он один и непомеченный на удаление, то возьмем его\r\n\t\r\n\tЕсли Рез.Пустая() Тогда\r\n\t\tЗапрос.Текст = \r\n\t\t\t\"ВЫБРАТЬ\r\n\t\t\t|\tМАКСИМУМ(ДоговорыКонтрагентов.Ссылка) КАК Договор,\r\n\t\t\t|\tКОЛИЧЕСТВО(РАЗЛИЧНЫЕ ДоговорыКонтрагентов.Ссылка) КАК КоличествоДоговоров\r\n\t\t\t|ИЗ\r\n\t\t\t|\tСправочник.ДоговорыКонтрагентов КАК ДоговорыКонтрагентов\r\n\t\t\t|ГДЕ\r\n\t\t\t|\tДоговорыКонтрагентов.Владелец = &Контрагент\r\n\t\t\t|\tИ ДоговорыКонтрагентов.ВидДоговора = &ВидДоговора\r\n\t\t\t|\tИ ДоговорыКонтрагентов.Организация = &Организация\r\n\t\t\t|\tИ НЕ ДоговорыКонтрагентов.ПометкаУдаления\";\r\n\t\t\r\n\t\tЗапрос.УстановитьПараметр(\"ВидДоговора\", ВидДоговора);\r\n\t\tЗапрос.УстановитьПараметр(\"Контрагент\", Контрагент);\r\n\t\tЗапрос.УстановитьПараметр(\"Организация\", Организация);\r\n\t\t\r\n\t\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\t\r\n\t\tЕсли ВыборкаДетальныеЗаписи.Следующий() Тогда\r\n\t\t\tЕсли ВыборкаДетальныеЗаписи.КоличествоДоговоров=1 Тогда\r\n\t\t\t\tРез = ВыборкаДетальныеЗаписи.Договор;\r\n\t\t\tИначеЕсли ВыборкаДетальныеЗаписи.КоличествоДоговоров=0 Тогда\r\n\t\t\t\tРез = СоздатьОсновнойДоговор(Организация, Контрагент, ВидДоговора);\r\n\t\t\tИначеЕсли ВыборкаДетальныеЗаписи.КоличествоДоговоров>1 Тогда\r\n\t\t\t\tРез = ВыборкаДетальныеЗаписи.Договор;\r\n\t\t\t\tТекстОшибки = СтрШаблон(\"Для контрагента %1 подставлен первый договор из нескольких по виду %2 для организации %3\", Контрагент, ВидДоговора, Организация);\r\n\t\t\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстОшибки);\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Рез;\r\n\r\nКонецФункции\n\n&НаСервере\r\nФункция ПолучитьОсновнойДоговор(Организация, Контрагент, ВидДоговора)\r\n\t\r\n\tРез = Справочники.ДоговорыКонтрагентов.ПустаяСсылка();\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t|\tОсновныеДоговорыКонтрагента.Договор КАК Договор\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ОсновныеДоговорыКонтрагента КАК ОсновныеДоговорыКонтрагента\r\n\t\t|ГДЕ\r\n\t\t|\tОсновныеДоговорыКонтрагента.Организация = &Организация\r\n\t\t|\tИ ОсновныеДоговорыКонтрагента.Контрагент = &Контрагент\r\n\t\t|\tИ ОсновныеДоговорыКонтрагента.ВидДоговора = &ВидДоговора\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ВидДоговора\", ВидДоговора);\r\n\tЗапрос.УстановитьПараметр(\"Контрагент\", Контрагент);\r\n\tЗапрос.УстановитьПараметр(\"Организация\", Организация);\r\n\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tЕсли ВыборкаДетальныеЗаписи.Следующий() Тогда\r\n\t\tРез = ВыборкаДетальныеЗаписи.Договор;\r\n\tКонецЕсли;\r\n\t\r\n\t//если основной договор не отмечен, то поищем среди всех договоров и если по данному виду он один и непомеченный на удаление, то возьмем его\r\n\t\r\n\tЕсли Рез.Пустая() Тогда\r\n\t\tЗапрос.Текст = \r\n\t\t\t\"ВЫБРАТЬ\r\n\t\t\t|\tМАКСИМУМ(ДоговорыКонтрагентов.Ссылка) КАК Договор,\r\n\t\t\t|\tКОЛИЧЕСТВО(РАЗЛИЧНЫЕ ДоговорыКонтрагентов.Ссылка) КАК КоличествоДоговоров\r\n\t\t\t|ИЗ\r\n\t\t\t|\tСправочник.ДоговорыКонтрагентов КАК ДоговорыКонтрагентов\r\n\t\t\t|ГДЕ\r\n\t\t\t|\tДоговорыКонтрагентов.Владелец = &Контрагент\r\n\t\t\t|\tИ ДоговорыКонтрагентов.ВидДоговора = &ВидДоговора\r\n\t\t\t|\tИ ДоговорыКонтрагентов.Организация = &Организация\r\n\t\t\t|\tИ НЕ ДоговорыКонтрагентов.ПометкаУдаления\";\r\n\t\t\r\n\t\tЗапрос.УстановитьПараметр(\"ВидДоговора\", ВидДоговора);\r\n\t\tЗапрос.УстановитьПараметр(\"Контрагент\", Контрагент);\r\n\t\tЗапрос.УстановитьПараметр(\"Организация\", Организация);\r\n\t\t\r\n\t\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\t\r\n\t\tЕсли ВыборкаДетальныеЗаписи.Следующий() Тогда\r\n\t\t\tЕсли ВыборкаДетальныеЗаписи.КоличествоДоговоров=1 Тогда\r\n\t\t\t\tРез = ВыборкаДетальныеЗаписи.Договор;\r\n\t\t\tИначеЕсли ВыборкаДетальныеЗаписи.КоличествоДоговоров=0 Тогда\r\n\t\t\t\tРез = СоздатьОсновнойДоговор(Организация, Контрагент, ВидДоговора);\r\n\t\t\tИначеЕсли ВыборкаДетальныеЗаписи.КоличествоДоговоров>1 Тогда\r\n\t\t\t\tРез = ВыборкаДетальныеЗаписи.Договор;\r\n\t\t\t\tТекстОшибки = СтрШаблон(\"Для контрагента %1 подставлен первый договор из нескольких по виду %2 для организации %3\", Контрагент, ВидДоговора, Организация);\r\n\t\t\t\tОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстОшибки);\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Рез;\r\n\r\nКонецФункции"
  },
  {
    "title": "decorator",
    "description": "Библиотека для создания оберток (прокси) над классами.",
    "code_snippet": ""
  },
  {
    "title": "Отключение (DETACH) баз MS SQL с отбором по вхождению в имя",
    "description": "Отключение (DETACH) баз MS SQL с отбором по вхождению в имя",
    "code_snippet": "```\r\n/*******************************************************\r\n Отключение (DETACH) баз MS SQL с отбором по вхождению в имя\r\n*******************************************************/\r\n\r\nDECLARE @SQL VARCHAR(max)  = ''\r\n\r\nDECLARE @StrNewLine CHAR\r\nSET @StrNewLine = CHAR(10) + CHAR(13)\r\n\r\nSELECT \r\n\t@SQL += 'alter database ['+ name + '] SET  SINGLE_USER WITH ROLLBACK IMMEDIATE' + '' + @StrNewLine\r\n\t--+ 'GO' + @StrNewLine\r\n\t+ 'EXEC master.dbo.sp_detach_db @dbname = '+ name + ';' + @StrNewLine\r\n\r\nfrom master.sys.databases AS SysDB\r\nWHERE SysDB.name LIKE 'tvs_%'\r\n\r\nPRINT @SQL\r\nEXEC (@SQL)\r\n```\n\n```\r\n/*******************************************************\r\n Отключение (DETACH) баз MS SQL с отбором по вхождению в имя\r\n*******************************************************/\r\n\r\nDECLARE @SQL VARCHAR(max)  = ''\r\n\r\nDECLARE @StrNewLine CHAR\r\nSET @StrNewLine = CHAR(10) + CHAR(13)\r\n\r\nSELECT \r\n\t@SQL += 'alter database ['+ name + '] SET  SINGLE_USER WITH ROLLBACK IMMEDIATE' + '' + @StrNewLine\r\n\t--+ 'GO' + @StrNewLine\r\n\t+ 'EXEC master.dbo.sp_detach_db @dbname = '+ name + ';' + @StrNewLine\r\n\r\nfrom master.sys.databases AS SysDB\r\nWHERE SysDB.name LIKE 'tvs_%'\r\n\r\nPRINT @SQL\r\nEXEC (@SQL)\r\n```\n\n{} Ожидается идентификатор\r\nОрфографическая ошибка в dbname: dbname"
  },
  {
    "title": "Заполнить счета учета",
    "description": "Заполнить счета учета",
    "code_snippet": "Документы.ПоступлениеТоваровУслуг.ЗаполнитьСчетаУчетаВТабличнойЧасти(ДокОб, \"Товары\");\r\nДокументы.ПоступлениеТоваровУслуг.ЗаполнитьСчетаУчетаВТабличнойЧасти(ДокОб, \"Услуги\");\r\nДокументы.ПоступлениеТоваровУслуг.ЗаполнитьСчетаУчетаРасчетов(ДокОб);\r\n\r\n// Для детального разбора используем\r\nСчетаУчета = БухгалтерскийУчетПереопределяемый.ПолучитьСчетаУчетаНоменклатуры(Организация, Номенклатура, Склад);\n\nДокументы.ПоступлениеТоваровУслуг.ЗаполнитьСчетаУчетаВТабличнойЧасти(ДокОб, \"Товары\");\r\nДокументы.ПоступлениеТоваровУслуг.ЗаполнитьСчетаУчетаВТабличнойЧасти(ДокОб, \"Услуги\");\r\nДокументы.ПоступлениеТоваровУслуг.ЗаполнитьСчетаУчетаРасчетов(ДокОб);\r\n\r\n// Для детального разбора используем\r\nСчетаУчета = БухгалтерскийУчетПереопределяемый.ПолучитьСчетаУчетаНоменклатуры(Организация, Номенклатура, Склад);\n\n{6} Переменной СчетаУчета присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Проверка, есть ли ключ у соответствия",
    "description": "Проверка, есть ли ключ у соответствия",
    "code_snippet": "Функция ЕстьКлючСоответствия(Объект, Ключ) Экспорт\r\n  Если Объект[Ключ] <> Неопределено Тогда\r\n    Возврат Истина;\r\n  КонецЕсли;\r\n  До = Объект.Количество();\r\n  Объект.Вставить(Ключ);\r\n  После = Объект.Количество();\r\n  Если До <> После Тогда\r\n    Объект.Удалить(Ключ);\r\n  КонецЕсли;\r\n  Возврат До = После;\r\nКонецФункции\n\nФункция ЕстьКлючСоответствия(Объект, Ключ) Экспорт\r\n  Если Объект[Ключ] <> Неопределено Тогда\r\n    Возврат Истина;\r\n  КонецЕсли;\r\n  До = Объект.Количество();\r\n  Объект.Вставить(Ключ);\r\n  После = Объект.Количество();\r\n  Если До <> После Тогда\r\n    Объект.Удалить(Ключ);\r\n  КонецЕсли;\r\n  Возврат До = После;\r\nКонецФункции"
  },
  {
    "title": "Таблица значений в табличный документ",
    "description": "Таблица значений в табличный документ",
    "code_snippet": "// Получить табличный документ на основании таблицы значений\r\n//\r\n// Параметры:\r\n//  Таблица - ТаблицаЗначений \r\n// \r\n// Возвращаемое значение:\r\n//  ТабличныйДокумент \r\n//\r\n&НаСервере\r\nФункция ПолучитьТабличныйДокумент(Таблица)\r\n    ТабДокумент = Новый ТабличныйДокумент;\r\n            \r\n    // Выводим заголовок таблицы\r\n    КолонкаИндекс = 0;\r\n    Пока КолонкаИндекс < Таблица.Колонки.Количество() Цикл\r\n        Колонка = Таблица.Колонки[КолонкаИндекс];\r\n\t\tОбластьКолонки = ТабДокумент.Область(1, КолонкаИндекс + 1, 1, КолонкаИндекс + 1);\r\n\t\tЕсли ПустаяСтрока(Колонка.Заголовок) Тогда\r\n\t\t\tОбластьКолонки.Текст = Колонка.Имя;\r\n\t\tИначе\r\n\t\t\tОбластьКолонки.Текст = Колонка.Заголовок;\r\n\t\tКонецЕсли;\r\n\t\tОбластьКолонки.ШиринаКолонки = Колонка.Ширина;\r\n        КолонкаИндекс = КолонкаИндекс + 1;\r\n    КонецЦикла;\r\n    \r\n    // Выводим строки таблицы\r\n    СтрокаИндекс = 0;\r\n    Пока СтрокаИндекс < Таблица.Количество() Цикл\r\n        Таблица_Строка = Таблица[СтрокаИндекс];\r\n        КолонкаИндекс = 0;\r\n        Пока КолонкаИндекс < Таблица.Колонки.Количество() Цикл\r\n            Колонка = Таблица.Колонки[КолонкаИндекс];\r\n            ТабДокумент.Область(СтрокаИндекс + 2, КолонкаИндекс + 1, СтрокаИндекс + 2, КолонкаИндекс + 1).Текст = Таблица_Строка[Колонка.Имя];  // + 2, т.к. в первой строке выведен заголовок\r\n            КолонкаИндекс = КолонкаИндекс + 1;\r\n        КонецЦикла;        \r\n        СтрокаИндекс = СтрокаИндекс + 1;\r\n    КонецЦикла;\r\n    \r\n    Возврат ТабДокумент;\r\nКонецФункции\n\n// Получить табличный документ на основании таблицы значений\r\n//\r\n// Параметры:\r\n//  Таблица - ТаблицаЗначений \r\n// \r\n// Возвращаемое значение:\r\n//  ТабличныйДокумент \r\n//\r\n&НаСервере\r\nФункция ПолучитьТабличныйДокумент(Таблица)\r\n    ТабДокумент = Новый ТабличныйДокумент;\r\n            \r\n    // Выводим заголовок таблицы\r\n    КолонкаИндекс = 0;\r\n    Пока КолонкаИндекс < Таблица.Колонки.Количество() Цикл\r\n        Колонка = Таблица.Колонки[КолонкаИндекс];\r\n\t\tОбластьКолонки = ТабДокумент.Область(1, КолонкаИндекс + 1, 1, КолонкаИндекс + 1);\r\n\t\tЕсли ПустаяСтрока(Колонка.Заголовок) Тогда\r\n\t\t\tОбластьКолонки.Текст = Колонка.Имя;\r\n\t\tИначе\r\n\t\t\tОбластьКолонки.Текст = Колонка.Заголовок;\r\n\t\tКонецЕсли;\r\n\t\tОбластьКолонки.ШиринаКолонки = Колонка.Ширина;\r\n        КолонкаИндекс = КолонкаИндекс + 1;\r\n    КонецЦикла;\r\n    \r\n    // Выводим строки таблицы\r\n    СтрокаИндекс = 0;\r\n    Пока СтрокаИндекс < Таблица.Количество() Цикл\r\n        Таблица_Строка = Таблица[СтрокаИндекс];\r\n        КолонкаИндекс = 0;\r\n        Пока КолонкаИндекс < Таблица.Колонки.Количество() Цикл\r\n            Колонка = Таблица.Колонки[КолонкаИндекс];\r\n            ТабДокумент.Область(СтрокаИндекс + 2, КолонкаИндекс + 1, СтрокаИндекс + 2, КолонкаИндекс + 1).Текст = Таблица_Строка[Колонка.Имя];  // + 2, т.к. в первой строке выведен заголовок\r\n            КолонкаИндекс = КолонкаИндекс + 1;\r\n        КонецЦикла;        \r\n        СтрокаИндекс = СтрокаИндекс + 1;\r\n    КонецЦикла;\r\n    \r\n    Возврат ТабДокумент;\r\nКонецФункции"
  },
  {
    "title": "Выгрузка Таблицы значений в Объект Таблица Значений на форме обработки (для передачи сервер - клиент)",
    "description": "Выгрузка Таблицы значений в Объект Таблица Значений на форме обработки (для передачи сервер - клиент)",
    "code_snippet": "&НаСервере\r\nПроцедура ЗаполнитьНаСервере()\r\n\t// Вставить содержимое обработчика.\r\n\tЗапрос= новый запрос;\r\n\tЗапрос.Текст=\"ВЫБРАТЬ\r\n\t             |\tОстаткиНоменклатурыОстатки.Номеклатура КАК Номеклатура,\r\n\t             |\tОстаткиНоменклатурыОстатки.КоличестовОстаток КАК КоличестовОстаток,\r\n\t             |\tОстаткиНоменклатурыОстатки.СуммаОстаток КАК СуммаОстаток\r\n\t             |ИЗ\r\n\t             |\tРегистрНакопления.ОстаткиНоменклатуры.Остатки КАК ОстаткиНоменклатурыОстатки\";\r\n\t//выборка=запрос.Выполнить().Выбрать();\r\n\t\r\n\t//создаем ТаблицуЗначений ТЗ\r\n\tТЗ=новый ТаблицаЗначений;\r\n\t//Выгружаем Результат Запроса в Таблицу Значений ТЗ \r\n\tТЗ=запрос.Выполнить().Выгрузить();\r\n\t//создаем ТаблицуЗначений ТЗрез\r\n\tТЗрез=новый ТаблицаЗначений;\r\n\t//в ТаблицуЗначений ТЗрез выгружаем данные с формы\r\n\tТЗрез=данныеформывзначение(Объект.Результат,Тип(\"ТаблицаЗначений\"));\r\n\t//В ТаблицуЗначений ТЗрез сохраняем ТЗ \r\n\tТЗрез=ТЗ;\r\n\t//Записываем значения Таблицы ТЗрез в объект на форме.\r\n\tЗначениеВданныеФормы(ТЗрез,объект.Результат);\r\n\t\r\n\t//данныевреквизитформы(Тзрез,\"Результат0\");\r\n\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ЗаполнитьНаСервере()\r\n\t// Вставить содержимое обработчика.\r\n\tЗапрос= новый запрос;\r\n\tЗапрос.Текст=\"ВЫБРАТЬ\r\n\t             |\tОстаткиНоменклатурыОстатки.Номеклатура КАК Номеклатура,\r\n\t             |\tОстаткиНоменклатурыОстатки.КоличестовОстаток КАК КоличестовОстаток,\r\n\t             |\tОстаткиНоменклатурыОстатки.СуммаОстаток КАК СуммаОстаток\r\n\t             |ИЗ\r\n\t             |\tРегистрНакопления.ОстаткиНоменклатуры.Остатки КАК ОстаткиНоменклатурыОстатки\";\r\n\t//выборка=запрос.Выполнить().Выбрать();\r\n\t\r\n\t//создаем ТаблицуЗначений ТЗ\r\n\tТЗ=новый ТаблицаЗначений;\r\n\t//Выгружаем Результат Запроса в Таблицу Значений ТЗ \r\n\tТЗ=запрос.Выполнить().Выгрузить();\r\n\t//создаем ТаблицуЗначений ТЗрез\r\n\tТЗрез=новый ТаблицаЗначений;\r\n\t//в ТаблицуЗначений ТЗрез выгружаем данные с формы\r\n\tТЗрез=данныеформывзначение(Объект.Результат,Тип(\"ТаблицаЗначений\"));\r\n\t//В ТаблицуЗначений ТЗрез сохраняем ТЗ \r\n\tТЗрез=ТЗ;\r\n\t//Записываем значения Таблицы ТЗрез в объект на форме.\r\n\tЗначениеВданныеФормы(ТЗрез,объект.Результат);\r\n\t\r\n\t//данныевреквизитформы(Тзрез,\"Результат0\");\r\n\r\nКонецПроцедуры\n\n{14} Переменной ТЗ присвоено значение, но оно нигде не используется\r\n{18} Переменной ТЗрез присвоено значение, но оно нигде не используется\r\n{20} Переменной ТЗрез присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в Номеклатура (найдено 2): Номеклатура\r\nОрфографическая ошибка в КоличестовОстаток (найдено 2): Количестов\r\nОрфографическая ошибка в данныеформывзначение: данныеформывзначение\r\nОрфографическая ошибка в данныевреквизитформы: данныевреквизитформы\r\nОрфографическая ошибка в Тзрез: Тзрез"
  },
  {
    "title": "Telegram 1C. Полный разбор API. Курс",
    "description": "Разберись со всеми возможностями API Telegram при работе из 1С",
    "code_snippet": ""
  },
  {
    "title": "Заполнить параметры запроса из структуры",
    "description": "Заполнить параметры запроса из структуры",
    "code_snippet": "//пПараметрыЗапроса - структура с данными для запроса\r\nПараметрыЗапроса=Запрос.НайтиПараметры();\r\nДля Каждого ПараметрЗапроса Из пПараметрыЗапроса Цикл\r\n\tЕсли ПараметрыЗапроса.Найти(ПараметрЗапроса.Ключ)<>Неопределено Тогда\r\n\t\tЗапрос.УстановитьПараметр(ПараметрЗапроса.Ключ, ПараметрЗапроса.Значение)\r\n\tКонецЕсли\r\nКонецЦикла;\n\n//пПараметрыЗапроса - структура с данными для запроса\r\nПараметрыЗапроса=Запрос.НайтиПараметры();\r\nДля Каждого ПараметрЗапроса Из пПараметрыЗапроса Цикл\r\n\tЕсли ПараметрыЗапроса.Найти(ПараметрЗапроса.Ключ)<>Неопределено Тогда\r\n\t\tЗапрос.УстановитьПараметр(ПараметрЗапроса.Ключ, ПараметрЗапроса.Значение)\r\n\tКонецЕсли\r\nКонецЦикла;"
  },
  {
    "title": "Проверка заполненности полей объекта и возврат статуса + незаполненных полей",
    "description": "Проверка заполненности полей объекта и возврат статуса + незаполненных полей",
    "code_snippet": "#Область ПроверкаЗаполненностиПолей\r\nФункция ПроверкаЗаполненностиРеквизитовОбъекта(ОбъектПроверки, ПоляПроверкиШапки = \"Дата, Номер\", ПоляПроверкиТЧ = \"Номенклатура, Количество\", ИмяТЧ = \"Товары\") Экспорт\r\n    НеЗаполненныеПоля = \"\";\r\n    Результат         = Ложь;\r\n    \r\n    РезультатПроверкиШапки = ПоляЗаполнены(ОбъектПроверки, ПоляПроверкиШапки);\r\n    РезультатПроверкиТЧ    = ПоляЗаполнены(ОбъектПроверки[ИмяТЧ], ПоляПроверкиТЧ);\r\n    \r\n    Результат = ?(РезультатПроверкиШапки = Ложь Или РезультатПроверкиТЧ = Ложь, Ложь, Истина);\r\n    \r\n    Возврат Новый Структура(\"Результат, НеЗаполненныеПоля\", Результат, НеЗаполненныеПоля);\r\nКонецФункции\r\n\r\nФункция ПоляЗаполнены(ОбъектПроверки, ПоляПроверки, НеЗаполненныеПоля = \"\") Экспорт\r\n    \r\n    Результат = Истина;\r\n    \r\n    ПоляПроверкиМассив = СтрРазделить(ПоляПроверки, \",\", Ложь);\r\n    Для Каждого Поле Из ПоляПроверкиМассив Цикл\r\n        Поле         = СокрЛП(Поле);\r\n        ЗначениеПоля = ОбъектПроверки[Поле];\r\n        \r\n        Если ЗначениеЗаполнено(ЗначениеПоля) Тогда\r\n            Продолжить;\r\n        КонецЕсли;\r\n        \r\n        Результат = Ложь;\r\n        НеЗаполненныеПоля = ?(НеЗаполненныеПоля = \"\", \"\", \", \") + Поле;\r\n    КонецЦикла;\r\n\r\n    Возврат Результат;\r\nКонецФункции\r\n#КонецОбласти\n\n#Область ПроверкаЗаполненностиПолей\r\nФункция ПроверкаЗаполненностиРеквизитовОбъекта(ОбъектПроверки, ПоляПроверкиШапки = \"Дата, Номер\", ПоляПроверкиТЧ = \"Номенклатура, Количество\", ИмяТЧ = \"Товары\") Экспорт\r\n    НеЗаполненныеПоля = \"\";\r\n    Результат         = Ложь;\r\n    \r\n    РезультатПроверкиШапки = ПоляЗаполнены(ОбъектПроверки, ПоляПроверкиШапки);\r\n    РезультатПроверкиТЧ    = ПоляЗаполнены(ОбъектПроверки[ИмяТЧ], ПоляПроверкиТЧ);\r\n    \r\n    Результат = ?(РезультатПроверкиШапки = Ложь Или РезультатПроверкиТЧ = Ложь, Ложь, Истина);\r\n    \r\n    Возврат Новый Структура(\"Результат, НеЗаполненныеПоля\", Результат, НеЗаполненныеПоля);\r\nКонецФункции\r\n\r\nФункция ПоляЗаполнены(ОбъектПроверки, ПоляПроверки, НеЗаполненныеПоля = \"\") Экспорт\r\n    \r\n    Результат = Истина;\r\n    \r\n    ПоляПроверкиМассив = СтрРазделить(ПоляПроверки, \",\", Ложь);\r\n    Для Каждого Поле Из ПоляПроверкиМассив Цикл\r\n        Поле         = СокрЛП(Поле);\r\n        ЗначениеПоля = ОбъектПроверки[Поле];\r\n        \r\n        Если ЗначениеЗаполнено(ЗначениеПоля) Тогда\r\n            Продолжить;\r\n        КонецЕсли;\r\n        \r\n        Результат = Ложь;\r\n        НеЗаполненныеПоля = ?(НеЗаполненныеПоля = \"\", \"\", \", \") + Поле;\r\n    КонецЦикла;\r\n\r\n    Возврат Результат;\r\nКонецФункции\r\n#КонецОбласти"
  },
  {
    "title": "Реквизиты Объекта в Структуру",
    "description": "Реквизиты Объекта в Структуру",
    "code_snippet": "&НаСервере\r\nФункция РеквизитыОбъектаВСтруктуру()\r\n\r\n\tРезультат = Новый Структура;\r\n\r\n\tДанныеОбъекта = РеквизитФормыВЗначение(\"Объект\");\r\n\tМДОбъекта = ДанныеОбъекта.Метаданные();\r\n\r\n\tДля Каждого ТекРеквизит Из МДОбъекта.Реквизиты Цикл\r\n\t\tРезультат.Вставить(ТекРеквизит.Имя, ДанныеОбъекта[ТекРеквизит.Имя])\r\n\tКонецЦикла;\r\n\r\n\tВозврат Результат\r\n\r\nКонецФункции\n\n&НаСервере\r\nФункция РеквизитыОбъектаВСтруктуру()\r\n\r\n\tРезультат = Новый Структура;\r\n\r\n\tДанныеОбъекта = РеквизитФормыВЗначение(\"Объект\");\r\n\tМДОбъекта = ДанныеОбъекта.Метаданные();\r\n\r\n\tДля Каждого ТекРеквизит Из МДОбъекта.Реквизиты Цикл\r\n\t\tРезультат.Вставить(ТекРеквизит.Имя, ДанныеОбъекта[ТекРеквизит.Имя])\r\n\tКонецЦикла;\r\n\r\n\tВозврат Результат\r\n\r\nКонецФункции"
  },
  {
    "title": "Проверка типа данных на принадлежность к ссылочным типам",
    "description": "Проверка типа данных на принадлежность к ссылочным типам",
    "code_snippet": "Функция ЭтоТипСсылка(ТипДанных, ВсеТипыСсылок = Неопределено) Экспорт\r\n    Результат = Ложь;\r\n    \r\n    Если ВсеТипыСсылок = Неопределено Тогда\r\n        ВсеТипыСсылок = ОписаниеТипаВсеСсылки();\r\n    КонецЕсли;\r\n    \r\n    Если ТипЗнч(ТипДанных) = Тип(\"ОписаниеТипов\") Тогда\r\n        ТипыВнутри = ТипДанных.Типы();\r\n        Для каждого Тип Из ТипыВнутри Цикл\r\n            Если ВсеТипыСсылок.СодержитТип(Тип) Тогда\r\n                Результат = Истина;\r\n            КонецЕсли;\r\n        КонецЦикла;\r\n    Иначе \r\n        Если ВсеТипыСсылок.СодержитТип(ТипДанных) Тогда\r\n            Результат = Истина;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    \r\n    Возврат Результат;\r\nКонецФункции\n\nФункция ЭтоТипСсылка(ТипДанных, ВсеТипыСсылок = Неопределено) Экспорт\r\n    Результат = Ложь;\r\n    \r\n    Если ВсеТипыСсылок = Неопределено Тогда\r\n        ВсеТипыСсылок = ОписаниеТипаВсеСсылки();\r\n    КонецЕсли;\r\n    \r\n    Если ТипЗнч(ТипДанных) = Тип(\"ОписаниеТипов\") Тогда\r\n        ТипыВнутри = ТипДанных.Типы();\r\n        Для каждого Тип Из ТипыВнутри Цикл\r\n            Если ВсеТипыСсылок.СодержитТип(Тип) Тогда\r\n                Результат = Истина;\r\n            КонецЕсли;\r\n        КонецЦикла;\r\n    Иначе \r\n        Если ВсеТипыСсылок.СодержитТип(ТипДанных) Тогда\r\n            Результат = Истина;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    \r\n    Возврат Результат;\r\nКонецФункции"
  },
  {
    "title": "Создать Таблицу значений со структурой по данным источника",
    "description": "Создать Таблицу значений со структурой по данным источника",
    "code_snippet": "Функция ПустаяТаблицаЗначенийПоКолонкамИсточника(Данные, ДобавлятьСсылочныеТипы = Истина) Экспорт \r\n    Перем ВсеТипыСсылок; //для кэширования\r\n    \r\n    Если ТипЗнч(Данные) = Тип(\"РезультатЗапроса\") Или ТипЗнч(Данные) = Тип(\"ТаблицаЗначений\") Или ТипЗнч(Данные) = Тип(\"ВременнаяТаблицаЗапроса\") Тогда\r\n        КолонкиЗапроса = Данные.Колонки;\r\n    Иначе\r\n        Возврат Неопределено;\r\n    КонецЕсли;\r\n    \r\n    Результат = Новый ТаблицаЗначений;\r\n    КолонкиТЗ = Результат.Колонки;\r\n    \r\n    Для Каждого ТекущаяКолонкаЗапроса Из КолонкиЗапроса Цикл\r\n        Если ДобавлятьСсылочныеТипы = Ложь Тогда\r\n            Если ЭтоТипСсылка(ТекущаяКолонкаЗапроса.ТипЗначения, ВсеТипыСсылок) Тогда\r\n                Продолжить;\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n            \r\n        НоваяКолонкаТЗ = КолонкиТЗ.Добавить(ТекущаяКолонкаЗапроса.Имя, ТекущаяКолонкаЗапроса.ТипЗначения);\r\n        ЗаполнитьЗначенияСвойств(НоваяКолонкаТЗ, ТекущаяКолонкаЗапроса);\r\n    КонецЦикла; \r\n    \r\n    Возврат Результат;\r\nКонецФункции\r\n\r\nФункция ЭтоТипСсылка(ТипДанных, ВсеТипыСсылок = Неопределено) Экспорт\r\n    Результат = Ложь;\r\n    \r\n    Если ВсеТипыСсылок = Неопределено Тогда\r\n        ВсеТипыСсылок = ОписаниеТипаВсеСсылки();\r\n    КонецЕсли;\r\n    \r\n    Если ТипЗнч(ТипДанных) = Тип(\"ОписаниеТипов\") Тогда\r\n        ТипыВнутри = ТипДанных.Типы();\r\n        Для каждого Тип Из ТипыВнутри Цикл\r\n            Если ВсеТипыСсылок.СодержитТип(Тип) Тогда\r\n                Результат = Истина;\r\n            КонецЕсли;\r\n        КонецЦикла;\r\n    КонецЕсли;\r\n    \r\n    Возврат Результат;\r\nКонецФункции\n\nФункция ПустаяТаблицаЗначенийПоКолонкамИсточника(Данные, ДобавлятьСсылочныеТипы = Истина) Экспорт \r\n    Перем ВсеТипыСсылок; //для кэширования\r\n    \r\n    Если ТипЗнч(Данные) = Тип(\"РезультатЗапроса\") Или ТипЗнч(Данные) = Тип(\"ТаблицаЗначений\") Или ТипЗнч(Данные) = Тип(\"ВременнаяТаблицаЗапроса\") Тогда\r\n        КолонкиЗапроса = Данные.Колонки;\r\n    Иначе\r\n        Возврат Неопределено;\r\n    КонецЕсли;\r\n    \r\n    Результат = Новый ТаблицаЗначений;\r\n    КолонкиТЗ = Результат.Колонки;\r\n    \r\n    Для Каждого ТекущаяКолонкаЗапроса Из КолонкиЗапроса Цикл\r\n        Если ДобавлятьСсылочныеТипы = Ложь Тогда\r\n            Если ЭтоТипСсылка(ТекущаяКолонкаЗапроса.ТипЗначения, ВсеТипыСсылок) Тогда\r\n                Продолжить;\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n            \r\n        НоваяКолонкаТЗ = КолонкиТЗ.Добавить(ТекущаяКолонкаЗапроса.Имя, ТекущаяКолонкаЗапроса.ТипЗначения);\r\n        ЗаполнитьЗначенияСвойств(НоваяКолонкаТЗ, ТекущаяКолонкаЗапроса);\r\n    КонецЦикла; \r\n    \r\n    Возврат Результат;\r\nКонецФункции\r\n\r\nФункция ЭтоТипСсылка(ТипДанных, ВсеТипыСсылок = Неопределено) Экспорт\r\n    Результат = Ложь;\r\n    \r\n    Если ВсеТипыСсылок = Неопределено Тогда\r\n        ВсеТипыСсылок = ОписаниеТипаВсеСсылки();\r\n    КонецЕсли;\r\n    \r\n    Если ТипЗнч(ТипДанных) = Тип(\"ОписаниеТипов\") Тогда\r\n        ТипыВнутри = ТипДанных.Типы();\r\n        Для каждого Тип Из ТипыВнутри Цикл\r\n            Если ВсеТипыСсылок.СодержитТип(Тип) Тогда\r\n                Результат = Истина;\r\n            КонецЕсли;\r\n        КонецЦикла;\r\n    КонецЕсли;\r\n    \r\n    Возврат Результат;\r\nКонецФункции"
  },
  {
    "title": "Универсальные процедуры для работы с логами",
    "description": "Универсальные процедуры для работы с логами",
    "code_snippet": "#Область Логирование\r\n// Процедура - Добавляет к логу данные действуя в зависимости от типа (строка или массив)\r\n//\r\n// Параметры:\r\n//  Лог         - Массив, Строка - Лог\r\n//  Данные     - Строка - Данные для добавления\r\n//\r\nПроцедура ДобавитьВЛог(Лог, Данные) Экспорт\r\n    Если ТипЗнч(Лог) = Тип(\"Строка\") Тогда\r\n        Лог = Лог + ?(Лог = \"\", \"\", Символы.ПС) + Данные;\r\n    ИначеЕсли ТипЗнч(Лог) = Тип(\"Массив\") Тогда\r\n        Лог.Добавить(Данные);\r\n    ИначеЕсли ТипЗнч(Лог) = Тип(\"ТекстовыйДокумент\") Тогда        \r\n        лог.ДобавитьСтроку(Данные);\r\n    ИначеЕсли ТипЗнч(Лог) = Тип(\"Неопределено\") Тогда //по умолчанию лог это массив\r\n        Лог = Новый Массив;\r\n        Лог.Добавить(Данные);\r\n    КонецЕсли;\r\nКонецПроцедуры\r\n\r\nПроцедура ДобавитьВЛогЗаголовок(Лог, Данные) Экспорт\r\n    \r\n    РазделительЛога = \"--------------------------------------------------------------------------\";\r\n    Если ТипЗнч(Лог) = Тип(\"Массив\")  Тогда\r\n        СтрокВЛоге = Лог.Количество();\r\n        \r\n        Если СтрокВЛоге > 0 Тогда\r\n            ПоследняяСтрокаЛога = Лог.Получить(СтрокВЛоге - 1);\r\n            Если РазделительЛога <> ПоследняяСтрокаЛога Тогда\r\n                ДобавитьВЛог(Лог, РазделительЛога);\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    \r\n    ДобавитьВЛог(Лог, Данные);\r\n    ДобавитьВЛог(Лог, РазделительЛога);\r\nКонецПроцедуры\r\n#КонецОбласти\r\n\r\n//быстрая запись в строку из массива для большого объема строк\r\nФункция МассивСтрокВСтроку(Строки) Экспорт \r\n    \r\n    Запись = Новый ЗаписьXML;\r\n    Запись.УстановитьСтроку();\r\n    Для Каждого ТекущаяСтрока Из Строки Цикл\r\n        Запись.ЗаписатьБезОбработки(ТекущаяСтрока + Символы.ПС);\r\n        \r\n    КонецЦикла;\r\n    \r\n    Возврат Запись.Закрыть();\r\nКонецФункции\r\n\r\nФункция ЛогСтрокой(Лог) Экспорт\r\n    \r\n    Если ТипЗнч(Лог) = Тип(\"ТекстовыйДокумент\") Тогда\r\n        Лог.ПолучитьТекст();\r\n    ИначеЕсли ТипЗнч(Лог) = Тип(\"Массив\") Тогда\r\n        Результат = МассивСтрокВСтроку(Лог);\r\n    ИначеЕсли ТипЗнч(Лог) = Тип(\"Строка\") Тогда\r\n        Результат = Лог;\r\n    КонецЕсли;\r\n    \r\n    Возврат Результат;\r\nКонецФункции\n\n#Область Логирование\r\n// Процедура - Добавляет к логу данные действуя в зависимости от типа (строка или массив)\r\n//\r\n// Параметры:\r\n//  Лог         - Массив, Строка - Лог\r\n//  Данные     - Строка - Данные для добавления\r\n//\r\nПроцедура ДобавитьВЛог(Лог, Данные) Экспорт\r\n    Если ТипЗнч(Лог) = Тип(\"Строка\") Тогда\r\n        Лог = Лог + ?(Лог = \"\", \"\", Символы.ПС) + Данные;\r\n    ИначеЕсли ТипЗнч(Лог) = Тип(\"Массив\") Тогда\r\n        Лог.Добавить(Данные);\r\n    ИначеЕсли ТипЗнч(Лог) = Тип(\"ТекстовыйДокумент\") Тогда        \r\n        лог.ДобавитьСтроку(Данные);\r\n    ИначеЕсли ТипЗнч(Лог) = Тип(\"Неопределено\") Тогда //по умолчанию лог это массив\r\n        Лог = Новый Массив;\r\n        Лог.Добавить(Данные);\r\n    КонецЕсли;\r\nКонецПроцедуры\r\n\r\nПроцедура ДобавитьВЛогЗаголовок(Лог, Данные) Экспорт\r\n    \r\n    РазделительЛога = \"--------------------------------------------------------------------------\";\r\n    Если ТипЗнч(Лог) = Тип(\"Массив\")  Тогда\r\n        СтрокВЛоге = Лог.Количество();\r\n        \r\n        Если СтрокВЛоге > 0 Тогда\r\n            ПоследняяСтрокаЛога = Лог.Получить(СтрокВЛоге - 1);\r\n            Если РазделительЛога <> ПоследняяСтрокаЛога Тогда\r\n                ДобавитьВЛог(Лог, РазделительЛога);\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    \r\n    ДобавитьВЛог(Лог, Данные);\r\n    ДобавитьВЛог(Лог, РазделительЛога);\r\nКонецПроцедуры\r\n#КонецОбласти\r\n\r\n//быстрая запись в строку из массива для большого объема строк\r\nФункция МассивСтрокВСтроку(Строки) Экспорт \r\n    \r\n    Запись = Новый ЗаписьXML;\r\n    Запись.УстановитьСтроку();\r\n    Для Каждого ТекущаяСтрока Из Строки Цикл\r\n        Запись.ЗаписатьБезОбработки(ТекущаяСтрока + Символы.ПС);\r\n        \r\n    КонецЦикла;\r\n    \r\n    Возврат Запись.Закрыть();\r\nКонецФункции\r\n\r\nФункция ЛогСтрокой(Лог) Экспорт\r\n    \r\n    Если ТипЗнч(Лог) = Тип(\"ТекстовыйДокумент\") Тогда\r\n        Лог.ПолучитьТекст();\r\n    ИначеЕсли ТипЗнч(Лог) = Тип(\"Массив\") Тогда\r\n        Результат = МассивСтрокВСтроку(Лог);\r\n    ИначеЕсли ТипЗнч(Лог) = Тип(\"Строка\") Тогда\r\n        Результат = Лог;\r\n    КонецЕсли;\r\n    \r\n    Возврат Результат;\r\nКонецФункции\n\nОрфографическая ошибка в Логирование: Логирование\r\nОрфографическая ошибка в Неопределено: Неопределено"
  },
  {
    "title": "WooCommerce 1C. Интеграция 1C с интернет магазином на WordPress. Курс",
    "description": "WooCommerce 1с. Научись интегрировать 1С с популярным интернет магазином на WordPress",
    "code_snippet": ""
  },
  {
    "title": "Запрос в SQL базу",
    "description": "Запрос в SQL базу",
    "code_snippet": "// Возвращает результат запроса в таблице значений.\r\n//\r\n// Параметры:\r\n//  Connection\t - COMОбъект(\"ADODB.Connection\"), коннект к бд (необязательный).\r\n//  SQLText      - текст, текст запроса.\r\n//  ДанныеДляПодключения - структура, формируется в СоздатьДанныеДляПодключения() (необязательный).\r\n//\r\nФункция ПолучитьРезультатЗапроса(SQLText, ДанныеДляПодключения = Неопределено, Connection = Неопределено) Экспорт\r\n\t\r\n\tЕсли Connection = Неопределено Тогда\r\n\t\tConnection = НовоеСоединениеССУБД(ДанныеДляПодключения);\r\n\tКонецЕсли;\r\n\t\r\n\tRecordSet                = Новый ComObject(\"ADODB.RecordSet\");\r\n\tRecordSet.CursorLocation = 3;\r\n\tRecordSet.LockType       = 3;\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\tRecordSet.Open(SQLText, Connection);\r\n\t\t\r\n\t\tТЗ = Новый ТаблицаЗначений;\r\n\t\tКоличествоПолей = RecordSet.Fields.Count;\r\n\t\t\r\n\t\tДля НомерСтолбца = 0 По КоличествоПолей - 1 Цикл // Создание и добавление колонок во временную таблицу\r\n\t\t\t\r\n\t\t\tИмяСтолбца = RecordSet.Fields.Item(НомерСтолбца).Name;\r\n\t\t\tТЗ.Колонки.Добавить(RecordSet.Fields.Item(НомерСтолбца).Name, SQLТипВ1СТип(RecordSet.Fields.Item(НомерСтолбца).Type, RecordSet.Fields.Item(НомерСтолбца).DefinedSize));\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tПока НЕ RecordSet.EOF Цикл // Заполнение созданной таблицы\r\n\t\t\t\r\n\t\t\tНоваяСтрока = ТЗ.Добавить();\r\n\t\t\t\r\n\t\t\tДля ПолеСч = 0 По КоличествоПолей - 1 Цикл\r\n\t\t\t\t\r\n\t\t\t\tПоле = RecordSet.Fields.item(ПолеСч);\r\n\t\t\t\tНоваяСтрока[Поле.name] = Поле.Value;\r\n\t\t\t\t\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tRecordSet.MoveNext();\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tRecordSet.Close();\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tЗаписьЖурналаРегистрации(НСтр(\"ru = 'Запрос в SQL базу \" + ДанныеДляПодключения.ИмяБД + \"'\"), УровеньЖурналаРегистрации.Ошибка, , , \"Ошибка выполнения запроса: \" + SQLText + Символы.ПС + ОписаниеОшибки());\r\n\t\tТЗ = Неопределено; \r\n\t\t\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат ТЗ;\r\n\t\r\nКонецФункции\r\n\r\nФункция НовоеСоединениеССУБД(ДанныеДляПодключения) Экспорт \r\n\t\r\n\tCon = Новый COMОбъект(\"ADODB.Connection\");\r\n\tСтрокаПодключения = \"Provider=SQLOLEDB; Data Source=\" + ДанныеДляПодключения.АдресСервера + \";Initial Catalog=\" \r\n\t+ ДанныеДляПодключения.ИмяБД + \";Persist Security Info=True;User ID=\" + ДанныеДляПодключения.Логин + \";Password=\" + ДанныеДляПодключения.Пароль;\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\tCon.ConnectionTimeOut = 15;\r\n\t\tCon.CommandTimeout = 220;\r\n\t\tCon.Open(СтрокаПодключения);\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tЗаписьЖурналаРегистрации(НСтр(\"ru = 'Соединение с SQL базой \" + ДанныеДляПодключения.ИмяБД + \"'\"), УровеньЖурналаРегистрации.Ошибка, , , ОписаниеОшибки());\r\n\t\tCon = Неопределено;\r\n\t\t\r\n\tКонецПопытки;\r\n\tВозврат Con;\r\n\t\r\nКонецФункции\r\n\r\nФункция SQLТипВ1СТип(Num, size)\r\n\t\r\n\tПараметрыСтроки = Новый КвалификаторыСтроки(size);\r\n\t\r\n\tЕсли\r\n\t\tNum = 20 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\");\r\n\tИначеЕсли\r\n\t\tNum = 128 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Булево\");\r\n\tИначеЕсли\r\n\t\tNum = 8 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки);\r\n\tИначеЕсли\r\n\t\tNum = 136 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки);\r\n\tИначеЕсли\r\n\t\tNum = 129 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки);\r\n\tИначеЕсли\r\n\t\tNum = 7 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Дата\");\r\n\tИначеЕсли\r\n\t\tNum = 133 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Дата\");\r\n\tИначеЕсли\r\n\t\tNum = 134 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Дата\");\r\n\tИначеЕсли\r\n\t\tNum = 135 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Дата\");\r\n\tИначеЕсли\r\n\t\tNum = 14 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\");\r\n\tИначеЕсли\r\n\t\tNum = 0 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка,  , , , ПараметрыСтроки\"); // adEmpty 0 no value\r\n\tИначеЕсли\r\n\t\tNum = 3 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adInteger 3 4 - byte signed integer\r\n\tИначеЕсли\r\n\t\tNum = 205 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка,  , , , ПараметрыСтроки\"); // adLongVarBinary 205 Long binary value\r\n\tИначеЕсли\r\n\t\tNum = 201 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка,  , , , ПараметрыСтроки\"); // adLongVarChar 201 Long string value\r\n\tИначеЕсли\r\n\t\tNum = 203 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка,  , , , ПараметрыСтроки\"); // adLongVarWChar 203 Long Null - terminates string value\r\n\tИначеЕсли\r\n\t\tNum = 131 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adNumeric 131 Number with fixed precision and scale\r\n\tИначеЕсли\r\n\t\tNum = 5 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\");\r\n\tИначеЕсли\r\n\t\tNum = 4 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adSingle 4 Single - precision floating - point value\r\n\tИначеЕсли\r\n\t\tNum = 2 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adSmallInt 2 2 - byte signed integer\r\n\tИначеЕсли\r\n\t\tNum = 16 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adTinyInt 16 1 - byte signed integer\r\n\tИначеЕсли\r\n\t\tNum = 21 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adUnsignedBigInt 21 8 - byte unsigned integer\r\n\tИначеЕсли\r\n\t\tNum = 19 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adUnsignedInt 19 4 - byte unsigned integer\r\n\tИначеЕсли\r\n\t\tNum = 18 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adUnsignedSmallInt 18 2 - byte unsigned integer\r\n\tИначеЕсли\r\n\t\tNum = 17 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adUnsignedTinyInt 17 1 - byte unsigned integer\r\n\tИначеЕсли\r\n\t\tNum = 132 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adUserDefined 132 User - defined variable\r\n\tИначеЕсли\r\n\t\tNum = 204 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки); // adVarBinary 204 Binary value\r\n\tИначеЕсли\r\n\t\tNum = 12 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adVariant 12 Automation variant\r\n\tИначеЕсли\r\n\t\tNum = 139 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adVarNumeric 139 Variable width exact numeric with signed scale\r\n\tИначеЕсли\r\n\t\tNum = 202 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки); // adVarWChar 202 Null - terminated Unicode character string\r\n\tИначеЕсли\r\n\t\tNum = 130 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки); // adWChar 130\r\n\tИначеЕсли\r\n\t\tNum = 200 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки);\r\n\tИначе\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\");\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает структуру с данными для НовоеСоединениеССУБД().\r\n//\r\n// Параметры:\r\n//  АдресСервера\t - текст, адрес сервера.\r\n//  ИмяБД      - текст, текст имя базы данных.\r\n//  Логин - текст, логин.\r\n//  Пароль - текст, пароль.\r\n//\r\nФункция СоздатьДанныеДляПодключения(АдресСервера, ИмяБД, Логин, Пароль) Экспорт\r\n\t\r\n\tДанныеДляПодключения = Новый Структура(\"АдресСервера, ИмяБД, Логин, Пароль\", АдресСервера, ИмяБД, Логин, Пароль);\r\n\tВозврат ДанныеДляПодключения;\r\n\t\r\nКонецФункции\n\n// Возвращает результат запроса в таблице значений.\r\n//\r\n// Параметры:\r\n//  Connection\t - COMОбъект(\"ADODB.Connection\"), коннект к бд (необязательный).\r\n//  SQLText      - текст, текст запроса.\r\n//  ДанныеДляПодключения - структура, формируется в СоздатьДанныеДляПодключения() (необязательный).\r\n//\r\nФункция ПолучитьРезультатЗапроса(SQLText, ДанныеДляПодключения = Неопределено, Connection = Неопределено) Экспорт\r\n\t\r\n\tЕсли Connection = Неопределено Тогда\r\n\t\tConnection = НовоеСоединениеССУБД(ДанныеДляПодключения);\r\n\tКонецЕсли;\r\n\t\r\n\tRecordSet                = Новый ComObject(\"ADODB.RecordSet\");\r\n\tRecordSet.CursorLocation = 3;\r\n\tRecordSet.LockType       = 3;\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\tRecordSet.Open(SQLText, Connection);\r\n\t\t\r\n\t\tТЗ = Новый ТаблицаЗначений;\r\n\t\tКоличествоПолей = RecordSet.Fields.Count;\r\n\t\t\r\n\t\tДля НомерСтолбца = 0 По КоличествоПолей - 1 Цикл // Создание и добавление колонок во временную таблицу\r\n\t\t\t\r\n\t\t\tИмяСтолбца = RecordSet.Fields.Item(НомерСтолбца).Name;\r\n\t\t\tТЗ.Колонки.Добавить(RecordSet.Fields.Item(НомерСтолбца).Name, SQLТипВ1СТип(RecordSet.Fields.Item(НомерСтолбца).Type, RecordSet.Fields.Item(НомерСтолбца).DefinedSize));\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tПока НЕ RecordSet.EOF Цикл // Заполнение созданной таблицы\r\n\t\t\t\r\n\t\t\tНоваяСтрока = ТЗ.Добавить();\r\n\t\t\t\r\n\t\t\tДля ПолеСч = 0 По КоличествоПолей - 1 Цикл\r\n\t\t\t\t\r\n\t\t\t\tПоле = RecordSet.Fields.item(ПолеСч);\r\n\t\t\t\tНоваяСтрока[Поле.name] = Поле.Value;\r\n\t\t\t\t\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tRecordSet.MoveNext();\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tRecordSet.Close();\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tЗаписьЖурналаРегистрации(НСтр(\"ru = 'Запрос в SQL базу \" + ДанныеДляПодключения.ИмяБД + \"'\"), УровеньЖурналаРегистрации.Ошибка, , , \"Ошибка выполнения запроса: \" + SQLText + Символы.ПС + ОписаниеОшибки());\r\n\t\tТЗ = Неопределено; \r\n\t\t\r\n\tКонецПопытки;\r\n\t\r\n\tВозврат ТЗ;\r\n\t\r\nКонецФункции\r\n\r\nФункция НовоеСоединениеССУБД(ДанныеДляПодключения) Экспорт \r\n\t\r\n\tCon = Новый COMОбъект(\"ADODB.Connection\");\r\n\tСтрокаПодключения = \"Provider=SQLOLEDB; Data Source=\" + ДанныеДляПодключения.АдресСервера + \";Initial Catalog=\" \r\n\t+ ДанныеДляПодключения.ИмяБД + \";Persist Security Info=True;User ID=\" + ДанныеДляПодключения.Логин + \";Password=\" + ДанныеДляПодключения.Пароль;\r\n\t\r\n\tПопытка\r\n\t\t\r\n\t\tCon.ConnectionTimeOut = 15;\r\n\t\tCon.CommandTimeout = 220;\r\n\t\tCon.Open(СтрокаПодключения);\r\n\t\t\r\n\tИсключение\r\n\t\t\r\n\t\tЗаписьЖурналаРегистрации(НСтр(\"ru = 'Соединение с SQL базой \" + ДанныеДляПодключения.ИмяБД + \"'\"), УровеньЖурналаРегистрации.Ошибка, , , ОписаниеОшибки());\r\n\t\tCon = Неопределено;\r\n\t\t\r\n\tКонецПопытки;\r\n\tВозврат Con;\r\n\t\r\nКонецФункции\r\n\r\nФункция SQLТипВ1СТип(Num, size)\r\n\t\r\n\tПараметрыСтроки = Новый КвалификаторыСтроки(size);\r\n\t\r\n\tЕсли\r\n\t\tNum = 20 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\");\r\n\tИначеЕсли\r\n\t\tNum = 128 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Булево\");\r\n\tИначеЕсли\r\n\t\tNum = 8 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки);\r\n\tИначеЕсли\r\n\t\tNum = 136 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки);\r\n\tИначеЕсли\r\n\t\tNum = 129 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки);\r\n\tИначеЕсли\r\n\t\tNum = 7 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Дата\");\r\n\tИначеЕсли\r\n\t\tNum = 133 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Дата\");\r\n\tИначеЕсли\r\n\t\tNum = 134 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Дата\");\r\n\tИначеЕсли\r\n\t\tNum = 135 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Дата\");\r\n\tИначеЕсли\r\n\t\tNum = 14 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\");\r\n\tИначеЕсли\r\n\t\tNum = 0 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка,  , , , ПараметрыСтроки\"); // adEmpty 0 no value\r\n\tИначеЕсли\r\n\t\tNum = 3 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adInteger 3 4 - byte signed integer\r\n\tИначеЕсли\r\n\t\tNum = 205 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка,  , , , ПараметрыСтроки\"); // adLongVarBinary 205 Long binary value\r\n\tИначеЕсли\r\n\t\tNum = 201 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка,  , , , ПараметрыСтроки\"); // adLongVarChar 201 Long string value\r\n\tИначеЕсли\r\n\t\tNum = 203 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка,  , , , ПараметрыСтроки\"); // adLongVarWChar 203 Long Null - terminates string value\r\n\tИначеЕсли\r\n\t\tNum = 131 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adNumeric 131 Number with fixed precision and scale\r\n\tИначеЕсли\r\n\t\tNum = 5 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\");\r\n\tИначеЕсли\r\n\t\tNum = 4 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adSingle 4 Single - precision floating - point value\r\n\tИначеЕсли\r\n\t\tNum = 2 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adSmallInt 2 2 - byte signed integer\r\n\tИначеЕсли\r\n\t\tNum = 16 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adTinyInt 16 1 - byte signed integer\r\n\tИначеЕсли\r\n\t\tNum = 21 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adUnsignedBigInt 21 8 - byte unsigned integer\r\n\tИначеЕсли\r\n\t\tNum = 19 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adUnsignedInt 19 4 - byte unsigned integer\r\n\tИначеЕсли\r\n\t\tNum = 18 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adUnsignedSmallInt 18 2 - byte unsigned integer\r\n\tИначеЕсли\r\n\t\tNum = 17 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adUnsignedTinyInt 17 1 - byte unsigned integer\r\n\tИначеЕсли\r\n\t\tNum = 132 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adUserDefined 132 User - defined variable\r\n\tИначеЕсли\r\n\t\tNum = 204 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки); // adVarBinary 204 Binary value\r\n\tИначеЕсли\r\n\t\tNum = 12 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adVariant 12 Automation variant\r\n\tИначеЕсли\r\n\t\tNum = 139 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Число\"); // adVarNumeric 139 Variable width exact numeric with signed scale\r\n\tИначеЕсли\r\n\t\tNum = 202 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки); // adVarWChar 202 Null - terminated Unicode character string\r\n\tИначеЕсли\r\n\t\tNum = 130 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки); // adWChar 130\r\n\tИначеЕсли\r\n\t\tNum = 200 Тогда\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\", , , , ПараметрыСтроки);\r\n\tИначе\r\n\t\tВозврат Новый ОписаниеТипов(\"Строка\");\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции\r\n\r\n// Возвращает структуру с данными для НовоеСоединениеССУБД().\r\n//\r\n// Параметры:\r\n//  АдресСервера\t - текст, адрес сервера.\r\n//  ИмяБД      - текст, текст имя базы данных.\r\n//  Логин - текст, логин.\r\n//  Пароль - текст, пароль.\r\n//\r\nФункция СоздатьДанныеДляПодключения(АдресСервера, ИмяБД, Логин, Пароль) Экспорт\r\n\t\r\n\tДанныеДляПодключения = Новый Структура(\"АдресСервера, ИмяБД, Логин, Пароль\", АдресСервера, ИмяБД, Логин, Пароль);\r\n\tВозврат ДанныеДляПодключения;\r\n\t\r\nКонецФункции\n\n{82} Высокая цикломатическая сложность: 96\r\nОрфографическая ошибка в коннект: коннект"
  },
  {
    "title": "Очистка номера телефона от \"мусора\" (нецифровых символов)",
    "description": "Очистка номера телефона от \"мусора\" (нецифровых символов)",
    "code_snippet": "СтрСоединить(СтрРазделить(СтрокаСЦифрами, СтрСоединить(СтрРазделить(СтрокаСЦифрами, \"0123456789\"))))\r\n\r\n// Если список ненужных символов известен, например, \"(\", \")\" и \"-\", то выражение может быть еще короче:\r\n\r\nСтрСоединить(СтрРазделить(СтрокаСЦифрами, \"()-\"))\n\nСтрСоединить(СтрРазделить(СтрокаСЦифрами, СтрСоединить(СтрРазделить(СтрокаСЦифрами, \"0123456789\"))))\r\n\r\n// Если список ненужных символов известен, например, \"(\", \")\" и \"-\", то выражение может быть еще короче:\r\n\r\nСтрСоединить(СтрРазделить(СтрокаСЦифрами, \"()-\"))\n\nОрфографическая ошибка в стринг: стринг\r\nОрфографическая ошибка в билдера: билдера\n\n//Функция очищает номер телефона от нецифровых символов\nФункция ОчиститьНомер(Номер, ОчищаемыеСимволы = \"\") Экспорт\n\t\n\tЕсли ПустаяСтрока(ОчищаемыеСимволы) Тогда\n\t\t\n\t\tВозврат СтрСоединить(СтрРазделить(Номер, СтрСоединить(СтрРазделить(Номер, \"0123456789\"))));\n\t\t\n\tКонецЕсли;\n\t\n\tВозврат СтрСоединить(СтрРазделить(Номер, ОчищаемыеСимволы))\t\n\t\nКонецФункции"
  },
  {
    "title": "Python + 1C. Защищенный OAuth 2 сервер. Курс",
    "description": "Разработай защищенный OAuth 2 сервер на Python для 1С за одно занятие.",
    "code_snippet": ""
  },
  {
    "title": "MAGAZKA - лучшая программа для магазина",
    "description": "Фирменная конфигурация для Платформы 1С 8.2/8.3\r\nНа рынке 11 лет, представлена в 14 странах, более 4500 довольных клиентов",
    "code_snippet": ""
  },
  {
    "title": "Игра : Самоцветы для 1С",
    "description": "Bejeweled for 1C",
    "code_snippet": ""
  },
  {
    "title": "Удалить пространство имен из готового файла xml",
    "description": "Удалить пространство имен из готового файла xml",
    "code_snippet": "Функция УдалитьПространство(хмл)\t//хмл - полное имя файла\r\n\tХ =  Новый COMОбъект(\"Msxml2.DOMDocument.6.0\");\r\n\tх.async = 0;\r\n\tх.validateOnParse = 0;\r\n\tх.resolveExternals=0;\r\n\tх.load(хмл);\r\n\txslDoc= Новый COMОбъект(\"MSXML2.DOMDocument.6.0\");\r\n\txslDoc.async = 0;\r\n\t\t\r\n\txslDoc.loadXML(\"<?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\"?>\r\n\t|<xsl:stylesheet version=\"\"1.0\"\"\r\n\t|  xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\">\r\n\t|  <xsl:output method=\"\"xml\"\"  encoding=\"\"UTF-8\"\" indent=\"\"no\"\"/>\t\r\n\t|  <xsl:template match=\"\"/|comment()|processing-instruction()\"\">\r\n\t|    <xsl:copy>\r\n\t|<!-- go process children (applies to root node only) -->\r\n\t|      <xsl:apply-templates/>\r\n\t|    </xsl:copy>\r\n\t|  </xsl:template>\t\r\n\t|  <xsl:template match=\"\"*\"\">\r\n\t|    <xsl:element name=\"\"{local-name()}\"\">\r\n\t|      <!-- go process attributes and children -->\r\n\t|      <xsl:apply-templates select=\"\"@*[name(.)!='type']|node()\"\"/>\r\n\t|    </xsl:element>\r\n\t|<xsl:text>\r\n\t|</xsl:text>\r\n\t|  </xsl:template>\r\n\t|   \t\r\n\t|  <xsl:template match=\"\"@*\"\">\r\n\t|    <xsl:attribute name=\"\"{local-name()}\"\">\r\n\t|      <xsl:value-of select=\"\".\"\"/>\r\n\t|    </xsl:attribute>\r\n\t|  </xsl:template>\t\r\n\t|</xsl:stylesheet>\r\n\t|\");\r\n\t\t\r\n\txmlDoc= Новый COMОбъект(\"MSXML2.DOMDocument.6.0\");\r\n\t// XML = xmlDoc.createProcessingInstruction(\"xml\", \"version=\"\"1.0\"\" encoding=\"\"UTF-8\"\"\");  \t\r\n\tх.transformNodeToObject(xslDoc, xmlDoc);\r\n\t//xmlDoc.insertBefore(XML,);\r\n\t\r\n\txslDoc=0;\r\n\tх=0;\r\n\txmlDoc.save(хмл);\r\n\txmlDoc=0;\r\n\tВозврат 1;\r\nКонецФункции // УдалитьПространство()\n\nФункция УдалитьПространство(хмл)\t//хмл - полное имя файла\r\n\tХ =  Новый COMОбъект(\"Msxml2.DOMDocument.6.0\");\r\n\tх.async = 0;\r\n\tх.validateOnParse = 0;\r\n\tх.resolveExternals=0;\r\n\tх.load(хмл);\r\n\txslDoc= Новый COMОбъект(\"MSXML2.DOMDocument.6.0\");\r\n\txslDoc.async = 0;\r\n\t\t\r\n\txslDoc.loadXML(\"<?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\"?>\r\n\t|<xsl:stylesheet version=\"\"1.0\"\"\r\n\t|  xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\">\r\n\t|  <xsl:output method=\"\"xml\"\"  encoding=\"\"UTF-8\"\" indent=\"\"no\"\"/>\t\r\n\t|  <xsl:template match=\"\"/|comment()|processing-instruction()\"\">\r\n\t|    <xsl:copy>\r\n\t|<!-- go process children (applies to root node only) -->\r\n\t|      <xsl:apply-templates/>\r\n\t|    </xsl:copy>\r\n\t|  </xsl:template>\t\r\n\t|  <xsl:template match=\"\"*\"\">\r\n\t|    <xsl:element name=\"\"{local-name()}\"\">\r\n\t|      <!-- go process attributes and children -->\r\n\t|      <xsl:apply-templates select=\"\"@*[name(.)!='type']|node()\"\"/>\r\n\t|    </xsl:element>\r\n\t|<xsl:text>\r\n\t|</xsl:text>\r\n\t|  </xsl:template>\r\n\t|   \t\r\n\t|  <xsl:template match=\"\"@*\"\">\r\n\t|    <xsl:attribute name=\"\"{local-name()}\"\">\r\n\t|      <xsl:value-of select=\"\".\"\"/>\r\n\t|    </xsl:attribute>\r\n\t|  </xsl:template>\t\r\n\t|</xsl:stylesheet>\r\n\t|\");\r\n\t\t\r\n\txmlDoc= Новый COMОбъект(\"MSXML2.DOMDocument.6.0\");\r\n\t// XML = xmlDoc.createProcessingInstruction(\"xml\", \"version=\"\"1.0\"\" encoding=\"\"UTF-8\"\"\");  \t\r\n\tх.transformNodeToObject(xslDoc, xmlDoc);\r\n\t//xmlDoc.insertBefore(XML,);\r\n\t\r\n\txslDoc=0;\r\n\tх=0;\r\n\txmlDoc.save(хмл);\r\n\txmlDoc=0;\r\n\tВозврат 1;\r\nКонецФункции // УдалитьПространство()\n\n{42} Переменной xslDoc присвоено значение, но оно нигде не используется\r\n{43} Переменной Х присвоено значение, но оно нигде не используется\r\n{45} Переменной xmlDoc присвоено значение, но оно нигде не используется\r\n{46} Функция всегда возвращает одно и тоже значение\r\nОрфографическая ошибка в Msxml2: Msxml\r\nОрфографическая ошибка в stylesheet (найдено 2): stylesheet\r\nОрфографическая ошибка в xmlns: xmlns"
  },
  {
    "title": "Скрипт установки модели восстановления Simple для всех баз",
    "description": "Скрипт установки модели восстановления Simple для всех баз",
    "code_snippet": "DECLARE @SqlText VARCHAR(max)  = ''\r\n\r\n\r\nSELECT @SqlText += 'alter database ['+name+'] set recovery simple' + ';' + CHAR(10) + CHAR(13)\r\nfrom master.sys.databases\r\nwhere database_id > 4 and state_desc = 'online' AND recovery_model_desc <> 'SIMPLE'\r\n\r\nPRINT @SqlText\r\nEXEC (@SqlText)\n\nDECLARE @SqlText VARCHAR(max)  = ''\r\n\r\n\r\nSELECT @SqlText += 'alter database ['+name+'] set recovery simple' + ';' + CHAR(10) + CHAR(13)\r\nfrom master.sys.databases\r\nwhere database_id > 4 and state_desc = 'online' AND recovery_model_desc <> 'SIMPLE'\r\n\r\nPRINT @SqlText\r\nEXEC (@SqlText)\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Добавить кнопку на форму в командную панель",
    "description": "Добавить кнопку на форму в командную панель",
    "code_snippet": "Процедура ДобавитьКнопкуНаФормуВПанель(Форма) Экспорт\r\n\tНоваяКоманда = Форма.Команды.Добавить(\"ФормаКоманднаяПанель_КомандаМояКоманда\");\r\n\tНоваяКоманда.Действие = \"Подключаемый_ВыполнитьКоманду\";\r\n\t\r\n\tКнопка = Форма.Элементы.Добавить(\"МояКнопка\", Тип(\"КнопкаФормы\"), Форма.Элементы.ФормаКоманднаяПанель);\r\n\tКнопка.Заголовок = \"Заголовок кнопки\";\r\n\tКнопка.ИмяКоманды = \"ФормаКоманднаяПанель_КомандаМояКоманда\";\r\nКонецПроцедуры\n\nПроцедура ДобавитьКнопкуНаФормуВПанель(Форма) Экспорт\r\n\tНоваяКоманда = Форма.Команды.Добавить(\"ФормаКоманднаяПанель_КомандаМояКоманда\");\r\n\tНоваяКоманда.Действие = \"Подключаемый_ВыполнитьКоманду\";\r\n\t\r\n\tКнопка = Форма.Элементы.Добавить(\"МояКнопка\", Тип(\"КнопкаФормы\"), Форма.Элементы.ФормаКоманднаяПанель);\r\n\tКнопка.Заголовок = \"Заголовок кнопки\";\r\n\tКнопка.ИмяКоманды = \"ФормаКоманднаяПанель_КомандаМояКоманда\";\r\nКонецПроцедуры"
  },
  {
    "title": "Интерактивный отбор дерева значений",
    "description": "Интерактивный отбор дерева значений",
    "code_snippet": "&НаКлиентеНаСервереБезКонтекста\nФункция ИмяКопииДереваЗаказа()\n\t\n\tВозврат \"КопияДереваЗаказа\";\n\t\nКонецФункции\n\n&НаСервере\nПроцедура СоздатьНовоеПустоеДеревоКопированием()\n\t\n\tПопытка\n\t\n\t\tРеквизит = ЭтаФорма[ИмяКопииДереваЗаказа()];\n\t\tВозврат; // Дерево есть, создавать не надо\n\t\n\tИсключение\n\tКонецПопытки; \n\t\n\t// Так как возникло исключение и мы попалю сюда, то копии дерева нету\n\tДеревоИсходник = РеквизитФормыВЗначение(\"ТаблицаЗаказа\");\n\tМассивДобавленныхРеквизитов = Новый Массив;\n\tНовоеДерево = Новый РеквизитФормы(ИмяКопииДереваЗаказа(), Новый ОписаниеТипов(\"ДеревоЗначений\"));\n\tМассивДобавленныхРеквизитов.Добавить(НовоеДерево);\n\t\n\tДля Каждого ТекКол Из ДеревоИсходник.Колонки Цикл\n\t\t\n\t\tКолонка = Новый РеквизитФормы(ТекКол.Имя, ТекКол.ТипЗначения, ИмяКопииДереваЗаказа());\n\t\tМассивДобавленныхРеквизитов.Добавить(Колонка);\n\t\t\n\tКонецЦикла;\n\t\n\tИзменитьРеквизиты(МассивДобавленныхРеквизитов);\n\tДеревоИсходник = Неопределено;\n\t\nКонецПроцедуры\n\n&НаСервере\nПроцедура СкопироватьДеревоЗаказа(ДеревоИсточник, ИмяРеквизитаНазначение)\n\t\n\tСоздатьНовоеПустоеДеревоКопированием();\n\tДеревоКопия = ДеревоИсточник.Скопировать();\n\tЗначениеВРеквизитФормы(ДеревоКопия, ИмяРеквизитаНазначение);\t\n\t\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура ОтобратьНеУдовлетворенныйСпрос(Команда)\n\tУстановитьОтборДереваЗаказаНаКлиенте(Элементы.ТаблицаЗаказаОтобратьНеУдовлетворенныйСпрос); // Передаем элемент кнопки, которая вызвала данную команду\n\t\nКонецПроцедуры\n\n&НаКлиенте\nПроцедура УстановитьОтборДереваЗаказаНаКлиенте(Элемент)\n\t\n\tЭлемент.Пометка = Не Элемент.Пометка;\n\tУстановитьОтборДереваЗаказа();\n\t\nКонецПроцедуры\n\n&НаСервере\nПроцедура УстановитьОтборДереваЗаказа()\n\t\n\t// Описываем возможные отборы\n\tСоответствиеОтборам = Новый Соответствие;\n\tСоответствиеОтборам.Вставить(Элементы.ТаблицаЗаказаОтобратьНеУдовлетворенныйСпрос, \"ТолькоНеУдовлетворенныйСпрос\");\n\t// Элемент и текстовое представление (потребуется дальше). Если нужно несколько отборов, добавьте тут ещё строк\n\t\n\tОтборы = Новый Структура;\n\tВключеноОтборов = 0;\n\t\n\tДля Каждого ЭлементОтбора Из СоответствиеОтборам Цикл\n\t\t\n\t\tЕсли ЭлементОтбора.Ключ.Пометка Тогда // Проходим по всем описанным элементам и проверяем, какие включены\n\t\t\t\n\t\t\tОтборы.Вставить(ЭлементОтбора.Значение);\n\t\t\tВключеноОтборов = ВключеноОтборов + 1;\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\tКонецЦикла;\n\t\n\t// Надо снять отбор\n\tДеревоКопия = РеквизитФормыВЗначение(ИмяКопииДереваЗаказа());\n\tДеревоЗаказа = РеквизитФормыВЗначение(\"ТаблицаЗаказа\");\n\tДеревоЗаказа = ДеревоКопия.Скопировать(); // Замещаем основное дерево, данными из копии\n\t\n\tЕсли ВключеноОтборов <= 0 Тогда\n\t\t\n\t\tЗначениеВРеквизитФормы(ДеревоЗаказа, \"ТаблицаЗаказа\"); // Возвращаем данные на форму\n\t\tВозврат;\n\t\t\n\tКонецЕсли;\n\t\n\t// Надо поставить отбор\n\tРодители = ДеревоЗаказа.Строки;\n\tРодителиКУдалению = Новый Массив;\n\t\n\tДля Каждого ТекРодитель Из Родители Цикл\n\t\t\n\t\tСтрокаРодителяСоответствуетОтбору = Истина;\n\t\t\n\t\tЕсли Отборы.Свойство(\"ТолькоНеУдовлетворенныйСпрос\") и ТекРодитель.СпросУдовлетворен Тогда\n\t\t\t\n\t\t\tСтрокаРодителяСоответствуетОтбору = Ложь;\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\t\tЕсли СтрокаРодителяСоответствуетОтбору и Отборы.Свойство(\"...\") и ТекРодитель.... Тогда\n\t\t\t\n\t\t\tСтрокаРодителяСоответствуетОтбору = Ложь;\n\t\t\t\n\t\tКонецЕсли;\n\t\t\n\t\tЕсли Не СтрокаРодителяСоответствуетОтбору Тогда\n\t\t\t\n\t\t\tРодителиКУдалению.Добавить(ТекРодитель);\n\t\t\t\n\t\tИначе\n\t\t\t\n\t\t\t// Если надо, добавьте тут отборы детей (подчиненных элементов)\n\n\t\tКонецЕсли;\t\t\n\t\t\n\tКонецЦикла;\t\n\t\n\tДля Каждого Родитель Из РодителиКУдалению Цикл\n\t\t\n\t\tДеревоЗаказа.Строки.Удалить(Родитель);\n\t\t\n\tКонецЦикла;\n\t\n\tЗначениеВРеквизитФормы(ДеревоЗаказа, \"ТаблицаЗаказа\"); // Передаем на форму, наше обновленное дерево\n\t\nКонецПроцедуры\n\nОрфографическая ошибка в Вуаля: Вуаля"
  },
  {
    "title": "Выгрузить Таблицу значений в массив структур (для передачи сервер - клиент)",
    "description": "Выгрузить Таблицу значений в массив структур (для передачи сервер - клиент)",
    "code_snippet": "&НаСервереБезКонтекста\r\nФункция ТаблицуЗначенийВМассив(ТаблЗнач)\r\n\tРезультат=Новый Массив;\r\n\tДля Каждого ТекСтр Из ТаблЗнач Цикл\r\n\t\tСтруктураСтроки=Новый Структура;\r\n\t\tДля Каждого ТекКол Из ТаблЗнач.Колонки Цикл\r\n\t\t\tСтруктураСтроки.Вставить(ТекКол.Имя,ТекСтр[ТекКол.Имя])\r\n\t\tКонецЦикла;\r\n\t\tРезультат.Добавить(СтруктураСтроки)\r\n\tКонецЦикла;\r\n\tВозврат Результат\r\nКонецФункции\n\n&НаСервереБезКонтекста\r\nФункция ТаблицуЗначенийВМассив(ТаблЗнач)\r\n\tРезультат=Новый Массив;\r\n\tДля Каждого ТекСтр Из ТаблЗнач Цикл\r\n\t\tСтруктураСтроки=Новый Структура;\r\n\t\tДля Каждого ТекКол Из ТаблЗнач.Колонки Цикл\r\n\t\t\tСтруктураСтроки.Вставить(ТекКол.Имя,ТекСтр[ТекКол.Имя])\r\n\t\tКонецЦикла;\r\n\t\tРезультат.Добавить(СтруктураСтроки)\r\n\tКонецЦикла;\r\n\tВозврат Результат\r\nКонецФункции\n\nФункция ТаблицаЗначенийВМассивСтруктур(ТаблицаЗначений)\n\tМассивКолонок = Новый Массив;\n\tДля каждого Колонка Из ТаблицаЗначений.Колонки Цикл\n\t\tМассивКолонок.Добавить(Колонка.Имя);\n\tКонецЦикла;\n\tКолонки = СтрСоединить(МассивКолонок, \",\");\n\t\n\tРезультат = Новый Массив;\n\t\n\tДля каждого СтрокаТаблицы Из ТаблицаЗначений Цикл\n\t\tСтрокаТаблицыСтруктурой = Новый Структура(Колонки);\n\t\tЗаполнитьЗначенияСвойств(СтрокаТаблицыСтруктурой, СтрокаТаблицы);\n\t\tРезультат.Добавить(СтрокаТаблицыСтруктурой);\n\tКонецЦикла;\n\t\n\tВозврат Результат;\nКонецФункции"
  },
  {
    "title": "ДеревоЗначений вывод на управляемую форму",
    "description": "ДеревоЗначений вывод на управляемую форму",
    "code_snippet": "&НаСервере\r\nПроцедура ВывестиДзНаФорму(ДеревоОбъект)\r\n\t\r\n\t// Создание Реквизита формы типа ДанныеФормыДерево\r\n\tМассивДобавляемыхРеквизитов = Новый Массив;\r\n\tМассивДобавляемыхРеквизитов.Добавить(Новый РеквизитФормы(\"Дерево\", \r\n\tНовый ОписаниеТипов(\"ДеревоЗначений\")));\r\n\tДля Каждого Колонка Из ДеревоОбъект.Колонки Цикл\r\n\t\tМассивДобавляемыхРеквизитов.Добавить(\r\n\t\tНовый РеквизитФормы(Колонка.Имя, Колонка.ТипЗначения, \"Дерево\"));\r\n\tКонецЦикла;\r\n\tИзменитьРеквизиты(МассивДобавляемыхРеквизитов);\r\n\t\r\n\t\r\n\t// Преобразование объекта прикладного типа ДеревоЗначений \r\n\t// в реквизит управляемой формы (данные формы)\r\n\tЗначениеВРеквизитФормы(ДеревоОбъект, \"Дерево\");\r\n\t\r\n\t\r\n\t// Создание элемента формы типа ТаблицаФормы для отображения дерева\r\n\tЭлементДерево = Элементы.Добавить(\"Дерево\", Тип(\"ТаблицаФормы\"));\r\n\tЭлементДерево.ПутьКДанным = \"Дерево\";\r\n\tЭлементДерево.Отображение = ОтображениеТаблицы.Дерево;\r\n\t\r\n\t\r\n\tДля Каждого Колонка Из ДеревоОбъект.Колонки Цикл\r\n\t\tНовыйЭлемент = Элементы.Добавить(Колонка.Имя, Тип(\"ПолеФормы\"), \r\n\t\tЭлементДерево);\r\n\t\tНовыйЭлемент.Вид = ВидПоляФормы.ПолеВвода;\r\n\t\tНовыйЭлемент.ПутьКДанным = \"Дерево.\" + Колонка.Имя;\r\n\tКонецЦикла;\r\n\t\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ВывестиДзНаФорму(ДеревоОбъект)\r\n\t\r\n\t// Создание Реквизита формы типа ДанныеФормыДерево\r\n\tМассивДобавляемыхРеквизитов = Новый Массив;\r\n\tМассивДобавляемыхРеквизитов.Добавить(Новый РеквизитФормы(\"Дерево\", \r\n\tНовый ОписаниеТипов(\"ДеревоЗначений\")));\r\n\tДля Каждого Колонка Из ДеревоОбъект.Колонки Цикл\r\n\t\tМассивДобавляемыхРеквизитов.Добавить(\r\n\t\tНовый РеквизитФормы(Колонка.Имя, Колонка.ТипЗначения, \"Дерево\"));\r\n\tКонецЦикла;\r\n\tИзменитьРеквизиты(МассивДобавляемыхРеквизитов);\r\n\t\r\n\t\r\n\t// Преобразование объекта прикладного типа ДеревоЗначений \r\n\t// в реквизит управляемой формы (данные формы)\r\n\tЗначениеВРеквизитФормы(ДеревоОбъект, \"Дерево\");\r\n\t\r\n\t\r\n\t// Создание элемента формы типа ТаблицаФормы для отображения дерева\r\n\tЭлементДерево = Элементы.Добавить(\"Дерево\", Тип(\"ТаблицаФормы\"));\r\n\tЭлементДерево.ПутьКДанным = \"Дерево\";\r\n\tЭлементДерево.Отображение = ОтображениеТаблицы.Дерево;\r\n\t\r\n\t\r\n\tДля Каждого Колонка Из ДеревоОбъект.Колонки Цикл\r\n\t\tНовыйЭлемент = Элементы.Добавить(Колонка.Имя, Тип(\"ПолеФормы\"), \r\n\t\tЭлементДерево);\r\n\t\tНовыйЭлемент.Вид = ВидПоляФормы.ПолеВвода;\r\n\t\tНовыйЭлемент.ПутьКДанным = \"Дерево.\" + Колонка.Имя;\r\n\tКонецЦикла;\r\n\t\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Программное добавление нового пользователя",
    "description": "Программное добавление нового пользователя",
    "code_snippet": "Процедура СоздатьНовогоПользователя(Имя, Пароль)\r\n    \r\n    ПроверкаНаСуществующегоПользователя = ПользователиИнформационнойБазы.НайтиПоИмени(Имя);\r\n    \r\n    Если ПроверкаНаСуществующегоПользователя = Неопределено Тогда\r\n        \r\n        ОписаниеПользователяИБ = Пользователи.НовоеОписаниеПользователяИБ();\r\n        \r\n        //В списке выбора не показываем\r\n        ОписаниеПользователяИБ.ПоказыватьВСпискеВыбора = Ложь;\r\n        \r\n        ОписаниеПользователяИБ.АутентификацияСтандартная = Истина;            \r\n        \r\n        ОписаниеПользователяИБ.Вставить(\"Действие\", \"Записать\");\r\n        ОписаниеПользователяИБ.Имя = Имя;\r\n        ОписаниеПользователяИБ.Пароль = Пароль;\r\n        \r\n        \r\n        НовыйПользователь = Справочники.Пользователи.СоздатьЭлемент();\r\n        НовыйПользователь.Имя    = Имя;\r\n        НовыйПользователь.Код             = Имя;\r\n        НовыйПользователь.Недействителен  = ложь;\r\n        \r\n        НовыйПользователь.ДополнительныеСвойства.Вставить(\r\n            \"ОписаниеПользователяИБ\", ОписаниеПользователяИБ);\r\n        \r\n        Попытка\r\n            НовыйПользователь.Записать();            \r\n            ДобавитьРолиНовомуПользователю(НовыйПользователь.Имя);\r\n       \tИсключение\r\n            ОбщегоНазначенияКлиентСервер.СообщитьПользователю(\"Ошибка создания нового пользователя\" + ОписаниеОшибки());\r\n        КонецПопытки;\r\n        \r\n    КонецЕсли;\r\n        \r\n    \r\nКонецПроцедуры\r\n\r\nПроцедура ДобавитьРолиНовомуПользователю(Имя);\r\n    Пользователь = ПользователиИнформационнойБазы.НайтиПоИмени(Имя);\r\n    Пользователь.Роли.Добавить(Метаданные.Роли.АдминистраторСистемы);\r\n    Пользователь.Роли.Добавить(Метаданные.Роли.ПолныеПрава);\r\n    Пользователь.Записать();\r\nКонецПроцедуры\n\nПроцедура СоздатьНовогоПользователя(Имя, Пароль)\r\n    \r\n    ПроверкаНаСуществующегоПользователя = ПользователиИнформационнойБазы.НайтиПоИмени(Имя);\r\n    \r\n    Если ПроверкаНаСуществующегоПользователя = Неопределено Тогда\r\n        \r\n        ОписаниеПользователяИБ = Пользователи.НовоеОписаниеПользователяИБ();\r\n        \r\n        //В списке выбора не показываем\r\n        ОписаниеПользователяИБ.ПоказыватьВСпискеВыбора = Ложь;\r\n        \r\n        ОписаниеПользователяИБ.АутентификацияСтандартная = Истина;            \r\n        \r\n        ОписаниеПользователяИБ.Вставить(\"Действие\", \"Записать\");\r\n        ОписаниеПользователяИБ.Имя = Имя;\r\n        ОписаниеПользователяИБ.Пароль = Пароль;\r\n        \r\n        \r\n        НовыйПользователь = Справочники.Пользователи.СоздатьЭлемент();\r\n        НовыйПользователь.Имя    = Имя;\r\n        НовыйПользователь.Код             = Имя;\r\n        НовыйПользователь.Недействителен  = ложь;\r\n        \r\n        НовыйПользователь.ДополнительныеСвойства.Вставить(\r\n            \"ОписаниеПользователяИБ\", ОписаниеПользователяИБ);\r\n        \r\n        Попытка\r\n            НовыйПользователь.Записать();            \r\n            ДобавитьРолиНовомуПользователю(НовыйПользователь.Имя);\r\n       \tИсключение\r\n            ОбщегоНазначенияКлиентСервер.СообщитьПользователю(\"Ошибка создания нового пользователя\" + ОписаниеОшибки());\r\n        КонецПопытки;\r\n        \r\n    КонецЕсли;\r\n        \r\n    \r\nКонецПроцедуры\r\n\r\nПроцедура ДобавитьРолиНовомуПользователю(Имя);\r\n    Пользователь = ПользователиИнформационнойБазы.НайтиПоИмени(Имя);\r\n    Пользователь.Роли.Добавить(Метаданные.Роли.АдминистраторСистемы);\r\n    Пользователь.Роли.Добавить(Метаданные.Роли.ПолныеПрава);\r\n    Пользователь.Записать();\r\nКонецПроцедуры"
  },
  {
    "title": "Чтение Excel через Табличный документ",
    "description": "Чтение Excel через Табличный документ",
    "code_snippet": "//На клиенте\r\n\r\nДиалогВыбора = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);\r\nДиалогВыбора.Заголовок = \"Выберите файл\";\r\n\r\nЕсли ДиалогВыбора.Выбрать() Тогда\r\n\tИмяФайла = ДиалогВыбора.ПолноеИмяФайла; \r\n\tКоманда1НаСервере(ИмяФайла);\r\n\t\r\nКонецЕсли; \r\n\r\n\r\n//На сервере\r\n\r\n//Вывод в табличный документ\r\n\r\nТабличныйДокумент = Новый ТабличныйДокумент;\r\n\r\nТабличныйДокумент.Прочитать(ИмяФайла, СпособЧтенияЗначенийТабличногоДокумента.Значение);\r\n\r\n//вывод в таблицу значений\r\n\r\nПЗ = Новый ПостроительЗапроса;\r\n\r\nПЗ.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабличныйДокумент.Область());\r\n\r\nПЗ.ДобавлениеПредставлений = ТипДобавленияПредставлений.НеДобавлять;\r\n\r\nПЗ.ЗаполнитьНастройки();\r\n\r\nПЗ.Выполнить();\r\n\r\nТаблицаЗначений = ПЗ.Результат.Выгрузить();\n\n//На клиенте\r\n\r\nДиалогВыбора = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);\r\nДиалогВыбора.Заголовок = \"Выберите файл\";\r\n\r\nЕсли ДиалогВыбора.Выбрать() Тогда\r\n\tИмяФайла = ДиалогВыбора.ПолноеИмяФайла; \r\n\tКоманда1НаСервере(ИмяФайла);\r\n\t\r\nКонецЕсли; \r\n\r\n\r\n//На сервере\r\n\r\n//Вывод в табличный документ\r\n\r\nТабличныйДокумент = Новый ТабличныйДокумент;\r\n\r\nТабличныйДокумент.Прочитать(ИмяФайла, СпособЧтенияЗначенийТабличногоДокумента.Значение);\r\n\r\n//вывод в таблицу значений\r\n\r\nПЗ = Новый ПостроительЗапроса;\r\n\r\nПЗ.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабличныйДокумент.Область());\r\n\r\nПЗ.ДобавлениеПредставлений = ТипДобавленияПредставлений.НеДобавлять;\r\n\r\nПЗ.ЗаполнитьНастройки();\r\n\r\nПЗ.Выполнить();\r\n\r\nТаблицаЗначений = ПЗ.Результат.Выгрузить();\n\n{33} Переменной ТаблицаЗначений присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Выгрузка запроса в XML. Выгрузка объекта",
    "description": "Выгрузка запроса в XML. Выгрузка объекта",
    "code_snippet": "&НаСервере\r\nПроцедура КомандаВыполнитьНаСервере()\r\n\t\r\n\tИмяФайла = \"d:\\test.xml\";\r\n\t\r\n\tЗапрос = Новый Запрос(\"ВЫБРАТЬ\r\n\t| Номенклатура.Код КАК Код,\r\n\t| Номенклатура.Наименование КАК Наименование,\r\n\t| Номенклатура.Артикул КАК Артикул,\r\n\t| Номенклатура.Ссылка КАК Номенклатура\r\n\t|ИЗ\r\n\t| Справочник.Номенклатура КАК Номенклатура\r\n\t|ГДЕ\r\n\t| Номенклатура.ЭтоГруппа = ЛОЖЬ\");\r\n\t\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\tЗаписьXML.ОткрытьФайл(ИмяФайла,\"UTF-8\");\r\n\t\r\n\tВыборкаРезультата = Запрос.Выполнить().Выгрузить(); \r\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Номенклатура\");\r\n\tДля каждого Выборка Из ВыборкаРезультата Цикл\r\n\t\tЗаписатьXML(ЗаписьXML, Выборка.Номенклатура.ПолучитьОбъект());           \r\n\tКонецЦикла;\r\n\tЗаписьXML.ЗаписатьКонецЭлемента();\r\n\tЗаписьXML.Закрыть();\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура КомандаВыполнитьНаСервере()\r\n\t\r\n\tИмяФайла = \"d:\\test.xml\";\r\n\t\r\n\tЗапрос = Новый Запрос(\"ВЫБРАТЬ\r\n\t| Номенклатура.Код КАК Код,\r\n\t| Номенклатура.Наименование КАК Наименование,\r\n\t| Номенклатура.Артикул КАК Артикул,\r\n\t| Номенклатура.Ссылка КАК Номенклатура\r\n\t|ИЗ\r\n\t| Справочник.Номенклатура КАК Номенклатура\r\n\t|ГДЕ\r\n\t| Номенклатура.ЭтоГруппа = ЛОЖЬ\");\r\n\t\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\tЗаписьXML.ОткрытьФайл(ИмяФайла,\"UTF-8\");\r\n\t\r\n\tВыборкаРезультата = Запрос.Выполнить().Выгрузить(); \r\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Номенклатура\");\r\n\tДля каждого Выборка Из ВыборкаРезультата Цикл\r\n\t\tЗаписатьXML(ЗаписьXML, Выборка.Номенклатура.ПолучитьОбъект());           \r\n\tКонецЦикла;\r\n\tЗаписьXML.ЗаписатьКонецЭлемента();\r\n\tЗаписьXML.Закрыть();\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\nПроцедура КомандаВыполнитьНаСервере()\n\t\n\tИмяФайла = \"d:\\test.xml\";\n\t\n\tЗапрос = Новый Запрос(\"ВЫБРАТЬ\n\t| Номенклатура.Код КАК Код,\n\t| Номенклатура.Наименование КАК Наименование,\n\t| Номенклатура.Артикул КАК Артикул,\n\t| Номенклатура.Ссылка КАК Номенклатура\n\t|ИЗ\n\t| Справочник.Номенклатура КАК Номенклатура\n\t|ГДЕ\n\t| Номенклатура.ЭтоГруппа = ЛОЖЬ\");\n\t\n\tЗаписьXML = Новый ЗаписьXML;\n\tЗаписьXML.ОткрытьФайл(ИмяФайла,\"UTF-8\");\n\t\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Номенклатура\");\n\t\n\tВыборкаРезультата = Запрос.Выполнить().Выбрать();\n\t\n\tПока ВыборкаРезультата.Следующий() Цикл\n\t\tЗаписатьXML(ЗаписьXML, ВыборкаРезультата.Номенклатура.ПолучитьОбъект());\n\tКонецЦикла;\n\t\n\t//Вариант через ТаблицуЗначений\n\t\n\t//ТабРезультаты = Запрос.Выполнить().Выгрузить();\n\t//\n\t//Для каждого СтрокаТаб Из ТабРезультаты Цикл\n\t//\tЗаписатьXML(ЗаписьXML, СтрокаТаб.Номенклатура.ПолучитьОбъект());\n\t//КонецЦикла;\n\t\n\tЗаписьXML.ЗаписатьКонецЭлемента();\n\tЗаписьXML.Закрыть();\n\t\nКонецПроцедуры"
  },
  {
    "title": "Проверка заполненности сложных объектов",
    "description": "Проверка заполненности сложных объектов",
    "code_snippet": "Функция СодержитДанные(ЗначениеДляПроверки) Экспорт\r\n\tРезультат = Ложь;\r\n\t\r\n\tЕсли ЗначениеДляПроверки <> Неопределено Тогда\r\n\t\tЕсли ТипЗнч(ЗначениеДляПроверки) = Тип(\"ТаблицаЗначений\")\r\n\t\t\tИли ТипЗнч(ЗначениеДляПроверки) = Тип(\"Массив\") \r\n\t\t\tИли ТипЗнч(ЗначениеДляПроверки) = Тип(\"СписокЗначений\") \r\n\t\t\tТогда\r\n\t\t\t\r\n\t\t\tЕсли ЗначениеДляПроверки.Количество() > 0 Тогда\r\n\t\t\t\tРезультат = Истина;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tИначе\r\n\t\t\tРезультат = ЗначениеЗаполнено(ЗначениеДляПроверки);\r\n\t\tКонецЕсли\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\r\nКонецФункции\n\nФункция СодержитДанные(ЗначениеДляПроверки) Экспорт\r\n\tРезультат = Ложь;\r\n\t\r\n\tЕсли ЗначениеДляПроверки <> Неопределено Тогда\r\n\t\tЕсли ТипЗнч(ЗначениеДляПроверки) = Тип(\"ТаблицаЗначений\")\r\n\t\t\tИли ТипЗнч(ЗначениеДляПроверки) = Тип(\"Массив\") \r\n\t\t\tИли ТипЗнч(ЗначениеДляПроверки) = Тип(\"СписокЗначений\") \r\n\t\t\tТогда\r\n\t\t\t\r\n\t\t\tЕсли ЗначениеДляПроверки.Количество() > 0 Тогда\r\n\t\t\t\tРезультат = Истина;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\tИначе\r\n\t\t\tРезультат = ЗначениеЗаполнено(ЗначениеДляПроверки);\r\n\t\tКонецЕсли\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\r\nКонецФункции"
  },
  {
    "title": "Создать объект ОписаниеТипов",
    "description": "Создать объект ОписаниеТипов",
    "code_snippet": "НоваяКолонка = ТЗ.Колонки.Добавить(\"КолонкаДата\", ОбщегоНазначения.ОписаниеТипаДата(ЧастиДаты.Дата));\r\n\r\nНоваяКолонка = ТЗ.Колонки.Добавить(\"КолонкаЧисло\", ОбщегоНазначения.ОписаниеТипаЧисло(12));\r\n\r\nНоваяКолонка = ТЗ.Колонки.Добавить(\"КолонкаСтрока\", ОбщегоНазначения.ОписаниеТипаСтрока(100));\r\n\r\nНоваяКолонка = ТЗ.Колонки.Добавить(\"КолонкаСсылка\", ОбщегоНазначения.ОписаниеТипаВсеСсылки());\n\nНоваяКолонка = ТЗ.Колонки.Добавить(\"КолонкаДата\", ОбщегоНазначения.ОписаниеТипаДата(ЧастиДаты.Дата));\r\n\r\nНоваяКолонка = ТЗ.Колонки.Добавить(\"КолонкаЧисло\", ОбщегоНазначения.ОписаниеТипаЧисло(12));\r\n\r\nНоваяКолонка = ТЗ.Колонки.Добавить(\"КолонкаСтрока\", ОбщегоНазначения.ОписаниеТипаСтрока(100));\r\n\r\nНоваяКолонка = ТЗ.Колонки.Добавить(\"КолонкаСсылка\", ОбщегоНазначения.ОписаниеТипаВсеСсылки());\n\n{1} Переменной НоваяКолонка присвоено значение, но оно нигде не используется\r\n{3} Переменной НоваяКолонка присвоено значение, но оно нигде не используется\r\n{5} Переменной НоваяКолонка присвоено значение, но оно нигде не используется\r\n{7} Переменной НоваяКолонка присвоено значение, но оно нигде не используется"
  },
  {
    "title": "HTTP в 1С для начинающих. Курс",
    "description": "Закрой все вопросы по работе с HTTP в 1C за одно занятие!",
    "code_snippet": ""
  },
  {
    "title": "Открытие формы выбора с отбором",
    "description": "Открытие формы выбора с отбором",
    "code_snippet": "&НаКлиенте\nПроцедура Подбор(Команда)\n\t\n    НастройкиКомпоновки = Новый НастройкиКомпоновкиДанных;\n\n    НастройкаОтбора = НастройкиКомпоновки.Отбор.Элементы.Добавить(Тип(\"ГруппаЭлементовОтбораКомпоновкиДанных\"));\n    НастройкаОтбора.ТипГруппы = ТипГруппыЭлементовОтбораКомпоновкиДанных.ГруппаИ;\n    \n\tЕсли ЗначениеЗаполнено(Объект.Контрагент) И НЕ Объект.Контрагент.Пустая() Тогда\n\t\tСтрокаОтбора = НастройкаОтбора.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\")); \n\t\tСтрокаОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных(\"Контрагент\");\n\t\tСтрокаОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.Равно;\n\t\tСтрокаОтбора.Использование  = Истина;\n\t\tСтрокаОтбора.ПравоеЗначение = Объект.Контрагент;\n\tКонецЕсли;\n\n\tЕсли ЗначениеЗаполнено(Объект.Период) Тогда\n\t\tСтрокаОтбора = НастройкаОтбора.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\")); \n\t\tСтрокаОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных(\"Дата\");\n\t\tСтрокаОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.БольшеИлиРавно;\n\t\tСтрокаОтбора.Использование  = Истина;\n\t\tСтрокаОтбора.ПравоеЗначение = Объект.Период.ДатаНачала;\n\t\t\n\t\tСтрокаОтбора = НастройкаОтбора.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\")); \n\t\tСтрокаОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных(\"Дата\");\n\t\tСтрокаОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.МеньшеИлиРавно;\n\t\tСтрокаОтбора.Использование  = Истина;\n\t\tСтрокаОтбора.ПравоеЗначение = Объект.Период.ДатаОкончания;\n\tКонецЕсли;\n\n    ПараметрыОтбора = Новый Структура;\n    ПараметрыОтбора.Вставить(\"ФиксированныеНастройки\", НастройкиКомпоновки);\n    ПараметрыОтбора.Вставить(\"РежимВыбора\",Истина);\n    ПараметрыОтбора.Вставить(\"МножественныйВыбор\",Истина);\n\n    ОткрытьФорму(\"Документ.КорректировкаРеализации.ФормаВыбора\", ПараметрыОтбора, Элементы.СписокДокументов); \n\t\nКонецПроцедуры\n\nПроцедура Подбор(Команда)\n\t\n\tФормаВыбора = ПолучитьФорму(\"Документ.КорректировкаРеализации.ФормаВыбора\", , ЭтаФорма.КлючУникальности);\n\t\n\tФормаВыбора.РежимВыбора = Истина;\n\tФормаВыбора.МножественныйВыбор = Истина;\n\tФормаВыбора.ЗакрыватьПриВыборе  = Истина;\n\tФормаВыбора.ВладелецФормы = ЭлементыФормы.СписокДокументов;\n\t\n\tЕсли ЗначениеЗаполнено(ЭтотОбъект.Контрагент) И НЕ ЭтотОбъект.Контрагент.Пустая() Тогда\n\t\tСтрокаОтбора = ФормаВыбора.Отбор.Контрагент;\n\t\tСтрокаОтбора.Значение = ЭтотОбъект.Контрагент;\n\t\tСтрокаОтбора.Использование = Истина;\n\tКонецЕсли;\n\t\n\tЕсли ЗначениеЗаполнено(ЭтотОбъект.Период) Тогда\n\t\tСтрокаОтбора = ФормаВыбора.Отбор.Дата;\n\t\tСтрокаОтбора.ЗначениеС = ЭтотОбъект.Период.ДатаНачала;\n\t\tСтрокаОтбора.ЗначениеПо = ЭтотОбъект.Период.ДатаОкончания;\n\t\tСтрокаОтбора.ВидСравнения = ВидСравнения.Интервал;\n\t\tСтрокаОтбора.Использование = Истина;\n\tКонецЕсли;\n\t\n\tФормаВыбора.Открыть();\n\t\nКонецПроцедуры"
  },
  {
    "title": "Интеграция 1С и Битрикс 24 через расширения. Курс",
    "description": "Разработка модуля интеграции ведется полностью в расширении, что позволит вам добавлять его даже в 1С:Fresh.",
    "code_snippet": ""
  },
  {
    "title": "1С мобильное приложение B2B. Видео курс по разработке",
    "description": "Интенсив по разработке мобильного приложения 1С, для внутри корпоративного использования. Разработка обмена, динамического интерфейса, авторизации, XDTO. В процессе изучения вы создадите мобильное приложение 1С для B2B с нуля до 100%.",
    "code_snippet": ""
  },
  {
    "title": "Разработка HTML интерфейса мобильного приложения 1С. Курс",
    "description": "Разработай красивое мобильное приложение 1С с помощью HTML и CSS",
    "code_snippet": ""
  },
  {
    "title": "Чат бот ВКонтакте на 1С. Курс",
    "description": "Интенсив по разработке чат бота ВКонтакте. Используя API ВКонтакте создавать чат бот ВКонтакте из 1С. Получить список пользователей группы ВКонтакте  и разослать им сообщения.",
    "code_snippet": ""
  },
  {
    "title": "1С XDTO для начинающих. Курс",
    "description": "Закрой все вопросы по XDTO за одно занятие!",
    "code_snippet": ""
  },
  {
    "title": "Преобразовать строку таблицы значений в структуру",
    "description": "Преобразовать строку таблицы значений в структуру",
    "code_snippet": "ПараметрыСтроки = ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(ТаблицаПоказателей[0]);\n\nПараметрыСтроки = ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(ТаблицаПоказателей[0]);\n\n{1} Переменной ПараметрыСтроки присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Значения реквизитов, прочитанных из информационной базы для нескольких объектов",
    "description": "Значения реквизитов, прочитанных из информационной базы для нескольких объектов",
    "code_snippet": "ВидыРасчета = Новый Массив;\r\n\r\nДля Каждого СтрокаИсточника Из ТаблицаВычислений Цикл\r\n\r\n        ВидыРасчета.Добавить(СтрокаИсточника.ВидНачисления);\r\n\r\nКонецЦикла;\r\n\r\nВидыРасчетаИнфо = ОбщегоНазначения.ЗначенияРеквизитовОбъектов(ВидыРасчета, \"УчетВремениВЧасах,КатегорияНачисленияИлиНеоплаченногоВремени,ТребуетсяРасчетБазы\");\n\nВидыРасчета = Новый Массив;\r\n\r\nДля Каждого СтрокаИсточника Из ТаблицаВычислений Цикл\r\n\r\n        ВидыРасчета.Добавить(СтрокаИсточника.ВидНачисления);\r\n\r\nКонецЦикла;\r\n\r\nВидыРасчетаИнфо = ОбщегоНазначения.ЗначенияРеквизитовОбъектов(ВидыРасчета, \"УчетВремениВЧасах,КатегорияНачисленияИлиНеоплаченногоВремени,ТребуетсяРасчетБазы\");\n\n{9} Переменной ВидыРасчетаИнфо присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Строковые функции. Альтернатива для СтрРазделить, СтрНайти и т.д.",
    "description": "Строковые функции. Альтернатива для СтрРазделить, СтрНайти и т.д.",
    "code_snippet": "СтрРазделить(Строка, \" \")\n\nСтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Строка, \" \")"
  },
  {
    "title": "yard",
    "description": "Yet another release downloader (YARD)",
    "code_snippet": ""
  },
  {
    "title": "Формирование файла CSV с записью в файл на клиенте",
    "description": "Формирование файла CSV с записью в файл на клиенте",
    "code_snippet": "&НаКлиенте\r\nПроцедура СформироватьCsvФайл(Команда)\r\n\t\r\n\tПутьККаталогу = ОткрытьДиалогВыбораФайла();\r\n\tТекст = ВыгрузитьВCSV(ПутьККаталогу.ПолноеИмяФайла);\r\n\t\r\n\tКодировка = КодировкаТекста.ANSI;\r\n\tТекстовыйФайлЗапись = Новый ЗаписьТекста(ПутьККаталогу.ПолноеИмяФайла,Кодировка);\r\n\tТекстовыйФайлЗапись.ЗаписатьСтроку(Текст);\r\n\tТекстовыйФайлЗапись.Закрыть();\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nФункция ОткрытьДиалогВыбораФайла(НачальныйКаталог = Неопределено, МножественныйВыбор = Ложь, Фильтр = Неопределено) экспорт\r\n\tСтандартнаяОбработка = Ложь;\r\n\tДиалогОткрытияФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);\r\n\tДиалогОткрытияФайла.Расширение = \"csv\";\r\n\tФильтр = \"csv|*.csv\";\r\n\tДиалогОткрытияФайла.Фильтр = Фильтр;\r\n\tДиалогОткрытияФайла.Каталог    = НачальныйКаталог;\r\n\tДиалогОткрытияФайла.Заголовок  = \"Выберите каталог...\";\r\n\tДиалогОткрытияФайла.МножественныйВыбор          = Ложь;\r\n\tДиалогОткрытияФайла.ПроверятьСуществованиеФайла = Истина;\r\n\tДиалогОткрытияФайла.ПредварительныйПросмотр     = Истина;\r\n\t\r\n\tЕсли Не ДиалогОткрытияФайла.Выбрать() Тогда\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ДиалогОткрытияФайла;\r\n\t\r\nКонецФункции\r\n\r\nФункция ВыгрузитьВCSV(имяФайлаCSV);\r\n\tТекст = СоздатьДанныеCSV(ТаблицаДокументов,Разделитель);\r\n\tВозврат Текст;\r\nКонецФункции\r\n\r\nФункция СоздатьДанныеCSV(ТаблицаДокументов, Разделитель)\r\n\tТекст = \"\";\r\n\tДля Каждого Запись из ТаблицаДокументов Цикл\r\n\t\tЕсли Текст = \"\" тогда\r\n\t\t\tТекст = СоздатьЗаголовкиCSV(ТаблицаДокументов, Разделитель) + Символы.ПС;   \t\r\n\t\tКонецЕсли;  \r\n\t\tТекст = Текст + Запись.snils + Разделитель + Запись.surname\r\n\t\t+ Разделитель + Запись.name + Разделитель + Запись.patronymic + Разделитель \r\n\t\t+ Запись.oid + Разделитель + Запись.compaignId + Разделитель + Формат(Запись.dateOfBirth, \"ДЛФ=Д\") + Разделитель + Запись.citizenship + Разделитель \r\n\t\t+ Запись.specialty + Разделитель + Запись.financingType + Разделитель + Запись.applicationDate + Разделитель + Запись.targetReception \r\n\t\t+ Разделитель + Запись.testResultType + Разделитель + Запись.testResultOrganization + Разделитель + Запись.testResultYear + Символы.ПС;         \t\r\n\tКонецЦикла;\r\n\tВозврат Текст;\r\nКонецФункции\r\n\r\n// Создаем строку загоовков для CSV-файла\r\nФункция СоздатьЗаголовкиCSV(ТаблицаДокументов, Разделитель)\r\n\tНоваяТаблица = ТаблицаДокументов.Выгрузить();\r\n\tКолонкиТЗ = НоваяТаблица.Колонки;\r\n\tДля каждого Колонка Из КолонкиТЗ Цикл  \r\n\t\tСтрКолонки = \"\" + СтрКолонки + Колонка.Имя + Разделитель;\r\n\tКонецЦикла; \r\n\tВозврат СтрКолонки;\r\nКонецФункции\n\n&НаКлиенте\r\nПроцедура СформироватьCsvФайл(Команда)\r\n\t\r\n\tПутьККаталогу = ОткрытьДиалогВыбораФайла();\r\n\tТекст = ВыгрузитьВCSV(ПутьККаталогу.ПолноеИмяФайла);\r\n\t\r\n\tКодировка = КодировкаТекста.ANSI;\r\n\tТекстовыйФайлЗапись = Новый ЗаписьТекста(ПутьККаталогу.ПолноеИмяФайла,Кодировка);\r\n\tТекстовыйФайлЗапись.ЗаписатьСтроку(Текст);\r\n\tТекстовыйФайлЗапись.Закрыть();\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nФункция ОткрытьДиалогВыбораФайла(НачальныйКаталог = Неопределено, МножественныйВыбор = Ложь, Фильтр = Неопределено) экспорт\r\n\tСтандартнаяОбработка = Ложь;\r\n\tДиалогОткрытияФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);\r\n\tДиалогОткрытияФайла.Расширение = \"csv\";\r\n\tФильтр = \"csv|*.csv\";\r\n\tДиалогОткрытияФайла.Фильтр = Фильтр;\r\n\tДиалогОткрытияФайла.Каталог    = НачальныйКаталог;\r\n\tДиалогОткрытияФайла.Заголовок  = \"Выберите каталог...\";\r\n\tДиалогОткрытияФайла.МножественныйВыбор          = Ложь;\r\n\tДиалогОткрытияФайла.ПроверятьСуществованиеФайла = Истина;\r\n\tДиалогОткрытияФайла.ПредварительныйПросмотр     = Истина;\r\n\t\r\n\tЕсли Не ДиалогОткрытияФайла.Выбрать() Тогда\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ДиалогОткрытияФайла;\r\n\t\r\nКонецФункции\r\n\r\nФункция ВыгрузитьВCSV(имяФайлаCSV);\r\n\tТекст = СоздатьДанныеCSV(ТаблицаДокументов,Разделитель);\r\n\tВозврат Текст;\r\nКонецФункции\r\n\r\nФункция СоздатьДанныеCSV(ТаблицаДокументов, Разделитель)\r\n\tТекст = \"\";\r\n\tДля Каждого Запись из ТаблицаДокументов Цикл\r\n\t\tЕсли Текст = \"\" тогда\r\n\t\t\tТекст = СоздатьЗаголовкиCSV(ТаблицаДокументов, Разделитель) + Символы.ПС;   \t\r\n\t\tКонецЕсли;  \r\n\t\tТекст = Текст + Запись.snils + Разделитель + Запись.surname\r\n\t\t+ Разделитель + Запись.name + Разделитель + Запись.patronymic + Разделитель \r\n\t\t+ Запись.oid + Разделитель + Запись.compaignId + Разделитель + Формат(Запись.dateOfBirth, \"ДЛФ=Д\") + Разделитель + Запись.citizenship + Разделитель \r\n\t\t+ Запись.specialty + Разделитель + Запись.financingType + Разделитель + Запись.applicationDate + Разделитель + Запись.targetReception \r\n\t\t+ Разделитель + Запись.testResultType + Разделитель + Запись.testResultOrganization + Разделитель + Запись.testResultYear + Символы.ПС;         \t\r\n\tКонецЦикла;\r\n\tВозврат Текст;\r\nКонецФункции\r\n\r\n// Создаем строку загоовков для CSV-файла\r\nФункция СоздатьЗаголовкиCSV(ТаблицаДокументов, Разделитель)\r\n\tНоваяТаблица = ТаблицаДокументов.Выгрузить();\r\n\tКолонкиТЗ = НоваяТаблица.Колонки;\r\n\tДля каждого Колонка Из КолонкиТЗ Цикл  \r\n\t\tСтрКолонки = \"\" + СтрКолонки + Колонка.Имя + Разделитель;\r\n\tКонецЦикла; \r\n\tВозврат СтрКолонки;\r\nКонецФункции\n\n{17} Переменной СтандартнаяОбработка присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в snils: snils\r\nОрфографическая ошибка в compaignId: compaign\r\nОрфографическая ошибка в загоовков: загоовков"
  },
  {
    "title": "Таблица значений на УФ с динамическим набором колонок",
    "description": "Таблица значений на УФ с динамическим набором колонок",
    "code_snippet": "ТЗ_рез = РеквизитФормыВЗначение(\"ТЗДокументы\");\r\n    \r\n    МассивРеквизитов = Новый Массив;\r\n    \r\n    //Удалим ранее созданные колонки в ТЗДокументы    \r\n    Для Каждого Колонка Из ТЗ_рез.Колонки Цикл\r\n        МассивРеквизитов.Добавить(\"ТЗДокументы.\" + Колонка.Имя);        \r\n\tКонецЦикла;\r\n\t\r\n\tИзменитьРеквизиты(,МассивРеквизитов);\r\n\t\r\n\t//Удалим отображение таблицы на форме и создадим новую\r\n\tЭлементТаблица = Элементы.Найти(\"ТЗДокументы\");\r\n\tЕсли ЭлементТаблица <> Неопределено Тогда\r\n\t\tЭлементы.Удалить(ЭлементТаблица);        \r\n\tКонецЕсли;     \r\n\t\r\n\tЭлементТаблица=Элементы.Добавить(\"ТЗДокументы\",Тип(\"ТаблицаФормы\"));\r\n\tЭлементТаблица.ПутьКДанным = \"ТЗДокументы\";\r\n\tЭлементТаблица.Отображение = ОтображениеТаблицы.Список;\r\n\t\r\n\tТЗ_рез = Данные;\r\n\r\n\t//Создадим реквизиты ТЗ\r\n    МассивРеквизитов.Очистить();\r\n    Для Каждого Колонка ИЗ ТЗ_рез.Колонки Цикл\r\n        МассивТипов = Новый Массив;\r\n        МассивТипов.Добавить(Колонка.ТипЗначения);\r\n        НоваяКолонка = Новый РеквизитФормы(Колонка.Имя, Новый ОписаниеТипов(МассивТипов), \"ТЗДокументы\");\r\n        МассивРеквизитов.Добавить(НоваяКолонка);\r\n    КонецЦикла;      \r\n    ИзменитьРеквизиты(МассивРеквизитов);  \r\n    ЗначениеВРеквизитФормы(ТЗ_рез, \"ТЗДокументы\");\r\n    \r\n    //Создаем элементы на форме для отображения колонок\r\n    ЭлементТЗ = Элементы.ТЗДокументы;\r\n    Для Каждого Колонка ИЗ ТЗ_рез.Колонки Цикл\r\n        НовыйЭлементФормы = Элементы.Добавить(\"ТЗДокументы\"+Колонка.Имя, Тип(\"ПолеФормы\"), ЭлементТЗ);\r\n        НовыйЭлементФормы.Вид = ВидПоляФормы.ПолеВвода;\r\n        НовыйЭлементФормы.ПутьКДанным = \"ТЗДокументы.\" + Колонка.Имя;\r\n    КонецЦикла;\n\nТЗ_рез = РеквизитФормыВЗначение(\"ТЗДокументы\");\r\n    \r\n    МассивРеквизитов = Новый Массив;\r\n    \r\n    //Удалим ранее созданные колонки в ТЗДокументы    \r\n    Для Каждого Колонка Из ТЗ_рез.Колонки Цикл\r\n        МассивРеквизитов.Добавить(\"ТЗДокументы.\" + Колонка.Имя);        \r\n\tКонецЦикла;\r\n\t\r\n\tИзменитьРеквизиты(,МассивРеквизитов);\r\n\t\r\n\t//Удалим отображение таблицы на форме и создадим новую\r\n\tЭлементТаблица = Элементы.Найти(\"ТЗДокументы\");\r\n\tЕсли ЭлементТаблица <> Неопределено Тогда\r\n\t\tЭлементы.Удалить(ЭлементТаблица);        \r\n\tКонецЕсли;     \r\n\t\r\n\tЭлементТаблица=Элементы.Добавить(\"ТЗДокументы\",Тип(\"ТаблицаФормы\"));\r\n\tЭлементТаблица.ПутьКДанным = \"ТЗДокументы\";\r\n\tЭлементТаблица.Отображение = ОтображениеТаблицы.Список;\r\n\t\r\n\tТЗ_рез = Данные;\r\n\r\n\t//Создадим реквизиты ТЗ\r\n    МассивРеквизитов.Очистить();\r\n    Для Каждого Колонка ИЗ ТЗ_рез.Колонки Цикл\r\n        МассивТипов = Новый Массив;\r\n        МассивТипов.Добавить(Колонка.ТипЗначения);\r\n        НоваяКолонка = Новый РеквизитФормы(Колонка.Имя, Новый ОписаниеТипов(МассивТипов), \"ТЗДокументы\");\r\n        МассивРеквизитов.Добавить(НоваяКолонка);\r\n    КонецЦикла;      \r\n    ИзменитьРеквизиты(МассивРеквизитов);  \r\n    ЗначениеВРеквизитФормы(ТЗ_рез, \"ТЗДокументы\");\r\n    \r\n    //Создаем элементы на форме для отображения колонок\r\n    ЭлементТЗ = Элементы.ТЗДокументы;\r\n    Для Каждого Колонка ИЗ ТЗ_рез.Колонки Цикл\r\n        НовыйЭлементФормы = Элементы.Добавить(\"ТЗДокументы\"+Колонка.Имя, Тип(\"ПолеФормы\"), ЭлементТЗ);\r\n        НовыйЭлементФормы.Вид = ВидПоляФормы.ПолеВвода;\r\n        НовыйЭлементФормы.ПутьКДанным = \"ТЗДокументы.\" + Колонка.Имя;\r\n    КонецЦикла;"
  },
  {
    "title": "Подставить свой макет в СКД",
    "description": "Подставить свой макет в СКД",
    "code_snippet": "СхемаКомпоновкиДанных          = ПолучитьМакет(\"МакетСКД\");\r\n\r\nАдресСхемыКомпоновкиДанных     = ПоместитьВоВременноеХранилище(СхемаКомпоновкиДанных, Новый УникальныйИдентификатор);\r\n\r\nИсточникДоступныхНастроек = Новый ИсточникДоступныхНастроекКомпоновкиДанных(АдресСхемыКомпоновкиДанных);       \r\n\r\nКомпоновщикНастроек.Инициализировать(ИсточникДоступныхНастроек);\r\n\r\nКомпоновщикНастроек.ЗагрузитьНастройки(СхемаКомпоновкиДанных.НастройкиПоУмолчанию);\n\nСхемаКомпоновкиДанных          = ПолучитьМакет(\"МакетСКД\");\r\n\r\nАдресСхемыКомпоновкиДанных     = ПоместитьВоВременноеХранилище(СхемаКомпоновкиДанных, Новый УникальныйИдентификатор);\r\n\r\nИсточникДоступныхНастроек = Новый ИсточникДоступныхНастроекКомпоновкиДанных(АдресСхемыКомпоновкиДанных);       \r\n\r\nКомпоновщикНастроек.Инициализировать(ИсточникДоступныхНастроек);\r\n\r\nКомпоновщикНастроек.ЗагрузитьНастройки(СхемаКомпоновкиДанных.НастройкиПоУмолчанию);"
  },
  {
    "title": "Грабли при работе с макетом в СКД",
    "description": "Грабли при работе с макетом в СКД",
    "code_snippet": ""
  },
  {
    "title": "Загрузка в 1с из CSV. Обработка-шаблон для импорта из csv",
    "description": "Загрузка в 1с из CSV. Обработка-шаблон для импорта из csv",
    "code_snippet": "&НаКлиенте\r\nПроцедура ЗагрузитьCSV(Команда)  // выполняется при нажатии на кнопку\r\n\tДиалогФыбораФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие); //!!!!!!!!!!!!\r\nДиалогФыбораФайла.Фильтр=\"csv файл с разделтелями (*.csv)|*.csv|\";\r\n\r\nДиалогФыбораФайла.Заголовок = \"Выберите файл\";\r\nДиалогФыбораФайла.ИндексФильтра = 0;\r\nописаниеОповещения = Новый ОписаниеОповещения(\"ГрузимИзФайла\", ЭтотОбъект);\r\n    \r\n    ДиалогФыбораФайла.Показать(описаниеОповещения);\t\r\n\r\nКонецПроцедуры\r\n\r\n\r\n\r\n&НаКлиенте\r\nПроцедура ГрузимИзФайла(ВыбранныеФайлы, ДополнительныеПараметры) Экспорт // вызываем диалог выбора файла\r\n    \r\n    Если ВыбранныеФайлы <> Неопределено И ВыбранныеФайлы.Количество() > 0 Тогда\r\n      //  Сообщить(\"Файл выбран!\");\r\n//работаем с файлом\r\n    Имяфайла=ВыбранныеФайлы[0];\t\t\r\n// Пишем в реестр\r\n    сообщить(имяФайла); // вызываем дальнейшую процедуру обработки\r\n\tПуть=имяФайла; // для сохранения xml понадобится\r\n// читаем файл\t\r\nЗагружаемыйФайл = Новый ТекстовыйДокумент; \r\nЗагружаемыйФайл.Прочитать(ИмяФайла);\r\n\r\nЕсли лист=\"лист1\" тогда\r\n\tобработатьCSV1(ЗагружаемыйФайл);\r\n\tконецЕсли;\r\n\r\n    Иначе\r\n        Сообщить(\"Файл не выбран!\");\r\n    КонецЕсли;\r\n    \r\n\r\nКонецПроцедуры\r\n\r\n// процедуру обработатьCSV1(файл) - можно сделать на клиенте\r\n&наСервере   \r\nпроцедура обработатьCSV1(файл)\r\n\tдля номерстроки=2 по файл.КоличествоСтрок() цикл // первую строку пропускаем т.к. там название полей\r\n\tстрока=файл.получитьСтроку(номерСтроки);\r\n\tмассив=РазложитьСтрокуВМассивПодстрок(строка,\";\"); // строка csv - файла, преобразованная в массив, дальше с этими данными можно делать что угодно \r\n\r\n\t\tконецЦикла;\r\n\tконецПроцедуры\r\n\t\r\n\t// процедуру РазложитьСтрокуВМассивПодстрок - можно сделать на клиенте, если процедура \"обработатьCSV1\" тоже имеет директиву &наКлиенте\r\n\t&наСервере\r\n\tФункция РазложитьСтрокуВМассивПодстрок(Знач Стр, Разделитель = \",\") Экспорт\r\n   \r\n   МассивСтрок = Новый Массив();\r\n   Если Разделитель = \" \" Тогда\r\n       Стр = СокрЛП(Стр);\r\n       Пока 1=1 Цикл\r\n           Поз = Найти(Стр,Разделитель);\r\n           Если Поз=0 Тогда\r\n               МассивСтрок.Добавить(Стр);\r\n               Возврат МассивСтрок;\r\n           КонецЕсли;\r\n           МассивСтрок.Добавить(Лев(Стр,Поз-1));\r\n           Стр = СокрЛ(Сред(Стр,Поз));\r\n       КонецЦикла;\r\n   Иначе\r\n       ДлинаРазделителя = СтрДлина(Разделитель);\r\n       Пока 1=1 Цикл\r\n           Поз = Найти(Стр,Разделитель);\r\n           Если Поз=0 Тогда\r\n               МассивСтрок.Добавить(Стр);\r\n               Возврат МассивСтрок;\r\n           КонецЕсли;\r\n           МассивСтрок.Добавить(Лев(Стр,Поз-1));\r\n           Стр = Сред(Стр,Поз+ДлинаРазделителя);\r\n       КонецЦикла;\r\n   КонецЕсли;\r\n   \r\nКонецФункции // глРазложить\n\n&НаКлиенте\r\nПроцедура ЗагрузитьCSV(Команда)  // выполняется при нажатии на кнопку\r\n\tДиалогФыбораФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие); //!!!!!!!!!!!!\r\nДиалогФыбораФайла.Фильтр=\"csv файл с разделтелями (*.csv)|*.csv|\";\r\n\r\nДиалогФыбораФайла.Заголовок = \"Выберите файл\";\r\nДиалогФыбораФайла.ИндексФильтра = 0;\r\nописаниеОповещения = Новый ОписаниеОповещения(\"ГрузимИзФайла\", ЭтотОбъект);\r\n    \r\n    ДиалогФыбораФайла.Показать(описаниеОповещения);\t\r\n\r\nКонецПроцедуры\r\n\r\n\r\n\r\n&НаКлиенте\r\nПроцедура ГрузимИзФайла(ВыбранныеФайлы, ДополнительныеПараметры) Экспорт // вызываем диалог выбора файла\r\n    \r\n    Если ВыбранныеФайлы <> Неопределено И ВыбранныеФайлы.Количество() > 0 Тогда\r\n      //  Сообщить(\"Файл выбран!\");\r\n//работаем с файлом\r\n    Имяфайла=ВыбранныеФайлы[0];\t\t\r\n// Пишем в реестр\r\n    сообщить(имяФайла); // вызываем дальнейшую процедуру обработки\r\n\tПуть=имяФайла; // для сохранения xml понадобится\r\n// читаем файл\t\r\nЗагружаемыйФайл = Новый ТекстовыйДокумент; \r\nЗагружаемыйФайл.Прочитать(ИмяФайла);\r\n\r\nЕсли лист=\"лист1\" тогда\r\n\tобработатьCSV1(ЗагружаемыйФайл);\r\n\tконецЕсли;\r\n\r\n    Иначе\r\n        Сообщить(\"Файл не выбран!\");\r\n    КонецЕсли;\r\n    \r\n\r\nКонецПроцедуры\r\n\r\n// процедуру обработатьCSV1(файл) - можно сделать на клиенте\r\n&наСервере   \r\nпроцедура обработатьCSV1(файл)\r\n\tдля номерстроки=2 по файл.КоличествоСтрок() цикл // первую строку пропускаем т.к. там название полей\r\n\tстрока=файл.получитьСтроку(номерСтроки);\r\n\tмассив=РазложитьСтрокуВМассивПодстрок(строка,\";\"); // строка csv - файла, преобразованная в массив, дальше с этими данными можно делать что угодно \r\n\r\n\t\tконецЦикла;\r\n\tконецПроцедуры\r\n\t\r\n\t// процедуру РазложитьСтрокуВМассивПодстрок - можно сделать на клиенте, если процедура \"обработатьCSV1\" тоже имеет директиву &наКлиенте\r\n\t&наСервере\r\n\tФункция РазложитьСтрокуВМассивПодстрок(Знач Стр, Разделитель = \",\") Экспорт\r\n   \r\n   МассивСтрок = Новый Массив();\r\n   Если Разделитель = \" \" Тогда\r\n       Стр = СокрЛП(Стр);\r\n       Пока 1=1 Цикл\r\n           Поз = Найти(Стр,Разделитель);\r\n           Если Поз=0 Тогда\r\n               МассивСтрок.Добавить(Стр);\r\n               Возврат МассивСтрок;\r\n           КонецЕсли;\r\n           МассивСтрок.Добавить(Лев(Стр,Поз-1));\r\n           Стр = СокрЛ(Сред(Стр,Поз));\r\n       КонецЦикла;\r\n   Иначе\r\n       ДлинаРазделителя = СтрДлина(Разделитель);\r\n       Пока 1=1 Цикл\r\n           Поз = Найти(Стр,Разделитель);\r\n           Если Поз=0 Тогда\r\n               МассивСтрок.Добавить(Стр);\r\n               Возврат МассивСтрок;\r\n           КонецЕсли;\r\n           МассивСтрок.Добавить(Лев(Стр,Поз-1));\r\n           Стр = Сред(Стр,Поз+ДлинаРазделителя);\r\n       КонецЦикла;\r\n   КонецЕсли;\r\n   \r\nКонецФункции // глРазложить\n\n{25} Переменной Путь присвоено значение, но оно нигде не используется\r\n{53} Не все части функции возвращают значение\r\nОрфографическая ошибка в ДиалогФыбораФайла (найдено 5): Фыбора\r\nОрфографическая ошибка в разделтелями: разделтелями\r\nОрфографическая ошибка в Имяфайла: Имяфайла\r\nОрфографическая ошибка в номерстроки: номерстроки"
  },
  {
    "title": "Использование Синонима отчета/обработки при выполнении кода &НаКлиенте",
    "description": "Использование Синонима отчета/обработки при выполнении кода &НаКлиенте",
    "code_snippet": "//***********************************************************************\r\n&НаКлиенте\r\nПроцедура СохранитьВExcel(Команда)\r\n    \r\n    ИмяФайла = Форма.СинонимОтчета + \" (\" + \r\n    Строка(Формат(ТекущаяДата(),\"ДФ=\"\"дд-ММ-гггг\"\"\")) + \")\" \r\n    +\".xlsx\";\r\n    \r\n    //.....\r\n\r\nКонецПроцедуры\r\n\r\n&НаКлиентеНаСервереБезКонтекста\r\nПроцедура ОбновитьТекстЗаголовка(Форма)\r\n    \r\n    Отчет = Форма.Отчет;\r\n    \r\n    ЗаголовокОтчета = НСтр(\"ru = '\" + Форма.СинонимОтчета + \"'\") + БухгалтерскиеОтчетыКлиентСервер.ПолучитьПредставлениеПериода(Отчет.НачалоПериода, Отчет.КонецПериода);\r\n\r\n    Если ЗначениеЗаполнено(Отчет.Организация) И Форма.ИспользуетсяНесколькоОрганизаций Тогда\r\n        ЗаголовокОтчета = ЗаголовокОтчета + \" \" + БухгалтерскиеОтчетыВызовСервераПовтИсп.ПолучитьТекстОрганизация(Отчет.Организация, Отчет.ВключатьОбособленныеПодразделения);\r\n    КонецЕсли;\r\n    \r\n    Форма.Заголовок = ЗаголовокОтчета;\r\n\r\nКонецПроцедуры\r\n\r\n//***********************************************************************\r\n&НаСервере\r\nФункция ВернутьСинонимОтчета()\r\n    \r\n    ОтчетОбъект = РеквизитФормыВЗначение(\"Отчет\");\r\n    \r\n    Возврат ОтчетОбъект.Метаданные().Синоним + \" \" + ОтчетОбъект.Метаданные().Комментарий;\r\n    //Возврат ОтчетОбъект.Метаданные().Синоним;\r\n    \r\nКонецФункции\r\n//***********************************************************************\r\n\r\n&НаСервере\r\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\r\n    \r\n    ЭтаФорма.СинонимОтчета = ВернутьСинонимОтчета();\r\n\r\nКонецПроцедуры\n\n//***********************************************************************\r\n&НаКлиенте\r\nПроцедура СохранитьВExcel(Команда)\r\n    \r\n    ИмяФайла = Форма.СинонимОтчета + \" (\" + \r\n    Строка(Формат(ТекущаяДата(),\"ДФ=\"\"дд-ММ-гггг\"\"\")) + \")\" \r\n    +\".xlsx\";\r\n    \r\n    //.....\r\n\r\nКонецПроцедуры\r\n\r\n&НаКлиентеНаСервереБезКонтекста\r\nПроцедура ОбновитьТекстЗаголовка(Форма)\r\n    \r\n    Отчет = Форма.Отчет;\r\n    \r\n    ЗаголовокОтчета = НСтр(\"ru = '\" + Форма.СинонимОтчета + \"'\") + БухгалтерскиеОтчетыКлиентСервер.ПолучитьПредставлениеПериода(Отчет.НачалоПериода, Отчет.КонецПериода);\r\n\r\n    Если ЗначениеЗаполнено(Отчет.Организация) И Форма.ИспользуетсяНесколькоОрганизаций Тогда\r\n        ЗаголовокОтчета = ЗаголовокОтчета + \" \" + БухгалтерскиеОтчетыВызовСервераПовтИсп.ПолучитьТекстОрганизация(Отчет.Организация, Отчет.ВключатьОбособленныеПодразделения);\r\n    КонецЕсли;\r\n    \r\n    Форма.Заголовок = ЗаголовокОтчета;\r\n\r\nКонецПроцедуры\r\n\r\n//***********************************************************************\r\n&НаСервере\r\nФункция ВернутьСинонимОтчета()\r\n    \r\n    ОтчетОбъект = РеквизитФормыВЗначение(\"Отчет\");\r\n    \r\n    Возврат ОтчетОбъект.Метаданные().Синоним + \" \" + ОтчетОбъект.Метаданные().Комментарий;\r\n    //Возврат ОтчетОбъект.Метаданные().Синоним;\r\n    \r\nКонецФункции\r\n//***********************************************************************\r\n\r\n&НаСервере\r\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\r\n    \r\n    ЭтаФорма.СинонимОтчета = ВернутьСинонимОтчета();\r\n\r\nКонецПроцедуры\n\n{7} Переменной ИмяФайла присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Универсальные функции для регистрации внешних обработок. Для внешней обработки (*.epf)",
    "description": "Универсальные функции для регистрации внешних обработок. Для внешней обработки (*.epf)",
    "code_snippet": "/////////////////////////////////////////////////////////////////////////\r\n// РЕГИСТРАЦИЯ ВНЕШНЕЙ ОБРАБОТКИ\r\n\r\nФункция СведенияОВнешнейОбработке() Экспорт \r\n    \r\n    ИмяОтчета = ЭтотОбъект.Метаданные().Имя; \r\n    Синоним = ЭтотОбъект.Метаданные().Синоним + \" \" + ЭтотОбъект.Метаданные().Комментарий; \r\n    Синоним = ?(ЗначениеЗаполнено(Синоним),Синоним, ИмяОтчета); \r\n    РегистрационныеДанные = Новый Структура();\r\n    РегистрационныеДанные.Вставить(\"Вид\", \"ДополнительнаяОбработка\");\r\n    РегистрационныеДанные.Вставить(\"Наименование\", Синоним);\r\n    РегистрационныеДанные.Вставить(\"Версия\", \"1.0\");\r\n    РегистрационныеДанные.Вставить(\"БезопасныйРежим\", Ложь);\r\n    РегистрационныеДанные.Вставить(\"Информация\", \"Обработка \"+Синоним);\r\n        \r\n    ТаблицаКоманд = ПолучитьТаблицуКоманд();\r\n\r\n    // Добавим команду в таблицу\r\n    ДобавитьКоманду(ТаблицаКоманд, Синоним, \"1\" , \"ОткрытиеФормы\", Истина, );\r\n        \r\n       // Сохраним таблицу команд в параметры регистрации обработки\r\n    РегистрационныеДанные.Вставить(\"Команды\", ТаблицаКоманд);\r\n\r\n    Возврат РегистрационныеДанные;\r\n\r\nКонецФункции\r\n\r\nФункция ПолучитьТаблицуКоманд()\r\n    \r\n    // Создадим пустую таблицу команд и колонки в ней\r\n    Команды = Новый ТаблицаЗначений;\r\n\r\n    // Как будет выглядеть описание печатной формы для пользователя\r\n    Команды.Колонки.Добавить(\"Представление\", Новый ОписаниеТипов(\"Строка\")); \r\n\r\n    // Имя нашего макета, что бы могли отличить вызванную команду в обработке печати\r\n    Команды.Колонки.Добавить(\"Идентификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n\r\n    // Тут задается, как должна вызваться команда обработки\r\n    // Возможные варианты:\r\n    // - ОткрытиеФормы - в этом случае в колонке идентификатор должно быть указано имя формы, которое должна будет открыть система\r\n    // - ВызовКлиентскогоМетода - вызвать клиентскую экспортную процедуру из модуля формы обработки\r\n    // - ВызовСерверногоМетода - вызвать серверную экспортную процедуру из модуля объекта обработки\r\n    Команды.Колонки.Добавить(\"Использование\", Новый ОписаниеТипов(\"Строка\"));\r\n\r\n    // Следующий параметр указывает, необходимо ли показывать оповещение при начале и завершению работы обработки. Не имеет смысла при открытии формы\r\n    Команды.Колонки.Добавить(\"ПоказыватьОповещение\", Новый ОписаниеТипов(\"Булево\"));\r\n\r\n    // Для печатной формы должен содержать строку ПечатьMXL \r\n    Команды.Колонки.Добавить(\"Модификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n    Возврат Команды;\r\n   \r\nКонецФункции\r\n\r\nПроцедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование = \"ОткрытиеФормы\", ПоказыватьОповещение = Ложь, Модификатор)\r\n    \r\n    // Добавляем команду в таблицу команд по переданному описанию.\r\n    // Параметры и их значения можно посмотреть в функции ПолучитьТаблицуКоманд\r\n    НоваяКоманда = ТаблицаКоманд.Добавить();\r\n    НоваяКоманда.Представление = Представление;\r\n    НоваяКоманда.Идентификатор = Идентификатор;\r\n    НоваяКоманда.Использование = Использование;\r\n    НоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;\r\n    НоваяКоманда.Модификатор = Модификатор;\r\n\r\nКонецПроцедуры\n\n/////////////////////////////////////////////////////////////////////////\r\n// РЕГИСТРАЦИЯ ВНЕШНЕЙ ОБРАБОТКИ\r\n\r\nФункция СведенияОВнешнейОбработке() Экспорт \r\n    \r\n    ИмяОтчета = ЭтотОбъект.Метаданные().Имя; \r\n    Синоним = ЭтотОбъект.Метаданные().Синоним + \" \" + ЭтотОбъект.Метаданные().Комментарий; \r\n    Синоним = ?(ЗначениеЗаполнено(Синоним),Синоним, ИмяОтчета); \r\n    РегистрационныеДанные = Новый Структура();\r\n    РегистрационныеДанные.Вставить(\"Вид\", \"ДополнительнаяОбработка\");\r\n    РегистрационныеДанные.Вставить(\"Наименование\", Синоним);\r\n    РегистрационныеДанные.Вставить(\"Версия\", \"1.0\");\r\n    РегистрационныеДанные.Вставить(\"БезопасныйРежим\", Ложь);\r\n    РегистрационныеДанные.Вставить(\"Информация\", \"Обработка \"+Синоним);\r\n        \r\n    ТаблицаКоманд = ПолучитьТаблицуКоманд();\r\n\r\n    // Добавим команду в таблицу\r\n    ДобавитьКоманду(ТаблицаКоманд, Синоним, \"1\" , \"ОткрытиеФормы\", Истина, );\r\n        \r\n       // Сохраним таблицу команд в параметры регистрации обработки\r\n    РегистрационныеДанные.Вставить(\"Команды\", ТаблицаКоманд);\r\n\r\n    Возврат РегистрационныеДанные;\r\n\r\nКонецФункции\r\n\r\nФункция ПолучитьТаблицуКоманд()\r\n    \r\n    // Создадим пустую таблицу команд и колонки в ней\r\n    Команды = Новый ТаблицаЗначений;\r\n\r\n    // Как будет выглядеть описание печатной формы для пользователя\r\n    Команды.Колонки.Добавить(\"Представление\", Новый ОписаниеТипов(\"Строка\")); \r\n\r\n    // Имя нашего макета, что бы могли отличить вызванную команду в обработке печати\r\n    Команды.Колонки.Добавить(\"Идентификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n\r\n    // Тут задается, как должна вызваться команда обработки\r\n    // Возможные варианты:\r\n    // - ОткрытиеФормы - в этом случае в колонке идентификатор должно быть указано имя формы, которое должна будет открыть система\r\n    // - ВызовКлиентскогоМетода - вызвать клиентскую экспортную процедуру из модуля формы обработки\r\n    // - ВызовСерверногоМетода - вызвать серверную экспортную процедуру из модуля объекта обработки\r\n    Команды.Колонки.Добавить(\"Использование\", Новый ОписаниеТипов(\"Строка\"));\r\n\r\n    // Следующий параметр указывает, необходимо ли показывать оповещение при начале и завершению работы обработки. Не имеет смысла при открытии формы\r\n    Команды.Колонки.Добавить(\"ПоказыватьОповещение\", Новый ОписаниеТипов(\"Булево\"));\r\n\r\n    // Для печатной формы должен содержать строку ПечатьMXL \r\n    Команды.Колонки.Добавить(\"Модификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n    Возврат Команды;\r\n   \r\nКонецФункции\r\n\r\nПроцедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование = \"ОткрытиеФормы\", ПоказыватьОповещение = Ложь, Модификатор)\r\n    \r\n    // Добавляем команду в таблицу команд по переданному описанию.\r\n    // Параметры и их значения можно посмотреть в функции ПолучитьТаблицуКоманд\r\n    НоваяКоманда = ТаблицаКоманд.Добавить();\r\n    НоваяКоманда.Представление = Представление;\r\n    НоваяКоманда.Идентификатор = Идентификатор;\r\n    НоваяКоманда.Использование = Использование;\r\n    НоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;\r\n    НоваяКоманда.Модификатор = Модификатор;\r\n\r\nКонецПроцедуры"
  },
  {
    "title": "Универсальные функции для регистрации внешних отчетов. Для внешнего отчета (*.erf)",
    "description": "Универсальные функции для регистрации внешних отчетов. Для внешнего отчета (*.erf)",
    "code_snippet": "Функция СведенияОВнешнейОбработке() Экспорт\r\n    \r\n    ИмяОтчета = ЭтотОбъект.Метаданные().Имя; \r\n    Синоним = ЭтотОбъект.Метаданные().Синоним; \r\n    Синоним = ?(ЗначениеЗаполнено(Синоним),Синоним, ИмяОтчета);         \r\n    РегистрационныеДанные = Новый Структура;\r\n    РегистрационныеДанные.Вставить(\"Вид\",\"ДополнительныйОтчет\"); //может быть – ПечатнаяФорма, ЗаполнениеОбъекта (для вн.обработки), ДополнительныйОтчет, СозданиеСвязанныхОбъектов… \r\n    РегистрационныеДанные.Вставить(\"Наименование\", Синоним); //имя под которым обработка будет зарегестрирована в справочнике внешних обработок\r\n    РегистрационныеДанные.Вставить(\"Версия\", \"1.0\");\r\n    РегистрационныеДанные.Вставить(\"БезопасныйРежим\", Ложь);\r\n    РегистрационныеДанные.Вставить(\"Информация\", \"Отчет \"+Синоним); //так будет выглядеть описание вн.отчета для пользователя\r\n    \r\n    ТаблицаКоманд = ПолучитьТаблицуКоманд();\r\n    \r\n    // Добавим команду в таблицу\r\n    ДобавитьКоманду(ТаблицаКоманд, Синоним, \"СформироватьОтчет\" , \"ОткрытиеФормы\", Истина, );\r\n        \r\n    // Сохраним таблицу команд в параметры регистрации обработки\r\n    РегистрационныеДанные.Вставить(\"Команды\", ТаблицаКоманд);\r\n    \r\n    Возврат РегистрационныеДанные;\r\n                                       \r\nКонецФункции\r\n\r\nФункция ПолучитьТаблицуКоманд()\r\n    \r\n    // Создадим пустую таблицу команд и колонки в ней\r\n    Команды = Новый ТаблицаЗначений;\r\n\r\n    // Как будет выглядеть описание печатной формы для пользователя\r\n    Команды.Колонки.Добавить(\"Представление\", Новый ОписаниеТипов(\"Строка\")); \r\n\r\n    // Имя нашего макета, что бы могли отличить вызванную команду в обработке печати\r\n    Команды.Колонки.Добавить(\"Идентификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n\r\n    // Тут задается, как должна вызваться команда обработки\r\n    // Возможные варианты:\r\n    // - ОткрытиеФормы - в этом случае в колонке идентификатор должно быть указано имя формы, которое должна будет открыть система\r\n    // - ВызовКлиентскогоМетода - вызвать клиентскую экспортную процедуру из модуля формы обработки\r\n    // - ВызовСерверногоМетода - вызвать серверную экспортную процедуру из модуля объекта обработки\r\n    Команды.Колонки.Добавить(\"Использование\", Новый ОписаниеТипов(\"Строка\"));\r\n\r\n    // Следующий параметр указывает, необходимо ли показывать оповещение при начале и завершению работы обработки. Не имеет смысла при открытии формы\r\n    Команды.Колонки.Добавить(\"ПоказыватьОповещение\", Новый ОписаниеТипов(\"Булево\"));\r\n\r\n    // Для печатной формы должен содержать строку ПечатьMXL \r\n    Команды.Колонки.Добавить(\"Модификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n    Возврат Команды;\r\n   \r\nКонецФункции\r\n\r\nПроцедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование = \"ОткрытиеФормы\", ПоказыватьОповещение = Ложь, Модификатор = \"ПечатьMXL\")\r\n    \r\n    // Добавляем команду в таблицу команд по переданному описанию.\r\n    // Параметры и их значения можно посмотреть в функции ПолучитьТаблицуКоманд\r\n    НоваяКоманда = ТаблицаКоманд.Добавить();\r\n    НоваяКоманда.Представление = Представление;\r\n    НоваяКоманда.Идентификатор = Идентификатор;\r\n    НоваяКоманда.Использование = Использование;\r\n    НоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;\r\n    НоваяКоманда.Модификатор = Модификатор;\r\n\r\nКонецПроцедуры\n\nФункция СведенияОВнешнейОбработке() Экспорт\r\n    \r\n    ИмяОтчета = ЭтотОбъект.Метаданные().Имя; \r\n    Синоним = ЭтотОбъект.Метаданные().Синоним; \r\n    Синоним = ?(ЗначениеЗаполнено(Синоним),Синоним, ИмяОтчета);         \r\n    РегистрационныеДанные = Новый Структура;\r\n    РегистрационныеДанные.Вставить(\"Вид\",\"ДополнительныйОтчет\"); //может быть – ПечатнаяФорма, ЗаполнениеОбъекта (для вн.обработки), ДополнительныйОтчет, СозданиеСвязанныхОбъектов… \r\n    РегистрационныеДанные.Вставить(\"Наименование\", Синоним); //имя под которым обработка будет зарегестрирована в справочнике внешних обработок\r\n    РегистрационныеДанные.Вставить(\"Версия\", \"1.0\");\r\n    РегистрационныеДанные.Вставить(\"БезопасныйРежим\", Ложь);\r\n    РегистрационныеДанные.Вставить(\"Информация\", \"Отчет \"+Синоним); //так будет выглядеть описание вн.отчета для пользователя\r\n    \r\n    ТаблицаКоманд = ПолучитьТаблицуКоманд();\r\n    \r\n    // Добавим команду в таблицу\r\n    ДобавитьКоманду(ТаблицаКоманд, Синоним, \"СформироватьОтчет\" , \"ОткрытиеФормы\", Истина, );\r\n        \r\n    // Сохраним таблицу команд в параметры регистрации обработки\r\n    РегистрационныеДанные.Вставить(\"Команды\", ТаблицаКоманд);\r\n    \r\n    Возврат РегистрационныеДанные;\r\n                                       \r\nКонецФункции\r\n\r\nФункция ПолучитьТаблицуКоманд()\r\n    \r\n    // Создадим пустую таблицу команд и колонки в ней\r\n    Команды = Новый ТаблицаЗначений;\r\n\r\n    // Как будет выглядеть описание печатной формы для пользователя\r\n    Команды.Колонки.Добавить(\"Представление\", Новый ОписаниеТипов(\"Строка\")); \r\n\r\n    // Имя нашего макета, что бы могли отличить вызванную команду в обработке печати\r\n    Команды.Колонки.Добавить(\"Идентификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n\r\n    // Тут задается, как должна вызваться команда обработки\r\n    // Возможные варианты:\r\n    // - ОткрытиеФормы - в этом случае в колонке идентификатор должно быть указано имя формы, которое должна будет открыть система\r\n    // - ВызовКлиентскогоМетода - вызвать клиентскую экспортную процедуру из модуля формы обработки\r\n    // - ВызовСерверногоМетода - вызвать серверную экспортную процедуру из модуля объекта обработки\r\n    Команды.Колонки.Добавить(\"Использование\", Новый ОписаниеТипов(\"Строка\"));\r\n\r\n    // Следующий параметр указывает, необходимо ли показывать оповещение при начале и завершению работы обработки. Не имеет смысла при открытии формы\r\n    Команды.Колонки.Добавить(\"ПоказыватьОповещение\", Новый ОписаниеТипов(\"Булево\"));\r\n\r\n    // Для печатной формы должен содержать строку ПечатьMXL \r\n    Команды.Колонки.Добавить(\"Модификатор\", Новый ОписаниеТипов(\"Строка\"));\r\n    Возврат Команды;\r\n   \r\nКонецФункции\r\n\r\nПроцедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование = \"ОткрытиеФормы\", ПоказыватьОповещение = Ложь, Модификатор = \"ПечатьMXL\")\r\n    \r\n    // Добавляем команду в таблицу команд по переданному описанию.\r\n    // Параметры и их значения можно посмотреть в функции ПолучитьТаблицуКоманд\r\n    НоваяКоманда = ТаблицаКоманд.Добавить();\r\n    НоваяКоманда.Представление = Представление;\r\n    НоваяКоманда.Идентификатор = Идентификатор;\r\n    НоваяКоманда.Использование = Использование;\r\n    НоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение;\r\n    НоваяКоманда.Модификатор = Модификатор;\r\n\r\nКонецПроцедуры\n\nОрфографическая ошибка в зарегестрирована: зарегестрирована"
  },
  {
    "title": "Сведения о внешней обработке - Печать",
    "description": "Сведения о внешней обработке - Печать",
    "code_snippet": "#Область ОсновныеНастройкиДляПодключенияПечать\r\nФункция ВернутьСтруктуруПараметров()\r\n\t\r\n\tСтруктура = Новый Структура();\r\n\tСтруктура.Вставить(\"Документ\",\"Документ.АктОРасхожденияхПриПоступленииТоваров\");\r\n\tСтруктура.Вставить(\"Представление\",ЭтотОбъект.Метаданные().Представление());\r\n\tСтруктура.Вставить(\"Наименование\",ЭтотОбъект.Метаданные().Синоним);\r\n\tСтруктура.Вставить(\"Идентификатор\",ЭтотОбъект.Метаданные().Имя);\r\n\tСтруктура.Вставить(\"Версия\",\"1.0.0.0\");\r\n\tВозврат Структура;\t\r\n\t\r\nКонецФункции \r\n\r\n\r\nФункция\tСведенияОВнешнейОбработке() ЭКСПОРТ\r\n\t\r\n\tСтруктура = ВернутьСтруктуруПараметров();\r\n\tВерсия = СтандартныеПодсистемыСервер.ВерсияБиблиотеки();\r\n\tСведения = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(Версия);\r\n\tСведения.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиПечатнаяФорма();\r\n\tСведения.Версия = Структура.Версия;\r\n\t\r\n\tМассивНазначений = Новый Массив();\r\n\tМассивНазначений.Добавить(Структура.Документ);\r\n\tСведения.Назначение = МассивНазначений;\r\n\tСведения.Наименование = Структура.Наименование;\r\n\t\r\n\tстр = Сведения.Команды.Добавить();\r\n\tстр.Представление = Структура.Представление;\r\n\tстр.Идентификатор = Структура.Идентификатор;\r\n\tстр.Модификатор\t  = \"ПечатьMXL\";\r\n\tстр.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\t\r\n\tВозврат Сведения;\r\n\t\r\nКонецФункции\r\n\r\nФункция Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) ЭКСПОРТ\r\n\t\r\n\tСтруктура = ВернутьСтруктуруПараметров();\r\n\t\r\n\tЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, Структура.Идентификатор) Тогда\r\n\t\tУправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, Структура.Идентификатор, Структура.Представление, СформироватьПечатнуюФорму(МассивОбъектов, ОбъектыПечати));\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции\r\n\r\nФункция СформироватьПечатнуюФорму(МассивОбъектов, ОбъектыПечати)\r\n\t\r\n\tТабличныйДокумент = Новый ТабличныйДокумент;\r\n\t\r\n\t\r\n\tВозврат ТабличныйДокумент;\r\n\t\r\nКонецФункции\r\n#КонецОбласти\n\n#Область ОсновныеНастройкиДляПодключенияПечать\r\nФункция ВернутьСтруктуруПараметров()\r\n\t\r\n\tСтруктура = Новый Структура();\r\n\tСтруктура.Вставить(\"Документ\",\"Документ.АктОРасхожденияхПриПоступленииТоваров\");\r\n\tСтруктура.Вставить(\"Представление\",ЭтотОбъект.Метаданные().Представление());\r\n\tСтруктура.Вставить(\"Наименование\",ЭтотОбъект.Метаданные().Синоним);\r\n\tСтруктура.Вставить(\"Идентификатор\",ЭтотОбъект.Метаданные().Имя);\r\n\tСтруктура.Вставить(\"Версия\",\"1.0.0.0\");\r\n\tВозврат Структура;\t\r\n\t\r\nКонецФункции \r\n\r\n\r\nФункция\tСведенияОВнешнейОбработке() ЭКСПОРТ\r\n\t\r\n\tСтруктура = ВернутьСтруктуруПараметров();\r\n\tВерсия = СтандартныеПодсистемыСервер.ВерсияБиблиотеки();\r\n\tСведения = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(Версия);\r\n\tСведения.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиПечатнаяФорма();\r\n\tСведения.Версия = Структура.Версия;\r\n\t\r\n\tМассивНазначений = Новый Массив();\r\n\tМассивНазначений.Добавить(Структура.Документ);\r\n\tСведения.Назначение = МассивНазначений;\r\n\tСведения.Наименование = Структура.Наименование;\r\n\t\r\n\tстр = Сведения.Команды.Добавить();\r\n\tстр.Представление = Структура.Представление;\r\n\tстр.Идентификатор = Структура.Идентификатор;\r\n\tстр.Модификатор\t  = \"ПечатьMXL\";\r\n\tстр.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();\t\r\n\tВозврат Сведения;\r\n\t\r\nКонецФункции\r\n\r\nФункция Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) ЭКСПОРТ\r\n\t\r\n\tСтруктура = ВернутьСтруктуруПараметров();\r\n\t\r\n\tЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, Структура.Идентификатор) Тогда\r\n\t\tУправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, Структура.Идентификатор, Структура.Представление, СформироватьПечатнуюФорму(МассивОбъектов, ОбъектыПечати));\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции\r\n\r\nФункция СформироватьПечатнуюФорму(МассивОбъектов, ОбъектыПечати)\r\n\t\r\n\tТабличныйДокумент = Новый ТабличныйДокумент;\r\n\t\r\n\t\r\n\tВозврат ТабличныйДокумент;\r\n\t\r\nКонецФункции\r\n#КонецОбласти\n\n{37} Не все части функции возвращают значение"
  },
  {
    "title": "yacloud",
    "description": "Реализация CLI Яндекс.Облака для OneScript",
    "code_snippet": ""
  },
  {
    "title": "Объединить заголовки табличного документа",
    "description": "Объединить заголовки табличного документа",
    "code_snippet": "Функция ОбработатьЗаголовки(ТабДок)\r\n    ВысотаФ = ТабДок.ФиксацияСверху;\r\n    ШиринаФ = ТабДок.ФиксацияСлева;\r\n    ШиринаТаблицы = ТабДок.ШиринаТаблицы;\r\n    МассивМассивовОбъединяемыхОбластей = Новый Массив;\r\n    МассивОбъединяемыхОбластей = Новый Массив;\r\n    НачальнаяКолонка = ШиринаФ + 1;\r\n    КонечнаяКолонка = ШиринаТаблицы;\r\n    МассивОбъединяемыхОбластей.Добавить(Новый Структура(\"НачальнаяКолонка, КонечнаяКолонка\", НачальнаяКолонка, КонечнаяКолонка));\r\n    МассивМассивовОбъединяемыхОбластей.Добавить(МассивОбъединяемыхОбластей);    \r\n    Строка = 1;\r\n    Пока Строка <= ВысотаФ Цикл\r\n        Если Строка = МассивМассивовОбъединяемыхОбластей.Количество() Тогда\r\n            Для Каждого ОбъединяемаяОбласть Из МассивМассивовОбъединяемыхОбластей[Строка-1] Цикл\r\n                НачальнаяКолонка = ОбъединяемаяОбласть.НачальнаяКолонка;            \r\n                КонечнаяКолонка = ОбъединяемаяОбласть.КонечнаяКолонка;\r\n                Колонка = НачальнаяКолонка;\r\n                Пока Колонка <= КонечнаяКолонка Цикл\r\n                    Если НЕ ОбъединятьЯчейки(ТабДок, Строка, Колонка) ИЛИ Колонка = КонечнаяКолонка Тогда\r\n                        Если Колонка <> НачальнаяКолонка Тогда\r\n                            МассивОбъединяемыхОбластей.Добавить(Новый Структура(\"НачальнаяКолонка, КонечнаяКолонка\", НачальнаяКолонка, Колонка));\r\n                        КонецЕсли;\r\n                        НачальнаяКолонка = Колонка + 1;\r\n                    КонецЕсли;    \r\n                    Колонка = Колонка + 1;\r\n                КонецЦикла;\r\n            КонецЦикла;\r\n            Если МассивОбъединяемыхОбластей.Количество() = 0 И ОбъединяемаяОбласть.НачальнаяКолонка = ШиринаФ + 1 И ОбъединяемаяОбласть.КонечнаяКолонка = ШиринаТаблицы Тогда\r\n                МассивОбъединяемыхОбластей.Добавить(Новый Структура(\"НачальнаяКолонка, КонечнаяКолонка\", ОбъединяемаяОбласть.НачальнаяКолонка, ОбъединяемаяОбласть.КонечнаяКолонка));\r\n            КонецЕсли;    \r\n            МассивМассивовОбъединяемыхОбластей.Добавить(МассивОбъединяемыхОбластей);\r\n            МассивОбъединяемыхОбластей = Новый Массив;\r\n        КонецЕсли;\r\n        Строка = Строка + 1;\r\n    КонецЦикла;\r\n    Строка = 1;\r\n    Пока Строка < МассивМассивовОбъединяемыхОбластей.Количество() Цикл\r\n        Для Каждого ОбъединяемаяОбласть Из МассивМассивовОбъединяемыхОбластей[Строка] Цикл\r\n            ТекстЗаголовка = ТабДок.Область(Строка, ОбъединяемаяОбласть.НачальнаяКолонка).Текст;\r\n            ОбъединяемаяОбласть = ТабДок.Область(Строка, ОбъединяемаяОбласть.НачальнаяКолонка, Строка, ОбъединяемаяОбласть.КонечнаяКолонка);\r\n            ОбъединяемаяОбласть.Объединить();\r\n            ОбъединяемаяОбласть.ГоризонтальноеПоложение = ГоризонтальноеПоложение.Центр;\r\n            ОбъединяемаяОбласть.Текст = ТекстЗаголовка;        \r\n        КонецЦикла;\r\n        Строка = Строка + 1;\r\n    КонецЦикла;\r\n    Возврат ТабДок;\r\nКонецФункции\r\n\r\nФункция ОбъединятьЯчейки(ТабДок, Строка, НачальнаяКолонка)\r\n    Ячейка = ТабДок.Область(Строка, НачальнаяКолонка);\r\n    ЯчейкаСлед = ТабДок.Область(Строка, НачальнаяКолонка+1);\r\n    Если ПустаяСтрока(Ячейка.Текст) Тогда\r\n        Возврат ложь\r\n    ИначеЕсли\r\n        Ячейка.Текст = ЯчейкаСлед.Текст\r\n            И Ячейка.Верх = Ячейка.Низ И ЯчейкаСлед.Верх = ЯчейкаСлед.Низ Тогда\r\n        Возврат Истина;\r\n    Иначе\r\n        Возврат ложь;\r\n    КонецЕсли;\r\nКонецФункции\n\nФункция ОбработатьЗаголовки(ТабДок)\r\n    ВысотаФ = ТабДок.ФиксацияСверху;\r\n    ШиринаФ = ТабДок.ФиксацияСлева;\r\n    ШиринаТаблицы = ТабДок.ШиринаТаблицы;\r\n    МассивМассивовОбъединяемыхОбластей = Новый Массив;\r\n    МассивОбъединяемыхОбластей = Новый Массив;\r\n    НачальнаяКолонка = ШиринаФ + 1;\r\n    КонечнаяКолонка = ШиринаТаблицы;\r\n    МассивОбъединяемыхОбластей.Добавить(Новый Структура(\"НачальнаяКолонка, КонечнаяКолонка\", НачальнаяКолонка, КонечнаяКолонка));\r\n    МассивМассивовОбъединяемыхОбластей.Добавить(МассивОбъединяемыхОбластей);    \r\n    Строка = 1;\r\n    Пока Строка <= ВысотаФ Цикл\r\n        Если Строка = МассивМассивовОбъединяемыхОбластей.Количество() Тогда\r\n            Для Каждого ОбъединяемаяОбласть Из МассивМассивовОбъединяемыхОбластей[Строка-1] Цикл\r\n                НачальнаяКолонка = ОбъединяемаяОбласть.НачальнаяКолонка;            \r\n                КонечнаяКолонка = ОбъединяемаяОбласть.КонечнаяКолонка;\r\n                Колонка = НачальнаяКолонка;\r\n                Пока Колонка <= КонечнаяКолонка Цикл\r\n                    Если НЕ ОбъединятьЯчейки(ТабДок, Строка, Колонка) ИЛИ Колонка = КонечнаяКолонка Тогда\r\n                        Если Колонка <> НачальнаяКолонка Тогда\r\n                            МассивОбъединяемыхОбластей.Добавить(Новый Структура(\"НачальнаяКолонка, КонечнаяКолонка\", НачальнаяКолонка, Колонка));\r\n                        КонецЕсли;\r\n                        НачальнаяКолонка = Колонка + 1;\r\n                    КонецЕсли;    \r\n                    Колонка = Колонка + 1;\r\n                КонецЦикла;\r\n            КонецЦикла;\r\n            Если МассивОбъединяемыхОбластей.Количество() = 0 И ОбъединяемаяОбласть.НачальнаяКолонка = ШиринаФ + 1 И ОбъединяемаяОбласть.КонечнаяКолонка = ШиринаТаблицы Тогда\r\n                МассивОбъединяемыхОбластей.Добавить(Новый Структура(\"НачальнаяКолонка, КонечнаяКолонка\", ОбъединяемаяОбласть.НачальнаяКолонка, ОбъединяемаяОбласть.КонечнаяКолонка));\r\n            КонецЕсли;    \r\n            МассивМассивовОбъединяемыхОбластей.Добавить(МассивОбъединяемыхОбластей);\r\n            МассивОбъединяемыхОбластей = Новый Массив;\r\n        КонецЕсли;\r\n        Строка = Строка + 1;\r\n    КонецЦикла;\r\n    Строка = 1;\r\n    Пока Строка < МассивМассивовОбъединяемыхОбластей.Количество() Цикл\r\n        Для Каждого ОбъединяемаяОбласть Из МассивМассивовОбъединяемыхОбластей[Строка] Цикл\r\n            ТекстЗаголовка = ТабДок.Область(Строка, ОбъединяемаяОбласть.НачальнаяКолонка).Текст;\r\n            ОбъединяемаяОбласть = ТабДок.Область(Строка, ОбъединяемаяОбласть.НачальнаяКолонка, Строка, ОбъединяемаяОбласть.КонечнаяКолонка);\r\n            ОбъединяемаяОбласть.Объединить();\r\n            ОбъединяемаяОбласть.ГоризонтальноеПоложение = ГоризонтальноеПоложение.Центр;\r\n            ОбъединяемаяОбласть.Текст = ТекстЗаголовка;        \r\n        КонецЦикла;\r\n        Строка = Строка + 1;\r\n    КонецЦикла;\r\n    Возврат ТабДок;\r\nКонецФункции\r\n\r\nФункция ОбъединятьЯчейки(ТабДок, Строка, НачальнаяКолонка)\r\n    Ячейка = ТабДок.Область(Строка, НачальнаяКолонка);\r\n    ЯчейкаСлед = ТабДок.Область(Строка, НачальнаяКолонка+1);\r\n    Если ПустаяСтрока(Ячейка.Текст) Тогда\r\n        Возврат ложь\r\n    ИначеЕсли\r\n        Ячейка.Текст = ЯчейкаСлед.Текст\r\n            И Ячейка.Верх = Ячейка.Низ И ЯчейкаСлед.Верх = ЯчейкаСлед.Низ Тогда\r\n        Возврат Истина;\r\n    Иначе\r\n        Возврат ложь;\r\n    КонецЕсли;\r\nКонецФункции"
  },
  {
    "title": "Печать БСП по табличному документу",
    "description": "Печать БСП по табличному документу",
    "code_snippet": "МодульУправлениеПечатьюКлиент = ОбщегоНазначенияКлиент.ОбщийМодуль(\"УправлениеПечатьюКлиент\");\r\n\tИдентификаторПечатнойФормы = \"ПечатьДокумент\";\r\n\t\r\n\tКоллекцияПечатныхФорм = МодульУправлениеПечатьюКлиент.НоваяКоллекцияПечатныхФорм(ИдентификаторПечатнойФормы);\r\n\tПечатнаяФорма = МодульУправлениеПечатьюКлиент.ОписаниеПечатнойФормы(КоллекцияПечатныхФорм, ИдентификаторПечатнойФормы);\r\n\tПечатнаяФорма.СинонимМакета = НСтр(\"ru = 'Наименование заголовка'\");\r\n\tПечатнаяФорма.ТабличныйДокумент = ТабличныйДокумент;  //указываем подготовленный табличный документ\r\n\tПечатнаяФорма.ТабличныйДокумент.АвтоМасштаб = Истина;  //по ширине страницы\r\n\r\n\tМодульУправлениеПечатьюКлиент.ПечатьДокументов(КоллекцияПечатныхФорм);\n\nМодульУправлениеПечатьюКлиент = ОбщегоНазначенияКлиент.ОбщийМодуль(\"УправлениеПечатьюКлиент\");\r\n\tИдентификаторПечатнойФормы = \"ПечатьДокумент\";\r\n\t\r\n\tКоллекцияПечатныхФорм = МодульУправлениеПечатьюКлиент.НоваяКоллекцияПечатныхФорм(ИдентификаторПечатнойФормы);\r\n\tПечатнаяФорма = МодульУправлениеПечатьюКлиент.ОписаниеПечатнойФормы(КоллекцияПечатныхФорм, ИдентификаторПечатнойФормы);\r\n\tПечатнаяФорма.СинонимМакета = НСтр(\"ru = 'Наименование заголовка'\");\r\n\tПечатнаяФорма.ТабличныйДокумент = ТабличныйДокумент;  //указываем подготовленный табличный документ\r\n\tПечатнаяФорма.ТабличныйДокумент.АвтоМасштаб = Истина;  //по ширине страницы\r\n\r\n\tМодульУправлениеПечатьюКлиент.ПечатьДокументов(КоллекцияПечатныхФорм);"
  },
  {
    "title": "Загрузка коммерческих предложений из FTP сайта в 1С УТ 11.4 в формате XML и создание по ним документов \"Заказ клиента\"",
    "description": "Загрузка коммерческих предложений из FTP сайта в 1С УТ 11.4 в формате XML и создание по ним документов \"Заказ клиента\"",
    "code_snippet": "Процедура ЮКОЗ_ЗагрузкаКП() Экспорт\r\n\t\r\n\t//Инициализируем константные переменные\r\n\tКаталогВрФл \t\t= КаталогВременныхФайлов();\r\n\tВидНоменклатуры \t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ВидыНоменклатурыТовар\");\r\n\tЕдиницаИзмШТ \t\t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ЕдиницаИзмерения_ШТ\");\r\n\tПриоритетСредний \t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ПриоритетСредний\");\r\n\tСкладОсновной \t\t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"СкладОсновной\");\r\n\tТиповоеСоглашение \t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ТиповоеСоглашение\");\r\n\tВалютаДок \t\t\t= Константы.ВалютаРегламентированногоУчета.Получить(); \r\n\tАдресFTP\t\t\t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"АдресFTP\");\r\n\tЛогинFTP\t\t\t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ЛогинFTP\");\r\n\tПарольFTP\t\t\t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ПарольFTP\");\r\n\t\r\n\t//Соединямся с FTP-сервером и ищем необработанные файлы xml\r\n\tФТПСоединение = Новый FTPСоединение(АдресFTP,, ЛогинFTP, ПарольFTP,, Истина);\r\n\tНайдемФайлаНаФТП = ФТПСоединение.НайтиФайлы(\"/\", \"*.xml\");\r\n\t\r\n\t//Если файлов нет, значит завершаем работу\r\n\tЕсли НайдемФайлаНаФТП.Количество() = 0 Тогда\r\n\t\tФТПСоединение = Неопределено;\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n\t//Подготавливаем таблицу значений для заполнения загружаемыми данными\r\n\tДанныеИзФайлаТовары = Новый ТаблицаЗначений();\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Артикул\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"ИД\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Производитель\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Номенклатура\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Количество\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Цена\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Размер\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Цвет\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Серия\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"ЦенаСоСкидкой\");\r\n\r\n\t//Циклом обходим каждый найденный на FTP файл xml\t\r\n\tДля каждого ФайлФТП из НайдемФайлаНаФТП Цикл\r\n\t\t\r\n\t\t//Очищаем нашу таблицу значений, чтобы она могла хранить данные только по одному файлу xml\r\n\t\tДанныеИзФайлаТовары.Очистить();\r\n\t\t\r\n\t\t//Получаем номер коммерческого предложения из имени файла xml\r\n\t\tНомерКП = ФайлФТП.ИмяБезРасширения;\r\n\t\t\r\n\t\t//Очищаем дату коммерческого предложения кототрую мы впоследствии возьмом из тела файла xml\r\n\t\tДатаКП = \"\";\r\n\t\t\t\t\t\t\r\n\t\t//Обернём код в попытку, мало ли будут ошибки при загрузке и обработке файла\r\n\t\tПопытка\r\n\t\t\t\r\n\t\t//Загружаем файл на локальный компьютер\t\r\n\t\tПутьКФайлуОбъект = КаталогВрФл + ФайлФТП.Имя;\r\n\t\tФТПСоединение.Получить(ФайлФТП.ПолноеИмя, ПутьКФайлуОбъект);\t\r\n\t\t\r\n\t\t//Перемещаем загруженный файл в директорию обработанных файлов на FTP\r\n\t\t//Специально помещаем в начале, чтобы регламентное задание в случае ошибок в этом файле каждый раз не спотыкалось об него\r\n\t\tФТПСоединение.Переместить(ФайлФТП.ПолноеИмя, \"OldFiles\" + \"\\\" + ФайлФТП.Имя);\r\n\t\t\r\n\t\t//Инициализируем чтение файла xml\r\n\t\tЧтениеXML = Новый ЧтениеXML;\r\n\t\tЧтениеXML.ОткрытьФайл(ПутьКФайлуОбъект);\r\n\t\t\r\n\t\t//Циклом обходим узлы XML файла и при совпадении с нужным именем узла записываем его значение в нашу таблицу значений\r\n\t\tПока ЧтениеXML.Прочитать() Цикл\r\n\t\t\tЕсли ЧтениеXML.ТипУзла <> ТипУзлаXML.НачалоЭлемента Тогда Продолжить; КонецЕсли;\r\n\t\t\tИмяУзла = ЧтениеXML.ЛокальноеИмя;\t\r\n\t\t\tЕсли ИмяУзла = \"PRODUCT\" Тогда\r\n\t\t\t\tНоваяСтрока = ДанныеИзФайлаТовары.Добавить();\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"ID\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.ИД = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"ARTICLE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Артикул = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"SIZE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Размер = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"COLOR\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Цвет = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"NAME\" И ЧтениеXML.КонтекстПространствИмен.Глубина = 5 Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Серия = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PROPERTY_PROVIDER_NAME\" И ЧтениеXML.КонтекстПространствИмен.Глубина = 5 Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Производитель = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"NAME\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Номенклатура = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"QUANTITY\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Количество = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PRICE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Цена = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PRICE_DISCOUNT\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.ЦенаСоСкидкой = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"DATE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tДатаСтр = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tДатаКП = Дата(ДатаСтр);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\t//Закрываем чтение XML и удаляем ранее загруженный временный файл из нашего компьютера\r\n\t\tЧтениеXML.Закрыть();\r\n\t\tУдалитьФайлы(ПутьКФайлуОбъект);\r\n\t\t\r\n\t\t//Дата коммерческого предложения обязательно должна быть заполнена, если нет, то вызываем ошибку с пояснением для журнала регистрации\r\n\t\tЕсли НЕ ЗначениеЗаполнено(ДатаКП) Тогда\r\n\t\t\tВызватьИсключение \"Пустая дата по КП \" + НомерКП;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//Запросом найдем уже созданный ранее заказ клиента по загружаемому файлу\r\n\t\t//Плохо, что запрос в цикле, но в данном случае можно ;) дабы не усложнять код.\r\n\t\tЗапросСущЗаказа = Новый Запрос();\r\n\t\tЗапросСущЗаказа.УстановитьПараметр(\"НомерКП\", НомерКП);\r\n\t\tЗапросСущЗаказа.УстановитьПараметр(\"ДатаКП\", НачалоДня(ДатаКП));\r\n\t\tЗапросСущЗаказа.Текст = \"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t                        |\tЗаказКлиента.Ссылка КАК Ссылка,\r\n\t\t                        |\tЗаказКлиента.Проведен КАК Проведен\r\n\t\t                        |ИЗ\r\n\t\t                        |\tДокумент.ЗаказКлиента КАК ЗаказКлиента\r\n\t\t                        |ГДЕ\r\n\t\t                        |\tЗаказКлиента.НомерПоДаннымКлиента = &НомерКП\r\n\t\t                        |\tИ ЗаказКлиента.ДатаПоДаннымКлиента = &ДатаКП\";\r\n\t\tРезультат_ЗапросСущЗаказа = ЗапросСущЗаказа.Выполнить().Выбрать();\r\n\t\t\r\n\t\t//Если заказ клиента найден и он проведен, то обновлять\\изменять мы его уже не можем и вызываем ошибку с пояснением,\r\n\t\t//если еще не проведен, то получаем ссылку на документ и работаем дальше\r\n\t\tЕсли Результат_ЗапросСущЗаказа.Следующий() Тогда\r\n\t\t\tЕсли Результат_ЗапросСущЗаказа.Проведен Тогда\r\n\t\t\t\tВызватьИсключение \"Заказ уже проведен по КП \" + НомерКП;\t\r\n\t\t\tКонецЕсли;\r\n\t\t\tДокЗаказ = Результат_ЗапросСущЗаказа.Ссылка.ПолучитьОбъект();\r\n\t\t\t\r\n\t\t//Если заказ клиента по загружаемому xml файлу еще не было, то создаем и заполняем его\t\r\n\t\tИначе\r\n\t\t\tДокЗаказ = Документы.ЗаказКлиента.СоздатьДокумент();\r\n\t\t\tДокЗаказ.Дата = ТекущаяДата();\t\t\r\n\t\t\tДокЗаказ.ЮКОЗ_НомерКПИзСайта = НомерКП;\r\n\t\t\tДокЗаказ.Приоритет = ПриоритетСредний;\r\n\t\t\tДокЗаказ.ХозяйственнаяОперация = Перечисления.ХозяйственныеОперации.РеализацияКлиенту;\r\n\t\t\tДокЗаказ.ЦенаВключаетНДС = Истина;\r\n\t\t\tДокЗаказ.НалогообложениеНДС = Перечисления.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС;\r\n\t\t\tДокЗаказ.НомерПоДаннымКлиента = НомерКП;\r\n\t\t\tДокЗаказ.ДатаПоДаннымКлиента = ДатаКП;\r\n\t\t\tДокЗаказ.Склад = СкладОсновной;\r\n\t\t\tДокЗаказ.Статус = Перечисления.СтатусыЗаказовКлиентов.КОтгрузке;\r\n\t\t\tДокЗаказ.ЮКОЗ_Статус = Перечисления.ЮКОЗ_СтатусыЗаказовКлиентов.Согласование;\r\n\t\t\tДокЗаказ.Валюта = ВалютаДок;\r\n\t\t\tДокЗаказ.Соглашение = ТиповоеСоглашение;\r\n\t\t\tДокЗаказ.НеОтгружатьЧастями = Истина;\r\n\t\t\tДокЗаказ.ПорядокОплаты = Перечисления.ПорядокОплатыПоСоглашениям.РасчетыВВалютеОплатаВВалюте;\r\n\t\t\tДокЗаказ.ФормаОплаты = Перечисления.ФормыОплаты.Безналичная;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//Очистим табличную часть Товары (на тот случай, если заказ клиента уже был ранее создан и там были какие-то данные)\r\n\t\tДокЗаказ.Товары.Очистить();\r\n\t\t\r\n\t\t//Обходим данные из файла через нашу таблицу значений\r\n\t\tДля каждого стр из ДанныеИзФайлаТовары Цикл\r\n\t\t\t\r\n\t\t\t//Проверям на заполнение обязательный полей (артикул, производитель, номенклатура), если хоть что-то не заполнено, то вызываем ошибку с пояснением\r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(стр.Артикул) И НЕ ЗначениеЗаполнено(стр.ИД) Тогда\r\n\t\t\t\tВызватьИсключение \"Пустой артикул и ID по КП \" + НомерКП;\t\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(стр.Производитель) Тогда\r\n\t\t\t\tВызватьИсключение \"Пустой производитель по КП \" + НомерКП;\t\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(стр.Номенклатура) Тогда\r\n\t\t\t\tВызватьИсключение \"Пустая номенклатура по КП \" + НомерКП;\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\t//Пытаемся найти уже созданную номенклатуру по артикулу, а если он не заполнен, то по ИД.\r\n\t\t\tЗапросСущТовара = Новый Запрос();\r\n\t\t\tЗапросСущТовара.УстановитьПараметр(\"ИД\", стр.ИД);\r\n\t\t\tЗапросСущТовара.Текст = \"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t\t                        |\tНоменклатура.Ссылка КАК Ссылка\r\n\t\t\t                        |ИЗ\r\n\t\t\t                        |\tСправочник.Номенклатура КАК Номенклатура\r\n\t\t\t                        |ГДЕ\" + Символы.ПС;\r\n\t\t\tЕсли ЗначениеЗаполнено(стр.Артикул) Тогда\t\t\t\t\t\t\r\n\t\t\t\tЗапросСущТовара.Текст = ЗапросСущТовара.Текст + \"Номенклатура.Артикул = &Артикул\";\r\n\t\t\tИначе\t\r\n\t\t\t    ЗапросСущТовара.Текст = ЗапросСущТовара.Текст + \"Номенклатура.ЮКОЗ_IDИзСайта = &ИД\";\r\n\t\t\tКонецЕсли;\r\n\t\t\tРезультат_ЗапросСущТовара = ЗапросСущТовара.Выполнить().Выбрать();\r\n\t\t\t\r\n\t\t\t//Формируем представление строки описания номенклатуры (строковая характеристика)\r\n\t\t\tДобТоварЮКОЗ_Характеристика = ?(ЗначениеЗаполнено(стр.Серия), стр.Серия + \", \", \"\") +\r\n\t\t\t\t                           ?(ЗначениеЗаполнено(стр.Размер), стр.Размер + \", \", \"\") +\r\n\t\t\t\t\t\t\t\t\t\t   ?(ЗначениеЗаполнено(стр.Цвет), стр.Цвет, \"\");\r\n\r\n\t\t\t//Получаем ссылку на номенклатуру если она найдена\r\n\t\t\tЕсли Результат_ЗапросСущТовара.Следующий() Тогда\r\n\t\t\t\tТоварСсылка = Результат_ЗапросСущТовара.Ссылка;\r\n\t\t\t\t\r\n\t\t\t//Если номенклатура не найдена, то создаем её\t\r\n\t\t\tИначе\r\n\t\t\t\tТоварНовый = Справочники.Номенклатура.СоздатьЭлемент();\r\n\t\t\t\t\r\n\t\t\t\t//Каждая номенлатура должна находится в своей группе в справочнике номенклатура, где название группы - это наименование производителя\r\n\t\t\t\t//проверяем это запросом\r\n\t\t\t\tЗапросСущГруппы = Новый Запрос();\r\n\t\t\t\tЗапросСущГруппы.УстановитьПараметр(\"Производитель\", стр.Производитель);\r\n\t\t\t\tЗапросСущГруппы.Текст = \"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t\t\t                        |\tНоменклатура.Ссылка КАК Ссылка\r\n\t\t\t\t                        |ИЗ\r\n\t\t\t\t                        |\tСправочник.Номенклатура КАК Номенклатура\r\n\t\t\t\t                        |ГДЕ\r\n\t\t\t\t                        |\tНоменклатура.Наименование = &Производитель\r\n\t\t\t\t                        |\tИ Номенклатура.ЭтоГруппа\";\r\n\t\t\t\tРезультат_ЗапросСущГруппы = ЗапросСущГруппы.Выполнить().Выбрать();\r\n\t\t\t\t\r\n\t\t\t\t//Если группа найдено, то берем ссылку на неё\r\n\t\t\t\tЕсли Результат_ЗапросСущГруппы.Следующий() Тогда\r\n\t\t\t\t\tГруппаТовараСсылка = Результат_ЗапросСущГруппы.Ссылка;\r\n\t\t\t\t\t\r\n\t\t\t\t//Если группа не найдена, то создаем её\t\r\n\t\t\t\tИначе\r\n\t\t\t\t\tГруппаТовараСсылка = Справочники.Номенклатура.СоздатьГруппу();\r\n\t\t\t\t\tГруппаТовараСсылка.Наименование = стр.Производитель;\r\n\t\t\t\t\tГруппаТовараСсылка.Записать();\r\n\t\t\t\t\tГруппаТовараСсылка = ГруппаТовараСсылка.Ссылка;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\t\t//Указываем, что номенклатуру мы создаем в группе которую нашли\\создали чуть ранее\r\n\t\t\t\tТоварНовый.Родитель = ГруппаТовараСсылка;\r\n\t\t\t\t\r\n\t\t\t\t//Формируем представление наименования номенклатуры, оно должно содержать артикул, а если его нет, то ИД\r\n\t\t\t\t//Также записываем артикул, если его нет, то ИД вместо него.\r\n\t\t\t\tЕсли ЗначениеЗаполнено(стр.Артикул) Тогда\t\t\t\t\t\t\r\n\t\t\t\t\tТоварНовый.Артикул = стр.Артикул;\r\n\t\t\t\t\tТоварНовый.Наименование = Строка(?(ЗначениеЗаполнено(стр.Артикул), \"(\" + стр.Артикул + \") \", \"\") + стр.Номенклатура);\r\n\t\t\t\tИначе\t\r\n\t\t\t\t\tТоварНовый.Наименование = Строка(?(ЗначениеЗаполнено(стр.ИД), \"(\" + стр.ИД + \") \", \"\") + стр.Номенклатура);\r\n\t\t\t    \tТоварНовый.Артикул = стр.ИД;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\t\t//Добавляем в наименование номенклатуры строковое описание номенклатуры, которое мы сформировали ранее,\r\n\t\t\t\t//при условии, что описание номенклатуры есть и оно уже не встречается в наименовании номенклатуры\r\n\t\t\t\tЕсли ЗначениеЗаполнено(ДобТоварЮКОЗ_Характеристика) Тогда \r\n\t\t\t\t\tЕсли СтрНайти(СтрЗаменить(ТоварНовый.Наименование, \",\", \"\"), \r\n\t\t\t\t\t\t\t\t  СтрЗаменить(ДобТоварЮКОЗ_Характеристика, \",\", \"\")) = 0 Тогда\r\n\t\t\t\t\t\tТоварНовый.Наименование = ТоварНовый.Наименование + \", \" + ДобТоварЮКОЗ_Характеристика;\t\r\n\t\t\t\t\tКонецЕсли;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\t\t//Заполняем остальные поля номенклатуры\r\n\t\t\t\tТоварНовый.ЮКОЗ_IDИзСайта = стр.ИД;\r\n\t\t\t\tТоварНовый.ТипНоменклатуры = Перечисления.ТипыНоменклатуры.Товар;\r\n\t\t\t\tТоварНовый.ВидНоменклатуры = ВидНоменклатуры;\r\n  \t\t\t    ТоварНовый.НаименованиеПолное = стр.Номенклатура + ?(ЗначениеЗаполнено(ДобТоварЮКОЗ_Характеристика), \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  \", \" + ДобТоварЮКОЗ_Характеристика, \"\");\r\n\t\t\t\tТоварНовый.СтавкаНДС = Перечисления.СтавкиНДС.НДС20;\r\n\t\t\t\tТоварНовый.ЕдиницаИзмерения = ЕдиницаИзмШТ;\r\n\t\t\t\tТоварНовый.ЕдиницаДляОтчетов = ЕдиницаИзмШТ;\r\n\t\t\t\tТоварНовый.ИспользованиеХарактеристик = Перечисления.ВариантыИспользованияХарактеристикНоменклатуры.НеИспользовать;\r\n\t\t\t\tТоварНовый.ВариантОформленияПродажи = Перечисления.ВариантыОформленияПродажи.РеализацияТоваровУслуг;\r\n\t\t\t\t\r\n\t\t\t\t//Ищем производителя, если его нет, то создаем нового и указываем его в номенклатуре\r\n\t\t\t\tПроизводительСсылка = Справочники.Производители.НайтиПоНаименованию(стр.Производитель);\r\n\t\t\t\tЕсли НЕ ЗначениеЗаполнено(ПроизводительСсылка) Тогда\r\n\t\t\t\t\tНовыйПроизводитель = Справочники.Производители.СоздатьЭлемент();\r\n\t\t\t\t\tНовыйПроизводитель.Наименование = стр.Производитель;\r\n\t\t\t\t\tНовыйПроизводитель.Записать();\r\n\t\t\t\t\tПроизводительСсылка = НовыйПроизводитель.Ссылка;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\t\tТоварНовый.Производитель = ПроизводительСсылка;\r\n\t\t\t\t\r\n\t\t\t\t//Записываем новую номенклатуру и получаем ссылку на неё\r\n\t\t\t\tТоварНовый.Записать();\r\n\t\t\t\tТоварСсылка = ТоварНовый.Ссылка;\r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\t//Добавляем в табличную часть Товары номенклатуру с заполнением данных из файла xml\r\n\t\t\tДобТовар = ДокЗаказ.Товары.Добавить();\r\n\t\t\tДобТовар.Номенклатура = ТоварСсылка;\r\n\t\t\tДобТовар.Количество = стр.Количество;\r\n\t\t\tДобТовар.КоличествоУпаковок = стр.Количество;\r\n\t\t\tДобТовар.Упаковка = ДобТовар.Номенклатура.ЕдиницаИзмерения;\r\n\t\t\tДобТовар.Цена = стр.Цена;\r\n\t\t\tДобТовар.СтавкаНДС = ДобТовар.Номенклатура.СтавкаНДС;\r\n\t\t\tДобТовар.Склад = СкладОсновной;\r\n\t\t\tДобТовар.ЮКОЗ_Характеристика = ДобТоварЮКОЗ_Характеристика;\r\n\t\t\t\r\n\t\t\t//Вычисляем процент ручной скидки, если в файле xml была указана цена со скидкой и она меньше, чем обычная цена\r\n\t\t\tЕсли ЗначениеЗаполнено(стр.ЦенаСоСкидкой) И ЗначениеЗаполнено(стр.Цена) Тогда \r\n\t\t\t\tстрЦенаСоСкидкой = Число(стр.ЦенаСоСкидкой);\r\n\t\t\t\tстрЦена = Число(стр.Цена);\t\t\r\n\t\t\t\tЕсли стрЦенаСоСкидкой > 0 И стрЦена > 0 И стрЦена > стрЦенаСоСкидкой Тогда\r\n\t\t\t\t\tДобТовар.ПроцентРучнойСкидки = (стрЦенаСоСкидкой / стрЦена - 1) * 100 * -1;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\t//Посчитаем сумму строки, а также НДС\r\n\t\tСтруктураПересчетаСуммы = ОбработкаТабличнойЧастиКлиентСервер.ПараметрыПересчетаСуммыНДСВСтрокеТЧ(ДокЗаказ);\t\r\n\t\tСтруктураДействий = Новый Структура;\t\r\n\t\tСтруктураДействий.Вставить(\"ПересчитатьСумму\", \"КоличествоУпаковок\");\r\n\t\tСтруктураДействий.Вставить(\"ПересчитатьСуммуНДС\", СтруктураПересчетаСуммы);\r\n\t\tСтруктураДействий.Вставить(\"ПересчитатьСуммуСНДС\", СтруктураПересчетаСуммы);\r\n\t\tОбработкаТабличнойЧастиСервер.ОбработатьТЧ(ДокЗаказ.Товары, СтруктураДействий, Неопределено);\r\n\t\t\r\n\t\t//Запишем заказ клиента без проведения\r\n\t\tДокЗаказ.Записать(РежимЗаписиДокумента.Запись);\r\n\t\t\r\n\t\t//Обработаем исключения в блоке попытки с записью в журнал регистрации для дальнейшего анализа\r\n\t\tИсключение\r\n\t\t\tЗаписьЖурналаРегистрации(\"Ошибка обработки КП из сайта: \" + ОписаниеОшибки(), УровеньЖурналаРегистрации.Ошибка);\r\n\t\tКонецПопытки;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t//После обработки всех файлов, закроем FTP соединение.\r\n\tФТПСоединение = Неопределено;\r\n\t\r\nКонецПроцедуры\n\nПроцедура ЮКОЗ_ЗагрузкаКП() Экспорт\r\n\t\r\n\t//Инициализируем константные переменные\r\n\tКаталогВрФл \t\t= КаталогВременныхФайлов();\r\n\tВидНоменклатуры \t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ВидыНоменклатурыТовар\");\r\n\tЕдиницаИзмШТ \t\t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ЕдиницаИзмерения_ШТ\");\r\n\tПриоритетСредний \t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ПриоритетСредний\");\r\n\tСкладОсновной \t\t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"СкладОсновной\");\r\n\tТиповоеСоглашение \t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ТиповоеСоглашение\");\r\n\tВалютаДок \t\t\t= Константы.ВалютаРегламентированногоУчета.Получить(); \r\n\tАдресFTP\t\t\t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"АдресFTP\");\r\n\tЛогинFTP\t\t\t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ЛогинFTP\");\r\n\tПарольFTP\t\t\t= РегистрыСведений.ЮКОЗ_ДополнительныеНастройки.ПолучитьНастройки(\"ПарольFTP\");\r\n\t\r\n\t//Соединямся с FTP-сервером и ищем необработанные файлы xml\r\n\tФТПСоединение = Новый FTPСоединение(АдресFTP,, ЛогинFTP, ПарольFTP,, Истина);\r\n\tНайдемФайлаНаФТП = ФТПСоединение.НайтиФайлы(\"/\", \"*.xml\");\r\n\t\r\n\t//Если файлов нет, значит завершаем работу\r\n\tЕсли НайдемФайлаНаФТП.Количество() = 0 Тогда\r\n\t\tФТПСоединение = Неопределено;\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n\t//Подготавливаем таблицу значений для заполнения загружаемыми данными\r\n\tДанныеИзФайлаТовары = Новый ТаблицаЗначений();\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Артикул\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"ИД\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Производитель\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Номенклатура\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Количество\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Цена\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Размер\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Цвет\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Серия\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"ЦенаСоСкидкой\");\r\n\r\n\t//Циклом обходим каждый найденный на FTP файл xml\t\r\n\tДля каждого ФайлФТП из НайдемФайлаНаФТП Цикл\r\n\t\t\r\n\t\t//Очищаем нашу таблицу значений, чтобы она могла хранить данные только по одному файлу xml\r\n\t\tДанныеИзФайлаТовары.Очистить();\r\n\t\t\r\n\t\t//Получаем номер коммерческого предложения из имени файла xml\r\n\t\tНомерКП = ФайлФТП.ИмяБезРасширения;\r\n\t\t\r\n\t\t//Очищаем дату коммерческого предложения кототрую мы впоследствии возьмом из тела файла xml\r\n\t\tДатаКП = \"\";\r\n\t\t\t\t\t\t\r\n\t\t//Обернём код в попытку, мало ли будут ошибки при загрузке и обработке файла\r\n\t\tПопытка\r\n\t\t\t\r\n\t\t//Загружаем файл на локальный компьютер\t\r\n\t\tПутьКФайлуОбъект = КаталогВрФл + ФайлФТП.Имя;\r\n\t\tФТПСоединение.Получить(ФайлФТП.ПолноеИмя, ПутьКФайлуОбъект);\t\r\n\t\t\r\n\t\t//Перемещаем загруженный файл в директорию обработанных файлов на FTP\r\n\t\t//Специально помещаем в начале, чтобы регламентное задание в случае ошибок в этом файле каждый раз не спотыкалось об него\r\n\t\tФТПСоединение.Переместить(ФайлФТП.ПолноеИмя, \"OldFiles\" + \"\\\" + ФайлФТП.Имя);\r\n\t\t\r\n\t\t//Инициализируем чтение файла xml\r\n\t\tЧтениеXML = Новый ЧтениеXML;\r\n\t\tЧтениеXML.ОткрытьФайл(ПутьКФайлуОбъект);\r\n\t\t\r\n\t\t//Циклом обходим узлы XML файла и при совпадении с нужным именем узла записываем его значение в нашу таблицу значений\r\n\t\tПока ЧтениеXML.Прочитать() Цикл\r\n\t\t\tЕсли ЧтениеXML.ТипУзла <> ТипУзлаXML.НачалоЭлемента Тогда Продолжить; КонецЕсли;\r\n\t\t\tИмяУзла = ЧтениеXML.ЛокальноеИмя;\t\r\n\t\t\tЕсли ИмяУзла = \"PRODUCT\" Тогда\r\n\t\t\t\tНоваяСтрока = ДанныеИзФайлаТовары.Добавить();\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"ID\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.ИД = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"ARTICLE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Артикул = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"SIZE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Размер = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"COLOR\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Цвет = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"NAME\" И ЧтениеXML.КонтекстПространствИмен.Глубина = 5 Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Серия = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PROPERTY_PROVIDER_NAME\" И ЧтениеXML.КонтекстПространствИмен.Глубина = 5 Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Производитель = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"NAME\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Номенклатура = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"QUANTITY\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Количество = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PRICE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Цена = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PRICE_DISCOUNT\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.ЦенаСоСкидкой = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"DATE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tДатаСтр = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tДатаКП = Дата(ДатаСтр);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\t//Закрываем чтение XML и удаляем ранее загруженный временный файл из нашего компьютера\r\n\t\tЧтениеXML.Закрыть();\r\n\t\tУдалитьФайлы(ПутьКФайлуОбъект);\r\n\t\t\r\n\t\t//Дата коммерческого предложения обязательно должна быть заполнена, если нет, то вызываем ошибку с пояснением для журнала регистрации\r\n\t\tЕсли НЕ ЗначениеЗаполнено(ДатаКП) Тогда\r\n\t\t\tВызватьИсключение \"Пустая дата по КП \" + НомерКП;\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//Запросом найдем уже созданный ранее заказ клиента по загружаемому файлу\r\n\t\t//Плохо, что запрос в цикле, но в данном случае можно ;) дабы не усложнять код.\r\n\t\tЗапросСущЗаказа = Новый Запрос();\r\n\t\tЗапросСущЗаказа.УстановитьПараметр(\"НомерКП\", НомерКП);\r\n\t\tЗапросСущЗаказа.УстановитьПараметр(\"ДатаКП\", НачалоДня(ДатаКП));\r\n\t\tЗапросСущЗаказа.Текст = \"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t                        |\tЗаказКлиента.Ссылка КАК Ссылка,\r\n\t\t                        |\tЗаказКлиента.Проведен КАК Проведен\r\n\t\t                        |ИЗ\r\n\t\t                        |\tДокумент.ЗаказКлиента КАК ЗаказКлиента\r\n\t\t                        |ГДЕ\r\n\t\t                        |\tЗаказКлиента.НомерПоДаннымКлиента = &НомерКП\r\n\t\t                        |\tИ ЗаказКлиента.ДатаПоДаннымКлиента = &ДатаКП\";\r\n\t\tРезультат_ЗапросСущЗаказа = ЗапросСущЗаказа.Выполнить().Выбрать();\r\n\t\t\r\n\t\t//Если заказ клиента найден и он проведен, то обновлять\\изменять мы его уже не можем и вызываем ошибку с пояснением,\r\n\t\t//если еще не проведен, то получаем ссылку на документ и работаем дальше\r\n\t\tЕсли Результат_ЗапросСущЗаказа.Следующий() Тогда\r\n\t\t\tЕсли Результат_ЗапросСущЗаказа.Проведен Тогда\r\n\t\t\t\tВызватьИсключение \"Заказ уже проведен по КП \" + НомерКП;\t\r\n\t\t\tКонецЕсли;\r\n\t\t\tДокЗаказ = Результат_ЗапросСущЗаказа.Ссылка.ПолучитьОбъект();\r\n\t\t\t\r\n\t\t//Если заказ клиента по загружаемому xml файлу еще не было, то создаем и заполняем его\t\r\n\t\tИначе\r\n\t\t\tДокЗаказ = Документы.ЗаказКлиента.СоздатьДокумент();\r\n\t\t\tДокЗаказ.Дата = ТекущаяДата();\t\t\r\n\t\t\tДокЗаказ.ЮКОЗ_НомерКПИзСайта = НомерКП;\r\n\t\t\tДокЗаказ.Приоритет = ПриоритетСредний;\r\n\t\t\tДокЗаказ.ХозяйственнаяОперация = Перечисления.ХозяйственныеОперации.РеализацияКлиенту;\r\n\t\t\tДокЗаказ.ЦенаВключаетНДС = Истина;\r\n\t\t\tДокЗаказ.НалогообложениеНДС = Перечисления.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС;\r\n\t\t\tДокЗаказ.НомерПоДаннымКлиента = НомерКП;\r\n\t\t\tДокЗаказ.ДатаПоДаннымКлиента = ДатаКП;\r\n\t\t\tДокЗаказ.Склад = СкладОсновной;\r\n\t\t\tДокЗаказ.Статус = Перечисления.СтатусыЗаказовКлиентов.КОтгрузке;\r\n\t\t\tДокЗаказ.ЮКОЗ_Статус = Перечисления.ЮКОЗ_СтатусыЗаказовКлиентов.Согласование;\r\n\t\t\tДокЗаказ.Валюта = ВалютаДок;\r\n\t\t\tДокЗаказ.Соглашение = ТиповоеСоглашение;\r\n\t\t\tДокЗаказ.НеОтгружатьЧастями = Истина;\r\n\t\t\tДокЗаказ.ПорядокОплаты = Перечисления.ПорядокОплатыПоСоглашениям.РасчетыВВалютеОплатаВВалюте;\r\n\t\t\tДокЗаказ.ФормаОплаты = Перечисления.ФормыОплаты.Безналичная;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//Очистим табличную часть Товары (на тот случай, если заказ клиента уже был ранее создан и там были какие-то данные)\r\n\t\tДокЗаказ.Товары.Очистить();\r\n\t\t\r\n\t\t//Обходим данные из файла через нашу таблицу значений\r\n\t\tДля каждого стр из ДанныеИзФайлаТовары Цикл\r\n\t\t\t\r\n\t\t\t//Проверям на заполнение обязательный полей (артикул, производитель, номенклатура), если хоть что-то не заполнено, то вызываем ошибку с пояснением\r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(стр.Артикул) И НЕ ЗначениеЗаполнено(стр.ИД) Тогда\r\n\t\t\t\tВызватьИсключение \"Пустой артикул и ID по КП \" + НомерКП;\t\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(стр.Производитель) Тогда\r\n\t\t\t\tВызватьИсключение \"Пустой производитель по КП \" + НомерКП;\t\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(стр.Номенклатура) Тогда\r\n\t\t\t\tВызватьИсключение \"Пустая номенклатура по КП \" + НомерКП;\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\t//Пытаемся найти уже созданную номенклатуру по артикулу, а если он не заполнен, то по ИД.\r\n\t\t\tЗапросСущТовара = Новый Запрос();\r\n\t\t\tЗапросСущТовара.УстановитьПараметр(\"ИД\", стр.ИД);\r\n\t\t\tЗапросСущТовара.Текст = \"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t\t                        |\tНоменклатура.Ссылка КАК Ссылка\r\n\t\t\t                        |ИЗ\r\n\t\t\t                        |\tСправочник.Номенклатура КАК Номенклатура\r\n\t\t\t                        |ГДЕ\" + Символы.ПС;\r\n\t\t\tЕсли ЗначениеЗаполнено(стр.Артикул) Тогда\t\t\t\t\t\t\r\n\t\t\t\tЗапросСущТовара.Текст = ЗапросСущТовара.Текст + \"Номенклатура.Артикул = &Артикул\";\r\n\t\t\tИначе\t\r\n\t\t\t    ЗапросСущТовара.Текст = ЗапросСущТовара.Текст + \"Номенклатура.ЮКОЗ_IDИзСайта = &ИД\";\r\n\t\t\tКонецЕсли;\r\n\t\t\tРезультат_ЗапросСущТовара = ЗапросСущТовара.Выполнить().Выбрать();\r\n\t\t\t\r\n\t\t\t//Формируем представление строки описания номенклатуры (строковая характеристика)\r\n\t\t\tДобТоварЮКОЗ_Характеристика = ?(ЗначениеЗаполнено(стр.Серия), стр.Серия + \", \", \"\") +\r\n\t\t\t\t                           ?(ЗначениеЗаполнено(стр.Размер), стр.Размер + \", \", \"\") +\r\n\t\t\t\t\t\t\t\t\t\t   ?(ЗначениеЗаполнено(стр.Цвет), стр.Цвет, \"\");\r\n\r\n\t\t\t//Получаем ссылку на номенклатуру если она найдена\r\n\t\t\tЕсли Результат_ЗапросСущТовара.Следующий() Тогда\r\n\t\t\t\tТоварСсылка = Результат_ЗапросСущТовара.Ссылка;\r\n\t\t\t\t\r\n\t\t\t//Если номенклатура не найдена, то создаем её\t\r\n\t\t\tИначе\r\n\t\t\t\tТоварНовый = Справочники.Номенклатура.СоздатьЭлемент();\r\n\t\t\t\t\r\n\t\t\t\t//Каждая номенлатура должна находится в своей группе в справочнике номенклатура, где название группы - это наименование производителя\r\n\t\t\t\t//проверяем это запросом\r\n\t\t\t\tЗапросСущГруппы = Новый Запрос();\r\n\t\t\t\tЗапросСущГруппы.УстановитьПараметр(\"Производитель\", стр.Производитель);\r\n\t\t\t\tЗапросСущГруппы.Текст = \"ВЫБРАТЬ ПЕРВЫЕ 1\r\n\t\t\t\t                        |\tНоменклатура.Ссылка КАК Ссылка\r\n\t\t\t\t                        |ИЗ\r\n\t\t\t\t                        |\tСправочник.Номенклатура КАК Номенклатура\r\n\t\t\t\t                        |ГДЕ\r\n\t\t\t\t                        |\tНоменклатура.Наименование = &Производитель\r\n\t\t\t\t                        |\tИ Номенклатура.ЭтоГруппа\";\r\n\t\t\t\tРезультат_ЗапросСущГруппы = ЗапросСущГруппы.Выполнить().Выбрать();\r\n\t\t\t\t\r\n\t\t\t\t//Если группа найдено, то берем ссылку на неё\r\n\t\t\t\tЕсли Результат_ЗапросСущГруппы.Следующий() Тогда\r\n\t\t\t\t\tГруппаТовараСсылка = Результат_ЗапросСущГруппы.Ссылка;\r\n\t\t\t\t\t\r\n\t\t\t\t//Если группа не найдена, то создаем её\t\r\n\t\t\t\tИначе\r\n\t\t\t\t\tГруппаТовараСсылка = Справочники.Номенклатура.СоздатьГруппу();\r\n\t\t\t\t\tГруппаТовараСсылка.Наименование = стр.Производитель;\r\n\t\t\t\t\tГруппаТовараСсылка.Записать();\r\n\t\t\t\t\tГруппаТовараСсылка = ГруппаТовараСсылка.Ссылка;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\t\t//Указываем, что номенклатуру мы создаем в группе которую нашли\\создали чуть ранее\r\n\t\t\t\tТоварНовый.Родитель = ГруппаТовараСсылка;\r\n\t\t\t\t\r\n\t\t\t\t//Формируем представление наименования номенклатуры, оно должно содержать артикул, а если его нет, то ИД\r\n\t\t\t\t//Также записываем артикул, если его нет, то ИД вместо него.\r\n\t\t\t\tЕсли ЗначениеЗаполнено(стр.Артикул) Тогда\t\t\t\t\t\t\r\n\t\t\t\t\tТоварНовый.Артикул = стр.Артикул;\r\n\t\t\t\t\tТоварНовый.Наименование = Строка(?(ЗначениеЗаполнено(стр.Артикул), \"(\" + стр.Артикул + \") \", \"\") + стр.Номенклатура);\r\n\t\t\t\tИначе\t\r\n\t\t\t\t\tТоварНовый.Наименование = Строка(?(ЗначениеЗаполнено(стр.ИД), \"(\" + стр.ИД + \") \", \"\") + стр.Номенклатура);\r\n\t\t\t    \tТоварНовый.Артикул = стр.ИД;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\t\t//Добавляем в наименование номенклатуры строковое описание номенклатуры, которое мы сформировали ранее,\r\n\t\t\t\t//при условии, что описание номенклатуры есть и оно уже не встречается в наименовании номенклатуры\r\n\t\t\t\tЕсли ЗначениеЗаполнено(ДобТоварЮКОЗ_Характеристика) Тогда \r\n\t\t\t\t\tЕсли СтрНайти(СтрЗаменить(ТоварНовый.Наименование, \",\", \"\"), \r\n\t\t\t\t\t\t\t\t  СтрЗаменить(ДобТоварЮКОЗ_Характеристика, \",\", \"\")) = 0 Тогда\r\n\t\t\t\t\t\tТоварНовый.Наименование = ТоварНовый.Наименование + \", \" + ДобТоварЮКОЗ_Характеристика;\t\r\n\t\t\t\t\tКонецЕсли;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\t\t//Заполняем остальные поля номенклатуры\r\n\t\t\t\tТоварНовый.ЮКОЗ_IDИзСайта = стр.ИД;\r\n\t\t\t\tТоварНовый.ТипНоменклатуры = Перечисления.ТипыНоменклатуры.Товар;\r\n\t\t\t\tТоварНовый.ВидНоменклатуры = ВидНоменклатуры;\r\n  \t\t\t    ТоварНовый.НаименованиеПолное = стр.Номенклатура + ?(ЗначениеЗаполнено(ДобТоварЮКОЗ_Характеристика), \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  \", \" + ДобТоварЮКОЗ_Характеристика, \"\");\r\n\t\t\t\tТоварНовый.СтавкаНДС = Перечисления.СтавкиНДС.НДС20;\r\n\t\t\t\tТоварНовый.ЕдиницаИзмерения = ЕдиницаИзмШТ;\r\n\t\t\t\tТоварНовый.ЕдиницаДляОтчетов = ЕдиницаИзмШТ;\r\n\t\t\t\tТоварНовый.ИспользованиеХарактеристик = Перечисления.ВариантыИспользованияХарактеристикНоменклатуры.НеИспользовать;\r\n\t\t\t\tТоварНовый.ВариантОформленияПродажи = Перечисления.ВариантыОформленияПродажи.РеализацияТоваровУслуг;\r\n\t\t\t\t\r\n\t\t\t\t//Ищем производителя, если его нет, то создаем нового и указываем его в номенклатуре\r\n\t\t\t\tПроизводительСсылка = Справочники.Производители.НайтиПоНаименованию(стр.Производитель);\r\n\t\t\t\tЕсли НЕ ЗначениеЗаполнено(ПроизводительСсылка) Тогда\r\n\t\t\t\t\tНовыйПроизводитель = Справочники.Производители.СоздатьЭлемент();\r\n\t\t\t\t\tНовыйПроизводитель.Наименование = стр.Производитель;\r\n\t\t\t\t\tНовыйПроизводитель.Записать();\r\n\t\t\t\t\tПроизводительСсылка = НовыйПроизводитель.Ссылка;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\t\tТоварНовый.Производитель = ПроизводительСсылка;\r\n\t\t\t\t\r\n\t\t\t\t//Записываем новую номенклатуру и получаем ссылку на неё\r\n\t\t\t\tТоварНовый.Записать();\r\n\t\t\t\tТоварСсылка = ТоварНовый.Ссылка;\r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\t//Добавляем в табличную часть Товары номенклатуру с заполнением данных из файла xml\r\n\t\t\tДобТовар = ДокЗаказ.Товары.Добавить();\r\n\t\t\tДобТовар.Номенклатура = ТоварСсылка;\r\n\t\t\tДобТовар.Количество = стр.Количество;\r\n\t\t\tДобТовар.КоличествоУпаковок = стр.Количество;\r\n\t\t\tДобТовар.Упаковка = ДобТовар.Номенклатура.ЕдиницаИзмерения;\r\n\t\t\tДобТовар.Цена = стр.Цена;\r\n\t\t\tДобТовар.СтавкаНДС = ДобТовар.Номенклатура.СтавкаНДС;\r\n\t\t\tДобТовар.Склад = СкладОсновной;\r\n\t\t\tДобТовар.ЮКОЗ_Характеристика = ДобТоварЮКОЗ_Характеристика;\r\n\t\t\t\r\n\t\t\t//Вычисляем процент ручной скидки, если в файле xml была указана цена со скидкой и она меньше, чем обычная цена\r\n\t\t\tЕсли ЗначениеЗаполнено(стр.ЦенаСоСкидкой) И ЗначениеЗаполнено(стр.Цена) Тогда \r\n\t\t\t\tстрЦенаСоСкидкой = Число(стр.ЦенаСоСкидкой);\r\n\t\t\t\tстрЦена = Число(стр.Цена);\t\t\r\n\t\t\t\tЕсли стрЦенаСоСкидкой > 0 И стрЦена > 0 И стрЦена > стрЦенаСоСкидкой Тогда\r\n\t\t\t\t\tДобТовар.ПроцентРучнойСкидки = (стрЦенаСоСкидкой / стрЦена - 1) * 100 * -1;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\t//Посчитаем сумму строки, а также НДС\r\n\t\tСтруктураПересчетаСуммы = ОбработкаТабличнойЧастиКлиентСервер.ПараметрыПересчетаСуммыНДСВСтрокеТЧ(ДокЗаказ);\t\r\n\t\tСтруктураДействий = Новый Структура;\t\r\n\t\tСтруктураДействий.Вставить(\"ПересчитатьСумму\", \"КоличествоУпаковок\");\r\n\t\tСтруктураДействий.Вставить(\"ПересчитатьСуммуНДС\", СтруктураПересчетаСуммы);\r\n\t\tСтруктураДействий.Вставить(\"ПересчитатьСуммуСНДС\", СтруктураПересчетаСуммы);\r\n\t\tОбработкаТабличнойЧастиСервер.ОбработатьТЧ(ДокЗаказ.Товары, СтруктураДействий, Неопределено);\r\n\t\t\r\n\t\t//Запишем заказ клиента без проведения\r\n\t\tДокЗаказ.Записать(РежимЗаписиДокумента.Запись);\r\n\t\t\r\n\t\t//Обработаем исключения в блоке попытки с записью в журнал регистрации для дальнейшего анализа\r\n\t\tИсключение\r\n\t\t\tЗаписьЖурналаРегистрации(\"Ошибка обработки КП из сайта: \" + ОписаниеОшибки(), УровеньЖурналаРегистрации.Ошибка);\r\n\t\tКонецПопытки;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t//После обработки всех файлов, закроем FTP соединение.\r\n\tФТПСоединение = Неопределено;\r\n\t\r\nКонецПроцедуры\n\n{1} Высокая цикломатическая сложность: 35\r\n{346} Переменной ФТПСоединение присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в Соединямся: Соединямся\r\nОрфографическая ошибка в кототрую: кототрую\r\nОрфографическая ошибка в возьмом: возьмом\r\nОрфографическая ошибка в Проверям: Проверям\r\nОрфографическая ошибка в номенлатура: номенлатура"
  },
  {
    "title": "Запуск длительной процедуры в фоне",
    "description": "Запуск длительной процедуры в фоне",
    "code_snippet": "НаименованиеЗадания = НСтр(\"ru = 'Заполнение документа \"\"Начисление зарплаты\"\"'\");\r\n\r\nРезультат = ДлительныеОперации.ЗапуститьВыполнениеВФоне(\r\n\r\n        УникальныйИдентификатор,\r\n\r\n        \"Документы.НачислениеЗаПервуюПоловинуМесяца.ПодготовитьДанныеДляЗаполнения\",\r\n\r\n        СтруктураПараметров,\r\n\r\n        НаименованиеЗадания);\n\nНаименованиеЗадания = НСтр(\"ru = 'Заполнение документа \"\"Начисление зарплаты\"\"'\");\r\n\r\nРезультат = ДлительныеОперации.ЗапуститьВыполнениеВФоне(\r\n\r\n        УникальныйИдентификатор,\r\n\r\n        \"Документы.НачислениеЗаПервуюПоловинуМесяца.ПодготовитьДанныеДляЗаполнения\",\r\n\r\n        СтруктураПараметров,\r\n\r\n        НаименованиеЗадания);\n\n{11} Переменной Результат присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Открытие формы с последующим вызовом формы завершения",
    "description": "Открытие формы с последующим вызовом формы завершения",
    "code_snippet": "ОткрытьФорму(\"Справочник.Сотрудники.Форма.ФормаЭлемента\",,ЭтотОбъект,,,, Новый ОписаниеОповещения(\"ЗагрузитьИзExcelЗавершение\", ЭтотОбъект), РежимОткрытияОкнаФормы.БлокироватьОкноВладельца);\n\nОткрытьФорму(\"Справочник.Сотрудники.Форма.ФормаЭлемента\",,ЭтотОбъект,,,, Новый ОписаниеОповещения(\"ЗагрузитьИзExcelЗавершение\", ЭтотОбъект), РежимОткрытияОкнаФормы.БлокироватьОкноВладельца);"
  },
  {
    "title": "Сведения о внешней обработке - Отчет",
    "description": "Сведения о внешней обработке - Отчет",
    "code_snippet": "#Область ОсновныеНастройкиДляПодключения\r\n//не забываем заполнять Обработка->Действия->Свойства->ХранилищеВариантовОтчетов\r\nФункция ВернутьСтруктуруПараметров()\r\n\t\r\n\tСтруктура = Новый Структура();\r\n\tСтруктура.Вставить(\"Документ\",\"\");\r\n\tСтруктура.Вставить(\"Представление\",ЭтотОбъект.Метаданные().Представление());\r\n\tСтруктура.Вставить(\"Наименование\",ЭтотОбъект.Метаданные().Синоним);\r\n\tСтруктура.Вставить(\"Идентификатор\",ЭтотОбъект.Метаданные().Имя);\r\n\tСтруктура.Вставить(\"Версия\",\"1.0.0.0\");\r\n\tВозврат Структура;\t\r\n\t\r\nКонецФункции \r\n\r\nФункция СведенияОВнешнейОбработке() ЭКСПОРТ\r\n\t\r\n\tПараметрыОбработки = ВернутьСтруктуруПараметров();\r\n\t\r\n\tСведения = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке();\r\n\tСведения.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительныйОтчет();\r\n\tСведения.Наименование = ПараметрыОбработки.Наименование;\r\n\t\r\n\tстр = Сведения.Команды.Добавить();\r\n\tстр.Представление = ПараметрыОбработки.Представление;\r\n\tстр.Идентификатор = ПараметрыОбработки.Идентификатор;\r\n\tстр.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();\r\n\t\r\n\tВозврат Сведения;\r\n\t\r\nКонецФункции\r\n#КонецОбласти\n\n#Область ОсновныеНастройкиДляПодключения\r\n//не забываем заполнять Обработка->Действия->Свойства->ХранилищеВариантовОтчетов\r\nФункция ВернутьСтруктуруПараметров()\r\n\t\r\n\tСтруктура = Новый Структура();\r\n\tСтруктура.Вставить(\"Документ\",\"\");\r\n\tСтруктура.Вставить(\"Представление\",ЭтотОбъект.Метаданные().Представление());\r\n\tСтруктура.Вставить(\"Наименование\",ЭтотОбъект.Метаданные().Синоним);\r\n\tСтруктура.Вставить(\"Идентификатор\",ЭтотОбъект.Метаданные().Имя);\r\n\tСтруктура.Вставить(\"Версия\",\"1.0.0.0\");\r\n\tВозврат Структура;\t\r\n\t\r\nКонецФункции \r\n\r\nФункция СведенияОВнешнейОбработке() ЭКСПОРТ\r\n\t\r\n\tПараметрыОбработки = ВернутьСтруктуруПараметров();\r\n\t\r\n\tСведения = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке();\r\n\tСведения.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительныйОтчет();\r\n\tСведения.Наименование = ПараметрыОбработки.Наименование;\r\n\t\r\n\tстр = Сведения.Команды.Добавить();\r\n\tстр.Представление = ПараметрыОбработки.Представление;\r\n\tстр.Идентификатор = ПараметрыОбработки.Идентификатор;\r\n\tстр.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();\r\n\t\r\n\tВозврат Сведения;\r\n\t\r\nКонецФункции\r\n#КонецОбласти"
  },
  {
    "title": "Язык выражений СКД Формат()",
    "description": "Язык выражений СКД Формат()",
    "code_snippet": ""
  },
  {
    "title": "Генератор случайных символов",
    "description": "Генератор случайных символов",
    "code_snippet": "Процедура КнопкаСгенерировать()    \r\n    Для Сч = 1 по 100 Цикл\r\n        Сообщить(ГенерацияСлучайногоСимвола(ТекущаяУниверсальнаяДатаВМиллисекундах()));\r\n    КонецЦикла;   \r\nКонецПроцедуры\r\n\r\nФункция ГенерацияСлучайногоСимвола(Счетчик)\r\n    ГСЧ = Новый ГенераторСлучайныхЧисел(Счетчик);    \r\n    СлучайнаяСтрока = \"\";\r\n    // генерируем случайное число из 6-ти символов, например \"d0c8Yf\"\r\n    Для Сч = 1 по 6 Цикл        \r\n        Набор = ГСЧ.СлучайноеЧисло(1,3);    \r\n        Если Набор = 1 Тогда\r\n            // это число\r\n            СлучайныйСимвол = ГСЧ.СлучайноеЧисло(0,9);    \r\n        ИначеЕсли Набор = 2 Тогда\r\n            // это Большая буква латиницы\r\n            СлучайныйСимвол = Символ(ГСЧ.СлучайноеЧисло(65,90));\r\n        ИначеЕсли Набор = 3 Тогда\r\n            // это маленькая буква латиницы\r\n            СлучайныйСимвол = Символ(ГСЧ.СлучайноеЧисло(97,122));\r\n        КонецЕсли;\r\n        СлучайнаяСтрока = СлучайнаяСтрока + СлучайныйСимвол;\r\n    КонецЦикла;      \r\n    Возврат(СлучайнаяСтрока);    \r\nКонецФункции\n\nПроцедура КнопкаСгенерировать()    \r\n    Для Сч = 1 по 100 Цикл\r\n        Сообщить(ГенерацияСлучайногоСимвола(ТекущаяУниверсальнаяДатаВМиллисекундах()));\r\n    КонецЦикла;   \r\nКонецПроцедуры\r\n\r\nФункция ГенерацияСлучайногоСимвола(Счетчик)\r\n    ГСЧ = Новый ГенераторСлучайныхЧисел(Счетчик);    \r\n    СлучайнаяСтрока = \"\";\r\n    // генерируем случайное число из 6-ти символов, например \"d0c8Yf\"\r\n    Для Сч = 1 по 6 Цикл        \r\n        Набор = ГСЧ.СлучайноеЧисло(1,3);    \r\n        Если Набор = 1 Тогда\r\n            // это число\r\n            СлучайныйСимвол = ГСЧ.СлучайноеЧисло(0,9);    \r\n        ИначеЕсли Набор = 2 Тогда\r\n            // это Большая буква латиницы\r\n            СлучайныйСимвол = Символ(ГСЧ.СлучайноеЧисло(65,90));\r\n        ИначеЕсли Набор = 3 Тогда\r\n            // это маленькая буква латиницы\r\n            СлучайныйСимвол = Символ(ГСЧ.СлучайноеЧисло(97,122));\r\n        КонецЕсли;\r\n        СлучайнаяСтрока = СлучайнаяСтрока + СлучайныйСимвол;\r\n    КонецЦикла;      \r\n    Возврат(СлучайнаяСтрока);    \r\nКонецФункции"
  },
  {
    "title": "Создать временную таблицу по имени регистра СрезПоследних",
    "description": "Создать временную таблицу по имени регистра СрезПоследних",
    "code_snippet": "// 1.\r\n\r\nОписаниеФильтра = ЗарплатаКадрыОбщиеНаборыДанных.ОписаниеФильтраДляСоздатьВТИмяРегистра(\"ВТСотрудникиПериоды\",\"Сотрудник\");\r\n\r\nОписаниеФильтра.СоответствиеИзмеренийРегистраИзмерениямФильтра.Вставить(\"Период\", \"Период\");\r\n\r\nОписаниеФильтра.СоответствиеИзмеренийРегистраИзмерениямФильтра.Вставить(\"Сотрудник\", \"Сотрудник\");\r\n\r\nЗарплатаКадрыОбщиеНаборыДанных.СоздатьВТИмяРегистраСрезПоследних(\r\n\r\n        \"ГрафикРаботыСотрудников\",\r\n\r\n        МенеджерВременныхТаблиц,\r\n\r\n        Истина,\r\n\r\n        ОписаниеФильтра,, \"ВТГрафики\");\r\n\r\n// 2.\r\n\r\nОписаниеФильтра = ЗарплатаКадрыПериодическиеРегистры.ОписаниеФильтраДляСоздатьВТИмяРегистра(\"ВТФильтрПозиции\", \"Позиция\");   \r\n\r\nПараметрыПостроения = ЗарплатаКадрыПериодическиеРегистры.ПараметрыПостроенияДляСоздатьВТИмяРегистраСрез();\r\n\r\nЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(ПараметрыПостроения.Отборы, \"Позиция\", \"<>\", Справочники.ШтатноеРасписание.ПустаяСсылка());\r\n\r\nПоказателиПремий = Новый Массив;\r\n\r\nПоказателиПремий.Добавить(Справочники.ПоказателиРасчетаЗарплаты.НайтиПоРеквизиту(\"Идентификатор\", \"ПроцентПпремииПроизводственной\"));\r\n\r\nПоказателиПремий.Добавить(Справочники.ПоказателиРасчетаЗарплаты.НайтиПоРеквизиту(\"Идентификатор\", \"ПроцентГодовойПремии\"));\r\n\r\nЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(ПараметрыПостроения.Отборы, \"Показатель\", \"В\", ПоказателиПремий);\r\n\r\nЗарплатаКадрыПериодическиеРегистры.СоздатьВТИмяРегистраСрезПоследних(\"ЗначенияПлановыхПоказателейРасчетаЗП\", МенеджерВТ, Истина, ОписаниеФильтра, ПараметрыПостроения, \"ВТЗначенияПлановыхПоказателейРасчетаЗП\");\n\n// 1.\r\n\r\nОписаниеФильтра = ЗарплатаКадрыОбщиеНаборыДанных.ОписаниеФильтраДляСоздатьВТИмяРегистра(\"ВТСотрудникиПериоды\",\"Сотрудник\");\r\n\r\nОписаниеФильтра.СоответствиеИзмеренийРегистраИзмерениямФильтра.Вставить(\"Период\", \"Период\");\r\n\r\nОписаниеФильтра.СоответствиеИзмеренийРегистраИзмерениямФильтра.Вставить(\"Сотрудник\", \"Сотрудник\");\r\n\r\nЗарплатаКадрыОбщиеНаборыДанных.СоздатьВТИмяРегистраСрезПоследних(\r\n\r\n        \"ГрафикРаботыСотрудников\",\r\n\r\n        МенеджерВременныхТаблиц,\r\n\r\n        Истина,\r\n\r\n        ОписаниеФильтра,, \"ВТГрафики\");\r\n\r\n// 2.\r\n\r\nОписаниеФильтра = ЗарплатаКадрыПериодическиеРегистры.ОписаниеФильтраДляСоздатьВТИмяРегистра(\"ВТФильтрПозиции\", \"Позиция\");   \r\n\r\nПараметрыПостроения = ЗарплатаКадрыПериодическиеРегистры.ПараметрыПостроенияДляСоздатьВТИмяРегистраСрез();\r\n\r\nЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(ПараметрыПостроения.Отборы, \"Позиция\", \"<>\", Справочники.ШтатноеРасписание.ПустаяСсылка());\r\n\r\nПоказателиПремий = Новый Массив;\r\n\r\nПоказателиПремий.Добавить(Справочники.ПоказателиРасчетаЗарплаты.НайтиПоРеквизиту(\"Идентификатор\", \"ПроцентПпремииПроизводственной\"));\r\n\r\nПоказателиПремий.Добавить(Справочники.ПоказателиРасчетаЗарплаты.НайтиПоРеквизиту(\"Идентификатор\", \"ПроцентГодовойПремии\"));\r\n\r\nЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(ПараметрыПостроения.Отборы, \"Показатель\", \"В\", ПоказателиПремий);\r\n\r\nЗарплатаКадрыПериодическиеРегистры.СоздатьВТИмяРегистраСрезПоследних(\"ЗначенияПлановыхПоказателейРасчетаЗП\", МенеджерВТ, Истина, ОписаниеФильтра, ПараметрыПостроения, \"ВТЗначенияПлановыхПоказателейРасчетаЗП\");"
  },
  {
    "title": "bsl-parser",
    "description": "Парсер конфигурации 1С",
    "code_snippet": ""
  },
  {
    "title": "Предупреждение на сервере",
    "description": "Предупреждение на сервере",
    "code_snippet": "ШаблонПредупреждения = НСтр(\"ru='Текст сообщения \"\"%1\"\".'\");\r\n\r\nТекстПредупреждения = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(\r\n\r\n        ШаблонПредупреждения,\r\n\r\n        СтрокаСотрудника.Сотрудник);\r\n\r\nОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстПредупреждения);\n\nШаблонПредупреждения = НСтр(\"ru='Текст сообщения \"\"%1\"\".'\");\r\n\r\nТекстПредупреждения = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(\r\n\r\n        ШаблонПредупреждения,\r\n\r\n        СтрокаСотрудника.Сотрудник);\r\n\r\nОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстПредупреждения);"
  },
  {
    "title": "Импорт файла полного бэкапа из SQLExpress в LocalDB",
    "description": "Импорт файла полного бэкапа из SQLExpress в LocalDB",
    "code_snippet": "//Сначала выполняем запрос\r\nRESTORE FILELISTONLY\r\nFROM DISK = 'E:\\DB\\full_backup'\r\n\r\n//Смотрим в результатах LogicalName, заменяем его и затем выполняем такой запрос\r\n\r\nRESTORE DATABASE MyDatabase\r\nFROM DISK = 'E:\\DB\\full_backup'\r\n\r\nWITH MOVE 'LogicalName' TO 'E:\\DB\\MyDatabase.mdf',\r\nMOVE 'LogicalName_log' TO 'E:\\DB\\MyDatabase_log.ldf',\r\nREPLACE;\n\n//Сначала выполняем запрос\r\nRESTORE FILELISTONLY\r\nFROM DISK = 'E:\\DB\\full_backup'\r\n\r\n//Смотрим в результатах LogicalName, заменяем его и затем выполняем такой запрос\r\n\r\nRESTORE DATABASE MyDatabase\r\nFROM DISK = 'E:\\DB\\full_backup'\r\n\r\nWITH MOVE 'LogicalName' TO 'E:\\DB\\MyDatabase.mdf',\r\nMOVE 'LogicalName_log' TO 'E:\\DB\\MyDatabase_log.ldf',\r\nREPLACE;\n\n{8} Ожидается идентификатор\r\n{3} Переменной DISK присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в бэкапа: бэкапа"
  },
  {
    "title": "Создать временную таблицу из таблицы значений",
    "description": "Создать временную таблицу из таблицы значений",
    "code_snippet": "ЗарплатаКадры.СоздатьВТПоТаблицеЗначений(Запрос.МенеджерВременныхТаблиц, ТаблицаМВО, \"ВТМВО\", Истина);\n\nЗарплатаКадры.СоздатьВТПоТаблицеЗначений(Запрос.МенеджерВременныхТаблиц, ТаблицаМВО, \"ВТМВО\", Истина);"
  },
  {
    "title": "Срезы последних (интерполяция периодических сведений)",
    "description": "Срезы последних (интерполяция периодических сведений)",
    "code_snippet": "ВЫБРАТЬ \n    Продажи.Период,\n    Продажи.Контрагент, \n    Продажи.Номенклатура, \n    СУММА(Продажи.КоличествоОборот) КАК Количество, \n    СУММА(Продажи.СтоимостьОборот) КАК Стоимость, \n    МИНИМУМ(РАЗНОСТЬДАТ(ЦеныНоменклатуры.Период, Продажи.Период, ДЕНЬ) * &Много + ЦеныНоменклатуры.Цена) \n    - МИНИМУМ(РАЗНОСТЬДАТ(ЦеныНоменклатуры.Период, Продажи.Период, ДЕНЬ) * &Много) КАК Цена \nИЗ \n    РегистрНакопления.Продажи.Обороты(&НачалоПериода, &КонецПериода, День, ) КАК Продажи \n        ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры КАК ЦеныНоменклатуры \n            ПО Продажи.Номенклатура = ЦеныНоменклатуры.Номенклатура \n            И (ЦеныНоменклатуры.ТипЦен = &ТипЦен) \n            И (ЦеныНоменклатуры.Период < = Продажи.Период)\nСГРУППИРОВАТЬ ПО \n    Продажи.Период, \n    Продажи.Контрагент, \n    Продажи.Номенклатура"
  },
  {
    "title": "Заполняем (описываем набор данных и поля) схему компоновки данных  из таблицы значений",
    "description": "Заполняем (описываем набор данных и поля) схему компоновки данных  из таблицы значений",
    "code_snippet": "// Функция - Схема компоновки данных из таблицы значений\r\n//  Формирует Схему компоновки, добавляет туда НаборДанных заполненный в соответствии\r\n//  с колонками Таблицы.\r\n//  Использование: открываю эту Схему конструктором, поднастраиваю и сохраняю в xml.\r\n//   Избавляет от необходимости вручную описывать Поля и их Типы\r\n//\r\n// Параметры:\r\n//  Таблица           - ТаблицаЗначений - Обязательно с определенными типами колонок.\r\n//      Можно использовать ТипизированнаяТаблицаЗначений()\r\n//  Наименование - Строка - Название будущего набора данных\r\n//\r\n// Возвращаемое значение:\r\n//  СхемаКомпоновкиДанных\r\n//\r\n// Пример:\r\n//  Схема = СхемаКомпоновкиДанныхИзТаблицыЗначений(Таблица, \"Звонки\");\r\n//  Конструктор = Новый КонструкторСхемыКомпоновкиДанных(Схема);\r\n//  Конструктор.Редактировать(ЭтаФорма);\r\n//\r\nФункция СхемаКомпоновкиДанныхИзТаблицыЗначений(Таблица, Наименование) Экспорт\r\n     Схема = Новый СхемаКомпоновкиДанных;\r\n     //Схема.ИсточникиДанных\r\n     Источник = Схема.ИсточникиДанных.Добавить();\r\n     Источник.Имя = \"ИсточникДанных\";\r\n     Источник.СтрокаСоединения = \"\";\r\n     Источник.ТипИсточникаДанных = \"Local\";\r\n\r\n     НаборДанных = НаборДанныхИзТаблицыЗначений(Схема, Таблица, Наименование);\r\n     Возврат Схема;\r\nКонецФункции\r\n\r\n\r\n// Функция - Набор данных из таблицы значений\r\n//     Добавляет НаборДанных в Схему, создаёт поля соответствующие колонкам Таблицы\r\n//     Памятка: чтобы подсунуть Таблицу используй ПриКомпоновкеРезультата()\r\n//     ПроцессорКомпоновкиДанных.Инициализировать(..., НаборыДанных , ..., ...);\r\n//\r\n// Параметры:\r\n//  Схема           - СхемаКомпоновкиДанных\r\n//  Таблица           - ТаблицаЗначений - Обязательно с определенными типами колонок.\r\n//      Можно использовать ТипизированнаяТаблицаЗначений().\r\n//  Наименование - Строка - Название будущего набора данных\r\n//\r\n// Возвращаемое значение:\r\n//  НаборДанныхОбъектСхемыКомпоновкиДанных\r\n//\r\nФункция НаборДанныхИзТаблицыЗначений(Схема, Таблица, Наименование) Экспорт\r\n     \r\n     //Схема = Новый СхемаКомпоновкиДанных; //Убрать\r\n     НаборДанных = Схема.НаборыДанных.Добавить(Тип(\"НаборДанныхОбъектСхемыКомпоновкиДанных\"));\r\n     НаборДанных.Имя = Наименование;\r\n     НаборДанных.ИмяОбъекта = Наименование;\r\n     НаборДанных.ИсточникДанных = Схема.ИсточникиДанных[0].Имя;\r\n     //НаборДанных.АвтоЗаполнениеДоступныхПолей = Истина;\r\n     \r\n     Для Каждого Колонка Из Таблица.Колонки Цикл\r\n          ДобавленноеПоле = НаборДанных.Поля.Добавить(Тип(\"ПолеНабораДанныхСхемыКомпоновкиДанных\"));\r\n          ДобавленноеПоле.Заголовок = Колонка.Имя;\r\n          ДобавленноеПоле.ПутьКДанным = Колонка.Имя;\r\n          ДобавленноеПоле.Поле = Колонка.Имя;\r\n          ДобавленноеПоле.ТипЗначения = Новый ОписаниеТипов(Колонка.ТипЗначения);\r\n     КонецЦикла;\r\n\r\n     Возврат НаборДанных;\r\n          \r\nКонецФункции\n\n// Функция - Схема компоновки данных из таблицы значений\r\n//  Формирует Схему компоновки, добавляет туда НаборДанных заполненный в соответствии\r\n//  с колонками Таблицы.\r\n//  Использование: открываю эту Схему конструктором, поднастраиваю и сохраняю в xml.\r\n//   Избавляет от необходимости вручную описывать Поля и их Типы\r\n//\r\n// Параметры:\r\n//  Таблица           - ТаблицаЗначений - Обязательно с определенными типами колонок.\r\n//      Можно использовать ТипизированнаяТаблицаЗначений()\r\n//  Наименование - Строка - Название будущего набора данных\r\n//\r\n// Возвращаемое значение:\r\n//  СхемаКомпоновкиДанных\r\n//\r\n// Пример:\r\n//  Схема = СхемаКомпоновкиДанныхИзТаблицыЗначений(Таблица, \"Звонки\");\r\n//  Конструктор = Новый КонструкторСхемыКомпоновкиДанных(Схема);\r\n//  Конструктор.Редактировать(ЭтаФорма);\r\n//\r\nФункция СхемаКомпоновкиДанныхИзТаблицыЗначений(Таблица, Наименование) Экспорт\r\n     Схема = Новый СхемаКомпоновкиДанных;\r\n     //Схема.ИсточникиДанных\r\n     Источник = Схема.ИсточникиДанных.Добавить();\r\n     Источник.Имя = \"ИсточникДанных\";\r\n     Источник.СтрокаСоединения = \"\";\r\n     Источник.ТипИсточникаДанных = \"Local\";\r\n\r\n     НаборДанных = НаборДанныхИзТаблицыЗначений(Схема, Таблица, Наименование);\r\n     Возврат Схема;\r\nКонецФункции\r\n\r\n\r\n// Функция - Набор данных из таблицы значений\r\n//     Добавляет НаборДанных в Схему, создаёт поля соответствующие колонкам Таблицы\r\n//     Памятка: чтобы подсунуть Таблицу используй ПриКомпоновкеРезультата()\r\n//     ПроцессорКомпоновкиДанных.Инициализировать(..., НаборыДанных , ..., ...);\r\n//\r\n// Параметры:\r\n//  Схема           - СхемаКомпоновкиДанных\r\n//  Таблица           - ТаблицаЗначений - Обязательно с определенными типами колонок.\r\n//      Можно использовать ТипизированнаяТаблицаЗначений().\r\n//  Наименование - Строка - Название будущего набора данных\r\n//\r\n// Возвращаемое значение:\r\n//  НаборДанныхОбъектСхемыКомпоновкиДанных\r\n//\r\nФункция НаборДанныхИзТаблицыЗначений(Схема, Таблица, Наименование) Экспорт\r\n     \r\n     //Схема = Новый СхемаКомпоновкиДанных; //Убрать\r\n     НаборДанных = Схема.НаборыДанных.Добавить(Тип(\"НаборДанныхОбъектСхемыКомпоновкиДанных\"));\r\n     НаборДанных.Имя = Наименование;\r\n     НаборДанных.ИмяОбъекта = Наименование;\r\n     НаборДанных.ИсточникДанных = Схема.ИсточникиДанных[0].Имя;\r\n     //НаборДанных.АвтоЗаполнениеДоступныхПолей = Истина;\r\n     \r\n     Для Каждого Колонка Из Таблица.Колонки Цикл\r\n          ДобавленноеПоле = НаборДанных.Поля.Добавить(Тип(\"ПолеНабораДанныхСхемыКомпоновкиДанных\"));\r\n          ДобавленноеПоле.Заголовок = Колонка.Имя;\r\n          ДобавленноеПоле.ПутьКДанным = Колонка.Имя;\r\n          ДобавленноеПоле.Поле = Колонка.Имя;\r\n          ДобавленноеПоле.ТипЗначения = Новый ОписаниеТипов(Колонка.ТипЗначения);\r\n     КонецЦикла;\r\n\r\n     Возврат НаборДанных;\r\n          \r\nКонецФункции\n\n{28} Переменной НаборДанных присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Запуск отчета из документа, передача ссылки в параметр отчета",
    "description": "Запуск отчета из документа, передача ссылки в параметр отчета",
    "code_snippet": "//Создаем команду в документе, в команде прописываем..\r\nСтруктураПараметров = Новый Структура;\r\nСтруктураПараметров.Вставить(\"ИМЯКОМАНДЫ\", Объект.Ссылка);\r\n\t\r\nОткрытьФорму(\"Отчет.НАИМЕНОВАНИЕОТЧЕТА.Форма.ФормаОтчета\", СтруктураПараметров, Объект.Ссылка);\r\n\r\n//В модуле формы отчета:\r\n\r\n&НаСервере\r\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\r\n\tПараметры.СформироватьПриОткрытии = Истина;\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ПередЗагрузкойВариантаНаСервере(Настройки)\r\n\tНастройки.ПараметрыДанных.УстановитьЗначениеПараметра(\"ИМЯКОМАНДЫ\", Параметры.ИМЯКОМАНДЫ);   \r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ПриЗагрузкеПользовательскихНастроекНаСервере(Настройки, ИспользуютсяСтандартныеНастройки)\r\n\tПараметр = Отчет.КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти(\"ИМЯКОМАНДЫ\");\r\n\tПараметр.Значение = Параметры.ИМЯКОМАНДЫ;            \r\n\tПараметр.Использование = Истина; \r\nКонецПроцедуры\n\n//Создаем команду в документе, в команде прописываем..\r\nСтруктураПараметров = Новый Структура;\r\nСтруктураПараметров.Вставить(\"ИМЯКОМАНДЫ\", Объект.Ссылка);\r\n\t\r\nОткрытьФорму(\"Отчет.НАИМЕНОВАНИЕОТЧЕТА.Форма.ФормаОтчета\", СтруктураПараметров, Объект.Ссылка);\r\n\r\n//В модуле формы отчета:\r\n\r\n&НаСервере\r\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\r\n\tПараметры.СформироватьПриОткрытии = Истина;\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ПередЗагрузкойВариантаНаСервере(Настройки)\r\n\tНастройки.ПараметрыДанных.УстановитьЗначениеПараметра(\"ИМЯКОМАНДЫ\", Параметры.ИМЯКОМАНДЫ);   \r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nПроцедура ПриЗагрузкеПользовательскихНастроекНаСервере(Настройки, ИспользуютсяСтандартныеНастройки)\r\n\tПараметр = Отчет.КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти(\"ИМЯКОМАНДЫ\");\r\n\tПараметр.Значение = Параметры.ИМЯКОМАНДЫ;            \r\n\tПараметр.Использование = Истина; \r\nКонецПроцедуры\n\n{5} Ожидается идентификатор"
  },
  {
    "title": "coverage-cli",
    "description": "Консольное приложение для конвертации результатов покрытия",
    "code_snippet": ""
  },
  {
    "title": "Особенность (грабля) при работе с Характеристиками через СКД",
    "description": "Особенность (грабля) при работе с Характеристиками через СКД",
    "code_snippet": "Орфографическая ошибка в грабля: грабля"
  },
  {
    "title": "Открыть форму выбора с отбором (УФ)",
    "description": "Открыть форму выбора с отбором (УФ)",
    "code_snippet": "&НаКлиенте\r\nПроцедура КнопкаВыбрать(Команда)\r\n\r\n    НастройкиКомпоновки = Новый НастройкиКомпоновкиДанных;\r\n\r\n    ГруппаОтбора = НастройкиКомпоновки.Отбор.Элементы.Добавить(Тип(\"ГруппаЭлементовОтбораКомпоновкиДанных\"));\r\n    ГруппаОтбора.ТипГруппы = ТипГруппыЭлементовОтбораКомпоновкиДанных.ГруппаИ;\r\n    \r\n    ЭлементОтбора = ГруппаОтбора.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\")); \r\n    ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"Номер\");\r\n    ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.всписке;\r\n    ЭлементОтбора.Использование = Истина;\r\n    ЭлементОтбора.ПравоеЗначение=номера;\r\n\r\n    ЭлементОтбора = ГруппаОтбора.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\")); \r\n    ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"ДАТА\");\r\n    ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.больше;\r\n    ЭлементОтбора.Использование = Истина;\r\n    ЭлементОтбора.ПравоеЗначение=(объект.Дата);\r\n\r\n    ПараметрыВыбора = Новый Структура;\r\n    ПараметрыВыбора.Вставить(\"ФиксированныеНастройки\", НастройкиКомпоновки);\r\n    ПараметрыВыбора.Вставить(\"РежимВыбора\",Истина);\r\n    ПараметрыВыбора.Вставить(\"МножественныйВыбор\",Истина);\r\n\r\n    ОбработкаВыбора = Новый ОписаниеОповещения(\"ВыбратьДокументКонец\", ЭтаФорма);\r\n\r\n    ОткрытьФорму(\"Документ.РеализацияТоваровУслуг.ФормаВыбора\",ПараметрыВыбора,\r\n            ЭтаФорма, , , , ОбработкаВыбора);\r\nКонецПроцедуры\r\n \r\n&НаКлиенте\r\nПроцедура ВыбратьДокументКонец(Значение, ДопПараметры) Экспорт\r\n    Если Значение = Неопределено Тогда ///Тут массив с выбранными документами получится \r\n        Возврат;\r\n    КонецЕсли;\r\n     \r\n     \r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура КнопкаВыбрать(Команда)\r\n\r\n    НастройкиКомпоновки = Новый НастройкиКомпоновкиДанных;\r\n\r\n    ГруппаОтбора = НастройкиКомпоновки.Отбор.Элементы.Добавить(Тип(\"ГруппаЭлементовОтбораКомпоновкиДанных\"));\r\n    ГруппаОтбора.ТипГруппы = ТипГруппыЭлементовОтбораКомпоновкиДанных.ГруппаИ;\r\n    \r\n    ЭлементОтбора = ГруппаОтбора.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\")); \r\n    ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"Номер\");\r\n    ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.всписке;\r\n    ЭлементОтбора.Использование = Истина;\r\n    ЭлементОтбора.ПравоеЗначение=номера;\r\n\r\n    ЭлементОтбора = ГруппаОтбора.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\")); \r\n    ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"ДАТА\");\r\n    ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.больше;\r\n    ЭлементОтбора.Использование = Истина;\r\n    ЭлементОтбора.ПравоеЗначение=(объект.Дата);\r\n\r\n    ПараметрыВыбора = Новый Структура;\r\n    ПараметрыВыбора.Вставить(\"ФиксированныеНастройки\", НастройкиКомпоновки);\r\n    ПараметрыВыбора.Вставить(\"РежимВыбора\",Истина);\r\n    ПараметрыВыбора.Вставить(\"МножественныйВыбор\",Истина);\r\n\r\n    ОбработкаВыбора = Новый ОписаниеОповещения(\"ВыбратьДокументКонец\", ЭтаФорма);\r\n\r\n    ОткрытьФорму(\"Документ.РеализацияТоваровУслуг.ФормаВыбора\",ПараметрыВыбора,\r\n            ЭтаФорма, , , , ОбработкаВыбора);\r\nКонецПроцедуры\r\n \r\n&НаКлиенте\r\nПроцедура ВыбратьДокументКонец(Значение, ДопПараметры) Экспорт\r\n    Если Значение = Неопределено Тогда ///Тут массив с выбранными документами получится \r\n        Возврат;\r\n    КонецЕсли;\r\n     \r\n     \r\nКонецПроцедуры"
  },
  {
    "title": "ТаблицаЗначений из кроны ДереваЗначений",
    "description": "ТаблицаЗначений из кроны ДереваЗначений",
    "code_snippet": "// Функция - Возвращает ТаблицЗначений из \"бездетных\" (листья всех ветвей/крона/конечные узлы) строк Дерева\r\n//  Зависит от ЗаполнитьТаблицуЛистьямиВетви()\r\n//\r\n// Параметры:\r\n//  Дерево      - ДеревоЗначений\r\n//\r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений -\r\n//\r\nФункция ТаблицаЗначенийИзКроныДереваЗначений(Дерево) Экспорт\r\n     Таблица = Новый ТаблицаЗначений;\r\n     Для каждого КолонкаДерева из Дерево.Колонки Цикл\r\n          КолонкаТаблицы = Таблица.Колонки.Добавить(КолонкаДерева.Имя, КолонкаДерева.ТипЗначения);\r\n     КонецЦикла;\r\n     \r\n     Для каждого Ветвь Из Дерево.Строки Цикл\r\n          ЗаполнитьТаблицуЛистьямиВетви(Таблица, Ветвь);\r\n     КонецЦикла;\r\n     Возврат Таблица;\r\nКонецФункции\r\n\r\n// Процедура - Заполнить таблицу листьями ветви.\r\n//  Рекурсивная вспомогательная функция для ТаблицаЗначенийИзКроныДереваЗначений()\r\n//\r\n// Параметры:\r\n//  Таблица     - ТаблицаЗначений -\r\n//  Ветвь     - СтрокаДереваЗначений -\r\n//\r\nПроцедура ЗаполнитьТаблицуЛистьямиВетви(Таблица, Ветвь)\r\n    ЭтоЛист = (Ветвь.Строки.Количество() = 0);\r\n    Если ЭтоЛист Тогда\r\n        Лист = Ветвь;\r\n        ЗаполнитьЗначенияСвойств(Таблица.Добавить(), Лист);\r\n    Иначе\r\n        Для Каждого Подветвь из Ветвь.Строки Цикл\r\n            ЗаполнитьТаблицуЛистьямиВетви(Таблица, Подветвь);\r\n        КонецЦикла;\r\n    КонецЕсли;\r\nКонецПроцедуры\n\n// Функция - Возвращает ТаблицЗначений из \"бездетных\" (листья всех ветвей/крона/конечные узлы) строк Дерева\r\n//  Зависит от ЗаполнитьТаблицуЛистьямиВетви()\r\n//\r\n// Параметры:\r\n//  Дерево      - ДеревоЗначений\r\n//\r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений -\r\n//\r\nФункция ТаблицаЗначенийИзКроныДереваЗначений(Дерево) Экспорт\r\n     Таблица = Новый ТаблицаЗначений;\r\n     Для каждого КолонкаДерева из Дерево.Колонки Цикл\r\n          КолонкаТаблицы = Таблица.Колонки.Добавить(КолонкаДерева.Имя, КолонкаДерева.ТипЗначения);\r\n     КонецЦикла;\r\n     \r\n     Для каждого Ветвь Из Дерево.Строки Цикл\r\n          ЗаполнитьТаблицуЛистьямиВетви(Таблица, Ветвь);\r\n     КонецЦикла;\r\n     Возврат Таблица;\r\nКонецФункции\r\n\r\n// Процедура - Заполнить таблицу листьями ветви.\r\n//  Рекурсивная вспомогательная функция для ТаблицаЗначенийИзКроныДереваЗначений()\r\n//\r\n// Параметры:\r\n//  Таблица     - ТаблицаЗначений -\r\n//  Ветвь     - СтрокаДереваЗначений -\r\n//\r\nПроцедура ЗаполнитьТаблицуЛистьямиВетви(Таблица, Ветвь)\r\n    ЭтоЛист = (Ветвь.Строки.Количество() = 0);\r\n    Если ЭтоЛист Тогда\r\n        Лист = Ветвь;\r\n        ЗаполнитьЗначенияСвойств(Таблица.Добавить(), Лист);\r\n    Иначе\r\n        Для Каждого Подветвь из Ветвь.Строки Цикл\r\n            ЗаполнитьТаблицуЛистьямиВетви(Таблица, Подветвь);\r\n        КонецЦикла;\r\n    КонецЕсли;\r\nКонецПроцедуры\n\nОрфографическая ошибка в Подветвь (найдено 2): Подветвь"
  },
  {
    "title": "Дополнительная расшифровка отчета БСП",
    "description": "Дополнительная расшифровка отчета БСП",
    "code_snippet": "// Общий модуль ОтчетыКлиентПереопределяемый\r\n\r\nПроцедура ОбработкаРасшифровки(ФормаОтчета, Элемент, Расшифровка, СтандартнаяОбработка) Экспорт\r\n\t\r\n\tОбработкаРасшифровкиПереопределение(ФормаОтчета, Элемент, Расшифровка, СтандартнаяОбработка);\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ОбработкаДополнительнойРасшифровки(ФормаОтчета, Элемент, Расшифровка, СтандартнаяОбработка) Экспорт\r\n\t\r\n\tОбработкаРасшифровкиПереопределение(ФормаОтчета, Элемент, Расшифровка, СтандартнаяОбработка);\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ОбработкаРасшифровкиПереопределение(ФормаОтчета, Элемент, Расшифровка, СтандартнаяОбработка)\r\n\t\r\n\tЕсли ФормаОтчета.НастройкиОтчета.ПолноеИмя = \"Отчет.ИмяРасшифровываемогоОтчета\" Тогда\r\n\t\t\r\n\t\tДоговорДляРасшифровки = ОтчетыВызовСервера.ЗначениеДанныхВПолеРасшифровки(ФормаОтчета.ОтчетДанныеРасшифровки, Расшифровка);\r\n\t\t\r\n\t\tЕсли ТипЗнч(ДоговорДляРасшифровки) = Тип(\"СправочникСсылка.ДоговорыКонтрагентов\") Тогда\r\n\t\t\t\r\n\t\t\tСтандартнаяОбработка = Ложь;\r\n\t\t\t\r\n\t\t\tОбработкаРасшифровки = Новый ОбработкаРасшифровкиКомпоновкиДанных(\r\n\t\t\t\t\t\t\t\t   ФормаОтчета.ОтчетДанныеРасшифровки,\r\n\t\t\t\t\t\t\t\t   Новый ИсточникДоступныхНастроекКомпоновкиДанных(ФормаОтчета.Отчет));\r\n\t\t\t\r\n\t\t\tДополнительныеПараметры = Новый Структура;\r\n\t\t\tДополнительныеПараметры.Вставить(\"Договор\", ДоговорДляРасшифровки);\r\n\t\t\tДополнительныеПараметры.Вставить(\"ФормаОтчета\", ФормаОтчета);\r\n\t\t\t\r\n\t\t\tОписаниеОповещения = Новый ОписаниеОповещения(\"ПоказатьВыборДействияЗавершение\", ЭтотОбъект, ДополнительныеПараметры);\r\n\t\t\tДоступныеДействия  = Новый Массив;\r\n\t\t\tДоступныеДействия.Добавить(ДействиеОбработкиРасшифровкиКомпоновкиДанных.ОткрытьЗначение);\r\n\t\t\t\r\n\t\t\tДополнительныеПунктыМеню = Новый СписокЗначений;\r\n\t\t\tДополнительныеПунктыМеню.Добавить(\"ЗаявкиПоДоговору\", НСтр(\"ru = 'Расшифровать...'\"));\r\n\t\t\t\r\n\t\t\tОбработкаРасшифровки.ПоказатьВыборДействия(ОписаниеОповещения, Расшифровка, ДоступныеДействия, ДополнительныеПунктыМеню);\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ПоказатьВыборДействияЗавершение(ВыполненноеДействие, ПараметрВыполненногоДействия, ДополнительныеПараметры) Экспорт\r\n\t\r\n\tЕсли ВыполненноеДействие = ДействиеОбработкиРасшифровкиКомпоновкиДанных.ОткрытьЗначение Тогда\r\n\t\t\r\n\t\tПоказатьЗначение(Неопределено, ПараметрВыполненногоДействия);\r\n\t\t\r\n\tИначеЕсли ВыполненноеДействие = \"ЗаявкиПоДоговору\" Тогда              \r\n\t\t\r\n\t\tОтборХ          = Новый Структура(\"Договор\", ДополнительныеПараметры.Договор);\r\n\r\n\t\tПараметрыФормыХ = Новый Структура(\"СформироватьПриОткрытии, Отбор, КлючВарианта\", Истина, ОтборХ, \"ДляРасшифровки\"); \r\n\t\t\r\n\t\tОткрытьФорму(\"Отчет.ЗаявкиНаПлатежПоДоговоруКонтрагента.Форма.ФормаОтчета\", ПараметрыФормыХ, ДополнительныеПараметры.ФормаОтчета, ДополнительныеПараметры.Договор);\t\t\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\n//Общий модуль ОтчетыВызовСервера установлены галочки: сервер\r\n\r\nФункция ЗначениеДанныхВПолеРасшифровки(ОтчетДанныеРасшифровки, Расшифровка) Экспорт\r\n\t\r\n\tДанныеРасшифровки = ПолучитьИзВременногоХранилища(ОтчетДанныеРасшифровки);\r\n\tВозврат ДанныеРасшифровки.Элементы.Получить(Расшифровка).ПолучитьПоля()[0].Значение;\t\r\n\t\r\nКонецФункции\n\n// Общий модуль ОтчетыКлиентПереопределяемый\r\n\r\nПроцедура ОбработкаРасшифровки(ФормаОтчета, Элемент, Расшифровка, СтандартнаяОбработка) Экспорт\r\n\t\r\n\tОбработкаРасшифровкиПереопределение(ФормаОтчета, Элемент, Расшифровка, СтандартнаяОбработка);\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ОбработкаДополнительнойРасшифровки(ФормаОтчета, Элемент, Расшифровка, СтандартнаяОбработка) Экспорт\r\n\t\r\n\tОбработкаРасшифровкиПереопределение(ФормаОтчета, Элемент, Расшифровка, СтандартнаяОбработка);\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ОбработкаРасшифровкиПереопределение(ФормаОтчета, Элемент, Расшифровка, СтандартнаяОбработка)\r\n\t\r\n\tЕсли ФормаОтчета.НастройкиОтчета.ПолноеИмя = \"Отчет.ИмяРасшифровываемогоОтчета\" Тогда\r\n\t\t\r\n\t\tДоговорДляРасшифровки = ОтчетыВызовСервера.ЗначениеДанныхВПолеРасшифровки(ФормаОтчета.ОтчетДанныеРасшифровки, Расшифровка);\r\n\t\t\r\n\t\tЕсли ТипЗнч(ДоговорДляРасшифровки) = Тип(\"СправочникСсылка.ДоговорыКонтрагентов\") Тогда\r\n\t\t\t\r\n\t\t\tСтандартнаяОбработка = Ложь;\r\n\t\t\t\r\n\t\t\tОбработкаРасшифровки = Новый ОбработкаРасшифровкиКомпоновкиДанных(\r\n\t\t\t\t\t\t\t\t   ФормаОтчета.ОтчетДанныеРасшифровки,\r\n\t\t\t\t\t\t\t\t   Новый ИсточникДоступныхНастроекКомпоновкиДанных(ФормаОтчета.Отчет));\r\n\t\t\t\r\n\t\t\tДополнительныеПараметры = Новый Структура;\r\n\t\t\tДополнительныеПараметры.Вставить(\"Договор\", ДоговорДляРасшифровки);\r\n\t\t\tДополнительныеПараметры.Вставить(\"ФормаОтчета\", ФормаОтчета);\r\n\t\t\t\r\n\t\t\tОписаниеОповещения = Новый ОписаниеОповещения(\"ПоказатьВыборДействияЗавершение\", ЭтотОбъект, ДополнительныеПараметры);\r\n\t\t\tДоступныеДействия  = Новый Массив;\r\n\t\t\tДоступныеДействия.Добавить(ДействиеОбработкиРасшифровкиКомпоновкиДанных.ОткрытьЗначение);\r\n\t\t\t\r\n\t\t\tДополнительныеПунктыМеню = Новый СписокЗначений;\r\n\t\t\tДополнительныеПунктыМеню.Добавить(\"ЗаявкиПоДоговору\", НСтр(\"ru = 'Расшифровать...'\"));\r\n\t\t\t\r\n\t\t\tОбработкаРасшифровки.ПоказатьВыборДействия(ОписаниеОповещения, Расшифровка, ДоступныеДействия, ДополнительныеПунктыМеню);\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\nПроцедура ПоказатьВыборДействияЗавершение(ВыполненноеДействие, ПараметрВыполненногоДействия, ДополнительныеПараметры) Экспорт\r\n\t\r\n\tЕсли ВыполненноеДействие = ДействиеОбработкиРасшифровкиКомпоновкиДанных.ОткрытьЗначение Тогда\r\n\t\t\r\n\t\tПоказатьЗначение(Неопределено, ПараметрВыполненногоДействия);\r\n\t\t\r\n\tИначеЕсли ВыполненноеДействие = \"ЗаявкиПоДоговору\" Тогда              \r\n\t\t\r\n\t\tОтборХ          = Новый Структура(\"Договор\", ДополнительныеПараметры.Договор);\r\n\r\n\t\tПараметрыФормыХ = Новый Структура(\"СформироватьПриОткрытии, Отбор, КлючВарианта\", Истина, ОтборХ, \"ДляРасшифровки\"); \r\n\t\t\r\n\t\tОткрытьФорму(\"Отчет.ЗаявкиНаПлатежПоДоговоруКонтрагента.Форма.ФормаОтчета\", ПараметрыФормыХ, ДополнительныеПараметры.ФормаОтчета, ДополнительныеПараметры.Договор);\t\t\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\n//Общий модуль ОтчетыВызовСервера установлены галочки: сервер\r\n\r\nФункция ЗначениеДанныхВПолеРасшифровки(ОтчетДанныеРасшифровки, Расшифровка) Экспорт\r\n\t\r\n\tДанныеРасшифровки = ПолучитьИзВременногоХранилища(ОтчетДанныеРасшифровки);\r\n\tВозврат ДанныеРасшифровки.Элементы.Получить(Расшифровка).ПолучитьПоля()[0].Значение;\t\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Поместить таблицу в запрос",
    "description": "Поместить таблицу в запрос",
    "code_snippet": "// Процедура - Поместить таблицу в запрос\r\n// Зависит от ТипизированнаяТаблицаЗначений() https://fastcode.im/Templates/6734\r\n// Параметры:\r\n//  Запрос\t\t - Запрос \r\n//  Таблица\t\t - ТаблицаЗначений\r\n//  ИмяТаблицы\t - Строка - Имя временной таблицы в Запросе\r\n//\r\nПроцедура ПоместитьТаблицуВЗапрос(Запрос, Таблица, ИмяТаблицы)\r\n\tТипизированнаяТаблица = ТипизированнаяТаблицаЗначений(Таблица);\r\n\tИсходныйТекстЗапроса = Запрос.Текст;\r\n\tЗапрос.Текст = \"Выбрать * Поместить \" + ИмяТаблицы + \" Из &\" + ИмяТаблицы + \" как \" + ИмяТаблицы;\r\n\tЕсли Запрос.МенеджерВременныхТаблиц = Неопределено Тогда\r\n\t\tЗапрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\r\n\tКонецЕсли;\r\n\tЕсли Запрос.Параметры.Свойство(ИмяТаблицы) Тогда\r\n\t\t_Параметр =  Запрос.Параметры.ИмяТаблицы;\r\n\t\tЗапрос.УстановитьПараметр(ИмяТаблицы, ТипизированнаяТаблица);\r\n\t\tЗапрос.Выполнить();\r\n\t\tЗапрос.УстановитьПараметр(ИмяТаблицы, _Параметр);\r\n\tИначе\r\n\t\tЗапрос.УстановитьПараметр(ИмяТаблицы, ТипизированнаяТаблица);\r\n\t\tЗапрос.Выполнить();\r\n\t\tЗапрос.Параметры.Удалить(ИмяТаблицы);\r\n\tКонецЕсли;\r\n\tЗапрос.Текст = ИсходныйТекстЗапроса;\r\nКонецПроцедуры\n\n// Процедура - Поместить таблицу в запрос\r\n// Зависит от ТипизированнаяТаблицаЗначений() https://fastcode.im/Templates/6734\r\n// Параметры:\r\n//  Запрос\t\t - Запрос \r\n//  Таблица\t\t - ТаблицаЗначений\r\n//  ИмяТаблицы\t - Строка - Имя временной таблицы в Запросе\r\n//\r\nПроцедура ПоместитьТаблицуВЗапрос(Запрос, Таблица, ИмяТаблицы)\r\n\tТипизированнаяТаблица = ТипизированнаяТаблицаЗначений(Таблица);\r\n\tИсходныйТекстЗапроса = Запрос.Текст;\r\n\tЗапрос.Текст = \"Выбрать * Поместить \" + ИмяТаблицы + \" Из &\" + ИмяТаблицы + \" как \" + ИмяТаблицы;\r\n\tЕсли Запрос.МенеджерВременныхТаблиц = Неопределено Тогда\r\n\t\tЗапрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\r\n\tКонецЕсли;\r\n\tЕсли Запрос.Параметры.Свойство(ИмяТаблицы) Тогда\r\n\t\t_Параметр =  Запрос.Параметры.ИмяТаблицы;\r\n\t\tЗапрос.УстановитьПараметр(ИмяТаблицы, ТипизированнаяТаблица);\r\n\t\tЗапрос.Выполнить();\r\n\t\tЗапрос.УстановитьПараметр(ИмяТаблицы, _Параметр);\r\n\tИначе\r\n\t\tЗапрос.УстановитьПараметр(ИмяТаблицы, ТипизированнаяТаблица);\r\n\t\tЗапрос.Выполнить();\r\n\t\tЗапрос.Параметры.Удалить(ИмяТаблицы);\r\n\tКонецЕсли;\r\n\tЗапрос.Текст = ИсходныйТекстЗапроса;\r\nКонецПроцедуры"
  },
  {
    "title": "osparser",
    "description": "Парсер встроенного языка платформы 1С:Предприятие 8",
    "code_snippet": ""
  },
  {
    "title": "Добавить движение в регистр накопления",
    "description": "Добавить движение в регистр накопления",
    "code_snippet": "Процедура ОбработкаПроведения(Отказ, Режим)\r\n\t// регистр ТоварыНаСкладах Приход\r\n\tДвижения.ТоварыНаСкладах.Записывать = Истина;\r\n\tДвижения.ТоварыНаСкладах.Очистить();\r\n\tДля Каждого ТекСтрокаТовары Из Товары Цикл\r\n\t\tДвижение = Движения.ТоварыНаСкладах.Добавить();\r\n\t\tДвижение.ВидДвижения = ВидДвиженияНакопления.Приход;\r\n\t\tДвижение.Период = Дата;\r\n\t\tДвижение.Номенклатура = ТекСтрокаТовары.Номенклатура;\r\n\t\tДвижение.Количество = ТекСтрокаТовары.Количество;\r\n\tКонецЦикла;\r\nКонецПроцедуры\n\nПроцедура ОбработкаПроведения(Отказ, Режим)\r\n\t// регистр ТоварыНаСкладах Приход\r\n\tДвижения.ТоварыНаСкладах.Записывать = Истина;\r\n\tДвижения.ТоварыНаСкладах.Очистить();\r\n\tДля Каждого ТекСтрокаТовары Из Товары Цикл\r\n\t\tДвижение = Движения.ТоварыНаСкладах.Добавить();\r\n\t\tДвижение.ВидДвижения = ВидДвиженияНакопления.Приход;\r\n\t\tДвижение.Период = Дата;\r\n\t\tДвижение.Номенклатура = ТекСтрокаТовары.Номенклатура;\r\n\t\tДвижение.Количество = ТекСтрокаТовары.Количество;\r\n\tКонецЦикла;\r\nКонецПроцедуры"
  },
  {
    "title": "Сортировка слиянием",
    "description": "Сортировка слиянием",
    "code_snippet": "ёж = 0; \r\nДля уж = 0 По А.Количество() + В.Количество() - 1 Цикл \r\n    що = (уж - ёж) = В.Количество() ИЛИ ёж < А.Количество() И А[ёж] < В[уж - ёж]; \r\n    Сообщить(?(що, \"а\" + ёж + \"=\" + А[ёж], \"в\" + (уж - ёж) + \"=\" + В[уж - ёж])); \r\n    ёж = ёж + що \r\nКонецЦикла\r\nё = 0; \r\nДля Сч = 1 По А.Количество() + В.Количество() Цикл \r\n    ж = (Сч - 1 - ё) = В.Количество() ИЛИ ё < А.Количество() И А[ё] < В[Сч - 1 - ё]; \r\n    Сообщить(?(ж, \"А[\" + ё + \"]=\" + А[ё], \"В[\" + (Сч - 1 - ё) + \"]=\" + В[Сч - 1 - ё])); \r\n    ё = ё + ж \r\nКонецЦикла\n\nёж = 0; \r\nДля уж = 0 По А.Количество() + В.Количество() - 1 Цикл \r\n    що = (уж - ёж) = В.Количество() ИЛИ ёж < А.Количество() И А[ёж] < В[уж - ёж]; \r\n    Сообщить(?(що, \"а\" + ёж + \"=\" + А[ёж], \"в\" + (уж - ёж) + \"=\" + В[уж - ёж])); \r\n    ёж = ёж + що \r\nКонецЦикла\r\nё = 0; \r\nДля Сч = 1 По А.Количество() + В.Количество() Цикл \r\n    ж = (Сч - 1 - ё) = В.Количество() ИЛИ ё < А.Количество() И А[ё] < В[Сч - 1 - ё]; \r\n    Сообщить(?(ж, \"А[\" + ё + \"]=\" + А[ё], \"В[\" + (Сч - 1 - ё) + \"]=\" + В[Сч - 1 - ё])); \r\n    ё = ё + ж \r\nКонецЦикла"
  },
  {
    "title": "Колонка сжато",
    "description": "Колонка сжато",
    "code_snippet": "Функция КолонкаСжато(ДокументСсылка, ИмяТабличнойЧасти, ИмяКолонки, Слэш = \",\", Тире = \"-\")\r\n    Запрос = Новый Запрос(\"ВЫБРАТЬ Различные \" + ИмяКолонки + \" ИЗ Документ.\" + ДокументСсылка.Метаданные().Имя + \".\" + ИмяТабличнойЧасти + \" ГДЕ Ссылка = &Ссылка Упорядочить ПО \" + ИмяКолонки);\r\n    Запрос.УстановитьПараметр(\"Ссылка\", ДокументСсылка);\r\n    Ряд = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку(ИмяКолонки);\r\n    Если Ряд.Количество() = 0 Тогда Возврат \"\"\r\n    КонецЕсли;\r\n    Ряд.Добавить(0); Ряд.Добавить(0);\r\n    Сжато = Строка(Ряд[0]);\r\n    Для ё = 1 По Ряд.Количество() - 3 Цикл\r\n        Если Число(Ряд[ё + 1]) - Число(Ряд[ё - 1]) <> 2 Тогда\r\n            Сжато = Сжато + Слэш + Строка(Ряд[ё])\r\n        ИначеЕсли Число(Ряд[ё + 2]) - Число(Ряд[ё]) <> 2 Тогда\r\n            Сжато = Сжато + Тире\r\n        КонецЕсли\r\n    КонецЦикла;\r\n    Возврат СтрЗаменить(Сжато, Тире + Слэш, Тире)\r\nКонецФункции\n\nФункция КолонкаСжато(ДокументСсылка, ИмяТабличнойЧасти, ИмяКолонки, Слэш = \",\", Тире = \"-\")\r\n    Запрос = Новый Запрос(\"ВЫБРАТЬ Различные \" + ИмяКолонки + \" ИЗ Документ.\" + ДокументСсылка.Метаданные().Имя + \".\" + ИмяТабличнойЧасти + \" ГДЕ Ссылка = &Ссылка Упорядочить ПО \" + ИмяКолонки);\r\n    Запрос.УстановитьПараметр(\"Ссылка\", ДокументСсылка);\r\n    Ряд = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку(ИмяКолонки);\r\n    Если Ряд.Количество() = 0 Тогда Возврат \"\"\r\n    КонецЕсли;\r\n    Ряд.Добавить(0); Ряд.Добавить(0);\r\n    Сжато = Строка(Ряд[0]);\r\n    Для ё = 1 По Ряд.Количество() - 3 Цикл\r\n        Если Число(Ряд[ё + 1]) - Число(Ряд[ё - 1]) <> 2 Тогда\r\n            Сжато = Сжато + Слэш + Строка(Ряд[ё])\r\n        ИначеЕсли Число(Ряд[ё + 2]) - Число(Ряд[ё]) <> 2 Тогда\r\n            Сжато = Сжато + Тире\r\n        КонецЕсли\r\n    КонецЦикла;\r\n    Возврат СтрЗаменить(Сжато, Тире + Слэш, Тире)\r\nКонецФункции"
  },
  {
    "title": "Квайн (программа, распечатывающая свой собственный текст)",
    "description": "Квайн (программа, распечатывающая свой собственный текст)1С не всерьез",
    "code_snippet": "С=\"С=\"\";Л=Лев(С,3);П=Сред(С,3);Сообщить(Л+Л+П+П)\";Л=Лев(С,3);П=Сред(С,3);Сообщить(Л+Л+П+П)\n\nПроцедура КВН(К)С=\"Процедура КВН(К)С=\"\";Л=Лев(С,19);П=Сред(С,19);Сообщить(Л+Л+П+П)КонецПроцедуры\";Л=Лев(С,19);П=Сред(С,19);Сообщить(Л+Л+П+П)КонецПроцедуры"
  },
  {
    "title": "Уничтожение временной таблицы",
    "description": "Уничтожение временной таблицы",
    "code_snippet": "//1.\r\nЗарплатаКадры.УничтожитьВТ(\r\n\r\n        МенеджерВременныхТаблиц,\r\n\r\n        СтрРазделить(\"ВТФизическиеЛицаПатент,ВТКадровыеДанныеСотрудников,ВТИностранцыСотрудники,ВТИностранцы,ВТНерезиденты,ВТФиксированныеСтатусыФизическихЛиц,ВТТекущиеСтатусыФизическихЛиц,ВТИностранцыСДатами,ВТНачисления,ВТРегистрация,ВТРассчитанныеДниВРФ\",\",\"));\r\n\r\n//2.\r\n\t\t\r\nУдалитьВТ = Новый Массив;\r\n\r\nУдалитьВТ.Добавить(\"втВременныеПозиции\");\r\n\r\nУдалитьВТ.Добавить(\"втВременныеПодразделения\");\r\n\r\nУдалитьВТ.Добавить(\"втФинальная\");\r\n\r\nЗарплатаКадры.УничтожитьВТ(МенеджерВТ, УдалитьВТ);\n\n//1.\r\nЗарплатаКадры.УничтожитьВТ(\r\n\r\n        МенеджерВременныхТаблиц,\r\n\r\n        СтрРазделить(\"ВТФизическиеЛицаПатент,ВТКадровыеДанныеСотрудников,ВТИностранцыСотрудники,ВТИностранцы,ВТНерезиденты,ВТФиксированныеСтатусыФизическихЛиц,ВТТекущиеСтатусыФизическихЛиц,ВТИностранцыСДатами,ВТНачисления,ВТРегистрация,ВТРассчитанныеДниВРФ\",\",\"));\r\n\r\n//2.\r\n\t\t\r\nУдалитьВТ = Новый Массив;\r\n\r\nУдалитьВТ.Добавить(\"втВременныеПозиции\");\r\n\r\nУдалитьВТ.Добавить(\"втВременныеПодразделения\");\r\n\r\nУдалитьВТ.Добавить(\"втФинальная\");\r\n\r\nЗарплатаКадры.УничтожитьВТ(МенеджерВТ, УдалитьВТ);"
  },
  {
    "title": "Установка видимости реквизита по умолчанию",
    "description": "Установка видимости реквизита по умолчанию",
    "code_snippet": "РеквизитыПозиции = ДанныеДолжности();\r\n\t\r\n\tЕсли РеквизитыПозиции <> Неопределено Тогда\r\n\t\t\r\n\t\tОбъект.Учащийся = ?(РеквизитыПозиции.Учащийся = Неопределено, Ложь, РеквизитыПозиции.Учащийся);\r\n\t\t\r\n\t\tОбщегоНазначенияКлиентСервер.УстановитьСвойствоЭлементаФормы(\r\n\t\t\r\n\t\tЭлементы,\r\n\t\t\r\n\t\t\"ОбразованиеКвалификация\",\r\n\t\t\r\n\t\t\"Видимость\",\r\n\t\t\r\n\t\tОбъект.Учащийся);\r\n\t\t\r\n\tКонецЕсли;\n\nРеквизитыПозиции = ДанныеДолжности();\r\n\t\r\n\tЕсли РеквизитыПозиции <> Неопределено Тогда\r\n\t\t\r\n\t\tОбъект.Учащийся = ?(РеквизитыПозиции.Учащийся = Неопределено, Ложь, РеквизитыПозиции.Учащийся);\r\n\t\t\r\n\t\tОбщегоНазначенияКлиентСервер.УстановитьСвойствоЭлементаФормы(\r\n\t\t\r\n\t\tЭлементы,\r\n\t\t\r\n\t\t\"ОбразованиеКвалификация\",\r\n\t\t\r\n\t\t\"Видимость\",\r\n\t\t\r\n\t\tОбъект.Учащийся);\r\n\t\t\r\n\tКонецЕсли;"
  },
  {
    "title": "Просмотр временной таблицы",
    "description": "Просмотр временной таблицы",
    "code_snippet": "Запрос.МенеджерВременныхТаблиц.Таблицы.Получить(0).ПолучитьДанные().Выгрузить();\n\nЗапрос.МенеджерВременныхТаблиц.Таблицы.Получить(0).ПолучитьДанные().Выгрузить();"
  },
  {
    "title": "stebi",
    "description": "Экспорт диагностик 1С: EDT для SonarQube 1C (BSL) Community Plugin.",
    "code_snippet": ""
  },
  {
    "title": "Перенести коллекцию КлючИЗначение",
    "description": "Перенести коллекцию КлючИЗначение",
    "code_snippet": "// Процедура - перенести коллекцию КлючИЗначение\r\n//\r\n// Параметры:\r\n//  Приемник - Структура, Соответствие\r\n//  Источник - Структура, Соответствие\r\n//  Заменять - Булево - Заменять [Значение] при наличии [Ключ] в [Приемник], иначе пропустить\r\nПроцедура ПеренестиКлючиИЗначения(Приемник, Источник, Заменять = Истина) Экспорт     \r\n\t\r\n\tТипПриемника = ТипЗнч(Приемник);\r\n\r\n\tДля каждого Элемент из Источник Цикл\r\n\t\t\r\n\t\tЕстьКлюч = Ложь;\r\n\t\t\t\t\r\n\t\tЕсли ТипПриемника = Тип(\"Соответствие\") Тогда\r\n\t\t\tЕстьКлюч = Приемник.Получить(Элемент.Ключ) <> Неопределено;\r\n\t\tИначеЕсли ТипПриемника = Тип(\"Структура\") Тогда  \r\n\t\t\tЕстьКлюч = Приемник.Свойство(Элемент.Ключ);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ЕстьКлюч И Заменять тогда\r\n\t\t\tПриемник[Элемент.Ключ] = Элемент.Значение\r\n\t\tИначе\r\n\t\t\tПриемник.Вставить(Элемент.Ключ, Элемент.Значение);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\nКонецПроцедуры\n\n// Процедура - перенести коллекцию КлючИЗначение\r\n//\r\n// Параметры:\r\n//  Приемник - Структура, Соответствие\r\n//  Источник - Структура, Соответствие\r\n//  Заменять - Булево - Заменять [Значение] при наличии [Ключ] в [Приемник], иначе пропустить\r\nПроцедура ПеренестиКлючиИЗначения(Приемник, Источник, Заменять = Истина) Экспорт     \r\n\t\r\n\tТипПриемника = ТипЗнч(Приемник);\r\n\r\n\tДля каждого Элемент из Источник Цикл\r\n\t\t\r\n\t\tЕстьКлюч = Ложь;\r\n\t\t\t\t\r\n\t\tЕсли ТипПриемника = Тип(\"Соответствие\") Тогда\r\n\t\t\tЕстьКлюч = Приемник.Получить(Элемент.Ключ) <> Неопределено;\r\n\t\tИначеЕсли ТипПриемника = Тип(\"Структура\") Тогда  \r\n\t\t\tЕстьКлюч = Приемник.Свойство(Элемент.Ключ);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ЕстьКлюч И Заменять тогда\r\n\t\t\tПриемник[Элемент.Ключ] = Элемент.Значение\r\n\t\tИначе\r\n\t\t\tПриемник.Вставить(Элемент.Ключ, Элемент.Значение);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\nКонецПроцедуры\n\n// Процедура - перенести коллекцию КлючИЗначение\n//\n// Параметры:\n//  Приемник - Структура, Соответствие\n//  Источник - Структура, Соответствие\n//  Заменять - Булево - При наличии переносимого свойства в Приемнике, заменить значение. По умолчанию Истина\n\nПроцедура ПеренестиКлючиИЗначения(Приемник, Источник, Заменять = Истина)     \n     Для каждого Элемент из Источник Цикл\n          Если Заменять И Приемник.Свойство(Элемент.Ключ) Тогда\n               Приемник[Элемент.Ключ] = Элемент.Значение\n          Иначе\n               Приемник.Вставить(Элемент.Ключ, Элемент.Значение);\n          КонецЕсли;\n     КонецЦикла;\nКонецПроцедуры"
  },
  {
    "title": "СКД. Повторение шапки отчета на каждой странице",
    "description": "СКД. Повторение шапки отчета на каждой странице",
    "code_snippet": "Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\n\n// если высота шапки три строки\n    ДокументРезультат.ПовторятьПриПечатиСтроки = ДокументРезультат.Область(1,, 3); \n\nКонецПроцедуры\n\nПроцедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\n\n    СтандартнаяОбработка = Ложь;\n\n    НастройкиКомпоновки = КомпоновщикНастроек.ПолучитьНастройки();\n\n    КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\n    МакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, НастройкиКомпоновки, ДанныеРасшифровки);\n\n    ПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\n    ПроцессорКомпоновки.Инициализировать(МакетКомпоновки,, ДанныеРасшифровки);\n\n    ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\n    ПроцессорВывода.УстановитьДокумент(ДокументРезультат);\n    ПроцессорВывода.Вывести(ПроцессорКомпоновки);\n\n    Если ДокументРезультат.ФиксацияСверху Тогда\n        ДокументРезультат.ПовторятьПриПечатиСтроки = ДокументРезультат.Область(1,, ДокументРезультат.ФиксацияСверху);\n    КонецЕсли;\n\nКонецПроцедуры"
  },
  {
    "title": "ТаблицаЗначений из DBF",
    "description": "ТаблицаЗначений из DBF",
    "code_snippet": "// Функция загружает данные из dbf файла в таблицу значений.\r\n// Зависит от ПутьКФайлу() https://fastcode.im/Templates/6672\r\n// Параметры:\r\n//  ИмяФайла - Строка - полный путь к файлу. Если не указан, то откроется диалог выбора пути к файлу.\r\n//  Кодировка - КодировкаXBase - Если не указан, то КодировкаXBase.OEM\r\n//\r\nФункция ТаблицаЗначенийИзDBF(Кодировка = Неопределено, ПутьКФайлу = Неопределено) Экспорт\r\n\t\r\n\tЕсли Кодировка = Неопределено Тогда \r\n\t\tКодировка = КодировкаXBase.OEM;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ПутьКФайлу = Неопределено Тогда\r\n\t\tПутьКФайлу = ПутьКФайлу(\"Выберите dbf-файл\",\"(*.dbf)|*.dbf\",РежимДиалогаВыбораФайла.Открытие);\r\n\tКонецЕсли;\r\n\t\r\n\t// Открытие файла данных\r\n\tФайлДанных = Новый XBase(ПутьКФайлу);\r\n\tФайлДанных.Кодировка = Кодировка;\r\n\tЕсли Не ФайлДанных.Открыта() Тогда\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \"Не удалось открыть файл \" + ПутьКФайлу;\r\n\t\tСообщение.Сообщить();\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\t// Переменные и объекты, что бы не создавать постоянно в цикле\r\n\tОписаниеБулево = Новый ОписаниеТипов(\"Булево\");\r\n\tОписаниеДаты = Новый ОписаниеТипов(\"Дата\",,, Новый КвалификаторыДаты(ЧастиДаты.Дата));\r\n\t\r\n\t// Создание таблицы значений\r\n\tТаблицаЗначений = Новый ТаблицаЗначений;\r\n\tДля Каждого Поле из ФайлДанных.Поля Цикл\r\n\t\tЕсли Поле.Тип = \"L\" Тогда\r\n\t\t\tТип = ОписаниеБулево;\r\n\t\tИначеЕсли Поле.Тип = \"D\" Тогда\r\n\t\t\tТип = ОписаниеДаты;\r\n\t\tИначеЕсли (Поле.Тип = \"N\") ИЛИ (Поле.Тип = \"F\") Тогда\r\n\t\t\tТип = Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(Поле.Длина, Поле.Точность));\r\n\t\tИначе\r\n\t\t\tТип = Новый ОписаниеТипов(\"Строка\",, Новый КвалификаторыСтроки(Поле.Длина));\r\n\t\tКонецЕсли;\r\n\t\tТаблицаЗначений.Колонки.Добавить(Поле.Имя, Тип);\r\n\tКонецЦикла;\r\n\t\r\n\t// Заполнение строк таблицы\r\n\tРаботаем = ФайлДанных.Первая();\r\n\tПока Работаем Цикл\r\n\t\tСтрокаТаблицы = ТаблицаЗначений.Добавить();\r\n\t\tЗаполнитьЗначенияСвойств(СтрокаТаблицы, ФайлДанных);\r\n\t\tРаботаем = ФайлДанных.Следующая();\r\n\tКонецЦикла;\r\n\t\r\n\tФайлДанных.ЗакрытьФайл();\r\n\tВозврат ТаблицаЗначений;\r\nКонецФункции\n\n// Функция загружает данные из dbf файла в таблицу значений.\r\n// Зависит от ПутьКФайлу() https://fastcode.im/Templates/6672\r\n// Параметры:\r\n//  ИмяФайла - Строка - полный путь к файлу. Если не указан, то откроется диалог выбора пути к файлу.\r\n//  Кодировка - КодировкаXBase - Если не указан, то КодировкаXBase.OEM\r\n//\r\nФункция ТаблицаЗначенийИзDBF(Кодировка = Неопределено, ПутьКФайлу = Неопределено) Экспорт\r\n\t\r\n\tЕсли Кодировка = Неопределено Тогда \r\n\t\tКодировка = КодировкаXBase.OEM;\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ПутьКФайлу = Неопределено Тогда\r\n\t\tПутьКФайлу = ПутьКФайлу(\"Выберите dbf-файл\",\"(*.dbf)|*.dbf\",РежимДиалогаВыбораФайла.Открытие);\r\n\tКонецЕсли;\r\n\t\r\n\t// Открытие файла данных\r\n\tФайлДанных = Новый XBase(ПутьКФайлу);\r\n\tФайлДанных.Кодировка = Кодировка;\r\n\tЕсли Не ФайлДанных.Открыта() Тогда\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = \"Не удалось открыть файл \" + ПутьКФайлу;\r\n\t\tСообщение.Сообщить();\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\t// Переменные и объекты, что бы не создавать постоянно в цикле\r\n\tОписаниеБулево = Новый ОписаниеТипов(\"Булево\");\r\n\tОписаниеДаты = Новый ОписаниеТипов(\"Дата\",,, Новый КвалификаторыДаты(ЧастиДаты.Дата));\r\n\t\r\n\t// Создание таблицы значений\r\n\tТаблицаЗначений = Новый ТаблицаЗначений;\r\n\tДля Каждого Поле из ФайлДанных.Поля Цикл\r\n\t\tЕсли Поле.Тип = \"L\" Тогда\r\n\t\t\tТип = ОписаниеБулево;\r\n\t\tИначеЕсли Поле.Тип = \"D\" Тогда\r\n\t\t\tТип = ОписаниеДаты;\r\n\t\tИначеЕсли (Поле.Тип = \"N\") ИЛИ (Поле.Тип = \"F\") Тогда\r\n\t\t\tТип = Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(Поле.Длина, Поле.Точность));\r\n\t\tИначе\r\n\t\t\tТип = Новый ОписаниеТипов(\"Строка\",, Новый КвалификаторыСтроки(Поле.Длина));\r\n\t\tКонецЕсли;\r\n\t\tТаблицаЗначений.Колонки.Добавить(Поле.Имя, Тип);\r\n\tКонецЦикла;\r\n\t\r\n\t// Заполнение строк таблицы\r\n\tРаботаем = ФайлДанных.Первая();\r\n\tПока Работаем Цикл\r\n\t\tСтрокаТаблицы = ТаблицаЗначений.Добавить();\r\n\t\tЗаполнитьЗначенияСвойств(СтрокаТаблицы, ФайлДанных);\r\n\t\tРаботаем = ФайлДанных.Следующая();\r\n\tКонецЦикла;\r\n\t\r\n\tФайлДанных.ЗакрытьФайл();\r\n\tВозврат ТаблицаЗначений;\r\nКонецФункции"
  },
  {
    "title": "Типизированная таблица значений",
    "description": "Типизированная таблица значений",
    "code_snippet": "// Типизированная таблица значений\r\n//     Создаёт и возвращает копию ТаблицыЗначений с заполненным Типом Колонок\r\n// Зависит от ЗагрузитьКолонку() https://fastcode.im/Templates/6670\r\n// Параметры:\r\n//  Таблица      - ТаблицаЗначений\r\n//\r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений\r\n//\r\nФункция ТипизированнаяТаблицаЗначений(Таблица) Экспорт\r\n    Результат = Новый ТаблицаЗначений;\r\n    Для Каждого Колонка Из Таблица.Колонки Цикл\r\n        ИмяКолонки = Колонка.Имя;\r\n        СвернутаяТаблица = Таблица.Скопировать(, ИмяКолонки);\r\n        СвернутаяТаблица.Свернуть(ИмяКолонки);\r\n        МассивТипов = Новый Массив;\r\n        Для Каждого СтрокаСвернутойТаблицы из СвернутаяТаблица Цикл\r\n            ТипЗначения = ТипЗнч(СтрокаСвернутойТаблицы[ИмяКолонки]);\r\n            Если МассивТипов.Найти(ТипЗначения) = Неопределено Тогда\r\n                МассивТипов.Добавить(ТипЗначения);\r\n            КонецЕсли;\r\n        КонецЦикла;\r\n        Если МассивТипов.Количество() = 1 Тогда\r\n            //Меры по предотвращению ошибки \"Тип не может быть выбран в запросе\"\r\n            //для колонок заполненных исключительно значениями типа Тип(\"Неопределено\")\r\n            Если МассивТипов[0] = Тип(\"Неопределено\") Тогда\r\n                МассивТипов[0] = Тип(\"Строка\");//Не уверен\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n        Результат.Колонки.Добавить(ИмяКолонки, Новый ОписаниеТипов(МассивТипов), Колонка.Заголовок, Колонка.Ширина);\r\n        ЗагрузитьКолонку(Результат, Таблица.ВыгрузитьКолонку(ИмяКолонки), ИмяКолонки, Ложь);\r\n    КонецЦикла;\r\n    Возврат Результат;\r\nКонецФункции\n\n// Типизированная таблица значений\r\n//     Создаёт и возвращает копию ТаблицыЗначений с заполненным Типом Колонок\r\n// Зависит от ЗагрузитьКолонку() https://fastcode.im/Templates/6670\r\n// Параметры:\r\n//  Таблица      - ТаблицаЗначений\r\n//\r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений\r\n//\r\nФункция ТипизированнаяТаблицаЗначений(Таблица) Экспорт\r\n    Результат = Новый ТаблицаЗначений;\r\n    Для Каждого Колонка Из Таблица.Колонки Цикл\r\n        ИмяКолонки = Колонка.Имя;\r\n        СвернутаяТаблица = Таблица.Скопировать(, ИмяКолонки);\r\n        СвернутаяТаблица.Свернуть(ИмяКолонки);\r\n        МассивТипов = Новый Массив;\r\n        Для Каждого СтрокаСвернутойТаблицы из СвернутаяТаблица Цикл\r\n            ТипЗначения = ТипЗнч(СтрокаСвернутойТаблицы[ИмяКолонки]);\r\n            Если МассивТипов.Найти(ТипЗначения) = Неопределено Тогда\r\n                МассивТипов.Добавить(ТипЗначения);\r\n            КонецЕсли;\r\n        КонецЦикла;\r\n        Если МассивТипов.Количество() = 1 Тогда\r\n            //Меры по предотвращению ошибки \"Тип не может быть выбран в запросе\"\r\n            //для колонок заполненных исключительно значениями типа Тип(\"Неопределено\")\r\n            Если МассивТипов[0] = Тип(\"Неопределено\") Тогда\r\n                МассивТипов[0] = Тип(\"Строка\");//Не уверен\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n        Результат.Колонки.Добавить(ИмяКолонки, Новый ОписаниеТипов(МассивТипов), Колонка.Заголовок, Колонка.Ширина);\r\n        ЗагрузитьКолонку(Результат, Таблица.ВыгрузитьКолонку(ИмяКолонки), ИмяКолонки, Ложь);\r\n    КонецЦикла;\r\n    Возврат Результат;\r\nКонецФункции"
  },
  {
    "title": "Отправить двоичные данные в телеграм (zip/pdf/gif)",
    "description": "Отправить двоичные данные в телеграм (zip/pdf/gif)",
    "code_snippet": "&НаСервере\nПроцедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)\n    Объект.ПроксиПротокол           = \"https\";\n    Объект.ИспользоватьПрокси       = Ложь;\nКонецПроцедуры // ПриСозданииНаСервере()\n//************************************************************\n&НаКлиенте\nПроцедура ВыбратьФайлКоманда(Команда)\n    ДВФ                     = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);\n    ДВФ.Фильтр              = \"Portable Document Format (*.pdf)|*.pdf\";\n    ДВФ.МножественныйВыбор  = Ложь;\n    ооПослеВыбораФайла      = Новый ОписаниеОповещения(\"ПослеВыбораФайла\"\n                            , ЭтотОбъект\n                            , Новый Структура());\n    ДВФ.Показать(ооПослеВыбораФайла);\nКонецПроцедуры // ВыбратьФайлКоманда()\n//************************************************************\n&НаКлиенте\nПроцедура ПослеВыбораФайла(ВыбранныеФайлы, ДополнительныеПараметры) Экспорт\n    Если ВыбранныеФайлы.Количество() <> 1 Или ПустаяСтрока(ВыбранныеФайлы[0]) Тогда Возврат КонецЕсли;\n    Файл                                = Новый Файл(ВыбранныеФайлы[0]);\n    ЭтотОбъект.ПутьФайла                = Файл.ПолноеИмя; \n    ЭтотОбъект.ИмяФайла                 = Файл.Имя;\n    Элементы.ОтправитьФайл.Доступность  = Истина;\nКонецПроцедуры // ПослеВыбораФайла()\n//************************************************************\n&НаКлиенте\nПроцедура ОтправитьСообщениеКоманда(Команда)\n    ОтправитьСообщение();    \nКонецПроцедуры // ОтправитьСообщениеКоманда()\n//************************************************************\n&НаСервере\nПроцедура ОтправитьСообщение()\n    МодульОбъекта   = РеквизитФормыВЗначение(\"Объект\");\n    МодульОбъекта.ОтправитьСообщение(ЭтотОбъект.СообщениеДляОтправки);\nКонецПроцедуры // ОтправитьСообщение() \n//************************************************************\n&НаКлиенте\nПроцедура ОтправитьФайлКоманда(Команда)\n    ДД  = Новый ДвоичныеДанные(ЭтотОбъект.ПутьФайла);\n    ОтправитьФайл(ДД);    \nКонецПроцедуры // ОтправитьФайлКоманда()\n//************************************************************\n&НаСервере\nПроцедура ОтправитьФайл(ДвоичныеДанные)\n    МодульОбъекта   = РеквизитФормыВЗначение(\"Объект\");\n    МодульОбъекта.ОтправитьФайл(ДвоичныеДанные, ЭтотОбъект.ИмяФайла, ЭтотОбъект.СообщениеДляОтправки);\nКонецПроцедуры // ОтправитьФайл()\n\n////////////////////////////////////////////////////////////////////////////////\n/// The MIT License\n/// \n/// Copyright (c) 2020 @PlugFox\n/// \n/// Permission is hereby granted, free of charge, to any person obtaining a copy\n/// of this software and associated documentation files (the \"Software\"), to deal\n/// in the Software without restriction, including without limitation the rights\n/// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n/// copies of the Software, and to permit persons to whom the Software is\n/// furnished to do so, subject to the following conditions:\n/// \n/// The above copyright notice and this permission notice shall be included in\n/// all copies or substantial portions of the Software.\n/// \n/// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n/// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n/// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n/// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n/// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n/// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n/// THE SOFTWARE.\n////////////////////////////////////////////////////////////////////////////////\n#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда\n\n//////////////////////////////////////////////////////////////\n#Область ПрограммныйИнтерфейс\n\n//\nПроцедура Конструктор(Токен\n    , ИдентификаторПолучателя\n    , ПроксиПротокол = Неопределено\n    , ПроксиСервер = Неопределено\n    , ПроксиПорт = Неопределено\n    , ПроксиПользователь = Неопределено\n    , ПроксиПароль = Неопределено\n    , ИспользоватьПрокси = Ложь) Экспорт\n    ЭтотОбъект.Токен                    = Токен;\n    ЭтотОбъект.ИдентификаторПолучателя  = ИдентификаторПолучателя;\n    ЭтотОбъект.ПроксиПротокол           = ПроксиПротокол;\n    ЭтотОбъект.ПроксиСервер             = ПроксиСервер;\n    ЭтотОбъект.ПроксиПорт               = ПроксиПорт;\n    ЭтотОбъект.ПроксиПользователь       = ПроксиПользователь;\n    ЭтотОбъект.ПроксиПароль             = ПроксиПароль;\n    ЭтотОбъект.ИспользоватьПрокси       = ИспользоватьПрокси;\nКонецПроцедуры // Конструктор()\n\n//\nПроцедура ОтправитьСообщение(Сообщение) Экспорт\n    // Глобальные переменные в процедуре:\n    // + Токен\n    // + ИдентификаторПолучателя\n    \n    // Сформировать соединение и запрос\n    Соединение  = ПолучитьСоединение();\n    Адрес       = СтрШаблон(\"/bot%1/sendMessage?chat_id=%2&parse_mode=HTML&text=%3\"\n                , Токен\n                , ИдентификаторПолучателя\n                , КодироватьСтроку(Сообщение, СпособКодированияСтроки.КодировкаURL, \"UTF8\"));\n    Заголовки   = Новый Соответствие;\n    Запрос      = Новый HTTPЗапрос(Адрес, Заголовки);\n    \n    // GET\n    Ответ       = Соединение.Получить(Запрос);\n    \n    // Разбор ответа\n    Если Ответ.КодСостояния <> 200 Тогда\n        ОтветСтрокой    = Ответ.ПолучитьТелоКакСтроку(КодировкаТекста.UTF8);\n        ВызватьИсключение СтрШаблон(\"Ошибка отправки вложения в телеграм.\n            |Код состояния: %1\n            |Тело: %2\"\n            , Ответ.КодСостояния\n            , ОтветСтрокой\n        ); \n    КонецЕсли;  \nКонецПроцедуры // ОтправитьСообщение()\n\n//\nПроцедура ОтправитьФайл(ДвоичныеДанные, ИмяФайла = \"\", Сообщение = \"\") Экспорт \n    // Сформировать тело запроса\n    Разделитель     = Строка(Новый УникальныйИдентификатор());\n    \n    // Формируем основное составное сообщение\n    Тело            = Новый ПотокВПамяти();\n    ЗаписьДанных    = Новый ЗаписьДанных(Тело, КодировкаТекста.UTF8, ПорядокБайтов.LittleEndian, Символы.ВК + Символы.ПС, Символы.ПС, Истина);\n    \n    // chat_id\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\n    ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"chat_id\"\"\");\n    ЗаписьДанных.ЗаписатьСтроку(\"\");\n    ЗаписьДанных.ЗаписатьСтроку(ИдентификаторПолучателя);\n    \n    // disable_notification\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\n    ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"disable_notification\"\"\");\n    ЗаписьДанных.ЗаписатьСтроку(\"\");\n    ЗаписьДанных.ЗаписатьСтроку(\"True\");\n        \n    Если Не ПустаяСтрока(Сообщение) Тогда \n        // caption\n        ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\n        ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"caption\"\"\");\n        ЗаписьДанных.ЗаписатьСтроку(\"\");\n        ЗаписьДанных.ЗаписатьСтроку(Сообщение);        \n        \n        // parse_mode\n        ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\n        ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"parse_mode\"\"\");\n        ЗаписьДанных.ЗаписатьСтроку(\"\");\n        ЗаписьДанных.ЗаписатьСтроку(\"HTML\");\n    КонецЕсли;\n    \n    // document    \n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\n    ЗаписьДанных.ЗаписатьСтроку(СтрШаблон(\"Content-Disposition: form-data; name=\"\"document\"\"; filename=\"\"%1.pdf\"\"\", ?(ПустаяСтрока(ИмяФайла), \"document_\" + Строка(Новый УникальныйИдентификатор()) + \".pdf\", ИмяФайла)));\n    ЗаписьДанных.ЗаписатьСтроку(\"Content-Type: application/pdf\");\n    ЗаписьДанных.ЗаписатьСтроку(\"\");   \n    //ЗаписьДанных.Закрыть();    \n    \n    // Добавим файл\n    //ЗаписьДанных    = Новый ЗаписьДанных(...);\n    ЗаписьДанных.Записать(ДвоичныеДанные);\n    //ЗаписьДанных.Закрыть();\n    \n    // Завершение записи\n    //ЗаписьДанных    = Новый ЗаписьДанных(Тело, КодировкаТекста.UTF8, ПорядокБайтов.LittleEndian, Символы.ВК + Символы.ПС, Символы.ПС, Ложь);\n    ЗаписьДанных.ЗаписатьСтроку(\"\");\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель + \"--\");\n    ЗаписьДанных.Закрыть();\n    \n    ДанныеТела          = Тело.ЗакрытьИПолучитьДвоичныеДанные();   \n\n    // Сформировать соединение и запрос\n    Соединение  = ПолучитьСоединение();\n    Заголовки   = Новый Соответствие;\n    Заголовки.Вставить(\"Content-Type\",      \"multipart/form-data; boundary=\" + Разделитель);\n    Заголовки.Вставить(\"Accept\",            \"*/*\");\n    Заголовки.Вставить(\"Cache-Control\",     \"no-cache\");\n    Заголовки.Вставить(\"Host\",              \"api.telegram.org\");\n    Заголовки.Вставить(\"Accept-Encoding\",   \"gzip, deflate\");\n    Заголовки.Вставить(\"Content-Length\",    Формат(ДанныеТела.Размер(), \"ЧДЦ=0; ЧН=0; ЧГ=0\"));\n    Заголовки.Вставить(\"Connection\",        \"close\");\n    Адрес       = СтрШаблон(\"/bot%1/sendDocument\", Токен);\n    Запрос      = Новый HTTPЗапрос(Адрес, Заголовки);\n    Запрос.УстановитьТелоИзДвоичныхДанных(ДанныеТела);\n\n    // POST\n    Ответ       = Соединение.ОтправитьДляОбработки(Запрос);\n\n    // Разбор ответа\n    Если Ответ.КодСостояния <> 200 Тогда\n        ОтветСтрокой    = Ответ.ПолучитьТелоКакСтроку(КодировкаТекста.UTF8);\n        ВызватьИсключение СтрШаблон(\"Ошибка отправки вложения в телеграм.\n            |Код состояния: %1\n            |Тело: %2\"\n            , Ответ.КодСостояния\n            , ОтветСтрокой\n        ); \n    КонецЕсли;\nКонецПроцедуры // ОтправитьФайлВТелеграм()\n#КонецОбласти\n//////////////////////////////////////////////////////////////\n\n//////////////////////////////////////////////////////////////\n#Область СлужебныеПроцедурыИФункции\nФункция ПолучитьСоединение()   \n    Прокси      = Новый ИнтернетПрокси(Истина);\n    Если ИспользоватьПрокси И ТипЗнч(ПроксиПротокол) = Тип(\"Строка\") И Не ПустаяСтрока(ПроксиПротокол) Тогда\n        Прокси.Установить(ПроксиПротокол, ПроксиСервер, ПроксиПорт, ПроксиПользователь, ПроксиПароль, Ложь);\n    КонецЕсли;\n    SSL         = Новый ЗащищенноеСоединениеOpenSSL();\n    Соединение  = Новый HTTPСоединение(\"api.telegram.org\", 443,,, Прокси, 30, SSL, Ложь); \n    Возврат Соединение;\nКонецФункции // ПолучитьСоединение()\n#КонецОбласти\n//////////////////////////////////////////////////////////////\n\n//////////////////////////////////////////////////////////////\n#Область Комментарии\n/// Author: Plague Fox\n/// Site: https://PlugFox.dev  \n/// Infostart: https://infostart.ru/profile/PlugFox/\n/// Telegram: @PlugFox\n/// Email: PlugFox@gmail.com\n/// Github: https://github.com/PlugFox\n#КонецОбласти\n//////////////////////////////////////////////////////////////\n\n#Иначе\nВызватьИсключение НСтр(\"ru = 'Недопустимый вызов объекта на клиенте.'\");\n#КонецЕсли"
  },
  {
    "title": "Скомпоновать результат отчета",
    "description": "Скомпоновать результат отчета",
    "code_snippet": "// Выполняет компоновку СКД по переданным настройкам\r\n//\r\n// Параметры:\r\n//  Результат               - ТабличныйДокумент,ТаблицаЗначений,ДеревоЗначений                      - результат выполнения\r\n//  СхемаКомпоновки         - СхемаКомпоновкиДанных                                                 - выполняемая СКД\r\n//  НастройкиКомпоновки     - НастройкиКомпоновкиДанных,КомпоновщикНастроекКомпоновкиДанных,Строка  - выполняемые настройки или адрес временного хранилища или компоновщик с настройками\r\n//  ДанныеРасшифровки       - ДанныеРасшифровкиКомпоновкиДанных, Неопределено                       - данные расшифровки\r\n//  ВнешниеНаборыДанных     - Структура, Неопределено                                               - коллекция внешних наборов данных\r\n//  ДополнительныеПараметры - Структура, Неопределено                                               - коллекция внешних наборов данных\r\n//       * МакетОформления              - МакетОформленияКомпоновкиДанных   - Макет оформления, в соответствии с которым необходимо оформлять макет компоновки данных.\r\n//       * МенеджерВременныхТаблиц      - МенеджерВременныхТаблиц,Структура - Временные таблицы, которые будут доступны в запросе СКД. Или МВТ или структура, где Ключ - Имя, а Значение - Таблица\r\n//       * ПроверятьДоступностьПолей    - Булево - Определяет, выполнять ли проверку прав на просмотр полей и проверку доступности поля во включенных функциональных возможностях.\r\n//       * ПараметрыФункциональныхОпций - Булево - Содержит параметры функциональных опций, используемые при исполнении отчета.\r\n//       * ВозможностьИспользованияВнешнихФункций - Булево - Указывает возможность использования функции общих модулей конфигурации в выражениях компоновки данных.\r\n//       * ОграничиватьПолучениеПолейПоСсылкамПоПравуПросмотр - Булево - Указывает обязательность наличия роли Просмотр для используемых метаданных в запросе СКД\r\n//\r\n//     https://infostart.ru/profile/309462/\r\n//     https://t.me/JuniorOneS\r\n//Подробнее об использовании метода: //infostart.ru/public/1082944/?ref=1159\r\n//\r\nПроцедура СкомпоноватьРезультатОтчета(Результат, СхемаКомпоновки, НастройкиКомпоновки, \r\n    ДанныеРасшифровки = Неопределено, ВнешниеНаборыДанных = Неопределено, ДополнительныеПараметры = Неопределено) Экспорт\r\n           \r\n    \r\n\t//Инициализируем настройки\r\n\tЕсли ТипЗнч(НастройкиКомпоновки) = Тип(\"КомпоновщикНастроекКомпоновкиДанных\") Тогда\r\n\t\tВыполняемыеНастройки    = НастройкиКомпоновки.ПолучитьНастройки();\r\n\tИначеЕсли ТипЗнч(НастройкиКомпоновки) = Тип(\"Строка\") И ЭтоАдресВременногоХранилища(НастройкиКомпоновки) Тогда\r\n\t\tВыполняемыеНастройки    = ПолучитьИзВременногоХранилища(НастройкиКомпоновки);\r\n\tИначе \r\n\t\tВыполняемыеНастройки    = НастройкиКомпоновки;   \r\n\tКонецЕсли;\r\n    \r\n\tЕсли НЕ ТипЗнч(ВыполняемыеНастройки) = Тип(\"НастройкиКомпоновкиДанных\") Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n    \r\n\r\n\t//Инициализируем дополнительные параметры вывода\r\n\tПараметрыВывода    = Новый Структура;\r\n\tПараметрыВывода.Вставить(\"МакетОформления\"                        , Неопределено);\r\n\tПараметрыВывода.Вставить(\"ПроверятьДоступностьПолей\"              , Истина);\r\n\tПараметрыВывода.Вставить(\"ПараметрыФункциональныхОпций\"           , Новый Структура);\r\n\tПараметрыВывода.Вставить(\"ВозможностьИспользованияВнешнихФункций\" , Ложь);\r\n\tПараметрыВывода.Вставить(\"МенеджерВременныхТаблиц\"                , Неопределено);\r\n\tПараметрыВывода.Вставить(\"ОграничиватьПолучениеПолейПоСсылкамПоПравуПросмотр\" , Истина);\r\n\t\r\n\tЕсли НЕ ДополнительныеПараметры = Неопределено Тогда\r\n\t\tЗаполнитьЗначенияСвойств(ПараметрыВывода, ДополнительныеПараметры);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ТипЗнч(ПараметрыВывода.МенеджерВременныхТаблиц) = Тип(\"Структура\") Тогда\r\n\t\tМенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\r\n\t\tДля Каждого КлючИЗначение Из ПараметрыВывода.МенеджерВременныхТаблиц Цикл\r\n\t\t\tДобавитьТаблицуВМенеджерВременныхТаблиц(МенеджерВременныхТаблиц, КлючИЗначение.Ключ, КлючИЗначение.Значение);\r\n\t\tКонецЦикла;\r\n\t\tПараметрыВывода.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tКонецЕсли;\r\n    \r\n\t//Определяем тип генератора\r\n\tЕсли ТипЗнч(Результат) = Тип(\"ТаблицаЗначений\") ИЛИ ТипЗнч(Результат) = Тип(\"ДеревоЗначений\") Тогда\r\n\t\tВыводВКоллекциюЗначений = Истина;\r\n\t\tТипГенератораВывода     = Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\");\r\n\tИначе\r\n\t\tВыводВКоллекциюЗначений = Ложь;\r\n\t\tТипГенератораВывода     = Тип(\"ГенераторМакетаКомпоновкиДанных\");\r\n\tКонецЕсли;\r\n    \r\n\t//Формируем макет, с помощью компоновщика макета\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n    \r\n\t//Передаем в макет компоновки схему, настройки и данные расшифровки\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновки, ВыполняемыеНастройки, \r\n\tДанныеРасшифровки, ПараметрыВывода.МакетОформления, ТипГенератораВывода, \r\n\tПараметрыВывода.ПроверятьДоступностьПолей, ПараметрыВывода.ПараметрыФункциональныхОпций);\r\n    \r\n\t//Выполним компоновку с помощью процессора компоновки\r\n\tПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновкиДанных.Инициализировать(\r\n\tМакетКомпоновки, ВнешниеНаборыДанных, ДанныеРасшифровки, \r\n\tПараметрыВывода.ВозможностьИспользованияВнешнихФункций,\r\n\tПараметрыВывода.ОграничиватьПолучениеПолейПоСсылкамПоПравуПросмотр,\r\n\tПараметрыВывода.МенеджерВременныхТаблиц);\r\n    \r\n\t//Выводим результат\r\n\tЕсли ВыводВКоллекциюЗначений Тогда\r\n\t\tПроцессорВывода    = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\t\tПроцессорВывода.УстановитьОбъект(Результат);\r\n\tИначе\r\n\t\tПроцессорВывода    = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n\t\tПроцессорВывода.УстановитьДокумент(Результат);\r\n\tКонецЕсли;\r\n    \r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);\r\n\r\nКонецПроцедуры\r\n\r\n// Процедура добавляет таблицу в менеджер временных таблиц\r\n//\r\n// Параметры:\r\n//  МенеджерВременныхТаблиц\t - МенеджерВременныхТаблиц - Менеджер, в который нужно добавить таблицу\r\n//  ИмяТаблицы\t\t\t\t - Строка - Имя временной таблицы\r\n//  ДанныеТаблицы\t\t\t - ТаблицаЗначений - Данные таблицы\r\n//\r\nПроцедура ДобавитьТаблицуВМенеджерВременныхТаблиц(МенеджерВременныхТаблиц, ИмяТаблицы, ДанныеТаблицы) Экспорт\r\n\t\r\n\tИменаКолонок = Новый Массив;\r\n\tДля Каждого Колонка Из ДанныеТаблицы.Колонки Цикл\r\n\t\tИменаКолонок.Добавить(Колонка.Имя);\r\n\tКонецЦикла;\r\n\tИменаКолонок = СтрСоединить(ИменаКолонок, \",\");\r\n\t\r\n\tТекстЗапроса = \"ВЫБРАТЬ %1 ПОМЕСТИТЬ %2 ИЗ &ТЗ КАК ТЗ\";\r\n\tТекстЗапроса = СтрШаблон(ТекстЗапроса, ИменаКолонок, ИмяТаблицы);\r\n\t\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tЗапрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tЗапрос.УстановитьПараметр(\"ТЗ\", ДанныеТаблицы);\r\n\tЗапрос.Выполнить();\r\n\t\r\nКонецПроцедуры\n\n// Выполняет компоновку СКД по переданным настройкам\r\n//\r\n// Параметры:\r\n//  Результат               - ТабличныйДокумент,ТаблицаЗначений,ДеревоЗначений                      - результат выполнения\r\n//  СхемаКомпоновки         - СхемаКомпоновкиДанных                                                 - выполняемая СКД\r\n//  НастройкиКомпоновки     - НастройкиКомпоновкиДанных,КомпоновщикНастроекКомпоновкиДанных,Строка  - выполняемые настройки или адрес временного хранилища или компоновщик с настройками\r\n//  ДанныеРасшифровки       - ДанныеРасшифровкиКомпоновкиДанных, Неопределено                       - данные расшифровки\r\n//  ВнешниеНаборыДанных     - Структура, Неопределено                                               - коллекция внешних наборов данных\r\n//  ДополнительныеПараметры - Структура, Неопределено                                               - коллекция внешних наборов данных\r\n//       * МакетОформления              - МакетОформленияКомпоновкиДанных   - Макет оформления, в соответствии с которым необходимо оформлять макет компоновки данных.\r\n//       * МенеджерВременныхТаблиц      - МенеджерВременныхТаблиц,Структура - Временные таблицы, которые будут доступны в запросе СКД. Или МВТ или структура, где Ключ - Имя, а Значение - Таблица\r\n//       * ПроверятьДоступностьПолей    - Булево - Определяет, выполнять ли проверку прав на просмотр полей и проверку доступности поля во включенных функциональных возможностях.\r\n//       * ПараметрыФункциональныхОпций - Булево - Содержит параметры функциональных опций, используемые при исполнении отчета.\r\n//       * ВозможностьИспользованияВнешнихФункций - Булево - Указывает возможность использования функции общих модулей конфигурации в выражениях компоновки данных.\r\n//       * ОграничиватьПолучениеПолейПоСсылкамПоПравуПросмотр - Булево - Указывает обязательность наличия роли Просмотр для используемых метаданных в запросе СКД\r\n//\r\n//     https://infostart.ru/profile/309462/\r\n//     https://t.me/JuniorOneS\r\n//Подробнее об использовании метода: //infostart.ru/public/1082944/?ref=1159\r\n//\r\nПроцедура СкомпоноватьРезультатОтчета(Результат, СхемаКомпоновки, НастройкиКомпоновки, \r\n    ДанныеРасшифровки = Неопределено, ВнешниеНаборыДанных = Неопределено, ДополнительныеПараметры = Неопределено) Экспорт\r\n           \r\n    \r\n\t//Инициализируем настройки\r\n\tЕсли ТипЗнч(НастройкиКомпоновки) = Тип(\"КомпоновщикНастроекКомпоновкиДанных\") Тогда\r\n\t\tВыполняемыеНастройки    = НастройкиКомпоновки.ПолучитьНастройки();\r\n\tИначеЕсли ТипЗнч(НастройкиКомпоновки) = Тип(\"Строка\") И ЭтоАдресВременногоХранилища(НастройкиКомпоновки) Тогда\r\n\t\tВыполняемыеНастройки    = ПолучитьИзВременногоХранилища(НастройкиКомпоновки);\r\n\tИначе \r\n\t\tВыполняемыеНастройки    = НастройкиКомпоновки;   \r\n\tКонецЕсли;\r\n    \r\n\tЕсли НЕ ТипЗнч(ВыполняемыеНастройки) = Тип(\"НастройкиКомпоновкиДанных\") Тогда\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n    \r\n\r\n\t//Инициализируем дополнительные параметры вывода\r\n\tПараметрыВывода    = Новый Структура;\r\n\tПараметрыВывода.Вставить(\"МакетОформления\"                        , Неопределено);\r\n\tПараметрыВывода.Вставить(\"ПроверятьДоступностьПолей\"              , Истина);\r\n\tПараметрыВывода.Вставить(\"ПараметрыФункциональныхОпций\"           , Новый Структура);\r\n\tПараметрыВывода.Вставить(\"ВозможностьИспользованияВнешнихФункций\" , Ложь);\r\n\tПараметрыВывода.Вставить(\"МенеджерВременныхТаблиц\"                , Неопределено);\r\n\tПараметрыВывода.Вставить(\"ОграничиватьПолучениеПолейПоСсылкамПоПравуПросмотр\" , Истина);\r\n\t\r\n\tЕсли НЕ ДополнительныеПараметры = Неопределено Тогда\r\n\t\tЗаполнитьЗначенияСвойств(ПараметрыВывода, ДополнительныеПараметры);\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли ТипЗнч(ПараметрыВывода.МенеджерВременныхТаблиц) = Тип(\"Структура\") Тогда\r\n\t\tМенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\r\n\t\tДля Каждого КлючИЗначение Из ПараметрыВывода.МенеджерВременныхТаблиц Цикл\r\n\t\t\tДобавитьТаблицуВМенеджерВременныхТаблиц(МенеджерВременныхТаблиц, КлючИЗначение.Ключ, КлючИЗначение.Значение);\r\n\t\tКонецЦикла;\r\n\t\tПараметрыВывода.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tКонецЕсли;\r\n    \r\n\t//Определяем тип генератора\r\n\tЕсли ТипЗнч(Результат) = Тип(\"ТаблицаЗначений\") ИЛИ ТипЗнч(Результат) = Тип(\"ДеревоЗначений\") Тогда\r\n\t\tВыводВКоллекциюЗначений = Истина;\r\n\t\tТипГенератораВывода     = Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\");\r\n\tИначе\r\n\t\tВыводВКоллекциюЗначений = Ложь;\r\n\t\tТипГенератораВывода     = Тип(\"ГенераторМакетаКомпоновкиДанных\");\r\n\tКонецЕсли;\r\n    \r\n\t//Формируем макет, с помощью компоновщика макета\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n    \r\n\t//Передаем в макет компоновки схему, настройки и данные расшифровки\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновки, ВыполняемыеНастройки, \r\n\tДанныеРасшифровки, ПараметрыВывода.МакетОформления, ТипГенератораВывода, \r\n\tПараметрыВывода.ПроверятьДоступностьПолей, ПараметрыВывода.ПараметрыФункциональныхОпций);\r\n    \r\n\t//Выполним компоновку с помощью процессора компоновки\r\n\tПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновкиДанных.Инициализировать(\r\n\tМакетКомпоновки, ВнешниеНаборыДанных, ДанныеРасшифровки, \r\n\tПараметрыВывода.ВозможностьИспользованияВнешнихФункций,\r\n\tПараметрыВывода.ОграничиватьПолучениеПолейПоСсылкамПоПравуПросмотр,\r\n\tПараметрыВывода.МенеджерВременныхТаблиц);\r\n    \r\n\t//Выводим результат\r\n\tЕсли ВыводВКоллекциюЗначений Тогда\r\n\t\tПроцессорВывода    = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\t\tПроцессорВывода.УстановитьОбъект(Результат);\r\n\tИначе\r\n\t\tПроцессорВывода    = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n\t\tПроцессорВывода.УстановитьДокумент(Результат);\r\n\tКонецЕсли;\r\n    \r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);\r\n\r\nКонецПроцедуры\r\n\r\n// Процедура добавляет таблицу в менеджер временных таблиц\r\n//\r\n// Параметры:\r\n//  МенеджерВременныхТаблиц\t - МенеджерВременныхТаблиц - Менеджер, в который нужно добавить таблицу\r\n//  ИмяТаблицы\t\t\t\t - Строка - Имя временной таблицы\r\n//  ДанныеТаблицы\t\t\t - ТаблицаЗначений - Данные таблицы\r\n//\r\nПроцедура ДобавитьТаблицуВМенеджерВременныхТаблиц(МенеджерВременныхТаблиц, ИмяТаблицы, ДанныеТаблицы) Экспорт\r\n\t\r\n\tИменаКолонок = Новый Массив;\r\n\tДля Каждого Колонка Из ДанныеТаблицы.Колонки Цикл\r\n\t\tИменаКолонок.Добавить(Колонка.Имя);\r\n\tКонецЦикла;\r\n\tИменаКолонок = СтрСоединить(ИменаКолонок, \",\");\r\n\t\r\n\tТекстЗапроса = \"ВЫБРАТЬ %1 ПОМЕСТИТЬ %2 ИЗ &ТЗ КАК ТЗ\";\r\n\tТекстЗапроса = СтрШаблон(ТекстЗапроса, ИменаКолонок, ИмяТаблицы);\r\n\t\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tЗапрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tЗапрос.УстановитьПараметр(\"ТЗ\", ДанныеТаблицы);\r\n\tЗапрос.Выполнить();\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Преобразовать массив структур в ТаблицуЗначений",
    "description": "Преобразовать массив структур в ТаблицуЗначений",
    "code_snippet": "Функция ПреобразоватьМассивВТаблицуЗначений(мсДанные) Экспорт\r\n    \r\n    тзДанные = Новый ТаблицаЗначений;\r\n    Для Каждого ЭлементМассива Из мсДанные Цикл\r\n        Если тзДанные.Колонки.Количество() = 0 Тогда\r\n            Для Каждого ЗначениеСтруктуры Из ЭлементМассива Цикл\r\n\t\t\t\tМассивДопустимыеТипы = Новый Массив;\r\n\t\t\t\tТипКолонки = ТипЗнч(ЗначениеСтруктуры.Значение); \r\n    \t\t\tМассивДопустимыеТипы.Добавить(ТипКолонки);                     \r\n    \t\t\tОписание_Типов = Новый ОписаниеТипов(МассивДопустимыеТипы);\r\n\t\t\t\tтзДанные.Колонки.Добавить(ЗначениеСтруктуры.Ключ,Описание_Типов);\r\n            КонецЦикла;\r\n        КонецЕсли;\r\n        НоваяСтрока = тзДанные.Добавить();\r\n        Для Каждого ЗначениеСтруктуры Из ЭлементМассива Цикл\r\n            НоваяСтрока[ЗначениеСтруктуры.Ключ] = ЗначениеСтруктуры.Значение;\r\n        КонецЦикла;\r\n    КонецЦикла;\r\n    \r\n    Возврат тзДанные;\r\n    \r\nКонецФункции\n\nФункция ПреобразоватьМассивВТаблицуЗначений(мсДанные) Экспорт\r\n    \r\n    тзДанные = Новый ТаблицаЗначений;\r\n    Для Каждого ЭлементМассива Из мсДанные Цикл\r\n        Если тзДанные.Колонки.Количество() = 0 Тогда\r\n            Для Каждого ЗначениеСтруктуры Из ЭлементМассива Цикл\r\n\t\t\t\tМассивДопустимыеТипы = Новый Массив;\r\n\t\t\t\tТипКолонки = ТипЗнч(ЗначениеСтруктуры.Значение); \r\n    \t\t\tМассивДопустимыеТипы.Добавить(ТипКолонки);                     \r\n    \t\t\tОписание_Типов = Новый ОписаниеТипов(МассивДопустимыеТипы);\r\n\t\t\t\tтзДанные.Колонки.Добавить(ЗначениеСтруктуры.Ключ,Описание_Типов);\r\n            КонецЦикла;\r\n        КонецЕсли;\r\n        НоваяСтрока = тзДанные.Добавить();\r\n        Для Каждого ЗначениеСтруктуры Из ЭлементМассива Цикл\r\n            НоваяСтрока[ЗначениеСтруктуры.Ключ] = ЗначениеСтруктуры.Значение;\r\n        КонецЦикла;\r\n    КонецЦикла;\r\n    \r\n    Возврат тзДанные;\r\n    \r\nКонецФункции\n\nФункция ПреобразоватьМассивВТаблицуЗначений(мсДанные) Экспорт\n\t//Создадим структуру колонок с типами так как сменить тип колонки в ТЗ не получиться\n\t//Создадим структуру колонок с типами так как сменить тип колонки в ТЗ не получиться\n\tСтруктураКолонок = Новый Структура;\n\t\n\tДля Каждого ЭлементМассива Из мсДанные Цикл\n\t\t//Ввиду того что массив может попасться разноколоночны нужно проверять не только первую строку\n\t\t//А так же если типы отличаются в разных элементах массива нужно иметь возможность получить читабельную ТЗ\n\t\tДля Каждого ЗначениеСтруктуры Из ЭлементМассива Цикл\n\t\t\tТипЗначенияКолонки = ТипЗнч(ЗначениеСтруктуры.Значение);\n\t\t\tЕсли НЕ СтруктураКолонок.Свойство(ЗначениеСтруктуры.Ключ) Тогда\n\t\t\t\tМассивДопустимыеТипы = Новый Массив;\n\t\t\t\tМассивДопустимыеТипы.Добавить(ТипЗначенияКолонки);\n\t\t\t\tСтруктураКолонок.Вставить(ЗначениеСтруктуры.Ключ,МассивДопустимыеТипы);\n\t\t\tИначе\n\t\t\t\tСодержитТип = СтруктураКолонок[ЗначениеСтруктуры.Ключ].Найти(ТипЗначенияКолонки);\n\t\t\t\tЕсли СодержитТип = Неопределено Тогда\n\t\t\t\t\tСтруктураКолонок[ЗначениеСтруктуры.Ключ].Добавить(ТипЗначенияКолонки)\n\t\t\t\tКонецЕсли;\n\t\t\tКонецЕсли;\n\t\tКонецЦикла;\n\tКонецЦикла;\n\t\n\t//Создадим ТЗ\n\tтзДанные = Новый ТаблицаЗначений;\n\t\n\t//Добавим Колонки в тз\n\tДля Каждого Колонка Из СтруктураКолонок Цикл\n\t\tтзДанные.Колонки.Добавить(Колонка.Ключ,Новый ОписаниеТипов(Колонка.Значение));\t\t\n\tКонецЦикла;\n\t\n\t//Теперь можно обработать нормально массив\n\tДля Каждого ЭлементМассива Из мсДанные Цикл\n\t\tСтрокаТЗ = тзДанные.Добавить();\n\t\tЗаполнитьЗначенияСвойств(СтрокаТЗ,ЭлементМассива);\n\tКонецЦикла;\n\t\n\tВозврат тзДанные;\n\nКонецФункции"
  },
  {
    "title": "Отправить сообщение или табличный документ в телеграм",
    "description": "Отправить сообщение или табличный документ в телеграм",
    "code_snippet": "/// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/// The MIT License\r\n/// \r\n/// Copyright (c) 2019 Plague Fox\r\n/// \r\n/// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n/// of this software and associated documentation files (the \"Software\"), to deal\r\n/// in the Software without restriction, including without limitation the rights\r\n/// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n/// copies of the Software, and to permit persons to whom the Software is\r\n/// furnished to do so, subject to the following conditions:\r\n/// \r\n/// The above copyright notice and this permission notice shall be included in\r\n/// all copies or substantial portions of the Software.\r\n/// \r\n/// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n/// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n/// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n/// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n/// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n/// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n/// THE SOFTWARE.\r\n/// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nПерем Токен,ИдентификаторПолучателя; // Телеграм\r\nПерем ПроксиПротокол,ПроксиСервер,ПроксиПорт,ПроксиПользователь,ПроксиПароль; // Прокси\r\n\r\nПроцедура ОтправитьСообщениеВТелеграм(Сообщение)\r\n    // Глобальные переменные в процедуре:\r\n    // + Токен\r\n    // + ИдентификаторПолучателя\r\n    \r\n    // Сформировать соединение и запрос\r\n    Соединение  = ПолучитьСоединение();\r\n    Адрес       = СтрШаблон(\"/bot%1/sendMessage?chat_id=%2&parse_mode=HTML&text=%3\"\r\n                , Токен\r\n                , ИдентификаторПолучателя\r\n                , КодироватьСтроку(Сообщение, СпособКодированияСтроки.КодировкаURL, \"UTF8\"));\r\n    Заголовки   = Новый Соответствие;\r\n    Запрос      = Новый HTTPЗапрос(Адрес, Заголовки);\r\n    \r\n    // GET\r\n    Ответ       = Соединение.Получить(Запрос);\r\n    \r\n    // Разбор ответа\r\n    Если Ответ.КодСостояния <> 200 Тогда\r\n        ОтветСтрокой    = Ответ.ПолучитьТелоКакСтроку(КодировкаТекста.UTF8);\r\n        ВызватьИсключение СтрШаблон(\"Ошибка отправки вложения в телеграм.\r\n            |Код состояния: %1\r\n            |Тело: %2\"\r\n            , Ответ.КодСостояния\r\n            , ОтветСтрокой\r\n        ); \r\n    КонецЕсли;  \r\nКонецПроцедуры // ОтправитьСообщениеВТелеграм()\r\n//************************************************************\r\nПроцедура ОтправитьТабличныйДокументВТелеграм(ТабличныйДокумент, ИмяФайла = \"\", Сообщение = \"\")\r\n    // Глобальные переменные в процедуре:\r\n    // + Токен\r\n    // + ИдентификаторПолучателя\r\n    \r\n    // Сформировать тело запроса\r\n    Разделитель     = Строка(Новый УникальныйИдентификатор());\r\n    \r\n    // Формируем основное составное сообщение\r\n    Тело            = Новый ПотокВПамяти();\r\n    ЗаписьДанных    = Новый ЗаписьДанных(Тело, КодировкаТекста.UTF8, ПорядокБайтов.LittleEndian, Символы.ВК + Символы.ПС, Символы.ПС, Истина);\r\n    \r\n    // chat_id\r\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\r\n    ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"chat_id\"\"\");\r\n    ЗаписьДанных.ЗаписатьСтроку(\"\");\r\n    ЗаписьДанных.ЗаписатьСтроку(ИдентификаторПолучателя);\r\n    \r\n    // disable_notification\r\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\r\n    ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"disable_notification\"\"\");\r\n    ЗаписьДанных.ЗаписатьСтроку(\"\");\r\n    ЗаписьДанных.ЗаписатьСтроку(\"True\");\r\n        \r\n    Если Не ПустаяСтрока(Сообщение) Тогда \r\n        // caption\r\n        ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\r\n        ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"caption\"\"\");\r\n        ЗаписьДанных.ЗаписатьСтроку(\"\");\r\n        ЗаписьДанных.ЗаписатьСтроку(Сообщение);        \r\n        \r\n        // parse_mode\r\n        ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\r\n        ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"parse_mode\"\"\");\r\n        ЗаписьДанных.ЗаписатьСтроку(\"\");\r\n        ЗаписьДанных.ЗаписатьСтроку(\"HTML\");\r\n    КонецЕсли;\r\n    \r\n    // document    \r\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\r\n    ЗаписьДанных.ЗаписатьСтроку(СтрШаблон(\"Content-Disposition: form-data; name=\"\"document\"\"; filename=\"\"%1.pdf\"\"\", ?(ПустаяСтрока(ИмяФайла), \"document_\" + Строка(Новый УникальныйИдентификатор()), ИмяФайла)));\r\n    ЗаписьДанных.ЗаписатьСтроку(\"Content-Type: application/pdf\");\r\n    ЗаписьДанных.ЗаписатьСтроку(\"\");   \r\n    ЗаписьДанных.Закрыть();    \r\n    \r\n    // Добавим файл\r\n    ТабличныйДокумент.Записать(Тело, ТипФайлаТабличногоДокумента.PDF);\r\n    \r\n    // Завершение записи\r\n    ЗаписьДанных    = Новый ЗаписьДанных(Тело, КодировкаТекста.UTF8, ПорядокБайтов.LittleEndian, Символы.ВК + Символы.ПС, Символы.ПС, Ложь);\r\n    ЗаписьДанных.ЗаписатьСтроку(\"\");\r\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель + \"--\");\r\n    ЗаписьДанных.Закрыть();\r\n    \r\n    ДанныеТела          = Тело.ЗакрытьИПолучитьДвоичныеДанные();   \r\n\r\n    // Сформировать соединение и запрос\r\n    Соединение  = ПолучитьСоединение();\r\n    Заголовки   = Новый Соответствие;\r\n    Заголовки.Вставить(\"Content-Type\",      \"multipart/form-data; boundary=\" + Разделитель);\r\n    Заголовки.Вставить(\"Accept\",            \"*/*\");\r\n    Заголовки.Вставить(\"Cache-Control\",     \"no-cache\");\r\n    Заголовки.Вставить(\"Host\",              \"api.telegram.org\");\r\n    Заголовки.Вставить(\"Accept-Encoding\",   \"gzip, deflate\");\r\n    Заголовки.Вставить(\"Content-Length\",    Формат(ДанныеТела.Размер(), \"ЧДЦ=0; ЧН=0; ЧГ=0\"));\r\n    Заголовки.Вставить(\"Connection\",        \"close\");\r\n    Адрес       = СтрШаблон(\"/bot%1/sendDocument\", Токен);\r\n    Запрос      = Новый HTTPЗапрос(Адрес, Заголовки);\r\n    Запрос.УстановитьТелоИзДвоичныхДанных(ДанныеТела);\r\n\r\n    // POST\r\n    Ответ       = Соединение.ОтправитьДляОбработки(Запрос);\r\n\r\n    // Разбор ответа\r\n    Если Ответ.КодСостояния <> 200 Тогда\r\n        ОтветСтрокой    = Ответ.ПолучитьТелоКакСтроку(КодировкаТекста.UTF8);\r\n        ВызватьИсключение СтрШаблон(\"Ошибка отправки вложения в телеграм.\r\n            |Код состояния: %1\r\n            |Тело: %2\"\r\n            , Ответ.КодСостояния\r\n            , ОтветСтрокой\r\n        ); \r\n    КонецЕсли;\r\nКонецПроцедуры // ОтправитьТабличныйДокументВТелеграм()\r\n//************************************************************\r\nФункция ПолучитьСоединение()    \r\n    // Глобальные переменные в процедуре:\r\n    // + ПроксиПротокол\r\n    // + ПроксиСервер\r\n    // + ПроксиПорт\r\n    // + ПроксиПользователь\r\n    // + ПроксиПароль\r\n    \r\n    Прокси      = Новый ИнтернетПрокси(Истина);\r\n    Если ТипЗнч(ПроксиПротокол) = Тип(\"Строка\") И Не ПустаяСтрока(ПроксиПротокол) Тогда\r\n        Прокси.Установить(ПроксиПротокол, ПроксиСервер, ПроксиПорт, ПроксиПользователь, ПроксиПароль, Ложь);\r\n    КонецЕсли;\r\n    SSL         = Новый ЗащищенноеСоединениеOpenSSL();\r\n    Соединение  = Новый HTTPСоединение(\"api.telegram.org\", 443,,, Прокси, 30, SSL, Ложь); \r\n    Возврат Соединение;\r\nКонецФункции // ПолучитьСоединение()\r\n\r\n// ТЕЛЕГРАМ +\r\nТокен                   = \"\"; // 000000000:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\r\nИдентификаторПолучателя = \"\"; // -000000000\r\n// ТЕЛЕГРАМ -\r\n\r\n// ПРОКСИ +\r\nПроксиПротокол          = \"https\"; // для socks5 - https\r\nПроксиСервер            = \"socks5://0.0.0.0\"; // socks5://domain.tld\r\nПроксиПорт              = 1080; // 1080\r\nПроксиПользователь      = \"\"; // user\r\nПроксиПароль            = \"\"; // password              \r\n// ПРОКСИ -\n\n/// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/// The MIT License\r\n/// \r\n/// Copyright (c) 2019 Plague Fox\r\n/// \r\n/// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n/// of this software and associated documentation files (the \"Software\"), to deal\r\n/// in the Software without restriction, including without limitation the rights\r\n/// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n/// copies of the Software, and to permit persons to whom the Software is\r\n/// furnished to do so, subject to the following conditions:\r\n/// \r\n/// The above copyright notice and this permission notice shall be included in\r\n/// all copies or substantial portions of the Software.\r\n/// \r\n/// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n/// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n/// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n/// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n/// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n/// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n/// THE SOFTWARE.\r\n/// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nПерем Токен,ИдентификаторПолучателя; // Телеграм\r\nПерем ПроксиПротокол,ПроксиСервер,ПроксиПорт,ПроксиПользователь,ПроксиПароль; // Прокси\r\n\r\nПроцедура ОтправитьСообщениеВТелеграм(Сообщение)\r\n    // Глобальные переменные в процедуре:\r\n    // + Токен\r\n    // + ИдентификаторПолучателя\r\n    \r\n    // Сформировать соединение и запрос\r\n    Соединение  = ПолучитьСоединение();\r\n    Адрес       = СтрШаблон(\"/bot%1/sendMessage?chat_id=%2&parse_mode=HTML&text=%3\"\r\n                , Токен\r\n                , ИдентификаторПолучателя\r\n                , КодироватьСтроку(Сообщение, СпособКодированияСтроки.КодировкаURL, \"UTF8\"));\r\n    Заголовки   = Новый Соответствие;\r\n    Запрос      = Новый HTTPЗапрос(Адрес, Заголовки);\r\n    \r\n    // GET\r\n    Ответ       = Соединение.Получить(Запрос);\r\n    \r\n    // Разбор ответа\r\n    Если Ответ.КодСостояния <> 200 Тогда\r\n        ОтветСтрокой    = Ответ.ПолучитьТелоКакСтроку(КодировкаТекста.UTF8);\r\n        ВызватьИсключение СтрШаблон(\"Ошибка отправки вложения в телеграм.\r\n            |Код состояния: %1\r\n            |Тело: %2\"\r\n            , Ответ.КодСостояния\r\n            , ОтветСтрокой\r\n        ); \r\n    КонецЕсли;  \r\nКонецПроцедуры // ОтправитьСообщениеВТелеграм()\r\n//************************************************************\r\nПроцедура ОтправитьТабличныйДокументВТелеграм(ТабличныйДокумент, ИмяФайла = \"\", Сообщение = \"\")\r\n    // Глобальные переменные в процедуре:\r\n    // + Токен\r\n    // + ИдентификаторПолучателя\r\n    \r\n    // Сформировать тело запроса\r\n    Разделитель     = Строка(Новый УникальныйИдентификатор());\r\n    \r\n    // Формируем основное составное сообщение\r\n    Тело            = Новый ПотокВПамяти();\r\n    ЗаписьДанных    = Новый ЗаписьДанных(Тело, КодировкаТекста.UTF8, ПорядокБайтов.LittleEndian, Символы.ВК + Символы.ПС, Символы.ПС, Истина);\r\n    \r\n    // chat_id\r\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\r\n    ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"chat_id\"\"\");\r\n    ЗаписьДанных.ЗаписатьСтроку(\"\");\r\n    ЗаписьДанных.ЗаписатьСтроку(ИдентификаторПолучателя);\r\n    \r\n    // disable_notification\r\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\r\n    ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"disable_notification\"\"\");\r\n    ЗаписьДанных.ЗаписатьСтроку(\"\");\r\n    ЗаписьДанных.ЗаписатьСтроку(\"True\");\r\n        \r\n    Если Не ПустаяСтрока(Сообщение) Тогда \r\n        // caption\r\n        ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\r\n        ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"caption\"\"\");\r\n        ЗаписьДанных.ЗаписатьСтроку(\"\");\r\n        ЗаписьДанных.ЗаписатьСтроку(Сообщение);        \r\n        \r\n        // parse_mode\r\n        ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\r\n        ЗаписьДанных.ЗаписатьСтроку(\"Content-Disposition: form-data; name=\"\"parse_mode\"\"\");\r\n        ЗаписьДанных.ЗаписатьСтроку(\"\");\r\n        ЗаписьДанных.ЗаписатьСтроку(\"HTML\");\r\n    КонецЕсли;\r\n    \r\n    // document    \r\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель);\r\n    ЗаписьДанных.ЗаписатьСтроку(СтрШаблон(\"Content-Disposition: form-data; name=\"\"document\"\"; filename=\"\"%1.pdf\"\"\", ?(ПустаяСтрока(ИмяФайла), \"document_\" + Строка(Новый УникальныйИдентификатор()), ИмяФайла)));\r\n    ЗаписьДанных.ЗаписатьСтроку(\"Content-Type: application/pdf\");\r\n    ЗаписьДанных.ЗаписатьСтроку(\"\");   \r\n    ЗаписьДанных.Закрыть();    \r\n    \r\n    // Добавим файл\r\n    ТабличныйДокумент.Записать(Тело, ТипФайлаТабличногоДокумента.PDF);\r\n    \r\n    // Завершение записи\r\n    ЗаписьДанных    = Новый ЗаписьДанных(Тело, КодировкаТекста.UTF8, ПорядокБайтов.LittleEndian, Символы.ВК + Символы.ПС, Символы.ПС, Ложь);\r\n    ЗаписьДанных.ЗаписатьСтроку(\"\");\r\n    ЗаписьДанных.ЗаписатьСтроку(\"--\" + Разделитель + \"--\");\r\n    ЗаписьДанных.Закрыть();\r\n    \r\n    ДанныеТела          = Тело.ЗакрытьИПолучитьДвоичныеДанные();   \r\n\r\n    // Сформировать соединение и запрос\r\n    Соединение  = ПолучитьСоединение();\r\n    Заголовки   = Новый Соответствие;\r\n    Заголовки.Вставить(\"Content-Type\",      \"multipart/form-data; boundary=\" + Разделитель);\r\n    Заголовки.Вставить(\"Accept\",            \"*/*\");\r\n    Заголовки.Вставить(\"Cache-Control\",     \"no-cache\");\r\n    Заголовки.Вставить(\"Host\",              \"api.telegram.org\");\r\n    Заголовки.Вставить(\"Accept-Encoding\",   \"gzip, deflate\");\r\n    Заголовки.Вставить(\"Content-Length\",    Формат(ДанныеТела.Размер(), \"ЧДЦ=0; ЧН=0; ЧГ=0\"));\r\n    Заголовки.Вставить(\"Connection\",        \"close\");\r\n    Адрес       = СтрШаблон(\"/bot%1/sendDocument\", Токен);\r\n    Запрос      = Новый HTTPЗапрос(Адрес, Заголовки);\r\n    Запрос.УстановитьТелоИзДвоичныхДанных(ДанныеТела);\r\n\r\n    // POST\r\n    Ответ       = Соединение.ОтправитьДляОбработки(Запрос);\r\n\r\n    // Разбор ответа\r\n    Если Ответ.КодСостояния <> 200 Тогда\r\n        ОтветСтрокой    = Ответ.ПолучитьТелоКакСтроку(КодировкаТекста.UTF8);\r\n        ВызватьИсключение СтрШаблон(\"Ошибка отправки вложения в телеграм.\r\n            |Код состояния: %1\r\n            |Тело: %2\"\r\n            , Ответ.КодСостояния\r\n            , ОтветСтрокой\r\n        ); \r\n    КонецЕсли;\r\nКонецПроцедуры // ОтправитьТабличныйДокументВТелеграм()\r\n//************************************************************\r\nФункция ПолучитьСоединение()    \r\n    // Глобальные переменные в процедуре:\r\n    // + ПроксиПротокол\r\n    // + ПроксиСервер\r\n    // + ПроксиПорт\r\n    // + ПроксиПользователь\r\n    // + ПроксиПароль\r\n    \r\n    Прокси      = Новый ИнтернетПрокси(Истина);\r\n    Если ТипЗнч(ПроксиПротокол) = Тип(\"Строка\") И Не ПустаяСтрока(ПроксиПротокол) Тогда\r\n        Прокси.Установить(ПроксиПротокол, ПроксиСервер, ПроксиПорт, ПроксиПользователь, ПроксиПароль, Ложь);\r\n    КонецЕсли;\r\n    SSL         = Новый ЗащищенноеСоединениеOpenSSL();\r\n    Соединение  = Новый HTTPСоединение(\"api.telegram.org\", 443,,, Прокси, 30, SSL, Ложь); \r\n    Возврат Соединение;\r\nКонецФункции // ПолучитьСоединение()\r\n\r\n// ТЕЛЕГРАМ +\r\nТокен                   = \"\"; // 000000000:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\r\nИдентификаторПолучателя = \"\"; // -000000000\r\n// ТЕЛЕГРАМ -\r\n\r\n// ПРОКСИ +\r\nПроксиПротокол          = \"https\"; // для socks5 - https\r\nПроксиСервер            = \"socks5://0.0.0.0\"; // socks5://domain.tld\r\nПроксиПорт              = 1080; // 1080\r\nПроксиПользователь      = \"\"; // user\r\nПроксиПароль            = \"\"; // password              \r\n// ПРОКСИ -\n\n{161} Переменной ИдентификаторПолучателя присвоено значение, но оно нигде не используется\r\n{166} Переменной ПроксиСервер присвоено значение, но оно нигде не используется\r\n{167} Переменной ПроксиПорт присвоено значение, но оно нигде не используется\r\n{168} Переменной ПроксиПользователь присвоено значение, но оно нигде не используется\r\n{169} Переменной ПроксиПароль присвоено значение, но оно нигде не используется\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Получить данные физического лица",
    "description": "Получить данные физического лица",
    "code_snippet": "ДанныеФизическогоЛица = КадровыйУчет.КадровыеДанныеФизическихЛиц(\r\n\t\tИстина, ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(ДокументДляПечати.ФизическоеЛицо), \r\n\t\t\"ФИОПолные, ФамилияИО, АдресПоПрописке, ДокументВид, ДокументСерия, ДокументНомер\", ДокументДляПечати.Дата);\n\nДанныеФизическогоЛица = КадровыйУчет.КадровыеДанныеФизическихЛиц(\r\n\t\tИстина, ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(ДокументДляПечати.ФизическоеЛицо), \r\n\t\t\"ФИОПолные, ФамилияИО, АдресПоПрописке, ДокументВид, ДокументСерия, ДокументНомер\", ДокументДляПечати.Дата);\n\n{3} Переменной ДанныеФизическогоЛица присвоено значение, но оно нигде не используется\n\n//==============================================================================\n// Получение данных ЗУП\n        \n// Возвращает структуру заполненную данными сотрудников, перечисленными в \n// параметре СписокНеобходимыхДанных.\n//\n// Параметры:\n//  Сотрудник - Ссылка на элемент справочника сотрудники или\n//\t\t\t\t\t\t  СправочникСсылка.Сотрудники.\n//  КадровыеДанные - \tСтрока - список полей данных, перечисленных через запятую \n//\t\t\t\t\t\tили Массив строк с полями данных, которые необходимо получить. \n//\t\t\t\t\t\tЕсли не указывать, будут возвращенны поля из функции КадровыеДанныеПоУмолчанию().\n//\tДатаПолученияДанных\t- дата на которую необходимо получить данные сотрудников, \n//\t\t\t\t\t\tприменимо к данным, носящим периодический характер.\n//\t\t\t\t\t\tЕсли дату не указывать, будут получены самые последние данные.\n//\n//\n//  ПоляОтбораПериодическихДанных - Структура, в качестве ключа указывается имя таблицы, содержащей\n//\t\t\t\t\t\t\t\t\tпериодические данные (например ФИОФизическихЛиц, ГражданствоФизическихЛиц).\n//\t\t\t\t\t\t\t\t\tВ качестве значений коллекция условий отбора, \n//\t\t\t\t\t\t\t\t\tсоединяемых по \"И\" и применяемых к регистру сведений.\n//\t\t\t\t\t\t\t\t\tКоллекция строки которой имеют поля.\n//\t\t\t\t\t\t\t\t\t\t* ЛевоеЗначение - строка, имя поля регистра сведений.\n//\t\t\t\t\t\t\t\t\t\t* ВидСравнения - строка, вид сравнения, допустимый в языке запросов.\n//\t\t\t\t\t\t\t\t\t\t* ПравоеЗначение - значение для сравнения с полем ЛевоеЗначение.\n//\n//\tСписок полей, допустимых в параметре КадровыеДанные см. КадровыйУчетВнутренний.ЗапросВТКадровыеДанныеСотрудников\n//\t\tи КадровыйУчетВнутренний.ЗапросВТКадровыеДанныеФизическихЛиц\n//\n// Возвращаемое значение:\n//   Структура   - Структура, содержащая запрошенные данные.\n//\nФункция ПолучитьКадровыеДанныеСотрудника(Сотрудник\n\t\t\t\t\t\t\t\t\t\t, КадровыеДанные\t\t\t\t= \"\"\n\t\t\t\t\t\t\t\t\t\t, ДатаПолученияДанных\t\t\t= '00010101'\n\t\t\t\t\t\t\t\t\t\t, ПоляОтбораПериодическихДанных\t= Неопределено\n\t\t\t\t\t\t\t\t\t\t, ФормироватьСПериодичностьДень\t= Истина)\n\tМассивСотрудников\t= Новый Массив;\n\tМассивСотрудников.Добавить(Сотрудник);\n\tТЗ\t\t\t\t\t= ПолучитьКадровыеДанныеСотрудников(Сотрудник\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t, КадровыеДанные\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t, ДатаПолученияДанных\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t, ПоляОтбораПериодическихДанных\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t, ФормироватьСПериодичностьДень);\n\tДанныеСотрудника\t= Новый Структура;\n\tДля Каждого Колонка Из ТЗ.Колонки Цикл\n\t\tДанныеСотрудника.Вставить(Колонка.Имя);\t\n\tКонецЦикла;\n\tЕсли ТЗ.Количество() = 1 Тогда\n\t\tЗаполнитьЗначенияСвойств(ДанныеСотрудника, ТЗ[0]);\t\n\tКонецЕсли;\n\tВозврат ДанныеСотрудника;\t\nКонецФункции // ПолучитьКадровыеДанныеСотрудника()\n//******************************************************************************\n// Возвращает таблицу значений заполненную данными сотрудников, перечисленными в \n// параметре СписокНеобходимыхДанных.\n//\n// Параметры:\n//  МассивСотрудников - Массив ссылок на элементы справочника сотрудники или\n//\t\t\t\t\t\t  СправочникСсылка.Сотрудники.\n//  КадровыеДанные - \tСтрока - список полей данных, перечисленных через запятую \n//\t\t\t\t\t\tили Массив строк с полями данных, которые необходимо получить. \n//\t\t\t\t\t\tЕсли не указывать, будут возвращенны поля из функции КадровыеДанныеПоУмолчанию().\n//\tДатаПолученияДанных\t- дата на которую необходимо получить данные сотрудников, \n//\t\t\t\t\t\tприменимо к данным, носящим периодический характер.\n//\t\t\t\t\t\tЕсли дату не указывать, будут получены самые последние данные.\n//\n//\n//  ПоляОтбораПериодическихДанных - Структура, в качестве ключа указывается имя таблицы, содержащей\n//\t\t\t\t\t\t\t\t\tпериодические данные (например ФИОФизическихЛиц, ГражданствоФизическихЛиц).\n//\t\t\t\t\t\t\t\t\tВ качестве значений коллекция условий отбора, \n//\t\t\t\t\t\t\t\t\tсоединяемых по \"И\" и применяемых к регистру сведений.\n//\t\t\t\t\t\t\t\t\tКоллекция строки которой имеют поля.\n//\t\t\t\t\t\t\t\t\t\t* ЛевоеЗначение - строка, имя поля регистра сведений.\n//\t\t\t\t\t\t\t\t\t\t* ВидСравнения - строка, вид сравнения, допустимый в языке запросов.\n//\t\t\t\t\t\t\t\t\t\t* ПравоеЗначение - значение для сравнения с полем ЛевоеЗначение.\n//\n//\tСписок полей, допустимых в параметре КадровыеДанные см. КадровыйУчетВнутренний.ЗапросВТКадровыеДанныеСотрудников\n//\t\tи КадровыйУчетВнутренний.ЗапросВТКадровыеДанныеФизическихЛиц\n//\n// Возвращаемое значение:\n//   ТаблицаЗначений   - Таблица значений, содержащая запрошенные данные.\n//\nФункция ПолучитьКадровыеДанныеСотрудников(МассивСотрудников\n\t\t\t\t\t\t\t\t\t\t, КадровыеДанные\t\t\t\t= \"\"\n\t\t\t\t\t\t\t\t\t\t, ДатаПолученияДанных\t\t\t= '00010101'\n\t\t\t\t\t\t\t\t\t\t, ПоляОтбораПериодическихДанных\t= Неопределено\n\t\t\t\t\t\t\t\t\t\t, ФормироватьСПериодичностьДень\t= Истина)\n\tВозврат КадровыйУчет.КадровыеДанныеСотрудников(Истина\n\t\t\t, МассивСотрудников\n\t\t\t, ?(ПустаяСтрока(КадровыеДанные), КадровыеДанныеПоУмолчанию(), КадровыеДанные)\n\t\t\t, ДатаПолученияДанных\n\t\t\t, ПоляОтбораПериодическихДанных\n\t\t\t, ФормироватьСПериодичностьДень);    \t\nКонецФункции // ПолучитьКадровыеДанныеСотрудников()\n//******************************************************************************\nФункция КадровыеДанныеПоУмолчанию()\n\t// Список доступных полей см. КадровыйУчетВнутренний.ЗапросВТКадровыеДанныеСотрудников\n\t// и КадровыйУчетВнутренний.ЗапросВТКадровыеДанныеФизическихЛиц\n\tВозврат СтрЗаменить(\"\n\t\t\t|Период,\n\t\t\t|ФизическоеЛицо,\n\t\t\t|Фамилия,\n\t\t\t|Имя,\n\t\t\t|Отчество,\n\t\t\t|ФИОПолные,\n\t\t\t|ФамилияИО,\n\t\t\t|ИОФамилия,\n            |Пол,\n            |Код,\n\t\t\t|Страна,\n\t\t\t|Организация,\n\t\t\t|Подразделение,\n\t\t\t|Должность,\n\t\t\t|ДолжностьПоШтатномуРасписанию,\n            |РабочееМестоПериодРегистрации,\n\t\t\t|ТарифнаяСтавка,\n\t\t\t|ФОТ,\n\t\t\t|ОсновноеНачисление,\n\t\t\t|Аванс,\n\t\t\t|ДокументПериодРегистрации,\t\n\t\t\t|ДокументВид, \t\t\t\t\n\t\t\t|ДокументКодМВД, \t\t\t\n\t\t\t|ДокументСерия, \t\t\t\n\t\t\t|ДокументНомер, \t\t\t\n\t\t\t|ДокументДатаВыдачи, \t\t\n\t\t\t|ДокументСрокДействия, \t\t\n\t\t\t|ДокументКемВыдан, \t\t\t\n\t\t\t|ДокументКодПодразделения, \t\n\t\t\t|ДокументПредставление,\n\t\t\t|АдресПоПрописке,\n\t\t\t|АдресПоПропискеПредставление,\n            |АдресДляИнформирования,\n            |АдресДляИнформированияПредставление,\n            |АдресМестаПроживания,\n            |АдресМестаПроживанияПредставление,\n            |ДатаРождения,\n            |МестоРождения,\n\t\t\t|ИННВСтранеГражданства,\n            |ИНН,\n\t\t\t|СтраховойНомерПФР,\n\t\t\t|ТелефонМобильный,\n\t\t\t|ТелефонМобильныйПредставление,\n\t\t\t|ТелефонДомашний,\n\t\t\t|ТелефонДомашнийПредставление,\n\t\t\t|ТелефонРабочий,\n\t\t\t|ТелефонРабочийПредставление,\n\t\t\t|EMail,\n\t\t\t|EMailПредставление,\n            |ТабельныйНомер,\n            |ДатаПриема,\n            |ДатаУвольнения,\n            |ДатаЗавершенияРаботы,\n            |ТекущаяОрганизация,\n            |ТекущееПодразделение,\n            |ТекущаяДолжность,\n            |ТекущийВидЗанятости,\n            |ОсновноеРабочееМестоВОрганизации,\n            |ОформленПоТрудовомуДоговору,\n            |ТекущаяДолжностьПоШтатномуРасписанию,\n            |ТекущийВидДоговора,\n            |ТекущаяТерритория,\n            |ТекущаяТарифнаяСтавка,\n            |ТекущийФОТ,\n            |ТекущаяНадбавка,\n            |ТекущийСпособРасчетаАванса,\n            |ТекущийАванс,\n            |ДатаНачалаУчета,\n            |ТрудовойДоговорНомер,\n            |ТрудовойДоговорДата,\n            //|ЗарплатныйПроект,\n            //|НомерЛицевогоСчета,\n            //|ЗарплатныйПроектДатаОткрытияЛицевогоСчета,\n            //|ЗарплатныйПроектРегистратор\n            |Сотрудник\", Символы.ПС, \"\");\t\nКонецФункции // КадровыеДанныеПоУмолчанию()\n\n// Возвращает сведения об ответственных лицах организации.\n//\n// Параметры:\n//\t\tОрганизация - ссылка на организацию.\n//\t\tСведения - строка с идентификаторами, разделенными запятыми.\n//\t\tДатаСведений - дата получения сведений.\n//\n// Возвращаемое значение:\n//\t\tСтруктураДанных - структура со свойствами, совпадающими с параметром «Сведения».\n//\t\t\tДопустимые идентификаторы запрашиваемых значений:\n//\t\t\t\tРуководитель\t\t\t\t\t\t- руководитель организации.\n//\t\t\t\tДолжностьРуководителя\t\t\t\t- должность руководителя.\n//\t\t\t\tДолжностьРуководителяСтрокой\t\t- представление должности руководителя.\n//\n//\t\t\t\tГлавныйБухгалтер\t\t\t\t\t- главный бухгалтер организации.\n//\n//\t\t\t\tКассир\t\t\t\t\t\t\t\t- кассир организации.\n//\t\t\t\tДолжностьКассира\t\t\t\t\t- должность кассира.\n//\t\t\t\tДолжностьКассираСтрокой\t\t\t\t- представление должности кассира.\n//\n//\t\t\t\tРуководительКадровойСлужбы\t\t\t\t\t- Руководитель кадровой службы организации.\n//\t\t\t\tДолжностьРуководителяКадровойСлужбы\t\t\t- должность руководителя кадровой службы организации.\n//\t\t\t\tДолжностьРуководителяКадровойСлужбыСтрокой\t- представление должности руководителя кадровой службы организации.\n//\n//\t\t\t\tОтветственныйЗаВУР \t\t\t\t\t- ответственный за военно-учетную работу.\n//\t\t\t\tДолжностьОтветственногоЗаВУР \t\t- должность ответственного за военно-учетную работу.\n//\t\t\t\tДолжностьОтветственногоЗаВУРСтрокой - представление должности ответственного за военно-учетную работу.\n//\nФункция ПолучитьДанныеОтветсвенныхЛиц(Организация, Сведения = \"\", ДатаСведений = Неопределено)\n\tСведения = ?(Не ПустаяСтрока(Сведения), Сведения, \"Руководитель,ДолжностьРуководителя,ДолжностьРуководителяСтрокой,ГлавныйБухгалтер\");\n\tВозврат СведенияОбОтветственныхЛицах.СведенияОбОтветственныхЛицах(Организация, Сведения, ДатаСведений);\nКонецФункции // ПолучитьДанныеОтветсвенныхЛиц() \n\n// Функция возвращает сведения об организации.\n//\n// Параметры:\n//   Организация       - СправочникСсылка.Организации - ссылка на элемент справочника \"Организации\".\n//   ДатаЗначения      - Дата - дата, на которую нужно получить сведения.\n//   СписокПоказателей - СписокЗначений - список показателей, значения которых нужно вернуть.\n//  \n// Возвращаемое значение:\n//   Структура - структура с ключами из списка показателей и возвращаемыми значениями.\n//\n// Пример:\n//\t ОргСведения = Новый Структура;\n//   Для Каждого Показатель Из СписокПоказателей Цикл\n//  \t ИмяПоказателя = Показатель.Представление;\n//       Если Имяпоказателя = \"КодНО\" Тогда\n//      \t Значение = Организация.КодНалоговогоОргана;\n//       ИначеЕсли ИмяПоказателя = \"ОГРН\" Тогда\n//      \t Значение = Организация.ОГРН;\n//       Иначе\n//      \t Значение = \"\";\n//       КонецЕсли;\n//       ОргСведения.Вставить(ИмяПоказателя, Значение);\n//   КонецЦикла;\n//   Возврат ОргСведения;\n//\nФункция ПолучитьСведенияОбОрганизации(Организация, Сведения = Неопределено, ДатаСведений = Неопределено)\n    Если Сведения = Неопределено Тогда\n        // Описания реквизитов в ЗарплатаКадрыБазовый.ПолучитьСведенияОбОрганизации()\n        Сведения = \"НаимЮЛСокр,НаимЮЛПол,ТелОрганизации,ИННЮЛ,КППЮЛ,ОГРН,АдрПочт_XML,АдрФакт_XML,АдрЮР_XML,АдресЭлектроннойПочтыОрганизации,ПолныйАдрЮР,ОргГород\";\n    КонецЕсли;\n\tВозврат РегламентированнаяОтчетностьВызовСервера.ПолучитьСведенияОбОрганизации(Организация, ДатаСведений, Сведения);\nКонецФункции // ПолучитьСведенияОбОрганизации()\n//******************************************************************************\nФункция АдресаОрганизации(Организация)\n    АдресаОрганизаций = УправлениеКонтактнойИнформациейЗарплатаКадры.АдресаОрганизаций(Организация);\n    ОписаниеЮридическогоАдреса = УправлениеКонтактнойИнформациейЗарплатаКадры.АдресОрганизации(\n        АдресаОрганизаций,\n        Организация,\n        Справочники.ВидыКонтактнойИнформации.ЮрАдресОрганизации);\t\t\t\t\n    ОписаниеФактическогоАдреса = УправлениеКонтактнойИнформациейЗарплатаКадры.АдресОрганизации(\n        АдресаОрганизаций,\n        Организация,\n        Справочники.ВидыКонтактнойИнформации.ФактАдресОрганизации);\n    ОрганизацияГород = ОписаниеФактическогоАдреса.Город;\n    Если НЕ ЗначениеЗаполнено(ОрганизацияГород) Тогда\n        ОрганизацияГород = ОписаниеЮридическогоАдреса.Город;\n    КонецЕсли;\n    Возврат Новый Структура(\"ОписаниеЮридическогоАдреса,ОписаниеФактическогоАдреса,ОрганизацияГород\"\n            , ОписаниеЮридическогоАдреса\n            , ОписаниеФактическогоАдреса\n            , ОрганизацияГород);     \nКонецФункции // АдресаОрганизации()"
  },
  {
    "title": "Записать текстовый файл без BOM",
    "description": "Записать текстовый файл без BOM",
    "code_snippet": "ПутьФайла = ПолучитьИмяВременногоФайла();\r\n\r\nСтрокаТекста = \"текст\";\r\n\r\nТекстовыйФайл = Новый ТекстовыйДокумент;\r\nТекстовыйФайл.УстановитьТекст(СтрокаТекста);\t\t\r\nТекстовыйФайл.Записать(ПутьФайла, КодировкаТекста.UTF8, Символы.ПС);\r\n\r\nФайловыйПоток = Новый ФайловыйПоток(ПутьФайла,РежимОткрытияФайла.Создать);\r\nТекстовыйФайл.Записать(ФайловыйПоток,КодировкаТекста.UTF8, Символы.ПС, Ложь);\r\n\r\nФайловыйПоток.Закрыть();\n\nПутьФайла = ПолучитьИмяВременногоФайла();\r\n\r\nСтрокаТекста = \"текст\";\r\n\r\nТекстовыйФайл = Новый ТекстовыйДокумент;\r\nТекстовыйФайл.УстановитьТекст(СтрокаТекста);\t\t\r\nТекстовыйФайл.Записать(ПутьФайла, КодировкаТекста.UTF8, Символы.ПС);\r\n\r\nФайловыйПоток = Новый ФайловыйПоток(ПутьФайла,РежимОткрытияФайла.Создать);\r\nТекстовыйФайл.Записать(ФайловыйПоток,КодировкаТекста.UTF8, Символы.ПС, Ложь);\r\n\r\nФайловыйПоток.Закрыть();"
  },
  {
    "title": "Формат изображения (уменьшить,обрезать,масштабировать,сжать)",
    "description": "Формат изображения (уменьшить,обрезать,масштабировать,сжать)",
    "code_snippet": "&НаКлиенте\r\nПроцедура сжатьФото(Фото)\r\n\tМаксимальнаяШирина\t= 700; \r\n\tМаксимальнаяВысота\t= 400;\r\n\t\t\t\r\n\tОбрезкаЛ\t=  200;\r\n\tОбрезкаВ\t=  0;\r\n\tОбрезкаП\t=  200;\r\n\tОбрезкаН\t=  0;\r\n\t\r\n    // Создаем объект\r\n    ФайлКартинка = Новый COMОбъект(\"WIA.ImageFile\");\r\n    ФайлКартинка.LoadFile(Фото);\r\n\r\n    //Сообщить(\"Картинка: \" + Картинка.Имя);\r\n    //Сообщить(\"    Расширение файла: \" + ФайлКартинка.FileExtension);\r\n    //Сообщить(\"    Ширина: \" + ФайлКартинка.Width);\r\n    //Сообщить(\"    Высота: \" + ФайлКартинка.Height);\r\n    //Сообщить(\"    Размер: \" + Окр(ФайлКартинка.FileData.Count / 1024, 2) + \" Кб\");\r\n        \r\n    ФайлПрогресс = Новый COMОбъект(\"WIA.ImageProcess\"); ///ФайлПрогресс.Filters - список Фильтров, всего 8\r\n\t\t\r\n    ФайлПрогресс.Filters.Add(ФайлПрогресс.FilterInfos(\"Scale\").FilterID);    ///масштабирование  \r\n    ФайлПрогресс.Filters.Add(ФайлПрогресс.FilterInfos(\"Crop\").FilterID);     ///Обрезка\r\n\tФайлПрогресс.Filters.Add(ФайлПрогресс.FilterInfos(\"Convert\").FilterID);  ///Конвертация (Сжатия)\r\n\t\t\r\n\tФайлПрогресс.Filters(1).Properties(\"MaximumWidth\").Value  = МаксимальнаяШирина;        \r\n\tФайлПрогресс.Filters(1).Properties(\"MaximumHeight\").Value = МаксимальнаяВысота;\t    \r\n\tФайлПрогресс.Filters(1).Properties(\"PreserveAspectRatio\").Value = Ложь;  ///Сохранять пропорции (По умолчанию было истина - сбивает разрешения высоту и ширину)\r\n\t\r\n\t//Форматы преобразований имееют следующий формат:\r\n\t///wiaFormatBMP    = \"{B96B3CAB-0728-11D3-9D7B-0000F81EF32E}\";      ///  .BMP\r\n\twiaFormatJPEG   = \"{B96B3CAE-0728-11D3-9D7B-0000F81EF32E}\";         ///  .JPEG\r\n\r\n\tФайлПрогресс.Filters(3).Properties(\"FormatID\").Value = wiaFormatJPEG;\r\n\tФайлПрогресс.Filters(3).Properties(\"Quality\").Value = 50;          ///Качество фотографии  (от 1 - 100); 100 =60КБ  50 = 8КБ\r\n\r\n\t///Обрезка\r\n\tФайлПрогресс.Filters(2).Properties(\"Left\").Value   =  ОбрезкаЛ;       /// лево;    \r\n\tФайлПрогресс.Filters(2).Properties(\"Top\").Value    =  ОбрезкаВ;       /// верх;     \r\n\tФайлПрогресс.Filters(2).Properties(\"Right\").Value  =  ОбрезкаП;       /// право;    \r\n\tФайлПрогресс.Filters(2).Properties(\"Bottom\").Value =  ОбрезкаН;\t      /// низ;      \r\n\t\r\n\t///Применить фильтры к фотографии\r\n    ФайлКартинка = ФайлПрогресс.Apply(ФайлКартинка);\r\n\r\n\t///Удалить старое фото и создать новое\r\n\tУдалитьФайлы(фото);\r\n    ФайлКартинка.SaveFile(фото);\r\n\t\r\n\t\r\n\t//Сообщить(\"    Расширение файла: \" + ФайлКартинка.FileExtension);\r\n\t//Сообщить(\"    Ширина: \" + ФайлКартинка.Width);\r\n\t//Сообщить(\"    Высота: \" + ФайлКартинка.Height);\r\n\t//Сообщить(\"    Размер: \" + Окр(ФайлКартинка.FileData.Count / 1024, 2) + \" Кб\");\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура сжатьФото(Фото)\r\n\tМаксимальнаяШирина\t= 700; \r\n\tМаксимальнаяВысота\t= 400;\r\n\t\t\t\r\n\tОбрезкаЛ\t=  200;\r\n\tОбрезкаВ\t=  0;\r\n\tОбрезкаП\t=  200;\r\n\tОбрезкаН\t=  0;\r\n\t\r\n    // Создаем объект\r\n    ФайлКартинка = Новый COMОбъект(\"WIA.ImageFile\");\r\n    ФайлКартинка.LoadFile(Фото);\r\n\r\n    //Сообщить(\"Картинка: \" + Картинка.Имя);\r\n    //Сообщить(\"    Расширение файла: \" + ФайлКартинка.FileExtension);\r\n    //Сообщить(\"    Ширина: \" + ФайлКартинка.Width);\r\n    //Сообщить(\"    Высота: \" + ФайлКартинка.Height);\r\n    //Сообщить(\"    Размер: \" + Окр(ФайлКартинка.FileData.Count / 1024, 2) + \" Кб\");\r\n        \r\n    ФайлПрогресс = Новый COMОбъект(\"WIA.ImageProcess\"); ///ФайлПрогресс.Filters - список Фильтров, всего 8\r\n\t\t\r\n    ФайлПрогресс.Filters.Add(ФайлПрогресс.FilterInfos(\"Scale\").FilterID);    ///масштабирование  \r\n    ФайлПрогресс.Filters.Add(ФайлПрогресс.FilterInfos(\"Crop\").FilterID);     ///Обрезка\r\n\tФайлПрогресс.Filters.Add(ФайлПрогресс.FilterInfos(\"Convert\").FilterID);  ///Конвертация (Сжатия)\r\n\t\t\r\n\tФайлПрогресс.Filters(1).Properties(\"MaximumWidth\").Value  = МаксимальнаяШирина;        \r\n\tФайлПрогресс.Filters(1).Properties(\"MaximumHeight\").Value = МаксимальнаяВысота;\t    \r\n\tФайлПрогресс.Filters(1).Properties(\"PreserveAspectRatio\").Value = Ложь;  ///Сохранять пропорции (По умолчанию было истина - сбивает разрешения высоту и ширину)\r\n\t\r\n\t//Форматы преобразований имееют следующий формат:\r\n\t///wiaFormatBMP    = \"{B96B3CAB-0728-11D3-9D7B-0000F81EF32E}\";      ///  .BMP\r\n\twiaFormatJPEG   = \"{B96B3CAE-0728-11D3-9D7B-0000F81EF32E}\";         ///  .JPEG\r\n\r\n\tФайлПрогресс.Filters(3).Properties(\"FormatID\").Value = wiaFormatJPEG;\r\n\tФайлПрогресс.Filters(3).Properties(\"Quality\").Value = 50;          ///Качество фотографии  (от 1 - 100); 100 =60КБ  50 = 8КБ\r\n\r\n\t///Обрезка\r\n\tФайлПрогресс.Filters(2).Properties(\"Left\").Value   =  ОбрезкаЛ;       /// лево;    \r\n\tФайлПрогресс.Filters(2).Properties(\"Top\").Value    =  ОбрезкаВ;       /// верх;     \r\n\tФайлПрогресс.Filters(2).Properties(\"Right\").Value  =  ОбрезкаП;       /// право;    \r\n\tФайлПрогресс.Filters(2).Properties(\"Bottom\").Value =  ОбрезкаН;\t      /// низ;      \r\n\t\r\n\t///Применить фильтры к фотографии\r\n    ФайлКартинка = ФайлПрогресс.Apply(ФайлКартинка);\r\n\r\n\t///Удалить старое фото и создать новое\r\n\tУдалитьФайлы(фото);\r\n    ФайлКартинка.SaveFile(фото);\r\n\t\r\n\t\r\n\t//Сообщить(\"    Расширение файла: \" + ФайлКартинка.FileExtension);\r\n\t//Сообщить(\"    Ширина: \" + ФайлКартинка.Width);\r\n\t//Сообщить(\"    Высота: \" + ФайлКартинка.Height);\r\n\t//Сообщить(\"    Размер: \" + Окр(ФайлКартинка.FileData.Count / 1024, 2) + \" Кб\");\r\nКонецПроцедуры\n\nОрфографическая ошибка в FilterInfos (найдено 3): Infos\r\nОрфографическая ошибка в имееют: имееют\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Убрать итоги из готового текста запроса",
    "description": "Убрать итоги из готового текста запроса",
    "code_snippet": "СхемаЗапроса = новый СхемаЗапроса;\r\nСхемаЗапроса.УстановитьТекстЗапроса(Запрос.Текст);\r\nСхемаЗапроса.ПакетЗапросов.Получить(СхемаЗапроса.ПакетЗапросов.Количество()-1).ВыраженияИтогов.Очистить();\r\nСхемаЗапроса.ПакетЗапросов.Получить(СхемаЗапроса.ПакетЗапросов.Количество()-1).КонтрольныеТочкиИтогов.Очистить();\r\nЗапрос.Текст = СхемаЗапроса.ПолучитьТекстЗапроса();\n\nСхемаЗапроса = новый СхемаЗапроса;\r\nСхемаЗапроса.УстановитьТекстЗапроса(Запрос.Текст);\r\nСхемаЗапроса.ПакетЗапросов.Получить(СхемаЗапроса.ПакетЗапросов.Количество()-1).ВыраженияИтогов.Очистить();\r\nСхемаЗапроса.ПакетЗапросов.Получить(СхемаЗапроса.ПакетЗапросов.Количество()-1).КонтрольныеТочкиИтогов.Очистить();\r\nЗапрос.Текст = СхемаЗапроса.ПолучитьТекстЗапроса();"
  },
  {
    "title": "Выгрузка в Excel документ",
    "description": "Выгрузка в Excel документ",
    "code_snippet": "Орфографическая ошибка в Эксель: Эксель"
  },
  {
    "title": "Дублирование тегов",
    "description": "Дублирование тегов",
    "code_snippet": "Орфографическая ошибка в экземлярах: экземлярах"
  },
  {
    "title": "Плановая себестоимость продаж (цена на Дату документа)",
    "description": "Плановая себестоимость продаж (цена на Дату документа)",
    "code_snippet": "Запрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\"ВЫБРАТЬ\r\n\t|\tПродажиОбороты.Период КАК Период,\r\n\t|\tПродажиОбороты.Характеристика КАК Характеристика,\r\n\t|\tПродажиОбороты.Номенклатура КАК Номенклатура,\r\n\t|\tПродажиОбороты.КоличествоОборот КАК Количество,\r\n\t|\tПродажиОбороты.СуммаОборот КАК Выручка,\r\n\t|\tПродажиОбороты.Контрагент КАК Контрагент,\r\n\t|\tПродажиОбороты.ЗаказПокупателя КАК ЗаказПокупателя,\r\n\t|\tПродажиОбороты.Ответственный КАК Ответственный\r\n\t|ПОМЕСТИТЬ втПродажиБезЦены\r\n\t|ИЗ\r\n\t|\tРегистрНакопления.Продажи.Обороты(&ДатаНачала, &ДатаОкончания, Регистратор, ) КАК ПродажиОбороты\r\n\t|;\r\n\t|\r\n\t|////////////////////////////////////////////////////////////////////////////////\r\n\t|ВЫБРАТЬ\r\n\t|\tЦеныНоменклатуры.Номенклатура КАК Номенклатура,\r\n\t|\tЦеныНоменклатуры.Характеристика КАК Характеристика,\r\n\t|\tМАКСИМУМ(ЦеныНоменклатуры.Цена) КАК Цена,\r\n\t|\tЦеныНоменклатуры.Период КАК Период\r\n\t|ПОМЕСТИТЬ втЦеныПоНоменклатуре\r\n\t|ИЗ\r\n\t|\tРегистрСведений.ЦеныНоменклатуры КАК ЦеныНоменклатуры\r\n\t|ГДЕ\r\n\t|\tЦеныНоменклатуры.Период <= &ДатаОкончания\r\n\t|\tИ ЦеныНоменклатуры.ВидЦен = &ВидЦен\r\n\t|\r\n\t|СГРУППИРОВАТЬ ПО\r\n\t|\tЦеныНоменклатуры.Номенклатура,\r\n\t|\tЦеныНоменклатуры.Характеристика,\r\n\t|\tЦеныНоменклатуры.Период\r\n\t|;\r\n\t|\r\n\t|////////////////////////////////////////////////////////////////////////////////\r\n\t|ВЫБРАТЬ\r\n\t|\tПродажиОбороты.Период КАК Период,\r\n\t|\tЕСТЬNULL(ПродажиОбороты.Выручка, 0) КАК Выручка,\r\n\t|\tПродажиОбороты.Характеристика КАК Характеристика,\r\n\t|\tПродажиОбороты.Номенклатура КАК Номенклатура,\r\n\t|\tЕСТЬNULL(ПродажиОбороты.Количество, 0) КАК Количество,\r\n\t|\tПродажиОбороты.Контрагент КАК Контрагент,\r\n\t|\tПродажиОбороты.Ответственный КАК Ответственный,\r\n\t|\tПродажиОбороты.ЗаказПокупателя КАК ЗаказПокупателя,\r\n\t|\tМАКСИМУМ(ЦеныНоменклатуры.Период) КАК ДатаЦены\r\n\t|ПОМЕСТИТЬ втМаксПериод\r\n\t|ИЗ\r\n\t|\tвтПродажиБезЦены КАК ПродажиОбороты\r\n\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ втЦеныПоНоменклатуре КАК ЦеныНоменклатуры\r\n\t|\t\tПО (ЦеныНоменклатуры.Номенклатура = ПродажиОбороты.Номенклатура)\r\n\t|\t\t\tИ (ЦеныНоменклатуры.Характеристика = ПродажиОбороты.Характеристика)\r\n\t|\t\t\tИ (ЦеныНоменклатуры.Период <= ПродажиОбороты.Период)\r\n\t|\r\n\t|СГРУППИРОВАТЬ ПО\r\n\t|\tПродажиОбороты.Ответственный,\r\n\t|\tПродажиОбороты.Контрагент,\r\n\t|\tПродажиОбороты.Номенклатура,\r\n\t|\tПродажиОбороты.Характеристика,\r\n\t|\tПродажиОбороты.Период,\r\n\t|\tПродажиОбороты.ЗаказПокупателя,\r\n\t|\tЕСТЬNULL(ПродажиОбороты.Выручка, 0),\r\n\t|\tЕСТЬNULL(ПродажиОбороты.Количество, 0)\r\n\t|;\r\n\t|\r\n\t|////////////////////////////////////////////////////////////////////////////////\r\n\t|ВЫБРАТЬ\r\n\t|\tЗаказ_Поставщику.ЗаказПокупателя КАК ЗаказПокупателя,\r\n\t|\tСУММА(ЗаказПоставщикуЗапасы.Сумма) КАК Сумма\r\n\t|ПОМЕСТИТЬ ВТЗатратыНаСубподряд\r\n\t|ИЗ\r\n\t|\tДокумент.ЗаказПоставщику.Запасы КАК ЗаказПоставщикуЗапасы\r\n\t|\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК Заказ_Поставщику\r\n\t|\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК Заказ_Покупателя\r\n\t|\t\t\tПО Заказ_Поставщику.ЗаказПокупателя = Заказ_Покупателя.Ссылка\r\n\t|\t\tПО ЗаказПоставщикуЗапасы.Ссылка = Заказ_Поставщику.Ссылка\r\n\t|ГДЕ\r\n\t|\tЗаказ_Покупателя.Дата > ДОБАВИТЬКДАТЕ(&ДатаНачала, ГОД, -1) И  Заказ_Покупателя.Контрагент НЕ В (&КонтрагентыБезСубподряда)\r\n\t|\r\n\t|СГРУППИРОВАТЬ ПО\r\n\t|\tЗаказ_Поставщику.ЗаказПокупателя\r\n\t|;\r\n\t|\r\n\t|////////////////////////////////////////////////////////////////////////////////\r\n\t|ВЫБРАТЬ\r\n\t|\tПродажиОбороты.Характеристика КАК Характеристика,\r\n\t|\tПродажиОбороты.Номенклатура КАК Номенклатура,\r\n\t|\tПродажиОбороты.Количество КАК Количество,\r\n\t|\tПродажиОбороты.Выручка КАК Выручка,\r\n\t|\tПродажиОбороты.Контрагент КАК Контрагент,\r\n\t|\tПродажиОбороты.Ответственный КАК Ответственный,\r\n\t|\tПродажиОбороты.Период КАК Период,\r\n\t|\tПродажиОбороты.ЗаказПокупателя КАК ЗаказПокупателя,\r\n\t|\tЦеныНоменклатуры.Цена КАК Цена,\r\n\t|\tisnull(ЦеныНоменклатуры.Цена,0) * ПродажиОбороты.Количество КАК Себестоимость,\r\n\t|\tisnull(ВТЗатратыНаСубподряд.Сумма,0) КАК Субподряд\r\n\t|ИЗ\r\n\t|\tвтМаксПериод КАК ПродажиОбороты\r\n\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ втЦеныПоНоменклатуре КАК ЦеныНоменклатуры\r\n\t|\t\tПО (ЦеныНоменклатуры.Номенклатура = ПродажиОбороты.Номенклатура)\r\n\t|\t\t\tИ (ЦеныНоменклатуры.Период = ПродажиОбороты.ДатаЦены)\r\n\t|\t\t\tИ ПродажиОбороты.Характеристика = ЦеныНоменклатуры.Характеристика\r\n\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ ВТЗатратыНаСубподряд КАК ВТЗатратыНаСубподряд\r\n\t|\t\tПО ПродажиОбороты.ЗаказПокупателя = ВТЗатратыНаСубподряд.ЗаказПокупателя\r\n\t|\r\n\t|СГРУППИРОВАТЬ ПО\r\n\t|\tПродажиОбороты.Ответственный,\r\n\t|\tПродажиОбороты.Характеристика,\r\n\t|\tПродажиОбороты.Контрагент,\r\n\t|\tПродажиОбороты.ЗаказПокупателя,\r\n\t|\tПродажиОбороты.Номенклатура,\r\n\t|\tПродажиОбороты.Количество,\r\n\t|\tПродажиОбороты.Период,\r\n\t|\tПродажиОбороты.Выручка,\r\n\t|\tЦеныНоменклатуры.Цена,\r\n\t|\tПродажиОбороты.ДатаЦены,\r\n\t|\tЦеныНоменклатуры.Цена * ПродажиОбороты.Количество,\r\n\t|\tВТЗатратыНаСубподряд.Сумма\r\n\t|ИТОГИ\r\n\t|\tСУММА(Количество),\r\n\t|\tСУММА(Выручка),\r\n\t|\tСУММА(Себестоимость),\r\n\t|\tМАКСИМУМ(Субподряд)\r\n\t|ПО\r\n\t|\tОтветственный,\r\n\t|\tКонтрагент,\r\n\t|\tЗаказПокупателя,\r\n\t|\tНоменклатура\";\n\nЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\"ВЫБРАТЬ\r\n\t|\tПродажиОбороты.Период КАК Период,\r\n\t|\tПродажиОбороты.Характеристика КАК Характеристика,\r\n\t|\tПродажиОбороты.Номенклатура КАК Номенклатура,\r\n\t|\tПродажиОбороты.КоличествоОборот КАК Количество,\r\n\t|\tПродажиОбороты.СуммаОборот КАК Выручка,\r\n\t|\tПродажиОбороты.Контрагент КАК Контрагент,\r\n\t|\tПродажиОбороты.ЗаказПокупателя КАК ЗаказПокупателя,\r\n\t|\tПродажиОбороты.Ответственный КАК Ответственный\r\n\t|ПОМЕСТИТЬ втПродажиБезЦены\r\n\t|ИЗ\r\n\t|\tРегистрНакопления.Продажи.Обороты(&ДатаНачала, &ДатаОкончания, Регистратор, ) КАК ПродажиОбороты\r\n\t|;\r\n\t|\r\n\t|////////////////////////////////////////////////////////////////////////////////\r\n\t|ВЫБРАТЬ\r\n\t|\tЦеныНоменклатуры.Номенклатура КАК Номенклатура,\r\n\t|\tЦеныНоменклатуры.Характеристика КАК Характеристика,\r\n\t|\tМАКСИМУМ(ЦеныНоменклатуры.Цена) КАК Цена,\r\n\t|\tЦеныНоменклатуры.Период КАК Период\r\n\t|ПОМЕСТИТЬ втЦеныПоНоменклатуре\r\n\t|ИЗ\r\n\t|\tРегистрСведений.ЦеныНоменклатуры КАК ЦеныНоменклатуры\r\n\t|ГДЕ\r\n\t|\tЦеныНоменклатуры.Период <= &ДатаОкончания\r\n\t|\tИ ЦеныНоменклатуры.ВидЦен = &ВидЦен\r\n\t|\r\n\t|СГРУППИРОВАТЬ ПО\r\n\t|\tЦеныНоменклатуры.Номенклатура,\r\n\t|\tЦеныНоменклатуры.Характеристика,\r\n\t|\tЦеныНоменклатуры.Период\r\n\t|;\r\n\t|\r\n\t|////////////////////////////////////////////////////////////////////////////////\r\n\t|ВЫБРАТЬ\r\n\t|\tПродажиОбороты.Период КАК Период,\r\n\t|\tЕСТЬNULL(ПродажиОбороты.Выручка, 0) КАК Выручка,\r\n\t|\tПродажиОбороты.Характеристика КАК Характеристика,\r\n\t|\tПродажиОбороты.Номенклатура КАК Номенклатура,\r\n\t|\tЕСТЬNULL(ПродажиОбороты.Количество, 0) КАК Количество,\r\n\t|\tПродажиОбороты.Контрагент КАК Контрагент,\r\n\t|\tПродажиОбороты.Ответственный КАК Ответственный,\r\n\t|\tПродажиОбороты.ЗаказПокупателя КАК ЗаказПокупателя,\r\n\t|\tМАКСИМУМ(ЦеныНоменклатуры.Период) КАК ДатаЦены\r\n\t|ПОМЕСТИТЬ втМаксПериод\r\n\t|ИЗ\r\n\t|\tвтПродажиБезЦены КАК ПродажиОбороты\r\n\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ втЦеныПоНоменклатуре КАК ЦеныНоменклатуры\r\n\t|\t\tПО (ЦеныНоменклатуры.Номенклатура = ПродажиОбороты.Номенклатура)\r\n\t|\t\t\tИ (ЦеныНоменклатуры.Характеристика = ПродажиОбороты.Характеристика)\r\n\t|\t\t\tИ (ЦеныНоменклатуры.Период <= ПродажиОбороты.Период)\r\n\t|\r\n\t|СГРУППИРОВАТЬ ПО\r\n\t|\tПродажиОбороты.Ответственный,\r\n\t|\tПродажиОбороты.Контрагент,\r\n\t|\tПродажиОбороты.Номенклатура,\r\n\t|\tПродажиОбороты.Характеристика,\r\n\t|\tПродажиОбороты.Период,\r\n\t|\tПродажиОбороты.ЗаказПокупателя,\r\n\t|\tЕСТЬNULL(ПродажиОбороты.Выручка, 0),\r\n\t|\tЕСТЬNULL(ПродажиОбороты.Количество, 0)\r\n\t|;\r\n\t|\r\n\t|////////////////////////////////////////////////////////////////////////////////\r\n\t|ВЫБРАТЬ\r\n\t|\tЗаказ_Поставщику.ЗаказПокупателя КАК ЗаказПокупателя,\r\n\t|\tСУММА(ЗаказПоставщикуЗапасы.Сумма) КАК Сумма\r\n\t|ПОМЕСТИТЬ ВТЗатратыНаСубподряд\r\n\t|ИЗ\r\n\t|\tДокумент.ЗаказПоставщику.Запасы КАК ЗаказПоставщикуЗапасы\r\n\t|\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК Заказ_Поставщику\r\n\t|\t\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК Заказ_Покупателя\r\n\t|\t\t\tПО Заказ_Поставщику.ЗаказПокупателя = Заказ_Покупателя.Ссылка\r\n\t|\t\tПО ЗаказПоставщикуЗапасы.Ссылка = Заказ_Поставщику.Ссылка\r\n\t|ГДЕ\r\n\t|\tЗаказ_Покупателя.Дата > ДОБАВИТЬКДАТЕ(&ДатаНачала, ГОД, -1) И  Заказ_Покупателя.Контрагент НЕ В (&КонтрагентыБезСубподряда)\r\n\t|\r\n\t|СГРУППИРОВАТЬ ПО\r\n\t|\tЗаказ_Поставщику.ЗаказПокупателя\r\n\t|;\r\n\t|\r\n\t|////////////////////////////////////////////////////////////////////////////////\r\n\t|ВЫБРАТЬ\r\n\t|\tПродажиОбороты.Характеристика КАК Характеристика,\r\n\t|\tПродажиОбороты.Номенклатура КАК Номенклатура,\r\n\t|\tПродажиОбороты.Количество КАК Количество,\r\n\t|\tПродажиОбороты.Выручка КАК Выручка,\r\n\t|\tПродажиОбороты.Контрагент КАК Контрагент,\r\n\t|\tПродажиОбороты.Ответственный КАК Ответственный,\r\n\t|\tПродажиОбороты.Период КАК Период,\r\n\t|\tПродажиОбороты.ЗаказПокупателя КАК ЗаказПокупателя,\r\n\t|\tЦеныНоменклатуры.Цена КАК Цена,\r\n\t|\tisnull(ЦеныНоменклатуры.Цена,0) * ПродажиОбороты.Количество КАК Себестоимость,\r\n\t|\tisnull(ВТЗатратыНаСубподряд.Сумма,0) КАК Субподряд\r\n\t|ИЗ\r\n\t|\tвтМаксПериод КАК ПродажиОбороты\r\n\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ втЦеныПоНоменклатуре КАК ЦеныНоменклатуры\r\n\t|\t\tПО (ЦеныНоменклатуры.Номенклатура = ПродажиОбороты.Номенклатура)\r\n\t|\t\t\tИ (ЦеныНоменклатуры.Период = ПродажиОбороты.ДатаЦены)\r\n\t|\t\t\tИ ПродажиОбороты.Характеристика = ЦеныНоменклатуры.Характеристика\r\n\t|\t\tЛЕВОЕ СОЕДИНЕНИЕ ВТЗатратыНаСубподряд КАК ВТЗатратыНаСубподряд\r\n\t|\t\tПО ПродажиОбороты.ЗаказПокупателя = ВТЗатратыНаСубподряд.ЗаказПокупателя\r\n\t|\r\n\t|СГРУППИРОВАТЬ ПО\r\n\t|\tПродажиОбороты.Ответственный,\r\n\t|\tПродажиОбороты.Характеристика,\r\n\t|\tПродажиОбороты.Контрагент,\r\n\t|\tПродажиОбороты.ЗаказПокупателя,\r\n\t|\tПродажиОбороты.Номенклатура,\r\n\t|\tПродажиОбороты.Количество,\r\n\t|\tПродажиОбороты.Период,\r\n\t|\tПродажиОбороты.Выручка,\r\n\t|\tЦеныНоменклатуры.Цена,\r\n\t|\tПродажиОбороты.ДатаЦены,\r\n\t|\tЦеныНоменклатуры.Цена * ПродажиОбороты.Количество,\r\n\t|\tВТЗатратыНаСубподряд.Сумма\r\n\t|ИТОГИ\r\n\t|\tСУММА(Количество),\r\n\t|\tСУММА(Выручка),\r\n\t|\tСУММА(Себестоимость),\r\n\t|\tМАКСИМУМ(Субподряд)\r\n\t|ПО\r\n\t|\tОтветственный,\r\n\t|\tКонтрагент,\r\n\t|\tЗаказПокупателя,\r\n\t|\tНоменклатура\";\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Программное получение СочетаниеКлавиш",
    "description": "Программное получение СочетаниеКлавиш",
    "code_snippet": "// Возвращает сочетание клавиш из скан-кода\r\n//\r\n// Параметры:\r\n//  Код - Строка - скан-код клавиши\r\n//  Alt - Число - факт нажатия клавиши alt\r\n//  Control - Число - факт нажатия клавиши Control\r\n//  Shift - Число - факт нажатия клавиши Shift\r\n//\r\n// Возвращаемое значение:\r\n//   СочетаниеКлавиш - программное сочетание клавиш\r\n//\r\nФункция ПолучитьСочетаниеКлавишПоКоду(Код, Alt = 0, Control = 0, Shift = 0) Экспорт\r\n    Возврат ЗначениеИзСтрокиВнутр(\"{\"\"#\"\", 69cf4251-8759-11d5-bf7e-0050bae2bc79, 1,\r\n        |{0, \" + Формат(Код, \"ЧН=0; ЧГ=0\") + \", \" + Формат(Alt * 16 + Control * 8 + Shift * 4, \"ЧН=0; ЧГ=0\") + \"}\r\n        |}\");\r\nКонецФункции\r\n\r\n// https://filestore.community.support.microsoft.com/api/images/924f1958-8fe8-41a8-b34b-6018c6283a05 - скан-коды клавиатуры\n\n// Возвращает сочетание клавиш из скан-кода\r\n//\r\n// Параметры:\r\n//  Код - Строка - скан-код клавиши\r\n//  Alt - Число - факт нажатия клавиши alt\r\n//  Control - Число - факт нажатия клавиши Control\r\n//  Shift - Число - факт нажатия клавиши Shift\r\n//\r\n// Возвращаемое значение:\r\n//   СочетаниеКлавиш - программное сочетание клавиш\r\n//\r\nФункция ПолучитьСочетаниеКлавишПоКоду(Код, Alt = 0, Control = 0, Shift = 0) Экспорт\r\n    Возврат ЗначениеИзСтрокиВнутр(\"{\"\"#\"\", 69cf4251-8759-11d5-bf7e-0050bae2bc79, 1,\r\n        |{0, \" + Формат(Код, \"ЧН=0; ЧГ=0\") + \", \" + Формат(Alt * 16 + Control * 8 + Shift * 4, \"ЧН=0; ЧГ=0\") + \"}\r\n        |}\");\r\nКонецФункции\r\n\r\n// https://filestore.community.support.microsoft.com/api/images/924f1958-8fe8-41a8-b34b-6018c6283a05 - скан-коды клавиатуры"
  },
  {
    "title": "Установить отбор пользовательских настроек динамического списка",
    "description": "Установить отбор пользовательских настроек динамического списка",
    "code_snippet": "//Если есть БСП\r\nмФорма = ОткрытьФорму(\"Справочник.Номенклатура.ФормаСписка\");\r\n\t\r\nОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбораДинамическогоСписка(мФорма.Список, \"ПометкаУдаления\", Истина, ВидСравненияКомпоновкиДанных.Равно, , Истина, РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Обычный, Новый УникальныйИдентификатор);\r\n\r\n//Если нет БСП то используем велосипед\r\n//Вызывающий код\r\nмФорма = ОткрытьФорму(\"Справочник.Номенклатура.ФормаСписка\");\r\nУстановитьПользовательскийОтборДинамическогоСписка(мФорма.Список, \"ПометкаУдаления\", Ложь, ВидСравненияКомпоновкиДанных.Равно);\r\n\t\t\r\n\r\n&НаКлиенте\r\nПроцедура УстановитьПользовательскийОтборДинамическогоСписка(Список, ИмяПоля, Значение, ВидСравнения);\r\n\t\r\n\tДля Каждого ЭлементОтбора Из Список.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(ЭлементОтбора) = Тип(\"ОтборКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tПользовательскийОтбор = ЭлементОтбора.Элементы;\r\n\t\t\t\r\n\t\t\tНовыйЭлементОтбора = Неопределено;\r\n\t\t\t\r\n\t\t\tДля Каждого СуществующийЭлементОтбора Из ПользовательскийОтбор Цикл\r\n\t\t\t\t\r\n\t\t\t\tЕсли СуществующийЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(ИмяПоля) Тогда\r\n\t\t\t\t\t\r\n\t\t\t\t\tНовыйЭлементОтбора = СуществующийЭлементОтбора;\r\n\t\t\t\t\t\r\n\t\t\t\t\t Прервать;\r\n\t\t\t\t\t\r\n\t\t\t\tКонецЕсли;\t\r\n\t\t\t\t\t\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tЕсли СуществующийЭлементОтбора = Неопределено Тогда\r\n\t\t\t\t\r\n\t\t\t\tНовыйЭлементОтбора = ПользовательскийОтбор.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n\t\t\t\t\r\n\t\t\t\tНовыйЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(ИмяПоля);\r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\r\n\t\t\tНовыйЭлементОтбора.ВидСравнения = ВидСравнения;\r\n\t\t\tНовыйЭлементОтбора.Использование = Истина;\r\n\t\t\tНовыйЭлементОтбора.РежимОтображения = РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Обычный;\r\n\t\t\tНовыйЭлементОтбора.ПравоеЗначение = Значение;\t\t\t\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры;\n\n//Если есть БСП\r\nмФорма = ОткрытьФорму(\"Справочник.Номенклатура.ФормаСписка\");\r\n\t\r\nОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбораДинамическогоСписка(мФорма.Список, \"ПометкаУдаления\", Истина, ВидСравненияКомпоновкиДанных.Равно, , Истина, РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Обычный, Новый УникальныйИдентификатор);\r\n\r\n//Если нет БСП то используем велосипед\r\n//Вызывающий код\r\nмФорма = ОткрытьФорму(\"Справочник.Номенклатура.ФормаСписка\");\r\nУстановитьПользовательскийОтборДинамическогоСписка(мФорма.Список, \"ПометкаУдаления\", Ложь, ВидСравненияКомпоновкиДанных.Равно);\r\n\t\t\r\n\r\n&НаКлиенте\r\nПроцедура УстановитьПользовательскийОтборДинамическогоСписка(Список, ИмяПоля, Значение, ВидСравнения);\r\n\t\r\n\tДля Каждого ЭлементОтбора Из Список.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(ЭлементОтбора) = Тип(\"ОтборКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tПользовательскийОтбор = ЭлементОтбора.Элементы;\r\n\t\t\t\r\n\t\t\tНовыйЭлементОтбора = Неопределено;\r\n\t\t\t\r\n\t\t\tДля Каждого СуществующийЭлементОтбора Из ПользовательскийОтбор Цикл\r\n\t\t\t\t\r\n\t\t\t\tЕсли СуществующийЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(ИмяПоля) Тогда\r\n\t\t\t\t\t\r\n\t\t\t\t\tНовыйЭлементОтбора = СуществующийЭлементОтбора;\r\n\t\t\t\t\t\r\n\t\t\t\t\t Прервать;\r\n\t\t\t\t\t\r\n\t\t\t\tКонецЕсли;\t\r\n\t\t\t\t\t\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tЕсли СуществующийЭлементОтбора = Неопределено Тогда\r\n\t\t\t\t\r\n\t\t\t\tНовыйЭлементОтбора = ПользовательскийОтбор.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n\t\t\t\t\r\n\t\t\t\tНовыйЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(ИмяПоля);\r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\r\n\t\t\tНовыйЭлементОтбора.ВидСравнения = ВидСравнения;\r\n\t\t\tНовыйЭлементОтбора.Использование = Истина;\r\n\t\t\tНовыйЭлементОтбора.РежимОтображения = РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Обычный;\r\n\t\t\tНовыйЭлементОтбора.ПравоеЗначение = Значение;\t\t\t\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры;\n\n{9} Ожидается идентификатор"
  },
  {
    "title": "Отслеживание изменений отбора",
    "description": "Отслеживание изменений отбора",
    "code_snippet": "//Подключаем обработчик изменения на отбор в данном случае у регистра сведений список при открытии- \r\nПроцедура ПриОткрытии()\r\n    ПодключитьОбработчикИзмененияДанных(\"РегистрСведенийСписок.Отбор\", \"ОбработкаОтбора\",Истина);\r\n\t\r\n\tОбработкаОтбора(Неопределено);\r\nКонецПроцедуры\r\n\r\nПроцедура ОбработкаОтбора(Элемент)\r\n\t\r\n    // Элемент - то что изменилось в Отборе - например Период.ВидСравнения\r\n    // тут можно обработать изменения отбора \r\n\t\t\r\nКонецПроцедуры\n\n//Подключаем обработчик изменения на отбор в данном случае у регистра сведений список при открытии- \r\nПроцедура ПриОткрытии()\r\n    ПодключитьОбработчикИзмененияДанных(\"РегистрСведенийСписок.Отбор\", \"ОбработкаОтбора\",Истина);\r\n\t\r\n\tОбработкаОтбора(Неопределено);\r\nКонецПроцедуры\r\n\r\nПроцедура ОбработкаОтбора(Элемент)\r\n\t\r\n    // Элемент - то что изменилось в Отборе - например Период.ВидСравнения\r\n    // тут можно обработать изменения отбора \r\n\t\t\r\nКонецПроцедуры"
  },
  {
    "title": "Элемент справочника",
    "description": "Элемент справочника",
    "code_snippet": "// Функция - Элемент справочника ищет/создаёт элемент справочника\r\n//\r\n// Параметры:\r\n//  НазваниеСправочника      - Строка - Название справочника элемент которого необходимо вернуть\r\n//  СтруктураПараметров      - Структура - Ключ = Название реквизиты, Значение = Значение\r\n//  Режим - Число                 - Варианты:\r\n//                                        1 - ищет и возвращает ссылку;\r\n//                                        2 - ищет и возвращает ссылку, если не находит создаёт новый элемент и возвращает ссылку на него\r\n//                                        3 - создаёт новый элемент и возвращает ссылку на него\r\n//\r\n// Возвращаемое значение:\r\n//  СправочникСсылка\r\n//\r\nФункция ЭлементСправочника(НазваниеСправочника, СтруктураПараметров, Режим = 2) Экспорт\r\n    \r\n    Результат = Неопределено;\r\n    \r\n    Искать = (Режим = 1 или Режим = 2);\r\n    \r\n    Если Искать тогда\r\n        Запрос = Новый Запрос;\r\n        ТекстУсловий = \"\";\r\n        Для Каждого ЭлементСтруктуры из СтруктураПараметров Цикл\r\n            Запрос.Параметры.Вставить(ЭлементСтруктуры.Ключ, ЭлементСтруктуры.Значение);\r\n            ОбъектМетаданных = Метаданные.Справочники[НазваниеСправочника].Реквизиты.Найти(ЭлементСтруктуры.Ключ);\r\n            Если ОбъектМетаданных = Неопределено Тогда\r\n                ОбъектМетаданных = Метаданные.Справочники[НазваниеСправочника].СтандартныеРеквизиты[ЭлементСтруктуры.Ключ];\r\n            КонецЕсли;\r\n            Тип = ОбъектМетаданных.Тип;\r\n            //Новый ОписаниеТипов(\r\n            Если Тип = Новый ОписаниеТипов(\"Строка\") Тогда\r\n                //и Тип.КвалификаторыСтроки.Длина = 0 Тогда\r\n                ТекстУсловий = ТекстУсловий + \"ВЫРАЗИТЬ(\" + НазваниеСправочника + \".\" + ЭлементСтруктуры.Ключ\r\n                + \" КАК СТРОКА(1000)) = ВЫРАЗИТЬ(&\" + ЭлементСтруктуры.Ключ + \" КАК СТРОКА(1000)) И \";\r\n            Иначе\r\n                \r\n                ТекстУсловий = ТекстУсловий + НазваниеСправочника + \".\" + ЭлементСтруктуры.Ключ + \" = &\" + ЭлементСтруктуры.Ключ + \" И \";\r\n                \r\n            КонецЕсли;\r\n        КонецЦикла;\r\n        ТекстУсловий = ТекстУсловий + \"ИСТИНА = ИСТИНА\";\r\n        Запрос.Текст = \"ВЫБРАТЬ \" + НазваниеСправочника + \".Ссылка ИЗ Справочник.\" + НазваниеСправочника  + \" КАК \" + НазваниеСправочника + \" ГДЕ \" + ТекстУсловий;\r\n        \r\n        ТЗ_РезультатЗапроса = Запрос.Выполнить().Выгрузить();\r\n        \r\n        Если ТЗ_РезультатЗапроса.Количество() = 1 Тогда\r\n            Результат = ТЗ_РезультатЗапроса[0].Ссылка;\r\n        ИначеЕсли ТЗ_РезультатЗапроса.Количество() > 1 Тогда\r\n            Сообщить(\"Найдено более одного элемента:\");\r\n            Сообщить(ТЗ_РезультатЗапроса[0].Ссылка);\r\n            Результат = ТЗ_РезультатЗапроса[0].Ссылка;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    \r\n    Создавать = (Режим = 3 или (Режим = 2 и не ЗначениеЗаполнено(Результат)));\r\n    \r\n    Если Создавать Тогда\r\n        Если СтруктураПараметров.Свойство(\"ЭтоГруппа\") и СтруктураПараметров.ЭтоГруппа Тогда\r\n            НовыйЭлемент = Справочники[НазваниеСправочника].СоздатьГруппу();\r\n        Иначе\r\n            НовыйЭлемент = Справочники[НазваниеСправочника].СоздатьЭлемент();\r\n        КонецЕсли;\r\n        \r\n        ЗаполнитьЗначенияСвойств(НовыйЭлемент, СтруктураПараметров);\r\n        НовыйЭлемент.Записать();\r\n        Результат = НовыйЭлемент.Ссылка;\r\n    КонецЕсли;\r\n    \r\n    Возврат Результат;\r\n    \r\nКонецФункции\n\n// Функция - Элемент справочника ищет/создаёт элемент справочника\r\n//\r\n// Параметры:\r\n//  НазваниеСправочника      - Строка - Название справочника элемент которого необходимо вернуть\r\n//  СтруктураПараметров      - Структура - Ключ = Название реквизиты, Значение = Значение\r\n//  Режим - Число                 - Варианты:\r\n//                                        1 - ищет и возвращает ссылку;\r\n//                                        2 - ищет и возвращает ссылку, если не находит создаёт новый элемент и возвращает ссылку на него\r\n//                                        3 - создаёт новый элемент и возвращает ссылку на него\r\n//\r\n// Возвращаемое значение:\r\n//  СправочникСсылка\r\n//\r\nФункция ЭлементСправочника(НазваниеСправочника, СтруктураПараметров, Режим = 2) Экспорт\r\n    \r\n    Результат = Неопределено;\r\n    \r\n    Искать = (Режим = 1 или Режим = 2);\r\n    \r\n    Если Искать тогда\r\n        Запрос = Новый Запрос;\r\n        ТекстУсловий = \"\";\r\n        Для Каждого ЭлементСтруктуры из СтруктураПараметров Цикл\r\n            Запрос.Параметры.Вставить(ЭлементСтруктуры.Ключ, ЭлементСтруктуры.Значение);\r\n            ОбъектМетаданных = Метаданные.Справочники[НазваниеСправочника].Реквизиты.Найти(ЭлементСтруктуры.Ключ);\r\n            Если ОбъектМетаданных = Неопределено Тогда\r\n                ОбъектМетаданных = Метаданные.Справочники[НазваниеСправочника].СтандартныеРеквизиты[ЭлементСтруктуры.Ключ];\r\n            КонецЕсли;\r\n            Тип = ОбъектМетаданных.Тип;\r\n            //Новый ОписаниеТипов(\r\n            Если Тип = Новый ОписаниеТипов(\"Строка\") Тогда\r\n                //и Тип.КвалификаторыСтроки.Длина = 0 Тогда\r\n                ТекстУсловий = ТекстУсловий + \"ВЫРАЗИТЬ(\" + НазваниеСправочника + \".\" + ЭлементСтруктуры.Ключ\r\n                + \" КАК СТРОКА(1000)) = ВЫРАЗИТЬ(&\" + ЭлементСтруктуры.Ключ + \" КАК СТРОКА(1000)) И \";\r\n            Иначе\r\n                \r\n                ТекстУсловий = ТекстУсловий + НазваниеСправочника + \".\" + ЭлементСтруктуры.Ключ + \" = &\" + ЭлементСтруктуры.Ключ + \" И \";\r\n                \r\n            КонецЕсли;\r\n        КонецЦикла;\r\n        ТекстУсловий = ТекстУсловий + \"ИСТИНА = ИСТИНА\";\r\n        Запрос.Текст = \"ВЫБРАТЬ \" + НазваниеСправочника + \".Ссылка ИЗ Справочник.\" + НазваниеСправочника  + \" КАК \" + НазваниеСправочника + \" ГДЕ \" + ТекстУсловий;\r\n        \r\n        ТЗ_РезультатЗапроса = Запрос.Выполнить().Выгрузить();\r\n        \r\n        Если ТЗ_РезультатЗапроса.Количество() = 1 Тогда\r\n            Результат = ТЗ_РезультатЗапроса[0].Ссылка;\r\n        ИначеЕсли ТЗ_РезультатЗапроса.Количество() > 1 Тогда\r\n            Сообщить(\"Найдено более одного элемента:\");\r\n            Сообщить(ТЗ_РезультатЗапроса[0].Ссылка);\r\n            Результат = ТЗ_РезультатЗапроса[0].Ссылка;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    \r\n    Создавать = (Режим = 3 или (Режим = 2 и не ЗначениеЗаполнено(Результат)));\r\n    \r\n    Если Создавать Тогда\r\n        Если СтруктураПараметров.Свойство(\"ЭтоГруппа\") и СтруктураПараметров.ЭтоГруппа Тогда\r\n            НовыйЭлемент = Справочники[НазваниеСправочника].СоздатьГруппу();\r\n        Иначе\r\n            НовыйЭлемент = Справочники[НазваниеСправочника].СоздатьЭлемент();\r\n        КонецЕсли;\r\n        \r\n        ЗаполнитьЗначенияСвойств(НовыйЭлемент, СтруктураПараметров);\r\n        НовыйЭлемент.Записать();\r\n        Результат = НовыйЭлемент.Ссылка;\r\n    КонецЕсли;\r\n    \r\n    Возврат Результат;\r\n    \r\nКонецФункции"
  },
  {
    "title": "Путь к файлу",
    "description": "Путь к файлу",
    "code_snippet": "// Функция - Путь к файлу\r\n// 20200904 Версия свежее в комментариях\r\n//\r\n// Параметры:\r\n//  Заголовок     - Строка - НПР: \"Укажите путь к базе Поставщиков\"\r\n//  Фильтр         - Строка -    НПР: \"(*.txt)|*.txt\"\r\n//  Режим         - РежимДиалогаВыбораФайла - НПР: РежимДиалогаВыбораФайла.Открытие\r\n//  ИсходныйПуть - Строка - НПР: Путь чтобы выбор начинался в определённом месте\r\n//\r\n// Возвращаемое значение:\r\n//  Строка, Неопределено -  В случае успеха Путь в виде Строки, иначе Неопределено\r\n//\r\n// Пример:\r\n//  Элемент.Значение = ПутьКФайлу(\"Выберите путь к файлу с данными (xls):\",\"(*.xls*)|*.xls*\", РежимДиалогаВыбораФайла.Открытие, Элемент.Значение)\r\nФункция ПутьКФайлу(Заголовок, Фильтр, Режим, ИсходныйПуть = Неопределено) Экспорт\r\n    Результат = Неопределено;\r\n    ДиалогОткрытияФайла  = Новый ДиалогВыбораФайла (Режим);\r\n    //выбор начнётся по исходному пути?!\r\n    Если ИсходныйПуть <> Неопределено Тогда\r\n        Если Режим =  РежимДиалогаВыбораФайла.ВыборКаталога Тогда\r\n            ДиалогОткрытияФайла.Каталог = ИсходныйПуть;\r\n        ИначеЕсли  Режим = ДиалогОткрытияФайла.ПолноеИмяФайла  Тогда\r\n            ДиалогОткрытияФайла.ПолноеИмяФайла = ИсходныйПуть;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    ДиалогОткрытияФайла.ПолноеИмяФайла     = \"\";\r\n    ДиалогОткрытияФайла.МножественныйВыбор = Ложь;\r\n    ДиалогОткрытияФайла.Заголовок          = Заголовок;\r\n    ДиалогОткрытияФайла.Фильтр = Фильтр;\r\n    Успех = ДиалогОткрытияФайла.Выбрать();\r\n    Если Успех Тогда\r\n        Если Режим = РежимДиалогаВыбораФайла.ВыборКаталога Тогда\r\n            Результат = ДиалогОткрытияФайла.Каталог;\r\n        Иначе\r\n            Результат = ДиалогОткрытияФайла.ПолноеИмяФайла;\r\n        КонецЕсли;\r\n    Иначе\r\n        Результат = Неопределено;\r\n    КонецЕсли;\r\n    Возврат Результат;\r\nКонецФункции\n\n// Функция - Путь к файлу\r\n// 20200904 Версия свежее в комментариях\r\n//\r\n// Параметры:\r\n//  Заголовок     - Строка - НПР: \"Укажите путь к базе Поставщиков\"\r\n//  Фильтр         - Строка -    НПР: \"(*.txt)|*.txt\"\r\n//  Режим         - РежимДиалогаВыбораФайла - НПР: РежимДиалогаВыбораФайла.Открытие\r\n//  ИсходныйПуть - Строка - НПР: Путь чтобы выбор начинался в определённом месте\r\n//\r\n// Возвращаемое значение:\r\n//  Строка, Неопределено -  В случае успеха Путь в виде Строки, иначе Неопределено\r\n//\r\n// Пример:\r\n//  Элемент.Значение = ПутьКФайлу(\"Выберите путь к файлу с данными (xls):\",\"(*.xls*)|*.xls*\", РежимДиалогаВыбораФайла.Открытие, Элемент.Значение)\r\nФункция ПутьКФайлу(Заголовок, Фильтр, Режим, ИсходныйПуть = Неопределено) Экспорт\r\n    Результат = Неопределено;\r\n    ДиалогОткрытияФайла  = Новый ДиалогВыбораФайла (Режим);\r\n    //выбор начнётся по исходному пути?!\r\n    Если ИсходныйПуть <> Неопределено Тогда\r\n        Если Режим =  РежимДиалогаВыбораФайла.ВыборКаталога Тогда\r\n            ДиалогОткрытияФайла.Каталог = ИсходныйПуть;\r\n        ИначеЕсли  Режим = ДиалогОткрытияФайла.ПолноеИмяФайла  Тогда\r\n            ДиалогОткрытияФайла.ПолноеИмяФайла = ИсходныйПуть;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n    ДиалогОткрытияФайла.ПолноеИмяФайла     = \"\";\r\n    ДиалогОткрытияФайла.МножественныйВыбор = Ложь;\r\n    ДиалогОткрытияФайла.Заголовок          = Заголовок;\r\n    ДиалогОткрытияФайла.Фильтр = Фильтр;\r\n    Успех = ДиалогОткрытияФайла.Выбрать();\r\n    Если Успех Тогда\r\n        Если Режим = РежимДиалогаВыбораФайла.ВыборКаталога Тогда\r\n            Результат = ДиалогОткрытияФайла.Каталог;\r\n        Иначе\r\n            Результат = ДиалогОткрытияФайла.ПолноеИмяФайла;\r\n        КонецЕсли;\r\n    Иначе\r\n        Результат = Неопределено;\r\n    КонецЕсли;\r\n    Возврат Результат;\r\nКонецФункции\n\n// Функция - открывает диалог выбора пути, возвращает результат выбора.\n//\n// Параметры:\n//  Заголовок     - Строка - НПР: \"Укажите путь к базе Поставщиков\"\n//  Фильтр         - Строка -    НПР: \"(*.txt)|*.txt\"\n//  Режим         - РежимДиалогаВыбораФайла - НПР: РежимДиалогаВыбораФайла.Открытие\n//  ИсходныйПуть - Строка - НПР: Путь чтобы выбор начинался в определённом месте\n//\n// Возвращаемое значение:\n//  Строка, Неопределено -  В случае успеха Путь в виде Строки, иначе Неопределено\n//\n// Пример:\n//  Элемент.Значение = Путь(\"Выберите путь к файлу с данными (xls):\",\"(*.xls*)|*.xls*\", РежимДиалогаВыбораФайла.Открытие, Элемент.Значение)\nФункция Путь(Заголовок, Фильтр, Режим, ИсходныйПуть = Неопределено) Экспорт\n    Результат = Неопределено;\n    ДиалогОткрытияФайла  = Новый ДиалогВыбораФайла (Режим);\n    //выбор начнётся по исходному пути?!\n    Если ИсходныйПуть <> Неопределено Тогда\n        Если Режим =  РежимДиалогаВыбораФайла.ВыборКаталога Тогда\n            ДиалогОткрытияФайла.Каталог = ИсходныйПуть;\n        ИначеЕсли  Режим = ДиалогОткрытияФайла.ПолноеИмяФайла  Тогда\n            ДиалогОткрытияФайла.ПолноеИмяФайла = ИсходныйПуть;\n        КонецЕсли;\n    КонецЕсли;\n    ДиалогОткрытияФайла.ПолноеИмяФайла     = \"\";\n    ДиалогОткрытияФайла.МножественныйВыбор = Ложь;\n    ДиалогОткрытияФайла.Заголовок          = Заголовок;\n    ДиалогОткрытияФайла.Фильтр = Фильтр;\n    Успех = ДиалогОткрытияФайла.Выбрать();\n    Если Успех Тогда\n        Если Режим = РежимДиалогаВыбораФайла.ВыборКаталога Тогда\n            Результат = ДиалогОткрытияФайла.Каталог;\n        Иначе\n            Результат = ДиалогОткрытияФайла.ПолноеИмяФайла;\n        КонецЕсли;\n    Иначе\n        Результат = Неопределено;\n    КонецЕсли;\n    Возврат Результат;\nКонецФункции"
  },
  {
    "title": "Загрузить колонку (создавать строки Таблицы при необходимости)",
    "description": "Загрузить колонку (создавать строки Таблицы при необходимости)",
    "code_snippet": "// Процедура - Загрузить колонку\r\n//\r\n// Параметры:\r\n//  Таблица             - ТаблицаЗначений, ТабличнаяЧасть\r\n//  МассивЗначений     - Массив\r\n//  Колонка             - Строка\r\n//  Очищать             - Булево - Необязательно. По-умолчанию Истина.\r\n//                                Если Истина, то таблица предварительно очищается.\r\n//                                \r\nПроцедура ЗагрузитьКолонку(Таблица, МассивЗначений, Колонка, Очищать = Истина) Экспорт\r\n    Если Очищать Тогда\r\n        Таблица.Очистить();\r\n    КонецЕсли;\r\n\r\n\r\n    МаксимальныйИндексТаблицы = Таблица.Количество() - 1;\r\n    МаксимальныйИндексМассива = МассивЗначений.Количество() - 1;\r\n    \r\n    Для ИндексМассива = 0 по МаксимальныйИндексМассива Цикл\r\n        Если ИндексМассива > МаксимальныйИндексТаблицы Тогда\r\n            Строка = Таблица.Добавить();\r\n        Иначе\r\n            Строка = Таблица[ИндексМассива];\r\n        КонецЕсли;\r\n        Строка[Колонка] = МассивЗначений[ИндексМассива];\r\n    КонецЦикла;\r\n    \r\nКонецПроцедуры\n\n// Процедура - Загрузить колонку\r\n//\r\n// Параметры:\r\n//  Таблица             - ТаблицаЗначений, ТабличнаяЧасть\r\n//  МассивЗначений     - Массив\r\n//  Колонка             - Строка\r\n//  Очищать             - Булево - Необязательно. По-умолчанию Истина.\r\n//                                Если Истина, то таблица предварительно очищается.\r\n//                                \r\nПроцедура ЗагрузитьКолонку(Таблица, МассивЗначений, Колонка, Очищать = Истина) Экспорт\r\n    Если Очищать Тогда\r\n        Таблица.Очистить();\r\n    КонецЕсли;\r\n\r\n\r\n    МаксимальныйИндексТаблицы = Таблица.Количество() - 1;\r\n    МаксимальныйИндексМассива = МассивЗначений.Количество() - 1;\r\n    \r\n    Для ИндексМассива = 0 по МаксимальныйИндексМассива Цикл\r\n        Если ИндексМассива > МаксимальныйИндексТаблицы Тогда\r\n            Строка = Таблица.Добавить();\r\n        Иначе\r\n            Строка = Таблица[ИндексМассива];\r\n        КонецЕсли;\r\n        Строка[Колонка] = МассивЗначений[ИндексМассива];\r\n    КонецЦикла;\r\n    \r\nКонецПроцедуры"
  },
  {
    "title": "Оформление (раскраска) строки табличной части обычной формы по условию, при получении данных",
    "description": "Оформление (раскраска) строки табличной части обычной формы по условию, при получении данных",
    "code_snippet": "Процедура ТоварыПриПолученииДанных(Элемент, ОформленияСтрок)\r\n\t\t\r\n\tДля Каждого ОформлениеСтроки Из ОформленияСтрок Цикл\r\n\t\t\t\r\n\t\tЕсли ОформлениеСтроки.ДанныеСтроки.Товар.Уценен Тогда\r\n\t\t\tОформлениеСтроки.Ячейки.Комментарий.УстановитьТекст(\"Уценка\");\r\n\t\t\tОформлениеСтроки.Ячейки.Комментарий.ЦветФона = Новый Цвет(255, 255, 128);\r\n\t\t\tОформлениеСтроки.Ячейки.Комментарий.ЦветТекста = Новый Цвет(0, 0, 0);\r\n\t\t\tОформлениеСтроки.Ячейки.Комментарий.ТолькоПросмотр = Истина;\r\n\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t//ОформлениеСтроки.ЦветФона = Новый Цвет(255, 255, 128);\r\n\t\t//ОформлениеСтроки.ЦветТекста = Новый Цвет(0, 0, 0);\r\n\t\t\t\t\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\nПроцедура ТоварыПриПолученииДанных(Элемент, ОформленияСтрок)\r\n\t\t\r\n\tДля Каждого ОформлениеСтроки Из ОформленияСтрок Цикл\r\n\t\t\t\r\n\t\tЕсли ОформлениеСтроки.ДанныеСтроки.Товар.Уценен Тогда\r\n\t\t\tОформлениеСтроки.Ячейки.Комментарий.УстановитьТекст(\"Уценка\");\r\n\t\t\tОформлениеСтроки.Ячейки.Комментарий.ЦветФона = Новый Цвет(255, 255, 128);\r\n\t\t\tОформлениеСтроки.Ячейки.Комментарий.ЦветТекста = Новый Цвет(0, 0, 0);\r\n\t\t\tОформлениеСтроки.Ячейки.Комментарий.ТолькоПросмотр = Истина;\r\n\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t//ОформлениеСтроки.ЦветФона = Новый Цвет(255, 255, 128);\r\n\t\t//ОформлениеСтроки.ЦветТекста = Новый Цвет(0, 0, 0);\r\n\t\t\t\t\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "УТ11 Счет на оплату из реализации",
    "description": "Печать из реализации, без типовых ограничений, номер и дата из документа реализации",
    "code_snippet": ""
  },
  {
    "title": "МассивБезДублей",
    "description": "МассивБезДублей",
    "code_snippet": "Функция МассивБезДублей(ИсходныйМассив) Экспорт\r\n\r\n\tРезультат = Новый Массив;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ИсходныйМассив) Тогда\r\n\t\tВремТаб = Новый ТаблицаЗначений;\r\n\t\tВремТаб.Колонки.Добавить(\"Данные\");\r\n\t\tДля Сч = 1 По ИсходныйМассив.Количество() Цикл\r\n\t\t\tВремТаб.Добавить();\r\n\t\tКонецЦикла;\r\n\t\tВремТаб.ЗагрузитьКолонку(ИсходныйМассив, 0);\r\n\t\tВремТаб.Свернуть(ВремТаб.Колонки[0].Имя);\r\n\t\tРезультат = ВремТаб.ВыгрузитьКолонку(0);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\t\r\n\r\nКонецФункции // МассивБезДублей()\n\nФункция МассивБезДублей(ИсходныйМассив) Экспорт\r\n\r\n\tРезультат = Новый Массив;\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ИсходныйМассив) Тогда\r\n\t\tВремТаб = Новый ТаблицаЗначений;\r\n\t\tВремТаб.Колонки.Добавить(\"Данные\");\r\n\t\tДля Сч = 1 По ИсходныйМассив.Количество() Цикл\r\n\t\t\tВремТаб.Добавить();\r\n\t\tКонецЦикла;\r\n\t\tВремТаб.ЗагрузитьКолонку(ИсходныйМассив, 0);\r\n\t\tВремТаб.Свернуть(ВремТаб.Колонки[0].Имя);\r\n\t\tРезультат = ВремТаб.ВыгрузитьКолонку(0);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\t\r\n\r\nКонецФункции // МассивБезДублей()\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "МассивВТаблицуЗначений",
    "description": "МассивВТаблицуЗначений",
    "code_snippet": "Функция МассивВТаблицуЗначений(ИсходныйМассив, Знач ИмяКолонки=\"\") Экспорт\r\n\t\r\n\tЕсли ПустаяСтрока(ИмяКолонки) Тогда\r\n\t\tИмяКолонки = \"Колонка1\";\r\n\tКонецЕсли;\r\n\t\r\n\tИмяКолонки = СтрЗаменить(ИмяКолонки, \" \", \"_\");\r\n\t\r\n\tРезультат = Новый ТаблицаЗначений;\r\n\tРезультат.Колонки.Добавить(ИмяКолонки);\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ИсходныйМассив) Тогда\r\n\t\tДля Сч = 1 По ИсходныйМассив.Количество() Цикл\r\n\t\t\tРезультат.Добавить();\r\n\t\tКонецЦикла;\r\n\t\tРезультат.ЗагрузитьКолонку(ИсходныйМассив, ИмяКолонки);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\t\r\n\r\nКонецФункции // МассивВТаблицуЗначений()\n\nФункция МассивВТаблицуЗначений(ИсходныйМассив, Знач ИмяКолонки=\"\") Экспорт\r\n\t\r\n\tЕсли ПустаяСтрока(ИмяКолонки) Тогда\r\n\t\tИмяКолонки = \"Колонка1\";\r\n\tКонецЕсли;\r\n\t\r\n\tИмяКолонки = СтрЗаменить(ИмяКолонки, \" \", \"_\");\r\n\t\r\n\tРезультат = Новый ТаблицаЗначений;\r\n\tРезультат.Колонки.Добавить(ИмяКолонки);\r\n\t\r\n\tЕсли ЗначениеЗаполнено(ИсходныйМассив) Тогда\r\n\t\tДля Сч = 1 По ИсходныйМассив.Количество() Цикл\r\n\t\t\tРезультат.Добавить();\r\n\t\tКонецЦикла;\r\n\t\tРезультат.ЗагрузитьКолонку(ИсходныйМассив, ИмяКолонки);\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат Результат;\t\r\n\r\nКонецФункции // МассивВТаблицуЗначений()\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "Печать из \"вне\" ссылки в файл",
    "description": "Печать из \"вне\" ссылки в файл",
    "code_snippet": "ФорматыПечати = Новый Массив;\r\nФорматыПечати.Добавить(ТипФайлаТабличногоДокумента.DOCX);\r\nКомандыПечати = УправлениеПечатью.КомандыПечатиФормы(\"Документ.Отпуск.Форма.ФормаДокумента\").НайтиСтроки(Новый Структура(\"Представление\", ПредставлениеПФ));\t\r\nНастройкиСохранения = УправлениеПечатью.НастройкиСохранения();\r\nНастройкиСохранения.ФорматыСохранения = ФорматыПечати;\r\nНастройкиСохранения.ПодписьИПечать = Истина;\r\n\r\nСписокОбъектов = Новый Массив;\r\nСписокОбъектов.Добавить(ДокументСсылка);\r\n\t\r\nТаблицаЗначенийПФ = УправлениеПечатью.НапечататьВФайл(КомандыПечати, СписокОбъектов, НастройкиСохранения);\n\nФорматыПечати = Новый Массив;\r\nФорматыПечати.Добавить(ТипФайлаТабличногоДокумента.DOCX);\r\nКомандыПечати = УправлениеПечатью.КомандыПечатиФормы(\"Документ.Отпуск.Форма.ФормаДокумента\").НайтиСтроки(Новый Структура(\"Представление\", ПредставлениеПФ));\t\r\nНастройкиСохранения = УправлениеПечатью.НастройкиСохранения();\r\nНастройкиСохранения.ФорматыСохранения = ФорматыПечати;\r\nНастройкиСохранения.ПодписьИПечать = Истина;\r\n\r\nСписокОбъектов = Новый Массив;\r\nСписокОбъектов.Добавить(ДокументСсылка);\r\n\t\r\nТаблицаЗначенийПФ = УправлениеПечатью.НапечататьВФайл(КомандыПечати, СписокОбъектов, НастройкиСохранения);\n\n{11} Переменной ТаблицаЗначенийПФ присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Как правильно добавить контактную информацию (БСП)",
    "description": "Как правильно добавить контактную информацию (БСП)",
    "code_snippet": "//вид контактной информации (адрес партнера, адрес контрагента, телефон партнера и т.д.)\r\nВидКИ = Справочники.ВидыКонтактнойИнформации.АдресПартнера;\r\n//тип контактной информации (Адрес, Телефон, ЭлектроннаяПочта)\r\nТипКИ = ВидКИ.Тип;\r\n\t\t\t\r\n//получение объекта XDTO по представлению контактной информации\r\nОбъектXDTOКИ = УправлениеКонтактнойИнформациейСлужебный.КонтактнаяИнформацияXDTOПоПредставлению(\"г. Минск, ул. Пинская, 28А\", ТипКИ);\r\nЗначенияПолей = \r\n\r\n//преобразование объекта XDTO в xml\r\nУправлениеКонтактнойИнформациейСлужебный.КонтактнаяИнформацияXDTOВXML(ОбъектXDTOКИ);\r\n\r\n//запись контактной информации в табличную часть объекта\r\n//ПартнерОбъект - тип СправочникОбъект.ИмяСправочника\r\nУправлениеКонтактнойИнформацией.ЗаписатьКонтактнуюИнформацию(ПартнерОбъект, ЗначенияПолей, ВидКИ, ТипКИ);\n\n//вид контактной информации (адрес партнера, адрес контрагента, телефон партнера и т.д.)\r\nВидКИ = Справочники.ВидыКонтактнойИнформации.АдресПартнера;\r\n//тип контактной информации (Адрес, Телефон, ЭлектроннаяПочта)\r\nТипКИ = ВидКИ.Тип;\r\n\t\t\t\r\n//получение объекта XDTO по представлению контактной информации\r\nОбъектXDTOКИ = УправлениеКонтактнойИнформациейСлужебный.КонтактнаяИнформацияXDTOПоПредставлению(\"г. Минск, ул. Пинская, 28А\", ТипКИ);\r\nЗначенияПолей = \r\n\r\n//преобразование объекта XDTO в xml\r\nУправлениеКонтактнойИнформациейСлужебный.КонтактнаяИнформацияXDTOВXML(ОбъектXDTOКИ);\r\n\r\n//запись контактной информации в табличную часть объекта\r\n//ПартнерОбъект - тип СправочникОбъект.ИмяСправочника\r\nУправлениеКонтактнойИнформацией.ЗаписатьКонтактнуюИнформацию(ПартнерОбъект, ЗначенияПолей, ВидКИ, ТипКИ);\n\nдля каждого СтрокаФЛ из Объект.ФизическиеЛица цикл\n\n\t\tПочтаСтруктура = Новый Структура;\n\t    Вид = Справочники.ВидыКонтактнойИнформации.EMailФизическиеЛица;\n\t\tВидДляФЛ = Справочники.ВидыКонтактнойИнформации.EmailФизическиеЛица;\n\t    ПочтаСтруктура.Вставить(\"Представление\",  СтрокаФЛ.emailИзФайла);\n\t\tПочтаСтруктура.Вставить(\"АдресЭП\", СтрокаФЛ.emailИзФайла);\n\t    ЭПАДРЕС_XML = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияВXML(ПочтаСтруктура,\"\", Перечисления.ТипыКонтактнойИнформации.АдресЭлектроннойПочты);\n\t    ЭПАДРЕС_JSON = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияВJSON(ЭПАДРЕС_XML);\n\t\tУправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(СтрокаФЛ.ФизЛицо, ЭПАДРЕС_JSON, ВидДляФЛ, ТекущаяДата(), Истина);\n\t\t\n\nконеццикла;\n\nДанныеЗаполненияКИ = Новый Структура(\"Представление,КонтактнаяИнформация,Комментарий,Значение, Корректный\");\n\tСтруктураДанных = Новый Структура(\"Комментарий\");\n\tЕсли ДанныеКонтрагента.Свойство(\"ЮридическийАдрес\")\n\t\tИ ДанныеКонтрагента.ЮридическийАдрес <> Неопределено Тогда\n\t\t\n\t\tДанныеЗаполненияКИ.Представление = ДанныеКонтрагента.ЮридическийАдрес;\n\t\tДанныеЗаполненияКИ.Комментарий = \"\";\n\t\t\n\t\t\t\t\n\t\t\n\t\t//////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\t\t// \t\t\t\t\t\t\t\t\tВ свободной форме   \n\t\t//////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\t\t//вид контактной информации (адрес партнера, адрес контрагента, телефон партнера и т.д.)\n\t\tВидКИ = Справочники.ВидыКонтактнойИнформации.ЮридическийАдресКонтрагента;\n\t\t//тип контактной информации (Адрес, Телефон, ЭлектроннаяПочта)\n\t\tТипКИ = ВидКИ.Тип;\n\t\t\n\t\t//получение объекта XDTO по представлению контактной информации\n\t\tОбъектXDTOКИ = УправлениеКонтактнойИнформациейЛокализация.КонтактнаяИнформацияXDTOПоПредставлению( ДанныеКонтрагента.ЮридическийАдрес, ТипКИ);\n\t\tЗначенияПолей = \n\t\t\n\t\t//преобразование объекта XDTO в xml\n\t\tУправлениеКонтактнойИнформациейЛокализация.КонтактнаяИнформацияXDTOВXML(ОбъектXDTOКИ);\n\t\t\n\t\tДанныеЗаполненияКИ.Значение = ЗначенияПолей;\n\t\t\n\t\tЗаполнитьЭлементКонтактнойИнформации(ВидКИ,ДанныеЗаполненияКИ);   \n\t\t\n\tКонецЕсли;\n\n\n&НаСервере\nПроцедура ЗаполнитьЭлементКонтактнойИнформации(ВидКонтактнойИнформации, СтруктураДанных)\n\t\n\t\tЕсли СтруктураДанных = Неопределено \n\t\tИЛИ НЕ ЗначениеЗаполнено(СтруктураДанных.Представление) Тогда\n\t\tВозврат;\n\tКонецЕсли;\n\t\n\tОтбор  = Новый Структура(\"Вид\", ВидКонтактнойИнформации);\n\tСтроки = ЭтотОбъект.КонтактнаяИнформацияОписаниеДополнительныхРеквизитов.НайтиСтроки(Отбор);\n\tДанныеСтроки = ?(Строки.Количество() = 0, Неопределено, Строки[0]);\n\tЕсли ДанныеСтроки = Неопределено Тогда\n\t\tВозврат;\n\tКонецЕсли;\n\tДанныеСтроки.Представление = СтруктураДанных.Представление;\n\tДанныеСтроки.Значение = СтруктураДанных.КонтактнаяИнформация;\n\tЭтотОбъект[ДанныеСтроки.ИмяРеквизита] = СтруктураДанных.Представление;\nКонецПроцедуры"
  },
  {
    "title": "Пример работы с OpenOffice/LibreOffice Calc",
    "description": "Пример работы с OpenOffice/LibreOffice Calc",
    "code_snippet": "Орфографическая ошибка в нибудь: нибудь"
  },
  {
    "title": "Открыть форму незаписанного документа",
    "description": "Открыть форму незаписанного документа",
    "code_snippet": "&НаКлиенте\r\nПроцедура Команда(Команда)\r\n\r\nФорма = ПолучитьФорму(\"Документ.НашДокумент.ФормаОбъекта\");\r\nДанныеФормы = Форма.Объект; // Получаем объект формы в переменную\r\nЗаполнитьДокументНаСервере(ДанныеФормы); // Заполняем документ на сервере\r\nКопироватьДанныеФормы(ДанныеФормы, Форма.Объект); // копируем наш объект в объект формы и далее открываем ее\r\nФорма.Открыть();\r\n\r\nКонецПроцедуры\r\n\r\n// Можно использовать безконтекстный вызов, оптимизируем передачу данных\r\n\r\n&НаСервереБезКонтекста\r\n\r\nФункция ЗаполнитьДокументНаСервере(ДанныеФормы);\r\n\r\nДок = ДанныеФормыВЗначение(ДанныеФормы, Тип(\"ДокументОбъект.НашДокумент\")); // Получаем объект из данных формы ИЛИ\r\n\r\nДок = Документы.НашДокумент.СоздатьДокумент();\r\n\r\n// Заполняем реквизиты объекта или другие действия ********\r\n\r\nЗначениеВДанныеФормы(Док,ДанныеФормы); // Кладем обратно в объект формы уже созданный документ\r\n\r\nКонецФункции\n\n&НаКлиенте\r\nПроцедура Команда(Команда)\r\n\r\nФорма = ПолучитьФорму(\"Документ.НашДокумент.ФормаОбъекта\");\r\nДанныеФормы = Форма.Объект; // Получаем объект формы в переменную\r\nЗаполнитьДокументНаСервере(ДанныеФормы); // Заполняем документ на сервере\r\nКопироватьДанныеФормы(ДанныеФормы, Форма.Объект); // копируем наш объект в объект формы и далее открываем ее\r\nФорма.Открыть();\r\n\r\nКонецПроцедуры\r\n\r\n// Можно использовать безконтекстный вызов, оптимизируем передачу данных\r\n\r\n&НаСервереБезКонтекста\r\n\r\nФункция ЗаполнитьДокументНаСервере(ДанныеФормы);\r\n\r\nДок = ДанныеФормыВЗначение(ДанныеФормы, Тип(\"ДокументОбъект.НашДокумент\")); // Получаем объект из данных формы ИЛИ\r\n\r\nДок = Документы.НашДокумент.СоздатьДокумент();\r\n\r\n// Заполняем реквизиты объекта или другие действия ********\r\n\r\nЗначениеВДанныеФормы(Док,ДанныеФормы); // Кладем обратно в объект формы уже созданный документ\r\n\r\nКонецФункции\n\n{16} Не все части функции возвращают значение\r\n{18} Переменной Док присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в безконтекстный: безконтекстный"
  },
  {
    "title": "Как удалить префикс и лидирующие нули?",
    "description": "Как удалить префикс и лидирующие нули?",
    "code_snippet": "Процедура ОбработатьНомерДокумента()\n\n       НомерБезПрефикса = Объект.ВходящийНомер; \n       Пока Найти(НомерБезПрефикса,\"0\") <> 1 Цикл\n               НомерБезПрефикса = Сред(НомерБезПрефикса,2); //удаляет лидирующие ненули\n       КонецЦикла;\n\n       НомерБезНулей = НомерБезПрефикса;\n       Пока Найти(НомерБезНулей,\"0\") = 1 Цикл\n                НомерБезНулей = Сред(НомерБезНулей,2); //удаляет лидирующие нули\n       КонецЦикла;\n       Объект.ОбработанныйНомер = НомерБезНулей;\n\nКонецПроцедуры\n\nПока Найти(\"0123456789\", Лев(НомерБезПрефикса, 1)) = 0 Цикл\n\t\tНомерБезПрефикса = Сред(НомерБезПрефикса, 2); //удаляет лидирующие ненули\n\tКонецЦикла;\n\tНомерБезНулей = НомерБезПрефикса;\n\tПока Найти(НомерБезНулей, \"0\") = 1 Цикл\n\t\tНомерБезНулей = Сред(НомерБезНулей,2); //удаляет лидирующие нули\n\tКонецЦикла;\n\nФункция ЧислоСправа(Стр, К = 0)\n   Возврат ?(Цел(КодСимвола(Прав(\"!\" + Стр, К + 1)) / 5 - 10.5), Формат(Число(\"0\" + Прав(Стр, К)), \"ЧГ=\"), ЧислоСправа(Стр, К + 1))\nКонецФункции\n\nФункция ЧислоСправа1(Номер)\n   Возврат Формат(Число(\"0\" + Сред(Номер, СтрДлина(СокрП(\n   СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(Номер\n   , \"0\", \" \"), \"1\", \" \"), \"2\", \" \"), \"3\", \" \"), \"4\", \" \"), \"5\", \" \"), \"6\", \" \"), \"7\", \" \"), \"8\", \" \"), \"9\", \" \"))) + 1)), \"ЧГ=\")\nКонецФункции"
  },
  {
    "title": "Добавить элемент в обычную форму",
    "description": "Добавить элемент в обычную форму",
    "code_snippet": "ПолеВвода = ЭлементыФормы.Добавить(Тип(\"ПолеВвода\"), <НаименованиеЭлемента>, Истина, <Панель>);\r\nПолеВвода.Данные = <ПутьКДанным>;\r\nПолеВвода.Верх = <Верх>;\r\nПолеВвода.Высота = <Высота>;\r\nПолеВвода.Лево = <Лево>;\r\nПолеВвода.Ширина = <Ширина>;\r\nПолеВвода.УстановитьПривязку(ГраницаЭлементаУправления.Лево, <КкомуПривязываемся>, <ККакойЕгоГранице>);\r\nПолеВвода.УстановитьПривязку(ГраницаЭлементаУправления.Право, <КкомуПривязываемся>, <ККакойЕгоГранице>);\r\nПолеВвода.УстановитьПривязку(ГраницаЭлементаУправления.Верх, <КкомуПривязываемся>, <ККакойЕгоГранице>);\r\nПолеВвода.УстановитьПривязку(ГраницаЭлементаУправления.Низ, <КкомуПривязываемся>, <ККакойЕгоГранице>);\n\nПолеВвода = ЭлементыФормы.Добавить(Тип(\"ПолеВвода\"), <НаименованиеЭлемента>, Истина, <Панель>);\r\nПолеВвода.Данные = <ПутьКДанным>;\r\nПолеВвода.Верх = <Верх>;\r\nПолеВвода.Высота = <Высота>;\r\nПолеВвода.Лево = <Лево>;\r\nПолеВвода.Ширина = <Ширина>;\r\nПолеВвода.УстановитьПривязку(ГраницаЭлементаУправления.Лево, <КкомуПривязываемся>, <ККакойЕгоГранице>);\r\nПолеВвода.УстановитьПривязку(ГраницаЭлементаУправления.Право, <КкомуПривязываемся>, <ККакойЕгоГранице>);\r\nПолеВвода.УстановитьПривязку(ГраницаЭлементаУправления.Верх, <КкомуПривязываемся>, <ККакойЕгоГранице>);\r\nПолеВвода.УстановитьПривязку(ГраницаЭлементаУправления.Низ, <КкомуПривязываемся>, <ККакойЕгоГранице>);\n\n{1}Неопознанный оператор\r\n\tПолеВвода = ЭлементыФормы.Добавить(Тип(\"ПолеВвода\"), <НаименованиеЭлемента>, Истина, <Панель>);"
  },
  {
    "title": "Имя перечисления по значению",
    "description": "Имя перечисления по значению",
    "code_snippet": "XMLСтрока(Перечисления.Виды.Вид1)\n\nXMLСтрока(Перечисления.Виды.Вид1)\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Запись в регистр сведений (периодический, независимый)",
    "description": "Запись в регистр сведений (периодический, независимый)",
    "code_snippet": "МенеджерЗаписи = РегистрыСведений.УчетНомернойНоменклатуры.СоздатьМенеджерЗаписи();\r\n\t\tПока Выборка.Следующий() Цикл\r\n\t\t\tЕсли Выборка.Номенклатура.Номерная Тогда\r\n\t\t\t\tМенеджерЗаписи.Период \t\t= Дата;\r\n\t\t\t\tМенеджерЗаписи.Место \t\t= Склад;\t\t\t\r\n\t\t\t\tМенеджерЗаписи.Номенклатура = Выборка.Номенклатура;\r\n\t\t\t\tМенеджерЗаписи.Номер \t\t= Выборка.НомерАгрегата;\r\n\t\t\t\tМенеджерЗаписи.Статус \t\t= Перечисления.СтатусНоменклатуры.НаСкладе;\r\n\t\t\t\tМенеджерЗаписи.Записать();\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\n\nМенеджерЗаписи = РегистрыСведений.УчетНомернойНоменклатуры.СоздатьМенеджерЗаписи();\r\n\t\tПока Выборка.Следующий() Цикл\r\n\t\t\tЕсли Выборка.Номенклатура.Номерная Тогда\r\n\t\t\t\tМенеджерЗаписи.Период \t\t= Дата;\r\n\t\t\t\tМенеджерЗаписи.Место \t\t= Склад;\t\t\t\r\n\t\t\t\tМенеджерЗаписи.Номенклатура = Выборка.Номенклатура;\r\n\t\t\t\tМенеджерЗаписи.Номер \t\t= Выборка.НомерАгрегата;\r\n\t\t\t\tМенеджерЗаписи.Статус \t\t= Перечисления.СтатусНоменклатуры.НаСкладе;\r\n\t\t\t\tМенеджерЗаписи.Записать();\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Преобразовать строку в имя",
    "description": "Преобразовать строку в имя по правилу CamelCase:  Мое название переменной БО -> МоеНазваниеПеременнойБО",
    "code_snippet": ""
  },
  {
    "title": "Установить препроцессор",
    "description": "Установить препроцессор",
    "code_snippet": ""
  },
  {
    "title": "Проверка Модифицированности объекта",
    "description": "Проверка Модифицированности объекта",
    "code_snippet": "Функция ОбъектМодифицирован(Объект, ПроверятьТабличныеЧасти = Истина, ПроверятьСтандартные = Истина) Экспорт\r\n    \r\n    Ссылка = Объект.Ссылка;\r\n    МетаданныеОбъекта = Ссылка.Метаданные();\r\n    \r\n    Для каждого Реквизит Из МетаданныеОбъекта.Реквизиты Цикл\r\n    Если Объект[Реквизит.Имя] <> Ссылка[Реквизит.Имя] Тогда\r\n            Возврат Истина;\r\n        КонецЕсли;\r\n    КонецЦикла;\r\n    \r\n    Если ПроверятьСтандартные Тогда\r\n        Для каждого Реквизит Из МетаданныеОбъекта.СтандартныеРеквизиты Цикл\r\n            Если Объект[Реквизит.Имя] <> Ссылка[Реквизит.Имя] Тогда\r\n                Возврат Истина;\r\n            КонецЕсли;\r\n        КонецЦикла;\r\n    КонецЕсли;\r\n     \r\n    Если ПроверятьТабличныеЧасти Тогда\r\n        Для каждого ТЧ Из МетаданныеОбъекта.ТабличныеЧасти Цикл\r\n            \r\n            Если Объект[ТЧ.Имя].Количество() <> Ссылка[ТЧ.Имя].Количество() Тогда\r\n        Возврат Истина;\r\n            КонецЕсли;\r\n                        \r\n            Для Индекс = 0 По Объект[ТЧ.Имя].Количество()-1 Цикл\r\n                ОбъектСтрокаТЧ = Объект[ТЧ.Имя][Индекс];\r\n                СсылкаСтрокаТЧ = Ссылка[ТЧ.Имя][Индекс];\r\n                Для каждого РеквизитТЧ Из ТЧ.Реквизиты Цикл\r\n                    Если ОбъектСтрокаТЧ[РеквизитТЧ.Имя] <> СсылкаСтрокаТЧ[РеквизитТЧ.Имя] Тогда\r\n                        Возврат Истина;\r\n                    КонецЕсли;\r\n                КонецЦикла;\r\n            КонецЦикла;\r\n            \r\n        КонецЦикла;        \r\n    КонецЕсли;\r\n    \r\n    Возврат Ложь;\r\n    \r\nКонецФункции\n\nФункция ОбъектМодифицирован(Объект, ПроверятьТабличныеЧасти = Истина, ПроверятьСтандартные = Истина) Экспорт\r\n    \r\n    Ссылка = Объект.Ссылка;\r\n    МетаданныеОбъекта = Ссылка.Метаданные();\r\n    \r\n    Для каждого Реквизит Из МетаданныеОбъекта.Реквизиты Цикл\r\n    Если Объект[Реквизит.Имя] <> Ссылка[Реквизит.Имя] Тогда\r\n            Возврат Истина;\r\n        КонецЕсли;\r\n    КонецЦикла;\r\n    \r\n    Если ПроверятьСтандартные Тогда\r\n        Для каждого Реквизит Из МетаданныеОбъекта.СтандартныеРеквизиты Цикл\r\n            Если Объект[Реквизит.Имя] <> Ссылка[Реквизит.Имя] Тогда\r\n                Возврат Истина;\r\n            КонецЕсли;\r\n        КонецЦикла;\r\n    КонецЕсли;\r\n     \r\n    Если ПроверятьТабличныеЧасти Тогда\r\n        Для каждого ТЧ Из МетаданныеОбъекта.ТабличныеЧасти Цикл\r\n            \r\n            Если Объект[ТЧ.Имя].Количество() <> Ссылка[ТЧ.Имя].Количество() Тогда\r\n        Возврат Истина;\r\n            КонецЕсли;\r\n                        \r\n            Для Индекс = 0 По Объект[ТЧ.Имя].Количество()-1 Цикл\r\n                ОбъектСтрокаТЧ = Объект[ТЧ.Имя][Индекс];\r\n                СсылкаСтрокаТЧ = Ссылка[ТЧ.Имя][Индекс];\r\n                Для каждого РеквизитТЧ Из ТЧ.Реквизиты Цикл\r\n                    Если ОбъектСтрокаТЧ[РеквизитТЧ.Имя] <> СсылкаСтрокаТЧ[РеквизитТЧ.Имя] Тогда\r\n                        Возврат Истина;\r\n                    КонецЕсли;\r\n                КонецЦикла;\r\n            КонецЦикла;\r\n            \r\n        КонецЦикла;        \r\n    КонецЕсли;\r\n    \r\n    Возврат Ложь;\r\n    \r\nКонецФункции\n\n{1} Высокая цикломатическая сложность: 20\r\nОрфографическая ошибка в Модифицированности: Модифицированности"
  },
  {
    "title": "Конвертация даты из формата ISO8601 в дату 1С с учетом миллисекунд",
    "description": "Конвертация даты из формата ISO8601 в дату 1С с учетом миллисекунд",
    "code_snippet": "Функция КонвертироватьДатуISO8601ВДату(Дата) Экспорт\r\n\r\n\tКонвертированнаяДата = Новый Структура(\"Дата, Миллисекунды\");\r\n\t\r\n\tАвтоконвертированнаяДата = XMLЗначение(Тип(\"Дата\"), Дата);\r\n\r\n\tМиллисекунды = Сред(Дата, 21);\r\n\tМиллисекунды = СокрЛП(СтрЗаменить(Миллисекунды, \"Z\", \"\"));\r\n\r\n\tЕсли НЕ ПустаяСтрока(Миллисекунды) Тогда\r\n\t\t\r\n\t\tЧислоМиллисекунд = Число(Миллисекунды);\r\n\t\t\r\n\t\tЕсли ЧислоМиллисекунд >= 500 Тогда\r\n\t\t\t\r\n\t\t\tАвтоконвертированнаяДата = АвтоконвертированнаяДата - 1;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tКонвертированнаяДата.Дата = АвтоконвертированнаяДата;\r\n\t\r\n\tКонвертированнаяДата.Миллисекунды = Миллисекунды;\r\n\t\r\n\tВозврат КонвертированнаяДата;\r\n\r\nКонецФункции\n\nФункция КонвертироватьДатуISO8601ВДату(Дата) Экспорт\r\n\r\n\tКонвертированнаяДата = Новый Структура(\"Дата, Миллисекунды\");\r\n\t\r\n\tАвтоконвертированнаяДата = XMLЗначение(Тип(\"Дата\"), Дата);\r\n\r\n\tМиллисекунды = Сред(Дата, 21);\r\n\tМиллисекунды = СокрЛП(СтрЗаменить(Миллисекунды, \"Z\", \"\"));\r\n\r\n\tЕсли НЕ ПустаяСтрока(Миллисекунды) Тогда\r\n\t\t\r\n\t\tЧислоМиллисекунд = Число(Миллисекунды);\r\n\t\t\r\n\t\tЕсли ЧислоМиллисекунд >= 500 Тогда\r\n\t\t\t\r\n\t\t\tАвтоконвертированнаяДата = АвтоконвертированнаяДата - 1;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tКонвертированнаяДата.Дата = АвтоконвертированнаяДата;\r\n\t\r\n\tКонвертированнаяДата.Миллисекунды = Миллисекунды;\r\n\t\r\n\tВозврат КонвертированнаяДата;\r\n\r\nКонецФункции\n\nОрфографическая ошибка в АвтоконвертированнаяДата (найдено 4): Автоконвертированная"
  },
  {
    "title": "v8metadata-reader",
    "description": "Чтение информации о метаданных 1С по файлам исходников",
    "code_snippet": ""
  },
  {
    "title": "Удалить дубли строк в таблице значений",
    "description": "Удалить дубли строк в таблице значений",
    "code_snippet": "Функция УдалитьДублиСтрокТаблицыЗначений(Таблица, Колонки = \"\") Экспорт\r\n\r\n\tЕсли ПустаяСтрока(Колонки) Тогда\r\n\t\t\r\n\t\t// Просто свернем таблицу по всем колонкам\r\n\t\t\r\n\t\tДля каждого Колонка Из Таблица.Колонки Цикл\r\n\t\t\tКолонки = Колонки + ?(ПустаяСтрока(Колонки), \"\", \",\") + Колонка.Имя;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tТаблицаРезультат = Таблица.Скопировать();\r\n\t\tТаблицаРезультат.Свернуть(Колонки);\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tКолонкиЗапроса = \"ТЗ.\" + СтрЗаменить(Колонки, \",\", \",ТЗ.\");\r\n\t\t\r\n\t\tЗапрос = Новый Запрос;\r\n\t\tЗапрос.Текст = \"ВЫБРАТЬ\r\n\t\t\t\t\t   |\t\" + КолонкиЗапроса + \"\r\n\t\t\t\t\t   |ПОМЕСТИТЬ ВТ_ТЗ\r\n\t\t\t\t\t   |ИЗ\r\n\t\t\t\t\t   |\t&ТЗ КАК ТЗ\r\n\t\t\t\t\t   |;\r\n\t\t\t\t\t   |\r\n\t\t\t\t\t   |////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t\t\t   |ВЫБРАТЬ РАЗЛИЧНЫЕ\r\n\t\t\t\t\t   |\t\" + СтрЗаменить(КолонкиЗапроса, \"ТЗ.\", \"ВТ_ТЗ.\") + \"\r\n\t\t\t\t\t   |ИЗ\r\n\t\t\t\t\t   |\tВТ_ТЗ КАК ВТ_ТЗ\r\n\t\t\t\t\t   |\";\r\n\r\n\t\tЗапрос.УстановитьПараметр(\"ТЗ\", Таблица);\r\n\t\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\tТаблицаЗапроса = РезультатЗапроса.Выгрузить();\r\n\t\tТаблицаРезультат = Таблица.СкопироватьКолонки();\r\n\t\tДля каждого СтрокаТЗ Из ТаблицаЗапроса Цикл\r\n\t\t\r\n\t\t\tСтруктураОтбора = Новый Структура(Колонки);\r\n\t\t\tЗаполнитьЗначенияСвойств(СтруктураОтбора, СтрокаТЗ);\r\n\t\t\t\r\n\t\t\tРезультатОтбора = Таблица.НайтиСтроки(СтруктураОтбора);\r\n\t\t\tДля каждого СтрокаОтбора Из РезультатОтбора Цикл\r\n\t\t\t\t\r\n\t\t\t\tНоваяСтрока = ТаблицаРезультат.Добавить();\r\n\t\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаОтбора);\r\n\t\t\t\tПрервать;\r\n\t\t\t\t\r\n\t\t\tКонецЦикла;\r\n\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ТаблицаРезультат;\r\n\r\nКонецФункции // УдалитьДублиСтрокТаблицыЗначений()\n\nФункция УдалитьДублиСтрокТаблицыЗначений(Таблица, Колонки = \"\") Экспорт\r\n\r\n\tЕсли ПустаяСтрока(Колонки) Тогда\r\n\t\t\r\n\t\t// Просто свернем таблицу по всем колонкам\r\n\t\t\r\n\t\tДля каждого Колонка Из Таблица.Колонки Цикл\r\n\t\t\tКолонки = Колонки + ?(ПустаяСтрока(Колонки), \"\", \",\") + Колонка.Имя;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tТаблицаРезультат = Таблица.Скопировать();\r\n\t\tТаблицаРезультат.Свернуть(Колонки);\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tКолонкиЗапроса = \"ТЗ.\" + СтрЗаменить(Колонки, \",\", \",ТЗ.\");\r\n\t\t\r\n\t\tЗапрос = Новый Запрос;\r\n\t\tЗапрос.Текст = \"ВЫБРАТЬ\r\n\t\t\t\t\t   |\t\" + КолонкиЗапроса + \"\r\n\t\t\t\t\t   |ПОМЕСТИТЬ ВТ_ТЗ\r\n\t\t\t\t\t   |ИЗ\r\n\t\t\t\t\t   |\t&ТЗ КАК ТЗ\r\n\t\t\t\t\t   |;\r\n\t\t\t\t\t   |\r\n\t\t\t\t\t   |////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t\t\t   |ВЫБРАТЬ РАЗЛИЧНЫЕ\r\n\t\t\t\t\t   |\t\" + СтрЗаменить(КолонкиЗапроса, \"ТЗ.\", \"ВТ_ТЗ.\") + \"\r\n\t\t\t\t\t   |ИЗ\r\n\t\t\t\t\t   |\tВТ_ТЗ КАК ВТ_ТЗ\r\n\t\t\t\t\t   |\";\r\n\r\n\t\tЗапрос.УстановитьПараметр(\"ТЗ\", Таблица);\r\n\t\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\tТаблицаЗапроса = РезультатЗапроса.Выгрузить();\r\n\t\tТаблицаРезультат = Таблица.СкопироватьКолонки();\r\n\t\tДля каждого СтрокаТЗ Из ТаблицаЗапроса Цикл\r\n\t\t\r\n\t\t\tСтруктураОтбора = Новый Структура(Колонки);\r\n\t\t\tЗаполнитьЗначенияСвойств(СтруктураОтбора, СтрокаТЗ);\r\n\t\t\t\r\n\t\t\tРезультатОтбора = Таблица.НайтиСтроки(СтруктураОтбора);\r\n\t\t\tДля каждого СтрокаОтбора Из РезультатОтбора Цикл\r\n\t\t\t\t\r\n\t\t\t\tНоваяСтрока = ТаблицаРезультат.Добавить();\r\n\t\t\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаОтбора);\r\n\t\t\t\tПрервать;\r\n\t\t\t\t\r\n\t\t\tКонецЦикла;\r\n\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ТаблицаРезультат;\r\n\r\nКонецФункции // УдалитьДублиСтрокТаблицыЗначений()"
  },
  {
    "title": "camelcase",
    "description": "Методы Разделить и Соединить для преобразования в \"Верблюжью нотацию\"",
    "code_snippet": ""
  },
  {
    "title": "ЗаписьJSON",
    "description": "ЗаписьJSON",
    "code_snippet": "ЗаписьJSON = Новый ЗаписьJSON;\r\n\t\r\n\tПараметрыЗаписиJSON = Новый ПараметрыЗаписиJSON(, Символы.Таб);\r\n\tЗаписьJSON.УстановитьСтроку(ПараметрыЗаписиJSON);\r\n\t\r\n\tЗаписьJSON.ЗаписатьНачалоОбъекта();\r\n\t\tЗаписьJSON.ЗаписатьИмяСвойства(\"Выражение\");\r\n\t\tЗаписьJSON.ЗаписатьЗначение(\"Сумма 1 + 1\");\r\n\t\tЗаписьJSON.ЗаписатьИмяСвойства(\"Результат\");\r\n\t\tЗаписьJSON.ЗаписатьЗначение(2);\r\n\tЗаписьJSON.ЗаписатьКонецОбъекта();\r\n\r\n\tТелоЗапроса = ЗаписьJSON.Закрыть();\n\nЗаписьJSON = Новый ЗаписьJSON;\r\n\t\r\n\tПараметрыЗаписиJSON = Новый ПараметрыЗаписиJSON(, Символы.Таб);\r\n\tЗаписьJSON.УстановитьСтроку(ПараметрыЗаписиJSON);\r\n\t\r\n\tЗаписьJSON.ЗаписатьНачалоОбъекта();\r\n\t\tЗаписьJSON.ЗаписатьИмяСвойства(\"Выражение\");\r\n\t\tЗаписьJSON.ЗаписатьЗначение(\"Сумма 1 + 1\");\r\n\t\tЗаписьJSON.ЗаписатьИмяСвойства(\"Результат\");\r\n\t\tЗаписьJSON.ЗаписатьЗначение(2);\r\n\tЗаписьJSON.ЗаписатьКонецОбъекта();\r\n\r\n\tТелоЗапроса = ЗаписьJSON.Закрыть();\n\n{13} Переменной ТелоЗапроса присвоено значение, но оно нигде не используется\r\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное.\n\nJ=Новый ЗаписьJSON;\nJ.УстановитьСтроку();\nЗаписатьJSON(J,Новый Структура(\"Выражение,Результат\",\"Сумма 1 + 1\",2));\nТелозапроса=J.Закрыть();"
  },
  {
    "title": "Заполнить реквизит \"СуммаДокумента \"на форме документа",
    "description": "Заполнить реквизит \"СуммаДокумента \"на форме документа",
    "code_snippet": "Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)\r\n\tСуммаДокумента = Товары.Итог(\"Сумма\");\r\nКонецПроцедуры\n\nПроцедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)\r\n\tСуммаДокумента = Товары.Итог(\"Сумма\");\r\nКонецПроцедуры\n\n{2} Переменной СуммаДокумента присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Расчет суммы в строке табличной части",
    "description": "Расчет суммы в строке табличной части",
    "code_snippet": "&НаКлиенте\r\nПроцедура ТоварыЦенаПриИзменении(Элемент)\r\n\tРассчитатьСумму();\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура РассчитатьСумму()\r\n\tСтр = Элементы.Товары.ТекущиеДанные;\r\n\tСтр.Сумма = Стр.Цена * Стр.Количество;\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура ТоварыЦенаПриИзменении(Элемент)\r\n\tРассчитатьСумму();\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура РассчитатьСумму()\r\n\tСтр = Элементы.Товары.ТекущиеДанные;\r\n\tСтр.Сумма = Стр.Цена * Стр.Количество;\r\nКонецПроцедуры"
  },
  {
    "title": "IP-адрес локального компьютера",
    "description": "IP-адрес локального компьютера",
    "code_snippet": "&НаКлиенте\r\nПроцедура УзнатьIP(Команда)\r\n\t\r\n\tCOMОбъект1 = Новый COMОбъект(\"WbemScripting.SWbemLocator\");\r\n\tCOMОбъект2 = COMОбъект1.ConnectServer(\".\",\"root\\CIMV2\");\r\n\t\r\n\tРезультат = COMОбъект2.ExecQuery(\"SELECT IPAddress FROM \r\n\t|Win32_NetworkAdapterConfiguration \r\n\t|WHERE IPEnabled = TRUE\");\r\n\t\r\n\tДля каждого Строка Из Результат Цикл\r\n\t\tДля каждого ПодСтрока Из Строка.IPAddress Цикл \r\n\t\t\tСтр = Объект.IPAddress.Добавить();\r\n\t\t\tСтр.Адрес = ПодСтрока;\r\n\t\t\t//Сообщить(ПодСтрока);\r\n\t\tКонецЦикла;\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура УзнатьIP(Команда)\r\n\t\r\n\tCOMОбъект1 = Новый COMОбъект(\"WbemScripting.SWbemLocator\");\r\n\tCOMОбъект2 = COMОбъект1.ConnectServer(\".\",\"root\\CIMV2\");\r\n\t\r\n\tРезультат = COMОбъект2.ExecQuery(\"SELECT IPAddress FROM \r\n\t|Win32_NetworkAdapterConfiguration \r\n\t|WHERE IPEnabled = TRUE\");\r\n\t\r\n\tДля каждого Строка Из Результат Цикл\r\n\t\tДля каждого ПодСтрока Из Строка.IPAddress Цикл \r\n\t\t\tСтр = Объект.IPAddress.Добавить();\r\n\t\t\tСтр.Адрес = ПодСтрока;\r\n\t\t\t//Сообщить(ПодСтрока);\r\n\t\tКонецЦикла;\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Загрузка XML в 1С из FTP",
    "description": "Загрузка XML в 1С из FTP",
    "code_snippet": "КаталогВрФл = КаталогВременныхФайлов();\r\n\t\r\n\tФТПСоединение = Новый FTPСоединение(\"адрес\",, \"логин\", \"пароль\",, Истина);\r\n\t\r\n\tНайдемФайлаНаФТП = ФТПСоединение.НайтиФайлы(\"/\", \"*.xml\");\r\n\t\r\n\tЕсли НайдемФайлаНаФТП.Количество() = 0 Тогда\r\n\t\tФТПСоединение = Неопределено;\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n\tДанныеИзФайлаТовары = Новый ТаблицаЗначений();\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Артикул\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"ИД\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Производитель\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Номенклатура\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Количество\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Цена\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Размер\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Цвет\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Серия\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"ЦенаСоСкидкой\");\r\n\t\r\n\tВидНоменклатуры = Справочники.ВидыНоменклатуры.НайтиПоНаименованию(\"Товар\");\r\n\tЕдиницаИзмШТ = Справочники.УпаковкиЕдиницыИзмерения.НайтиПоКоду(\"796\");\r\n\tПриоритетСредний = Справочники.Приоритеты.НайтиПоНаименованию(\"Средний\");\r\n\tСкладОсновной = Справочники.Склады.НайтиПоНаименованию(\"Основной склад\");\r\n\tТиповоеСоглашение = Справочники.СоглашенияСКлиентами.НайтиПоНаименованию(\"Основное\");\r\n\tВалютаДок = Константы.ВалютаРегламентированногоУчета.Получить(); \r\n\t\t\r\n\tДля каждого ФайлФТП из НайдемФайлаНаФТП Цикл\r\n\t\t\r\n\t\tДанныеИзФайлаТовары.Очистить();\r\n\t\tНомерКП = ФайлФТП.ИмяБезРасширения;\r\n\t\tДатаКП = \"\";\r\n\t\t\r\n\t\tПутьКФайлуОбъект = КаталогВрФл + ФайлФТП.Имя;\r\n\t\t\r\n\t\tПопытка\r\n\t\t\r\n\t\tФТПСоединение.Получить(ФайлФТП.ПолноеИмя, ПутьКФайлуОбъект);\t\t\r\n\t\tФТПСоединение.Переместить(ФайлФТП.ПолноеИмя, \"OldFiles\" + \"\\\" + ФайлФТП.Имя);\r\n\t\t\t\t\r\n\t\tЧтениеXML = Новый ЧтениеXML;\r\n\t\tЧтениеXML.ОткрытьФайл(ПутьКФайлуОбъект);\r\n\t\t\r\n\t\tПока ЧтениеXML.Прочитать() Цикл\r\n\t\t\tЕсли ЧтениеXML.ТипУзла <> ТипУзлаXML.НачалоЭлемента Тогда Продолжить; КонецЕсли;\r\n\t\t\tИмяУзла = ЧтениеXML.ЛокальноеИмя;\t\r\n\t\t\tЕсли ИмяУзла = \"PRODUCT\" Тогда\r\n\t\t\t\tНоваяСтрока = ДанныеИзФайлаТовары.Добавить();\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"ID\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.ИД = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"ARTICLE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Артикул = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"SIZE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Размер = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"COLOR\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Цвет = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"NAME\" И ЧтениеXML.КонтекстПространствИмен.Глубина = 5 Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Серия = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PROPERTY_PROVIDER_NAME\" И ЧтениеXML.КонтекстПространствИмен.Глубина = 5 Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Производитель = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"NAME\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Номенклатура = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"QUANTITY\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Количество = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PRICE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Цена = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PRICE_DISCOUNT\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.ЦенаСоСкидкой = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"DATE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tДатаСтр = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tДатаКП = Дата(ДатаСтр);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tЧтениеXML.Закрыть();\r\n\t\tУдалитьФайлы(ПутьКФайлуОбъект);\n\nКаталогВрФл = КаталогВременныхФайлов();\r\n\t\r\n\tФТПСоединение = Новый FTPСоединение(\"адрес\",, \"логин\", \"пароль\",, Истина);\r\n\t\r\n\tНайдемФайлаНаФТП = ФТПСоединение.НайтиФайлы(\"/\", \"*.xml\");\r\n\t\r\n\tЕсли НайдемФайлаНаФТП.Количество() = 0 Тогда\r\n\t\tФТПСоединение = Неопределено;\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n\tДанныеИзФайлаТовары = Новый ТаблицаЗначений();\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Артикул\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"ИД\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Производитель\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Номенклатура\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Количество\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Цена\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Размер\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Цвет\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"Серия\");\r\n\tДанныеИзФайлаТовары.Колонки.Добавить(\"ЦенаСоСкидкой\");\r\n\t\r\n\tВидНоменклатуры = Справочники.ВидыНоменклатуры.НайтиПоНаименованию(\"Товар\");\r\n\tЕдиницаИзмШТ = Справочники.УпаковкиЕдиницыИзмерения.НайтиПоКоду(\"796\");\r\n\tПриоритетСредний = Справочники.Приоритеты.НайтиПоНаименованию(\"Средний\");\r\n\tСкладОсновной = Справочники.Склады.НайтиПоНаименованию(\"Основной склад\");\r\n\tТиповоеСоглашение = Справочники.СоглашенияСКлиентами.НайтиПоНаименованию(\"Основное\");\r\n\tВалютаДок = Константы.ВалютаРегламентированногоУчета.Получить(); \r\n\t\t\r\n\tДля каждого ФайлФТП из НайдемФайлаНаФТП Цикл\r\n\t\t\r\n\t\tДанныеИзФайлаТовары.Очистить();\r\n\t\tНомерКП = ФайлФТП.ИмяБезРасширения;\r\n\t\tДатаКП = \"\";\r\n\t\t\r\n\t\tПутьКФайлуОбъект = КаталогВрФл + ФайлФТП.Имя;\r\n\t\t\r\n\t\tПопытка\r\n\t\t\r\n\t\tФТПСоединение.Получить(ФайлФТП.ПолноеИмя, ПутьКФайлуОбъект);\t\t\r\n\t\tФТПСоединение.Переместить(ФайлФТП.ПолноеИмя, \"OldFiles\" + \"\\\" + ФайлФТП.Имя);\r\n\t\t\t\t\r\n\t\tЧтениеXML = Новый ЧтениеXML;\r\n\t\tЧтениеXML.ОткрытьФайл(ПутьКФайлуОбъект);\r\n\t\t\r\n\t\tПока ЧтениеXML.Прочитать() Цикл\r\n\t\t\tЕсли ЧтениеXML.ТипУзла <> ТипУзлаXML.НачалоЭлемента Тогда Продолжить; КонецЕсли;\r\n\t\t\tИмяУзла = ЧтениеXML.ЛокальноеИмя;\t\r\n\t\t\tЕсли ИмяУзла = \"PRODUCT\" Тогда\r\n\t\t\t\tНоваяСтрока = ДанныеИзФайлаТовары.Добавить();\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"ID\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.ИД = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"ARTICLE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Артикул = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"SIZE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Размер = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"COLOR\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Цвет = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"NAME\" И ЧтениеXML.КонтекстПространствИмен.Глубина = 5 Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Серия = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PROPERTY_PROVIDER_NAME\" И ЧтениеXML.КонтекстПространствИмен.Глубина = 5 Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Производитель = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"NAME\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Номенклатура = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"QUANTITY\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Количество = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PRICE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.Цена = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"PRICE_DISCOUNT\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tНоваяСтрока.ЦенаСоСкидкой = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ИмяУзла = \"DATE\" Тогда\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\t\tДатаСтр = СокрЛП(ЧтениеXML.Значение);\r\n\t\t\t\tДатаКП = Дата(ДатаСтр);\r\n\t\t\t\tПродолжить;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tЧтениеXML.Закрыть();\r\n\t\tУдалитьФайлы(ПутьКФайлуОбъект);\n\n{113} Ожидается Except"
  },
  {
    "title": "Пересчет сумм в табличной части документа",
    "description": "Пересчет сумм в табличной части документа",
    "code_snippet": "НА СЕРВЕРЕ:\r\n\r\nСтруктураПересчетаСуммы = ОбработкаТабличнойЧастиКлиентСервер.ПараметрыПересчетаСуммыНДСВСтрокеТЧ(ДокЗаказ);\t\r\nСтруктураДействий = Новый Структура;\t\r\nСтруктураДействий.Вставить(\"ПересчитатьСумму\", \"КоличествоУпаковок\");\r\nСтруктураДействий.Вставить(\"ПересчитатьСуммуНДС\", СтруктураПересчетаСуммы);\r\nСтруктураДействий.Вставить(\"ПересчитатьСуммуСНДС\", СтруктураПересчетаСуммы);\r\nСтруктураДействий.Вставить(\"ПересчитатьСуммуСУчетомРучнойСкидки\", Новый Структура(\"Очищать\", Ложь));\r\nОбработкаТабличнойЧастиСервер.ОбработатьТЧ(ДокЗаказ.Товары, СтруктураДействий, Неопределено);\r\n\r\n\r\nНА КЛИЕНТЕ:\r\n\r\nСтруктураПересчетаСуммы = ОбработкаТабличнойЧастиКлиентСервер.ПараметрыПересчетаСуммыНДСВСтрокеТЧ(Объект);\t\r\n\t\t\tСтруктураДействий = Новый Структура;\t\r\n\t\t\tСтруктураДействий.Вставить(\"ПересчитатьКоличествоЕдиниц\");\r\n\t\t\tСтруктураДействий.Вставить(\"ПересчитатьСумму\");\r\n\t\t\tСтруктураДействий.Вставить(\"ПересчитатьСуммуНДС\", СтруктураПересчетаСуммы);\r\n\t\t\tСтруктураДействий.Вставить(\"ПересчитатьСуммуСНДС\", СтруктураПересчетаСуммы);\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьПризнакТипНоменклатуры\", Новый Структура(\"Номенклатура\", \"ТипНоменклатуры\"));\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьПризнакАртикул\", Новый Структура(\"Номенклатура\", \"Артикул\"));\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьПризнакВариантОформленияПродажи\", Новый Структура(\"Номенклатура\", \"ВариантОформленияПродажи\"));\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьСодержание\", ОбработкаТабличнойЧастиКлиентСервер.ПолучитьСтруктуруЗаполненияСодержанияУслугиВСтрокеТЧ(Объект, Ложь));\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьДубликатыЗависимыхРеквизитов\", ЗависимыеРеквизиты());\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьПризнакБезВозвратнойТары\", Объект.ВернутьМногооборотнуюТару);\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьПризнакОтмененоБезВозвратнойТары\", Объект.ВернутьМногооборотнуюТару);\r\n\t\t\tПараметрыДействия = ОбеспечениеКлиентСервер.ПараметрыДействияПроверитьЗаполнитьОбеспечение(ВариантыОбеспечения, Объект.ЖелаемаяДатаОтгрузки);\r\n\t\t\tСтруктураДействий.Вставить(\"ПроверитьЗаполнитьОбеспечениеВДокументеПродажи\", ПараметрыДействия);\r\n\t\t\tСтруктураДействий.Вставить(\"ПриИзмененииТипаНоменклатурыИлиВариантаОбеспечения\",\r\n\t\t\t\t\tНовый Структура(\"ЕстьРаботы, ЕстьОтменено\", Истина, Истина));\r\nСтруктураДействий.Вставить(\"НоменклатураПриИзмененииПереопределяемый\", Новый Структура(\"ИмяФормы, ИмяТабличнойЧасти\",\r\n\t\tЭтаФорма.ИмяФормы, \"Товары\"));\r\n\r\n\r\n\r\nСтруктураДействий.Вставить(\"ПроверитьСериюРассчитатьСтатус\", Новый Структура(\"Склад, ПараметрыУказанияСерий\", ТекущаСтрока.Склад, ПараметрыУказанияСерий));\r\n\t\t\t\tОбработкаТабличнойЧастиКлиент.ОбработатьСтрокуТЧ(ТекущаСтрока, СтруктураДействий, Неопределено);\n\nНА СЕРВЕРЕ:\r\n\r\nСтруктураПересчетаСуммы = ОбработкаТабличнойЧастиКлиентСервер.ПараметрыПересчетаСуммыНДСВСтрокеТЧ(ДокЗаказ);\t\r\nСтруктураДействий = Новый Структура;\t\r\nСтруктураДействий.Вставить(\"ПересчитатьСумму\", \"КоличествоУпаковок\");\r\nСтруктураДействий.Вставить(\"ПересчитатьСуммуНДС\", СтруктураПересчетаСуммы);\r\nСтруктураДействий.Вставить(\"ПересчитатьСуммуСНДС\", СтруктураПересчетаСуммы);\r\nСтруктураДействий.Вставить(\"ПересчитатьСуммуСУчетомРучнойСкидки\", Новый Структура(\"Очищать\", Ложь));\r\nОбработкаТабличнойЧастиСервер.ОбработатьТЧ(ДокЗаказ.Товары, СтруктураДействий, Неопределено);\r\n\r\n\r\nНА КЛИЕНТЕ:\r\n\r\nСтруктураПересчетаСуммы = ОбработкаТабличнойЧастиКлиентСервер.ПараметрыПересчетаСуммыНДСВСтрокеТЧ(Объект);\t\r\n\t\t\tСтруктураДействий = Новый Структура;\t\r\n\t\t\tСтруктураДействий.Вставить(\"ПересчитатьКоличествоЕдиниц\");\r\n\t\t\tСтруктураДействий.Вставить(\"ПересчитатьСумму\");\r\n\t\t\tСтруктураДействий.Вставить(\"ПересчитатьСуммуНДС\", СтруктураПересчетаСуммы);\r\n\t\t\tСтруктураДействий.Вставить(\"ПересчитатьСуммуСНДС\", СтруктураПересчетаСуммы);\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьПризнакТипНоменклатуры\", Новый Структура(\"Номенклатура\", \"ТипНоменклатуры\"));\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьПризнакАртикул\", Новый Структура(\"Номенклатура\", \"Артикул\"));\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьПризнакВариантОформленияПродажи\", Новый Структура(\"Номенклатура\", \"ВариантОформленияПродажи\"));\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьСодержание\", ОбработкаТабличнойЧастиКлиентСервер.ПолучитьСтруктуруЗаполненияСодержанияУслугиВСтрокеТЧ(Объект, Ложь));\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьДубликатыЗависимыхРеквизитов\", ЗависимыеРеквизиты());\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьПризнакБезВозвратнойТары\", Объект.ВернутьМногооборотнуюТару);\r\n\t\t\tСтруктураДействий.Вставить(\"ЗаполнитьПризнакОтмененоБезВозвратнойТары\", Объект.ВернутьМногооборотнуюТару);\r\n\t\t\tПараметрыДействия = ОбеспечениеКлиентСервер.ПараметрыДействияПроверитьЗаполнитьОбеспечение(ВариантыОбеспечения, Объект.ЖелаемаяДатаОтгрузки);\r\n\t\t\tСтруктураДействий.Вставить(\"ПроверитьЗаполнитьОбеспечениеВДокументеПродажи\", ПараметрыДействия);\r\n\t\t\tСтруктураДействий.Вставить(\"ПриИзмененииТипаНоменклатурыИлиВариантаОбеспечения\",\r\n\t\t\t\t\tНовый Структура(\"ЕстьРаботы, ЕстьОтменено\", Истина, Истина));\r\nСтруктураДействий.Вставить(\"НоменклатураПриИзмененииПереопределяемый\", Новый Структура(\"ИмяФормы, ИмяТабличнойЧасти\",\r\n\t\tЭтаФорма.ИмяФормы, \"Товары\"));\r\n\r\n\r\n\r\nСтруктураДействий.Вставить(\"ПроверитьСериюРассчитатьСтатус\", Новый Структура(\"Склад, ПараметрыУказанияСерий\", ТекущаСтрока.Склад, ПараметрыУказанияСерий));\r\n\t\t\t\tОбработкаТабличнойЧастиКлиент.ОбработатьСтрокуТЧ(ТекущаСтрока, СтруктураДействий, Неопределено);\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Программная обработка расшифровки отчета на СКД на обычных формах",
    "description": "Программная обработка расшифровки отчета на СКД на обычных формах",
    "code_snippet": "Процедура РезультатОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка)\r\n   Перем ВыполненноеДействие;\r\n\r\n   // Запретим стандартную обработку расшифровки\r\n \r\n    СтандартнаяОбработка = Ложь;\r\n\r\n   // Создадим и инициализируем обработчик расшифровки\r\n \r\n    ОбработкаРасшифровки = Новый ОбработкаРасшифровкиКомпоновкиДанных(ДанныеРасшифровки, Новый ИсточникДоступныхНастроекКомпоновкиДанных(СхемаКомпоновкиДанных));\r\n    \r\n    ДоступныеДействия = Новый Массив();\r\n    ДоступныеДействия.Добавить(ДействиеОбработкиРасшифровкиКомпоновкиДанных.ОткрытьЗначение);\r\n    ДоступныеДействия.Добавить(ДействиеОбработкиРасшифровкиКомпоновкиДанных.Расшифровать);\r\n    ДоступныеДействия.Добавить(ДействиеОбработкиРасшифровкиКомпоновкиДанных.Упорядочить);\r\n    \r\n   // Осуществим выбор действия расшифровки пользователем\r\n \r\n    Настройки = ОбработкаРасшифровки.Выполнить(Расшифровка, ВыполненноеДействие, ДоступныеДействия);\r\n    \r\n    Если Настройки <> Неопределено Тогда\r\n       // Пользователь выбрал действие, для которого нужно менять настройки\r\n \r\n\r\n        Если ВыполненноеДействие = ДействиеОбработкиРасшифровкиКомпоновкиДанных.Упорядочить Тогда\r\n            \r\n            ФормированиеПечатныхФорм.ПеренестиПорядокВОтчет(Настройки);\r\n            \r\n           // Если требется упорядочить - упорядочим в текущем отчете\r\n \r\n            КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);\r\n            СкомпоноватьРезультат(ЭлементыФормы.Результат, ДанныеРасшифровки);\r\n\r\n\r\n        Иначе\r\n            \r\n             // При других действиях - создадим новый отчет, откроем форму, сформируем отчет в ней\r\n \r\n            Отчет = Отчеты[Метаданные().Имя].Создать();\r\n            Отчет.КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);\r\n            Форма = Отчет.ПолучитьФорму();\r\n            Форма.ОбновитьОтчет();\r\n            Форма.Открыть();\r\n\r\n        КонецЕсли;\r\n\tКонецЕсли;\r\nКонецПроцедуры\n\nПроцедура РезультатОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка)\r\n   Перем ВыполненноеДействие;\r\n\r\n   // Запретим стандартную обработку расшифровки\r\n \r\n    СтандартнаяОбработка = Ложь;\r\n\r\n   // Создадим и инициализируем обработчик расшифровки\r\n \r\n    ОбработкаРасшифровки = Новый ОбработкаРасшифровкиКомпоновкиДанных(ДанныеРасшифровки, Новый ИсточникДоступныхНастроекКомпоновкиДанных(СхемаКомпоновкиДанных));\r\n    \r\n    ДоступныеДействия = Новый Массив();\r\n    ДоступныеДействия.Добавить(ДействиеОбработкиРасшифровкиКомпоновкиДанных.ОткрытьЗначение);\r\n    ДоступныеДействия.Добавить(ДействиеОбработкиРасшифровкиКомпоновкиДанных.Расшифровать);\r\n    ДоступныеДействия.Добавить(ДействиеОбработкиРасшифровкиКомпоновкиДанных.Упорядочить);\r\n    \r\n   // Осуществим выбор действия расшифровки пользователем\r\n \r\n    Настройки = ОбработкаРасшифровки.Выполнить(Расшифровка, ВыполненноеДействие, ДоступныеДействия);\r\n    \r\n    Если Настройки <> Неопределено Тогда\r\n       // Пользователь выбрал действие, для которого нужно менять настройки\r\n \r\n\r\n        Если ВыполненноеДействие = ДействиеОбработкиРасшифровкиКомпоновкиДанных.Упорядочить Тогда\r\n            \r\n            ФормированиеПечатныхФорм.ПеренестиПорядокВОтчет(Настройки);\r\n            \r\n           // Если требется упорядочить - упорядочим в текущем отчете\r\n \r\n            КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);\r\n            СкомпоноватьРезультат(ЭлементыФормы.Результат, ДанныеРасшифровки);\r\n\r\n\r\n        Иначе\r\n            \r\n             // При других действиях - создадим новый отчет, откроем форму, сформируем отчет в ней\r\n \r\n            Отчет = Отчеты[Метаданные().Имя].Создать();\r\n            Отчет.КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);\r\n            Форма = Отчет.ПолучитьФорму();\r\n            Форма.ОбновитьОтчет();\r\n            Форма.Открыть();\r\n\r\n        КонецЕсли;\r\n\tКонецЕсли;\r\nКонецПроцедуры\n\nОрфографическая ошибка в требется: требется"
  },
  {
    "title": "Пауза",
    "description": "Пауза",
    "code_snippet": "Функция Ожидать(ВремяОжиданияВСекундах) Экспорт\r\n    \r\n    Если ВремяОжиданияВСекундах<> 0 Тогда\r\n        \r\n        НастройкиПрокси = Новый ИнтернетПрокси(Ложь);\r\n        НастройкиПрокси.НеИспользоватьПроксиДляЛокальныхАдресов = Истина;\r\n        НастройкиПрокси.НеИспользоватьПроксиДляАдресов.Добавить(\"127.0.0.0\");\r\n        \r\n        Попытка\r\n            Замыкание = Новый HTTPСоединение(\r\n                \"127.0.0.0\",,,,НастройкиПрокси,\r\n                ВремяОжиданияВСекундах);\r\n            Замыкание.Получить(Новый HTTPЗапрос());\r\n        Исключение\r\n            Возврат Неопределено;\r\n        КонецПопытки;\r\n        \r\n    КонецЕсли;\r\n    \r\nКонецФункции\n\nФункция Ожидать(ВремяОжиданияВСекундах) Экспорт\r\n    \r\n    Если ВремяОжиданияВСекундах<> 0 Тогда\r\n        \r\n        НастройкиПрокси = Новый ИнтернетПрокси(Ложь);\r\n        НастройкиПрокси.НеИспользоватьПроксиДляЛокальныхАдресов = Истина;\r\n        НастройкиПрокси.НеИспользоватьПроксиДляАдресов.Добавить(\"127.0.0.0\");\r\n        \r\n        Попытка\r\n            Замыкание = Новый HTTPСоединение(\r\n                \"127.0.0.0\",,,,НастройкиПрокси,\r\n                ВремяОжиданияВСекундах);\r\n            Замыкание.Получить(Новый HTTPЗапрос());\r\n        Исключение\r\n            Возврат Неопределено;\r\n        КонецПопытки;\r\n        \r\n    КонецЕсли;\r\n    \r\nКонецФункции\n\n{1} Не все части функции возвращают значение\n\nДатаОкончания = ТекущаяДата() + ВремяОжиданияВСекундах;\n \n Пока ТекущаяДата() < ДатаОкончания Цикл\n\t \n КонецЦикла;\n\nФункция Ожидать(ВремяОжидания) Экспорт\n    ТекВремя = ТекущаяДата();\n\tПока ТекущаяДата() < ТекВремя + ВремяОжидания Цикл\n\t   ОжидатьДо20(ВремяОжидания-(ТекущаяДата()-ТекВремя));\n    КонецЦикла;\n    Возврат Истина;\nКонецФункции\n\nФункция ОжидатьДо20(ВремяОжидания) \n    \n    Если ВремяОжидания <> 0 Тогда\n        \n        НастройкиПрокси = Новый ИнтернетПрокси(Ложь);\n        НастройкиПрокси.НеИспользоватьПроксиДляЛокальныхАдресов = Истина;\n        НастройкиПрокси.НеИспользоватьПроксиДляАдресов.Добавить(\"127.0.0.0\");\n        \n        Попытка\n            Loopback = Новый HTTPСоединение(\n                \"127.0.0.0\",,,,НастройкиПрокси,\n                ВремяОжидания);\n            Loopback.Получить(Новый HTTPЗапрос());\n\t\t\tВозврат Истина;\n        Исключение\n            Возврат Ложь;\n        КонецПопытки;\n        \n    КонецЕсли;\n    \nКонецФункции"
  },
  {
    "title": "Сократить лидирующие нули",
    "description": "Сократить лидирующие нули",
    "code_snippet": "Функция УбратьЛидирующиеНули(СокращаемаяСтрока)\r\n\r\n\t\tВозврат СтрЗаменить(СокрЛ(СтрЗаменить(СокращаемаяСтрока,\"0\",\" \")),\" \",\"0\");\r\n\r\nКонецФункции\n\nФункция УбратьЛидирующиеНули(СокращаемаяСтрока)\r\n\r\n\t\tВозврат СтрЗаменить(СокрЛ(СтрЗаменить(СокращаемаяСтрока,\"0\",\" \")),\" \",\"0\");\r\n\r\nКонецФункции"
  },
  {
    "title": "Есть реквизит у объекта",
    "description": "Есть реквизит у объекта",
    "code_snippet": "Функция ЕстьРеквизитУОбъекта(Объект, ИмяРеквизита) Экспорт\r\n\t\r\n\tСлучайноеЗначение= Новый УникальныйИдентификатор();\r\n    Буфер = Новый Структура(ИмяРеквизита, СлучайноеЗначение);\r\n    ЗаполнитьЗначенияСвойств(Буфер, Объект);\r\n    Возврат Буфер[ИмяРеквизита] <> СлучайноеЗначение;\r\n\t\r\nКонецФункции\n\nФункция ЕстьРеквизитУОбъекта(Объект, ИмяРеквизита) Экспорт\r\n\t\r\n\tСлучайноеЗначение= Новый УникальныйИдентификатор();\r\n    Буфер = Новый Структура(ИмяРеквизита, СлучайноеЗначение);\r\n    ЗаполнитьЗначенияСвойств(Буфер, Объект);\r\n    Возврат Буфер[ИмяРеквизита] <> СлучайноеЗначение;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Убрать лишние символы из строки",
    "description": "Убрать лишние символы из строки",
    "code_snippet": "Функция УбратьЛишниеСимволыИзСтроки(Строка) Экспорт\r\n\tРезультирующаяСтрока = \"\";\r\n\tДля н = 1 По СтрДлина(Строка) Цикл\r\n\t\tЕсли (КодСимвола(Строка, н) >= 48 И КодСимвола(Строка, н) <= 57)\r\n\t\t\tИЛИ (КодСимвола(Строка, н) >= 65 И КодСимвола(Строка, н) <= 90)\r\n\t\t\tИЛИ (КодСимвола(Строка, н) >= 97 И КодСимвола(Строка, н) <= 122)\r\n\t\t\tИЛИ (КодСимвола(Строка, н) >= 1040 И КодСимвола(Строка, н) <= 1103) Тогда\r\n\t\t\tРезультирующаяСтрока = РезультирующаяСтрока + Сред(Строка, н, 1);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tВозврат РезультирующаяСтрока;\r\nКонецФункции\n\nФункция УбратьЛишниеСимволыИзСтроки(Строка) Экспорт\r\n\tРезультирующаяСтрока = \"\";\r\n\tДля н = 1 По СтрДлина(Строка) Цикл\r\n\t\tЕсли (КодСимвола(Строка, н) >= 48 И КодСимвола(Строка, н) <= 57)\r\n\t\t\tИЛИ (КодСимвола(Строка, н) >= 65 И КодСимвола(Строка, н) <= 90)\r\n\t\t\tИЛИ (КодСимвола(Строка, н) >= 97 И КодСимвола(Строка, н) <= 122)\r\n\t\t\tИЛИ (КодСимвола(Строка, н) >= 1040 И КодСимвола(Строка, н) <= 1103) Тогда\r\n\t\t\tРезультирующаяСтрока = РезультирующаяСтрока + Сред(Строка, н, 1);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tВозврат РезультирующаяСтрока;\r\nКонецФункции"
  },
  {
    "title": "slack",
    "description": "Slack для oscript",
    "code_snippet": ""
  },
  {
    "title": "Загрузка данных из Excel",
    "description": "Загрузка данных из Excel",
    "code_snippet": "&НаСервере\r\nФункция ПолучитьТЗДляНестандарта()\r\n\tРезультат = Новый ТаблицаЗначений;\r\n\tРезультат.Колонки.Добавить(\"Артикул\", Новый ОписаниеТипов(\"Строка\", ,Новый КвалификаторыСтроки(0, ДопустимаяДлина.Переменная)));\r\n\tРезультат.Колонки.Добавить(\"Номенклатура\", Новый ОписаниеТипов(\"Строка\", ,Новый КвалификаторыСтроки(0, ДопустимаяДлина.Переменная)));\r\n\tРезультат.Колонки.Добавить(\"Характеристика\", Новый ОписаниеТипов(\"Строка\", ,Новый КвалификаторыСтроки(0, ДопустимаяДлина.Переменная)));\r\n\tРезультат.Колонки.Добавить(\"Количество\", Новый ОписаниеТипов(\"Число\",Новый КвалификаторыЧисла(0, 0, ДопустимыйЗнак.Любой)));\r\n\tРезультат.Колонки.Добавить(\"ЕдИзм\", Новый ОписаниеТипов(\"Строка\", ,Новый КвалификаторыСтроки(0, ДопустимаяДлина.Переменная)));\r\n\tРезультат.Колонки.Добавить(\"Цена\", Новый ОписаниеТипов(\"Число\",Новый КвалификаторыЧисла(0, 0, ДопустимыйЗнак.Любой)));\r\n\tРезультат.Колонки.Добавить(\"Сумма\", Новый ОписаниеТипов(\"Число\",Новый КвалификаторыЧисла(0, 0, ДопустимыйЗнак.Любой)));\r\n\tВозврат Результат;\r\nКонецФункции\r\n\r\n&НаКлиенте\r\nПроцедура Расш1_ЮКОЗ_ЗагрузитьНестандартПосле(Команда)\r\n\t\r\n\tРезультат = ПолучитьТЗДляНестандарта();\r\n\t\r\n\tРежим = РежимДиалогаВыбораФайла.Открытие; \r\n\tДиалогОткрытияФайла = Новый ДиалогВыбораФайла(Режим); \r\n\tДиалогОткрытияФайла.ПолноеИмяФайла = \"\"; \r\n\tФильтр = \"Excel файлы(*.xls;*.xlsx)|*.xls;*.xlsx\"; \r\n\tДиалогОткрытияФайла.Фильтр = Фильтр; \r\n\tДиалогОткрытияФайла.МножественныйВыбор = Ложь; \r\n\tДиалогОткрытияФайла.Заголовок = \"Выберите файл\"; \r\n\t\r\n\tЕсли ДиалогОткрытияФайла.Выбрать() Тогда \r\n\t\t\r\n\t\tПопытка\r\n\t\t\tЭксель = Новый COMОбъект(\"Excel.Application\");\r\n\t\tИсключение\r\n\t\t\tСообщить(ОписаниеОшибки() + \" Программа Exсel не установлена на данном компьютере!\"); \r\n\t\t\tВозврат;\r\n\t\tКонецПопытки;\r\n\t\t\r\n\t\tКнига = Эксель.WorkBooks.Open(ДиалогОткрытияФайла.ПолноеИмяФайла);\r\n\t\tЛист = Книга.WorkSheets(1);\r\n\t\t\r\n\t\tНомерСтроки = 2;\r\n\t\t\t\t\r\n\t\tПока НЕ ПустаяСтрока(Лист.Cells(НомерСтроки, 1).Value) Цикл\r\n\t\t\t\r\n\t\t\tНоваяСтрока = Результат.Добавить();\r\n\t\t\tНоваяСтрока.Артикул\t= СокрЛП(Лист.Cells(НомерСтроки,1).Value);\r\n\t\t\tНоваяСтрока.Номенклатура\t= СокрЛП(Лист.Cells(НомерСтроки,2).Value);\r\n\t\t\tНоваяСтрока.Характеристика\t= СокрЛП(Лист.Cells(НомерСтроки,3).Value);\r\n\t\t\tНоваяСтрока.Количество\t= СокрЛП(Лист.Cells(НомерСтроки,4).Value);\r\n\t\t\tНоваяСтрока.ЕдИзм\t= СокрЛП(Лист.Cells(НомерСтроки,5).Value);\r\n\t\t\tНоваяСтрока.Цена\t= СокрЛП(Лист.Cells(НомерСтроки,6).Value);\r\n\t\t\tНоваяСтрока.Сумма\t= СокрЛП(Лист.Cells(НомерСтроки,7).Value);\r\n\t\t\t\r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(НоваяСтрока.Номенклатура) Тогда\r\n\t\t\t\tВызватьИсключение \"В строке №\" + НомерСтроки + \" не заполнено наимевание номенклатуры. Загрузка прервана!\";\t\r\n\t\t\t\tВозврат;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tНомерСтроки = НомерСтроки + 1;\r\n\t\t\t\r\n\t\tКонецЦикла;\t\r\n\t\t\r\n\t\tЭксель.Application.Quit();\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\r\nФункция ПолучитьТЗДляНестандарта()\r\n\tРезультат = Новый ТаблицаЗначений;\r\n\tРезультат.Колонки.Добавить(\"Артикул\", Новый ОписаниеТипов(\"Строка\", ,Новый КвалификаторыСтроки(0, ДопустимаяДлина.Переменная)));\r\n\tРезультат.Колонки.Добавить(\"Номенклатура\", Новый ОписаниеТипов(\"Строка\", ,Новый КвалификаторыСтроки(0, ДопустимаяДлина.Переменная)));\r\n\tРезультат.Колонки.Добавить(\"Характеристика\", Новый ОписаниеТипов(\"Строка\", ,Новый КвалификаторыСтроки(0, ДопустимаяДлина.Переменная)));\r\n\tРезультат.Колонки.Добавить(\"Количество\", Новый ОписаниеТипов(\"Число\",Новый КвалификаторыЧисла(0, 0, ДопустимыйЗнак.Любой)));\r\n\tРезультат.Колонки.Добавить(\"ЕдИзм\", Новый ОписаниеТипов(\"Строка\", ,Новый КвалификаторыСтроки(0, ДопустимаяДлина.Переменная)));\r\n\tРезультат.Колонки.Добавить(\"Цена\", Новый ОписаниеТипов(\"Число\",Новый КвалификаторыЧисла(0, 0, ДопустимыйЗнак.Любой)));\r\n\tРезультат.Колонки.Добавить(\"Сумма\", Новый ОписаниеТипов(\"Число\",Новый КвалификаторыЧисла(0, 0, ДопустимыйЗнак.Любой)));\r\n\tВозврат Результат;\r\nКонецФункции\r\n\r\n&НаКлиенте\r\nПроцедура Расш1_ЮКОЗ_ЗагрузитьНестандартПосле(Команда)\r\n\t\r\n\tРезультат = ПолучитьТЗДляНестандарта();\r\n\t\r\n\tРежим = РежимДиалогаВыбораФайла.Открытие; \r\n\tДиалогОткрытияФайла = Новый ДиалогВыбораФайла(Режим); \r\n\tДиалогОткрытияФайла.ПолноеИмяФайла = \"\"; \r\n\tФильтр = \"Excel файлы(*.xls;*.xlsx)|*.xls;*.xlsx\"; \r\n\tДиалогОткрытияФайла.Фильтр = Фильтр; \r\n\tДиалогОткрытияФайла.МножественныйВыбор = Ложь; \r\n\tДиалогОткрытияФайла.Заголовок = \"Выберите файл\"; \r\n\t\r\n\tЕсли ДиалогОткрытияФайла.Выбрать() Тогда \r\n\t\t\r\n\t\tПопытка\r\n\t\t\tЭксель = Новый COMОбъект(\"Excel.Application\");\r\n\t\tИсключение\r\n\t\t\tСообщить(ОписаниеОшибки() + \" Программа Exсel не установлена на данном компьютере!\"); \r\n\t\t\tВозврат;\r\n\t\tКонецПопытки;\r\n\t\t\r\n\t\tКнига = Эксель.WorkBooks.Open(ДиалогОткрытияФайла.ПолноеИмяФайла);\r\n\t\tЛист = Книга.WorkSheets(1);\r\n\t\t\r\n\t\tНомерСтроки = 2;\r\n\t\t\t\t\r\n\t\tПока НЕ ПустаяСтрока(Лист.Cells(НомерСтроки, 1).Value) Цикл\r\n\t\t\t\r\n\t\t\tНоваяСтрока = Результат.Добавить();\r\n\t\t\tНоваяСтрока.Артикул\t= СокрЛП(Лист.Cells(НомерСтроки,1).Value);\r\n\t\t\tНоваяСтрока.Номенклатура\t= СокрЛП(Лист.Cells(НомерСтроки,2).Value);\r\n\t\t\tНоваяСтрока.Характеристика\t= СокрЛП(Лист.Cells(НомерСтроки,3).Value);\r\n\t\t\tНоваяСтрока.Количество\t= СокрЛП(Лист.Cells(НомерСтроки,4).Value);\r\n\t\t\tНоваяСтрока.ЕдИзм\t= СокрЛП(Лист.Cells(НомерСтроки,5).Value);\r\n\t\t\tНоваяСтрока.Цена\t= СокрЛП(Лист.Cells(НомерСтроки,6).Value);\r\n\t\t\tНоваяСтрока.Сумма\t= СокрЛП(Лист.Cells(НомерСтроки,7).Value);\r\n\t\t\t\r\n\t\t\tЕсли НЕ ЗначениеЗаполнено(НоваяСтрока.Номенклатура) Тогда\r\n\t\t\t\tВызватьИсключение \"В строке №\" + НомерСтроки + \" не заполнено наимевание номенклатуры. Загрузка прервана!\";\t\r\n\t\t\t\tВозврат;\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tНомерСтроки = НомерСтроки + 1;\r\n\t\t\t\r\n\t\tКонецЦикла;\t\r\n\t\t\r\n\t\tЭксель.Application.Quit();\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\n{54} Обнаружен недостижимый участок кода\r\nОрфографическая ошибка в ПолучитьТЗДляНестандарта (найдено 2): Нестандарта\r\nОрфографическая ошибка в Расш1_ЮКОЗ_ЗагрузитьНестандартПосле: Нестандарт\r\nОрфографическая ошибка в Эксель (найдено 3): Эксель\r\nОрфографическая ошибка в Exсel: Exсel\r\nОрфографическая ошибка в наимевание: наимевание"
  },
  {
    "title": "Обновлятор-1С: групповое (пакетное) обновление и обслуживание всех баз за один раз",
    "description": "Быстрое и надежное обновление файловых и серверных баз, защита от шифровальщиков, автоматическое обновление доработанных конфигураций  и расширений, а также многое другое.",
    "code_snippet": ""
  },
  {
    "title": "Вставка рисунка в табличный документ без изменения макета",
    "description": "Вставка рисунка в табличный документ без изменения макета",
    "code_snippet": "Рисунок = Шапка.Рисунки.Добавить(ТипРисункаТабличногоДокумента.Картинка);\r\nРисунок.Верх = 4;\r\nРисунок.Высота = 22;\r\nРисунок.Ширина = 95;\r\nРисунок.Лево = 45;\r\nРисунок.Линия = Новый Линия(ТипЛинииРисункаТабличногоДокумента.НетЛинии,-1);\r\nКарт = БиблиотекаКартинок.ВашаКартинка;\r\nРисунок.Картинка = Карт;\n\nРисунок = Шапка.Рисунки.Добавить(ТипРисункаТабличногоДокумента.Картинка);\r\nРисунок.Верх = 4;\r\nРисунок.Высота = 22;\r\nРисунок.Ширина = 95;\r\nРисунок.Лево = 45;\r\nРисунок.Линия = Новый Линия(ТипЛинииРисункаТабличногоДокумента.НетЛинии,-1);\r\nКарт = БиблиотекаКартинок.ВашаКартинка;\r\nРисунок.Картинка = Карт;"
  },
  {
    "title": "Удалить элемент массива",
    "description": "Удалить элемент массива",
    "code_snippet": "ОбщегоНазначенияКлиентСервер.УдалитьЗначениеИзМассива(ВидыВремениВЗачетНормыСуммированногоУчета, ОбщегоНазначенияКлиентСервер.ПредопределенныйЭлемент(\"Справочник.ВидыИспользованияРабочегоВремени.НеявкиПоНевыясненнымПричинам\"));\n\nОбщегоНазначенияКлиентСервер.УдалитьЗначениеИзМассива(ВидыВремениВЗачетНормыСуммированногоУчета, ОбщегоНазначенияКлиентСервер.ПредопределенныйЭлемент(\"Справочник.ВидыИспользованияРабочегоВремени.НеявкиПоНевыясненнымПричинам\"));"
  },
  {
    "title": "Структура отчета СКД",
    "description": "Структура отчета СКД",
    "code_snippet": "ТекНастройкиКомпоновщика =КомпоновщикНастроек.Настройки;\r\nТекНастройкиКомпоновщика.Структура.Очистить();\r\n\r\n //добавить группировку\r\n \r\n\r\nГруппировкаПоСкладу = ТекНастройкиКомпоновщика.Структура.Добавить(Тип(\"ГруппировкаКомпоновкиДанных\"));\r\nГруппировкаПоСкладу.Имя = \"Склад\";\r\nГруппировкаПоСкладу.Использование = Истина;\r\n\r\n //созданная группировка по полю \"Склад\"\r\n \r\nПолеГруппировкиСклад = ГруппировкаПоСкладу.ПоляГруппировки.Элементы.Добавить(Тип(\"ПолеГруппировкиКомпоновкиДанных\"));       \r\nПолеГруппировкиСклад.Использование      = Истина;\r\nПолеГруппировкиСклад.Поле               = Новый ПолеКомпоновкиДанных(\"Склад\");\r\nПолеГруппировкиСклад.ТипГруппировки = ТипГруппировкиКомпоновкиДанных.Иерархия;\r\nПолеГруппировкиСклад.ТипДополнения      = ТипДополненияПериодаКомпоновкиДанных.БезДополнения;\r\n\r\n //добавить выводимые поля в группировке: склад и количество остаток для данной группировки\r\n \r\nВыбранноеПоле = ГруппировкаПоСкладу.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));     \r\nВыбранноеПоле.Поле = Новый ПолеКомпоновкиДанных(\"Склад\");\r\nВыбранноеПоле = ГруппировкаПоСкладу.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));     \r\nВыбранноеПоле.Поле = Новый ПолеКомпоновкиДанных(\"КоличествоОстаток\");\r\n\r\n //добавим детальные записи как подгруппу в \"Склад\". Все отличие только в том, что нет группировки\r\n \r\nДетальныеЗаписи = ГруппировкаПоСкладу.Структура.Добавить(Тип(\"ГруппировкаКомпоновкиДанных\"));\r\nДетальныеЗаписи.Имя = \"Детальные\";\r\nДетальныеЗаписи.Использование = Истина;\r\n //добавить выводимые поля в детальных записях: Номенклатуру и количество остаток \r\n \r\nВыбранноеПоле = ДетальныеЗаписи.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));   \r\nВыбранноеПоле.Поле = Новый ПолеКомпоновкиДанных(\"Номенклатура\");\r\nВыбранноеПоле = ДетальныеЗаписи.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));   \r\nВыбранноеПоле.Поле = Новый ПолеКомпоновкиДанных(\"КоличествоОстаток\");\n\nТекНастройкиКомпоновщика =КомпоновщикНастроек.Настройки;\r\nТекНастройкиКомпоновщика.Структура.Очистить();\r\n\r\n //добавить группировку\r\n \r\n\r\nГруппировкаПоСкладу = ТекНастройкиКомпоновщика.Структура.Добавить(Тип(\"ГруппировкаКомпоновкиДанных\"));\r\nГруппировкаПоСкладу.Имя = \"Склад\";\r\nГруппировкаПоСкладу.Использование = Истина;\r\n\r\n //созданная группировка по полю \"Склад\"\r\n \r\nПолеГруппировкиСклад = ГруппировкаПоСкладу.ПоляГруппировки.Элементы.Добавить(Тип(\"ПолеГруппировкиКомпоновкиДанных\"));       \r\nПолеГруппировкиСклад.Использование      = Истина;\r\nПолеГруппировкиСклад.Поле               = Новый ПолеКомпоновкиДанных(\"Склад\");\r\nПолеГруппировкиСклад.ТипГруппировки = ТипГруппировкиКомпоновкиДанных.Иерархия;\r\nПолеГруппировкиСклад.ТипДополнения      = ТипДополненияПериодаКомпоновкиДанных.БезДополнения;\r\n\r\n //добавить выводимые поля в группировке: склад и количество остаток для данной группировки\r\n \r\nВыбранноеПоле = ГруппировкаПоСкладу.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));     \r\nВыбранноеПоле.Поле = Новый ПолеКомпоновкиДанных(\"Склад\");\r\nВыбранноеПоле = ГруппировкаПоСкладу.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));     \r\nВыбранноеПоле.Поле = Новый ПолеКомпоновкиДанных(\"КоличествоОстаток\");\r\n\r\n //добавим детальные записи как подгруппу в \"Склад\". Все отличие только в том, что нет группировки\r\n \r\nДетальныеЗаписи = ГруппировкаПоСкладу.Структура.Добавить(Тип(\"ГруппировкаКомпоновкиДанных\"));\r\nДетальныеЗаписи.Имя = \"Детальные\";\r\nДетальныеЗаписи.Использование = Истина;\r\n //добавить выводимые поля в детальных записях: Номенклатуру и количество остаток \r\n \r\nВыбранноеПоле = ДетальныеЗаписи.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));   \r\nВыбранноеПоле.Поле = Новый ПолеКомпоновкиДанных(\"Номенклатура\");\r\nВыбранноеПоле = ДетальныеЗаписи.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));   \r\nВыбранноеПоле.Поле = Новый ПолеКомпоновкиДанных(\"КоличествоОстаток\");"
  },
  {
    "title": "os-amazonmws",
    "description": "Взаимодействие с API Amazon MWS",
    "code_snippet": ""
  },
  {
    "title": "ТаблицаЗначенийВТаблицуХТМЛ",
    "description": "ТаблицаЗначенийВТаблицуХТМЛ",
    "code_snippet": "Функция ТаблицаЗначенийВТаблицуХТМЛ(ТабЗначений,СтруктураПараметрыТаблицыХТМЛ = Неопределено) Экспорт\r\n\t\r\n\t//СтруктураПараметрыТаблицыХТМЛ\r\n\t//\r\n\t//Общие параметры:\r\n\t//СтруктураПараметрыТаблицыХТМЛ.ШиринаТаблицы - общая ширина таблица\r\n\t//СтруктураПараметрыТаблицыХТМЛ.ЦветШапки - цвет шапки таблицы пример \"eadbaf\"\r\n\t//СтруктураПараметрыТаблицыХТМЛ.ПунктПорядкуИспользуется - по умолчанию ЛОЖЬ\r\n\t//\r\n\t//Индивиуальные для каждой колонки:\r\n\t//СтруктураПараметрыТаблицыХТМЛ.Заголовок1 - заголовок для первой колонки, цифра на конце обознает номер колонки (не с нуля)\r\n\t//СтруктураПараметрыТаблицыХТМЛ.Ширина1 - ширина для первой колонки, цифра на конце обознает номер колонки (не с нуля)\r\n\t//СтруктураПараметрыТаблицыХТМЛ.Положение1 - отвечает за положение текста в колонке (по умол. лево), передовать \"center\" или \"right\"\r\n\t\r\n\t//ТабЗначений = Новый ТаблицаЗначений;\r\n\tМассивИменКолонок = Новый Массив;\r\n\t\r\n\tЕсли ТипЗнч(СтруктураПараметрыТаблицыХТМЛ) <> Тип(\"Структура\") Тогда\r\n\t\tСтруктураПараметрыТаблицыХТМЛ = Новый Структура;\r\n\tКонецЕсли;\r\n\t\t\t\t\r\n\tКоличествоКолонок = ТабЗначений.Колонки.Количество();\r\n\tПунктПорядкуИспользуется = ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(\"ПунктПорядкуИспользуется\"),СтруктураПараметрыТаблицыХТМЛ.ПунктПорядкуИспользуется,ЛОЖЬ);\t\r\n\t\r\n\tЕсли КоличествоКолонок < 0 Тогда\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\t\t\r\n\tЦветШапки = ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(\"ЦветШапки\"),\" bgcolor=\"\"#\" + СтруктураПараметрыТаблицыХТМЛ.ЦветШапки + \"\"\"\",\"\");\r\n\tШиринаТаблицы = ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(\"ШиринаТаблицы\"),\" style=\"\"width:\" + СтруктураПараметрыТаблицыХТМЛ.ШиринаТаблицы + \"px\"\"\",\"\"); \r\n\tТаблицаХТМЛ = \"<table border=\"\"1\"\" cellpadding=\"\"1\"\" cellspacing=\"\"0\"\" \" + ШиринаТаблицы + \">\r\n\t\t\t\t|<tbody>\r\n\t\t\t\t|<tr>\";\r\n\t\r\n\t//Первым выводим столбик П/П если он задан в шапку\r\n\tЕсли ПунктПорядкуИспользуется Тогда\r\n\t\tТаблицаХТМЛ = ТаблицаХТМЛ + \"\r\n\t\t\t\t|<td\" + ЦветШапки + \" style=\"\"width:30px\"\" align=\"\"center\"\">п/п</td>\";\t\r\n\tКонецЕсли;\r\n\t\r\n\t//Формируем шапку\r\n\tДля Счетчик = 1 по КоличествоКолонок Цикл\r\n\t\tИмяСвойстваШирина = \"Ширина\" + Счетчик;\r\n\t\tШиринаСтолбца = ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(ИмяСвойстваШирина),\" style=\"\"width:\" + СтруктураПараметрыТаблицыХТМЛ[ИмяСвойстваШирина] + \"px\"\"\",\"\");\r\n\t\tИмяКолонки = ТабЗначений.Колонки[Счетчик-1].Имя;\r\n\t\tИмяСвойстваЗаголовок = \"Заголовок\" + Счетчик;\r\n\t\tЗаголовокКолонки = ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(ИмяСвойстваЗаголовок),СтруктураПараметрыТаблицыХТМЛ[ИмяСвойстваЗаголовок],ИмяКолонки);\r\n\t\tТаблицаХТМЛ = ТаблицаХТМЛ + \" \r\n\t\t\t\t|<td\" + ЦветШапки + ШиринаСтолбца + \" align=\"\"center\"\">\" + ЗаголовокКолонки + \"</td>\";\t\r\n\t\tМассивИменКолонок.Добавить(ИмяКолонки);\r\n\tКонецЦикла;\r\n\tТаблицаХТМЛ = ТаблицаХТМЛ + \"\r\n\t\t\t\t|</tr>\";\r\n\t\r\n\t//Заполняем таблицу\t\r\n\tПунктПорядку = 0;\r\n\tДля каждого СтрокаТаблицы Из ТабЗначений Цикл\r\n\t\tПунктПорядку = ПунктПорядку + 1;\r\n\t\tТаблицаХТМЛ = ТаблицаХТМЛ + \"\r\n\t\t\t\t|<tr>\" + ?(ПунктПорядкуИспользуется, Символы.ПС + \"<td align=\"\"center\"\">\" + ПунктПорядку + \"</td>\",\"\") + \"\";\r\n\t\tДля Счетчик = 0 по КоличествоКолонок - 1 Цикл\r\n\t\t\tИмяСвойстваПоложение = \"Положение\" + Строка(Счетчик + 1);\r\n\t\t\tПоложение = \" align=\"\"\" + ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(ИмяСвойстваПоложение),СтруктураПараметрыТаблицыХТМЛ[ИмяСвойстваПоложение],\"left\") + \"\"\"\";\r\n\t\t\tТаблицаХТМЛ = ТаблицаХТМЛ + \"\r\n\t\t\t\t|<td \" + Положение + \">\" + СтрокаТаблицы[МассивИменКолонок[Счетчик]] + \"</td>\";\t\t\t\r\n\t\tКонецЦикла;\t\t\t\t\r\n\t\tТаблицаХТМЛ = ТаблицаХТМЛ + \"\r\n\t\t\t\t|</tr>\";\r\n\tКонецЦикла;\t\r\n\t\r\n\tТаблицаХТМЛ = ТаблицаХТМЛ + \" \r\n\t\t\t\t|</tbody>\r\n\t\t\t\t|</table>\";\r\n\t\r\n\tВозврат ТаблицаХТМЛ;\r\n\r\nКонецФункции\n\nФункция ТаблицаЗначенийВТаблицуХТМЛ(ТабЗначений,СтруктураПараметрыТаблицыХТМЛ = Неопределено) Экспорт\r\n\t\r\n\t//СтруктураПараметрыТаблицыХТМЛ\r\n\t//\r\n\t//Общие параметры:\r\n\t//СтруктураПараметрыТаблицыХТМЛ.ШиринаТаблицы - общая ширина таблица\r\n\t//СтруктураПараметрыТаблицыХТМЛ.ЦветШапки - цвет шапки таблицы пример \"eadbaf\"\r\n\t//СтруктураПараметрыТаблицыХТМЛ.ПунктПорядкуИспользуется - по умолчанию ЛОЖЬ\r\n\t//\r\n\t//Индивиуальные для каждой колонки:\r\n\t//СтруктураПараметрыТаблицыХТМЛ.Заголовок1 - заголовок для первой колонки, цифра на конце обознает номер колонки (не с нуля)\r\n\t//СтруктураПараметрыТаблицыХТМЛ.Ширина1 - ширина для первой колонки, цифра на конце обознает номер колонки (не с нуля)\r\n\t//СтруктураПараметрыТаблицыХТМЛ.Положение1 - отвечает за положение текста в колонке (по умол. лево), передовать \"center\" или \"right\"\r\n\t\r\n\t//ТабЗначений = Новый ТаблицаЗначений;\r\n\tМассивИменКолонок = Новый Массив;\r\n\t\r\n\tЕсли ТипЗнч(СтруктураПараметрыТаблицыХТМЛ) <> Тип(\"Структура\") Тогда\r\n\t\tСтруктураПараметрыТаблицыХТМЛ = Новый Структура;\r\n\tКонецЕсли;\r\n\t\t\t\t\r\n\tКоличествоКолонок = ТабЗначений.Колонки.Количество();\r\n\tПунктПорядкуИспользуется = ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(\"ПунктПорядкуИспользуется\"),СтруктураПараметрыТаблицыХТМЛ.ПунктПорядкуИспользуется,ЛОЖЬ);\t\r\n\t\r\n\tЕсли КоличествоКолонок < 0 Тогда\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\t\t\r\n\tЦветШапки = ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(\"ЦветШапки\"),\" bgcolor=\"\"#\" + СтруктураПараметрыТаблицыХТМЛ.ЦветШапки + \"\"\"\",\"\");\r\n\tШиринаТаблицы = ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(\"ШиринаТаблицы\"),\" style=\"\"width:\" + СтруктураПараметрыТаблицыХТМЛ.ШиринаТаблицы + \"px\"\"\",\"\"); \r\n\tТаблицаХТМЛ = \"<table border=\"\"1\"\" cellpadding=\"\"1\"\" cellspacing=\"\"0\"\" \" + ШиринаТаблицы + \">\r\n\t\t\t\t|<tbody>\r\n\t\t\t\t|<tr>\";\r\n\t\r\n\t//Первым выводим столбик П/П если он задан в шапку\r\n\tЕсли ПунктПорядкуИспользуется Тогда\r\n\t\tТаблицаХТМЛ = ТаблицаХТМЛ + \"\r\n\t\t\t\t|<td\" + ЦветШапки + \" style=\"\"width:30px\"\" align=\"\"center\"\">п/п</td>\";\t\r\n\tКонецЕсли;\r\n\t\r\n\t//Формируем шапку\r\n\tДля Счетчик = 1 по КоличествоКолонок Цикл\r\n\t\tИмяСвойстваШирина = \"Ширина\" + Счетчик;\r\n\t\tШиринаСтолбца = ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(ИмяСвойстваШирина),\" style=\"\"width:\" + СтруктураПараметрыТаблицыХТМЛ[ИмяСвойстваШирина] + \"px\"\"\",\"\");\r\n\t\tИмяКолонки = ТабЗначений.Колонки[Счетчик-1].Имя;\r\n\t\tИмяСвойстваЗаголовок = \"Заголовок\" + Счетчик;\r\n\t\tЗаголовокКолонки = ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(ИмяСвойстваЗаголовок),СтруктураПараметрыТаблицыХТМЛ[ИмяСвойстваЗаголовок],ИмяКолонки);\r\n\t\tТаблицаХТМЛ = ТаблицаХТМЛ + \" \r\n\t\t\t\t|<td\" + ЦветШапки + ШиринаСтолбца + \" align=\"\"center\"\">\" + ЗаголовокКолонки + \"</td>\";\t\r\n\t\tМассивИменКолонок.Добавить(ИмяКолонки);\r\n\tКонецЦикла;\r\n\tТаблицаХТМЛ = ТаблицаХТМЛ + \"\r\n\t\t\t\t|</tr>\";\r\n\t\r\n\t//Заполняем таблицу\t\r\n\tПунктПорядку = 0;\r\n\tДля каждого СтрокаТаблицы Из ТабЗначений Цикл\r\n\t\tПунктПорядку = ПунктПорядку + 1;\r\n\t\tТаблицаХТМЛ = ТаблицаХТМЛ + \"\r\n\t\t\t\t|<tr>\" + ?(ПунктПорядкуИспользуется, Символы.ПС + \"<td align=\"\"center\"\">\" + ПунктПорядку + \"</td>\",\"\") + \"\";\r\n\t\tДля Счетчик = 0 по КоличествоКолонок - 1 Цикл\r\n\t\t\tИмяСвойстваПоложение = \"Положение\" + Строка(Счетчик + 1);\r\n\t\t\tПоложение = \" align=\"\"\" + ?(СтруктураПараметрыТаблицыХТМЛ.Свойство(ИмяСвойстваПоложение),СтруктураПараметрыТаблицыХТМЛ[ИмяСвойстваПоложение],\"left\") + \"\"\"\";\r\n\t\t\tТаблицаХТМЛ = ТаблицаХТМЛ + \"\r\n\t\t\t\t|<td \" + Положение + \">\" + СтрокаТаблицы[МассивИменКолонок[Счетчик]] + \"</td>\";\t\t\t\r\n\t\tКонецЦикла;\t\t\t\t\r\n\t\tТаблицаХТМЛ = ТаблицаХТМЛ + \"\r\n\t\t\t\t|</tr>\";\r\n\tКонецЦикла;\t\r\n\t\r\n\tТаблицаХТМЛ = ТаблицаХТМЛ + \" \r\n\t\t\t\t|</tbody>\r\n\t\t\t\t|</table>\";\r\n\t\r\n\tВозврат ТаблицаХТМЛ;\r\n\r\nКонецФункции\n\nОрфографическая ошибка в eadbaf: eadbaf\r\nОрфографическая ошибка в Индивиуальные: Индивиуальные\r\nОрфографическая ошибка в обознает (найдено 2): обознает\r\nОрфографическая ошибка в передовать: передовать\r\nОрфографическая ошибка в bgcolor: bgcolor\r\nОрфографическая ошибка в cellpadding: cellpadding\r\nОрфографическая ошибка в cellspacing: cellspacing\r\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "swagger",
    "description": "Формирование swagger спецификации на основании метаданных конфигурации 1С.",
    "code_snippet": ""
  },
  {
    "title": "Нетленка 1С - защита конфигураций",
    "description": "Защита конфигураций и обработок 1С 8.3",
    "code_snippet": ""
  },
  {
    "title": "onec-repo-converter",
    "description": "Приложение для конвертирования репозитория 1С с исходниками в формате выгрузки конфигуратора в формат EDT.",
    "code_snippet": ""
  },
  {
    "title": "Записать текст в файл",
    "description": "Записать текст в файл",
    "code_snippet": "&НаКлиенте\r\nПроцедура ЗаписатьТекстовыйФайл(ИмяФайла, Текст)\r\n\t\r\n\tТекстовыйФайл = Новый ТекстовыйДокумент;\r\n \r\n    ТекстовыйФайл.УстановитьТекст(Текст);\r\n\t\r\n\t//ТекстовыйФайл.ДобавитьСтроку(\"\"); \r\n    \r\n    ТекстовыйФайл.Записать(ИмяФайла,\r\n        КодировкаТекста.UTF8\r\n    );\r\n\t\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура ЗаписатьТекстовыйФайл(ИмяФайла, Текст)\r\n\t\r\n\tТекстовыйФайл = Новый ТекстовыйДокумент;\r\n \r\n    ТекстовыйФайл.УстановитьТекст(Текст);\r\n\t\r\n\t//ТекстовыйФайл.ДобавитьСтроку(\"\"); \r\n    \r\n    ТекстовыйФайл.Записать(ИмяФайла,\r\n        КодировкаТекста.UTF8\r\n    );\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Прочитать текст из файла",
    "description": "Прочитать текст из файла",
    "code_snippet": "&НаКлиенте\r\nФункция ПрочитатьТекстовыйФайл(ИмяФайла)\r\n\t\r\n\tТекстовыйФайл = Новый ТекстовыйДокумент;\r\n \r\n    ТекстовыйФайл.Прочитать(ИмяФайла,\r\n        КодировкаТекста.UTF8\r\n    );\r\n\t\r\n\tВозврат ТекстовыйФайл.ПолучитьТекст();\r\n\t\r\nКонецФункции\n\n&НаКлиенте\r\nФункция ПрочитатьТекстовыйФайл(ИмяФайла)\r\n\t\r\n\tТекстовыйФайл = Новый ТекстовыйДокумент;\r\n \r\n    ТекстовыйФайл.Прочитать(ИмяФайла,\r\n        КодировкаТекста.UTF8\r\n    );\r\n\t\r\n\tВозврат ТекстовыйФайл.ПолучитьТекст();\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Запуск внешнего приложения программно",
    "description": "Запуск внешнего приложения программно",
    "code_snippet": "&НаКлиенте\r\nПроцедура КомандаВыполнитьПрограмму(Команда)\r\n\t\r\n\tСтрокаЗапуска = \"C:\\Application.exe\";\r\n\t\r\n\tНачатьЗапускПриложения(Новый ОписаниеОповещения(\"НачатьЗапускПриложенияЗавершение\", ЭтотОбъект), СтрокаЗапуска,, Истина);\r\n\t\r\nКонецПроцедуры  \r\n\r\n&НаКлиенте\r\nПроцедура НачатьЗапускПриложенияЗавершение(КодВозврата, ДополнительныеПараметры) Экспорт \r\n    \r\n    //Вставить обработку завершения выполнения\r\n    \r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура КомандаВыполнитьПрограмму(Команда)\r\n\t\r\n\tСтрокаЗапуска = \"C:\\Application.exe\";\r\n\t\r\n\tНачатьЗапускПриложения(Новый ОписаниеОповещения(\"НачатьЗапускПриложенияЗавершение\", ЭтотОбъект), СтрокаЗапуска,, Истина);\r\n\t\r\nКонецПроцедуры  \r\n\r\n&НаКлиенте\r\nПроцедура НачатьЗапускПриложенияЗавершение(КодВозврата, ДополнительныеПараметры) Экспорт \r\n    \r\n    //Вставить обработку завершения выполнения\r\n    \r\nКонецПроцедуры"
  },
  {
    "title": "Диалог выбора каталога",
    "description": "Диалог выбора каталога",
    "code_snippet": "Режим = РежимДиалогаВыбораФайла.ВыборКаталога; \r\nДиалогОткрытия = Новый ДиалогВыбораФайла(Режим); \r\nДиалогОткрытия.Каталог = \"\"; \r\nДиалогОткрытия.МножественныйВыбор = Ложь; \r\nДиалогОткрытия.Заголовок = \"Выберите каталог\"; \r\n\r\nЕсли ДиалогОткрытия.Выбрать() Тогда \r\n\tПутьККаталогу = ДиалогОткрытия.Каталог; \r\nКонецЕсли;\n\nРежим = РежимДиалогаВыбораФайла.ВыборКаталога; \r\nДиалогОткрытия = Новый ДиалогВыбораФайла(Режим); \r\nДиалогОткрытия.Каталог = \"\"; \r\nДиалогОткрытия.МножественныйВыбор = Ложь; \r\nДиалогОткрытия.Заголовок = \"Выберите каталог\"; \r\n\r\nЕсли ДиалогОткрытия.Выбрать() Тогда \r\n\tПутьККаталогу = ДиалогОткрытия.Каталог; \r\nКонецЕсли;\n\n{8} Переменной ПутьККаталогу присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Поместить текст в буфер обмена",
    "description": "Поместить текст в буфер обмена",
    "code_snippet": "Процедура УстановитьТекстВБуферОбмена(Текст) Экспорт\r\n  #Если Клиент Тогда\r\n    COMОбъект = Новый COMОбъект(\"htmlfile\");\r\n    COMОбъект.ParentWindow.ClipboardData.SetData(\"Text\", Текст);\r\n  #КонецЕсли\r\nКонецПроцедуры\n\nПроцедура УстановитьТекстВБуферОбмена(Текст) Экспорт\r\n  #Если Клиент Тогда\r\n    COMОбъект = Новый COMОбъект(\"htmlfile\");\r\n    COMОбъект.ParentWindow.ClipboardData.SetData(\"Text\", Текст);\r\n  #КонецЕсли\r\nКонецПроцедуры"
  },
  {
    "title": "Заполнить первоначальные значения в форме (Организация)",
    "description": "Заполнить первоначальные значения в форме (Организация)",
    "code_snippet": "Процедура ПриСозданииНаСервере\r\n\r\n\tЗначенияДляЗаполнения = Новый Структура(\"Организация\",\r\n\t\"Объект.Организация\");\r\n\tЗарплатаКадры.ЗаполнитьПервоначальныеЗначенияВФорме(ЭтаФорма, ЗначенияДляЗаполнения);\r\n\r\nКонецПроцедуры\n\nПроцедура ПриСозданииНаСервере\r\n\r\n\tЗначенияДляЗаполнения = Новый Структура(\"Организация\",\r\n\t\"Объект.Организация\");\r\n\tЗарплатаКадры.ЗаполнитьПервоначальныеЗначенияВФорме(ЭтаФорма, ЗначенияДляЗаполнения);\r\n\r\nКонецПроцедуры"
  },
  {
    "title": "Преобразовать строку в число",
    "description": "Преобразовать строку в число",
    "code_snippet": "// Преобразует исходную строку в число без вызова исключений.\r\n//\r\n// Параметры:\r\n//   Значение - Строка - Строка, которую необходимо привести к числу.\r\n//                       Например, \"10\", \"+10\", \"010\", вернет 10;\r\n//                                 \"(10)\", \"-10\",вернет -10;\r\n//                                 \"10,2\", \"10.2\",вернет 10.2;\r\n//                                 \"000\", \" \", \"\",вернет 0;\r\n//                                 \"10текст\", вернет Неопределено.\r\n//\r\n// Возвращаемое значение:\r\n//   Число, Неопределено - Полученное число, либо Неопределено, если строка не является числом.\r\n//\r\n\r\nВведеннаяОчередность = СтроковыеФункцииКлиентСервер.СтрокаВЧисло(СтрокаТаблицы.ПредставлениеОчередности);\n\n// Преобразует исходную строку в число без вызова исключений.\r\n//\r\n// Параметры:\r\n//   Значение - Строка - Строка, которую необходимо привести к числу.\r\n//                       Например, \"10\", \"+10\", \"010\", вернет 10;\r\n//                                 \"(10)\", \"-10\",вернет -10;\r\n//                                 \"10,2\", \"10.2\",вернет 10.2;\r\n//                                 \"000\", \" \", \"\",вернет 0;\r\n//                                 \"10текст\", вернет Неопределено.\r\n//\r\n// Возвращаемое значение:\r\n//   Число, Неопределено - Полученное число, либо Неопределено, если строка не является числом.\r\n//\r\n\r\nВведеннаяОчередность = СтроковыеФункцииКлиентСервер.СтрокаВЧисло(СтрокаТаблицы.ПредставлениеОчередности);\n\n{15} Переменной ВведеннаяОчередность присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Преобразовать строку в дату",
    "description": "Преобразовать строку в дату",
    "code_snippet": "// Преобразует исходную строку в дату.\r\n//\r\n// Параметры:\r\n//  Значение - Строка - Строка, которую необходимо привести к дате.\r\n//                      Формат даты должен быть в виде \"ДД.ММ.ГГГГ\" или \"ДД/ММ/ГГ\" или \"ДД-ММ-ГГ\",\r\n//                      Например, \"23.02.1980\" или \"23/02/80\".\r\n// \r\n// Возвращаемое значение:\r\n//  Дата - полученная дата.\r\n//\r\nДля Каждого СтрокаТаблицы Из ЗагружаемыеДанные Цикл\r\n\t\t\r\n\t\tСтрокаСотрудник = Сотрудники.Добавить();\r\n\t\tСтрокаСотрудник.Идентификатор \t= СтрокаТаблицы.Идентификатор;\r\n\t\tСтрокаСотрудник.ДатаНачала \t\t= СтроковыеФункцииКлиентСервер.СтрокаВДату(СтрокаТаблицы.ДатаНачала);\r\n\t\tСтрокаСотрудник.ДатаОкончания \t= СтроковыеФункцииКлиентСервер.СтрокаВДату(СтрокаТаблицы.ДатаОкончания);\r\n\t\r\nКонецЦикла;\n\n// Преобразует исходную строку в дату.\r\n//\r\n// Параметры:\r\n//  Значение - Строка - Строка, которую необходимо привести к дате.\r\n//                      Формат даты должен быть в виде \"ДД.ММ.ГГГГ\" или \"ДД/ММ/ГГ\" или \"ДД-ММ-ГГ\",\r\n//                      Например, \"23.02.1980\" или \"23/02/80\".\r\n// \r\n// Возвращаемое значение:\r\n//  Дата - полученная дата.\r\n//\r\nДля Каждого СтрокаТаблицы Из ЗагружаемыеДанные Цикл\r\n\t\t\r\n\t\tСтрокаСотрудник = Сотрудники.Добавить();\r\n\t\tСтрокаСотрудник.Идентификатор \t= СтрокаТаблицы.Идентификатор;\r\n\t\tСтрокаСотрудник.ДатаНачала \t\t= СтроковыеФункцииКлиентСервер.СтрокаВДату(СтрокаТаблицы.ДатаНачала);\r\n\t\tСтрокаСотрудник.ДатаОкончания \t= СтроковыеФункцииКлиентСервер.СтрокаВДату(СтрокаТаблицы.ДатаОкончания);\r\n\t\r\nКонецЦикла;"
  },
  {
    "title": "Удалить префикс объекта и лидирующие нули (ЗУП 3)",
    "description": "Удалить префикс объекта и лидирующие нули (ЗУП 3)",
    "code_snippet": "// Удаляет префикс информационной базы и префикс организации из переданной строки НомерОбъекта.\r\n// Переменная НомерОбъекта должна соответствовать шаблону: ООГГ-ХХХ...ХХ или ГГ-ХХХ...ХХ, где:\r\n//    ОО - префикс организации;\r\n//    ГГ - префикс информационной базы;\r\n//    \"-\" - разделитель;\r\n//    ХХХ...ХХ - номер/код объекта.\r\n//\r\n// Пример:\r\n//    УдалитьПрефиксыИзНомераОбъекта(\"0ФГЛ-000001234\", Истина, Истина) = \"000001234\"\r\n//    УдалитьПрефиксыИзНомераОбъекта(\"0ФГЛ-000001234\", Ложь, Истина)   = \"Ф-000001234\"\r\n//    УдалитьПрефиксыИзНомераОбъекта(\"0ФГЛ-000001234\", Истина, Ложь)   = \"ГЛ-000001234\"\r\n//    УдалитьПрефиксыИзНомераОбъекта(\"0ФГЛ-000001234\", Ложь, Ложь)     = \"ФГЛ-000001234\"\r\n\r\nДокПрием.НомерДок = ПрефиксацияОбъектовКлиентСервер.УдалитьПрефиксыИзНомераОбъекта(СокрЛП(Объект.Номер), Истина, Истина);\r\n\r\n\r\n// Получает номер документа для вывода на печать; из номера удаляются префиксы и лидирующие нули.\r\n// Функция:\r\n// отбрасывает префикс организации,\r\n// отбрасывает префикс информационной базы (опционально),\r\n// отбрасывает пользовательские префиксы (опционально),\r\n// удаляет лидирующие нули в номере объекта.\r\n\r\nДокПрием.НомерДок = ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(СокрЛП(Объект.Номер), Истина, Истина);\n\n// Удаляет префикс информационной базы и префикс организации из переданной строки НомерОбъекта.\r\n// Переменная НомерОбъекта должна соответствовать шаблону: ООГГ-ХХХ...ХХ или ГГ-ХХХ...ХХ, где:\r\n//    ОО - префикс организации;\r\n//    ГГ - префикс информационной базы;\r\n//    \"-\" - разделитель;\r\n//    ХХХ...ХХ - номер/код объекта.\r\n//\r\n// Пример:\r\n//    УдалитьПрефиксыИзНомераОбъекта(\"0ФГЛ-000001234\", Истина, Истина) = \"000001234\"\r\n//    УдалитьПрефиксыИзНомераОбъекта(\"0ФГЛ-000001234\", Ложь, Истина)   = \"Ф-000001234\"\r\n//    УдалитьПрефиксыИзНомераОбъекта(\"0ФГЛ-000001234\", Истина, Ложь)   = \"ГЛ-000001234\"\r\n//    УдалитьПрефиксыИзНомераОбъекта(\"0ФГЛ-000001234\", Ложь, Ложь)     = \"ФГЛ-000001234\"\r\n\r\nДокПрием.НомерДок = ПрефиксацияОбъектовКлиентСервер.УдалитьПрефиксыИзНомераОбъекта(СокрЛП(Объект.Номер), Истина, Истина);\r\n\r\n\r\n// Получает номер документа для вывода на печать; из номера удаляются префиксы и лидирующие нули.\r\n// Функция:\r\n// отбрасывает префикс организации,\r\n// отбрасывает префикс информационной базы (опционально),\r\n// отбрасывает пользовательские префиксы (опционально),\r\n// удаляет лидирующие нули в номере объекта.\r\n\r\nДокПрием.НомерДок = ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(СокрЛП(Объект.Номер), Истина, Истина);"
  },
  {
    "title": "Склонение ФИО",
    "description": "Склонение ФИО",
    "code_snippet": "РезультатСклонения = \"\";\r\n\r\nЕсли ФизическиеЛицаЗарплатаКадры.Просклонять(Строка(Руководитель), 3, РезультатСклонения, Руководитель.Пол) Тогда\r\n\t\t\t\t\tШапка.Параметры.ФИОРуководителя = РезультатСклонения\r\nКонецЕсли;\n\nРезультатСклонения = \"\";\r\n\r\nЕсли ФизическиеЛицаЗарплатаКадры.Просклонять(Строка(Руководитель), 3, РезультатСклонения, Руководитель.Пол) Тогда\r\n\t\t\t\t\tШапка.Параметры.ФИОРуководителя = РезультатСклонения\r\nКонецЕсли;"
  },
  {
    "title": "Фамилия инициалы",
    "description": "Фамилия инициалы",
    "code_snippet": "ДанныеПечати.ФИОРуководителяСокращенное = ФизическиеЛицаЗарплатаКадрыКлиентСервер.ФамилияИнициалы(ДанныеДляПечатиСотрудники.ФизическоеЛицо)\n\nДанныеПечати.ФИОРуководителяСокращенное = ФизическиеЛицаЗарплатаКадрыКлиентСервер.ФамилияИнициалы(ДанныеДляПечатиСотрудники.ФизическоеЛицо)"
  },
  {
    "title": "Инициалы фамилия",
    "description": "Инициалы фамилия",
    "code_snippet": "ДанныеПечати.ФИОРуководителяСокращенное = ФизическиеЛицаЗарплатаКадры.РасшифровкаПодписи(ДанныеФИО);\n\nДанныеПечати.ФИОРуководителяСокращенное = ФизическиеЛицаЗарплатаКадры.РасшифровкаПодписи(ДанныеФИО);"
  },
  {
    "title": "Ответственные организации",
    "description": "Ответственные организации",
    "code_snippet": "ЗапрашиваемыеЗначения = Новый Структура;\r\n\tЗапрашиваемыеЗначения.Вставить(\"Организация\", Объект.Документ.Организация);\r\n\t\r\n\tЗапрашиваемыеЗначения.Вставить(\"Руководитель\");\r\n\tЗапрашиваемыеЗначения.Вставить(\"ДолжностьРуководителя\");\r\n\t\r\n\tЗапрашиваемыеЗначения.Вставить(\"ГлавныйБухгалтер\");\r\n\t\r\n\tЗапрашиваемыеЗначения.Вставить(\"РуководительКадровойСлужбы\");\r\n\tЗапрашиваемыеЗначения.Вставить(\"ДолжностьРуководителяКадровойСлужбы\");\r\n\t\r\n\tДатаВЗапросОтветственных = Объект.Документ.Дата;\r\n\t\r\n\t//!!! ПОЗВОЛЯЕТ ПОЛУЧИТЬ ДАННЫЕ ТОЛЬКО НА ДАТУ СЕАНСА\r\n\tЗарплатаКадры.ПолучитьЗначенияПоУмолчанию(ЗапрашиваемыеЗначения, ДатаВЗапросОтветственных);\r\n\t\r\n\tФИОГлБух = \"\";\r\n\t\r\n\tЕсли ФизическиеЛицаЗарплатаКадры.Просклонять(ЗапрашиваемыеЗначения.ГлавныйБухгалтер.Наименование, 3, ФИОГлБух, \r\n\t\t?(ЗапрашиваемыеЗначения.ГлавныйБухгалтер.Пол = Перечисления.ПолФизическогоЛица.Мужской, 1, 2)) Тогда\t\r\n\t\t\r\n\t\t//Область3.Параметры.ФИОГлБух = ФИОГлБух;\r\n\r\n\tКонецЕсли;\t\r\n\t\r\n\tОбластьМакетаПриказ.Параметры.ФИОГлавныйБухгалтер\t\t\t\t\t= ФизическиеЛицаЗарплатаКадрыКлиентСервер.ФамилияИнициалы(ФИОГлБух);\r\n\tОбластьПодписиРуководитель.Параметры.ФИО \t\t\t\t\t\t\t\t= ФизическиеЛицаЗарплатаКадры.РасшифровкаПодписи(ЗапрашиваемыеЗначения.Руководитель);\r\n\tОбластьПодписиРуководитель.Параметры.Должность \t\t\t\t\t\t= ЗапрашиваемыеЗначения.ДолжностьРуководителя;\r\n\r\n\r\n\t//ОТВЕТСТВЕННЫЕ ЛИЦА НА ЗАДАННУЮ ДАТУ\r\n\r\n\tДатаВЗапросОтветственных = ДАТА(2019,09,02);\r\n\t\t\r\n\tЗапрашиваемыеЗначения = СведенияОбОтветственныхЛицах.СведенияОбОтветственныхЛицах(Выборка.Организация, \"Руководитель,ДолжностьРуководителя\", ДатаВЗапросОтветственных);\n\nЗапрашиваемыеЗначения = Новый Структура;\r\n\tЗапрашиваемыеЗначения.Вставить(\"Организация\", Объект.Документ.Организация);\r\n\t\r\n\tЗапрашиваемыеЗначения.Вставить(\"Руководитель\");\r\n\tЗапрашиваемыеЗначения.Вставить(\"ДолжностьРуководителя\");\r\n\t\r\n\tЗапрашиваемыеЗначения.Вставить(\"ГлавныйБухгалтер\");\r\n\t\r\n\tЗапрашиваемыеЗначения.Вставить(\"РуководительКадровойСлужбы\");\r\n\tЗапрашиваемыеЗначения.Вставить(\"ДолжностьРуководителяКадровойСлужбы\");\r\n\t\r\n\tДатаВЗапросОтветственных = Объект.Документ.Дата;\r\n\t\r\n\t//!!! ПОЗВОЛЯЕТ ПОЛУЧИТЬ ДАННЫЕ ТОЛЬКО НА ДАТУ СЕАНСА\r\n\tЗарплатаКадры.ПолучитьЗначенияПоУмолчанию(ЗапрашиваемыеЗначения, ДатаВЗапросОтветственных);\r\n\t\r\n\tФИОГлБух = \"\";\r\n\t\r\n\tЕсли ФизическиеЛицаЗарплатаКадры.Просклонять(ЗапрашиваемыеЗначения.ГлавныйБухгалтер.Наименование, 3, ФИОГлБух, \r\n\t\t?(ЗапрашиваемыеЗначения.ГлавныйБухгалтер.Пол = Перечисления.ПолФизическогоЛица.Мужской, 1, 2)) Тогда\t\r\n\t\t\r\n\t\t//Область3.Параметры.ФИОГлБух = ФИОГлБух;\r\n\r\n\tКонецЕсли;\t\r\n\t\r\n\tОбластьМакетаПриказ.Параметры.ФИОГлавныйБухгалтер\t\t\t\t\t= ФизическиеЛицаЗарплатаКадрыКлиентСервер.ФамилияИнициалы(ФИОГлБух);\r\n\tОбластьПодписиРуководитель.Параметры.ФИО \t\t\t\t\t\t\t\t= ФизическиеЛицаЗарплатаКадры.РасшифровкаПодписи(ЗапрашиваемыеЗначения.Руководитель);\r\n\tОбластьПодписиРуководитель.Параметры.Должность \t\t\t\t\t\t= ЗапрашиваемыеЗначения.ДолжностьРуководителя;\r\n\r\n\r\n\t//ОТВЕТСТВЕННЫЕ ЛИЦА НА ЗАДАННУЮ ДАТУ\r\n\r\n\tДатаВЗапросОтветственных = ДАТА(2019,09,02);\r\n\t\t\r\n\tЗапрашиваемыеЗначения = СведенияОбОтветственныхЛицах.СведенияОбОтветственныхЛицах(Выборка.Организация, \"Руководитель,ДолжностьРуководителя\", ДатаВЗапросОтветственных);\n\n{35} Переменной ЗапрашиваемыеЗначения присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Сведения об организации",
    "description": "Сведения об организации",
    "code_snippet": "&НаСервере\r\nПроцедура СведенияОбОрганизацииНаСервере()\r\n\t\r\n\t//Без передачи списка показателей возвращаются все доступные значения показатели\r\n\t//Если нужно значение конкретного показателя см. подробнее ЗарплатаКадрыБазовый.ПолучитьСведенияОбОрганизации \r\n\t\r\n\tСведенияОбОрганизации = ЗарплатаКадрыБазовый.ПолучитьСведенияОбОрганизации(Объект.Организация,ТекущаяДата(), );\r\n\t\t\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура СведенияОбОрганизацииНаСервере()\r\n\t\r\n\t//Без передачи списка показателей возвращаются все доступные значения показатели\r\n\t//Если нужно значение конкретного показателя см. подробнее ЗарплатаКадрыБазовый.ПолучитьСведенияОбОрганизации \r\n\t\r\n\tСведенияОбОрганизации = ЗарплатаКадрыБазовый.ПолучитьСведенияОбОрганизации(Объект.Организация,ТекущаяДата(), );\r\n\t\t\r\nКонецПроцедуры\n\n{7} Переменной СведенияОбОрганизации присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Данные бухгалтерского учета",
    "description": "Данные бухгалтерского учета",
    "code_snippet": "&НаСервере\r\nПроцедура ОтражениеВУчетеНаСервере()\r\n\t\r\n\t//Тестировалось на релизе 3.1.8\r\n\t\r\n\tСотрудник = Справочники.Сотрудники.НайтиПоНаименованию(\"Колесник Дмитрий Иванович\");\r\n\tДатаНачалаСобытия = ДАТА(2018,12,14);\r\n\tНачисление = ПланыВидовРасчета.Начисления.НайтиПоНаименованию(\"Оплата по окладу\");\r\n\t\r\n\t// Определяет статью финансирования, используемую для СОТРУДНИКА по умолчанию.\r\n\t\r\n\tОтражениеВБухучетеНачисления = УчетСреднегоЗаработка.ОтражениеВБухучетеПоУмолчанию(Сотрудник, ДатаНачалаСобытия, Начисление);\r\n\t\r\n\t// Определяет статью финансирования, используемую для НАЧИСЛЕНИЯ СОТРУДНИКА по умолчанию.\r\n\t\r\n\tОтражениеВБухучетеСотрудника = УчетСреднегоЗаработка.ОтражениеВБухучетеПоУмолчанию(Сотрудник, ДатаНачалаСобытия);\r\n\t\r\n\t//ОтражениеВБухучетеСотрудника2 = ОтражениеЗарплатыВБухучетеРасширенный.НастройкаБухучетаЗарплатыСотрудника(Сотрудник, ДатаНачалаСобытия);\r\n\t\r\n\t//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\t\r\n\t//ВАРИАНТ 1\r\n\t\r\n\t// Определяет статью финансирования, используемую для НАЧИСЛЕНИЯ СОТРУДНИКА по умолчанию.\r\n\t// Определяет откуда применяется статья финансирования (из Организации, Подразделения, Сотрудника)\t\r\n\t// и выводит статью финансирования с учетом всех введенных данных\r\n\t\r\n\tКадровыеДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, \r\n\tОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Сотрудник), \r\n\t\"Организация,ФизическоеЛицо,Подразделение,ТерриторияВыполненияРаботВОрганизации\", ДатаНачалаСобытия);\r\n\r\n\tМенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц();\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\t\r\n\tЗапрос.Текст =\r\n\t\"ВЫБРАТЬ\r\n\t|\tТаблицаСотрудников.Сотрудник КАК Сотрудник,\r\n\t|\tТаблицаСотрудников.Период КАК Период,\r\n\t|\tТаблицаСотрудников.Подразделение КАК Подразделение,\r\n\t|\tТаблицаСотрудников.ТерриторияВыполненияРаботВОрганизации КАК ТерриторияВыполненияРаботВОрганизации\r\n\t|ПОМЕСТИТЬ ВТСотрудники\r\n\t|ИЗ\r\n\t|\t&ТаблицаСотрудников КАК ТаблицаСотрудников\"; \r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ТаблицаСотрудников\", КадровыеДанныеСотрудника);\r\n\tЗапрос.Выполнить();\r\n\t\t\r\n\tОтражениеЗарплатыВБухучете.СоздатьВТСведенияОБухучетеЗарплатыСотрудников(МенеджерВременныхТаблиц, \"ВТСотрудники\", \"Сотрудник,Период\", КадровыеДанныеСотрудника[0].Организация);\r\n\t\r\n\tОтражениеВБухучетеСотрудникаПодробно = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТСведенияОБухучетеЗарплатыСотрудников\").ПолучитьДанные().Выгрузить();\r\n\t\r\n\t//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n\t//ВАРИАНТ 2\r\n\t\r\n\tМенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\r\n\t\r\n\tТекстЗапроса = \r\n\t\"ВЫБРАТЬ РАЗРЕШЕННЫЕ\r\n\t|\tСотрудники.Ссылка КАК Сотрудник,\r\n\t|\t&ДатаАктуальности КАК Период\r\n\t|ПОМЕСТИТЬ ВТСотрудники\r\n\t|ИЗ\r\n\t|\tСправочник.Сотрудники КАК Сотрудники\r\n\t|ГДЕ\r\n\t|\tСотрудники.Ссылка = &Сотрудник\";\r\n\t\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tЗапрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\tЗапрос.УстановитьПараметр(\"ДатаАктуальности\", ДатаНачалаСобытия);\r\n\tЗапрос.Выполнить();\r\n\t\r\n\t// Из кадрового учета получаем организацию и подразделение.\r\n\tОписатель = КадровыйУчет.ОписательВременныхТаблицДляСоздатьВТКадровыеДанныеСотрудников(МенеджерВременныхТаблиц, \"ВТСотрудники\");\r\n\tКадровыйУчет.СоздатьВТКадровыеДанныеСотрудников(Описатель, Истина, \"Организация,Подразделение,ТерриторияВыполненияРаботВОрганизации\");\r\n\t\r\n\tОтборы = Новый Массив;\t\r\n\tОтборыНачислений = Новый Структура(\"ПлановыеНачисления\", ОбщегоНазначенияКлиентСервер.СкопироватьМассив(Отборы));\r\n\t\r\n\tЗапросВТПлановыеНачисления = КадровыйУчетРасширенный.ЗапросВТПлановыеНачисленияСотрудников(\r\n\tИстина, \"ВТПлановыеНачисленияСотрудников\", \"ВТСотрудники\", \"Сотрудник,Период\",ОтборыНачислений,Истина);\r\n\t\r\n\tЗапросВТПлановыеНачисления.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tЗапросВТПлановыеНачисления.Выполнить();\r\n\t\r\n\t// Формируем временную таблицу с настройками бухучета.\r\n\t//Если Начисление <> Неопределено Тогда\r\n\tОтражениеЗарплатыВБухучете.СоздатьВТСведенияОБухучетеНачисленийСотрудников(МенеджерВременныхТаблиц, \"ВТКадровыеДанныеСотрудников\", \"Сотрудник,Период\", , , Начисление);\r\n\t//ИмяВТ = \"ВТСведенияОБухучетеНачисленийСотрудников\";\r\n\t//Иначе\r\n\tОтражениеЗарплатыВБухучетеРасширенный.СоздатьВТСведенияОБухучетеЗарплатыСотрудников(МенеджерВременныхТаблиц, \"ВТКадровыеДанныеСотрудников\", \"Сотрудник,Период\");\r\n\t//ИмяВТ = \"ВТСведенияОБухучетеЗарплатыСотрудников\";\r\n\t//КонецЕсли;\r\n\t\r\n\tОтражениеВБухучетеНачисленийСотрудникаПодробно = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТСведенияОБухучетеНачисленийСотрудников\").ПолучитьДанные().Выгрузить();\r\n\tОтражениеВБухучетеСотрудникаПодробно = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТСведенияОБухучетеЗарплатыСотрудников\").ПолучитьДанные().Выгрузить();\r\n\t\r\n   \tВТПлановыеНачисленияСотрудников = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТПлановыеНачисленияСотрудников\").ПолучитьДанные().Выгрузить();\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ОтражениеВУчетеНаСервере()\r\n\t\r\n\t//Тестировалось на релизе 3.1.8\r\n\t\r\n\tСотрудник = Справочники.Сотрудники.НайтиПоНаименованию(\"Колесник Дмитрий Иванович\");\r\n\tДатаНачалаСобытия = ДАТА(2018,12,14);\r\n\tНачисление = ПланыВидовРасчета.Начисления.НайтиПоНаименованию(\"Оплата по окладу\");\r\n\t\r\n\t// Определяет статью финансирования, используемую для СОТРУДНИКА по умолчанию.\r\n\t\r\n\tОтражениеВБухучетеНачисления = УчетСреднегоЗаработка.ОтражениеВБухучетеПоУмолчанию(Сотрудник, ДатаНачалаСобытия, Начисление);\r\n\t\r\n\t// Определяет статью финансирования, используемую для НАЧИСЛЕНИЯ СОТРУДНИКА по умолчанию.\r\n\t\r\n\tОтражениеВБухучетеСотрудника = УчетСреднегоЗаработка.ОтражениеВБухучетеПоУмолчанию(Сотрудник, ДатаНачалаСобытия);\r\n\t\r\n\t//ОтражениеВБухучетеСотрудника2 = ОтражениеЗарплатыВБухучетеРасширенный.НастройкаБухучетаЗарплатыСотрудника(Сотрудник, ДатаНачалаСобытия);\r\n\t\r\n\t//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\t\r\n\t//ВАРИАНТ 1\r\n\t\r\n\t// Определяет статью финансирования, используемую для НАЧИСЛЕНИЯ СОТРУДНИКА по умолчанию.\r\n\t// Определяет откуда применяется статья финансирования (из Организации, Подразделения, Сотрудника)\t\r\n\t// и выводит статью финансирования с учетом всех введенных данных\r\n\t\r\n\tКадровыеДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, \r\n\tОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Сотрудник), \r\n\t\"Организация,ФизическоеЛицо,Подразделение,ТерриторияВыполненияРаботВОрганизации\", ДатаНачалаСобытия);\r\n\r\n\tМенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц();\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\t\r\n\tЗапрос.Текст =\r\n\t\"ВЫБРАТЬ\r\n\t|\tТаблицаСотрудников.Сотрудник КАК Сотрудник,\r\n\t|\tТаблицаСотрудников.Период КАК Период,\r\n\t|\tТаблицаСотрудников.Подразделение КАК Подразделение,\r\n\t|\tТаблицаСотрудников.ТерриторияВыполненияРаботВОрганизации КАК ТерриторияВыполненияРаботВОрганизации\r\n\t|ПОМЕСТИТЬ ВТСотрудники\r\n\t|ИЗ\r\n\t|\t&ТаблицаСотрудников КАК ТаблицаСотрудников\"; \r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ТаблицаСотрудников\", КадровыеДанныеСотрудника);\r\n\tЗапрос.Выполнить();\r\n\t\t\r\n\tОтражениеЗарплатыВБухучете.СоздатьВТСведенияОБухучетеЗарплатыСотрудников(МенеджерВременныхТаблиц, \"ВТСотрудники\", \"Сотрудник,Период\", КадровыеДанныеСотрудника[0].Организация);\r\n\t\r\n\tОтражениеВБухучетеСотрудникаПодробно = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТСведенияОБухучетеЗарплатыСотрудников\").ПолучитьДанные().Выгрузить();\r\n\t\r\n\t//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n\t//ВАРИАНТ 2\r\n\t\r\n\tМенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\r\n\t\r\n\tТекстЗапроса = \r\n\t\"ВЫБРАТЬ РАЗРЕШЕННЫЕ\r\n\t|\tСотрудники.Ссылка КАК Сотрудник,\r\n\t|\t&ДатаАктуальности КАК Период\r\n\t|ПОМЕСТИТЬ ВТСотрудники\r\n\t|ИЗ\r\n\t|\tСправочник.Сотрудники КАК Сотрудники\r\n\t|ГДЕ\r\n\t|\tСотрудники.Ссылка = &Сотрудник\";\r\n\t\r\n\tЗапрос = Новый Запрос(ТекстЗапроса);\r\n\tЗапрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tЗапрос.УстановитьПараметр(\"Сотрудник\", Сотрудник);\r\n\tЗапрос.УстановитьПараметр(\"ДатаАктуальности\", ДатаНачалаСобытия);\r\n\tЗапрос.Выполнить();\r\n\t\r\n\t// Из кадрового учета получаем организацию и подразделение.\r\n\tОписатель = КадровыйУчет.ОписательВременныхТаблицДляСоздатьВТКадровыеДанныеСотрудников(МенеджерВременныхТаблиц, \"ВТСотрудники\");\r\n\tКадровыйУчет.СоздатьВТКадровыеДанныеСотрудников(Описатель, Истина, \"Организация,Подразделение,ТерриторияВыполненияРаботВОрганизации\");\r\n\t\r\n\tОтборы = Новый Массив;\t\r\n\tОтборыНачислений = Новый Структура(\"ПлановыеНачисления\", ОбщегоНазначенияКлиентСервер.СкопироватьМассив(Отборы));\r\n\t\r\n\tЗапросВТПлановыеНачисления = КадровыйУчетРасширенный.ЗапросВТПлановыеНачисленияСотрудников(\r\n\tИстина, \"ВТПлановыеНачисленияСотрудников\", \"ВТСотрудники\", \"Сотрудник,Период\",ОтборыНачислений,Истина);\r\n\t\r\n\tЗапросВТПлановыеНачисления.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n\tЗапросВТПлановыеНачисления.Выполнить();\r\n\t\r\n\t// Формируем временную таблицу с настройками бухучета.\r\n\t//Если Начисление <> Неопределено Тогда\r\n\tОтражениеЗарплатыВБухучете.СоздатьВТСведенияОБухучетеНачисленийСотрудников(МенеджерВременныхТаблиц, \"ВТКадровыеДанныеСотрудников\", \"Сотрудник,Период\", , , Начисление);\r\n\t//ИмяВТ = \"ВТСведенияОБухучетеНачисленийСотрудников\";\r\n\t//Иначе\r\n\tОтражениеЗарплатыВБухучетеРасширенный.СоздатьВТСведенияОБухучетеЗарплатыСотрудников(МенеджерВременныхТаблиц, \"ВТКадровыеДанныеСотрудников\", \"Сотрудник,Период\");\r\n\t//ИмяВТ = \"ВТСведенияОБухучетеЗарплатыСотрудников\";\r\n\t//КонецЕсли;\r\n\t\r\n\tОтражениеВБухучетеНачисленийСотрудникаПодробно = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТСведенияОБухучетеНачисленийСотрудников\").ПолучитьДанные().Выгрузить();\r\n\tОтражениеВБухучетеСотрудникаПодробно = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТСведенияОБухучетеЗарплатыСотрудников\").ПолучитьДанные().Выгрузить();\r\n\t\r\n   \tВТПлановыеНачисленияСотрудников = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТПлановыеНачисленияСотрудников\").ПолучитьДанные().Выгрузить();\r\n\t\r\nКонецПроцедуры\n\n{12} Переменной ОтражениеВБухучетеНачисления присвоено значение, но оно нигде не используется\r\n{16} Переменной ОтражениеВБухучетеСотрудника присвоено значение, но оно нигде не используется\r\n{52} Переменной ОтражениеВБухучетеСотрудникаПодробно присвоено значение, но оно нигде не используется\r\n{98} Переменной ОтражениеВБухучетеНачисленийСотрудникаПодробно присвоено значение, но оно нигде не используется\r\n{99} Переменной ОтражениеВБухучетеСотрудникаПодробно присвоено значение, но оно нигде не используется\r\n{101} Переменной ВТПлановыеНачисленияСотрудников присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Данные среднего заработка, остатка отпусков, резерва отпусков",
    "description": "Данные среднего заработка, остатка отпусков, резерва отпусков",
    "code_snippet": "&НаСервере\r\nПроцедура ПолучитьДанныеСреднегоЗаработкаНаСервере()\r\n\t\r\n\tДатаОтпуска     = Дата(2018,01,01);\r\n\t\r\n\t//Расчетный год отпуска\r\n\tДатаНачала         = Дата(2017,01,01);\r\n\tДатаОкончания     = Дата(2017,12,31);\r\n\t\r\n\tИсходнаяТаблица = УчетСреднегоЗаработка.ПустаяТаблицаИсходныхДанныхРасчетаОбщегоСреднегоЗаработка();\r\n\tмПараметры = КадровыйУчет.ПараметрыПолученияСотрудниковОрганизацийПоСпискуФизическихЛиц();\r\n\tмПараметры.Организация = Справочники.Организации.НайтиПоРеквизиту(\"ИНН\", \"0000000000\");\r\n\tмПараметры.НачалоПериода     \t\t= ДатаОтпуска;\r\n\tмПараметры.ОкончаниеПериода    \t= ДатаОтпуска;\r\n\t//мПараметры.КадровыеДанные       \t= \"Подразделение\";\r\n\t\r\n\tЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\t\t\t\tмПараметры.Отборы, \"ФизическоеЛицо\", \"=\", Справочники.ФизическиеЛица.НайтиПоНаименованию(\"Иванов Иван Иванович\"));\r\n\t\r\n\t// 1. получаем сотрудников организации\r\n\t\r\n\tСотрудникиОрганизации = КадровыйУчет.СотрудникиОрганизации(Истина, мПараметры);\r\n\t\r\n\t// 2. получаем средний заработок сотрудников\r\n\t\r\n\tСотрудникиОрганизации.Колонки.Добавить(\"СреднийЗаработок\", Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(15, 2)));\r\n\tСотрудникиОрганизации.Колонки.Добавить(\"ОстатокОтпуска\", Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(4, 0)));\r\n\tСотрудникиОрганизации.Колонки.Добавить(\"Сумма\", Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(15, 2)));\r\n\t\r\n\tОграничитьКоличество = 10;\r\n\t// получем данные для расчета среднего\r\n\tСтрокиКУдалению = Новый Массив;\r\n\tИндекс = 1;\r\n\t\r\n\tДля каждого СтрокаСотрудник из СотрудникиОрганизации Цикл\r\n\t\tЕсли Индекс <= ОграничитьКоличество Тогда\r\n\t\t\tСтрокаТаблицы = ИсходнаяТаблица.Добавить();\r\n\t\t\tСтрокаТаблицы.Сотрудник                         = СтрокаСотрудник.Сотрудник;\r\n\t\t\tСтрокаТаблицы.ПорядокРасчета                     = Перечисления.ПорядокРасчетаСреднегоЗаработкаОбщий.Постановление2010;\r\n\t\t\tСтрокаТаблицы.ДатаНачалаСобытия                 = ДатаОтпуска;\r\n\t\t\tСтрокаТаблицы.НачалоПериодаРасчетаСреднего         = ДатаНачала;\r\n\t\t\tСтрокаТаблицы.ОкончаниеПериодаРасчетаСреднего     = ДатаОкончания;\r\n\t\t\tИндекс = Индекс + 1;\r\n\t\tИначе \r\n\t\t\tСтрокиКУдалению.Добавить(СтрокаСотрудник);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля каждого пСтрока из СтрокиКУдалению Цикл\r\n\t\tСотрудникиОрганизации.Удалить(пСтрока);\r\n\tКонецЦикла;\r\n\t\r\n\tДанныеДляРасчета = УчетСреднегоЗаработка.ДанныеДляРасчетаОбщегоСреднегоЗаработкаСотрудников(ИсходнаяТаблица, Неопределено, Неопределено, Истина);\r\n\t\r\n\tДля каждого СтрокаСотрудник из СотрудникиОрганизации Цикл\r\n\t\t\r\n\t\tОтбор = Новый Структура(\"Сотрудник\",СтрокаСотрудник.Сотрудник);\r\n\t\t\r\n\t\tДанныеОВремени         = ДанныеДляРасчета.ДанныеОВремени;\r\n\t\tДанныеОНачислениях     = ДанныеДляРасчета.ДанныеОНачислениях;\r\n\t\tДанныеОбИндексации     = ДанныеДляРасчета.ДанныеОбИндексации;\r\n\t\t\r\n\t\tДанныеДляРасчетаСотрудник = Новый Структура(\"ДанныеОВремени,ДанныеОНачислениях,ДанныеОбИндексации\");\r\n\t\t\r\n\t\tДанныеДляРасчетаСотрудник.ДанныеОВремени         = ДанныеОВремени.Скопировать(ДанныеОВремени.НайтиСтроки(Отбор));\r\n\t\tДанныеДляРасчетаСотрудник.ДанныеОНачислениях     = ДанныеОНачислениях.Скопировать(ДанныеОНачислениях.НайтиСтроки(Отбор));\r\n\t\tДанныеДляРасчетаСотрудник.ДанныеОбИндексации     = ДанныеОбИндексации.Скопировать(ДанныеОбИндексации.НайтиСтроки(Отбор));\r\n\t\t\r\n\t\tДополнительныеПараметры = УчетСреднегоЗаработкаКлиентСервер.ДополнительныеПараметрыРасчетаСреднегоЗаработка();\r\n\t\t\r\n\t\tДополнительныеПараметры.ДатаНачалаСобытия = ДатаОтпуска;\r\n\t\t\r\n\t\tЕсли Не ЗначениеЗаполнено(ДополнительныеПараметры.НачалоПериода) \r\n\t\t\tИли Не ЗначениеЗаполнено(ДополнительныеПараметры.ОкончаниеПериода) Тогда\r\n\t\t\tПериодРасчета = УчетСреднегоЗаработка.ПериодРасчетаОбщегоСреднегоЗаработкаСотрудника(ДатаОтпуска, СтрокаСотрудник.Сотрудник, ДополнительныеПараметры.Начисление);\r\n\t\t\tДополнительныеПараметры.НачалоПериода = ДатаНачала;\r\n\t\t\tДополнительныеПараметры.ОкончаниеПериода = ДатаОкончания;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ДополнительныеПараметры.ПорядокРасчета = Неопределено Тогда\r\n\t\t\tДополнительныеПараметры.ПорядокРасчета = УчетСреднегоЗаработкаКлиентСервер.ПорядокРасчетаОбщегоСреднегоЗаработка(ДатаОтпуска);\r\n\t\tКонецЕсли;\r\n\t\tДополнительныеПараметры.ПорядокРасчета         = Перечисления.ПорядокРасчетаСреднегоЗаработкаОбщий.Постановление2010;\r\n\t\tДополнительныеПараметры.СпособРасчетаОтпуска = Перечисления.СпособыРасчетаНачислений.ОплатаОтпускаПоКалендарнымДням;\r\n\t\t\r\n\t\tДополнительныеПараметры.Индексации = ДанныеДляРасчета.ДанныеОбИндексации;\r\n\t\t\r\n\t\tСтрокаСотрудник.СреднийЗаработок = УчетСреднегоЗаработкаКлиентСервер.СреднийЗаработокОбщий(ДанныеДляРасчетаСотрудник.ДанныеОНачислениях, ДанныеДляРасчетаСотрудник.ДанныеОВремени, ДополнительныеПараметры);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t// 3. считаем остатки отпусков\r\n\t\r\n\tСписокСотрудников = СотрудникиОрганизации.ВыгрузитьКолонку(\"Сотрудник\");\r\n\tВидыОтпусков = Неопределено;\r\n\t//ВидыОтпусков = Новый Массив;\r\n\t//ВидыОтпусков.Добавить(Справочники.ВидыОтпусков.Основной);\r\n\t\r\n\tТаблицаОстаткиОтпусков = ОстаткиОтпусков.ОстаткиОтпусковСотрудниковНаДату(СписокСотрудников, ДатаОтпуска, ВидыОтпусков);\r\n\t\r\n\tДля каждого СтрокаСотрудник из СотрудникиОрганизации Цикл\r\n\t\t\r\n\t\tОтбор = Новый Структура(\"Сотрудник\",СтрокаСотрудник.Сотрудник);\r\n\t\tСтрокиОтпуска = ТаблицаОстаткиОтпусков.НайтиСтроки(Отбор);\r\n\t\t\r\n\t\tОстатокОтпуска = 0;\r\n\t\t\r\n\t\tДля каждого СтрокаОтпуска из СтрокиОтпуска Цикл\r\n\t\t\tОстатокОтпуска = ОстатокОтпуска + СтрокаОтпуска.КоличествоДней;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tСтрокаСотрудник.ОстатокОтпуска = ОстатокОтпуска;\r\n\t\tСтрокаСотрудник.Сумма = ОстатокОтпуска * СтрокаСотрудник.СреднийЗаработок;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t//СотрудникиОрганизации.Колонки.Добавить(\"СреднийЗаработок\",Новый ОписаниеТипов(\"Число\",Новый КвалификаторыЧисла(15, 2)));\r\n\t//Сообщить(УчетСреднегоЗаработка.СреднийЗаработок(СотрудникиОрганизации[0].Сотрудник,Дата(2017,12,31)));\r\n\t\r\n\t//ЗаполнитьТаблицуЗначенийНаФорме(СотрудникиОрганизации,\"ТЗ2\");\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ПолучитьДанныеСреднегоЗаработкаНаСервере()\r\n\t\r\n\tДатаОтпуска     = Дата(2018,01,01);\r\n\t\r\n\t//Расчетный год отпуска\r\n\tДатаНачала         = Дата(2017,01,01);\r\n\tДатаОкончания     = Дата(2017,12,31);\r\n\t\r\n\tИсходнаяТаблица = УчетСреднегоЗаработка.ПустаяТаблицаИсходныхДанныхРасчетаОбщегоСреднегоЗаработка();\r\n\tмПараметры = КадровыйУчет.ПараметрыПолученияСотрудниковОрганизацийПоСпискуФизическихЛиц();\r\n\tмПараметры.Организация = Справочники.Организации.НайтиПоРеквизиту(\"ИНН\", \"0000000000\");\r\n\tмПараметры.НачалоПериода     \t\t= ДатаОтпуска;\r\n\tмПараметры.ОкончаниеПериода    \t= ДатаОтпуска;\r\n\t//мПараметры.КадровыеДанные       \t= \"Подразделение\";\r\n\t\r\n\tЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\t\t\t\tмПараметры.Отборы, \"ФизическоеЛицо\", \"=\", Справочники.ФизическиеЛица.НайтиПоНаименованию(\"Иванов Иван Иванович\"));\r\n\t\r\n\t// 1. получаем сотрудников организации\r\n\t\r\n\tСотрудникиОрганизации = КадровыйУчет.СотрудникиОрганизации(Истина, мПараметры);\r\n\t\r\n\t// 2. получаем средний заработок сотрудников\r\n\t\r\n\tСотрудникиОрганизации.Колонки.Добавить(\"СреднийЗаработок\", Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(15, 2)));\r\n\tСотрудникиОрганизации.Колонки.Добавить(\"ОстатокОтпуска\", Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(4, 0)));\r\n\tСотрудникиОрганизации.Колонки.Добавить(\"Сумма\", Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(15, 2)));\r\n\t\r\n\tОграничитьКоличество = 10;\r\n\t// получем данные для расчета среднего\r\n\tСтрокиКУдалению = Новый Массив;\r\n\tИндекс = 1;\r\n\t\r\n\tДля каждого СтрокаСотрудник из СотрудникиОрганизации Цикл\r\n\t\tЕсли Индекс <= ОграничитьКоличество Тогда\r\n\t\t\tСтрокаТаблицы = ИсходнаяТаблица.Добавить();\r\n\t\t\tСтрокаТаблицы.Сотрудник                         = СтрокаСотрудник.Сотрудник;\r\n\t\t\tСтрокаТаблицы.ПорядокРасчета                     = Перечисления.ПорядокРасчетаСреднегоЗаработкаОбщий.Постановление2010;\r\n\t\t\tСтрокаТаблицы.ДатаНачалаСобытия                 = ДатаОтпуска;\r\n\t\t\tСтрокаТаблицы.НачалоПериодаРасчетаСреднего         = ДатаНачала;\r\n\t\t\tСтрокаТаблицы.ОкончаниеПериодаРасчетаСреднего     = ДатаОкончания;\r\n\t\t\tИндекс = Индекс + 1;\r\n\t\tИначе \r\n\t\t\tСтрокиКУдалению.Добавить(СтрокаСотрудник);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля каждого пСтрока из СтрокиКУдалению Цикл\r\n\t\tСотрудникиОрганизации.Удалить(пСтрока);\r\n\tКонецЦикла;\r\n\t\r\n\tДанныеДляРасчета = УчетСреднегоЗаработка.ДанныеДляРасчетаОбщегоСреднегоЗаработкаСотрудников(ИсходнаяТаблица, Неопределено, Неопределено, Истина);\r\n\t\r\n\tДля каждого СтрокаСотрудник из СотрудникиОрганизации Цикл\r\n\t\t\r\n\t\tОтбор = Новый Структура(\"Сотрудник\",СтрокаСотрудник.Сотрудник);\r\n\t\t\r\n\t\tДанныеОВремени         = ДанныеДляРасчета.ДанныеОВремени;\r\n\t\tДанныеОНачислениях     = ДанныеДляРасчета.ДанныеОНачислениях;\r\n\t\tДанныеОбИндексации     = ДанныеДляРасчета.ДанныеОбИндексации;\r\n\t\t\r\n\t\tДанныеДляРасчетаСотрудник = Новый Структура(\"ДанныеОВремени,ДанныеОНачислениях,ДанныеОбИндексации\");\r\n\t\t\r\n\t\tДанныеДляРасчетаСотрудник.ДанныеОВремени         = ДанныеОВремени.Скопировать(ДанныеОВремени.НайтиСтроки(Отбор));\r\n\t\tДанныеДляРасчетаСотрудник.ДанныеОНачислениях     = ДанныеОНачислениях.Скопировать(ДанныеОНачислениях.НайтиСтроки(Отбор));\r\n\t\tДанныеДляРасчетаСотрудник.ДанныеОбИндексации     = ДанныеОбИндексации.Скопировать(ДанныеОбИндексации.НайтиСтроки(Отбор));\r\n\t\t\r\n\t\tДополнительныеПараметры = УчетСреднегоЗаработкаКлиентСервер.ДополнительныеПараметрыРасчетаСреднегоЗаработка();\r\n\t\t\r\n\t\tДополнительныеПараметры.ДатаНачалаСобытия = ДатаОтпуска;\r\n\t\t\r\n\t\tЕсли Не ЗначениеЗаполнено(ДополнительныеПараметры.НачалоПериода) \r\n\t\t\tИли Не ЗначениеЗаполнено(ДополнительныеПараметры.ОкончаниеПериода) Тогда\r\n\t\t\tПериодРасчета = УчетСреднегоЗаработка.ПериодРасчетаОбщегоСреднегоЗаработкаСотрудника(ДатаОтпуска, СтрокаСотрудник.Сотрудник, ДополнительныеПараметры.Начисление);\r\n\t\t\tДополнительныеПараметры.НачалоПериода = ДатаНачала;\r\n\t\t\tДополнительныеПараметры.ОкончаниеПериода = ДатаОкончания;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tЕсли ДополнительныеПараметры.ПорядокРасчета = Неопределено Тогда\r\n\t\t\tДополнительныеПараметры.ПорядокРасчета = УчетСреднегоЗаработкаКлиентСервер.ПорядокРасчетаОбщегоСреднегоЗаработка(ДатаОтпуска);\r\n\t\tКонецЕсли;\r\n\t\tДополнительныеПараметры.ПорядокРасчета         = Перечисления.ПорядокРасчетаСреднегоЗаработкаОбщий.Постановление2010;\r\n\t\tДополнительныеПараметры.СпособРасчетаОтпуска = Перечисления.СпособыРасчетаНачислений.ОплатаОтпускаПоКалендарнымДням;\r\n\t\t\r\n\t\tДополнительныеПараметры.Индексации = ДанныеДляРасчета.ДанныеОбИндексации;\r\n\t\t\r\n\t\tСтрокаСотрудник.СреднийЗаработок = УчетСреднегоЗаработкаКлиентСервер.СреднийЗаработокОбщий(ДанныеДляРасчетаСотрудник.ДанныеОНачислениях, ДанныеДляРасчетаСотрудник.ДанныеОВремени, ДополнительныеПараметры);\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t// 3. считаем остатки отпусков\r\n\t\r\n\tСписокСотрудников = СотрудникиОрганизации.ВыгрузитьКолонку(\"Сотрудник\");\r\n\tВидыОтпусков = Неопределено;\r\n\t//ВидыОтпусков = Новый Массив;\r\n\t//ВидыОтпусков.Добавить(Справочники.ВидыОтпусков.Основной);\r\n\t\r\n\tТаблицаОстаткиОтпусков = ОстаткиОтпусков.ОстаткиОтпусковСотрудниковНаДату(СписокСотрудников, ДатаОтпуска, ВидыОтпусков);\r\n\t\r\n\tДля каждого СтрокаСотрудник из СотрудникиОрганизации Цикл\r\n\t\t\r\n\t\tОтбор = Новый Структура(\"Сотрудник\",СтрокаСотрудник.Сотрудник);\r\n\t\tСтрокиОтпуска = ТаблицаОстаткиОтпусков.НайтиСтроки(Отбор);\r\n\t\t\r\n\t\tОстатокОтпуска = 0;\r\n\t\t\r\n\t\tДля каждого СтрокаОтпуска из СтрокиОтпуска Цикл\r\n\t\t\tОстатокОтпуска = ОстатокОтпуска + СтрокаОтпуска.КоличествоДней;\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tСтрокаСотрудник.ОстатокОтпуска = ОстатокОтпуска;\r\n\t\tСтрокаСотрудник.Сумма = ОстатокОтпуска * СтрокаСотрудник.СреднийЗаработок;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t//СотрудникиОрганизации.Колонки.Добавить(\"СреднийЗаработок\",Новый ОписаниеТипов(\"Число\",Новый КвалификаторыЧисла(15, 2)));\r\n\t//Сообщить(УчетСреднегоЗаработка.СреднийЗаработок(СотрудникиОрганизации[0].Сотрудник,Дата(2017,12,31)));\r\n\t\r\n\t//ЗаполнитьТаблицуЗначенийНаФорме(СотрудникиОрганизации,\"ТЗ2\");\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Данные отработанного времени",
    "description": "Данные отработанного времени",
    "code_snippet": "//В ДАННОМ ПРИМЕРЕ МОЖНО ПОЛУЧИТЬ ДАННЫЕ ВРЕМЕНИ ТОЛЬКО ЗА ОДИН МЕСЯЦ\r\n\r\n&НаСервере\r\nПроцедура Команда1НаСервере()\r\n\t\r\n    ПараметрыПолученияДанных = УчетРабочегоВремениРасширенный.ПараметрыПолученияДанныхУчетаВремени();\r\n    ДатаНачала = '20180901';\r\n    ДатаОкончания = КонецМесяца(ДатаНачала);\r\n    ПараметрыПолученияДанных.ДатаНачала = ДатаНачала;\r\n    ПараметрыПолученияДанных.ДатаОкончания = ДатаОкончания;\r\n    \r\n    МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\r\n\t\r\n\t//Запрос.Текст = \"ВЫБРАТЬ РАЗЛИЧНЫЕ\r\n\t//               |\tСотрудники.ФизическоеЛицо КАК ФизическоеЛицо\r\n\t//               |ИЗ\r\n\t//               |\tВТСотрудники КАК Сотрудники\";\r\n\t//МассивСотрудников = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку(\"ФизическоеЛицо\");\r\n\t\r\n    МассивСотрудников = Новый Массив;\r\n    МассивСотрудников.Добавить(Справочники.Сотрудники.НайтиПоНаименованию(\"Иванов Иван Иванович\"));\r\n\t\r\n    СоздатьВТСотрудники(МенеджерВременныхТаблиц, МассивСотрудников, ДатаНачала);\r\n    УчетРабочегоВремениРасширенный.СоздатьВТДанныеУчетаРабочегоВремениСотрудников(МенеджерВременныхТаблиц, Истина, ПараметрыПолученияДанных);\r\n\t\r\n\t//Колонка \"План\" говорит о наличии введенного документа Табель, если значение Ложь значит создан документ Табель.\r\n\t\r\n\tДанныеТабеляТ13 = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТДанныеУчетаРабочегоВремениСотрудников\").ПолучитьДанные().Выгрузить();\r\n\t\r\n\tНормаПоГрафику = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТНормаВремени\").ПолучитьДанные().Выгрузить();\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура Команда1(Команда)\r\n    Команда1НаСервере();\r\nКонецПроцедуры\r\n\r\n&НаСервереБезКонтекста\r\nПроцедура СоздатьВТСотрудники(МенеджерВременныхТаблиц, МассивСотрудников, Месяц, ДатаАктуальности = Неопределено, ДатаНачала = Неопределено, ДатаОкончания = Неопределено)\r\n\t\r\n    ТаблицаСотрудники = Новый ТаблицаЗначений;\r\n    ТаблицаСотрудники.Колонки.Добавить(\"Сотрудник\", Новый ОписаниеТипов(\"СправочникСсылка.Сотрудники\"));\r\n    ТаблицаСотрудники.Колонки.Добавить(\"Месяц\", Новый ОписаниеТипов(\"Дата\"));\r\n    ТаблицаСотрудники.Колонки.Добавить(\"ДатаАктуальности\", Новый ОписаниеТипов(\"Дата\"));\r\n    ТаблицаСотрудники.Колонки.Добавить(\"ДатаНачала\", Новый ОписаниеТипов(\"Дата\"));\r\n    ТаблицаСотрудники.Колонки.Добавить(\"ДатаОкончания\", Новый ОписаниеТипов(\"Дата\"));    \r\n    \r\n    Для Каждого Сотрудник Из МассивСотрудников Цикл\r\n        СтрокаСотрудники = ТаблицаСотрудники.Добавить();\r\n        СтрокаСотрудники.Сотрудник = Сотрудник;\r\n    КонецЦикла;\r\n    \r\n    ТаблицаСотрудники.ЗаполнитьЗначения(Месяц, \"Месяц\");\r\n    ТаблицаСотрудники.ЗаполнитьЗначения(?(ДатаАктуальности = Неопределено, ТекущаяДата(), ДатаАктуальности), \"ДатаАктуальности\");\r\n    ТаблицаСотрудники.ЗаполнитьЗначения(?(ДатаНачала = Неопределено, Месяц, ДатаНачала), \"ДатаНачала\");\r\n    ТаблицаСотрудники.ЗаполнитьЗначения(?(ДатаОкончания = Неопределено, КонецМесяца(Месяц), ДатаОкончания), \"ДатаОкончания\");\r\n    \r\n    Запрос = Новый Запрос(\r\n    \"ВЫБРАТЬ\r\n    |    ТаблицаСотрудники.Сотрудник,\r\n    |    ТаблицаСотрудники.Месяц,\r\n    |    ТаблицаСотрудники.ДатаАктуальности,        \r\n    |    ТаблицаСотрудники.ДатаНачала,\r\n    |    ТаблицаСотрудники.ДатаОкончания\r\n    |ПОМЕСТИТЬ ВТСотрудники\r\n    |ИЗ\r\n    |    &ТаблицаСотрудники КАК ТаблицаСотрудники\");\r\n    \r\n    Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n    Запрос.УстановитьПараметр(\"ТаблицаСотрудники\", ТаблицаСотрудники);\r\n    Запрос.Выполнить();\r\n\t\r\nКонецПроцедуры\n\n//В ДАННОМ ПРИМЕРЕ МОЖНО ПОЛУЧИТЬ ДАННЫЕ ВРЕМЕНИ ТОЛЬКО ЗА ОДИН МЕСЯЦ\r\n\r\n&НаСервере\r\nПроцедура Команда1НаСервере()\r\n\t\r\n    ПараметрыПолученияДанных = УчетРабочегоВремениРасширенный.ПараметрыПолученияДанныхУчетаВремени();\r\n    ДатаНачала = '20180901';\r\n    ДатаОкончания = КонецМесяца(ДатаНачала);\r\n    ПараметрыПолученияДанных.ДатаНачала = ДатаНачала;\r\n    ПараметрыПолученияДанных.ДатаОкончания = ДатаОкончания;\r\n    \r\n    МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;\r\n\t\r\n\t//Запрос.Текст = \"ВЫБРАТЬ РАЗЛИЧНЫЕ\r\n\t//               |\tСотрудники.ФизическоеЛицо КАК ФизическоеЛицо\r\n\t//               |ИЗ\r\n\t//               |\tВТСотрудники КАК Сотрудники\";\r\n\t//МассивСотрудников = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку(\"ФизическоеЛицо\");\r\n\t\r\n    МассивСотрудников = Новый Массив;\r\n    МассивСотрудников.Добавить(Справочники.Сотрудники.НайтиПоНаименованию(\"Иванов Иван Иванович\"));\r\n\t\r\n    СоздатьВТСотрудники(МенеджерВременныхТаблиц, МассивСотрудников, ДатаНачала);\r\n    УчетРабочегоВремениРасширенный.СоздатьВТДанныеУчетаРабочегоВремениСотрудников(МенеджерВременныхТаблиц, Истина, ПараметрыПолученияДанных);\r\n\t\r\n\t//Колонка \"План\" говорит о наличии введенного документа Табель, если значение Ложь значит создан документ Табель.\r\n\t\r\n\tДанныеТабеляТ13 = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТДанныеУчетаРабочегоВремениСотрудников\").ПолучитьДанные().Выгрузить();\r\n\t\r\n\tНормаПоГрафику = МенеджерВременныхТаблиц.Таблицы.Найти(\"ВТНормаВремени\").ПолучитьДанные().Выгрузить();\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура Команда1(Команда)\r\n    Команда1НаСервере();\r\nКонецПроцедуры\r\n\r\n&НаСервереБезКонтекста\r\nПроцедура СоздатьВТСотрудники(МенеджерВременныхТаблиц, МассивСотрудников, Месяц, ДатаАктуальности = Неопределено, ДатаНачала = Неопределено, ДатаОкончания = Неопределено)\r\n\t\r\n    ТаблицаСотрудники = Новый ТаблицаЗначений;\r\n    ТаблицаСотрудники.Колонки.Добавить(\"Сотрудник\", Новый ОписаниеТипов(\"СправочникСсылка.Сотрудники\"));\r\n    ТаблицаСотрудники.Колонки.Добавить(\"Месяц\", Новый ОписаниеТипов(\"Дата\"));\r\n    ТаблицаСотрудники.Колонки.Добавить(\"ДатаАктуальности\", Новый ОписаниеТипов(\"Дата\"));\r\n    ТаблицаСотрудники.Колонки.Добавить(\"ДатаНачала\", Новый ОписаниеТипов(\"Дата\"));\r\n    ТаблицаСотрудники.Колонки.Добавить(\"ДатаОкончания\", Новый ОписаниеТипов(\"Дата\"));    \r\n    \r\n    Для Каждого Сотрудник Из МассивСотрудников Цикл\r\n        СтрокаСотрудники = ТаблицаСотрудники.Добавить();\r\n        СтрокаСотрудники.Сотрудник = Сотрудник;\r\n    КонецЦикла;\r\n    \r\n    ТаблицаСотрудники.ЗаполнитьЗначения(Месяц, \"Месяц\");\r\n    ТаблицаСотрудники.ЗаполнитьЗначения(?(ДатаАктуальности = Неопределено, ТекущаяДата(), ДатаАктуальности), \"ДатаАктуальности\");\r\n    ТаблицаСотрудники.ЗаполнитьЗначения(?(ДатаНачала = Неопределено, Месяц, ДатаНачала), \"ДатаНачала\");\r\n    ТаблицаСотрудники.ЗаполнитьЗначения(?(ДатаОкончания = Неопределено, КонецМесяца(Месяц), ДатаОкончания), \"ДатаОкончания\");\r\n    \r\n    Запрос = Новый Запрос(\r\n    \"ВЫБРАТЬ\r\n    |    ТаблицаСотрудники.Сотрудник,\r\n    |    ТаблицаСотрудники.Месяц,\r\n    |    ТаблицаСотрудники.ДатаАктуальности,        \r\n    |    ТаблицаСотрудники.ДатаНачала,\r\n    |    ТаблицаСотрудники.ДатаОкончания\r\n    |ПОМЕСТИТЬ ВТСотрудники\r\n    |ИЗ\r\n    |    &ТаблицаСотрудники КАК ТаблицаСотрудники\");\r\n    \r\n    Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;\r\n    Запрос.УстановитьПараметр(\"ТаблицаСотрудники\", ТаблицаСотрудники);\r\n    Запрос.Выполнить();\r\n\t\r\nКонецПроцедуры\n\n{28} Переменной ДанныеТабеляТ13 присвоено значение, но оно нигде не используется\r\n{30} Переменной НормаПоГрафику присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Работающие сотрудники",
    "description": "Работающие сотрудники",
    "code_snippet": "//Пример функция для получения актуальных работающих сотрудников за период\r\n//Возвращается таблица значений\r\n\r\nФункция ПроверитьНаличиеПодработки(Сотрудник, ДатаНазначения)\r\n\t\r\n\tСтруктураДанных = Новый Структура();\r\n\t\r\n\tСтруктураДанных.Вставить(\"ДатаНачала\",);\r\n\tСтруктураДанных.Вставить(\"ДатаОкончания\",);\r\n\tСтруктураДанных.Вставить(\"РазмерОклада\",);\r\n\t\r\n\tПараметрыПолучения = ПолучитьПараметры();\r\n\tПараметрыПолучения.Организация = ЭтотОбъект.Организация;\r\n\t\r\n\t//Если ЗначениеЗаполнено(Подразделение) Тогда\r\n\t//\tПараметрыПолучения.Подразделение = Подразделение;\t\r\n\t//КонецЕсли;\r\n\t\r\n\t//Если ВключаяУволенныхНаНачалоПериода Тогда\r\n\t//\tПараметрыПолучения.ВключаяУволенныхНаНачалоПериода = Истина;\r\n\t//КонецЕсли;\r\n\t\r\n\tПараметрыПолучения.НачалоПериода = НачалоМесяца(ДатаНазначения);\r\n\tПараметрыПолучения.ОкончаниеПериода = КонецМесяца(ДатаНазначения);\r\n\tПараметрыПолучения.ПодработкиРаботниковПоТрудовымДоговорам = Истина;\r\n\tПараметрыПолучения.РаботникиПоДоговорамГПХ = Ложь;\r\n\t\r\n\t// ОТБОР ПО ВИДУ ЗАНЯТОСТИ РАБОТАЕТ ТОЛЬКО НАЧИНАЯ С РЕДАКЦИИ 3.1.7\r\n\t//ЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\t//\t\t\tПараметрыПолучения.Отборы, \"ВидЗанятости\", \"=\", Перечисления.ВидыЗанятости.Подработка);\r\n\t\t\t\t\r\n\tЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\t\t\t\tПараметрыПолучения.Отборы, \"ФизическоеЛицо\", \"=\", Сотрудник.ФизическоеЛицо);\r\n\r\n\tПараметрыПолучения.КадровыеДанные = \"Сотрудник,ФизическоеЛицо,Подразделение,Должность,ДолжностьПоШтатномуРасписанию,КоличествоСтавок,ВидЗанятости,ДатаПриема,ДатаУвольнения,ГрафикРаботы\";\r\n\t\r\n\tТаблицаСотрудников = КадровыйУчет.СотрудникиОрганизации(Истина, ПараметрыПолучения);\r\n\t\r\n\tВозврат ТаблицаСотрудников;\r\n\t\r\nКонецФункции\r\n\r\n\r\n&НаСервере\r\nФункция ПолучитьПараметры()\r\n\tВозврат КадровыйУчет.ПараметрыПолученияСотрудниковОрганизацийПоСпискуФизическихЛиц();\t\r\nКонецФункции\n\n//Пример функция для получения актуальных работающих сотрудников за период\r\n//Возвращается таблица значений\r\n\r\nФункция ПроверитьНаличиеПодработки(Сотрудник, ДатаНазначения)\r\n\t\r\n\tСтруктураДанных = Новый Структура();\r\n\t\r\n\tСтруктураДанных.Вставить(\"ДатаНачала\",);\r\n\tСтруктураДанных.Вставить(\"ДатаОкончания\",);\r\n\tСтруктураДанных.Вставить(\"РазмерОклада\",);\r\n\t\r\n\tПараметрыПолучения = ПолучитьПараметры();\r\n\tПараметрыПолучения.Организация = ЭтотОбъект.Организация;\r\n\t\r\n\t//Если ЗначениеЗаполнено(Подразделение) Тогда\r\n\t//\tПараметрыПолучения.Подразделение = Подразделение;\t\r\n\t//КонецЕсли;\r\n\t\r\n\t//Если ВключаяУволенныхНаНачалоПериода Тогда\r\n\t//\tПараметрыПолучения.ВключаяУволенныхНаНачалоПериода = Истина;\r\n\t//КонецЕсли;\r\n\t\r\n\tПараметрыПолучения.НачалоПериода = НачалоМесяца(ДатаНазначения);\r\n\tПараметрыПолучения.ОкончаниеПериода = КонецМесяца(ДатаНазначения);\r\n\tПараметрыПолучения.ПодработкиРаботниковПоТрудовымДоговорам = Истина;\r\n\tПараметрыПолучения.РаботникиПоДоговорамГПХ = Ложь;\r\n\t\r\n\t// ОТБОР ПО ВИДУ ЗАНЯТОСТИ РАБОТАЕТ ТОЛЬКО НАЧИНАЯ С РЕДАКЦИИ 3.1.7\r\n\t//ЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\t//\t\t\tПараметрыПолучения.Отборы, \"ВидЗанятости\", \"=\", Перечисления.ВидыЗанятости.Подработка);\r\n\t\t\t\t\r\n\tЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\t\t\t\tПараметрыПолучения.Отборы, \"ФизическоеЛицо\", \"=\", Сотрудник.ФизическоеЛицо);\r\n\r\n\tПараметрыПолучения.КадровыеДанные = \"Сотрудник,ФизическоеЛицо,Подразделение,Должность,ДолжностьПоШтатномуРасписанию,КоличествоСтавок,ВидЗанятости,ДатаПриема,ДатаУвольнения,ГрафикРаботы\";\r\n\t\r\n\tТаблицаСотрудников = КадровыйУчет.СотрудникиОрганизации(Истина, ПараметрыПолучения);\r\n\t\r\n\tВозврат ТаблицаСотрудников;\r\n\t\r\nКонецФункции\r\n\r\n\r\n&НаСервере\r\nФункция ПолучитьПараметры()\r\n\tВозврат КадровыйУчет.ПараметрыПолученияСотрудниковОрганизацийПоСпискуФизическихЛиц();\t\r\nКонецФункции"
  },
  {
    "title": "Паспортные данные физического лица",
    "description": "Паспортные данные физического лица",
    "code_snippet": "ДанныеФизЛица = КадровыйУчет.ДокументыФизическихЛиц(ВыборкаСтрок.ФизическоеЛицо, Истина); \r\n\t\t\t\r\nОбластьМакетаСтрока.Параметры.Паспорт = \"\" + ДанныеФизЛица[0].ВидДокумента + \", \" \r\n+ ДанныеФизЛица[0].Серия + \", \" + ДанныеФизЛица[0].Номер + \", выдан: \" + ДанныеФизЛица[0].КемВыдан;\n\nДанныеФизЛица = КадровыйУчет.ДокументыФизическихЛиц(ВыборкаСтрок.ФизическоеЛицо, Истина); \r\n\t\t\t\r\nОбластьМакетаСтрока.Параметры.Паспорт = \"\" + ДанныеФизЛица[0].ВидДокумента + \", \" \r\n+ ДанныеФизЛица[0].Серия + \", \" + ДанныеФизЛица[0].Номер + \", выдан: \" + ДанныеФизЛица[0].КемВыдан;"
  },
  {
    "title": "Основной сотрудник физ. лица",
    "description": "Основной сотрудник физ. лица",
    "code_snippet": "&НаСервере\r\nПроцедура УстановитьОсновногоСотрудника(ВыводитьСообщения = Истина)\r\n\t\r\n   Объект.ОсновнойСотрудник = КадровыйУчетРасширенный.ОсновнойСотрудникФизЛица(Объект.ФизическоеЛицо, Объект.Организация, Объект.ДатаНачала, ВыводитьСообщения);\r\n\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура УстановитьОсновногоСотрудника(ВыводитьСообщения = Истина)\r\n\t\r\n   Объект.ОсновнойСотрудник = КадровыйУчетРасширенный.ОсновнойСотрудникФизЛица(Объект.ФизическоеЛицо, Объект.Организация, Объект.ДатаНачала, ВыводитьСообщения);\r\n\r\nКонецПроцедуры"
  },
  {
    "title": "Стажи сотрудников",
    "description": "Стажи сотрудников",
    "code_snippet": "&НаСервере\r\nФункция РассчитатьСтажиСотрудниковЗанявшихПозиции(ПозицияШР, Должность, Подразделение, ДатаОтсчета, КатегорияДолжности, ОкладИндекс)\r\n\t\r\n\tСтруктураДанных = Новый Структура();\r\n\t\r\n\tСтруктураДанных.Вставить(\"ДатаНачала\",);\r\n\tСтруктураДанных.Вставить(\"ДатаОкончания\",);\r\n\tСтруктураДанных.Вставить(\"РазмерОклада\",);\r\n\t\r\n\tПараметрыПолучения = ПолучитьПараметры();\r\n\tПараметрыПолучения.Организация = Отчет.Организация;\r\n\t\r\n\t//Если ЗначениеЗаполнено(Подразделение) Тогда\r\n\t//\tПараметрыПолучения.Подразделение = Подразделение;\t\r\n\t//КонецЕсли;\r\n\t\r\n\t//Если ВключаяУволенныхНаНачалоПериода Тогда\r\n\t//\tПараметрыПолучения.ВключаяУволенныхНаНачалоПериода = Истина;\r\n\t//КонецЕсли;\r\n\t\r\n\tПараметрыПолучения.НачалоПериода = НачалоМесяца(ДатаОтсчета);\r\n\tПараметрыПолучения.ОкончаниеПериода = КонецМесяца(ДатаОтсчета);\r\n\tПараметрыПолучения.ПодработкиРаботниковПоТрудовымДоговорам = Истина;\r\n\tПараметрыПолучения.РаботникиПоДоговорамГПХ = Ложь;\r\n\t\r\n\t//ЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\t//ПараметрыПолучения.Отборы, \"ДолжностьПоШтатномуРасписанию\", \"=\", ПозицияШР);\r\n\t\r\n\tЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\tПараметрыПолучения.Отборы, \"Должность\", \"=\", Должность);\r\n\t\r\n\tЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\tПараметрыПолучения.Отборы, \"Подразделение\", \"=\", Подразделение);\r\n\t\r\n\tПараметрыПолучения.КадровыеДанные = \"Сотрудник,ФизическоеЛицо,Подразделение,Должность,ДолжностьПоШтатномуРасписанию,КоличествоСтавок,ВидЗанятости,ДатаПриема,ДатаУвольнения\";\r\n\t\r\n\tТаблицаСотрудников = КадровыйУчет.СотрудникиОрганизации(Истина, ПараметрыПолучения);\r\n\t\r\n\t//ДанныеПозиции = УправлениеШтатнымРасписанием.ДанныеПозицииШтатногоРасписания(ПозицияШР, ДатаОтсчета, Истина);\r\n\t\r\n\tТаблицаСтажей = КадровыйУчетРасширенный.СведенияОСтажахСотрудников(ТаблицаСотрудников);\r\n\t\r\n\tВозврат ТаблицаСтажей;\r\n\t\r\nКонецФункции\n\n&НаСервере\r\nФункция РассчитатьСтажиСотрудниковЗанявшихПозиции(ПозицияШР, Должность, Подразделение, ДатаОтсчета, КатегорияДолжности, ОкладИндекс)\r\n\t\r\n\tСтруктураДанных = Новый Структура();\r\n\t\r\n\tСтруктураДанных.Вставить(\"ДатаНачала\",);\r\n\tСтруктураДанных.Вставить(\"ДатаОкончания\",);\r\n\tСтруктураДанных.Вставить(\"РазмерОклада\",);\r\n\t\r\n\tПараметрыПолучения = ПолучитьПараметры();\r\n\tПараметрыПолучения.Организация = Отчет.Организация;\r\n\t\r\n\t//Если ЗначениеЗаполнено(Подразделение) Тогда\r\n\t//\tПараметрыПолучения.Подразделение = Подразделение;\t\r\n\t//КонецЕсли;\r\n\t\r\n\t//Если ВключаяУволенныхНаНачалоПериода Тогда\r\n\t//\tПараметрыПолучения.ВключаяУволенныхНаНачалоПериода = Истина;\r\n\t//КонецЕсли;\r\n\t\r\n\tПараметрыПолучения.НачалоПериода = НачалоМесяца(ДатаОтсчета);\r\n\tПараметрыПолучения.ОкончаниеПериода = КонецМесяца(ДатаОтсчета);\r\n\tПараметрыПолучения.ПодработкиРаботниковПоТрудовымДоговорам = Истина;\r\n\tПараметрыПолучения.РаботникиПоДоговорамГПХ = Ложь;\r\n\t\r\n\t//ЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\t//ПараметрыПолучения.Отборы, \"ДолжностьПоШтатномуРасписанию\", \"=\", ПозицияШР);\r\n\t\r\n\tЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\tПараметрыПолучения.Отборы, \"Должность\", \"=\", Должность);\r\n\t\r\n\tЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\tПараметрыПолучения.Отборы, \"Подразделение\", \"=\", Подразделение);\r\n\t\r\n\tПараметрыПолучения.КадровыеДанные = \"Сотрудник,ФизическоеЛицо,Подразделение,Должность,ДолжностьПоШтатномуРасписанию,КоличествоСтавок,ВидЗанятости,ДатаПриема,ДатаУвольнения\";\r\n\t\r\n\tТаблицаСотрудников = КадровыйУчет.СотрудникиОрганизации(Истина, ПараметрыПолучения);\r\n\t\r\n\t//ДанныеПозиции = УправлениеШтатнымРасписанием.ДанныеПозицииШтатногоРасписания(ПозицияШР, ДатаОтсчета, Истина);\r\n\t\r\n\tТаблицаСтажей = КадровыйУчетРасширенный.СведенияОСтажахСотрудников(ТаблицаСотрудников);\r\n\t\r\n\tВозврат ТаблицаСтажей;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Кадровые данные сотрудника",
    "description": "Кадровые данные сотрудника",
    "code_snippet": "КадровыеДанныеСотрудников = КадровыйУчет.КадровыеДанныеСотрудников(Истина, \r\n    ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Строка), \r\n    \"Организация,ФизическоеЛицо,ТабельныйНомер,Подразделение,Должность,ВидЗанятости,ДолжностьПоШтатномуРасписанию,КоличествоСтавок,ДатаПриема,ДатаУвольнения,ГрафикРаботы,СтатьяФинансирования, РазрядКатегория \", ТекущаяДата());\r\n\r\n// Список всех возможных кадровых данных\r\n//\r\n// ФИОПолные\r\n// Пол\r\n// ТабельныйНомер\r\n// Организация\r\n// Подразделение\r\n// Должность\r\n// ДатаПриема\r\n// ДатаУвольнения\r\n// Возраст\r\n// Фамилия\r\n// Имя\r\n// Отчество\r\n// Наименование\r\n// ФизическоеЛицоНаименование\r\n// Код\r\n// ФизическоеЛицоКод\r\n// АдресДляИнформирования\r\n// АдресДляИнформированияПредставление\r\n// АдресЗаПределамиРФ\r\n// АдресЗаПределамиРФПредставление\r\n// АдресМестаПроживания\r\n// АдресМестаПроживанияПредставление\r\n// АдресПоПрописке\r\n// АдресПоПропискеПредставление\r\n// ТелефонДомашний\r\n// ТелефонДомашнийПредставление\r\n// ТелефонРабочий\r\n// ТелефонРабочийПредставление\r\n// EMail\r\n// EMailПредставление\r\n// ДокументПериодРегистрации\r\n// ДокументВид\r\n// ДокументКодМВД\r\n// ДокументСерия\r\n// ДокументНомер\r\n// ДокументДатаВыдачи\r\n// ДокументСрокДействия\r\n// ДокументКемВыдан\r\n// ДокументКодПодразделения\r\n// ДокументПредставление\r\n// ИнвалидностьПериодРегистрации\r\n// Инвалидность\r\n// ИнвалидностьДатаВыдачи\r\n// ИнвалидностьСрокДействияСправки\r\n// ГражданствоПериодРегистрации\r\n// Страна\r\n// ИННВСтранеГражданства\r\n// ПроцентСевернойНадбавки\r\n// ТекущаяОрганизация\r\n// ТекущееПодразделение\r\n// ТекущаяДолжность\r\n// ТекущийВидЗанятости\r\n// ОсновноеРабочееМестоВОрганизации\r\n// ДатаПриема\r\n// ДатаЗавершенияРаботы\r\n// ОформленПоТрудовомуДоговору\r\n// ДатаУвольнения\r\n// ТекущаяТарифнаяСтавка\r\n// ТекущийСпособРасчетаАванса\r\n// ТекущийАванс\r\n// ДатаНачалаУчета\r\n// ПриказОПриеме\r\n// ПриказОПриемеДата\r\n// ПриказОПриемеНомер\r\n// НазначениеПодработки\r\n// ПриказОбУвольнении\r\n// ПриказОбУвольненииДата\r\n// ПриказОбУвольненииНомер\r\n// ПриказОбУвольненииСтатьяТКРФ\r\n// ПрекращениеПодработки\r\n// РабочееМестоПериодРегистрации\r\n// РабочееМестоРегистратор\r\n// ВидСобытия\r\n// КоличествоСтавок\r\n// ЭтоГоловнойСотрудник\r\n// УчетЗатратПериодРегистрации\r\n// СпособОтраженияЗарплатыВБухучете\r\n// ОтношениеКЕНВД\r\n// СтатьяФинансирования\r\n// УчетЗатратДокументОснование\r\n// ОплатаТрудаПериодЗаписи\r\n// ОплатаТрудаРегистратор\r\n// ТарифнаяСтавка\r\n// ФОТ\r\n// Надбавка\r\n// ВидЗанятостиПериодЗаписи\r\n// ВидЗанятостиРегистратор\r\n// ВидЗанятости\r\n// АвансПериодЗаписи\r\n// АвансРегистратор\r\n// СпособРасчетаАванса\r\n// Аванс\r\n// КлассУсловийТрудаПериодРегистрации\r\n// КлассУсловийТруда\r\n// КлассУсловийТрудаДатаРегистрацииИзменений\r\n// ЗарплатныйПроектПериодРегистрации\r\n// ЗарплатныйПроектРегистратор\r\n// ЗарплатныйПроект\r\n// НомерЛицевогоСчета.\n\nКадровыеДанныеСотрудников = КадровыйУчет.КадровыеДанныеСотрудников(Истина, \r\n    ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Строка), \r\n    \"Организация,ФизическоеЛицо,ТабельныйНомер,Подразделение,Должность,ВидЗанятости,ДолжностьПоШтатномуРасписанию,КоличествоСтавок,ДатаПриема,ДатаУвольнения,ГрафикРаботы,СтатьяФинансирования, РазрядКатегория \", ТекущаяДата());\r\n\r\n// Список всех возможных кадровых данных\r\n//\r\n// ФИОПолные\r\n// Пол\r\n// ТабельныйНомер\r\n// Организация\r\n// Подразделение\r\n// Должность\r\n// ДатаПриема\r\n// ДатаУвольнения\r\n// Возраст\r\n// Фамилия\r\n// Имя\r\n// Отчество\r\n// Наименование\r\n// ФизическоеЛицоНаименование\r\n// Код\r\n// ФизическоеЛицоКод\r\n// АдресДляИнформирования\r\n// АдресДляИнформированияПредставление\r\n// АдресЗаПределамиРФ\r\n// АдресЗаПределамиРФПредставление\r\n// АдресМестаПроживания\r\n// АдресМестаПроживанияПредставление\r\n// АдресПоПрописке\r\n// АдресПоПропискеПредставление\r\n// ТелефонДомашний\r\n// ТелефонДомашнийПредставление\r\n// ТелефонРабочий\r\n// ТелефонРабочийПредставление\r\n// EMail\r\n// EMailПредставление\r\n// ДокументПериодРегистрации\r\n// ДокументВид\r\n// ДокументКодМВД\r\n// ДокументСерия\r\n// ДокументНомер\r\n// ДокументДатаВыдачи\r\n// ДокументСрокДействия\r\n// ДокументКемВыдан\r\n// ДокументКодПодразделения\r\n// ДокументПредставление\r\n// ИнвалидностьПериодРегистрации\r\n// Инвалидность\r\n// ИнвалидностьДатаВыдачи\r\n// ИнвалидностьСрокДействияСправки\r\n// ГражданствоПериодРегистрации\r\n// Страна\r\n// ИННВСтранеГражданства\r\n// ПроцентСевернойНадбавки\r\n// ТекущаяОрганизация\r\n// ТекущееПодразделение\r\n// ТекущаяДолжность\r\n// ТекущийВидЗанятости\r\n// ОсновноеРабочееМестоВОрганизации\r\n// ДатаПриема\r\n// ДатаЗавершенияРаботы\r\n// ОформленПоТрудовомуДоговору\r\n// ДатаУвольнения\r\n// ТекущаяТарифнаяСтавка\r\n// ТекущийСпособРасчетаАванса\r\n// ТекущийАванс\r\n// ДатаНачалаУчета\r\n// ПриказОПриеме\r\n// ПриказОПриемеДата\r\n// ПриказОПриемеНомер\r\n// НазначениеПодработки\r\n// ПриказОбУвольнении\r\n// ПриказОбУвольненииДата\r\n// ПриказОбУвольненииНомер\r\n// ПриказОбУвольненииСтатьяТКРФ\r\n// ПрекращениеПодработки\r\n// РабочееМестоПериодРегистрации\r\n// РабочееМестоРегистратор\r\n// ВидСобытия\r\n// КоличествоСтавок\r\n// ЭтоГоловнойСотрудник\r\n// УчетЗатратПериодРегистрации\r\n// СпособОтраженияЗарплатыВБухучете\r\n// ОтношениеКЕНВД\r\n// СтатьяФинансирования\r\n// УчетЗатратДокументОснование\r\n// ОплатаТрудаПериодЗаписи\r\n// ОплатаТрудаРегистратор\r\n// ТарифнаяСтавка\r\n// ФОТ\r\n// Надбавка\r\n// ВидЗанятостиПериодЗаписи\r\n// ВидЗанятостиРегистратор\r\n// ВидЗанятости\r\n// АвансПериодЗаписи\r\n// АвансРегистратор\r\n// СпособРасчетаАванса\r\n// Аванс\r\n// КлассУсловийТрудаПериодРегистрации\r\n// КлассУсловийТруда\r\n// КлассУсловийТрудаДатаРегистрацииИзменений\r\n// ЗарплатныйПроектПериодРегистрации\r\n// ЗарплатныйПроектРегистратор\r\n// ЗарплатныйПроект\r\n// НомерЛицевогоСчета.\n\n{3} Переменной КадровыеДанныеСотрудников присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в ЗарплатныйПроектПериодРегистрации: Зарплатный\r\nОрфографическая ошибка в ЗарплатныйПроектРегистратор: Зарплатный\r\nОрфографическая ошибка в ЗарплатныйПроект: Зарплатный"
  },
  {
    "title": "Действующие плановые начисления на дату",
    "description": "Действующие плановые начисления на дату",
    "code_snippet": "//Функция возвращает актуальные плановые начисления сотрудников на заданную дату в виде таблицы значений\r\n\r\nТекущиеДанныеОплатыТруда = КадровыйУчетРасширенный.ТекущиеНачисленияСотрудника(Сотрудник, ТекущаяДата(),,);\r\n\r\n//Или для списка сотрудников\r\n\r\nТекущиеДанныеОплатыТруда = КадровыйУчетРасширенный.ТекущиеНачисленияСотрудников(МассивСотрудник, ТекущаяДата(),,);\n\n//Функция возвращает актуальные плановые начисления сотрудников на заданную дату в виде таблицы значений\r\n\r\nТекущиеДанныеОплатыТруда = КадровыйУчетРасширенный.ТекущиеНачисленияСотрудника(Сотрудник, ТекущаяДата(),,);\r\n\r\n//Или для списка сотрудников\r\n\r\nТекущиеДанныеОплатыТруда = КадровыйУчетРасширенный.ТекущиеНачисленияСотрудников(МассивСотрудник, ТекущаяДата(),,);\n\n{3} Переменной ТекущиеДанныеОплатыТруда присвоено значение, но оно нигде не используется\r\n{7} Переменной ТекущиеДанныеОплатыТруда присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Получить данные позиции штатного расписания",
    "description": "Получить данные позиции штатного расписания",
    "code_snippet": "//Функция возвращает данные позиции штатного расписания на заданную дату в виде таблицы значений\r\n\r\nДанныеПозиции = УправлениеШтатнымРасписанием.ДанныеПозицииШтатногоРасписания(Позиция, ТекущаяДата(), Истина);\n\n//Функция возвращает данные позиции штатного расписания на заданную дату в виде таблицы значений\r\n\r\nДанныеПозиции = УправлениеШтатнымРасписанием.ДанныеПозицииШтатногоРасписания(Позиция, ТекущаяДата(), Истина);\n\n{3} Переменной ДанныеПозиции присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Чтение XML в таблицу значений",
    "description": "Чтение XML в таблицу значений",
    "code_snippet": "Режим = РежимДиалогаВыбораФайла.Открытие;\r\n\tДиалогОткрытияФайла = Новый ДиалогВыбораФайла(Режим);        \r\n\tДиалогОткрытияФайла.ПолноеИмяФайла = \"\";\r\n\tФильтр = \"Текст(*.XML)|*.XML\";\r\n\tДиалогОткрытияФайла.Фильтр = Фильтр;\r\n\tДиалогОткрытияФайла.МножественныйВыбор = Ложь;             \r\n\tДиалогОткрытияФайла.Заголовок = \"Выберите файл для загрузки\";\r\n\t\r\n\tЕсли ДиалогОткрытияФайла.Выбрать() Тогда \r\n\t\tПутьКФайлу = ДиалогОткрытияФайла.ПолноеИмяФайла;\r\n\t\tЧтениеXML = Новый ЧтениеXML;\r\n\t\tЧтениеXML.ОткрытьФайл(ПутьКФайлу);\r\n\t\tСериализатор = Новый СериализаторXDTO(ФабрикаXDTO);\r\n\t\tТЗ = Сериализатор.ПрочитатьXML(ЧтениеXML,Тип(\"ТаблицаЗначений\"));\r\n\t\tЧтениеXML.Закрыть();\r\n\tКонецЕсли;\r\n\t\r\n\t\tЭтотОбъект.Контрагент \t\t  \t= Справочники.Контрагенты.НайтиПоРеквизиту(\"ИНН\", ТЗ[0].КонтрагентИНН);\r\n\t\tЭтотОбъект.КРВ_IDМенеджер\t  \t= ТЗ[0].IDМенеджер;\r\n\t\tЭтотОбъект.КРВ_НомерЗаказаУНФ \t= ТЗ[0].Номер;\r\n\t\tЭтотОбъект.Склад \t\t\t\t= Справочники.Склады.НайтиПоНаименованию(ТЗ[0].Склад);\r\n\t\r\nДля каждого СтрокаТЗ Из ТЗ Цикл\r\nКонецЦикла;\n\nРежим = РежимДиалогаВыбораФайла.Открытие;\r\n\tДиалогОткрытияФайла = Новый ДиалогВыбораФайла(Режим);        \r\n\tДиалогОткрытияФайла.ПолноеИмяФайла = \"\";\r\n\tФильтр = \"Текст(*.XML)|*.XML\";\r\n\tДиалогОткрытияФайла.Фильтр = Фильтр;\r\n\tДиалогОткрытияФайла.МножественныйВыбор = Ложь;             \r\n\tДиалогОткрытияФайла.Заголовок = \"Выберите файл для загрузки\";\r\n\t\r\n\tЕсли ДиалогОткрытияФайла.Выбрать() Тогда \r\n\t\tПутьКФайлу = ДиалогОткрытияФайла.ПолноеИмяФайла;\r\n\t\tЧтениеXML = Новый ЧтениеXML;\r\n\t\tЧтениеXML.ОткрытьФайл(ПутьКФайлу);\r\n\t\tСериализатор = Новый СериализаторXDTO(ФабрикаXDTO);\r\n\t\tТЗ = Сериализатор.ПрочитатьXML(ЧтениеXML,Тип(\"ТаблицаЗначений\"));\r\n\t\tЧтениеXML.Закрыть();\r\n\tКонецЕсли;\r\n\t\r\n\t\tЭтотОбъект.Контрагент \t\t  \t= Справочники.Контрагенты.НайтиПоРеквизиту(\"ИНН\", ТЗ[0].КонтрагентИНН);\r\n\t\tЭтотОбъект.КРВ_IDМенеджер\t  \t= ТЗ[0].IDМенеджер;\r\n\t\tЭтотОбъект.КРВ_НомерЗаказаУНФ \t= ТЗ[0].Номер;\r\n\t\tЭтотОбъект.Склад \t\t\t\t= Справочники.Склады.НайтиПоНаименованию(ТЗ[0].Склад);\r\n\t\r\nДля каждого СтрокаТЗ Из ТЗ Цикл\r\nКонецЦикла;"
  },
  {
    "title": "Сохранение таблицы значений в XML",
    "description": "Сохранение таблицы значений в XML",
    "code_snippet": "ДанныеНакладной = Новый ТаблицаЗначений();\r\n\tДанныеНакладной.Колонки.Добавить(\"НоменклатураАртикул\");\r\n\tДанныеНакладной.Колонки.Добавить(\"Количество\");\r\n\tДанныеНакладной.Колонки.Добавить(\"Цена\");\r\n\t\r\n\tДля Каждого Стр Из Товары Цикл\r\n\t\tЕсли Стр.Номенклатура.Артикул = \"\" Тогда\r\n\t\t\tСообщить (\"Внимание! В номенклатуре \" + Стр.Номенклатура + \" не определен артикул.\");\r\n\t\tИначе\t\t\r\n\t\t\tСтрокаТЗ = ДанныеНакладной.Добавить();\r\n\t\t\tСтрокаТЗ.НоменклатураАртикул = Стр.Номенклатура.Артикул;\r\n\t\t\tСтрокаТЗ.Количество = Стр.Количество;\r\n\t\t\tСтрокаТЗ.Цена = Стр.Цена;\t\t\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tСериализатор = Новый СериализаторXDTO(ФабрикаXDTO);\r\n\tXML = Новый ЗаписьXML;\r\n\tИмяФайла = \"\" + КРВ_ВспомогательныеФункции.УбратьНули(Номер)\r\n\t+ \" - \" + КРВ_ВспомогательныеФункции.УбратьНедопустимыеСимволы(Контрагент);\r\n\t\r\n\tXML.ОткрытьФайл(\"d:\\1C_DATA\\ОБМЕН\\\" + ИмяФайла + \".xml\");\r\n\tСериализатор.ЗаписатьXML(XML, ДанныеНакладной);\n\nДанныеНакладной = Новый ТаблицаЗначений();\r\n\tДанныеНакладной.Колонки.Добавить(\"НоменклатураАртикул\");\r\n\tДанныеНакладной.Колонки.Добавить(\"Количество\");\r\n\tДанныеНакладной.Колонки.Добавить(\"Цена\");\r\n\t\r\n\tДля Каждого Стр Из Товары Цикл\r\n\t\tЕсли Стр.Номенклатура.Артикул = \"\" Тогда\r\n\t\t\tСообщить (\"Внимание! В номенклатуре \" + Стр.Номенклатура + \" не определен артикул.\");\r\n\t\tИначе\t\t\r\n\t\t\tСтрокаТЗ = ДанныеНакладной.Добавить();\r\n\t\t\tСтрокаТЗ.НоменклатураАртикул = Стр.Номенклатура.Артикул;\r\n\t\t\tСтрокаТЗ.Количество = Стр.Количество;\r\n\t\t\tСтрокаТЗ.Цена = Стр.Цена;\t\t\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tСериализатор = Новый СериализаторXDTO(ФабрикаXDTO);\r\n\tXML = Новый ЗаписьXML;\r\n\tИмяФайла = \"\" + КРВ_ВспомогательныеФункции.УбратьНули(Номер)\r\n\t+ \" - \" + КРВ_ВспомогательныеФункции.УбратьНедопустимыеСимволы(Контрагент);\r\n\t\r\n\tXML.ОткрытьФайл(\"d:\\1C_DATA\\ОБМЕН\\\" + ИмяФайла + \".xml\");\r\n\tСериализатор.ЗаписатьXML(XML, ДанныеНакладной);"
  },
  {
    "title": "SmartProxy",
    "description": "Библиотека для получения работающих https прокси серверов.",
    "code_snippet": ""
  },
  {
    "title": "diff3cf",
    "description": "Утилита для автоматического сравнения переопределенных в расширении модулей измененных в новом релизе поставки основной конфигурации",
    "code_snippet": ""
  },
  {
    "title": "Как по GUID определить время и дату создания ссылки?",
    "description": "Как по GUID определить время и дату создания ссылки?",
    "code_snippet": "Функция UUID_Timestamp(Ссылка)\r\n\t\r\n\tГУИД = Ссылка.УникальныйИдентификатор();\r\n    // Например ГУИД равен: bdb62d89-cede-11e4-b12b-d4ae52b5e909\r\n    // Дата содержится в первых символах, bdb62d89-cede-11e4 которые нужно переставить задом наперед: 11e4-cede-bdb62d89\r\n    Строка16 = Сред(ГУИД, 15, 4) + Сред(ГУИД, 10, 4) + Сред(ГУИД, 1, 8);\r\n    \r\n    // Убираем \"лишние\" знаки \"-\"(тире).\r\n    Строка16 = СтрЗаменить(Строка16, \"-\", \"\");\r\n    \r\n    // Убираем первый символ, так как в нем содержится версия стандарта (зашит в седьмой октет)\r\n    Строка15 = Сред(Строка16, 2);\r\n    \r\n    // Получаем timestamp в 60 бит : 1E4 CEDE BDB6 2D89\r\n    ЧислоСек = 0;\r\n    Для Позиция = 1 По СтрДлина(Строка15) Цикл\r\n        ЧислоСек = ЧислоСек + Найти(\"123456789abcdef\",Сред(Строка15,Позиция,1))*Pow(16,СтрДлина(Строка15) - Позиция);\r\n    КонецЦикла;\r\n    ЧислоСек = ЧислоСек / 10000000;\r\n    \r\n    // Прибавляем к дате начала Григореанского календаря\r\n    Возврат Дата(1582, 10, 15, 00, 00, 00) + ЧислоСек + СмещениеСтандартногоВремени() + СмещениеЛетнегоВремени();;\r\n    \r\nКонецФункции\n\nФункция UUID_Timestamp(Ссылка)\r\n\t\r\n\tГУИД = Ссылка.УникальныйИдентификатор();\r\n    // Например ГУИД равен: bdb62d89-cede-11e4-b12b-d4ae52b5e909\r\n    // Дата содержится в первых символах, bdb62d89-cede-11e4 которые нужно переставить задом наперед: 11e4-cede-bdb62d89\r\n    Строка16 = Сред(ГУИД, 15, 4) + Сред(ГУИД, 10, 4) + Сред(ГУИД, 1, 8);\r\n    \r\n    // Убираем \"лишние\" знаки \"-\"(тире).\r\n    Строка16 = СтрЗаменить(Строка16, \"-\", \"\");\r\n    \r\n    // Убираем первый символ, так как в нем содержится версия стандарта (зашит в седьмой октет)\r\n    Строка15 = Сред(Строка16, 2);\r\n    \r\n    // Получаем timestamp в 60 бит : 1E4 CEDE BDB6 2D89\r\n    ЧислоСек = 0;\r\n    Для Позиция = 1 По СтрДлина(Строка15) Цикл\r\n        ЧислоСек = ЧислоСек + Найти(\"123456789abcdef\",Сред(Строка15,Позиция,1))*Pow(16,СтрДлина(Строка15) - Позиция);\r\n    КонецЦикла;\r\n    ЧислоСек = ЧислоСек / 10000000;\r\n    \r\n    // Прибавляем к дате начала Григореанского календаря\r\n    Возврат Дата(1582, 10, 15, 00, 00, 00) + ЧислоСек + СмещениеСтандартногоВремени() + СмещениеЛетнегоВремени();;\r\n    \r\nКонецФункции\n\nОрфографическая ошибка в Григореанского: Григореанского\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Веб сервис БУХ обращение",
    "description": "Веб сервис БУХ обращение",
    "code_snippet": "&НаСервереБезКонтекста\r\nФункция ПолучитьПроксиУниверсальныйВебСервисЕРП(ТестовыйСервер)\r\n\t\r\n\tПараметрыПрокси = ПолучитьПараметрыПрокси(ТестовыйСервер);\r\n\t\r\n\tАдресWS\t\t\t= ПараметрыПрокси.АдресWS;\r\n\tПользователь\t= ПараметрыПрокси.Пользователь;\r\n\tПароль\t\t\t= ПараметрыПрокси.Пароль;\r\n\t\r\n\tПопытка\r\n\t\tОпределение = Новый WSОпределения(АдресWS, Пользователь, Пароль);\r\n\t\t\r\n\t\tПрокси = Новый WSПрокси(Определение, \"gm_BuhExchangeURL\", \"gm_BuhExchange\", \"gm_BuhExchangeSoap\");\r\n\t\tПрокси.Пользователь\t= Пользователь;\r\n\t\tПрокси.Пароль\t\t= Пароль;\t\r\n\tИсключение\t\r\n\t\tЗаписьЖурналаРегистрации(\"ВебСервис\",УровеньЖурналаРегистрации.Ошибка,,, \"ПолучитьПроксиУниверсальныйВебСервисБух()\"+ Символы.ПС + ОписаниеОшибки());\r\n\t\tВозврат Неопределено;\t\r\n\tКонецПопытки;\t\r\n\t\r\n\tВозврат Прокси;\r\n\t\r\nКонецФункции\r\n\r\n&НаСервереБезКонтекста\r\nФункция ПолучитьПараметрыПрокси(ТестовыйСервер)\r\n\t\r\n\tСтруктураПараметров = Новый Структура();\t\r\n\t\r\n\tСтруктураПараметров.Вставить(\"АдресWS\",\"http://192.168.12.11/buh_centr/ws/gm_BuhExchange.1cws?wsdl\"); //\"http://192.168.12.11/buh_centr/ws/gm_BuhExchange.1cws?wsdl\"\r\n\t\r\n\tСтруктураПараметров.Вставить(\"Пользователь\",\"WS_Обмен\");\r\n\tСтруктураПараметров.Вставить(\"Пароль\",\"123456\");\r\n\t\r\n\tВозврат СтруктураПараметров;\r\n\t\r\nКонецФункции\n\n&НаСервереБезКонтекста\r\nФункция ПолучитьПроксиУниверсальныйВебСервисЕРП(ТестовыйСервер)\r\n\t\r\n\tПараметрыПрокси = ПолучитьПараметрыПрокси(ТестовыйСервер);\r\n\t\r\n\tАдресWS\t\t\t= ПараметрыПрокси.АдресWS;\r\n\tПользователь\t= ПараметрыПрокси.Пользователь;\r\n\tПароль\t\t\t= ПараметрыПрокси.Пароль;\r\n\t\r\n\tПопытка\r\n\t\tОпределение = Новый WSОпределения(АдресWS, Пользователь, Пароль);\r\n\t\t\r\n\t\tПрокси = Новый WSПрокси(Определение, \"gm_BuhExchangeURL\", \"gm_BuhExchange\", \"gm_BuhExchangeSoap\");\r\n\t\tПрокси.Пользователь\t= Пользователь;\r\n\t\tПрокси.Пароль\t\t= Пароль;\t\r\n\tИсключение\t\r\n\t\tЗаписьЖурналаРегистрации(\"ВебСервис\",УровеньЖурналаРегистрации.Ошибка,,, \"ПолучитьПроксиУниверсальныйВебСервисБух()\"+ Символы.ПС + ОписаниеОшибки());\r\n\t\tВозврат Неопределено;\t\r\n\tКонецПопытки;\t\r\n\t\r\n\tВозврат Прокси;\r\n\t\r\nКонецФункции\r\n\r\n&НаСервереБезКонтекста\r\nФункция ПолучитьПараметрыПрокси(ТестовыйСервер)\r\n\t\r\n\tСтруктураПараметров = Новый Структура();\t\r\n\t\r\n\tСтруктураПараметров.Вставить(\"АдресWS\",\"http://192.168.12.11/buh_centr/ws/gm_BuhExchange.1cws?wsdl\"); //\"http://192.168.12.11/buh_centr/ws/gm_BuhExchange.1cws?wsdl\"\r\n\t\r\n\tСтруктураПараметров.Вставить(\"Пользователь\",\"WS_Обмен\");\r\n\tСтруктураПараметров.Вставить(\"Пароль\",\"123456\");\r\n\t\r\n\tВозврат СтруктураПараметров;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Кеширование текущей строки для сравнения при окончании редактирования",
    "description": "Кеширование текущей строки для сравнения при окончании редактирования",
    "code_snippet": "//1. На форме необходимо создать реквизит: КешТекущейСтроки - ПроизвольныйТип.\r\n\r\n//2. В нужной табличной части создаём процедуру ПередНачаломИзменения, например такую:\r\n\r\n&НаКлиенте\r\nПроцедура ПрикреплённыеФайлыНаСервереПередНачаломИзменения(Элемент, Отказ)\r\n    КешТекущейСтроки = ПреобразоватьСтрокуТаблицыВСтруктуру(Элемент.ТекущиеДанные, Элементы.ГруппаСтраницы.ПодчиненныеЭлементы.ГруппаПрисоединенныеФайлы.ПодчиненныеЭлементы.ПрикреплённыеФайлыНаСервере.ПодчиненныеЭлементы, \"ПрикреплённыеФайлыНаСервере\");\r\nКонецПроцедуры\r\n\r\n// 3. Добавить  Процедуру  ПреобразоватьСтрокуТаблицыВСтруктуру. В этой процедуре необходимо пропускать обработку колонок, которые взяты по ссылке из какого-то ссылочного реквизита (Ссылка.Реквизит), они не главные и их не обязательно помещать в структуру\r\n\r\n// Возвращает структуру с ключами, соответствующими колонкам таблицы значений.\r\n// Значения в структуре заполняются значениями полей из переданной строки таблицы.\r\n//\r\n// Параметры:\r\n//\tТекущаяСтрока - СтрокаТаблицыЗначений\r\n//      ПодчиненныеЭлементы - полный путь к подчиненным элементам табличной части (колонкам) на управляемых формах\r\n//      ИмяТаблица - имя таблицы на управляемой форме\r\n// Возвращаемое значение:\r\n//\tСтруктура\r\n//      лучше вынести  функцию в общий модуль НаКлиенте\r\n&НаКлиенте\r\nФункция ПреобразоватьСтрокуТаблицыВСтруктуру(ТекущаяСтрока,ПодчиненныеЭлементы, ИмяТаблицы) Экспорт \r\n\t\r\n\tРезультатСтруктура = Новый Структура;\r\n\t\r\n    Для Каждого Колонка Из ПодчиненныеЭлементы Цикл\r\n        Если Колонка.Имя = ИмяТаблицы+\"Артикул\" ИЛИ Колонка.Имя = ИмяТаблицы+\"НомерСтроки\" Тогда // вложенные в ссылку реквизиты исключаем, их пользователь не меняет\r\n            Продолжить;\r\n        КонецЕсли; \r\n        ИмяКолонки = СтрЗаменить(Колонка.Имя,ИмяТаблицы,\"\");\r\n\t\tРезультатСтруктура.Вставить(ИмяКолонки, ТекущаяСтрока[ИмяКолонки]);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат РезультатСтруктура;\r\n\t\r\nКонецФункции\r\n\r\n// 4. Создаём процедуру ПриОкончанииРедактирования и в ней уже смотрим что изменилось в строке, после её редактирования, сопоставляем с кешированными данными в строке, например так:\r\n\r\n&НаКлиенте\r\nПроцедура ПрикреплённыеФайлыНаСервереПередОкончаниемРедактирования(Элемент, НоваяСтрока, ОтменаРедактирования, Отказ)\r\n    \r\n    Если  НоваяСтрока = Ложь И КешТекущейСтроки <> Неопределено Тогда\r\n        \r\n        // проверяем сравниваем с кешированной строкой перед изменениями\r\n        Если КешТекущейСтроки.Имя <> \"\" И КешТекущейСтроки.Имя <> Элемент.ТекущиеДанные.Имя Тогда\r\n            // пишете код что надо сделать\r\n\r\n        КонецЕсли; \r\n     КонецЕсли;\r\n\r\nКонецПроцедуры\n\n//1. На форме необходимо создать реквизит: КешТекущейСтроки - ПроизвольныйТип.\r\n\r\n//2. В нужной табличной части создаём процедуру ПередНачаломИзменения, например такую:\r\n\r\n&НаКлиенте\r\nПроцедура ПрикреплённыеФайлыНаСервереПередНачаломИзменения(Элемент, Отказ)\r\n    КешТекущейСтроки = ПреобразоватьСтрокуТаблицыВСтруктуру(Элемент.ТекущиеДанные, Элементы.ГруппаСтраницы.ПодчиненныеЭлементы.ГруппаПрисоединенныеФайлы.ПодчиненныеЭлементы.ПрикреплённыеФайлыНаСервере.ПодчиненныеЭлементы, \"ПрикреплённыеФайлыНаСервере\");\r\nКонецПроцедуры\r\n\r\n// 3. Добавить  Процедуру  ПреобразоватьСтрокуТаблицыВСтруктуру. В этой процедуре необходимо пропускать обработку колонок, которые взяты по ссылке из какого-то ссылочного реквизита (Ссылка.Реквизит), они не главные и их не обязательно помещать в структуру\r\n\r\n// Возвращает структуру с ключами, соответствующими колонкам таблицы значений.\r\n// Значения в структуре заполняются значениями полей из переданной строки таблицы.\r\n//\r\n// Параметры:\r\n//\tТекущаяСтрока - СтрокаТаблицыЗначений\r\n//      ПодчиненныеЭлементы - полный путь к подчиненным элементам табличной части (колонкам) на управляемых формах\r\n//      ИмяТаблица - имя таблицы на управляемой форме\r\n// Возвращаемое значение:\r\n//\tСтруктура\r\n//      лучше вынести  функцию в общий модуль НаКлиенте\r\n&НаКлиенте\r\nФункция ПреобразоватьСтрокуТаблицыВСтруктуру(ТекущаяСтрока,ПодчиненныеЭлементы, ИмяТаблицы) Экспорт \r\n\t\r\n\tРезультатСтруктура = Новый Структура;\r\n\t\r\n    Для Каждого Колонка Из ПодчиненныеЭлементы Цикл\r\n        Если Колонка.Имя = ИмяТаблицы+\"Артикул\" ИЛИ Колонка.Имя = ИмяТаблицы+\"НомерСтроки\" Тогда // вложенные в ссылку реквизиты исключаем, их пользователь не меняет\r\n            Продолжить;\r\n        КонецЕсли; \r\n        ИмяКолонки = СтрЗаменить(Колонка.Имя,ИмяТаблицы,\"\");\r\n\t\tРезультатСтруктура.Вставить(ИмяКолонки, ТекущаяСтрока[ИмяКолонки]);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат РезультатСтруктура;\r\n\t\r\nКонецФункции\r\n\r\n// 4. Создаём процедуру ПриОкончанииРедактирования и в ней уже смотрим что изменилось в строке, после её редактирования, сопоставляем с кешированными данными в строке, например так:\r\n\r\n&НаКлиенте\r\nПроцедура ПрикреплённыеФайлыНаСервереПередОкончаниемРедактирования(Элемент, НоваяСтрока, ОтменаРедактирования, Отказ)\r\n    \r\n    Если  НоваяСтрока = Ложь И КешТекущейСтроки <> Неопределено Тогда\r\n        \r\n        // проверяем сравниваем с кешированной строкой перед изменениями\r\n        Если КешТекущейСтроки.Имя <> \"\" И КешТекущейСтроки.Имя <> Элемент.ТекущиеДанные.Имя Тогда\r\n            // пишете код что надо сделать\r\n\r\n        КонецЕсли; \r\n     КонецЕсли;\r\n\r\nКонецПроцедуры\n\n{7} Переменной КешТекущейСтроки присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Групповое изменение Измерения в НабореЗаписей регистра сведений",
    "description": "Групповое изменение Измерения в НабореЗаписей регистра сведений",
    "code_snippet": "НаборЗаписей = РегистрыСведений.РС1.СоздатьНаборЗаписей();    \r\n   // тут устанавливаете нужный  отбор по измерениям \r\n    НаборЗаписей.Отбор.Измерение1.Установить(ЗначениеИзмерения);\r\n    НаборЗаписей.Прочитать();\r\n\r\n    МенеджерЗаписи = РегистрыСведений.РС1.СоздатьМенеджерЗаписи();\r\n    \r\n    Для Каждого ТекЗапись Из НаборЗаписей Цикл\r\n        ЗаполнитьЗначенияСвойств(МенеджерЗаписи, ТекЗапись);\r\n        МенеджерЗаписи.Прочитать();\r\n        МенеджерЗаписи.Измерение1 = НовоеЗначениеИзмерения;\r\n        МенеджерЗаписи.Записать();\r\n    КонецЦикла;\r\n\r\n// набор используем только для цикла перебора записей\r\n// а запись каждую редактируем отдельно\r\n// если необходимо можно сделать в одной транзакции\t\r\n\r\n// иначе не даст сохранить, напишет набор не соотвествует  установленному отбору\n\nНаборЗаписей = РегистрыСведений.РС1.СоздатьНаборЗаписей();    \r\n   // тут устанавливаете нужный  отбор по измерениям \r\n    НаборЗаписей.Отбор.Измерение1.Установить(ЗначениеИзмерения);\r\n    НаборЗаписей.Прочитать();\r\n\r\n    МенеджерЗаписи = РегистрыСведений.РС1.СоздатьМенеджерЗаписи();\r\n    \r\n    Для Каждого ТекЗапись Из НаборЗаписей Цикл\r\n        ЗаполнитьЗначенияСвойств(МенеджерЗаписи, ТекЗапись);\r\n        МенеджерЗаписи.Прочитать();\r\n        МенеджерЗаписи.Измерение1 = НовоеЗначениеИзмерения;\r\n        МенеджерЗаписи.Записать();\r\n    КонецЦикла;\r\n\r\n// набор используем только для цикла перебора записей\r\n// а запись каждую редактируем отдельно\r\n// если необходимо можно сделать в одной транзакции\t\r\n\r\n// иначе не даст сохранить, напишет набор не соотвествует  установленному отбору\n\nОрфографическая ошибка в соотвествует: соотвествует"
  },
  {
    "title": "Быстро получить всех родителей для текущей позиции",
    "description": "Быстро получить всех родителей для текущей позиции",
    "code_snippet": "ВсеКоды = СтрЗаменить(Справочники.Номенклатура.НайтиПоКоду(Код).ПолныйКод(),\"/\",Символы.ПС);\r\n            \r\nДля Индекс = 1 По СтрЧислоСтрок(ВсеКоды) Цикл\r\n   Путь = Путь + Справочники.Номенклатура.НайтиПоКоду(СтрПолучитьСтроку(ВсеКоды, Индекс)) + \"\\\";\r\nКонецЦикла;\r\n\r\n// Параметр .ПолныйКод() позволяет получить всех родителей через символ \"/\"\r\n// дальше заменяем символ \"/\" на символ переноса строки Символы.ПС\r\n// и получаем в каждой строке по родителю \r\n// далее через индекс строк собираем полный путь, при необходимости\n\nВсеКоды = СтрЗаменить(Справочники.Номенклатура.НайтиПоКоду(Код).ПолныйКод(),\"/\",Символы.ПС);\r\n            \r\nДля Индекс = 1 По СтрЧислоСтрок(ВсеКоды) Цикл\r\n   Путь = Путь + Справочники.Номенклатура.НайтиПоКоду(СтрПолучитьСтроку(ВсеКоды, Индекс)) + \"\\\";\r\nКонецЦикла;\r\n\r\n// Параметр .ПолныйКод() позволяет получить всех родителей через символ \"/\"\r\n// дальше заменяем символ \"/\" на символ переноса строки Символы.ПС\r\n// и получаем в каждой строке по родителю \r\n// далее через индекс строк собираем полный путь, при необходимости"
  },
  {
    "title": "Установить параметр отчета СКД",
    "description": "Установить параметр отчета СКД",
    "code_snippet": "Процедура УстановитьПараметр(Имя, Значение)\r\n\t\r\n    Параметр = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый   ПараметрКомпоновкиДанных(Имя));\r\n\tЕсли Параметр <> Неопределено Тогда\r\n\t\tПараметр.Значение = Значение;\r\n\t\tПараметр.Использование = ЗначениеЗаполнено(Значение);\r\n\tКонецЕсли;\r\n\r\n\r\nКонецПроцедуры\n\nПроцедура УстановитьПараметр(Имя, Значение)\r\n\t\r\n    Параметр = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый   ПараметрКомпоновкиДанных(Имя));\r\n\tЕсли Параметр <> Неопределено Тогда\r\n\t\tПараметр.Значение = Значение;\r\n\t\tПараметр.Использование = ЗначениеЗаполнено(Значение);\r\n\tКонецЕсли;\r\n\r\n\r\nКонецПроцедуры"
  },
  {
    "title": "Объединить таблицы значений",
    "description": "Объединить таблицы значений",
    "code_snippet": "Функция ОбъединитьТаблицыЗначений(Знач Таблица1, Таблица2, Измерения, Ресурсы) Экспорт\r\n\t\r\n\tМассивРесурсов = СтрРазделить(Ресурсы, \",\");\r\n\tСтруктураОтбора = Новый Структура(Измерения);\r\n\tДля Каждого СтрокаТЗ Из Таблица2 Цикл\r\n\t\t\r\n\t\tЗаполнитьЗначенияСвойств(СтруктураОтбора, СтрокаТЗ);\r\n\t\t\r\n\t\tРезультатОтбора = Таблица1.НайтиСтроки(СтруктураОтбора);\r\n\t\tЕсли РезультатОтбора.Количество() > 0 Тогда\r\n\t\t\tСтрокаОтбора = РезультатОтбора[0];\r\n\t\t\tДля Каждого Колонка Из МассивРесурсов Цикл\r\n\t\t\t\tСтрокаОтбора[Колонка] = СтрокаОтбора[Колонка] + СтрокаТЗ[Колонка];\r\n\t\t\tКонецЦикла;\r\n\t\tИначе\r\n\t\t\tСтрокаОтбора = Таблица1.Добавить();\r\n\t\t\tЗаполнитьЗначенияСвойств(СтрокаОтбора, СтрокаТЗ);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Таблица1;\r\n\t\r\nКонецФункции\n\nФункция ОбъединитьТаблицыЗначений(Знач Таблица1, Таблица2, Измерения, Ресурсы) Экспорт\r\n\t\r\n\tМассивРесурсов = СтрРазделить(Ресурсы, \",\");\r\n\tСтруктураОтбора = Новый Структура(Измерения);\r\n\tДля Каждого СтрокаТЗ Из Таблица2 Цикл\r\n\t\t\r\n\t\tЗаполнитьЗначенияСвойств(СтруктураОтбора, СтрокаТЗ);\r\n\t\t\r\n\t\tРезультатОтбора = Таблица1.НайтиСтроки(СтруктураОтбора);\r\n\t\tЕсли РезультатОтбора.Количество() > 0 Тогда\r\n\t\t\tСтрокаОтбора = РезультатОтбора[0];\r\n\t\t\tДля Каждого Колонка Из МассивРесурсов Цикл\r\n\t\t\t\tСтрокаОтбора[Колонка] = СтрокаОтбора[Колонка] + СтрокаТЗ[Колонка];\r\n\t\t\tКонецЦикла;\r\n\t\tИначе\r\n\t\t\tСтрокаОтбора = Таблица1.Добавить();\r\n\t\t\tЗаполнитьЗначенияСвойств(СтрокаОтбора, СтрокаТЗ);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат Таблица1;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "ОставитьСтрокиТаблицыЗначений",
    "description": "ОставитьСтрокиТаблицыЗначений",
    "code_snippet": "Функция ОставитьСтрокиТаблицыЗначений(Знач Таблица, СтруктураОтбора) Экспорт\r\n\t\r\n\tМассивСтрок = Новый Массив;\r\n\tРезультатОтбора = Таблица.НайтиСтроки(СтруктураОтбора);\r\n\tДля каждого СтрокаОтбора Из РезультатОтбора Цикл\r\n\t\tМассивСтрок.Добавить(СтрокаОтбора);\r\n\tКонецЦикла;\r\n\t\r\n\tМассивУдаления = Новый Массив;\r\n\tДля Каждого СтрокаТЗ Из Таблица Цикл\r\n\t\tЕсли МассивСтрок.Найти(СтрокаТЗ) = Неопределено Тогда\r\n\t\t\tМассивУдаления.Добавить(СтрокаТЗ);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого СтрокаТЗ Из МассивУдаления Цикл\r\n\t\tТаблица.Удалить(СтрокаТЗ);\r\n\tКонецЦикла;\r\n\t\r\n    Возврат Таблица;\r\n    \r\nКонецФункции // ОставитьСтрокиТаблицыЗначений()\n\nФункция ОставитьСтрокиТаблицыЗначений(Знач Таблица, СтруктураОтбора) Экспорт\r\n\t\r\n\tМассивСтрок = Новый Массив;\r\n\tРезультатОтбора = Таблица.НайтиСтроки(СтруктураОтбора);\r\n\tДля каждого СтрокаОтбора Из РезультатОтбора Цикл\r\n\t\tМассивСтрок.Добавить(СтрокаОтбора);\r\n\tКонецЦикла;\r\n\t\r\n\tМассивУдаления = Новый Массив;\r\n\tДля Каждого СтрокаТЗ Из Таблица Цикл\r\n\t\tЕсли МассивСтрок.Найти(СтрокаТЗ) = Неопределено Тогда\r\n\t\t\tМассивУдаления.Добавить(СтрокаТЗ);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого СтрокаТЗ Из МассивУдаления Цикл\r\n\t\tТаблица.Удалить(СтрокаТЗ);\r\n\tКонецЦикла;\r\n\t\r\n    Возврат Таблица;\r\n    \r\nКонецФункции // ОставитьСтрокиТаблицыЗначений()\n\nОрфографическая ошибка в соответсвующие (найдено 2): соответсвующие\r\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "УдалитьСтрокиТаблицыЗначений",
    "description": "УдалитьСтрокиТаблицыЗначений",
    "code_snippet": "Функция УдалитьСтрокиТаблицыЗначений(Знач Таблица, СтруктураОтбора) Экспорт\r\n\t\r\n\tМассивСтрок = Новый Массив;\r\n\tРезультатОтбора = Таблица.НайтиСтроки(СтруктураОтбора);\r\n\tДля каждого СтрокаОтбора Из РезультатОтбора Цикл\r\n\t\tМассивСтрок.Добавить(СтрокаОтбора);\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого СтрокаТЗ Из МассивСтрок Цикл\r\n\t\tТаблица.Удалить(СтрокаТЗ);\r\n\tКонецЦикла;\r\n\t\r\n    Возврат Таблица;\r\n    \r\nКонецФункции // УдалитьСтрокиТаблицыЗначений()\n\nФункция УдалитьСтрокиТаблицыЗначений(Знач Таблица, СтруктураОтбора) Экспорт\r\n\t\r\n\tМассивСтрок = Новый Массив;\r\n\tРезультатОтбора = Таблица.НайтиСтроки(СтруктураОтбора);\r\n\tДля каждого СтрокаОтбора Из РезультатОтбора Цикл\r\n\t\tМассивСтрок.Добавить(СтрокаОтбора);\r\n\tКонецЦикла;\r\n\t\r\n\tДля Каждого СтрокаТЗ Из МассивСтрок Цикл\r\n\t\tТаблица.Удалить(СтрокаТЗ);\r\n\tКонецЦикла;\r\n\t\r\n    Возврат Таблица;\r\n    \r\nКонецФункции // УдалитьСтрокиТаблицыЗначений()\n\nОрфографическая ошибка в соответсвующие: соответсвующие\r\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "Срез на даты за период. Шаблон запроса",
    "description": "Срез на даты за период. Шаблон запроса",
    "code_snippet": "//1)Традиционный подход\r\n\r\n/// первый запрос - выбирает все даты документов\r\n\r\nВЫБРАТЬ РАЗЛИЧНЫЕ\r\n\tНАЧАЛОПЕРИОДА(Товары.Ссылка.Дата, ДЕНЬ) КАК ДатаДокумента\r\nПОМЕСТИТЬ \r\n\tВТ_ДатыДокументов\r\nИЗ\r\n\tДокумент.Реализация.Товары КАК Товары\r\nГДЕ\r\n\tТовары.Ссылка.Дата МЕЖДУ &НачалоПериода И &КонецПериода\r\n;\r\n\r\n/// второй запрос - выбирает из нашего регистра сведений измерения и максимальный период на каждую дату\r\nВЫБРАТЬ\r\n\tВТ_ДатыДокументов.ДатаДокумента,\r\n\tЦены.Номенклатура,\r\n\tМАКСИМУМ(Цены.Период) КАК ДатаЦены\r\nПОМЕСТИТЬ \r\n\tВТ_ДатыНачалаДействия\r\nИЗ \r\n\tВТ_ДатыДокументов КАК ВТ_ДатыДокументов\r\n\tВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры КАК Цены\r\n    \tПО Цены.Период <= ВТ_ДатыДокументов.ДатаДокумента\r\n\t\r\nГДЕ\r\n\tЦены.ТипЦены = &ТипЦены // например, такой отбор, или какой-нибудь другой\r\n\r\nСГРУППИРОВАТЬ ПО\r\n\tВТ_ДатыДокументов.ДатаДокумента,\r\n\tЦены.Номенклатура\r\n;\r\n\r\n/// третий запрос - выбирает из нашего регистра актуальные значения ресурсов на каждую дату документа\r\nВЫБРАТЬ\r\n\tВТ_ДатыНачалаДействия.ДатаДокумента,\r\n\tЦены.Номенклатура,\r\n\tЦены.Цена\r\n\t\r\nПОМЕСТИТЬ \r\n\tВТ_ЗначенияРесурсов\r\nИЗ \r\n\tРегистрСведений.ЦеныНоменклатуры КАК Цены\r\n\tВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_ДатыНачалаДействия КАК ВТ_ДатыНачалаДействия\r\n    \tПО ВТ_ДатыНачалаДействия.Период = Цены.Период\r\n    \tИ ВТ_ДатыНачалаДействия.Номенклатура = Цены.Номенклатура\r\nГДЕ\r\n\tЦены.ТипЦены = &ТипЦены // не забываем еще раз указать тот же отбор\r\n;\r\n\r\n/// четвертый запрос - основной, который получает нужные данные из временной таблицы, полученной на предыдущем шаге\r\nВЫБРАТЬ\r\n\tТовары.Ссылка КАК Документ,\r\n\tТовары.Номенклатура,\r\n\tВТ_ЗначенияРесурсов.Цена * Товары.Количество КАК Сумма // тут делаем что-то нужное нам с полученными значениями\r\nИЗ \r\n\tДокумент.Реализация.Товары КАК Товары\r\n\tВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_ЗначенияРесурсов КАК ВТ_ЗначенияРесурсов\r\n    \tПО Товары.Номенклатура = ВТ_ЗначенияРесурсов.Номенклатура\r\n    \tИ НАЧАЛОПЕРИОДА(Товары.Ссылка.Дата, ДЕНЬ) = ВТ_ЗначенияРесурсов.ДатаДокумента\r\n\r\n\r\n//2)Подход со слабой связностью \r\n\r\n/// первый запрос - вытаскиваем из регистра сведений все что нужно за один раз\r\nВЫБРАТЬ\r\n    Период,\r\n    Номенклатура,\r\n    Цена\r\nПОМЕСТИТЬ ВТ_Срез\r\nИЗ \r\n    РегистрСведений.ЦеныНоменклатуры КАК Движения\r\nГДЕ \r\n    Период > &НачалоПериода\r\n    И Период <= &КонецПериода\r\n    И ТипЦены = &ТипЦены // например, такой отбор, или какой-нибудь другой\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ\r\n    Период,\r\n    Номенклатура,\r\n    Цена\r\nИЗ \r\n    РегистрСведений.ЦеныНоменклатуры.СрезПоследних(&НачалоПериода, ТипЦены = &ТипЦены // тут надо повторить отбор\r\n\t\t) КАК Срез\r\nИНДЕКСИРОВАТЬ ПО\r\n    Движения.Номенклатура,\r\n    Движения.Период\r\n\r\n;\r\n/// второй запрос - собираем таблицу с периодами действия ресурса\r\nВЫБРАТЬ\r\n    НачалоПериода.Номенклатура,\r\n    НачалоПериода.Цена,\r\n    НачалоПериода.Период КАК НачалоПериода,\r\n    ЕСТЬNULL(ДОБАВИТЬКДАТЕ(МИНИМУМ(КонецПериода.Период), СЕКУНДА, -1), &КонецПериода) КАК КонецПериода\r\nПОМЕСТИТЬ ВТ_ЗначенияРесурсов\r\nИЗ\r\n    ВТ_Срез КАК НачалоПериода\r\n    ЛЕВОЕ СОЕДИНЕНИЕ ВТ_Срез КАК КонецПериода\r\n        ПО НачалоПериода.Номенклатура = КонецПериода.Номенклатура\r\n        И НачалоПериода.Период < КонецПериода.Период\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    НачалоПериода.Период,\r\n    НачалоПериода.Номенклатура,\r\n    НачалоПериода.Цена\r\n;\r\n\r\n/// третий запрос - основной, который получает нужные данные из временной таблицы, полученной на предыдущем шаге\r\nВЫБРАТЬ\r\n\tТовары.Ссылка КАК Документ,\r\n\tТовары.Номенклатура,\r\n\tВТ_ЗначенияРесурсов.Цена * Товары.Количество КАК Сумма // тут делаем что-то нужное нам с полученными значениями\r\nИЗ \r\n\tДокумент.Реализация.Товары КАК Товары\r\n\tВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_ЗначенияРесурсов КАК ВТ_ЗначенияРесурсов\r\n    \tПО Товары.Номенклатура = ВТ_ЗначенияРесурсов.Номенклатура\r\n    \tИ Товары.Ссылка.Дата МЕЖДУ ВТ_ЗначенияРесурсов.НачалоПериода И ВТ_ЗначенияРесурсов.КонецПериода\n\n//1)Традиционный подход\r\n\r\n/// первый запрос - выбирает все даты документов\r\n\r\nВЫБРАТЬ РАЗЛИЧНЫЕ\r\n\tНАЧАЛОПЕРИОДА(Товары.Ссылка.Дата, ДЕНЬ) КАК ДатаДокумента\r\nПОМЕСТИТЬ \r\n\tВТ_ДатыДокументов\r\nИЗ\r\n\tДокумент.Реализация.Товары КАК Товары\r\nГДЕ\r\n\tТовары.Ссылка.Дата МЕЖДУ &НачалоПериода И &КонецПериода\r\n;\r\n\r\n/// второй запрос - выбирает из нашего регистра сведений измерения и максимальный период на каждую дату\r\nВЫБРАТЬ\r\n\tВТ_ДатыДокументов.ДатаДокумента,\r\n\tЦены.Номенклатура,\r\n\tМАКСИМУМ(Цены.Период) КАК ДатаЦены\r\nПОМЕСТИТЬ \r\n\tВТ_ДатыНачалаДействия\r\nИЗ \r\n\tВТ_ДатыДокументов КАК ВТ_ДатыДокументов\r\n\tВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры КАК Цены\r\n    \tПО Цены.Период <= ВТ_ДатыДокументов.ДатаДокумента\r\n\t\r\nГДЕ\r\n\tЦены.ТипЦены = &ТипЦены // например, такой отбор, или какой-нибудь другой\r\n\r\nСГРУППИРОВАТЬ ПО\r\n\tВТ_ДатыДокументов.ДатаДокумента,\r\n\tЦены.Номенклатура\r\n;\r\n\r\n/// третий запрос - выбирает из нашего регистра актуальные значения ресурсов на каждую дату документа\r\nВЫБРАТЬ\r\n\tВТ_ДатыНачалаДействия.ДатаДокумента,\r\n\tЦены.Номенклатура,\r\n\tЦены.Цена\r\n\t\r\nПОМЕСТИТЬ \r\n\tВТ_ЗначенияРесурсов\r\nИЗ \r\n\tРегистрСведений.ЦеныНоменклатуры КАК Цены\r\n\tВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_ДатыНачалаДействия КАК ВТ_ДатыНачалаДействия\r\n    \tПО ВТ_ДатыНачалаДействия.Период = Цены.Период\r\n    \tИ ВТ_ДатыНачалаДействия.Номенклатура = Цены.Номенклатура\r\nГДЕ\r\n\tЦены.ТипЦены = &ТипЦены // не забываем еще раз указать тот же отбор\r\n;\r\n\r\n/// четвертый запрос - основной, который получает нужные данные из временной таблицы, полученной на предыдущем шаге\r\nВЫБРАТЬ\r\n\tТовары.Ссылка КАК Документ,\r\n\tТовары.Номенклатура,\r\n\tВТ_ЗначенияРесурсов.Цена * Товары.Количество КАК Сумма // тут делаем что-то нужное нам с полученными значениями\r\nИЗ \r\n\tДокумент.Реализация.Товары КАК Товары\r\n\tВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_ЗначенияРесурсов КАК ВТ_ЗначенияРесурсов\r\n    \tПО Товары.Номенклатура = ВТ_ЗначенияРесурсов.Номенклатура\r\n    \tИ НАЧАЛОПЕРИОДА(Товары.Ссылка.Дата, ДЕНЬ) = ВТ_ЗначенияРесурсов.ДатаДокумента\r\n\r\n\r\n//2)Подход со слабой связностью \r\n\r\n/// первый запрос - вытаскиваем из регистра сведений все что нужно за один раз\r\nВЫБРАТЬ\r\n    Период,\r\n    Номенклатура,\r\n    Цена\r\nПОМЕСТИТЬ ВТ_Срез\r\nИЗ \r\n    РегистрСведений.ЦеныНоменклатуры КАК Движения\r\nГДЕ \r\n    Период > &НачалоПериода\r\n    И Период <= &КонецПериода\r\n    И ТипЦены = &ТипЦены // например, такой отбор, или какой-нибудь другой\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ\r\n    Период,\r\n    Номенклатура,\r\n    Цена\r\nИЗ \r\n    РегистрСведений.ЦеныНоменклатуры.СрезПоследних(&НачалоПериода, ТипЦены = &ТипЦены // тут надо повторить отбор\r\n\t\t) КАК Срез\r\nИНДЕКСИРОВАТЬ ПО\r\n    Движения.Номенклатура,\r\n    Движения.Период\r\n\r\n;\r\n/// второй запрос - собираем таблицу с периодами действия ресурса\r\nВЫБРАТЬ\r\n    НачалоПериода.Номенклатура,\r\n    НачалоПериода.Цена,\r\n    НачалоПериода.Период КАК НачалоПериода,\r\n    ЕСТЬNULL(ДОБАВИТЬКДАТЕ(МИНИМУМ(КонецПериода.Период), СЕКУНДА, -1), &КонецПериода) КАК КонецПериода\r\nПОМЕСТИТЬ ВТ_ЗначенияРесурсов\r\nИЗ\r\n    ВТ_Срез КАК НачалоПериода\r\n    ЛЕВОЕ СОЕДИНЕНИЕ ВТ_Срез КАК КонецПериода\r\n        ПО НачалоПериода.Номенклатура = КонецПериода.Номенклатура\r\n        И НачалоПериода.Период < КонецПериода.Период\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    НачалоПериода.Период,\r\n    НачалоПериода.Номенклатура,\r\n    НачалоПериода.Цена\r\n;\r\n\r\n/// третий запрос - основной, который получает нужные данные из временной таблицы, полученной на предыдущем шаге\r\nВЫБРАТЬ\r\n\tТовары.Ссылка КАК Документ,\r\n\tТовары.Номенклатура,\r\n\tВТ_ЗначенияРесурсов.Цена * Товары.Количество КАК Сумма // тут делаем что-то нужное нам с полученными значениями\r\nИЗ \r\n\tДокумент.Реализация.Товары КАК Товары\r\n\tВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_ЗначенияРесурсов КАК ВТ_ЗначенияРесурсов\r\n    \tПО Товары.Номенклатура = ВТ_ЗначенияРесурсов.Номенклатура\r\n    \tИ Товары.Ссылка.Дата МЕЖДУ ВТ_ЗначенияРесурсов.НачалоПериода И ВТ_ЗначенияРесурсов.КонецПериода\n\n{6} Ожидается идентификатор\r\nОрфографическая ошибка в нибудь (найдено 2): нибудь"
  },
  {
    "title": "Прибавить рабочие дни к дате",
    "description": "Прибавить рабочие дни к дате",
    "code_snippet": "Запрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ ПЕРВЫЕ \" + Число(ДобавитьКоличествоДней) + \"\r\n\t\t|\tДанныеПроизводственногоКалендаря.Дата КАК ДатаКалендаря\r\n\t\t|ПОМЕСТИТЬ ВТ_РабочиеДни\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ДанныеПроизводственногоКалендаря КАК ДанныеПроизводственногоКалендаря\r\n\t\t|ГДЕ\r\n\t\t|\tДанныеПроизводственногоКалендаря.ВидДня = &ВидДня_РабочийДень\r\n\t\t|\tИ ДанныеПроизводственногоКалендаря.Дата >= &ИсходнаяДата\r\n\t\t|;\r\n\t\t|\r\n\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tМАКСИМУМ(ВТ_РабочиеДни.ДатаКалендаря) КАК ДатаКалендаря\r\n\t\t|ИЗ\r\n\t\t|\tВТ_РабочиеДни КАК ВТ_РабочиеДни\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ИсходнаяДата\", НачалоДня(Объект.Дата));\r\n\tЗапрос.УстановитьПараметр(\"ВидДня_РабочийДень\", Перечисления.ВидыДнейПроизводственногоКалендаря.Рабочий);\r\n\t\r\n        РезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tЕсли ВыборкаДетальныеЗаписи.Следующий() Тогда\r\n\t\tВозврат ВыборкаДетальныеЗаписи.ДатаКалендаря;\t\t\t\r\n\tКонецЕсли;\n\nЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ ПЕРВЫЕ \" + Число(ДобавитьКоличествоДней) + \"\r\n\t\t|\tДанныеПроизводственногоКалендаря.Дата КАК ДатаКалендаря\r\n\t\t|ПОМЕСТИТЬ ВТ_РабочиеДни\r\n\t\t|ИЗ\r\n\t\t|\tРегистрСведений.ДанныеПроизводственногоКалендаря КАК ДанныеПроизводственногоКалендаря\r\n\t\t|ГДЕ\r\n\t\t|\tДанныеПроизводственногоКалендаря.ВидДня = &ВидДня_РабочийДень\r\n\t\t|\tИ ДанныеПроизводственногоКалендаря.Дата >= &ИсходнаяДата\r\n\t\t|;\r\n\t\t|\r\n\t\t|////////////////////////////////////////////////////////////////////////////////\r\n\t\t|ВЫБРАТЬ\r\n\t\t|\tМАКСИМУМ(ВТ_РабочиеДни.ДатаКалендаря) КАК ДатаКалендаря\r\n\t\t|ИЗ\r\n\t\t|\tВТ_РабочиеДни КАК ВТ_РабочиеДни\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"ИсходнаяДата\", НачалоДня(Объект.Дата));\r\n\tЗапрос.УстановитьПараметр(\"ВидДня_РабочийДень\", Перечисления.ВидыДнейПроизводственногоКалендаря.Рабочий);\r\n\t\r\n        РезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();\r\n\t\r\n\tЕсли ВыборкаДетальныеЗаписи.Следующий() Тогда\r\n\t\tВозврат ВыборкаДетальныеЗаписи.ДатаКалендаря;\t\t\t\r\n\tКонецЕсли;"
  },
  {
    "title": "yabr",
    "description": "Приложение oscript для чтения скобочных файлов 1С",
    "code_snippet": ""
  },
  {
    "title": "Передача таблицы значений в запрос",
    "description": "Передача таблицы значений в запрос",
    "code_snippet": "Товары = Новый ТаблицаЗначений;\t\r\nТовары.Колонки.Добавить(\"Наименование\");\t\r\nТовары.Колонки.Добавить(\"Количество\");\r\n\r\nЗапрос = Новый Запрос;\r\nЗапрос.Текст = \"ВЫБРАТЬ\r\n\t\t\t   |\tВнешнийИсточник.Наименование,\r\n\t\t\t   |\tВнешнийИсточник.Количество\r\n\t\t\t   |ПОМЕСТИТЬ ВТ_ВнешнийИсточник\r\n\t\t\t   |ИЗ\r\n\t\t\t   |\t&ВнешнийИсточник КАК ВнешнийИсточник\r\n\t\t\t   |;\r\n\t\t\t   |\r\n\t\t\t   |////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t   |ВЫБРАТЬ\r\n\t\t\t   |\tВТ_ВнешнийИсточник.Наименование,\r\n\t\t\t   |\tВТ_ВнешнийИсточник.Количество КАК Количество\r\n\t\t\t   |ИЗ\r\n\t\t\t   |\tВТ_ВнешнийИсточник КАК ВТ_ВнешнийИсточник\r\n\t\t\t   |ГДЕ\r\n\t\t\t   |\tВТ_ВнешнийИсточник.Количество > 0\r\n\t\t\t   |\r\n\t\t\t   |УПОРЯДОЧИТЬ ПО\r\n\t\t\t   |\tКоличество\";\r\n\r\nЗапрос.УстановитьПараметр(\"ВнешнийИсточник\", Товары);\t\t\t   \r\nРезультатЗапроса = Запрос.Выполнить();\r\nВыборка = РезультатЗапроса.Выбрать();\r\n\r\nПока Выборка.Следующий() Цикл\r\n\t\r\n\t// Обработка данных\r\n\t\r\nКонецЦикла;\n\nТовары = Новый ТаблицаЗначений;\t\r\nТовары.Колонки.Добавить(\"Наименование\");\t\r\nТовары.Колонки.Добавить(\"Количество\");\r\n\r\nЗапрос = Новый Запрос;\r\nЗапрос.Текст = \"ВЫБРАТЬ\r\n\t\t\t   |\tВнешнийИсточник.Наименование,\r\n\t\t\t   |\tВнешнийИсточник.Количество\r\n\t\t\t   |ПОМЕСТИТЬ ВТ_ВнешнийИсточник\r\n\t\t\t   |ИЗ\r\n\t\t\t   |\t&ВнешнийИсточник КАК ВнешнийИсточник\r\n\t\t\t   |;\r\n\t\t\t   |\r\n\t\t\t   |////////////////////////////////////////////////////////////////////////////////\r\n\t\t\t   |ВЫБРАТЬ\r\n\t\t\t   |\tВТ_ВнешнийИсточник.Наименование,\r\n\t\t\t   |\tВТ_ВнешнийИсточник.Количество КАК Количество\r\n\t\t\t   |ИЗ\r\n\t\t\t   |\tВТ_ВнешнийИсточник КАК ВТ_ВнешнийИсточник\r\n\t\t\t   |ГДЕ\r\n\t\t\t   |\tВТ_ВнешнийИсточник.Количество > 0\r\n\t\t\t   |\r\n\t\t\t   |УПОРЯДОЧИТЬ ПО\r\n\t\t\t   |\tКоличество\";\r\n\r\nЗапрос.УстановитьПараметр(\"ВнешнийИсточник\", Товары);\t\t\t   \r\nРезультатЗапроса = Запрос.Выполнить();\r\nВыборка = РезультатЗапроса.Выбрать();\r\n\r\nПока Выборка.Следующий() Цикл\r\n\t\r\n\t// Обработка данных\r\n\t\r\nКонецЦикла;"
  },
  {
    "title": "TurboConf 6 - расширение Конфигуратора 1С",
    "description": "TurboConf повышает эффективность работы в Конфигураторе 1С и помогает программисту автоматизировать свои задачи.",
    "code_snippet": ""
  },
  {
    "title": "Таблица значений из списка колонок",
    "description": "Таблица значений из списка колонок",
    "code_snippet": "Функция ТаблицаЗначений(Колонки)\r\n\r\n\tЕсли ТипЗнч(Колонки) = Тип(\"Строка\") Тогда\r\n\t\tКолонки = СтрРазделить(Колонки, \",\");\r\n\tКонецЕсли;\r\n\t\r\n\tТабЗнач = Новый ТаблицаЗначений;\r\n\tДля каждого Колонка Из Колонки Цикл\r\n\t\tИмяКолонки = СтрЗаменить(СокрЛП(Колонка), \" \", \"_\");\r\n\t\tТабЗнач.Колонки.Добавить(ИмяКолонки);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат ТабЗнач;\r\n\r\nКонецФункции // ТаблицаЗначений()\n\nФункция ТаблицаЗначений(Колонки)\r\n\r\n\tЕсли ТипЗнч(Колонки) = Тип(\"Строка\") Тогда\r\n\t\tКолонки = СтрРазделить(Колонки, \",\");\r\n\tКонецЕсли;\r\n\t\r\n\tТабЗнач = Новый ТаблицаЗначений;\r\n\tДля каждого Колонка Из Колонки Цикл\r\n\t\tИмяКолонки = СтрЗаменить(СокрЛП(Колонка), \" \", \"_\");\r\n\t\tТабЗнач.Колонки.Добавить(ИмяКолонки);\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат ТабЗнач;\r\n\r\nКонецФункции // ТаблицаЗначений()"
  },
  {
    "title": "Структура метаданных регистра сведений",
    "description": "Структура метаданных регистра сведений",
    "code_snippet": "Функция СтруктураМетаданныхРегистраСведений(РегистрСведений) Экспорт\r\n\t\r\n\tСтруктураРегистра         = Неопределено;\r\n\tРегистрСведенийМетаданные = Неопределено;\r\n\t\r\n\tЕсли ТипЗнч(РегистрСведений) = Тип(\"Строка\") Тогда\r\n\t\tРегистрСведенийМетаданные = Метаданные.НайтиПоПолномуИмени(\"РегистрСведений.\" + РегистрСведений);\r\n\tИначе\r\n\t\t\r\n\t\tРегистрСведенийМетаданные = Метаданные.НайтиПоТипу(ТипЗнч(РегистрСведений));\r\n\t\tЕсли РегистрСведенийМетаданные <> Неопределено Тогда\r\n\t\t\tРегистрСведенийМетаданные = Метаданные.НайтиПоПолномуИмени(\"РегистрСведений.\" + РегистрСведенийМетаданные.Имя);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли РегистрСведенийМетаданные <> Неопределено Тогда\r\n\t\t\r\n\t\tНаименованиеРегистра       = РегистрСведенийМетаданные.Имя;\r\n\t\tМетаданныеРегистраСведений = Метаданные.РегистрыСведений[НаименованиеРегистра];\r\n\r\n\t\tМассивИзмерений = Новый Массив;\r\n\t\tДля Каждого Измерение Из МетаданныеРегистраСведений.Измерения Цикл\r\n\t\t\tМассивИзмерений.Добавить(Измерение.Имя);\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tМассивРесурсов  = Новый Массив;\r\n\t\tДля Каждого Ресурс Из МетаданныеРегистраСведений.Ресурсы Цикл\r\n\t\t\tМассивРесурсов.Добавить(Ресурс.Имя);\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tСтруктураРегистра = Новый Структура;\r\n\t\tСтруктураРегистра.Вставить(\"Измерения\", МассивИзмерений);\r\n\t\tСтруктураРегистра.Вставить(\"Ресурсы\",   МассивРесурсов);\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат СтруктураРегистра;\r\n\t\r\nКонецФункции // СтруктураМетаданныхРегистраСведений()\n\nФункция СтруктураМетаданныхРегистраСведений(РегистрСведений) Экспорт\r\n\t\r\n\tСтруктураРегистра         = Неопределено;\r\n\tРегистрСведенийМетаданные = Неопределено;\r\n\t\r\n\tЕсли ТипЗнч(РегистрСведений) = Тип(\"Строка\") Тогда\r\n\t\tРегистрСведенийМетаданные = Метаданные.НайтиПоПолномуИмени(\"РегистрСведений.\" + РегистрСведений);\r\n\tИначе\r\n\t\t\r\n\t\tРегистрСведенийМетаданные = Метаданные.НайтиПоТипу(ТипЗнч(РегистрСведений));\r\n\t\tЕсли РегистрСведенийМетаданные <> Неопределено Тогда\r\n\t\t\tРегистрСведенийМетаданные = Метаданные.НайтиПоПолномуИмени(\"РегистрСведений.\" + РегистрСведенийМетаданные.Имя);\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли РегистрСведенийМетаданные <> Неопределено Тогда\r\n\t\t\r\n\t\tНаименованиеРегистра       = РегистрСведенийМетаданные.Имя;\r\n\t\tМетаданныеРегистраСведений = Метаданные.РегистрыСведений[НаименованиеРегистра];\r\n\r\n\t\tМассивИзмерений = Новый Массив;\r\n\t\tДля Каждого Измерение Из МетаданныеРегистраСведений.Измерения Цикл\r\n\t\t\tМассивИзмерений.Добавить(Измерение.Имя);\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tМассивРесурсов  = Новый Массив;\r\n\t\tДля Каждого Ресурс Из МетаданныеРегистраСведений.Ресурсы Цикл\r\n\t\t\tМассивРесурсов.Добавить(Ресурс.Имя);\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tСтруктураРегистра = Новый Структура;\r\n\t\tСтруктураРегистра.Вставить(\"Измерения\", МассивИзмерений);\r\n\t\tСтруктураРегистра.Вставить(\"Ресурсы\",   МассивРесурсов);\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат СтруктураРегистра;\r\n\t\r\nКонецФункции // СтруктураМетаданныхРегистраСведений()"
  },
  {
    "title": "Колонки в строку",
    "description": "Колонки в строку",
    "code_snippet": "Функция КолонкиВСтроку(Коллекция, Разделитель=\",\")\r\n\r\n\tСтрКоллекция = \"\";\r\n\t\r\n\tДля каждого Колонка Из Коллекция.Колонки Цикл\r\n\t\tЕсли Не ПустаяСтрока(СтрКоллекция) Тогда\r\n\t\t\tСтрКоллекция = СтрКоллекция + Разделитель;\r\n\t\tКонецЕсли;\r\n\t\tСтрКоллекция = СтрКоллекция + Колонка.Имя;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат СтрКоллекция;\r\n\r\nКонецФункции // КолонкиВСтроку()\n\nФункция КолонкиВСтроку(Коллекция, Разделитель=\",\")\r\n\r\n\tСтрКоллекция = \"\";\r\n\t\r\n\tДля каждого Колонка Из Коллекция.Колонки Цикл\r\n\t\tЕсли Не ПустаяСтрока(СтрКоллекция) Тогда\r\n\t\t\tСтрКоллекция = СтрКоллекция + Разделитель;\r\n\t\tКонецЕсли;\r\n\t\tСтрКоллекция = СтрКоллекция + Колонка.Имя;\r\n\tКонецЦикла;\r\n\t\r\n\tВозврат СтрКоллекция;\r\n\r\nКонецФункции // КолонкиВСтроку()"
  },
  {
    "title": "Цветовая схема Solarized",
    "description": "Две цветовых темы для конфигуратора.",
    "code_snippet": ""
  },
  {
    "title": "Запись Чтение XML 2",
    "description": "Запись Чтение XML 2",
    "code_snippet": "//Имя справочника для примера\r\n    ИмяСправочника = \"Номенклатура\";\r\n    \r\n    ////////////////////////////////////////////////////////////­/////////////\r\n    //Выгрузка\r\n    \r\n    Запись = Новый ЗаписьXML;\r\n    Запись.УстановитьСтроку();\r\n    \r\n    //записываем объявление xml файла: <?xml version=\"1.0\"?>\r\n    Запись.ЗаписатьОбъявлениеXML();\r\n    \r\n    //записываем корневой элемент, по спецификации xml он может быть только один, назовем его \"Данные\"\r\n    Запись.ЗаписатьНачалоЭлемента(\"Данные\");\r\n    \r\n    //для того чтобы пространства имен не объявлялись сериализатором в кажом элементе, пишем их в корневой элемент\r\n    //они будут работать на все вложеные элементы\r\n    //пространство имен по-умолчанию\r\n    Запись.ЗаписатьСоответствиеПространстваИмен(\"\", \"http://v8.1c.ru/8.1/data/enterprise/current-config\");\r\n    \r\n    //пространства имен остальные префиксы\r\n    Запись.ЗаписатьСоответствиеПространстваИмен(\"xsd\", \"http://www.w3.org/2001/XMLSchema\");\r\n    Запись.ЗаписатьСоответствиеПространстваИмен(\"xsi\", \"http://www.w3.org/2001/XMLSchema-instance\");\r\n    \r\n    //ограничение количества выгружаемых элементов для примера\r\n    Кол = 4;\r\n    Выборка = Справочники[ИмяСправочника].Выбрать();\r\n    Пока Выборка.Следующий() Цикл\r\n        \r\n        //вместо этого кода в боевой реализации выгрузки будет создание ОбъектаXDTO и его сериализация\r\n        //через ФабрикуXDTO и загруженные в нее схемы конфигурации приемника\r\n        СериализаторXDTO.ЗаписатьXML(Запись, Выборка.ПолучитьОбъект());\r\n        //\r\n        \r\n        Кол = Кол - 1;\r\n        Если Кол=0 Тогда\r\n            Прервать;\r\n        КонецЕсли;\r\n    КонецЦикла;\r\n    \r\n    //записываем конец корневого элемента\r\n    Запись.ЗаписатьКонецЭлемента();\r\n    \r\n    //покажем что получилось\r\n    Текст = Запись.Закрыть();\r\n    Сообщить(\"Содержимое файла:\");\r\n    Сообщить(Текст);\r\n    \r\n    //а теперь загрузим это обратно\r\n    \r\n    ////////////////////////////////////////////////////////////­/////////////\r\n    //Загрузка\r\n    Сообщить(\"Данные полученные при загрузке:\");\r\n    \r\n    Чтение = Новый ЧтениеXML;\r\n    Чтение.УстановитьСтроку(Текст);\r\n    \r\n    //прочитаем начало xml файла\r\n    Чтение.ПерейтиКСодержимому();\r\n    \r\n    //прочитаем начало корневого элемента\r\n    Чтение.Прочитать();\r\n    \r\n    //читаем содержимое пока текущим не станет конец корневого элемента, т.к. мы писали туда только целые элементы справочника,\r\n    //а сериализатор читает каждый из их полностью, то мы упремся именно в конец корневого\r\n    Пока Чтение.ТипУзла<>ТипУзлаXML.КонецЭлемента Цикл\r\n        \r\n        //читаем очередной элемент справочника\r\n        Объект = СериализаторXDTO.ПрочитатьXML(Чтение);\r\n        \r\n        //покажем что прочитали, осталось только записать объект\r\n        Сообщить(\"\"+ТипЗнч(Объект)+\" - \"+Объект);\r\n    КонецЦикла;\r\n    \r\n    Чтение.Закрыть();\n\n//Имя справочника для примера\r\n    ИмяСправочника = \"Номенклатура\";\r\n    \r\n    ////////////////////////////////////////////////////////////­/////////////\r\n    //Выгрузка\r\n    \r\n    Запись = Новый ЗаписьXML;\r\n    Запись.УстановитьСтроку();\r\n    \r\n    //записываем объявление xml файла: <?xml version=\"1.0\"?>\r\n    Запись.ЗаписатьОбъявлениеXML();\r\n    \r\n    //записываем корневой элемент, по спецификации xml он может быть только один, назовем его \"Данные\"\r\n    Запись.ЗаписатьНачалоЭлемента(\"Данные\");\r\n    \r\n    //для того чтобы пространства имен не объявлялись сериализатором в кажом элементе, пишем их в корневой элемент\r\n    //они будут работать на все вложеные элементы\r\n    //пространство имен по-умолчанию\r\n    Запись.ЗаписатьСоответствиеПространстваИмен(\"\", \"http://v8.1c.ru/8.1/data/enterprise/current-config\");\r\n    \r\n    //пространства имен остальные префиксы\r\n    Запись.ЗаписатьСоответствиеПространстваИмен(\"xsd\", \"http://www.w3.org/2001/XMLSchema\");\r\n    Запись.ЗаписатьСоответствиеПространстваИмен(\"xsi\", \"http://www.w3.org/2001/XMLSchema-instance\");\r\n    \r\n    //ограничение количества выгружаемых элементов для примера\r\n    Кол = 4;\r\n    Выборка = Справочники[ИмяСправочника].Выбрать();\r\n    Пока Выборка.Следующий() Цикл\r\n        \r\n        //вместо этого кода в боевой реализации выгрузки будет создание ОбъектаXDTO и его сериализация\r\n        //через ФабрикуXDTO и загруженные в нее схемы конфигурации приемника\r\n        СериализаторXDTO.ЗаписатьXML(Запись, Выборка.ПолучитьОбъект());\r\n        //\r\n        \r\n        Кол = Кол - 1;\r\n        Если Кол=0 Тогда\r\n            Прервать;\r\n        КонецЕсли;\r\n    КонецЦикла;\r\n    \r\n    //записываем конец корневого элемента\r\n    Запись.ЗаписатьКонецЭлемента();\r\n    \r\n    //покажем что получилось\r\n    Текст = Запись.Закрыть();\r\n    Сообщить(\"Содержимое файла:\");\r\n    Сообщить(Текст);\r\n    \r\n    //а теперь загрузим это обратно\r\n    \r\n    ////////////////////////////////////////////////////////////­/////////////\r\n    //Загрузка\r\n    Сообщить(\"Данные полученные при загрузке:\");\r\n    \r\n    Чтение = Новый ЧтениеXML;\r\n    Чтение.УстановитьСтроку(Текст);\r\n    \r\n    //прочитаем начало xml файла\r\n    Чтение.ПерейтиКСодержимому();\r\n    \r\n    //прочитаем начало корневого элемента\r\n    Чтение.Прочитать();\r\n    \r\n    //читаем содержимое пока текущим не станет конец корневого элемента, т.к. мы писали туда только целые элементы справочника,\r\n    //а сериализатор читает каждый из их полностью, то мы упремся именно в конец корневого\r\n    Пока Чтение.ТипУзла<>ТипУзлаXML.КонецЭлемента Цикл\r\n        \r\n        //читаем очередной элемент справочника\r\n        Объект = СериализаторXDTO.ПрочитатьXML(Чтение);\r\n        \r\n        //покажем что прочитали, осталось только записать объект\r\n        Сообщить(\"\"+ТипЗнч(Объект)+\" - \"+Объект);\r\n    КонецЦикла;\r\n    \r\n    Чтение.Закрыть();\n\nОрфографическая ошибка в сериализатором: сериализатором\r\nОрфографическая ошибка в кажом: кажом\r\nОрфографическая ошибка в вложеные: вложеные\r\nОрфографическая ошибка в сериализация: сериализация"
  },
  {
    "title": "Получить представление [разницы] времени",
    "description": "Получить представление [разницы] времени",
    "code_snippet": "// Возвращает представление прошедшего времени\r\n//\r\n// Параметры:\r\n//  РазницаВремени  - Число - Высчитанная разница времени в секундах/милисекундах\r\n//\tВремяВМилисекундах - Булево - Время передано в милисекундах\r\n//\r\n// Возвращаемое значение:\r\n//   Строка   - Представление разницы времени\r\n//\r\nФункция ПолучитьПредставлениеВремени(РазницаВремени, ВремяВМилисекундах = Ложь) Экспорт\r\n\t\r\n\tРазмерЧаса = 3600;\r\n\tРазмерМинуты = 60;\r\n\tРазмерСекунды = 1;\r\n\t\r\n\tЕсли ВремяВМилисекундах Тогда\r\n\t\t\r\n\t\tРазмерЧаса = РазмерЧаса * 1000;\r\n\t\tРазмерМинуты = РазмерМинуты * 1000;\r\n\t\tРазмерСекунды = РазмерСекунды * 1000;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЧасов = Цел(РазницаВремени / РазмерЧаса);\r\n\tМинут = Цел((РазницаВремени - (Часов * РазмерЧаса)) / РазмерМинуты);\r\n\tСекунд = Цел((РазницаВремени - ((Часов * РазмерЧаса) + (Минут * РазмерМинуты))) / РазмерСекунды);\r\n\t\r\n\tЕсли ВремяВМилисекундах Тогда\r\n\t\t\r\n\t\tМилисекунд = РазницаВремени - ((Часов * РазмерЧаса) + (Минут * РазмерМинуты) + (Секунд * РазмерСекунды));\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tМилисекунд = Цел((РазницаВремени - ((Часов * РазмерЧаса) + (Минут * РазмерМинуты) + (Секунд * РазмерСекунды))) * 1000);\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВремяТекст = \"\";\r\n\t\r\n\tЕсли РазницаВремени >= РазмерЧаса Тогда\r\n\t\t\r\n\t\t//ВремяТекст = ВремяТекст + Строка(Часов) + \" час.\";\r\n\t\tВремяТекст = ВремяТекст + \" \" + СтрокаСЧислом(\";%1 час;;%1 часа;%1 часов;%1 часа\", Часов, ВидЧисловогоЗначения.Количественное);\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли РазницаВремени >= РазмерМинуты Тогда\r\n\t\t\r\n\t\t//ВремяТекст = ВремяТекст + ?(Часов > 0, ?(Секунд > 0, \" \", \" и \"), \"\") + Строка(Минут) + \" мин.\";\r\n\t\tВремяТекст = ВремяТекст + ?(Часов > 0, ?(Секунд > 0, \" \", \" и \"), \"\") + \" \" + СтрокаСЧислом(\";%1 минута;;%1 минуты;%1 минут;%1 минут\", Минут, ВидЧисловогоЗначения.Количественное);\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли РазницаВремени >= РазмерСекунды и Секунд > 0 Тогда\r\n\t\t\r\n\t\t//ВремяТекст = ВремяТекст + ?(Минут > 0, ?(Милисекунд > 0, \" \", \" и \"), \"\") + Строка(Секунд) + \" сек.\";\r\n\t\tВремяТекст = ВремяТекст +  ?(Минут > 0, ?(Милисекунд > 0, \" \", \" и \"), \"\") + \" \" + СтрокаСЧислом(\";%1 секунда;;%1 секунды;%1 секунд;%1 секунд\", Секунд, ВидЧисловогоЗначения.Количественное);\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли Милисекунд > 0 и РазницаВремени <= РазмерСекунды Тогда\r\n\t\t\r\n\t\t//ВремяТекст = ВремяТекст + ?(Секунд > 0, \" и \", \"\") + Строка(Милисекунд) + \" мсек.\";\r\n\t\tВремяТекст = ВремяТекст + Строка(Милисекунд) + \" мсек.\";\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ВремяТекст;\r\n\t\r\nКонецФункции // ПолучитьПредставлениеВремени()\r\n// Внимание, если у вас старая платформа и не поддерживает  метод \"СтрокаСЧислом\" закоментируйте строки и раскоментируйте строки над ними\n\n// Возвращает представление прошедшего времени\r\n//\r\n// Параметры:\r\n//  РазницаВремени  - Число - Высчитанная разница времени в секундах/милисекундах\r\n//\tВремяВМилисекундах - Булево - Время передано в милисекундах\r\n//\r\n// Возвращаемое значение:\r\n//   Строка   - Представление разницы времени\r\n//\r\nФункция ПолучитьПредставлениеВремени(РазницаВремени, ВремяВМилисекундах = Ложь) Экспорт\r\n\t\r\n\tРазмерЧаса = 3600;\r\n\tРазмерМинуты = 60;\r\n\tРазмерСекунды = 1;\r\n\t\r\n\tЕсли ВремяВМилисекундах Тогда\r\n\t\t\r\n\t\tРазмерЧаса = РазмерЧаса * 1000;\r\n\t\tРазмерМинуты = РазмерМинуты * 1000;\r\n\t\tРазмерСекунды = РазмерСекунды * 1000;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЧасов = Цел(РазницаВремени / РазмерЧаса);\r\n\tМинут = Цел((РазницаВремени - (Часов * РазмерЧаса)) / РазмерМинуты);\r\n\tСекунд = Цел((РазницаВремени - ((Часов * РазмерЧаса) + (Минут * РазмерМинуты))) / РазмерСекунды);\r\n\t\r\n\tЕсли ВремяВМилисекундах Тогда\r\n\t\t\r\n\t\tМилисекунд = РазницаВремени - ((Часов * РазмерЧаса) + (Минут * РазмерМинуты) + (Секунд * РазмерСекунды));\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tМилисекунд = Цел((РазницаВремени - ((Часов * РазмерЧаса) + (Минут * РазмерМинуты) + (Секунд * РазмерСекунды))) * 1000);\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВремяТекст = \"\";\r\n\t\r\n\tЕсли РазницаВремени >= РазмерЧаса Тогда\r\n\t\t\r\n\t\t//ВремяТекст = ВремяТекст + Строка(Часов) + \" час.\";\r\n\t\tВремяТекст = ВремяТекст + \" \" + СтрокаСЧислом(\";%1 час;;%1 часа;%1 часов;%1 часа\", Часов, ВидЧисловогоЗначения.Количественное);\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли РазницаВремени >= РазмерМинуты Тогда\r\n\t\t\r\n\t\t//ВремяТекст = ВремяТекст + ?(Часов > 0, ?(Секунд > 0, \" \", \" и \"), \"\") + Строка(Минут) + \" мин.\";\r\n\t\tВремяТекст = ВремяТекст + ?(Часов > 0, ?(Секунд > 0, \" \", \" и \"), \"\") + \" \" + СтрокаСЧислом(\";%1 минута;;%1 минуты;%1 минут;%1 минут\", Минут, ВидЧисловогоЗначения.Количественное);\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли РазницаВремени >= РазмерСекунды и Секунд > 0 Тогда\r\n\t\t\r\n\t\t//ВремяТекст = ВремяТекст + ?(Минут > 0, ?(Милисекунд > 0, \" \", \" и \"), \"\") + Строка(Секунд) + \" сек.\";\r\n\t\tВремяТекст = ВремяТекст +  ?(Минут > 0, ?(Милисекунд > 0, \" \", \" и \"), \"\") + \" \" + СтрокаСЧислом(\";%1 секунда;;%1 секунды;%1 секунд;%1 секунд\", Секунд, ВидЧисловогоЗначения.Количественное);\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли Милисекунд > 0 и РазницаВремени <= РазмерСекунды Тогда\r\n\t\t\r\n\t\t//ВремяТекст = ВремяТекст + ?(Секунд > 0, \" и \", \"\") + Строка(Милисекунд) + \" мсек.\";\r\n\t\tВремяТекст = ВремяТекст + Строка(Милисекунд) + \" мсек.\";\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат ВремяТекст;\r\n\t\r\nКонецФункции // ПолучитьПредставлениеВремени()\r\n// Внимание, если у вас старая платформа и не поддерживает  метод \"СтрокаСЧислом\" закоментируйте строки и раскоментируйте строки над ними\n\nОрфографическая ошибка в милисекундах (найдено 3): милисекундах\r\nОрфографическая ошибка в ВремяВМилисекундах (найдено 4): Милисекундах\r\nОрфографическая ошибка в Милисекунд (найдено 7): Милисекунд\r\nОрфографическая ошибка в закоментируйте: закоментируйте\r\nОрфографическая ошибка в раскоментируйте: раскоментируйте"
  },
  {
    "title": "Получить разницу дат в [секундах, минутах, днях, ...]",
    "description": "Получить разницу дат в [секундах, минутах, днях, ...]",
    "code_snippet": "// Получение запросом\r\n\r\n// Возращает разницу переданных дат в указанном типе разницы\r\n//\r\n// Параметры:\r\n//  МеньшаяДата \t- Меньшая (Начальная) дата, к примеру дата документа\r\n//  БольшаяДата \t- Большая (Конечная) дата, к примеру текущая дата\r\n//  Тип\t\t- Тип разницы, поддерживается: секунда, минута, час, день, неделя, месяц, год\r\n//\tВыбиратьБольшуюДатуПервой - В случае если в качестве меньшей даты, указана большая, можно ли их поменять местами\r\n//\r\n// Порядок указания дат не пренципиален, функция сама определит какая из дат большая.\r\n// По умолчанию тип разницы \"день\".\r\n// Указывать тип можно в любом регистре.\r\n// Возращает целое число!\r\n//\r\nФункция ПолучитьРазницуДатВ(Знач МеньшаяДата, Знач БольшаяДата, Тип = \"день\", ВыбиратьБольшуюДатуПервой = Истина) Экспорт\r\n\r\n\tТип = НРег(Тип);\r\n\t\r\n\tЕсли МеньшаяДата > БольшаяДата и ВыбиратьБольшуюДатуПервой Тогда\r\n\t\t\r\n\t\tВремДата = БольшаяДата;\r\n\t\tБольшаяДата = МеньшаяДата;\r\n\t\tМеньшаяДата = ВремДата;\r\n\t\t\r\n\tИначеЕсли БольшаяДата = МеньшаяДата Тогда \r\n\t\t\r\n\t\tВозврат 0;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\t\r\n\tЕсли Тип = \"сек\" или Тип = \"секунда\" или Тип = \"секунды\" Тогда Возврат БольшаяДата - МеньшаяДата;\r\n\tИначеЕсли Тип = \"мин\" или Тип = \"минута\" или Тип = \"минуты\" Тогда Тип = \"МИНУТА\"\r\n\tИначеЕсли Тип = \"час\" или Тип = \"часы\" Тогда Тип = \"ЧАС\"\r\n\tИначеЕсли Тип = \"день\" или Тип = \"дней\" или Тип = \"дни\" Тогда Тип = \"ДЕНЬ\"\r\n\tИначеЕсли Тип = \"неделя\" или Тип = \"недель\" или Тип = \"недели\" Тогда Тип = \"НЕДЕЛЯ\"\r\n\tИначеЕсли  Тип = \"месяц\" или Тип = \"месяцев\" или Тип = \"месяцы\" Тогда Тип = \"МЕСЯЦ\"\r\n\tИначеЕсли Тип = \"год\" или Тип = \"лет\" Тогда Тип = \"ГОД\"\r\n\tИначе Возврат 0;\r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"БольшаяДата\", БольшаяДата);\r\n\tЗапрос.УстановитьПараметр(\"МеньшаяДата\", МеньшаяДата);\r\n\tЗапрос.УстановитьПараметр(\"ВидСравнения\", Тип);\r\n\tЗапрос.Текст= \"ВЫБРАТЬ РАЗНОСТЬДАТ(&МеньшаяДата, &БольшаяДата, ДЕНЬ) КАК Разница\";\r\n\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"ДЕНЬ\", Тип);\r\n\tВыборка = Запрос.Выполнить().Выбрать(); \r\n\t\r\n\tВозврат ?(Выборка.Следующий(), ?(Выборка.Разница <> Null, Выборка.Разница, 0), 0);\r\n\t\t\r\nКонецФункции\r\n\r\n// На клиенте\r\n\r\n// Возращает разницу переданных дат в указанном типе разницы\r\n//\r\n// Параметры:\r\n//  МеньшаяДата \t- Меньшая (Начальная) дата, к примеру дата документа\r\n//  БольшаяДата \t- Большая (Конечная) дата, к примеру текущая дата\r\n//  Тип\t\t- Тип разницы, поддерживается: секунда, минута, час, день, неделя, месяц, год\r\n//\tВыбиратьБольшуюДатуПервой - В случае если в качестве меньшей даты, указана большая, можно ли их поменять местами\r\n//\r\n// Порядок указания дат не пренципиален, функция сама определит какая из дат большая.\r\n// По умолчанию тип разницы \"день\".\r\n// Указывать тип можно в любом регистре.\r\n// Возращает целое число!\r\n//\r\nФункция ПолучитьРазницуДатВ(Знач МеньшаяДата, Знач БольшаяДата, Тип = \"день\", ВыбиратьБольшуюДатуПервой = Истина) Экспорт\r\n\t\r\n\tТип = НРег(Тип);\r\n\t\r\n\tЕсли МеньшаяДата > БольшаяДата и ВыбиратьБольшуюДатуПервой Тогда\r\n\t\t\r\n\t\tВремДата = БольшаяДата;\r\n\t\tБольшаяДата = МеньшаяДата;\r\n\t\tМеньшаяДата = ВремДата;\r\n\t\t\r\n\tИначеЕсли БольшаяДата = МеньшаяДата Тогда \r\n\t\t\r\n\t\tВозврат 0;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tРазница = БольшаяДата - МеньшаяДата;\t\r\n\t\r\n\tЕсли Тип = \"сек\" или Тип = \"секунда\" или Тип = \"секунды\" Тогда\r\n\t\tВозврат Разница;\r\n\tИначеЕсли Тип = \"мин\" или Тип = \"минута\" или Тип = \"минуты\" Тогда\r\n\t\tВозврат Цел(Разница / 60);\r\n\tИначеЕсли Тип = \"час\" или Тип = \"часы\" Тогда\r\n\t\tВозврат Цел(Разница / (60*60));\r\n\tИначеЕсли Тип = \"день\" или Тип = \"дней\" или Тип = \"дни\" Тогда \r\n\t\tВозврат Цел(Разница / (60*60*24));\r\n\tИначеЕсли Тип = \"неделя\" или Тип = \"недель\" или Тип = \"недели\" Тогда\r\n\t\tВозврат Цел(Разница / (60*60*24*7));\r\n\tИначеЕсли  Тип = \"месяц\" или Тип = \"месяцев\" или Тип = \"месяцы\" Тогда\r\n\t\tВозврат Цел(Разница / (60*60*24*30));\r\n\tИначеЕсли Тип = \"год\" или Тип = \"лет\" Тогда\r\n\t\tВозврат Цел(Разница / (60*60*24*365));\r\n\tИначе \r\n\t\tВозврат 0;\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции\n\n// Получение запросом\r\n\r\n// Возращает разницу переданных дат в указанном типе разницы\r\n//\r\n// Параметры:\r\n//  МеньшаяДата \t- Меньшая (Начальная) дата, к примеру дата документа\r\n//  БольшаяДата \t- Большая (Конечная) дата, к примеру текущая дата\r\n//  Тип\t\t- Тип разницы, поддерживается: секунда, минута, час, день, неделя, месяц, год\r\n//\tВыбиратьБольшуюДатуПервой - В случае если в качестве меньшей даты, указана большая, можно ли их поменять местами\r\n//\r\n// Порядок указания дат не пренципиален, функция сама определит какая из дат большая.\r\n// По умолчанию тип разницы \"день\".\r\n// Указывать тип можно в любом регистре.\r\n// Возращает целое число!\r\n//\r\nФункция ПолучитьРазницуДатВ(Знач МеньшаяДата, Знач БольшаяДата, Тип = \"день\", ВыбиратьБольшуюДатуПервой = Истина) Экспорт\r\n\r\n\tТип = НРег(Тип);\r\n\t\r\n\tЕсли МеньшаяДата > БольшаяДата и ВыбиратьБольшуюДатуПервой Тогда\r\n\t\t\r\n\t\tВремДата = БольшаяДата;\r\n\t\tБольшаяДата = МеньшаяДата;\r\n\t\tМеньшаяДата = ВремДата;\r\n\t\t\r\n\tИначеЕсли БольшаяДата = МеньшаяДата Тогда \r\n\t\t\r\n\t\tВозврат 0;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\t\r\n\tЕсли Тип = \"сек\" или Тип = \"секунда\" или Тип = \"секунды\" Тогда Возврат БольшаяДата - МеньшаяДата;\r\n\tИначеЕсли Тип = \"мин\" или Тип = \"минута\" или Тип = \"минуты\" Тогда Тип = \"МИНУТА\"\r\n\tИначеЕсли Тип = \"час\" или Тип = \"часы\" Тогда Тип = \"ЧАС\"\r\n\tИначеЕсли Тип = \"день\" или Тип = \"дней\" или Тип = \"дни\" Тогда Тип = \"ДЕНЬ\"\r\n\tИначеЕсли Тип = \"неделя\" или Тип = \"недель\" или Тип = \"недели\" Тогда Тип = \"НЕДЕЛЯ\"\r\n\tИначеЕсли  Тип = \"месяц\" или Тип = \"месяцев\" или Тип = \"месяцы\" Тогда Тип = \"МЕСЯЦ\"\r\n\tИначеЕсли Тип = \"год\" или Тип = \"лет\" Тогда Тип = \"ГОД\"\r\n\tИначе Возврат 0;\r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"БольшаяДата\", БольшаяДата);\r\n\tЗапрос.УстановитьПараметр(\"МеньшаяДата\", МеньшаяДата);\r\n\tЗапрос.УстановитьПараметр(\"ВидСравнения\", Тип);\r\n\tЗапрос.Текст= \"ВЫБРАТЬ РАЗНОСТЬДАТ(&МеньшаяДата, &БольшаяДата, ДЕНЬ) КАК Разница\";\r\n\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"ДЕНЬ\", Тип);\r\n\tВыборка = Запрос.Выполнить().Выбрать(); \r\n\t\r\n\tВозврат ?(Выборка.Следующий(), ?(Выборка.Разница <> Null, Выборка.Разница, 0), 0);\r\n\t\t\r\nКонецФункции\r\n\r\n// На клиенте\r\n\r\n// Возращает разницу переданных дат в указанном типе разницы\r\n//\r\n// Параметры:\r\n//  МеньшаяДата \t- Меньшая (Начальная) дата, к примеру дата документа\r\n//  БольшаяДата \t- Большая (Конечная) дата, к примеру текущая дата\r\n//  Тип\t\t- Тип разницы, поддерживается: секунда, минута, час, день, неделя, месяц, год\r\n//\tВыбиратьБольшуюДатуПервой - В случае если в качестве меньшей даты, указана большая, можно ли их поменять местами\r\n//\r\n// Порядок указания дат не пренципиален, функция сама определит какая из дат большая.\r\n// По умолчанию тип разницы \"день\".\r\n// Указывать тип можно в любом регистре.\r\n// Возращает целое число!\r\n//\r\nФункция ПолучитьРазницуДатВ(Знач МеньшаяДата, Знач БольшаяДата, Тип = \"день\", ВыбиратьБольшуюДатуПервой = Истина) Экспорт\r\n\t\r\n\tТип = НРег(Тип);\r\n\t\r\n\tЕсли МеньшаяДата > БольшаяДата и ВыбиратьБольшуюДатуПервой Тогда\r\n\t\t\r\n\t\tВремДата = БольшаяДата;\r\n\t\tБольшаяДата = МеньшаяДата;\r\n\t\tМеньшаяДата = ВремДата;\r\n\t\t\r\n\tИначеЕсли БольшаяДата = МеньшаяДата Тогда \r\n\t\t\r\n\t\tВозврат 0;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tРазница = БольшаяДата - МеньшаяДата;\t\r\n\t\r\n\tЕсли Тип = \"сек\" или Тип = \"секунда\" или Тип = \"секунды\" Тогда\r\n\t\tВозврат Разница;\r\n\tИначеЕсли Тип = \"мин\" или Тип = \"минута\" или Тип = \"минуты\" Тогда\r\n\t\tВозврат Цел(Разница / 60);\r\n\tИначеЕсли Тип = \"час\" или Тип = \"часы\" Тогда\r\n\t\tВозврат Цел(Разница / (60*60));\r\n\tИначеЕсли Тип = \"день\" или Тип = \"дней\" или Тип = \"дни\" Тогда \r\n\t\tВозврат Цел(Разница / (60*60*24));\r\n\tИначеЕсли Тип = \"неделя\" или Тип = \"недель\" или Тип = \"недели\" Тогда\r\n\t\tВозврат Цел(Разница / (60*60*24*7));\r\n\tИначеЕсли  Тип = \"месяц\" или Тип = \"месяцев\" или Тип = \"месяцы\" Тогда\r\n\t\tВозврат Цел(Разница / (60*60*24*30));\r\n\tИначеЕсли Тип = \"год\" или Тип = \"лет\" Тогда\r\n\t\tВозврат Цел(Разница / (60*60*24*365));\r\n\tИначе \r\n\t\tВозврат 0;\r\n\tКонецЕсли;\r\n\t\r\nКонецФункции\n\n{69} Высокая цикломатическая сложность: 28\r\nОрфографическая ошибка в Возращает (найдено 4): Возращает\r\nОрфографическая ошибка в пренципиален (найдено 2): пренципиален"
  },
  {
    "title": "Получить дату через указанное количество [дней, месяцев, лет, ...]",
    "description": "Получить дату через указанное количество [дней, месяцев, лет, ...]",
    "code_snippet": "// Возращает дату через указанное количество в указанном типе\r\n//\r\n// Параметры:\r\n//\tДата1\t- Дата от которой будет производится исчисление\r\n//\tКол\t\t- Количество прибавляемых или убавляемых единиц указанного типа\r\n//\tТип\t\t- Тип исчисления, поддерживается: секунда, минута, день, час, неделя, меняс, год\r\n//\tЗнак\t- При значении \"+\" прибавляет к дате указанное количество единиц указанного типа\r\n//\t\t\t  При значении \"-\" отнимает от даты указанное количество единиц указанного типа\r\n//\r\n// По умолчанию тип разницы \"День\", знак равен \"+\". \r\n// Указывать тип можно в любом регистре!\r\n// Допускается передавать отрицательное количество единиц в поле \"Кол\" и опускании значения \"Знак\"\r\n// В таком случае функция будет считать значение параметра знак равным \"-\"\r\n//\r\nФункция ПолучитьДатуЧерез(Дата1, Кол, Знач Тип = \"день\", Знач Знак = \"\") Экспорт\r\n\r\n\tЕсли Кол = 0 Тогда\r\n\t\tВозврат Дата1;\r\n\tКонецЕсли;\r\n\t\r\n\tТип = НРег(Тип);\r\n\t\r\n\tЕсли Кол < 0 и НЕ ЗначениеЗаполнено(Знак) Тогда\r\n\t\tКол = Кол * -1;\r\n\t\tЗнак = \"-\";\r\n\tИначеЕсли НЕ ЗначениеЗаполнено(Знак) Тогда\r\n\t\tЗнак = \"+\";\r\n\tКонецЕсли;\r\n\t\r\n\tЗнакПлюс = ?(Знак = \"+\", Истина, Ложь);\r\n\t\r\n\tЕсли НЕ ЗнакПлюс Тогда\r\n\t\t\r\n\t\tКол = Кол * -1;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли Тип = \"сек\" или Тип = \"секунда\" или Тип = \"секунды\" Тогда Тип = \"СЕКУНДА\"\r\n\tИначеЕсли Тип = \"мин\" или Тип = \"минута\" или Тип = \"минуты\" Тогда Тип = \"МИНУТА\"\r\n\tИначеЕсли Тип = \"час\" или Тип = \"часы\" Тогда Тип = \"ЧАС\"\r\n\tИначеЕсли Тип = \"день\" или Тип = \"дней\" или Тип = \"дни\" Тогда Тип = \"ДЕНЬ\"\r\n\tИначеЕсли Тип = \"неделя\" или Тип = \"недель\" или Тип = \"недели\" Тогда Тип = \"НЕДЕЛЯ\"\r\n\tИначеЕсли  Тип = \"месяц\" или Тип = \"месяцев\" или Тип = \"месяцы\" Тогда Тип = \"МЕСЯЦ\"\r\n\tИначеЕсли Тип = \"год\" или Тип = \"лет\" Тогда Тип = \"ГОД\"\r\n\tИначе Возврат 0;\r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"Дата\", Дата1);\r\n\tЗапрос.УстановитьПараметр(\"Кол\", Кол);\r\n\tЗапрос.Текст= \"ВЫБРАТЬ ДОБАВИТЬКДАТЕ(&Дата, ДЕНЬ, &Кол) КАК Значение\";\r\n\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"ДЕНЬ\", Тип);\r\n\tВыборка = Запрос.Выполнить().Выбрать(); \r\n\t\r\n\tВозврат ?(Выборка.Следующий(), Выборка.Значение, 0);\r\n\t\r\nКонецФункции\n\n// Возращает дату через указанное количество в указанном типе\r\n//\r\n// Параметры:\r\n//\tДата1\t- Дата от которой будет производится исчисление\r\n//\tКол\t\t- Количество прибавляемых или убавляемых единиц указанного типа\r\n//\tТип\t\t- Тип исчисления, поддерживается: секунда, минута, день, час, неделя, меняс, год\r\n//\tЗнак\t- При значении \"+\" прибавляет к дате указанное количество единиц указанного типа\r\n//\t\t\t  При значении \"-\" отнимает от даты указанное количество единиц указанного типа\r\n//\r\n// По умолчанию тип разницы \"День\", знак равен \"+\". \r\n// Указывать тип можно в любом регистре!\r\n// Допускается передавать отрицательное количество единиц в поле \"Кол\" и опускании значения \"Знак\"\r\n// В таком случае функция будет считать значение параметра знак равным \"-\"\r\n//\r\nФункция ПолучитьДатуЧерез(Дата1, Кол, Знач Тип = \"день\", Знач Знак = \"\") Экспорт\r\n\r\n\tЕсли Кол = 0 Тогда\r\n\t\tВозврат Дата1;\r\n\tКонецЕсли;\r\n\t\r\n\tТип = НРег(Тип);\r\n\t\r\n\tЕсли Кол < 0 и НЕ ЗначениеЗаполнено(Знак) Тогда\r\n\t\tКол = Кол * -1;\r\n\t\tЗнак = \"-\";\r\n\tИначеЕсли НЕ ЗначениеЗаполнено(Знак) Тогда\r\n\t\tЗнак = \"+\";\r\n\tКонецЕсли;\r\n\t\r\n\tЗнакПлюс = ?(Знак = \"+\", Истина, Ложь);\r\n\t\r\n\tЕсли НЕ ЗнакПлюс Тогда\r\n\t\t\r\n\t\tКол = Кол * -1;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\n\tЕсли Тип = \"сек\" или Тип = \"секунда\" или Тип = \"секунды\" Тогда Тип = \"СЕКУНДА\"\r\n\tИначеЕсли Тип = \"мин\" или Тип = \"минута\" или Тип = \"минуты\" Тогда Тип = \"МИНУТА\"\r\n\tИначеЕсли Тип = \"час\" или Тип = \"часы\" Тогда Тип = \"ЧАС\"\r\n\tИначеЕсли Тип = \"день\" или Тип = \"дней\" или Тип = \"дни\" Тогда Тип = \"ДЕНЬ\"\r\n\tИначеЕсли Тип = \"неделя\" или Тип = \"недель\" или Тип = \"недели\" Тогда Тип = \"НЕДЕЛЯ\"\r\n\tИначеЕсли  Тип = \"месяц\" или Тип = \"месяцев\" или Тип = \"месяцы\" Тогда Тип = \"МЕСЯЦ\"\r\n\tИначеЕсли Тип = \"год\" или Тип = \"лет\" Тогда Тип = \"ГОД\"\r\n\tИначе Возврат 0;\r\n\tКонецЕсли;\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"Дата\", Дата1);\r\n\tЗапрос.УстановитьПараметр(\"Кол\", Кол);\r\n\tЗапрос.Текст= \"ВЫБРАТЬ ДОБАВИТЬКДАТЕ(&Дата, ДЕНЬ, &Кол) КАК Значение\";\r\n\tЗапрос.Текст = СтрЗаменить(Запрос.Текст, \"ДЕНЬ\", Тип);\r\n\tВыборка = Запрос.Выполнить().Выбрать(); \r\n\t\r\n\tВозврат ?(Выборка.Следующий(), Выборка.Значение, 0);\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в Возращает: Возращает\r\nОрфографическая ошибка в меняс: меняс"
  },
  {
    "title": "Отправка сообщения в чат-бот телеграм",
    "description": "Отправка сообщения в чат-бот телеграм",
    "code_snippet": "// 1) Создаем бота в телеграме, для этого нужно перейти в @BotFather и проследовать инструкциям,\n//    по окончании которых нам предоставят Access token\t\nДанныеДоступа = \"это Access token\";\n\n// 2) однократно получаем ID чата с ботом, предварительно написав боту любое сообщение\n// быстро: \n\t\t\t// - https://cms3.ru/kak-poluchit-chat-id-telegram/\n\t\t\t// - api.telegram.org/bot<ДанныеДоступа>/getUpdates\n// чуть дольше: из текста json ответа, в объекте chat: \"chat\": {\"id\": \"ид чата\"}\nСоединение = Новый HTTPСоединение(\"api.telegram.org\",443,,,,,Новый ЗащищенноеСоединениеOpenSSL());\nТекстJSONОтвета = Соединение.Получить(Новый HTTPЗапрос(\"bot\" + ДанныеДоступа + \"/getUpdates\")).ПолучитьТелоКакСтроку();\n//(затем можно закомментировать две строчки кода выше)\nИдЧата = \"это chat.id\";\n\n// 3) Отправляем сообщение с ранее указанными сообщением, токеном, ид чата\nЗапрячьТелегу = Новый HTTPСоединение(\"api.telegram.org\",443,,,,15,Новый ЗащищенноеСоединениеOpenSSL());\nЗапрячьТелегу.Получить(Новый HTTPЗапрос(\"bot\" + ДанныеДоступа + \"/sendMessage?chat_id=\" + ИдЧата + \"&text=\" + Сообщение));"
  },
  {
    "title": "github",
    "description": "Библиотека упрощает взаимодействие с GitHub API из OneScript.",
    "code_snippet": ""
  },
  {
    "title": "yaspeller",
    "description": "Средство проверок и исправления опечаток в тексте.",
    "code_snippet": ""
  },
  {
    "title": "Определение суммарного покрытия перекрывающихся интервалов",
    "description": "Определение суммарного покрытия перекрывающихся интервалов",
    "code_snippet": "ВЫБРАТЬ\n    СУММА(ВложенныйЗапрос.Разность) КАК ЗанятыхДней\nИЗ\n    (ВЫБРАТЬ РАЗЛИЧНЫЕ\n        1 - РАЗНОСТЬДАТ(ДАТАВРЕМЯ(1, 1, 1), Дано.ДатаНачала, ДЕНЬ) КАК Разность\n    ИЗ\n        Дано КАК Дано\n            ЛЕВОЕ СОЕДИНЕНИЕ Дано КАК Левее\n            ПО (Левее.ДатаНачала < Дано.ДатаНачала)\n                И Дано.ДатаНачала <= Левее.ДатаОкончания\n    ГДЕ\n        Левее.ДатаНачала ЕСТЬ NULL\n\n    ОБЪЕДИНИТЬ ВСЕ\n\n    ВЫБРАТЬ РАЗЛИЧНЫЕ\n        РАЗНОСТЬДАТ(ДАТАВРЕМЯ(1, 1, 1), Дано.ДатаОкончания, ДЕНЬ)\n    ИЗ\n        Дано КАК Дано\n            ЛЕВОЕ СОЕДИНЕНИЕ Дано КАК Правее\n            ПО (Правее.ДатаНачала <= Дано.ДатаОкончания)\n                И Дано.ДатаОкончания < Правее.ДатаОкончания\n    ГДЕ\n        Правее.ДатаОкончания ЕСТЬ NULL) КАК ВложенныйЗапрос"
  },
  {
    "title": "Определение пересечения интервалов в кольце",
    "description": "Определение пересечения интервалов в кольце",
    "code_snippet": "select * from tab\nwhere (@start - start) * (start - @end) * (@start - @end) <= 0 \n      or (@start - start) * (@start - end) * (start - end) >= 0;"
  },
  {
    "title": "Получение интервалов неизменности курсов валют",
    "description": "Получение интервалов неизменности курсов валют",
    "code_snippet": "ВЫБРАТЬ\r\n    Дано.Период,\r\n    Дано.Валюта,\r\n    Дано.Курс,\r\n    КОЛИЧЕСТВО(Было.Курс) КАК Номер\r\nПОМЕСТИТЬ Интервалы\r\nИЗ\r\n    Дано КАК Дано\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Дано КАК Было\r\n        ПО (Было.Валюта = Дано.Валюта)\r\n            И (Было.Период <= Дано.Период)\r\n            И (Было.Курс <> Дано.Курс)\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.Период,\r\n    Дано.Валюта,\r\n    Дано.Курс\r\n;\r\nВЫБРАТЬ\r\n    МИНИМУМ(Интервалы.Период) КАК ДатаС,\r\n    МАКСИМУМ(Интервалы.Период) КАК ДатаПо,\r\n    Интервалы.Валюта,\r\n    Интервалы.Курс\r\nИЗ\r\n    Интервалы КАК Интервалы\r\nСГРУППИРОВАТЬ ПО\r\n    Интервалы.Валюта,\r\n    Интервалы.Курс,\r\n    Интервалы.Номер\r\nУПОРЯДОЧИТЬ ПО\r\n    Интервалы.Валюта,\r\n    ДатаС\n\nВЫБРАТЬ\r\n    Дано.Период,\r\n    Дано.Валюта,\r\n    Дано.Курс,\r\n    КОЛИЧЕСТВО(Было.Курс) КАК Номер\r\nПОМЕСТИТЬ Интервалы\r\nИЗ\r\n    Дано КАК Дано\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Дано КАК Было\r\n        ПО (Было.Валюта = Дано.Валюта)\r\n            И (Было.Период <= Дано.Период)\r\n            И (Было.Курс <> Дано.Курс)\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.Период,\r\n    Дано.Валюта,\r\n    Дано.Курс\r\n;\r\nВЫБРАТЬ\r\n    МИНИМУМ(Интервалы.Период) КАК ДатаС,\r\n    МАКСИМУМ(Интервалы.Период) КАК ДатаПо,\r\n    Интервалы.Валюта,\r\n    Интервалы.Курс\r\nИЗ\r\n    Интервалы КАК Интервалы\r\nСГРУППИРОВАТЬ ПО\r\n    Интервалы.Валюта,\r\n    Интервалы.Курс,\r\n    Интервалы.Номер\r\nУПОРЯДОЧИТЬ ПО\r\n    Интервалы.Валюта,\r\n    ДатаС\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Определение пропусков в последовательности чисел",
    "description": "Определение пропусков в последовательности чисел",
    "code_snippet": "В обсуждении много разных вариантов решения. Из моих быстрее всего работает вот этот:\r\n\r\nВЫБРАТЬ ПЕРВЫЕ 2\r\n    Дано.Х + ВЗ.У КАК Х\r\nИЗ\r\n    Дано КАК Дано,\r\n    (ВЫБРАТЬ\r\n        0 КАК У    \r\n    ОБЪЕДИНИТЬ\r\n    ВЫБРАТЬ\r\n        1) КАК ВЗ\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.Х + ВЗ.У\r\nИМЕЮЩИЕ\r\n    КОЛИЧЕСТВО(*) = 1\r\nУПОРЯДОЧИТЬ ПО\r\n    Дано.Х + ВЗ.У\n\nВ обсуждении много разных вариантов решения. Из моих быстрее всего работает вот этот:\r\n\r\nВЫБРАТЬ ПЕРВЫЕ 2\r\n    Дано.Х + ВЗ.У КАК Х\r\nИЗ\r\n    Дано КАК Дано,\r\n    (ВЫБРАТЬ\r\n        0 КАК У    \r\n    ОБЪЕДИНИТЬ\r\n    ВЫБРАТЬ\r\n        1) КАК ВЗ\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.Х + ВЗ.У\r\nИМЕЮЩИЕ\r\n    КОЛИЧЕСТВО(*) = 1\r\nУПОРЯДОЧИТЬ ПО\r\n    Дано.Х + ВЗ.У\n\n{1} Ожидается идентификатор"
  },
  {
    "title": "Инвертирование периодов в запросе",
    "description": "Инвертирование периодов в запросе",
    "code_snippet": "ВЫБРАТЬ\r\n    &ДатаНачалаОсновная КАК Дата\r\nПОМЕСТИТЬ Даты\r\nОБЪЕДИНИТЬ ВСЕ\r\nВЫБРАТЬ\r\n    ДОБАВИТЬКДАТЕ(Дано.ДатаНачалаИсключения, ДЕНЬ, -1)\r\nИЗ\r\n    Дано КАК Дано\r\nОБЪЕДИНИТЬ ВСЕ\r\nВЫБРАТЬ\r\n    ДОБАВИТЬКДАТЕ(Дано.ДатаОкончанияИсключения, ДЕНЬ, 1)\r\nИЗ\r\n    Дано КАК Дано\r\nОБЪЕДИНИТЬ ВСЕ\r\nВЫБРАТЬ\r\n    &ДатаОкончанияОсновная\r\n;\r\nВЫБРАТЬ\r\n    МИНИМУМ(Даты.Дата) КАК ДатаНачала,\r\n    МАКСИМУМ(Даты.Дата) КАК ДатаОкончания\r\nИЗ\r\n    (ВЫБРАТЬ\r\n        КОЛИЧЕСТВО(Раньше.Дата) КАК Номер,\r\n        Даты.Дата КАК Дата\r\n    ИЗ\r\n        Даты КАК Раньше\r\n            ВНУТРЕННЕЕ СОЕДИНЕНИЕ Даты КАК Даты\r\n            ПО Раньше.Дата <= Даты.Дата\r\n    СГРУППИРОВАТЬ ПО\r\n        Даты.Дата) КАК Даты\r\nСГРУППИРОВАТЬ ПО\r\n    ВЫРАЗИТЬ(Даты.Номер / 2 КАК ЧИСЛО(10, 0))\n\nВЫБРАТЬ\r\n    &ДатаНачалаОсновная КАК Дата\r\nПОМЕСТИТЬ Даты\r\nОБЪЕДИНИТЬ ВСЕ\r\nВЫБРАТЬ\r\n    ДОБАВИТЬКДАТЕ(Дано.ДатаНачалаИсключения, ДЕНЬ, -1)\r\nИЗ\r\n    Дано КАК Дано\r\nОБЪЕДИНИТЬ ВСЕ\r\nВЫБРАТЬ\r\n    ДОБАВИТЬКДАТЕ(Дано.ДатаОкончанияИсключения, ДЕНЬ, 1)\r\nИЗ\r\n    Дано КАК Дано\r\nОБЪЕДИНИТЬ ВСЕ\r\nВЫБРАТЬ\r\n    &ДатаОкончанияОсновная\r\n;\r\nВЫБРАТЬ\r\n    МИНИМУМ(Даты.Дата) КАК ДатаНачала,\r\n    МАКСИМУМ(Даты.Дата) КАК ДатаОкончания\r\nИЗ\r\n    (ВЫБРАТЬ\r\n        КОЛИЧЕСТВО(Раньше.Дата) КАК Номер,\r\n        Даты.Дата КАК Дата\r\n    ИЗ\r\n        Даты КАК Раньше\r\n            ВНУТРЕННЕЕ СОЕДИНЕНИЕ Даты КАК Даты\r\n            ПО Раньше.Дата <= Даты.Дата\r\n    СГРУППИРОВАТЬ ПО\r\n        Даты.Дата) КАК Даты\r\nСГРУППИРОВАТЬ ПО\r\n    ВЫРАЗИТЬ(Даты.Номер / 2 КАК ЧИСЛО(10, 0))\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Проверка совпадения таблиц.",
    "description": "Проверка совпадения таблиц.",
    "code_snippet": "ВЫБРАТЬ\r\n\tМенеджеры.Ссылка\r\nИЗ\r\n\tСправочник.Контрагенты.МенеджерыПокупателя КАК Менеджеры\r\n\r\nСГРУППИРОВАТЬ ПО\r\n\tМенеджеры.Ссылка\r\n\r\nИМЕЮЩИЕ\r\n\tКОЛИЧЕСТВО(*) = &МассивКоличество И\r\n\tМИНИМУМ(Менеджеры.МенеджерПокупателя В (&Массив)) = ИСТИНА\n\nВЫБРАТЬ\r\n\tМенеджеры.Ссылка\r\nИЗ\r\n\tСправочник.Контрагенты.МенеджерыПокупателя КАК Менеджеры\r\n\r\nСГРУППИРОВАТЬ ПО\r\n\tМенеджеры.Ссылка\r\n\r\nИМЕЮЩИЕ\r\n\tКОЛИЧЕСТВО(*) = &МассивКоличество И\r\n\tМИНИМУМ(Менеджеры.МенеджерПокупателя В (&Массив)) = ИСТИНА\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Проверка совпадения таблиц путем сравнения полного и внутреннего соединения",
    "description": "Проверка совпадения таблиц путем сравнения полного и внутреннего соединения",
    "code_snippet": "ВЫБРАТЬ\r\n\tТовары.Номенклатура,\r\n\tТовары.Количество\r\nПОМЕСТИТЬ Эталон\r\nИЗ\r\n\t&Товары КАК Товары\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tТовары.Ссылка\r\nИЗ\r\n\tДокумент.ЗаказПокупателя.Товары КАК Товары\r\n\t\tПОЛНОЕ СОЕДИНЕНИЕ Эталон КАК Эталон\r\n\t\tПО Товары.Номенклатура = Эталон.Номенклатура\r\n\t\t\tИ Товары.Количество = Эталон.Количество\r\n\r\nСГРУППИРОВАТЬ ПО\r\n\tТовары.Ссылка\r\n\r\nИМЕЮЩИЕ\r\n\tКОЛИЧЕСТВО(Товары.Номенклатура) МЕЖДУ КОЛИЧЕСТВО(*) И КОЛИЧЕСТВО(Эталон.Номенклатура)\n\nВЫБРАТЬ\r\n\tТовары.Номенклатура,\r\n\tТовары.Количество\r\nПОМЕСТИТЬ Эталон\r\nИЗ\r\n\t&Товары КАК Товары\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n\tТовары.Ссылка\r\nИЗ\r\n\tДокумент.ЗаказПокупателя.Товары КАК Товары\r\n\t\tПОЛНОЕ СОЕДИНЕНИЕ Эталон КАК Эталон\r\n\t\tПО Товары.Номенклатура = Эталон.Номенклатура\r\n\t\t\tИ Товары.Количество = Эталон.Количество\r\n\r\nСГРУППИРОВАТЬ ПО\r\n\tТовары.Ссылка\r\n\r\nИМЕЮЩИЕ\r\n\tКОЛИЧЕСТВО(Товары.Номенклатура) МЕЖДУ КОЛИЧЕСТВО(*) И КОЛИЧЕСТВО(Эталон.Номенклатура)\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Определение периодов работы сотрудников по данным СКУД. Сгруппировать периоды в запросе",
    "description": "Определение периодов работы сотрудников по данным СКУД. Сгруппировать периоды в запросе",
    "code_snippet": "ВЫБРАТЬ\n    ДОБАВИТЬКДАТЕ(ПроходыСигур.Период, СЕКУНДА, РАЗНОСТЬДАТ(ДАТАВРЕМЯ(1, 1, 1), ПроходыСигур.Время, СЕКУНДА)) КАК Дата,\n    ПроходыСигур.Сотрудник\nПОМЕСТИТЬ Дано\nИЗ\n    ПроходыСигур КАК ПроходыСигур\n;\n\n////////////////////////////////////////////////////////////////////////////////\nВЫБРАТЬ\n    МАКСИМУМ(Раньше.Дата) КАК От,\n    Дано.Дата КАК До,\n    Дано.Сотрудник\nПОМЕСТИТЬ Отсутствия\nИЗ\n    Дано КАК Раньше\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Дано КАК Дано\n        ПО Раньше.Сотрудник = Дано.Сотрудник\n            И Раньше.Дата < Дано.Дата\n\nСГРУППИРОВАТЬ ПО\n    Дано.Сотрудник,\n    Дано.Дата\n\nИМЕЮЩИЕ\n    РАЗНОСТЬДАТ(МАКСИМУМ(Раньше.Дата), Дано.Дата, ЧАС) > 6\n\nОБЪЕДИНИТЬ ВСЕ\n\nВЫБРАТЬ РАЗЛИЧНЫЕ\n    &ДатаНачала,\n    &ДатаНачала,\n    ПроходыСигур.Сотрудник\nИЗ\n    ПроходыСигур КАК ПроходыСигур\n\nОБЪЕДИНИТЬ\n\nВЫБРАТЬ РАЗЛИЧНЫЕ\n    &ДатаОкончания,\n    &ДатаОкончания,\n    ПроходыСигур.Сотрудник\nИЗ\n    ПроходыСигур КАК ПроходыСигур\n;\n\n////////////////////////////////////////////////////////////////////////////////\nВЫБРАТЬ\n    МАКСИМУМ(Раньше.До) КАК От,\n    Отсутствия.От КАК До,\n    Отсутствия.Сотрудник\nИЗ\n    Отсутствия КАК Отсутствия\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Отсутствия КАК Раньше\n        ПО Отсутствия.Сотрудник = Раньше.Сотрудник И Раньше.До < Отсутствия.От  \n\nСГРУППИРОВАТЬ ПО\n    Отсутствия.От,\n    Отсутствия.Сотрудник\n\nОрфографическая ошибка в отсутсвует: отсутсвует\r\nОрфографическая ошибка в ПроходыСигур (найдено 11): Сигур\r\nОрфографическая ошибка в неактивности: неактивности\r\nОрфографическая ошибка в круглосуточности: круглосуточности\r\nОрфографическая ошибка в равновероятности: равновероятности\r\nОрфографическая ошибка в домысливания: домысливания"
  },
  {
    "title": "Найти заказы, количества во всех строках которых меньше либо равны нулю",
    "description": "Найти заказы, количества во всех строках которых меньше либо равны нулю",
    "code_snippet": "ВЫБРАТЬ\r\nСсылка\r\nИЗ Документ.ЗаказПокупателя.Товары\r\nСГРУППИРОВАТЬ ПО Ссылка\r\nИМЕЮЩИЕ МАКСИМУМ(Количество) <= 0\n\nВЫБРАТЬ\r\nСсылка\r\nИЗ Документ.ЗаказПокупателя.Товары\r\nСГРУППИРОВАТЬ ПО Ссылка\r\nИМЕЮЩИЕ МАКСИМУМ(Количество) <= 0\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Определение плановых остатков товара с учетом предшествующих фактических и будущих плановых продаж",
    "description": "Определение плановых остатков товара с учетом предшествующих фактических и будущих плановых продаж",
    "code_snippet": "ВЫБРАТЬ\r\n    ФактическиеПродажи.Период,\r\n    ФактическиеПродажи.Номенклатура,\r\n    ФактическиеПродажи.КоличествоОборот КАК Количество,\r\n    ЛОЖЬ КАК План\r\nПОМЕСТИТЬ НедельныеПродажи\r\nИЗ\r\n    РегистрНакопления.Продажи.Обороты(НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&Дата1, НЕДЕЛЯ, -&Окно), НЕДЕЛЯ), КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&Дата1, НЕДЕЛЯ, -1), НЕДЕЛЯ), Неделя, ) КАК ФактическиеПродажи\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ\r\n    ПланируемыеПродажи.Период,\r\n    ПланируемыеПродажи.Номенклатура,\r\n    ПланируемыеПродажи.КоличествоОборот,\r\n    ИСТИНА\r\nИЗ\r\n    РегистрНакопления.ПланыПродаж.Обороты(НАЧАЛОПЕРИОДА(&Дата1, НЕДЕЛЯ), &Дата2, Неделя, ) КАК ПланируемыеПродажи\r\n;\r\nВЫБРАТЬ\r\n    НедельныеПродажи.Период,\r\n    НедельныеПродажи.Номенклатура,\r\n    СРЕДНЕЕ(ПродажиВОкнеНедель.Количество) КАК Расход\r\nПОМЕСТИТЬ СреднеНедельныеПродажи\r\nИЗ\r\n    НедельныеПродажи КАК НедельныеПродажи\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ НедельныеПродажи КАК ПродажиВОкнеНедель\r\n        ПО (НедельныеПродажи.План)\r\n            И НедельныеПродажи.Номенклатура = ПродажиВОкнеНедель.Номенклатура\r\n            И (ПродажиВОкнеНедель.Период МЕЖДУ ДОБАВИТЬКДАТЕ(НедельныеПродажи.Период, НЕДЕЛЯ, -&Окно) И НедельныеПродажи.Период)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    НедельныеПродажи.Период,\r\n    НедельныеПродажи.Номенклатура\r\n;\r\nВЫБРАТЬ\r\n    Периоды.Период,\r\n    ТоварыНаСкладахОстатки.Номенклатура,\r\n    ТоварыНаСкладахОстатки.КоличествоОстаток - СУММА(Расходы.Расход) КАК ПлановыйОстаток\r\nИЗ\r\n    РегистрНакопления.ТоварыНаСкладах.Остатки(НАЧАЛОПЕРИОДА(&Дата1, НЕДЕЛЯ), ) КАК ТоварыНаСкладахОстатки\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ СреднеНедельныеПродажи КАК Периоды\r\n        ПО ТоварыНаСкладахОстатки.Номенклатура = Периоды.Номенклатура\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ СреднеНедельныеПродажи КАК Расходы\r\n        ПО (Периоды.Номенклатура = Расходы.Номенклатура)\r\n            И (Расходы.Период <= Периоды.Период)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Периоды.Период,\r\n    ТоварыНаСкладахОстатки.Номенклатура,\r\n    ТоварыНаСкладахОстатки.КоличествоОстаток\n\nВЫБРАТЬ\r\n    ФактическиеПродажи.Период,\r\n    ФактическиеПродажи.Номенклатура,\r\n    ФактическиеПродажи.КоличествоОборот КАК Количество,\r\n    ЛОЖЬ КАК План\r\nПОМЕСТИТЬ НедельныеПродажи\r\nИЗ\r\n    РегистрНакопления.Продажи.Обороты(НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&Дата1, НЕДЕЛЯ, -&Окно), НЕДЕЛЯ), КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&Дата1, НЕДЕЛЯ, -1), НЕДЕЛЯ), Неделя, ) КАК ФактическиеПродажи\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ\r\n    ПланируемыеПродажи.Период,\r\n    ПланируемыеПродажи.Номенклатура,\r\n    ПланируемыеПродажи.КоличествоОборот,\r\n    ИСТИНА\r\nИЗ\r\n    РегистрНакопления.ПланыПродаж.Обороты(НАЧАЛОПЕРИОДА(&Дата1, НЕДЕЛЯ), &Дата2, Неделя, ) КАК ПланируемыеПродажи\r\n;\r\nВЫБРАТЬ\r\n    НедельныеПродажи.Период,\r\n    НедельныеПродажи.Номенклатура,\r\n    СРЕДНЕЕ(ПродажиВОкнеНедель.Количество) КАК Расход\r\nПОМЕСТИТЬ СреднеНедельныеПродажи\r\nИЗ\r\n    НедельныеПродажи КАК НедельныеПродажи\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ НедельныеПродажи КАК ПродажиВОкнеНедель\r\n        ПО (НедельныеПродажи.План)\r\n            И НедельныеПродажи.Номенклатура = ПродажиВОкнеНедель.Номенклатура\r\n            И (ПродажиВОкнеНедель.Период МЕЖДУ ДОБАВИТЬКДАТЕ(НедельныеПродажи.Период, НЕДЕЛЯ, -&Окно) И НедельныеПродажи.Период)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    НедельныеПродажи.Период,\r\n    НедельныеПродажи.Номенклатура\r\n;\r\nВЫБРАТЬ\r\n    Периоды.Период,\r\n    ТоварыНаСкладахОстатки.Номенклатура,\r\n    ТоварыНаСкладахОстатки.КоличествоОстаток - СУММА(Расходы.Расход) КАК ПлановыйОстаток\r\nИЗ\r\n    РегистрНакопления.ТоварыНаСкладах.Остатки(НАЧАЛОПЕРИОДА(&Дата1, НЕДЕЛЯ), ) КАК ТоварыНаСкладахОстатки\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ СреднеНедельныеПродажи КАК Периоды\r\n        ПО ТоварыНаСкладахОстатки.Номенклатура = Периоды.Номенклатура\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ СреднеНедельныеПродажи КАК Расходы\r\n        ПО (Периоды.Номенклатура = Расходы.Номенклатура)\r\n            И (Расходы.Период <= Периоды.Период)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Периоды.Период,\r\n    ТоварыНаСкладахОстатки.Номенклатура,\r\n    ТоварыНаСкладахОстатки.КоличествоОстаток\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Сравнение плановых и фактических дней отпуска",
    "description": "Сравнение плановых и фактических дней отпуска",
    "code_snippet": "ВЫБРАТЬ\r\n    План.Сотрудник,\r\n    План.Начало,\r\n    Календарь.ДатаКалендаря КАК День\r\nПОМЕСТИТЬ ПланДни\r\nИЗ\r\n    План КАК План\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК Календарь\r\n        ПО (Календарь.ДатаКалендаря МЕЖДУ План.Начало И План.Окончание)\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ\r\n    Факт.Сотрудник,\r\n    Факт.Начало,\r\n    Календарь.ДатаКалендаря КАК День\r\nПОМЕСТИТЬ ФактДни\r\nИЗ\r\n    Факт КАК Факт\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК Календарь\r\n        ПО (Календарь.ДатаКалендаря МЕЖДУ Факт.Начало И Факт.Окончание)\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ\r\n    План.Сотрудник,\r\n    План.Начало,\r\n    План.День,\r\n    КОЛИЧЕСТВО(Прошлое.День) КАК НомерДня\r\nПОМЕСТИТЬ ПланПлюс\r\nИЗ\r\n    ПланДни КАК План\r\n        ЛЕВОЕ СОЕДИНЕНИЕ ПланДни КАК Прошлое\r\n        ПО План.Сотрудник = Прошлое.Сотрудник\r\n            И План.День >= Прошлое.День\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    План.Сотрудник,\r\n    План.Начало,\r\n    План.День\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ\r\n    Факт.Сотрудник,\r\n    Факт.Начало,\r\n    Факт.День,\r\n    КОЛИЧЕСТВО(Прошлое.День) КАК НомерДня\r\nПОМЕСТИТЬ ФактПлюс\r\nИЗ\r\n    ФактДни КАК Факт\r\n        ЛЕВОЕ СОЕДИНЕНИЕ ФактДни КАК Прошлое\r\n        ПО Факт.Сотрудник = Прошлое.Сотрудник\r\n            И Факт.День >= Прошлое.День\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Факт.Сотрудник,\r\n    Факт.Начало,\r\n    Факт.День\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ\r\n    ПланПлюс.Сотрудник КАК СотрудникПлан,\r\n    МИНИМУМ(ПланПлюс.День) КАК НачалоПлан,\r\n    МАКСИМУМ(ПланПлюс.День) КАК ОкончаниеПлан,\r\n    ФактПлюс.Сотрудник КАК СотрудникФакт,\r\n    МИНИМУМ(ФактПлюс.День) КАК НачалоФакт,\r\n    МАКСИМУМ(ФактПлюс.День) КАК ОкончаниеФакт,\r\n    ЕСТЬNULL(КОЛИЧЕСТВО(ПланПлюс.День), КОЛИЧЕСТВО(ФактПлюс.День)) КАК Длина\r\nИЗ\r\n    ПланПлюс КАК ПланПлюс\r\n        ПОЛНОЕ СОЕДИНЕНИЕ ФактПлюс КАК ФактПлюс\r\n        ПО ПланПлюс.Сотрудник = ФактПлюс.Сотрудник\r\n            И ПланПлюс.НомерДня = ФактПлюс.НомерДня\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    ПланПлюс.Сотрудник,\r\n    ФактПлюс.Сотрудник,\r\n    ПланПлюс.Начало,\r\n    ФактПлюс.Начало\r\n\r\nУПОРЯДОЧИТЬ ПО\r\n    СотрудникПлан,\r\n    НачалоПлан,\r\n    НачалоФакт\n\nВЫБРАТЬ\r\n    План.Сотрудник,\r\n    План.Начало,\r\n    Календарь.ДатаКалендаря КАК День\r\nПОМЕСТИТЬ ПланДни\r\nИЗ\r\n    План КАК План\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК Календарь\r\n        ПО (Календарь.ДатаКалендаря МЕЖДУ План.Начало И План.Окончание)\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ\r\n    Факт.Сотрудник,\r\n    Факт.Начало,\r\n    Календарь.ДатаКалендаря КАК День\r\nПОМЕСТИТЬ ФактДни\r\nИЗ\r\n    Факт КАК Факт\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК Календарь\r\n        ПО (Календарь.ДатаКалендаря МЕЖДУ Факт.Начало И Факт.Окончание)\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ\r\n    План.Сотрудник,\r\n    План.Начало,\r\n    План.День,\r\n    КОЛИЧЕСТВО(Прошлое.День) КАК НомерДня\r\nПОМЕСТИТЬ ПланПлюс\r\nИЗ\r\n    ПланДни КАК План\r\n        ЛЕВОЕ СОЕДИНЕНИЕ ПланДни КАК Прошлое\r\n        ПО План.Сотрудник = Прошлое.Сотрудник\r\n            И План.День >= Прошлое.День\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    План.Сотрудник,\r\n    План.Начало,\r\n    План.День\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ\r\n    Факт.Сотрудник,\r\n    Факт.Начало,\r\n    Факт.День,\r\n    КОЛИЧЕСТВО(Прошлое.День) КАК НомерДня\r\nПОМЕСТИТЬ ФактПлюс\r\nИЗ\r\n    ФактДни КАК Факт\r\n        ЛЕВОЕ СОЕДИНЕНИЕ ФактДни КАК Прошлое\r\n        ПО Факт.Сотрудник = Прошлое.Сотрудник\r\n            И Факт.День >= Прошлое.День\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Факт.Сотрудник,\r\n    Факт.Начало,\r\n    Факт.День\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ\r\n    ПланПлюс.Сотрудник КАК СотрудникПлан,\r\n    МИНИМУМ(ПланПлюс.День) КАК НачалоПлан,\r\n    МАКСИМУМ(ПланПлюс.День) КАК ОкончаниеПлан,\r\n    ФактПлюс.Сотрудник КАК СотрудникФакт,\r\n    МИНИМУМ(ФактПлюс.День) КАК НачалоФакт,\r\n    МАКСИМУМ(ФактПлюс.День) КАК ОкончаниеФакт,\r\n    ЕСТЬNULL(КОЛИЧЕСТВО(ПланПлюс.День), КОЛИЧЕСТВО(ФактПлюс.День)) КАК Длина\r\nИЗ\r\n    ПланПлюс КАК ПланПлюс\r\n        ПОЛНОЕ СОЕДИНЕНИЕ ФактПлюс КАК ФактПлюс\r\n        ПО ПланПлюс.Сотрудник = ФактПлюс.Сотрудник\r\n            И ПланПлюс.НомерДня = ФактПлюс.НомерДня\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    ПланПлюс.Сотрудник,\r\n    ФактПлюс.Сотрудник,\r\n    ПланПлюс.Начало,\r\n    ФактПлюс.Начало\r\n\r\nУПОРЯДОЧИТЬ ПО\r\n    СотрудникПлан,\r\n    НачалоПлан,\r\n    НачалоФакт\n\n{2} Ожидается идентификатор\r\nОрфографическая ошибка в неотгулянные: неотгулянные"
  },
  {
    "title": "Получить дату по номеру дня недели и его порядковому номеру в месяце",
    "description": "Получить дату по номеру дня недели и его порядковому номеру в месяце",
    "code_snippet": "Функция ПолучитьДатуПоНомерамДняВНеделеИМесяце(НомерДняНеделиМесяца, НомерДняНедели, ДатаМесяца)\r\n    \r\n    Возврат НачалоМесяца(ДатаМесяца) \r\n+ 86400 * (7 * НомерДняНеделиМесяца - 7 + (НомерДняНедели - ДеньНедели(НачалоМесяца(ДатаМесяца)) + 7) % 7)\n\nФункция ПолучитьДатуПоНомерамДняВНеделеИМесяце(НомерДняНеделиМесяца, НомерДняНедели, ДатаМесяца)\r\n    \r\n    Возврат НачалоМесяца(ДатаМесяца) \r\n+ 86400 * (7 * НомерДняНеделиМесяца - 7 + (НомерДняНедели - ДеньНедели(НачалоМесяца(ДатаМесяца)) + 7) % 7)\n\n{4} Ожидается EndFunction"
  },
  {
    "title": "Получение предпоследнего курса валюты",
    "description": "Получение предпоследнего курса валюты",
    "code_snippet": "ВЫБРАТЬ ПЕРВЫЕ 1\r\n    ВЗ.Период КАК Период,\r\n    ВЗ.Курс КАК Курс\r\nИЗ\r\n    (ВЫБРАТЬ ПЕРВЫЕ 2\r\n        КурсыВалют.Период КАК Период,\r\n        КурсыВалют.Курс КАК Курс\r\n    ИЗ\r\n        РегистрСведений.КурсыВалют КАК КурсыВалют\r\n    ГДЕ\r\n        КурсыВалют.Валюта = &Валюта\r\n    УПОРЯДОЧИТЬ ПО\r\n        Период УБЫВ) КАК ВЗ\r\nУПОРЯДОЧИТЬ ПО\r\n    Период\n\nВЫБРАТЬ ПЕРВЫЕ 1\r\n    ВЗ.Период КАК Период,\r\n    ВЗ.Курс КАК Курс\r\nИЗ\r\n    (ВЫБРАТЬ ПЕРВЫЕ 2\r\n        КурсыВалют.Период КАК Период,\r\n        КурсыВалют.Курс КАК Курс\r\n    ИЗ\r\n        РегистрСведений.КурсыВалют КАК КурсыВалют\r\n    ГДЕ\r\n        КурсыВалют.Валюта = &Валюта\r\n    УПОРЯДОЧИТЬ ПО\r\n        Период УБЫВ) КАК ВЗ\r\nУПОРЯДОЧИТЬ ПО\r\n    Период\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Определить элементарные интервалы, образующиеся при пересечении всех исходных интервалов",
    "description": "Определить элементарные интервалы, образующиеся при пересечении всех исходных интервалов",
    "code_snippet": "ВЫБРАТЬ\n    0 КАК Момент\nПОМЕСТИТЬ ОсьВремени\n\nОБЪЕДИНИТЬ\n\nВЫБРАТЬ\n    График.От\nИЗ\n    ГрафикПоКалендарю КАК График\n\nОБЪЕДИНИТЬ\n\nВЫБРАТЬ\n    График.До\nИЗ\n    ГрафикПоКалендарю КАК График\n\nОБЪЕДИНИТЬ\n\nВЫБРАТЬ\n    Загрузка.От\nИЗ\n    Загрузка КАК Загрузка\n\nОБЪЕДИНИТЬ\n\nВЫБРАТЬ\n    Загрузка.До\nИЗ\n    Загрузка КАК Загрузка\n\nОБЪЕДИНИТЬ\n\nВЫБРАТЬ\n    24\n;\nВЫБРАТЬ\n    ОсьВремени.Момент КАК От,\n    МИНИМУМ(Позже.Момент) КАК До\nПОМЕСТИТЬ ВсеИнтервалы\nИЗ\n    ОсьВремени КАК ОсьВремени\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОсьВремени КАК Позже\n        ПО ОсьВремени.Момент < Позже.Момент\nСГРУППИРОВАТЬ ПО\n    ОсьВремени.Момент\n;\nВЫБРАТЬ\n    ВсеИнтервалы.От,\n    ВсеИнтервалы.До,\n    ЕСТЬNULL(ГрафикПоКалендарю.ТипВремени, \"нераб. время\") КАК ТипВремени,\n    ЕСТЬNULL(Загрузка.Работа, \"без работы\") КАК Работа\nИЗ\n    ВсеИнтервалы КАК ВсеИнтервалы\n        ЛЕВОЕ СОЕДИНЕНИЕ ГрафикПоКалендарю КАК ГрафикПоКалендарю\n        ПО (ГрафикПоКалендарю.От <= ВсеИнтервалы.От)\n            И ВсеИнтервалы.До <= ГрафикПоКалендарю.До\n        ЛЕВОЕ СОЕДИНЕНИЕ Загрузка КАК Загрузка\n        ПО (Загрузка.От <= ВсеИнтервалы.От)\n            И ВсеИнтервалы.До <= Загрузка.До\n\nОрфографическая ошибка в нераб: нераб"
  },
  {
    "title": "Найти количество повторяющихся подряд по дням записей",
    "description": "Найти количество повторяющихся подряд по дням записей",
    "code_snippet": "ВЫБРАТЬ\r\n    Дано.Дата,\r\n    МИНИМУМ(Дано.Явка) КАК Явка,\r\n    РАЗНОСТЬДАТ(ЕСТЬNULL(МАКСИМУМ(ВЫБОР\r\n                    КОГДА Раньше.Явка <> Дано.Явка\r\n                        ТОГДА Раньше.Дата\r\n                КОНЕЦ), ДОБАВИТЬКДАТЕ(МИНИМУМ(Раньше.Дата), ДЕНЬ, -1)), Дано.Дата, ДЕНЬ) КАК РазПодряд\r\nИЗ\r\n    Дано КАК Дано\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Дано КАК Раньше\r\n        ПО (Раньше.Дата <= Дано.Дата)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.Дата\r\nУПОРЯДОЧИТЬ ПО\r\n    Дано.Дата\n\nВЫБРАТЬ\r\n    Дано.Дата,\r\n    МИНИМУМ(Дано.Явка) КАК Явка,\r\n    РАЗНОСТЬДАТ(ЕСТЬNULL(МАКСИМУМ(ВЫБОР\r\n                    КОГДА Раньше.Явка <> Дано.Явка\r\n                        ТОГДА Раньше.Дата\r\n                КОНЕЦ), ДОБАВИТЬКДАТЕ(МИНИМУМ(Раньше.Дата), ДЕНЬ, -1)), Дано.Дата, ДЕНЬ) КАК РазПодряд\r\nИЗ\r\n    Дано КАК Дано\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Дано КАК Раньше\r\n        ПО (Раньше.Дата <= Дано.Дата)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.Дата\r\nУПОРЯДОЧИТЬ ПО\r\n    Дано.Дата\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Сравнение набора товаров, проданных сменами",
    "description": "Сравнение набора товаров, проданных сменами",
    "code_snippet": "ВЫБРАТЬ РАЗЛИЧНЫЕ\r\n    Дано.Смена,\r\n    ВЗ.Знак\r\nИЗ\r\n    Дано КАК Дано,\r\n    (ВЫБРАТЬ\r\n        МИНИМУМ(ВЫБОР\r\n                КОГДА Дано1.Смена ЕСТЬ NULL \r\n                        ИЛИ Дано2.Смена ЕСТЬ NULL \r\n                    ТОГДА \"<>\"\r\n                ИНАЧЕ \"=\"\r\n            КОНЕЦ) КАК Знак\r\n    ИЗ\r\n        Дано КАК Дано1\r\n            ПОЛНОЕ СОЕДИНЕНИЕ Дано КАК Дано2\r\n            ПО Дано1.Товар = Дано2.Товар\r\n                И Дано1.Смена <> Дано2.Смена) КАК ВЗ\n\nВЫБРАТЬ РАЗЛИЧНЫЕ\r\n    Дано.Смена,\r\n    ВЗ.Знак\r\nИЗ\r\n    Дано КАК Дано,\r\n    (ВЫБРАТЬ\r\n        МИНИМУМ(ВЫБОР\r\n                КОГДА Дано1.Смена ЕСТЬ NULL \r\n                        ИЛИ Дано2.Смена ЕСТЬ NULL \r\n                    ТОГДА \"<>\"\r\n                ИНАЧЕ \"=\"\r\n            КОНЕЦ) КАК Знак\r\n    ИЗ\r\n        Дано КАК Дано1\r\n            ПОЛНОЕ СОЕДИНЕНИЕ Дано КАК Дано2\r\n            ПО Дано1.Товар = Дано2.Товар\r\n                И Дано1.Смена <> Дано2.Смена) КАК ВЗ\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Найти документ, состав табличной части которого соответствует параметру - таблице значений",
    "description": "Найти документ, состав табличной части которого соответствует параметру - таблице значений",
    "code_snippet": "ВЫБРАТЬ\r\n    Товары.Номенклатура,\r\n    Товары.Количество\r\nПОМЕСТИТЬ Эталон\r\nИЗ\r\n    &Товары КАК Товары\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ РАЗЛИЧНЫЕ\r\n    Товары.Ссылка,\r\n    Товары.Номенклатура КАК Номенклатура,\r\n    Товары.Количество КАК Количество\r\nПОМЕСТИТЬ ВсеСтроки\r\nИЗ\r\n    Документ.ЗаказПокупателя.Товары КАК Товары\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ РАЗЛИЧНЫЕ\r\n    ЗаказПокупателя.Ссылка,\r\n    Эталон.Номенклатура,\r\n    Эталон.Количество\r\nИЗ\r\n    Эталон КАК Эталон,\r\n    Документ.ЗаказПокупателя КАК ЗаказПокупателя\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Пары.Ссылка\r\nИЗ\r\n    (ВЫБРАТЬ\r\n        Пары.Ссылка КАК Ссылка,\r\n        Пары.Номенклатура КАК Номенклатура,\r\n        Пары.Количество КАК Количество,\r\n        КОЛИЧЕСТВО(*) КАК Признак\r\n    ИЗ\r\n        ВсеСтроки КАК Пары\r\n    \r\n    СГРУППИРОВАТЬ ПО\r\n        Пары.Ссылка,\r\n        Пары.Номенклатура,\r\n        Пары.Количество) КАК Пары\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Пары.Ссылка\r\n\r\nИМЕЮЩИЕ\r\n    МИНИМУМ(Пары.Признак) = 2\n\nВЫБРАТЬ\r\n    Товары.Номенклатура,\r\n    Товары.Количество\r\nПОМЕСТИТЬ Эталон\r\nИЗ\r\n    &Товары КАК Товары\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ РАЗЛИЧНЫЕ\r\n    Товары.Ссылка,\r\n    Товары.Номенклатура КАК Номенклатура,\r\n    Товары.Количество КАК Количество\r\nПОМЕСТИТЬ ВсеСтроки\r\nИЗ\r\n    Документ.ЗаказПокупателя.Товары КАК Товары\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ РАЗЛИЧНЫЕ\r\n    ЗаказПокупателя.Ссылка,\r\n    Эталон.Номенклатура,\r\n    Эталон.Количество\r\nИЗ\r\n    Эталон КАК Эталон,\r\n    Документ.ЗаказПокупателя КАК ЗаказПокупателя\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Пары.Ссылка\r\nИЗ\r\n    (ВЫБРАТЬ\r\n        Пары.Ссылка КАК Ссылка,\r\n        Пары.Номенклатура КАК Номенклатура,\r\n        Пары.Количество КАК Количество,\r\n        КОЛИЧЕСТВО(*) КАК Признак\r\n    ИЗ\r\n        ВсеСтроки КАК Пары\r\n    \r\n    СГРУППИРОВАТЬ ПО\r\n        Пары.Ссылка,\r\n        Пары.Номенклатура,\r\n        Пары.Количество) КАК Пары\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Пары.Ссылка\r\n\r\nИМЕЮЩИЕ\r\n    МИНИМУМ(Пары.Признак) = 2\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Распределение товаров по ячейкам в запросе",
    "description": "Распределение товаров по ячейкам в запросе",
    "code_snippet": "ВЫБРАТЬ\r\n    Ячейки.Ячейка,\r\n    СУММА(Слева.Количество) - МИНИМУМ(Ячейки.Количество) КАК КоличествоОт,\r\n    СУММА(Слева.Количество) КАК КоличествоДо\r\nПОМЕСТИТЬ ЛинейкаЯчеек\r\nИЗ\r\n    Ячейки КАК Ячейки\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Ячейки КАК Слева\r\n        ПО (Слева.Ячейка <= Ячейки.Ячейка)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Ячейки.Ячейка\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Товары.Товар,\r\n    СУММА(Слева.Количество) - МИНИМУМ(Товары.Количество) КАК КоличествоОт,\r\n    СУММА(Слева.Количество) КАК КоличествоДо\r\nПОМЕСТИТЬ ЛинейкаТоваров\r\nИЗ\r\n    Товары КАК Товары\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Товары КАК Слева\r\n        ПО (Слева.Товар <= Товары.Товар)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Товары.Товар\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Ячейки.Ячейка КАК Ячейка,\r\n    Товары.Товар КАК Товар,\r\n    ВЫБОР\r\n        КОГДА Товары.КоличествоДо < Ячейки.КоличествоДо\r\n            ТОГДА Товары.КоличествоДо\r\n        ИНАЧЕ Ячейки.КоличествоДо\r\n    КОНЕЦ - ВЫБОР\r\n        КОГДА Товары.КоличествоОт > Ячейки.КоличествоОт\r\n            ТОГДА Товары.КоличествоОт\r\n        ИНАЧЕ Ячейки.КоличествоОт\r\n    КОНЕЦ КАК Количество\r\nИЗ\r\n    ЛинейкаЯчеек КАК Ячейки\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ЛинейкаТоваров КАК Товары\r\n        ПО Ячейки.КоличествоОт < Товары.КоличествоДо\r\n            И Ячейки.КоличествоДо > Товары.КоличествоОт\n\nВЫБРАТЬ\r\n    Ячейки.Ячейка,\r\n    СУММА(Слева.Количество) - МИНИМУМ(Ячейки.Количество) КАК КоличествоОт,\r\n    СУММА(Слева.Количество) КАК КоличествоДо\r\nПОМЕСТИТЬ ЛинейкаЯчеек\r\nИЗ\r\n    Ячейки КАК Ячейки\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Ячейки КАК Слева\r\n        ПО (Слева.Ячейка <= Ячейки.Ячейка)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Ячейки.Ячейка\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Товары.Товар,\r\n    СУММА(Слева.Количество) - МИНИМУМ(Товары.Количество) КАК КоличествоОт,\r\n    СУММА(Слева.Количество) КАК КоличествоДо\r\nПОМЕСТИТЬ ЛинейкаТоваров\r\nИЗ\r\n    Товары КАК Товары\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Товары КАК Слева\r\n        ПО (Слева.Товар <= Товары.Товар)\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Товары.Товар\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Ячейки.Ячейка КАК Ячейка,\r\n    Товары.Товар КАК Товар,\r\n    ВЫБОР\r\n        КОГДА Товары.КоличествоДо < Ячейки.КоличествоДо\r\n            ТОГДА Товары.КоличествоДо\r\n        ИНАЧЕ Ячейки.КоличествоДо\r\n    КОНЕЦ - ВЫБОР\r\n        КОГДА Товары.КоличествоОт > Ячейки.КоличествоОт\r\n            ТОГДА Товары.КоличествоОт\r\n        ИНАЧЕ Ячейки.КоличествоОт\r\n    КОНЕЦ КАК Количество\r\nИЗ\r\n    ЛинейкаЯчеек КАК Ячейки\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ЛинейкаТоваров КАК Товары\r\n        ПО Ячейки.КоличествоОт < Товары.КоличествоДо\r\n            И Ячейки.КоличествоДо > Товары.КоличествоОт\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Объединение пересекающихся периодов в запросе",
    "description": "Объединение пересекающихся периодов в запросе",
    "code_snippet": "ВЫБРАТЬ РАЗЛИЧНЫЕ\r\n    Край.От\r\nПОМЕСТИТЬ ЛевыеКрая\r\nИЗ\r\n    Интервалы КАК Край\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Интервалы КАК Интервалы\r\n        ПО (Интервалы.От < Край.От)\r\n            И Край.От <= Интервалы.До\r\nГДЕ\r\n    Интервалы.От ЕСТЬ NULL \r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ РАЗЛИЧНЫЕ\r\n    Край.До\r\nПОМЕСТИТЬ ПравыеКрая\r\nИЗ\r\n    Интервалы КАК Край\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Интервалы КАК Интервалы\r\n        ПО (Интервалы.От <= Край.До)\r\n            И Край.До < Интервалы.До\r\nГДЕ\r\n    Интервалы.От ЕСТЬ NULL \r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ\r\n    ЛевыеКрая.От,\r\n    МИНИМУМ(ПравыеКрая.До) КАК До\r\nИЗ\r\n    ЛевыеКрая КАК ЛевыеКрая\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПравыеКрая КАК ПравыеКрая\r\n        ПО ЛевыеКрая.От <= ПравыеКрая.До\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    ЛевыеКрая.От\n\nВЫБРАТЬ РАЗЛИЧНЫЕ\r\n    Край.От\r\nПОМЕСТИТЬ ЛевыеКрая\r\nИЗ\r\n    Интервалы КАК Край\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Интервалы КАК Интервалы\r\n        ПО (Интервалы.От < Край.От)\r\n            И Край.От <= Интервалы.До\r\nГДЕ\r\n    Интервалы.От ЕСТЬ NULL \r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ РАЗЛИЧНЫЕ\r\n    Край.До\r\nПОМЕСТИТЬ ПравыеКрая\r\nИЗ\r\n    Интервалы КАК Край\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Интервалы КАК Интервалы\r\n        ПО (Интервалы.От <= Край.До)\r\n            И Край.До < Интервалы.До\r\nГДЕ\r\n    Интервалы.От ЕСТЬ NULL \r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nВЫБРАТЬ\r\n    ЛевыеКрая.От,\r\n    МИНИМУМ(ПравыеКрая.До) КАК До\r\nИЗ\r\n    ЛевыеКрая КАК ЛевыеКрая\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПравыеКрая КАК ПравыеКрая\r\n        ПО ЛевыеКрая.От <= ПравыеКрая.До\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    ЛевыеКрая.От\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Выделение разрядов числа без использования округления и деления по модулю",
    "description": "Выделение разрядов числа без использования округления и деления по модулю",
    "code_snippet": "Функция Ф(Х, У)\r\n    Возврат ?(У < 2, 0 + (Х > 9999), Ф((Х - 10000 * (Х > 9999)) * 10, У - 1))\r\nКонецФункции\n\nФункция Ф(Х, У)\r\n    Возврат ?(У < 2, 0 + (Х > 9999), Ф((Х - 10000 * (Х > 9999)) * 10, У - 1))\r\nКонецФункции"
  },
  {
    "title": "Посчитать запросом суммарную длительность различных состояний",
    "description": "Посчитать запросом суммарную длительность различных состояний",
    "code_snippet": "ВЫБРАТЬ\r\n    &Дата1 КАК Период,\r\n    НаНачало.Скважина,\r\n    НаНачало.Состояние\r\nПОМЕСТИТЬ Дано\r\nИЗ\r\n    РегистрСведений.Резерв.СрезПоследних(&Дата1, ) КАК НаНачало\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ\r\n    Резерв.Период,\r\n    Резерв.Скважина,\r\n    Резерв.Состояние\r\nИЗ\r\n    РегистрСведений.Резерв КАК Резерв\r\nГДЕ\r\n    Резерв.Период МЕЖДУ &Дата1 И &Дата2\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ\r\n    &Дата2,\r\n    НаКонец.Скважина,\r\n    НаКонец.Состояние\r\nИЗ\r\n    РегистрСведений.Резерв.СрезПоследних(&Дата2, ) КАК НаКонец\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Раньше.Период,\r\n    Раньше.Скважина,\r\n    Раньше.Состояние,\r\n    РАЗНОСТЬДАТ(Раньше.Период, МИНИМУМ(Позже.Период), СЕКУНДА) КАК Длительность\r\nПОМЕСТИТЬ Интервалы\r\nИЗ\r\n    Дано КАК Раньше\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Дано КАК Позже\r\n        ПО Раньше.Скважина = Позже.Скважина\r\n            И Раньше.Период < Позже.Период\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Раньше.Период,\r\n    Раньше.Скважина,\r\n    Раньше.Состояние\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Интервалы.Скважина,\r\n    Интервалы.Состояние,\r\n    СУММА(Интервалы.Длительность) КАК Длительность\r\nИЗ\r\n    Интервалы КАК Интервалы\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Интервалы.Скважина,\r\n    Интервалы.Состояние\n\nВЫБРАТЬ\r\n    &Дата1 КАК Период,\r\n    НаНачало.Скважина,\r\n    НаНачало.Состояние\r\nПОМЕСТИТЬ Дано\r\nИЗ\r\n    РегистрСведений.Резерв.СрезПоследних(&Дата1, ) КАК НаНачало\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ\r\n    Резерв.Период,\r\n    Резерв.Скважина,\r\n    Резерв.Состояние\r\nИЗ\r\n    РегистрСведений.Резерв КАК Резерв\r\nГДЕ\r\n    Резерв.Период МЕЖДУ &Дата1 И &Дата2\r\n\r\nОБЪЕДИНИТЬ ВСЕ\r\n\r\nВЫБРАТЬ\r\n    &Дата2,\r\n    НаКонец.Скважина,\r\n    НаКонец.Состояние\r\nИЗ\r\n    РегистрСведений.Резерв.СрезПоследних(&Дата2, ) КАК НаКонец\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Раньше.Период,\r\n    Раньше.Скважина,\r\n    Раньше.Состояние,\r\n    РАЗНОСТЬДАТ(Раньше.Период, МИНИМУМ(Позже.Период), СЕКУНДА) КАК Длительность\r\nПОМЕСТИТЬ Интервалы\r\nИЗ\r\n    Дано КАК Раньше\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Дано КАК Позже\r\n        ПО Раньше.Скважина = Позже.Скважина\r\n            И Раньше.Период < Позже.Период\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Раньше.Период,\r\n    Раньше.Скважина,\r\n    Раньше.Состояние\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Интервалы.Скважина,\r\n    Интервалы.Состояние,\r\n    СУММА(Интервалы.Длительность) КАК Длительность\r\nИЗ\r\n    Интервалы КАК Интервалы\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Интервалы.Скважина,\r\n    Интервалы.Состояние\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Разбиение произвольного периода на интервалы в запросе",
    "description": "Разбиение произвольного периода на интервалы в запросе",
    "code_snippet": "ВЫБРАТЬ\r\n    0 КАК Х\r\nПОМЕСТИТЬ Бит\r\nОБЪЕДИНИТЬ\r\nВЫБРАТЬ\r\n    1\r\n;\r\nВЫБРАТЬ\r\n    Б0.Х + 2 * (Б1.Х + 2 * (Б2.Х + 2 * (Б3.Х + 2 * (Б4.Х + 2 * Б5.Х)))) КАК Х\r\nПОМЕСТИТЬ Периоды\r\nИЗ\r\n    Бит КАК Б0,\r\n    Бит КАК Б1,\r\n    Бит КАК Б2,\r\n    Бит КАК Б3,\r\n    Бит КАК Б4,\r\n    Бит КАК Б5\r\nГДЕ\r\n    Б0.Х + 2 * (Б1.Х + 2 * (Б2.Х + 2 * (Б3.Х + 2 * (Б4.Х + 2 * Б5.Х)))) < РАЗНОСТЬДАТ(&Дата1, &Дата2, МЕСЯЦ)\r\n;\r\nВЫБРАТЬ\r\n    ЕСТЬNULL(НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&Дата1, МЕСЯЦ, Начала.Х + 1), МЕСЯЦ), &Дата1) КАК ДатаНачала,\r\n    ЕСТЬNULL(КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&Дата1, МЕСЯЦ, Окончания.Х), МЕСЯЦ), &Дата2) КАК ДатаОкончания\r\nИЗ\r\n    Периоды КАК Начала\r\n        ПОЛНОЕ СОЕДИНЕНИЕ Периоды КАК Окончания\r\n        ПО (Начала.Х + 1 = Окончания.Х)\n\nВЫБРАТЬ\r\n    0 КАК Х\r\nПОМЕСТИТЬ Бит\r\nОБЪЕДИНИТЬ\r\nВЫБРАТЬ\r\n    1\r\n;\r\nВЫБРАТЬ\r\n    Б0.Х + 2 * (Б1.Х + 2 * (Б2.Х + 2 * (Б3.Х + 2 * (Б4.Х + 2 * Б5.Х)))) КАК Х\r\nПОМЕСТИТЬ Периоды\r\nИЗ\r\n    Бит КАК Б0,\r\n    Бит КАК Б1,\r\n    Бит КАК Б2,\r\n    Бит КАК Б3,\r\n    Бит КАК Б4,\r\n    Бит КАК Б5\r\nГДЕ\r\n    Б0.Х + 2 * (Б1.Х + 2 * (Б2.Х + 2 * (Б3.Х + 2 * (Б4.Х + 2 * Б5.Х)))) < РАЗНОСТЬДАТ(&Дата1, &Дата2, МЕСЯЦ)\r\n;\r\nВЫБРАТЬ\r\n    ЕСТЬNULL(НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&Дата1, МЕСЯЦ, Начала.Х + 1), МЕСЯЦ), &Дата1) КАК ДатаНачала,\r\n    ЕСТЬNULL(КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&Дата1, МЕСЯЦ, Окончания.Х), МЕСЯЦ), &Дата2) КАК ДатаОкончания\r\nИЗ\r\n    Периоды КАК Начала\r\n        ПОЛНОЕ СОЕДИНЕНИЕ Периоды КАК Окончания\r\n        ПО (Начала.Х + 1 = Окончания.Х)\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Поиск свободного штрихкода (EAN-13) внутри одного префикса",
    "description": "Поиск свободного штрихкода (EAN-13) внутри одного префикса",
    "code_snippet": "ВЫБРАТЬ 0 КАК Х ПОМЕСТИТЬ Р1 ОБЪЕДИНИТЬ ВЫБРАТЬ 1\r\n;\r\nВЫБРАТЬ А.Х + 2 * Б.Х КАК Х ПОМЕСТИТЬ Р2 ИЗ Р1 КАК А, Р1 КАК Б\r\n;\r\nВЫБРАТЬ А.Х + 4 * Б.Х КАК Х ПОМЕСТИТЬ Р4 ИЗ Р2 КАК А, Р2 КАК Б\r\n;\r\nВЫБРАТЬ ВЫРАЗИТЬ(ПОДСТРОКА(ШтрихКод, 1, А.Х - 1) КАК СТРОКА(12)) \r\n+ ПОДСТРОКА(\"123456789\", Б.Х + 1, 1) \r\n+ ПОДСТРОКА(\"000000000000\", А.Х + 1, 12) КАК ШтрихКод\r\nПОМЕСТИТЬ ДаноПлюс \r\nИЗ РегистрСведений_ШтрихкодыНоменклатуры, Р4 КАК А, Р4 КАК Б\r\nГДЕ ШтрихКод ПОДОБНО ПОДСТРОКА(\"%999999999999\", 1, 13 - А.Х) \r\nИ ШтрихКод НЕ ПОДОБНО ПОДСТРОКА(\"%999999999999\", 1, 14 - А.Х)\r\nИ Б.Х < 9 И ПОДСТРОКА(ШтрихКод, А.Х, 1) = ПОДСТРОКА(\"012345678\", Б.Х + 1, 1)\r\n;\r\nВЫБРАТЬ ШтрихКод\r\nИЗ ДаноПлюс\r\nГДЕ ШтрихКод НЕ В \r\n(ВЫБРАТЬ Дано.ШтрихКод ИЗ РегистрСведений_ШтрихкодыНоменклатуры КАК Дано)\n\nВЫБРАТЬ 0 КАК Х ПОМЕСТИТЬ Р1 ОБЪЕДИНИТЬ ВЫБРАТЬ 1\r\n;\r\nВЫБРАТЬ А.Х + 2 * Б.Х КАК Х ПОМЕСТИТЬ Р2 ИЗ Р1 КАК А, Р1 КАК Б\r\n;\r\nВЫБРАТЬ А.Х + 4 * Б.Х КАК Х ПОМЕСТИТЬ Р4 ИЗ Р2 КАК А, Р2 КАК Б\r\n;\r\nВЫБРАТЬ ВЫРАЗИТЬ(ПОДСТРОКА(ШтрихКод, 1, А.Х - 1) КАК СТРОКА(12)) \r\n+ ПОДСТРОКА(\"123456789\", Б.Х + 1, 1) \r\n+ ПОДСТРОКА(\"000000000000\", А.Х + 1, 12) КАК ШтрихКод\r\nПОМЕСТИТЬ ДаноПлюс \r\nИЗ РегистрСведений_ШтрихкодыНоменклатуры, Р4 КАК А, Р4 КАК Б\r\nГДЕ ШтрихКод ПОДОБНО ПОДСТРОКА(\"%999999999999\", 1, 13 - А.Х) \r\nИ ШтрихКод НЕ ПОДОБНО ПОДСТРОКА(\"%999999999999\", 1, 14 - А.Х)\r\nИ Б.Х < 9 И ПОДСТРОКА(ШтрихКод, А.Х, 1) = ПОДСТРОКА(\"012345678\", Б.Х + 1, 1)\r\n;\r\nВЫБРАТЬ ШтрихКод\r\nИЗ ДаноПлюс\r\nГДЕ ШтрихКод НЕ В \r\n(ВЫБРАТЬ Дано.ШтрихКод ИЗ РегистрСведений_ШтрихкодыНоменклатуры КАК Дано)\n\n{} Ожидается идентификатор\r\nОрфографическая ошибка в инкрементирования: инкрементирования\r\nОрфографическая ошибка в РегистрСведений_ШтрихкодыНоменклатуры (найдено 2): Штрихкоды"
  },
  {
    "title": "Выбор записи по номеру из НЕПРОНУМЕРОВАННОЙ таблицы",
    "description": "Выбор записи по номеру из НЕПРОНУМЕРОВАННОЙ таблицы",
    "code_snippet": "ВЫБРАТЬ\r\n    0 КАК Х\r\nПОМЕСТИТЬ Бит\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    1\r\n;\r\nВЫБРАТЬ\r\n    NULL КАК Х\r\nПОМЕСТИТЬ Сдвиг\r\nИЗ\r\n    Бит КАК Б0,\r\n    Бит КАК Б1,\r\n    Бит КАК Б2,\r\n    Бит КАК Б3,\r\n    Бит КАК Б4,\r\n    Бит КАК Б5,\r\n    Бит КАК Б6,\r\n    Бит КАК Б7\r\nГДЕ\r\n    Б0.Х + 2 * (Б1.Х + 2 * (Б2.Х + 2 * (Б3.Х + 2 * (Б4.Х + 2 * (Б5.Х + 2 * (Б6.Х + 2 * Б7.Х)))))) < 256 - &Номер\r\n;\r\nВЫБРАТЬ\r\n    Дано.Х КАК Х\r\nПОМЕСТИТЬ Дано\r\nИЗ \r\n&Дано КАК Дано\r\n;\r\nВЫБРАТЬ ПЕРВЫЕ 2\r\n    ВЗ.Х\r\nИЗ\r\n    (ВЫБРАТЬ ПЕРВЫЕ 256\r\n        ВЗ.Х\r\n    ИЗ\r\n        (ВЫБРАТЬ\r\n            Сдвиг.Х\r\n        ИЗ\r\n            Сдвиг КАК Сдвиг\r\n        \r\n        ОБЪЕДИНИТЬ ВСЕ\r\n        \r\n        ВЫБРАТЬ\r\n            Дано.Х\r\n        ИЗ\r\n            Дано КАК Дано) КАК ВЗ\r\n    \r\n    УПОРЯДОЧИТЬ ПО\r\n        Х) КАК ВЗ\r\n\r\nУПОРЯДОЧИТЬ ПО\r\n    Х УБЫВ\n\nВЫБРАТЬ\r\n    0 КАК Х\r\nПОМЕСТИТЬ Бит\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    1\r\n;\r\nВЫБРАТЬ\r\n    NULL КАК Х\r\nПОМЕСТИТЬ Сдвиг\r\nИЗ\r\n    Бит КАК Б0,\r\n    Бит КАК Б1,\r\n    Бит КАК Б2,\r\n    Бит КАК Б3,\r\n    Бит КАК Б4,\r\n    Бит КАК Б5,\r\n    Бит КАК Б6,\r\n    Бит КАК Б7\r\nГДЕ\r\n    Б0.Х + 2 * (Б1.Х + 2 * (Б2.Х + 2 * (Б3.Х + 2 * (Б4.Х + 2 * (Б5.Х + 2 * (Б6.Х + 2 * Б7.Х)))))) < 256 - &Номер\r\n;\r\nВЫБРАТЬ\r\n    Дано.Х КАК Х\r\nПОМЕСТИТЬ Дано\r\nИЗ \r\n&Дано КАК Дано\r\n;\r\nВЫБРАТЬ ПЕРВЫЕ 2\r\n    ВЗ.Х\r\nИЗ\r\n    (ВЫБРАТЬ ПЕРВЫЕ 256\r\n        ВЗ.Х\r\n    ИЗ\r\n        (ВЫБРАТЬ\r\n            Сдвиг.Х\r\n        ИЗ\r\n            Сдвиг КАК Сдвиг\r\n        \r\n        ОБЪЕДИНИТЬ ВСЕ\r\n        \r\n        ВЫБРАТЬ\r\n            Дано.Х\r\n        ИЗ\r\n            Дано КАК Дано) КАК ВЗ\r\n    \r\n    УПОРЯДОЧИТЬ ПО\r\n        Х) КАК ВЗ\r\n\r\nУПОРЯДОЧИТЬ ПО\r\n    Х УБЫВ\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Как в запросе секунды преобразовать в часы и минуты",
    "description": "Как в запросе секунды преобразовать в часы и минуты",
    "code_snippet": "РАЗНОСТЬДАТ(ДАТАВРЕМЯ(1, 1, 1), ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(1, 1, 1), СЕКУНДА, &ДлительностьВСекундах), ЧАС) \r\n    + МИНУТА(ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(1, 1, 1), СЕКУНДА, &ДлительностьВСекундах)) / 100\n\nРАЗНОСТЬДАТ(ДАТАВРЕМЯ(1, 1, 1), ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(1, 1, 1), СЕКУНДА, &ДлительностьВСекундах), ЧАС) \r\n    + МИНУТА(ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(1, 1, 1), СЕКУНДА, &ДлительностьВСекундах)) / 100"
  },
  {
    "title": "Перебор всех строковых комбинаций \"0\" и \"1\" в порядке возрастания числа единиц",
    "description": "Перебор всех строковых комбинаций \"0\" и \"1\" в порядке возрастания числа единиц",
    "code_snippet": "Функция СледующийКод(Код)\r\n    Возврат Прав(СтрЗаменить(Код, \"1\", \"0\") + Лев(\"1\" + Код, Найти(Код, \"0\")) \r\n    + ?(Найти(Код, \"01\"), \"0\", \"\") + Сред(Код, Найти(Код + \"01\", \"01\") + 2), СтрДлина(Код))\r\nКонецФункции\n\nФункция СледующийКод(Код)\r\n    Возврат Прав(СтрЗаменить(Код, \"1\", \"0\") + Лев(\"1\" + Код, Найти(Код, \"0\")) \r\n    + ?(Найти(Код, \"01\"), \"0\", \"\") + Сред(Код, Найти(Код + \"01\", \"01\") + 2), СтрДлина(Код))\r\nКонецФункции"
  },
  {
    "title": "Транслитерация в запросе",
    "description": "Транслитерация в запросе",
    "code_snippet": "ВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    Дано.Наименование\r\nПОМЕСТИТЬ ДаноКириллица\r\nИЗ\r\n    &ДаноКириллица КАК Дано\r\n;\r\nВЫБРАТЬ\r\n    \"\" \"\" КАК Буква,\r\n    &СимволНПП КАК Замена\r\nПОМЕСТИТЬ ГОСТ79_2000\r\n\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"а\"\", \"\"a\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"б\"\", \"\"b\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"в\"\", \"\"v\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"г\"\", \"\"g\"\" \r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"д\"\", \"\"d\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"е\"\", \"\"e\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ё\"\", \"\"yo\"\"ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ж\"\", \"\"zh\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"з\"\", \"\"z\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"и\"\", \"\"i\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"й\"\", \"\"j\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"к\"\", \"\"k\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"л\"\", \"\"l\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"м\"\", \"\"m\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"н\"\", \"\"n\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"о\"\", \"\"o\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"п\"\", \"\"p\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"р\"\", \"\"r\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"с\"\", \"\"s\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"т\"\", \"\"t\"\" \r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"у\"\", \"\"u\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ф\"\", \"\"f\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"х\"\", \"\"x\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ц\"\", \"\"cz\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ч\"\", \"\"ch\"\"ОБЪЕДИНИТЬ ВЫБРАТЬ    \"\"ш\"\", \"\"sh\"\"ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"щ\"\",\"\"shh\"\"ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ъ\"\", \"\"\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ы\"\",\"\"y\"\"  ОБЪЕДИНИТЬ ВЫБРАТЬ    \"\"ь\"\", \"\"\"\"  ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"э\"\", \"\"e\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ю\"\", \"\"yu\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"я\"\",\"\"ya\"\"\r\n\r\nИНДЕКСИРОВАТЬ ПО\r\n    Буква\r\n;\r\nВЫБРАТЬ\r\n    0 КАК Х\r\nПОМЕСТИТЬ ЦИФРЫ\r\n\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 1 ОБЪЕДИНИТЬ ВЫБРАТЬ 2 ОБЪЕДИНИТЬ ВЫБРАТЬ 3 ОБЪЕДИНИТЬ ВЫБРАТЬ 4 ОБЪЕДИНИТЬ ВЫБРАТЬ 5\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 6 ОБЪЕДИНИТЬ ВЫБРАТЬ 7 ОБЪЕДИНИТЬ ВЫБРАТЬ 8 ОБЪЕДИНИТЬ ВЫБРАТЬ 9\r\n;\r\nВЫБРАТЬ\r\n    А.Х * 10 + Б.Х + 1 КАК Х\r\nПОМЕСТИТЬ Числа\r\nИЗ\r\n    ЦИФРЫ КАК А,\r\n    ЦИФРЫ КАК Б\r\n;\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки КАК ж,\r\n    Числа.Х КАК ё,\r\n    ЕСТЬNULL(ГОСТ.Замена, ПОДСТРОКА(Дано.Наименование, Числа.Х, 1)) КАК а\r\nПОМЕСТИТЬ Таб\r\nИЗ\r\n    ДаноКириллица КАК Дано\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Числа КАК Числа\r\n        ПО (ПОДСТРОКА(Дано.Наименование, Числа.Х, 1) + \"\"!\"\" <> \"\"!\"\")\r\n        ЛЕВОЕ СОЕДИНЕНИЕ ГОСТ79_2000 КАК ГОСТ\r\n        ПО (ПОДСТРОКА(Дано.Наименование, Числа.Х, 1) = ГОСТ.Буква)\r\n;\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    Дано.Наименование КАК Наименование\r\nПОМЕСТИТЬ ДаноЛатинница\r\nИЗ\r\n    &ДаноЛатинница КАК Дано\r\n\r\nИНДЕКСИРОВАТЬ ПО\r\n    Наименование\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Таб.ж КАК НомерСтроки,\r\n   ДаноКириллица.Наименование КАК Кириллица,\r\n    Таб.а КАК Латинница,\r\n   ДаноЛатинница.НомерСтроки КАК КлючСвязи\r\nИЗ\r\n    Таб КАК Таб \r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДаноКириллица КАК ДаноКириллица \r\n        ПО Таб.ж = ДаноКириллица.НомерСтроки\r\n        ЛЕВОЕ СОЕДИНЕНИЕ ДаноЛатинница КАК ДаноЛатинница \r\n        ПО Таб.а = ДаноЛатинница.Наименование\r\n\r\nУПОРЯДОЧИТЬ ПО\r\n    Таб.ж\n\nВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    Дано.Наименование\r\nПОМЕСТИТЬ ДаноКириллица\r\nИЗ\r\n    &ДаноКириллица КАК Дано\r\n;\r\nВЫБРАТЬ\r\n    \"\" \"\" КАК Буква,\r\n    &СимволНПП КАК Замена\r\nПОМЕСТИТЬ ГОСТ79_2000\r\n\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"а\"\", \"\"a\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"б\"\", \"\"b\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"в\"\", \"\"v\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"г\"\", \"\"g\"\" \r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"д\"\", \"\"d\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"е\"\", \"\"e\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ё\"\", \"\"yo\"\"ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ж\"\", \"\"zh\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"з\"\", \"\"z\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"и\"\", \"\"i\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"й\"\", \"\"j\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"к\"\", \"\"k\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"л\"\", \"\"l\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"м\"\", \"\"m\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"н\"\", \"\"n\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"о\"\", \"\"o\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"п\"\", \"\"p\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"р\"\", \"\"r\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"с\"\", \"\"s\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"т\"\", \"\"t\"\" \r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"у\"\", \"\"u\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ф\"\", \"\"f\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"х\"\", \"\"x\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ц\"\", \"\"cz\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ч\"\", \"\"ch\"\"ОБЪЕДИНИТЬ ВЫБРАТЬ    \"\"ш\"\", \"\"sh\"\"ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"щ\"\",\"\"shh\"\"ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ъ\"\", \"\"\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ы\"\",\"\"y\"\"  ОБЪЕДИНИТЬ ВЫБРАТЬ    \"\"ь\"\", \"\"\"\"  ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"э\"\", \"\"e\"\" ОБЪЕДИНИТЬ ВЫБРАТЬ \"\"ю\"\", \"\"yu\"\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ \"\"я\"\",\"\"ya\"\"\r\n\r\nИНДЕКСИРОВАТЬ ПО\r\n    Буква\r\n;\r\nВЫБРАТЬ\r\n    0 КАК Х\r\nПОМЕСТИТЬ ЦИФРЫ\r\n\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 1 ОБЪЕДИНИТЬ ВЫБРАТЬ 2 ОБЪЕДИНИТЬ ВЫБРАТЬ 3 ОБЪЕДИНИТЬ ВЫБРАТЬ 4 ОБЪЕДИНИТЬ ВЫБРАТЬ 5\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 6 ОБЪЕДИНИТЬ ВЫБРАТЬ 7 ОБЪЕДИНИТЬ ВЫБРАТЬ 8 ОБЪЕДИНИТЬ ВЫБРАТЬ 9\r\n;\r\nВЫБРАТЬ\r\n    А.Х * 10 + Б.Х + 1 КАК Х\r\nПОМЕСТИТЬ Числа\r\nИЗ\r\n    ЦИФРЫ КАК А,\r\n    ЦИФРЫ КАК Б\r\n;\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки КАК ж,\r\n    Числа.Х КАК ё,\r\n    ЕСТЬNULL(ГОСТ.Замена, ПОДСТРОКА(Дано.Наименование, Числа.Х, 1)) КАК а\r\nПОМЕСТИТЬ Таб\r\nИЗ\r\n    ДаноКириллица КАК Дано\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Числа КАК Числа\r\n        ПО (ПОДСТРОКА(Дано.Наименование, Числа.Х, 1) + \"\"!\"\" <> \"\"!\"\")\r\n        ЛЕВОЕ СОЕДИНЕНИЕ ГОСТ79_2000 КАК ГОСТ\r\n        ПО (ПОДСТРОКА(Дано.Наименование, Числа.Х, 1) = ГОСТ.Буква)\r\n;\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ ж, ВЫРАЗИТЬ(ё / 2 КАК ЧИСЛО(15, 0)) е, ё, а ПОМЕСТИТЬ Шаг ИЗ Таб КАК Таб; УНИЧТОЖИТЬ Таб;\r\nВЫБРАТЬ ж, е ё, МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА а ИНАЧЕ \"\"\"\" КОНЕЦ) + МАКСИМУМ(ВЫБОР е * 2 - ё КОГДА 1 ТОГДА \"\"\"\"ИНАЧЕ Шаг.а КОНЕЦ) а\r\nПОМЕСТИТЬ Таб ИЗ Шаг СГРУППИРОВАТЬ ПО ж, е; УНИЧТОЖИТЬ Шаг;\r\n\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    Дано.Наименование КАК Наименование\r\nПОМЕСТИТЬ ДаноЛатинница\r\nИЗ\r\n    &ДаноЛатинница КАК Дано\r\n\r\nИНДЕКСИРОВАТЬ ПО\r\n    Наименование\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Таб.ж КАК НомерСтроки,\r\n   ДаноКириллица.Наименование КАК Кириллица,\r\n    Таб.а КАК Латинница,\r\n   ДаноЛатинница.НомерСтроки КАК КлючСвязи\r\nИЗ\r\n    Таб КАК Таб \r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДаноКириллица КАК ДаноКириллица \r\n        ПО Таб.ж = ДаноКириллица.НомерСтроки\r\n        ЛЕВОЕ СОЕДИНЕНИЕ ДаноЛатинница КАК ДаноЛатинница \r\n        ПО Таб.а = ДаноЛатинница.Наименование\r\n\r\nУПОРЯДОЧИТЬ ПО\r\n    Таб.ж\n\nПропущен символ '\"' (двойная кавычка)\r\nОрфографическая ошибка в транслитируется: транслитируется\r\nОрфографическая ошибка в латинницей: латинницей\r\nОрфографическая ошибка в ДаноЛатинница (найдено 6): Латинница\r\nОрфографическая ошибка в Латинница: Латинница"
  },
  {
    "title": "Заполнение пропусков в таблице цветов",
    "description": "Заполнение пропусков в таблице цветов",
    "code_snippet": "ВЫБРАТЬ\r\n    Дано.Номер,\r\n    ЕСТЬNULL(Выше.Цвет, Дано.Цвет)\r\nИЗ\r\n    Дано КАК Дано\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Дано КАК Выше\r\n        ПО (Дано.Цвет ЕСТЬ NULL )\r\n            И (Выше.Номер В\r\n                (ВЫБРАТЬ\r\n                    МАКСИМУМ(Было.Номер) КАК Номер\r\n                ИЗ\r\n                    Дано КАК Было\r\n                ГДЕ\r\n                    Было.Номер < Дано.Номер\r\n                    И НЕ Было.Цвет ЕСТЬ NULL ))\n\nВЫБРАТЬ\r\n    Дано.Номер,\r\n    ЕСТЬNULL(Выше.Цвет, Дано.Цвет)\r\nИЗ\r\n    Дано КАК Дано\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Дано КАК Выше\r\n        ПО (Дано.Цвет ЕСТЬ NULL )\r\n            И (Выше.Номер В\r\n                (ВЫБРАТЬ\r\n                    МАКСИМУМ(Было.Номер) КАК Номер\r\n                ИЗ\r\n                    Дано КАК Было\r\n                ГДЕ\r\n                    Было.Номер < Дано.Номер\r\n                    И НЕ Было.Цвет ЕСТЬ NULL ))\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Количество дней недели (понедельников/вторников/...) в заданном диапазоне одним запросом",
    "description": "Количество дней недели (понедельников/вторников/...) в заданном диапазоне одним запросом",
    "code_snippet": "ВЫБРАТЬ\r\n   Дни.ДеньНедели,\r\n   РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&НачалоПериода, ДЕНЬ, -Дни.ДеньНедели), НЕДЕЛЯ)\r\n, НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&КонецПериода, ДЕНЬ, 1 - Дни.ДеньНедели), НЕДЕЛЯ), ДЕНЬ) / 7 КАК КоличествоДней\r\nИЗ\r\n   (ВЫБРАТЬ 1 КАК ДеньНедели ОБЪЕДИНИТЬ ВЫБРАТЬ 2 ОБЪЕДИНИТЬ ВЫБРАТЬ 3 ОБЪЕДИНИТЬ ВЫБРАТЬ 4 ОБЪЕДИНИТЬ ВЫБРАТЬ 5\r\n   ОБЪЕДИНИТЬ ВЫБРАТЬ 6 ОБЪЕДИНИТЬ ВЫБРАТЬ 7) КАК Дни\n\nВЫБРАТЬ\r\n   Дни.ДеньНедели,\r\n   РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&НачалоПериода, ДЕНЬ, -Дни.ДеньНедели), НЕДЕЛЯ)\r\n, НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&КонецПериода, ДЕНЬ, 1 - Дни.ДеньНедели), НЕДЕЛЯ), ДЕНЬ) / 7 КАК КоличествоДней\r\nИЗ\r\n   (ВЫБРАТЬ 1 КАК ДеньНедели ОБЪЕДИНИТЬ ВЫБРАТЬ 2 ОБЪЕДИНИТЬ ВЫБРАТЬ 3 ОБЪЕДИНИТЬ ВЫБРАТЬ 4 ОБЪЕДИНИТЬ ВЫБРАТЬ 5\r\n   ОБЪЕДИНИТЬ ВЫБРАТЬ 6 ОБЪЕДИНИТЬ ВЫБРАТЬ 7) КАК Дни\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Свернуть строки в таблице значений конкатенацией",
    "description": "Свернуть строки в таблице значений конкатенацией",
    "code_snippet": "Дано.Сортировать(\"Поле1, Поле2\");\r\nё = Дано.Количество();\r\nПока ё > 1 Цикл\r\n   ё = ё - 1;\r\n    Если Дано[ё - 1].Поле1 = Дано[ё].Поле1 И Дано[ё - 1].Поле2 = Дано[ё].Поле2 Тогда\r\n        Дано[ё - 1].Поле3 = Дано[ё - 1].Поле3 + Дано[ё].Поле3;\r\n        Дано.Удалить(ё)\r\n    КонецЕсли \r\nКонецЦикла;\n\nДано.Сортировать(\"Поле1, Поле2\");\r\nё = Дано.Количество();\r\nПока ё > 1 Цикл\r\n   ё = ё - 1;\r\n    Если Дано[ё - 1].Поле1 = Дано[ё].Поле1 И Дано[ё - 1].Поле2 = Дано[ё].Поле2 Тогда\r\n        Дано[ё - 1].Поле3 = Дано[ё - 1].Поле3 + Дано[ё].Поле3;\r\n        Дано.Удалить(ё)\r\n    КонецЕсли \r\nКонецЦикла;"
  },
  {
    "title": "Генератор вариантов формул",
    "description": "Генератор вариантов формул",
    "code_snippet": "Функция СписокФормул(От, До)\n    Перем Результат, Сч, Оп; // для безопасности\n    Результат = Новый СписокЗначений;\n    Если От >= До Тогда\n        Результат.Добавить(\"X\" + От);\n        Результат.Добавить(\"( - X\" + От + \")\")\n    Иначе \n        Для Сч = От По До - 1 Цикл\n            ПравыеЧасти = СписокФормул(Сч + 1, До); // для скорости\n            Для каждого Слева Из СписокФормул(От, Сч) Цикл\n                Для каждого Справа Из ПравыеЧасти Цикл\n                    Для Оп = 1 По 3 Цикл\n                        Результат.Добавить(\"(\" + Слева + \" \" + Сред(\"+*/\", Оп, 1) + \" \" + Справа + \")\")\n                    КонецЦикла \n                КонецЦикла\n            КонецЦикла     \n        КонецЦикла \n    КонецЕсли;\n    Возврат Результат\nКонецФункции // СписокФормул()\n\nОрфографическая ошибка в конкатенируясь: конкатенируясь"
  },
  {
    "title": "Алгоритм перебора всех возможных сочетаний элементов",
    "description": "Алгоритм перебора всех возможных сочетаний элементов",
    "code_snippet": "Функция ВсеПодмножества(Множество) \r\n    Ответ = Новый Массив;\r\n    Ответ.Добавить(Новый СписокЗначений);\r\n    Для ИндексЭлемента = 0 По Множество.Количество() - 1 Цикл\r\n        Для ИндексВарианта = 0 По Ответ.Количество() - 1 Цикл\r\n            Ответ.Добавить(Ответ[ИндексВарианта].Скопировать());\r\n            Ответ[ИндексВарианта].Добавить(Множество[ИндексЭлемента])\r\n        КонецЦикла\r\n    КонецЦикла;\r\n    Возврат Ответ\r\nКонецФункции\n\nФункция ВсеПодмножества(Множество) \r\n    Ответ = Новый Массив;\r\n    Ответ.Добавить(Новый СписокЗначений);\r\n    Для ИндексЭлемента = 0 По Множество.Количество() - 1 Цикл\r\n        Для ИндексВарианта = 0 По Ответ.Количество() - 1 Цикл\r\n            Ответ.Добавить(Ответ[ИндексВарианта].Скопировать());\r\n            Ответ[ИндексВарианта].Добавить(Множество[ИндексЭлемента])\r\n        КонецЦикла\r\n    КонецЦикла;\r\n    Возврат Ответ\r\nКонецФункции"
  },
  {
    "title": "Выбрать в запросе одну запись из нескольких",
    "description": "Выбрать в запросе одну запись из нескольких",
    "code_snippet": "ВЫБРАТЬ РАЗЛИЧНЫЕ Ф, К1, К2, К3, К4\nИЗ Дано\nГДЕ (Ф, К1, К2, К3, К4) \nВ (ВЫБРАТЬ ПЕРВЫЕ 1 * ИЗ Дано КАК ВСЁ ГДЕ ВСЁ.Ф = Дано.Ф)"
  },
  {
    "title": "Как свернуть таблицу значений в коде, но получить не сумму, а максимум",
    "description": "Как свернуть таблицу значений в коде, но получить не сумму, а максимум",
    "code_snippet": "Дано.Сортировать(\"Поле1, Поле2\");\n\nДля ё = 1 По Дано.Количество() - 1 Цикл\n    Если Дано[ё].Поле1 = Дано[ё - 1].Поле1 И Дано[ё].Поле2 = Дано[ё - 1].Поле2 Тогда\n        Дано[ё].Поле3 = МИН(Дано[ё].Поле3, Дано[ё - 1].Поле3); // = МАКС(Дано[ё].Поле3, Дано[ё - 1].Поле3);\n        Дано[ё - 1].Поле3 = 0\n    КонецЕсли \nКонецЦикла;\n\nДано.Свернуть(\"Поле1, Поле2\", \"Поле3\");\n\nДано.Сортировать(\"Поле1, Поле2, Поле3 Убыв\"); //для МАКС, Дано.Сортировать(\"Поле1, Поле2, Поле3\"); //для МИН\nДля ё = 1 По Дано.Количество() - 1 Цикл\n    Если Дано[ё].Поле1 = Дано[ё - 1].Поле1 И Дано[ё].Поле2 = Дано[ё - 1].Поле2 Тогда\n        Дано[ё].Поле3 = 0\n    КонецЕсли \nКонецЦикла;\nДано.Свернуть(\"Поле1, Поле2\", \"Поле3\");\n\nДано.Сортировать(ИменаПолейГруппировки);\n\nДля ё = 1 По Дано.Количество() - 1 Цикл\n    Повтор = Истина;\n    Для каждого Элемент Из Новый Структура(ИменаПолейГруппировки) Цикл\n        Повтор = Повтор И (Дано[ё][Элемент.Ключ] = Дано[ё - 1][Элемент.Ключ])  \n    КонецЦикла; \n    Если Повтор Тогда \n        Дано[ё][Ресурс] = МИН(Дано[ё][Ресурс], Дано[ё - 1][Ресурс]);\n        Дано[ё - 1][Ресурс] = 0\n    КонецЕсли \nКонецЦикла;\n\nДано.Свернуть(ИменаПолейГруппировки, Ресурс);\n\nСток = Новый Соответствие;\n\nДля каждого Строка Из Дано Цикл \n    Ключ = Строка[ПолеГруппировки];\n    Если Сток[Ключ] = Неопределено Тогда \n        Сток[Ключ] = Строка\n    Иначе \n        Сток[Ключ][Ресурс] = МИН(Сток[Ключ][Ресурс], Строка[Ресурс]);\n        Строка[Ресурс] = 0\n    КонецЕсли \nКонецЦикла;\n\nДано.Свернуть(ПолеГруппировки, Ресурс);"
  },
  {
    "title": "Поиск кратчайших путей по алгоритму Флойда-Уоршолла",
    "description": "Поиск кратчайших путей по алгоритму Флойда-Уоршолла",
    "code_snippet": "Функция КратчайшийПутьФлойд(Откуда, Куда, Дуги) Экспорт\r\n    // загрузка графа в \"соответствие соответствий\" так, что Пути[Откуда][Куда] = Длина\r\n    Пути = Новый Соответствие;\r\n    Для каждого Дуга Из Дуги Цикл\r\n        Пути[Дуга.Откуда] = ?(Пути[Дуга.Откуда] = Неопределено, Новый Соответствие, Пути[Дуга.Откуда]);\r\n        Пути[Дуга.Откуда][Дуга.Куда] = Дуга.Длина\r\n    КонецЦикла;\r\n    // три вложенных цикла по узлам графа\r\n    Для каждого Узел1 Из Пути Цикл // тогда Узел.Ключ - это одна вершина из полного множества вершин  \r\n        Для каждого Узел2 Из Пути Цикл \r\n            Если Пути[Узел2.Ключ][Узел1.Ключ] <> Неопределено Тогда\r\n                Для каждого Узел3 Из Узел1.Значение Цикл // здесь только вершины, связанные с Узел1.Ключ \r\n                    Длина = Пути[Узел2.Ключ][Узел3.Ключ];\r\n                    Обход = Пути[Узел2.Ключ][Узел1.Ключ] + Узел3.Значение; // Узел3.Значение == Пути[Узел1.Ключ][Узел3.Ключ]\r\n                    Пути[Узел2.Ключ][Узел3.Ключ] = ?(Длина = Неопределено, Обход, Мин(Длина, Обход))\r\n                КонецЦикла \r\n            КонецЕсли \r\n        КонецЦикла \r\n    КонецЦикла;\r\n    // восстановление пути\r\n    Путь = Дуги.СкопироватьКолонки(\"Куда, Длина\");\r\n    Путь.Добавить().Куда = Откуда;\r\n    Путь.Добавить().Куда = Куда;\r\n    Путь[1].Длина = Пути[Откуда][Куда];\r\n    Для каждого Узел Из Пути Цикл \r\n        Если Пути[Откуда][Узел.Ключ] <> Неопределено И Пути[Узел.Ключ][Куда] <> Неопределено \r\n            И Пути[Откуда][Узел.Ключ] + Пути[Узел.Ключ][Куда] = Пути[Откуда][Куда] Тогда\r\n            ЗаполнитьЗначенияСвойств(Путь.Добавить(), Новый Структура(\"Куда, Длина\", Узел.Ключ, Пути[Откуда][Узел.Ключ]))\r\n        КонецЕсли\r\n    КонецЦикла;\r\n    Путь.Сортировать(\"Длина\");\r\n    Возврат Путь\r\nКонецФункции // КратчайшийПуть()\n\nФункция КратчайшийПутьФлойд(Откуда, Куда, Дуги) Экспорт\r\n    // загрузка графа в \"соответствие соответствий\" так, что Пути[Откуда][Куда] = Длина\r\n    Пути = Новый Соответствие;\r\n    Для каждого Дуга Из Дуги Цикл\r\n        Пути[Дуга.Откуда] = ?(Пути[Дуга.Откуда] = Неопределено, Новый Соответствие, Пути[Дуга.Откуда]);\r\n        Пути[Дуга.Откуда][Дуга.Куда] = Дуга.Длина\r\n    КонецЦикла;\r\n    // три вложенных цикла по узлам графа\r\n    Для каждого Узел1 Из Пути Цикл // тогда Узел.Ключ - это одна вершина из полного множества вершин  \r\n        Для каждого Узел2 Из Пути Цикл \r\n            Если Пути[Узел2.Ключ][Узел1.Ключ] <> Неопределено Тогда\r\n                Для каждого Узел3 Из Узел1.Значение Цикл // здесь только вершины, связанные с Узел1.Ключ \r\n                    Длина = Пути[Узел2.Ключ][Узел3.Ключ];\r\n                    Обход = Пути[Узел2.Ключ][Узел1.Ключ] + Узел3.Значение; // Узел3.Значение == Пути[Узел1.Ключ][Узел3.Ключ]\r\n                    Пути[Узел2.Ключ][Узел3.Ключ] = ?(Длина = Неопределено, Обход, Мин(Длина, Обход))\r\n                КонецЦикла \r\n            КонецЕсли \r\n        КонецЦикла \r\n    КонецЦикла;\r\n    // восстановление пути\r\n    Путь = Дуги.СкопироватьКолонки(\"Куда, Длина\");\r\n    Путь.Добавить().Куда = Откуда;\r\n    Путь.Добавить().Куда = Куда;\r\n    Путь[1].Длина = Пути[Откуда][Куда];\r\n    Для каждого Узел Из Пути Цикл \r\n        Если Пути[Откуда][Узел.Ключ] <> Неопределено И Пути[Узел.Ключ][Куда] <> Неопределено \r\n            И Пути[Откуда][Узел.Ключ] + Пути[Узел.Ключ][Куда] = Пути[Откуда][Куда] Тогда\r\n            ЗаполнитьЗначенияСвойств(Путь.Добавить(), Новый Структура(\"Куда, Длина\", Узел.Ключ, Пути[Откуда][Узел.Ключ]))\r\n        КонецЕсли\r\n    КонецЦикла;\r\n    Путь.Сортировать(\"Длина\");\r\n    Возврат Путь\r\nКонецФункции // КратчайшийПуть()\n\nОрфографическая ошибка в Флойда (найдено 2): Флойда\r\nОрфографическая ошибка в Уоршолла: Уоршолла\r\nОрфографическая ошибка в Дейкстры: Дейкстры\r\nОрфографическая ошибка в КратчайшийПутьФлойд: Флойд"
  },
  {
    "title": "Определение длины строки в запросе методом половинного деления",
    "description": "Определение длины строки в запросе методом половинного деления",
    "code_snippet": "ВЫБРАТЬ\r\n    Стр, Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   0, 512) = \"\" ТОГДА Х -   1 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   1, 512) = \"\" ТОГДА Х -   2 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   3, 512) = \"\" ТОГДА Х -   4 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   7, 512) = \"\" ТОГДА Х -   8 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  15, 512) = \"\" ТОГДА Х -  16 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  31, 512) = \"\" ТОГДА Х -  32 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  63, 512) = \"\" ТОГДА Х -  64 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 127, 512) = \"\" ТОГДА Х - 128 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 255, 512) = \"\" ТОГДА Х - 256 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 511, 512) = \"\" ТОГДА Х - 512 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    Дано КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ\r\n\r\n//Для строки длиной до 1024 символов используется система из 10-ти вложенных запросов. Исходная таблица, кроме самой строки, должна содержать начальное значение поиска Х, равное 1024.\r\n\r\n//Данный вариант не учитывает в длине строки концевые пробелы. Если это действительно требуется, то придется использовать вот такой вариант:\r\n\r\nВЫБРАТЬ\r\n    Стр, Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   0, 1) + \"!\" = \"!\" ТОГДА Х -   1 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   1, 1) + \"!\" = \"!\" ТОГДА Х -   2 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   3, 1) + \"!\" = \"!\" ТОГДА Х -   4 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   7, 1) + \"!\" = \"!\" ТОГДА Х -   8 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  15, 1) + \"!\" = \"!\" ТОГДА Х -  16 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  31, 1) + \"!\" = \"!\" ТОГДА Х -  32 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  63, 1) + \"!\" = \"!\" ТОГДА Х -  64 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 127, 1) + \"!\" = \"!\" ТОГДА Х - 128 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 255, 1) + \"!\" = \"!\" ТОГДА Х - 256 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 511, 1) + \"!\" = \"!\" ТОГДА Х - 512 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    Дано КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ\n\nВЫБРАТЬ\r\n    Стр, Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   0, 512) = \"\" ТОГДА Х -   1 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   1, 512) = \"\" ТОГДА Х -   2 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   3, 512) = \"\" ТОГДА Х -   4 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   7, 512) = \"\" ТОГДА Х -   8 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  15, 512) = \"\" ТОГДА Х -  16 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  31, 512) = \"\" ТОГДА Х -  32 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  63, 512) = \"\" ТОГДА Х -  64 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 127, 512) = \"\" ТОГДА Х - 128 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 255, 512) = \"\" ТОГДА Х - 256 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 511, 512) = \"\" ТОГДА Х - 512 ИНАЧЕ Х КОНЕЦ КАК Х\r\nИЗ    Дано КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ\r\n\r\n//Для строки длиной до 1024 символов используется система из 10-ти вложенных запросов. Исходная таблица, кроме самой строки, должна содержать начальное значение поиска Х, равное 1024.\r\n\r\n//Данный вариант не учитывает в длине строки концевые пробелы. Если это действительно требуется, то придется использовать вот такой вариант:\r\n\r\nВЫБРАТЬ\r\n    Стр, Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   0, 1) + \"!\" = \"!\" ТОГДА Х -   1 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   1, 1) + \"!\" = \"!\" ТОГДА Х -   2 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   3, 1) + \"!\" = \"!\" ТОГДА Х -   4 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -   7, 1) + \"!\" = \"!\" ТОГДА Х -   8 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  15, 1) + \"!\" = \"!\" ТОГДА Х -  16 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  31, 1) + \"!\" = \"!\" ТОГДА Х -  32 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х -  63, 1) + \"!\" = \"!\" ТОГДА Х -  64 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 127, 1) + \"!\" = \"!\" ТОГДА Х - 128 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 255, 1) + \"!\" = \"!\" ТОГДА Х - 256 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    (ВЫБРАТЬ Стр, ВЫБОР КОГДА ПОДСТРОКА(Стр, Х - 511, 1) + \"!\" = \"!\" ТОГДА Х - 512 ИНАЧЕ Х КОНЕЦ Х\r\nИЗ    Дано КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ) КАК ВЗ\n\n{} Ожидается идентификатор\r\nОрфографическая ошибка в громозким: громозким"
  },
  {
    "title": "Подсчет записей, содержащих одинаковые неупорядоченные пары значений",
    "description": "Подсчет записей, содержащих одинаковые неупорядоченные пары значений",
    "code_snippet": "ВЫБРАТЬ А, Б, КОЛИЧЕСТВО(*) \nИЗ (ВЫБРАТЬ А, Б ИЗ Дано ОБЪЕДИНИТЬ ВЫБРАТЬ Б, А ИЗ Дано ГДЕ А <> Б) КАК ВЗ \nГДЕ А <= Б\nСГРУППИРОВАТЬ ПО А, Б"
  },
  {
    "title": "Первый пропущенный артикул",
    "description": "Первый пропущенный артикул",
    "code_snippet": "ВЫБРАТЬ\n    ВЫБОР ПОДСТРОКА(Артикул, 6, 1)КОГДА\"1\"ТОГДА 1 КОГДА\"2\"ТОГДА 2 КОГДА\"3\"ТОГДА 3 КОГДА\"4\"ТОГДА 4 КОГДА\"5\"ТОГДА 5 КОГДА\"6\"ТОГДА 6 КОГДА\"7\"ТОГДА 7 КОГДА\"8\"ТОГДА 8 КОГДА\"9\"ТОГДА 9 ИНАЧЕ 0 КОНЕЦ \n  + ВЫБОР ПОДСТРОКА(Артикул, 5, 1)КОГДА\"1\"ТОГДА 1 КОГДА\"2\"ТОГДА 2 КОГДА\"3\"ТОГДА 3 КОГДА\"4\"ТОГДА 4 КОГДА\"5\"ТОГДА 5 КОГДА\"6\"ТОГДА 6 КОГДА\"7\"ТОГДА 7 КОГДА\"8\"ТОГДА 8 КОГДА\"9\"ТОГДА 9 ИНАЧЕ 0 КОНЕЦ * 10\n  + ВЫБОР ПОДСТРОКА(Артикул, 4, 1)КОГДА\"1\"ТОГДА 1 КОГДА\"2\"ТОГДА 2 КОГДА\"3\"ТОГДА 3 КОГДА\"4\"ТОГДА 4 КОГДА\"5\"ТОГДА 5 КОГДА\"6\"ТОГДА 6 КОГДА\"7\"ТОГДА 7 КОГДА\"8\"ТОГДА 8 КОГДА\"9\"ТОГДА 9 ИНАЧЕ 0 КОНЕЦ * 100\n  + ВЫБОР ПОДСТРОКА(Артикул, 3, 1)КОГДА\"1\"ТОГДА 1 КОГДА\"2\"ТОГДА 2 КОГДА\"3\"ТОГДА 3 КОГДА\"4\"ТОГДА 4 КОГДА\"5\"ТОГДА 5 КОГДА\"6\"ТОГДА 6 КОГДА\"7\"ТОГДА 7 КОГДА\"8\"ТОГДА 8 КОГДА\"9\"ТОГДА 9 ИНАЧЕ 0 КОНЕЦ * 1000\n  + ВЫБОР ПОДСТРОКА(Артикул, 2, 1)КОГДА\"1\"ТОГДА 1 КОГДА\"2\"ТОГДА 2 КОГДА\"3\"ТОГДА 3 КОГДА\"4\"ТОГДА 4 КОГДА\"5\"ТОГДА 5 КОГДА\"6\"ТОГДА 6 КОГДА\"7\"ТОГДА 7 КОГДА\"8\"ТОГДА 8 КОГДА\"9\"ТОГДА 9 ИНАЧЕ 0 КОНЕЦ * 10000\n  + ВЫБОР ПОДСТРОКА(Артикул, 1, 1)КОГДА\"1\"ТОГДА 1 КОГДА\"2\"ТОГДА 2 КОГДА\"3\"ТОГДА 3 КОГДА\"4\"ТОГДА 4 КОГДА\"5\"ТОГДА 5 КОГДА\"6\"ТОГДА 6 КОГДА\"7\"ТОГДА 7 КОГДА\"8\"ТОГДА 8 КОГДА\"9\"ТОГДА 9 ИНАЧЕ 0 КОНЕЦ * 100000 КАК Х\nПОМЕСТИТЬ Числа\nИЗ Дано\nДЛЯ ИЗМЕНЕНИЯ\n;\nВЫБРАТЬ \n    Х, \n    ЛОЖЬ КАК Свободен\nПОМЕСТИТЬ ЧислаПлюс\nИЗ Числа\nОБЪЕДИНИТЬ\nВЫБРАТЬ    \n    Х + 1, \n    ИСТИНА\nИЗ Числа\n;\nВЫБРАТЬ ПЕРВЫЕ 1\n    Х КАК ПервыйСвободныйАртикул\nИЗ ЧислаПлюс\nСГРУППИРОВАТЬ ПО Х\nИМЕЮЩИЕ КОЛИЧЕСТВО(*) = 1 И МАКСИМУМ(Свободен) = ИСТИНА\n\nОрфографическая ошибка в шестизначных: шестизначных"
  },
  {
    "title": "Количество дней, когда товар был на складе",
    "description": "Количество дней, когда товар был на складе",
    "code_snippet": "ВЫБРАТЬ\n    Движения.Склад,\n    Движения.Номенклатура,\n    Движения.Период,\n    Движения.КоличествоНачальныйОстаток,\n    Движения.КоличествоКонечныйОстаток\nПОМЕСТИТЬ Движения\nИЗ\n    РегистрНакопления.ТоварыНаСкладах.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Секунда, , ) КАК Движения\n;\n\n////////////////////////////////////////////////////////////­////////////////////\nВЫБРАТЬ\n    Движения.Склад,\n    Движения.Номенклатура,\n    Движения.Период,\n    Движения.КоличествоНачальныйОстаток,\n    Движения.КоличествоКонечныйОстаток\nПОМЕСТИТЬ ДополненныеДвижения\nИЗ\n    Движения КАК Движения\n\nОБЪЕДИНИТЬ\n\nВЫБРАТЬ РАЗЛИЧНЫЕ\n    НачальныеНули.Склад,\n    НачальныеНули.Номенклатура,\n    &НачалоПериода,\n    0,\n    0\nИЗ\n    Движения КАК НачальныеНули\n\nОБЪЕДИНИТЬ\n\nВЫБРАТЬ РАЗЛИЧНЫЕ\n    КонечныеНули.Склад,\n    КонечныеНули.Номенклатура,\n    &КонецПериода,\n    0,\n    0\nИЗ\n    Движения КАК КонечныеНули\n;\n\n////////////////////////////////////////////////////////////­////////////////////\nВЫБРАТЬ\n    Точки.Склад,\n    Точки.Номенклатура,\n    Точки.Период,\n    МАКСИМУМ(Точки.КоличествоНачальныйОстаток) КАК КоличествоНачальныйОстаток,\n    МАКСИМУМ(Точки.КоличествоКонечныйОстаток) КАК КоличествоКонечныйОстаток\nПОМЕСТИТЬ ТочкиВремени\nИЗ\n    ДополненныеДвижения КАК Точки\n\nСГРУППИРОВАТЬ ПО\n    Точки.Склад,\n    Точки.Номенклатура,\n    Точки.Период\n;\n\n////////////////////////////////////////////////////////////­////////////////////\nВЫБРАТЬ\n    Точки.Склад,\n    Точки.Номенклатура,\n    МАКСИМУМ(Слева.Период) КАК НачалоОтсутствия,\n    Точки.Период\nПОМЕСТИТЬ Интервалы\nИЗ\n    ТочкиВремени КАК Точки\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТочкиВремени КАК Слева\n        ПО Точки.Склад = Слева.Склад\n            И Точки.Номенклатура = Слева.Номенклатура\n            И (Точки.КоличествоНачальныйОстаток = 0)\n            И (Слева.КоличествоКонечныйОстаток = 0)\n            И Точки.Период > Слева.Период\n\nСГРУППИРОВАТЬ ПО\n    Точки.Склад,\n    Точки.Номенклатура,\n    Точки.Период\n\nОБЪЕДИНИТЬ ВСЕ\n\nВЫБРАТЬ РАЗЛИЧНЫЕ\n    Точки.Склад,\n    Точки.Номенклатура,\n    &КонецПериода,\n    &НачалоПериода\nИЗ\n    Движения КАК Точки\n;\n\n////////////////////////////////////////////////////////////­////////////////////\nВЫБРАТЬ\n    Интервалы.Склад,\n    Интервалы.Номенклатура,\n    СУММА(РАЗНОСТЬДАТ(Интервалы.Период, Интервалы.НачалоОтсутствия, СЕКУНДА)) / 60 / 60 / 24 КАК ДнейНаличия\nИЗ\n    Интервалы КАК Интервалы\n\nСГРУППИРОВАТЬ ПО\n    Интервалы.Склад,\n    Интервалы.Номенклатура\n\nВЫБРАТЬ\n    Движения.Период,\n    Движения.Склад,\n    Движения.Номенклатура,\n    Движения.КоличествоКонечныйОстаток\nПОМЕСТИТЬ Движения\nИЗ\n    РегистрНакопления.ТоварыНаСкладах.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, ДЕНЬ, ДвиженияИГраницыПериода, Склад = &Склад) КАК Движения\n;\nВЫБРАТЬ\n    Интервалы.Склад,\n    Интервалы.Номенклатура,\n    СУММА(Интервалы.Интервал) КАК ДнейНаличия\nИЗ\n    (ВЫБРАТЬ\n        Было.Склад КАК Склад,\n        Было.Номенклатура КАК Номенклатура,\n        РАЗНОСТЬДАТ(Было.Период, МИНИМУМ(Стало.Период), ДЕНЬ) КАК Интервал\n    ИЗ\n        Движения КАК Было\n            ВНУТРЕННЕЕ СОЕДИНЕНИЕ Движения КАК Стало\n            ПО Было.Склад = Стало.Склад\n                И Было.Номенклатура = Стало.Номенклатура\n                И (Было.КоличествоКонечныйОстаток > 0)\n                И Было.Период < Стало.Период\n        СГРУППИРОВАТЬ ПО\n        Было.Период,\n        Было.Склад,\n        Было.Номенклатура) КАК Интервалы\nСГРУППИРОВАТЬ ПО\n    Интервалы.Склад,\n    Интервалы.Номенклатура"
  },
  {
    "title": "Движения периодического регистра сведений без повторов",
    "description": "Движения периодического регистра сведений без повторов",
    "code_snippet": "ВЫБРАТЬ\r\n    Дано.Дата КАК Дата,\r\n    Дано.Цена\r\nИЗ\r\n    Дано КАК Дано\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Дано КАК Слева\r\n        ПО (Слева.Дата < Дано.Дата)\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.Дата,\r\n    Дано.Цена\r\nИМЕЮЩИЕ\r\n    ЕСТЬNULL(МАКСИМУМ(Слева.Дата), 0) <> ЕСТЬNULL(МАКСИМУМ(ВЫБОР Слева.Цена КОГДА Дано.Цена ТОГДА Слева.Дата КОНЕЦ), 1)\r\n\r\n//Или вот еще решение через коррелированный запрос (всегда требуется тестировать производительность таких вариантов!)\r\n\r\nВЫБРАТЬ\r\n    Дано.Дата КАК Дата,\r\n    Дано.Цена\r\nИЗ\r\n    Дано КАК Дано\r\nГДЕ\r\n    НЕ Дано.Цена В\r\n                (ВЫБРАТЬ ПЕРВЫЕ 1\r\n                    Слева.Цена\r\n                ИЗ\r\n                    Дано КАК Слева\r\n                ГДЕ\r\n                    Слева.Дата < Дано.Дата\r\n                УПОРЯДОЧИТЬ ПО\r\n                    Слева.Дата УБЫВ)\n\nВЫБРАТЬ\r\n    Дано.Дата КАК Дата,\r\n    Дано.Цена\r\nИЗ\r\n    Дано КАК Дано\r\n        ЛЕВОЕ СОЕДИНЕНИЕ Дано КАК Слева\r\n        ПО (Слева.Дата < Дано.Дата)\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.Дата,\r\n    Дано.Цена\r\nИМЕЮЩИЕ\r\n    ЕСТЬNULL(МАКСИМУМ(Слева.Дата), 0) <> ЕСТЬNULL(МАКСИМУМ(ВЫБОР Слева.Цена КОГДА Дано.Цена ТОГДА Слева.Дата КОНЕЦ), 1)\r\n\r\n//Или вот еще решение через коррелированный запрос (всегда требуется тестировать производительность таких вариантов!)\r\n\r\nВЫБРАТЬ\r\n    Дано.Дата КАК Дата,\r\n    Дано.Цена\r\nИЗ\r\n    Дано КАК Дано\r\nГДЕ\r\n    НЕ Дано.Цена В\r\n                (ВЫБРАТЬ ПЕРВЫЕ 1\r\n                    Слева.Цена\r\n                ИЗ\r\n                    Дано КАК Слева\r\n                ГДЕ\r\n                    Слева.Дата < Дано.Дата\r\n                УПОРЯДОЧИТЬ ПО\r\n                    Слева.Дата УБЫВ)\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Округление в большую сторону",
    "description": "Округление в большую сторону",
    "code_snippet": "М - Цел(М - Ч)\r\n//где М = 999999999 или больше, при необходимости.\r\n\r\n//В качестве дополнения красивый прием, взятый из чужого кода. Абсолютное значение числа Ч:\r\n\r\nМакс(Ч, -Ч)\n\nМ - Цел(М - Ч)\r\n//где М = 999999999 или больше, при необходимости.\r\n\r\n//В качестве дополнения красивый прием, взятый из чужого кода. Абсолютное значение числа Ч:\r\n\r\nМакс(Ч, -Ч)\n\n{} Ожидается идентификатор\r\nОрфографическая ошибка в бОльшую: Ольшую"
  },
  {
    "title": "Сравнение двух массивов",
    "description": "Сравнение двух массивов",
    "code_snippet": "Функция ИсключающееИЛИ(Массив1, Массив2)    \r\n    Результат = Новый Массив;    \r\n    Повтор = Новый Соответствие;    \r\n    Для каждого Элемент Из Массив1 Цикл\r\n        Повтор[Элемент] = ?(Повтор[Элемент] = Неопределено, Ложь, Истина)\r\n    КонецЦикла;    \r\n    Для каждого Элемент Из Массив2 Цикл\r\n        Повтор[Элемент] = ?(Повтор[Элемент] = Неопределено, Ложь, Истина)\r\n    КонецЦикла;    \r\n    Для каждого Элемент Из Повтор Цикл\r\n        Если НЕ Элемент.Значение Тогда\r\n            Результат.Добавить(Элемент.Ключ)\r\n        КонецЕсли \r\n    КонецЦикла;    \r\n    Возврат Результат\r\nКонецФункции\r\n\r\n//Если в массиве могут быть только даты (в исходной задаче было так), то можно использовать другой принцип, сократив один цикл:\r\n\r\nФункция ИсключающееИЛИ1(Массив1, Массив2)    \r\n    Результат = Новый Массив;    \r\n    Строка1 = ЗначениеВСтрокуВнутр(Массив1);\r\n    Строка2 = ЗначениеВСтрокуВнутр(Массив2);    \r\n    Для каждого Элемент Из Массив1 Цикл\r\n        Если НЕ Найти(Строка2, Формат(Элемент,\"ДФ=ггггММддЧЧммсс\")) Тогда\r\n            Результат.Добавить(Элемент)\r\n        КонецЕсли \r\n    КонецЦикла;    \r\n    Для каждого Элемент Из Массив2 Цикл\r\n        Если НЕ Найти(Строка1, Формат(Элемент,\"ДФ=ггггММддЧЧммсс\")) Тогда\r\n            Результат.Добавить(Элемент)\r\n        КонецЕсли \r\n    КонецЦикла;    \r\n    Возврат Результат\r\nКонецФункции\n\nФункция ИсключающееИЛИ(Массив1, Массив2)    \r\n    Результат = Новый Массив;    \r\n    Повтор = Новый Соответствие;    \r\n    Для каждого Элемент Из Массив1 Цикл\r\n        Повтор[Элемент] = ?(Повтор[Элемент] = Неопределено, Ложь, Истина)\r\n    КонецЦикла;    \r\n    Для каждого Элемент Из Массив2 Цикл\r\n        Повтор[Элемент] = ?(Повтор[Элемент] = Неопределено, Ложь, Истина)\r\n    КонецЦикла;    \r\n    Для каждого Элемент Из Повтор Цикл\r\n        Если НЕ Элемент.Значение Тогда\r\n            Результат.Добавить(Элемент.Ключ)\r\n        КонецЕсли \r\n    КонецЦикла;    \r\n    Возврат Результат\r\nКонецФункции\r\n\r\n//Если в массиве могут быть только даты (в исходной задаче было так), то можно использовать другой принцип, сократив один цикл:\r\n\r\nФункция ИсключающееИЛИ1(Массив1, Массив2)    \r\n    Результат = Новый Массив;    \r\n    Строка1 = ЗначениеВСтрокуВнутр(Массив1);\r\n    Строка2 = ЗначениеВСтрокуВнутр(Массив2);    \r\n    Для каждого Элемент Из Массив1 Цикл\r\n        Если НЕ Найти(Строка2, Формат(Элемент,\"ДФ=ггггММддЧЧммсс\")) Тогда\r\n            Результат.Добавить(Элемент)\r\n        КонецЕсли \r\n    КонецЦикла;    \r\n    Для каждого Элемент Из Массив2 Цикл\r\n        Если НЕ Найти(Строка1, Формат(Элемент,\"ДФ=ггггММддЧЧммсс\")) Тогда\r\n            Результат.Добавить(Элемент)\r\n        КонецЕсли \r\n    КонецЦикла;    \r\n    Возврат Результат\r\nКонецФункции\n\nОрфографическая ошибка в ггггММддЧЧммсс (найдено 2): гггг"
  },
  {
    "title": "Объединение непересекающихся интервалов в запросе",
    "description": "Объединение непересекающихся интервалов в запросе",
    "code_snippet": "ВЫБРАТЬ\n    Дано.НачалоПериода,\n    Дано.КонецПериода,\n    Дано.Гостиница,\n    Дано.ФизическоеЛицо,\n    СУММА(РАЗНОСТЬДАТ(Слева.НачалоПериода, Слева.КонецПериода, ДЕНЬ) + 1) КАК Интеграл\nПОМЕСТИТЬ ДаноПлюс\nИЗ\n    Дано КАК Дано\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Дано КАК Слева\n        ПО (Слева.НачалоПериода <= Дано.НачалоПериода) \n           И Дано.Гостиница = ДаноСлева.Гостиница \n           И Дано.ФизическоеЛицо = ДаноСлева.ФизическоеЛицо\nСГРУППИРОВАТЬ ПО\n    Дано.НачалоПериода,\n    Дано.КонецПериода,\n    Дано.Гостиница,\n    Дано.ФизическоеЛицо\n;\nВЫБРАТЬ\n    МИНИМУМ(Дано.НачалоПериода) КАК НачалоПериода,\n    МАКСИМУМ(Дано.КонецПериода) КАК КонецПериода,\n    Дано.Гостиница,\n    Дано.ФизическоеЛицо\nИЗ\n    ДаноПлюс КАК Дано\nСГРУППИРОВАТЬ ПО\n    ДОБАВИТЬКДАТЕ(Дано.КонецПериода, ДЕНЬ, -Дано.Интеграл),\n    Дано.Гостиница,\n    Дано.ФизическоеЛицо"
  },
  {
    "title": "Оптимизация подбора кусков заданного суммарного метража методом ветвей и границ",
    "description": "Оптимизация подбора кусков заданного суммарного метража методом ветвей и границ",
    "code_snippet": "Процедура КнопкаСформироватьНажатие(Кнопка) \r\n    РабочаяТаблица = Метраж.Выгрузить(); \r\n    РабочаяТаблица.ЗаполнитьЗначения(Метраж.Итог(\"Имеется\"), \"НужноВзять\"); \r\n    Метраж.ЗагрузитьКолонку(РабочаяТаблица.ВыгрузитьКолонку(\"НужноВзять\"), \"НужноВзять\"); \r\n    РабочаяТаблица.ЗаполнитьЗначения(0, \"НужноВзять\"); \r\n    РабочаяТаблица.Сортировать(\"Коэффициент Убыв\"); \r\n    ПодборКусков(РабочаяТаблица, РабочаяТаблица.Количество() - 1, Требуется) \r\nКонецПроцедуры\r\n\r\nПроцедура ПодборКусков(РабочаяТаблица, ВГраница, ЗаданнаяСумма, УжеВзяли = 0) Экспорт  \r\n    Если ВГраница < 0 ИЛИ ЗаданнаяСумма < 0 ИЛИ УжеВзяли >= Метраж.Итог(\"НужноВзять\") Тогда //промах  \r\n        Возврат      \r\n    ИначеЕсли ЗаданнаяСумма = 0 Тогда //фиксируем решение  \r\n        Ответ = РабочаяТаблица.Скопировать( , \"НомерСтроки, НужноВзять\"); \r\n        Ответ.Сортировать(\"НомерСтроки\"); \r\n        Метраж.ЗагрузитьКолонку(Ответ.ВыгрузитьКолонку(\"НужноВзять\"), \"НужноВзять\")  \r\n    КонецЕсли;  \r\n    Курсор = РабочаяТаблица[ВГраница];  \r\n    Для НужноВзять = 0 По Курсор.Имеется Цикл  \r\n        Курсор.НужноВзять = НужноВзять;  \r\n        ПодборКусков(РабочаяТаблица, ВГраница - 1, ЗаданнаяСумма - НужноВзять * Курсор.Коэффициент, УжеВзяли + НужноВзять);          \r\n        Курсор.НужноВзять = 0 \r\n    КонецЦикла \r\nКонецПроцедуры // ПодборКусков()\n\nПроцедура КнопкаСформироватьНажатие(Кнопка) \r\n    РабочаяТаблица = Метраж.Выгрузить(); \r\n    РабочаяТаблица.ЗаполнитьЗначения(Метраж.Итог(\"Имеется\"), \"НужноВзять\"); \r\n    Метраж.ЗагрузитьКолонку(РабочаяТаблица.ВыгрузитьКолонку(\"НужноВзять\"), \"НужноВзять\"); \r\n    РабочаяТаблица.ЗаполнитьЗначения(0, \"НужноВзять\"); \r\n    РабочаяТаблица.Сортировать(\"Коэффициент Убыв\"); \r\n    ПодборКусков(РабочаяТаблица, РабочаяТаблица.Количество() - 1, Требуется) \r\nКонецПроцедуры\r\n\r\nПроцедура ПодборКусков(РабочаяТаблица, ВГраница, ЗаданнаяСумма, УжеВзяли = 0) Экспорт  \r\n    Если ВГраница < 0 ИЛИ ЗаданнаяСумма < 0 ИЛИ УжеВзяли >= Метраж.Итог(\"НужноВзять\") Тогда //промах  \r\n        Возврат      \r\n    ИначеЕсли ЗаданнаяСумма = 0 Тогда //фиксируем решение  \r\n        Ответ = РабочаяТаблица.Скопировать( , \"НомерСтроки, НужноВзять\"); \r\n        Ответ.Сортировать(\"НомерСтроки\"); \r\n        Метраж.ЗагрузитьКолонку(Ответ.ВыгрузитьКолонку(\"НужноВзять\"), \"НужноВзять\")  \r\n    КонецЕсли;  \r\n    Курсор = РабочаяТаблица[ВГраница];  \r\n    Для НужноВзять = 0 По Курсор.Имеется Цикл  \r\n        Курсор.НужноВзять = НужноВзять;  \r\n        ПодборКусков(РабочаяТаблица, ВГраница - 1, ЗаданнаяСумма - НужноВзять * Курсор.Коэффициент, УжеВзяли + НужноВзять);          \r\n        Курсор.НужноВзять = 0 \r\n    КонецЦикла \r\nКонецПроцедуры // ПодборКусков()"
  },
  {
    "title": "Объединение данных двух периодических регистров",
    "description": "Объединение данных двух периодических регистров",
    "code_snippet": "ВЫБРАТЬ\r\n    ВЫБОР\r\n        КОГДА ТаблицаКоличества.Дата > ТаблицаСостояний.Дата\r\n            ТОГДА ТаблицаКоличества.Дата\r\n        ИНАЧЕ ТаблицаСостояний.Дата\r\n    КОНЕЦ КАК Дата,\r\n    ТаблицаКоличества.Количество КАК Количество,\r\n    ТаблицаСостояний.Состояние КАК Состояние\r\nИЗ\r\n    ТаблицаКоличества КАК ТаблицаКоличества\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТаблицаСостояний КАК ТаблицаСостояний\r\n        ПО (ТаблицаСостояний.Дата В\r\n                    (ВЫБРАТЬ\r\n                        МАКСИМУМ(ТаблицаСостояний.Дата)\r\n                    ИЗ\r\n                        ТаблицаСостояний КАК ТаблицаСостояний\r\n                    ГДЕ\r\n                        ТаблицаСостояний.Дата <= ТаблицаКоличества.Дата)\r\n                ИЛИ ТаблицаКоличества.Дата В\r\n                    (ВЫБРАТЬ\r\n                        МАКСИМУМ(ТаблицаКоличества.Дата)\r\n                    ИЗ\r\n                        ТаблицаКоличества КАК ТаблицаКоличества\r\n                    ГДЕ\r\n                        ТаблицаКоличества.Дата <= ТаблицаСостояний.Дата))\n\nВЫБРАТЬ\r\n    ВЫБОР\r\n        КОГДА ТаблицаКоличества.Дата > ТаблицаСостояний.Дата\r\n            ТОГДА ТаблицаКоличества.Дата\r\n        ИНАЧЕ ТаблицаСостояний.Дата\r\n    КОНЕЦ КАК Дата,\r\n    ТаблицаКоличества.Количество КАК Количество,\r\n    ТаблицаСостояний.Состояние КАК Состояние\r\nИЗ\r\n    ТаблицаКоличества КАК ТаблицаКоличества\r\n        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТаблицаСостояний КАК ТаблицаСостояний\r\n        ПО (ТаблицаСостояний.Дата В\r\n                    (ВЫБРАТЬ\r\n                        МАКСИМУМ(ТаблицаСостояний.Дата)\r\n                    ИЗ\r\n                        ТаблицаСостояний КАК ТаблицаСостояний\r\n                    ГДЕ\r\n                        ТаблицаСостояний.Дата <= ТаблицаКоличества.Дата)\r\n                ИЛИ ТаблицаКоличества.Дата В\r\n                    (ВЫБРАТЬ\r\n                        МАКСИМУМ(ТаблицаКоличества.Дата)\r\n                    ИЗ\r\n                        ТаблицаКоличества КАК ТаблицаКоличества\r\n                    ГДЕ\r\n                        ТаблицаКоличества.Дата <= ТаблицаСостояний.Дата))\n\n{3} Ожидается идентификатор\r\nОрфографическая ошибка в ахтунг: ахтунг"
  },
  {
    "title": "Определение длины строки в запросе",
    "description": "Определение длины строки в запросе",
    "code_snippet": "ВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    Дано.Строка\r\nПОМЕСТИТЬ Дано\r\nИЗ\r\n    &Дано КАК Дано\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    0 КАК ё\r\nПОМЕСТИТЬ Р0\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    1\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    2 * Р1.ё + Р0.ё КАК ё\r\nПОМЕСТИТЬ Р10\r\nИЗ\r\n    Р0 КАК Р1,\r\n    Р0 КАК Р0\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    4 * Р32.ё + Р10.ё КАК ё\r\nПОМЕСТИТЬ Р3210\r\nИЗ\r\n    Р10 КАК Р32,\r\n    Р10 КАК Р10\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    16 * Р54.ё + Р3210.ё + 1 КАК ё\r\nПОМЕСТИТЬ Р543210\r\nИЗ\r\n    Р10 КАК Р54,\r\n    Р3210 КАК Р3210\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    Дано.Строка,\r\n    МАКСИМУМ(Р543210.ё) КАК ДлинаСтроки\r\nИЗ\r\n    Дано КАК Дано,\r\n    Р543210 КАК Р543210\r\nГДЕ\r\n    ПОДСТРОКА(Дано.Строка, Р543210.ё, 1) + \"!\" <> \"!\"\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.НомерСтроки,\r\n    Дано.Строка\n\nВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    Дано.Строка\r\nПОМЕСТИТЬ Дано\r\nИЗ\r\n    &Дано КАК Дано\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    0 КАК ё\r\nПОМЕСТИТЬ Р0\r\n\r\nОБЪЕДИНИТЬ\r\n\r\nВЫБРАТЬ\r\n    1\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    2 * Р1.ё + Р0.ё КАК ё\r\nПОМЕСТИТЬ Р10\r\nИЗ\r\n    Р0 КАК Р1,\r\n    Р0 КАК Р0\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    4 * Р32.ё + Р10.ё КАК ё\r\nПОМЕСТИТЬ Р3210\r\nИЗ\r\n    Р10 КАК Р32,\r\n    Р10 КАК Р10\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    16 * Р54.ё + Р3210.ё + 1 КАК ё\r\nПОМЕСТИТЬ Р543210\r\nИЗ\r\n    Р10 КАК Р54,\r\n    Р3210 КАК Р3210\r\n;\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\nВЫБРАТЬ\r\n    Дано.НомерСтроки,\r\n    Дано.Строка,\r\n    МАКСИМУМ(Р543210.ё) КАК ДлинаСтроки\r\nИЗ\r\n    Дано КАК Дано,\r\n    Р543210 КАК Р543210\r\nГДЕ\r\n    ПОДСТРОКА(Дано.Строка, Р543210.ё, 1) + \"!\" <> \"!\"\r\n\r\nСГРУППИРОВАТЬ ПО\r\n    Дано.НомерСтроки,\r\n    Дано.Строка\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Загадка суммы и произведения",
    "description": "Загадка суммы и произведения",
    "code_snippet": "ВЫБРАТЬ 0 КАК Х\nПОМЕСТИТЬ Бит\nОБЪЕДИНИТЬ ВЫБРАТЬ 1\n;\nВЫБРАТЬ    Бит0.Х + 2 * (Бит1.Х + 2 * (Бит2.Х + 2 * (Бит3.Х + 2 * (Бит4.Х + 2 * (Бит5.Х + 2 * Бит6.Х))))) КАК Х\nПОМЕСТИТЬ Ряд\nИЗ Бит КАК Бит6, Бит КАК Бит5, Бит КАК Бит4, Бит КАК Бит3, Бит КАК Бит2, Бит КАК Бит1, Бит КАК Бит0\n;\nВЫБРАТЬ Ряд1.Х КАК Х, Ряд2.Х КАК У, Ряд1.Х + Ряд2.Х КАК Сумма, Ряд1.Х * Ряд2.Х КАК ХУ\nПОМЕСТИТЬ Пробы\nИЗ Ряд КАК Ряд1, Ряд КАК Ряд2\nГДЕ 1 < Ряд1.Х И Ряд1.Х < Ряд2.Х И Ряд1.Х + Ряд2.Х <= 100\n;\nВЫБРАТЬ РАЗЛИЧНЫЕ Сумма\nПОМЕСТИТЬ ТабуСумм\nИЗ Пробы\nГДЕ ХУ В (ВЫБРАТЬ ХУ ИЗ Пробы СГРУППИРОВАТЬ ПО ХУ ИМЕЮЩИЕ КОЛИЧЕСТВО(*) = 1)\n;\nВЫБРАТЬ    ХУ КАК Произведение\nПОМЕСТИТЬ ЧислаПоля\nИЗ Пробы\nГДЕ    НЕ Сумма В (ВЫБРАТЬ * ИЗ ТабуСумм)\nСГРУППИРОВАТЬ ПО ХУ\nИМЕЮЩИЕ КОЛИЧЕСТВО(РАЗЛИЧНЫЕ Сумма) = 1\n;\nВЫБРАТЬ Сумма, МАКСИМУМ(Произведение), МАКСИМУМ(Х), МАКСИМУМ(У)\nИЗ Пробы ВНУТРЕННЕЕ СОЕДИНЕНИЕ ЧислаПоля ПО ХУ = Произведение\nГДЕ НЕ Сумма В (ВЫБРАТЬ * ИЗ ТабуСумм)\nСГРУППИРОВАТЬ ПО Сумма\nИМЕЮЩИЕ КОЛИЧЕСТВО(РАЗЛИЧНЫЕ Произведение) = 1"
  },
  {
    "title": "Простой трюк для быстрого объединения таблиц значений",
    "description": "Простой трюк для быстрого объединения таблиц значений",
    "code_snippet": "ОбъединениеТаблиц = Таблица1.Скопировать();\nДля Каждого Строка Из Таблица2 Цикл ЗаполнитьЗначенияСвойств(ОбъединениеТаблиц.Добавить(), Строка) КонецЦикла\n\nОбъединениеТаблиц = Таблица2.Скопировать();\nДля ё = 1 По Таблица1.Количество() Цикл ОбъединениеТаблиц.Вставить(0) КонецЦикла;\nДля ё = 0 По Таблица1.Колонки.Количество() - 1 Цикл \n    ОбъединениеТаблиц.ЗагрузитьКолонку(Таблица1.ВыгрузитьКолонку(ё), ё) \nКонецЦикла;"
  },
  {
    "title": "Получение таблицы и массива, заполненных последовательностью чисел от 0 до N-1",
    "description": "Получение таблицы и массива, заполненных последовательностью чисел от 0 до N-1",
    "code_snippet": "// Возвращает текст запроса, формирующего таблицу чисел rN с одной колонкой X (eng), содержащую ряд: 0, 1, (N - 1).\r\nfunction ProtoText(N, M = 1000000000) export\r\n    return ?(N > 2\r\n    , ProtoText(M - Int(M - Sqrt(N)))\r\n    + strreplace(strreplace(\";select top #2 a.X * #1 + b.X X into r#2 from r#1 a, r#1 b\", \"#2\", format(N, \"NG=\")), \"#1\", format(M - Int(M - Sqrt(N)), \"NG=\"))\r\n    , \"select 0 X into r2 union select 1\")\r\nendfunction\r\n\r\n// Возвращает таблицу, содержащую последовательность чисел: 0, 1, 2, ..., (ЧислоСтрок - 1)\r\nФункция ПоследовательностьЧиселТаблицей(ЧислоСтрок) Экспорт\r\n    Запрос = Новый Запрос(СтрЗаменить(ProtoText(ЧислоСтрок), \"into r\" + format(ЧислоСтрок, \"NG=\"), \"\"));\r\n    Возврат Запрос.Выполнить().Выгрузить()\r\nКонецФункции\r\n\r\n// Возвращает массив, содержащий последовательность чисел: 0, 1, 2, ..., (ЧислоЭлементов - 1) \r\nФункция ПоследовательностьЧиселМассивом(ЧислоЭлементов) Экспорт\r\n    Возврат ПоследовательностьЧиселТаблицей(ЧислоЭлементов).ВыгрузитьКолонку(0)\r\nКонецФункции\n\n// Возвращает текст запроса, формирующего таблицу чисел rN с одной колонкой X (eng), содержащую ряд: 0, 1, (N - 1).\r\nfunction ProtoText(N, M = 1000000000) export\r\n    return ?(N > 2\r\n    , ProtoText(M - Int(M - Sqrt(N)))\r\n    + strreplace(strreplace(\";select top #2 a.X * #1 + b.X X into r#2 from r#1 a, r#1 b\", \"#2\", format(N, \"NG=\")), \"#1\", format(M - Int(M - Sqrt(N)), \"NG=\"))\r\n    , \"select 0 X into r2 union select 1\")\r\nendfunction\r\n\r\n// Возвращает таблицу, содержащую последовательность чисел: 0, 1, 2, ..., (ЧислоСтрок - 1)\r\nФункция ПоследовательностьЧиселТаблицей(ЧислоСтрок) Экспорт\r\n    Запрос = Новый Запрос(СтрЗаменить(ProtoText(ЧислоСтрок), \"into r\" + format(ЧислоСтрок, \"NG=\"), \"\"));\r\n    Возврат Запрос.Выполнить().Выгрузить()\r\nКонецФункции\r\n\r\n// Возвращает массив, содержащий последовательность чисел: 0, 1, 2, ..., (ЧислоЭлементов - 1) \r\nФункция ПоследовательностьЧиселМассивом(ЧислоЭлементов) Экспорт\r\n    Возврат ПоследовательностьЧиселТаблицей(ЧислоЭлементов).ВыгрузитьКолонку(0)\r\nКонецФункции\n\nОрфографическая ошибка в ProtoText (найдено 3): Proto\r\nОрфографическая ошибка в strreplace (найдено 2): strreplace"
  },
  {
    "title": "Добавить к дате и разность дат",
    "description": "Добавить к дате и разность дат",
    "code_snippet": "Функция ДобавитьКДате(Дата1, Количество, Период) Экспорт\r\n    Шаг = Новый Структура(\"Год, Квартал, Месяц, Неделя, День, Час, Минута, Секунда\", 12, 3, 1, -604800, -86400, -3600, -60, -1);\r\n    Возврат ?(Шаг[Период] > 0, ДобавитьМесяц(Дата1, Количество * Шаг[Период]), Дата1 - Количество * Шаг[Период])\r\nКонецФункции\r\nФункция РазностьДат(Дата1, Дата2, Период) Экспорт\r\n    Шаг = Новый Структура(\"Год, Квартал, Месяц, Неделя, День, Час, Минута, Секунда\", 12, 3, 1, -604800, -86400, -3600, -60, -1);\r\n    Возврат Цел(?(Шаг[Период] > 0, Год(Дата2) * 12 + Месяц(Дата2) - 1, '00010101' - Дата2) / Шаг[Период]) \r\n          - Цел(?(Шаг[Период] > 0, Год(Дата1) * 12 + Месяц(Дата1) - 1, '00010101' - Дата1) / Шаг[Период])\r\nКонецФункции\r\n\r\n//Функция Квартал\r\n\r\nФункция Квартал(Дата) Экспорт  \r\n    Возврат Цел((Месяц(Дата) - 1) / 3) + 1\r\nКонецФункции\r\n\r\n//Названия месяцев прописью\r\n\r\nФормат(Дата(1, НомерМесяца, 1),\"ДФ=ММММ\")\r\n\r\n//Название дней недели прописью\r\n\r\nФормат(Дата(1, 1, 2 + НомерДняНедели),\"ДФ=дддд\")\n\nФункция ДобавитьКДате(Дата1, Количество, Период) Экспорт\r\n    Шаг = Новый Структура(\"Год, Квартал, Месяц, Неделя, День, Час, Минута, Секунда\", 12, 3, 1, -604800, -86400, -3600, -60, -1);\r\n    Возврат ?(Шаг[Период] > 0, ДобавитьМесяц(Дата1, Количество * Шаг[Период]), Дата1 - Количество * Шаг[Период])\r\nКонецФункции\r\nФункция РазностьДат(Дата1, Дата2, Период) Экспорт\r\n    Шаг = Новый Структура(\"Год, Квартал, Месяц, Неделя, День, Час, Минута, Секунда\", 12, 3, 1, -604800, -86400, -3600, -60, -1);\r\n    Возврат Цел(?(Шаг[Период] > 0, Год(Дата2) * 12 + Месяц(Дата2) - 1, '00010101' - Дата2) / Шаг[Период]) \r\n          - Цел(?(Шаг[Период] > 0, Год(Дата1) * 12 + Месяц(Дата1) - 1, '00010101' - Дата1) / Шаг[Период])\r\nКонецФункции\r\n\r\n//Функция Квартал\r\n\r\nФункция Квартал(Дата) Экспорт  \r\n    Возврат Цел((Месяц(Дата) - 1) / 3) + 1\r\nКонецФункции\r\n\r\n//Названия месяцев прописью\r\n\r\nФормат(Дата(1, НомерМесяца, 1),\"ДФ=ММММ\")\r\n\r\n//Название дней недели прописью\r\n\r\nФормат(Дата(1, 1, 2 + НомерДняНедели),\"ДФ=дддд\")\n\nОрфографическая ошибка в дддд: дддд"
  },
  {
    "title": "Сжатое представление последовательности дат запросом",
    "description": "Сжатое представление последовательности дат запросом",
    "code_snippet": "ВЫБРАТЬ \r\n    Даты.Дата, \r\n    КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ДатыДо.Дата) КАК Номер \r\nПОМЕСТИТЬ НомераДат \r\nИЗ \r\n    ВТДаты КАК Даты \r\n    ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДаты КАК ДатыДо \r\n        ПО (ДатыДо.Дата < = Даты.Дата) \r\nСГРУППИРОВАТЬ ПО \r\n    Даты.Дата \r\n; \r\n\r\n//////////////////////////////////////////////////////////////////////////////// \r\nВЫБРАТЬ \r\n    МИНИМУМ(НомераДат.Дата) КАК ДатаНач, \r\n    МАКСИМУМ(НомераДат.Дата) КАК ДатаКон \r\nИЗ \r\n    НомераДат КАК НомераДат \r\nСГРУППИРОВАТЬ ПО \r\n    ДОБАВИТЬКДАТЕ(НомераДат.Дата, ДЕНЬ, -НомераДат.Номер)\n\nВЫБРАТЬ \r\n    Даты.Дата, \r\n    КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ДатыДо.Дата) КАК Номер \r\nПОМЕСТИТЬ НомераДат \r\nИЗ \r\n    ВТДаты КАК Даты \r\n    ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДаты КАК ДатыДо \r\n        ПО (ДатыДо.Дата < = Даты.Дата) \r\nСГРУППИРОВАТЬ ПО \r\n    Даты.Дата \r\n; \r\n\r\n//////////////////////////////////////////////////////////////////////////////// \r\nВЫБРАТЬ \r\n    МИНИМУМ(НомераДат.Дата) КАК ДатаНач, \r\n    МАКСИМУМ(НомераДат.Дата) КАК ДатаКон \r\nИЗ \r\n    НомераДат КАК НомераДат \r\nСГРУППИРОВАТЬ ПО \r\n    ДОБАВИТЬКДАТЕ(НомераДат.Дата, ДЕНЬ, -НомераДат.Номер)\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Функция для превращения строки в дату по форматной строке",
    "description": "Функция для превращения строки в дату по форматной строке",
    "code_snippet": "Функция СтрокаВДату(Знач ФорматДаты, Знач Дано, Ошибка = Ложь) Экспорт \r\n    Попытка \r\n        ё = Формат('00010101', \"ДФ=\" + ФорматДаты) // - необязательная проверка первого правильности параметра \r\n    Исключение \r\n        Ошибка = Истина; \r\n        Возврат '00010101' \r\n    КонецПопытки; \r\n    Ч = Новый Соответствие; \r\n    Для ё = 1 По СтрДлина(ФорматДаты) + 7 Цикл \r\n        Ч[Сред(ФорматДаты + \"dMyHhms\", ё, 1)] = 0    // - инициализация частей даты \r\n    КонецЦикла; \r\n    Для ё = 1 По 12 Цикл \r\n        Дано = СтрЗаменить(Дано, Формат(Дата(1, ё, 1), \"ДФ=MMММ\"), Формат(ё, \"ЧЦ=4; ЧВН=\")); // - замена названий месяцев числами \r\n        Дано = СтрЗаменить(Дано, Формат(Дата(1, ё, 1), \"ДФ=MMМ\" ), Формат(ё, \"ЧЦ=3; ЧВН=\")) \r\n    КонецЦикла; \r\n    Для ё = 1 По СтрДлина(ФорматДаты) Цикл \r\n        Ч[Сред(ФорматДаты, ё, 1)] = 10 * Ч[Сред(ФорматДаты, ё, 1)] + Найти(\"123456789\", Сред(Дано, ё, 1)); // - накопление частей даты \r\n        Ошибка = Ошибка ИЛИ Найти(\"dMyHhms\", Сред(ФорматДаты, ё, 1)) И НЕ Найти(\"0123456789\", Сред(Дано, ё, 1)) // - необязательная проверка на цифры \r\n    КонецЦикла; \r\n    Ч[\"y\"] = Ч[\"y\"] + ?(Ч[\"y\"] < 50, 2000, ?(Ч[\"y\"] < 100, 1900, 0)); // - дополнение двух цифр года до четырех \r\n    Попытка \r\n        Возврат Дата(Ч[\"y\"], Ч[\"M\"], Ч[\"d\"], Ч[\"H\"] + Ч[\"h\"], Ч[\"m\"], Ч[\"s\"]) \r\n    Исключение \r\n        Ошибка = Истина; \r\n        Возврат '00010101' \r\n    КонецПопытки \r\nКонецФункции\n\nФункция СтрокаВДату(Знач ФорматДаты, Знач Дано, Ошибка = Ложь) Экспорт \r\n    Попытка \r\n        ё = Формат('00010101', \"ДФ=\" + ФорматДаты) // - необязательная проверка первого правильности параметра \r\n    Исключение \r\n        Ошибка = Истина; \r\n        Возврат '00010101' \r\n    КонецПопытки; \r\n    Ч = Новый Соответствие; \r\n    Для ё = 1 По СтрДлина(ФорматДаты) + 7 Цикл \r\n        Ч[Сред(ФорматДаты + \"dMyHhms\", ё, 1)] = 0    // - инициализация частей даты \r\n    КонецЦикла; \r\n    Для ё = 1 По 12 Цикл \r\n        Дано = СтрЗаменить(Дано, Формат(Дата(1, ё, 1), \"ДФ=MMММ\"), Формат(ё, \"ЧЦ=4; ЧВН=\")); // - замена названий месяцев числами \r\n        Дано = СтрЗаменить(Дано, Формат(Дата(1, ё, 1), \"ДФ=MMМ\" ), Формат(ё, \"ЧЦ=3; ЧВН=\")) \r\n    КонецЦикла; \r\n    Для ё = 1 По СтрДлина(ФорматДаты) Цикл \r\n        Ч[Сред(ФорматДаты, ё, 1)] = 10 * Ч[Сред(ФорматДаты, ё, 1)] + Найти(\"123456789\", Сред(Дано, ё, 1)); // - накопление частей даты \r\n        Ошибка = Ошибка ИЛИ Найти(\"dMyHhms\", Сред(ФорматДаты, ё, 1)) И НЕ Найти(\"0123456789\", Сред(Дано, ё, 1)) // - необязательная проверка на цифры \r\n    КонецЦикла; \r\n    Ч[\"y\"] = Ч[\"y\"] + ?(Ч[\"y\"] < 50, 2000, ?(Ч[\"y\"] < 100, 1900, 0)); // - дополнение двух цифр года до четырех \r\n    Попытка \r\n        Возврат Дата(Ч[\"y\"], Ч[\"M\"], Ч[\"d\"], Ч[\"H\"] + Ч[\"h\"], Ч[\"m\"], Ч[\"s\"]) \r\n    Исключение \r\n        Ошибка = Истина; \r\n        Возврат '00010101' \r\n    КонецПопытки \r\nКонецФункции"
  },
  {
    "title": "Найти кратчайший путь коня между двумя заданными клетками",
    "description": "Найти кратчайший путь коня между двумя заданными клетками",
    "code_snippet": "Функция Спираль(А, Б, Круг = 0)Экспорт\r\n    Поле = НоваяТаблицаЗначений(\"Х, У, Круг, Связи\");\r\n    Для К = 0 По 63 Цикл \r\n        ЗаполнитьЗначенияСвойств(Поле.Добавить(), Новый Структура(\"Х, У, Круг, Связи\", Цел(К / 8), К % 8, (К = А) - 1, Новый Массив))\r\n    КонецЦикла;\r\n    Пока Поле[Б].Круг < 0 Цикл \r\n        Целина = Поле.НайтиСтроки(Новый Структура(\"Круг\", -1));\r\n        Трек = Поле.НайтиСтроки(Новый Структура(\"Круг\", Круг));\r\n        Для Каждого С Из Целина Цикл\r\n            Для Каждого К Из Трек Цикл\r\n                Если (С.Х - К.Х) * (С.Х - К.Х) + (С.У - К.У) * (С.У - К.У) = 5 Тогда\r\n                    С.Круг = Круг + 1;\r\n                    С.Связи.Добавить(К.Х * 8 + К.У)\r\n                КонецЕсли\r\n            КонецЦикла\r\n        КонецЦикла;\r\n        Круг = Круг + 1\r\n    КонецЦикла;\r\n    Возврат Поле\r\nКонецФункции\r\nПроцедура Спуск(Б, Поле, Знач Путь = \"\") Экспорт\r\n    Путь = Сред(\"abcdefgh\", Б / 8 + 1, 1) + (Б % 8 + 1) + \" \" + Путь;\r\n    Если Поле[Б].Связи.Количество() = 0 Тогда\r\n        ЗаполнитьЗначенияСвойств(Пути.Добавить(), Новый Структура(\"Путь\", Путь))\r\n    Иначе\r\n        Для Каждого К Из Поле[Б].Связи Цикл\r\n            Спуск(К, Поле, Путь)\r\n        КонецЦикла\r\n    КонецЕсли\r\nКонецПроцедуры\n\nФункция Спираль(А, Б, Круг = 0)Экспорт\r\n    Поле = НоваяТаблицаЗначений(\"Х, У, Круг, Связи\");\r\n    Для К = 0 По 63 Цикл \r\n        ЗаполнитьЗначенияСвойств(Поле.Добавить(), Новый Структура(\"Х, У, Круг, Связи\", Цел(К / 8), К % 8, (К = А) - 1, Новый Массив))\r\n    КонецЦикла;\r\n    Пока Поле[Б].Круг < 0 Цикл \r\n        Целина = Поле.НайтиСтроки(Новый Структура(\"Круг\", -1));\r\n        Трек = Поле.НайтиСтроки(Новый Структура(\"Круг\", Круг));\r\n        Для Каждого С Из Целина Цикл\r\n            Для Каждого К Из Трек Цикл\r\n                Если (С.Х - К.Х) * (С.Х - К.Х) + (С.У - К.У) * (С.У - К.У) = 5 Тогда\r\n                    С.Круг = Круг + 1;\r\n                    С.Связи.Добавить(К.Х * 8 + К.У)\r\n                КонецЕсли\r\n            КонецЦикла\r\n        КонецЦикла;\r\n        Круг = Круг + 1\r\n    КонецЦикла;\r\n    Возврат Поле\r\nКонецФункции\r\nПроцедура Спуск(Б, Поле, Знач Путь = \"\") Экспорт\r\n    Путь = Сред(\"abcdefgh\", Б / 8 + 1, 1) + (Б % 8 + 1) + \" \" + Путь;\r\n    Если Поле[Б].Связи.Количество() = 0 Тогда\r\n        ЗаполнитьЗначенияСвойств(Пути.Добавить(), Новый Структура(\"Путь\", Путь))\r\n    Иначе\r\n        Для Каждого К Из Поле[Б].Связи Цикл\r\n            Спуск(К, Поле, Путь)\r\n        КонецЦикла\r\n    КонецЕсли\r\nКонецПроцедуры\n\nОрфографическая ошибка в abcdefgh: abcdefgh"
  },
  {
    "title": "Сгибы листка (задача с собеседования)",
    "description": "Сгибы листка (задача с собеседования)",
    "code_snippet": "function W(k,a=0,b=0)return?(k<1,\"\",W(k-1,a+b)+a%2+W(k-1,a+1+b,1))endfunction\n\nfunction W(k,a=0,b=0)return?(k,W(k-1,a+b)+a%2+W(k-1,a+b+1,1),\"\")endfunction"
  },
  {
    "title": "Ход конем",
    "description": "Ход конем",
    "code_snippet": "ВЫБРАТЬ 1 у, \"a\" х\r\nПОМЕСТИТЬ а\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 2, \"b\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 3, \"c\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 4, \"d\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 5, \"e\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 6, \"f\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 7, \"g\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 8, \"h\"\r\n;\r\nВЫБРАТЬ г.х, д.у\r\nИЗ а а, а г, а д\r\nГДЕ а.х = &ах И (а.у - г.у) * (а.у - г.у) + (&бу - д.у) * (&бу - д.у) = 5\n\nВЫБРАТЬ 1 у, \"a\" х\r\nПОМЕСТИТЬ а\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 2, \"b\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 3, \"c\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 4, \"d\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 5, \"e\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 6, \"f\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 7, \"g\"\r\nОБЪЕДИНИТЬ ВЫБРАТЬ 8, \"h\"\r\n;\r\nВЫБРАТЬ г.х, д.у\r\nИЗ а а, а г, а д\r\nГДЕ а.х = &ах И (а.у - г.у) * (а.у - г.у) + (&бу - д.у) * (&бу - д.у) = 5\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Сравнение двух строк",
    "description": "Сравнение двух строк",
    "code_snippet": "Функция ТаблицаСравненияСтрок_(С1, С2) Экспорт\r\n   Ответ = Новый ТаблицаЗначений; //Ответ = НоваяТаблицаЗначений(\"От, До, ОК\");\r\n   Ответ.Колонки.Добавить(\"От\");\r\n   Ответ.Колонки.Добавить(\"До\"); \r\n   Ответ.Колонки.Добавить(\"ОК\");  \r\n   ЗаполнитьЗначенияСвойств(Ответ.Добавить(), Новый Структура(\"От, ОК\", 1, Сред(С1, 1, 1) = Сред(С2, 1, 1)));\r\n   Для ё = 2 По Макс(СтрДлина(С1), СтрДлина(С2)) Цикл\r\n      Если Ответ[0].ОК <> (Сред(С1, ё, 1) = Сред(С2, ё, 1)) Тогда\r\n         ЗаполнитьЗначенияСвойств(Ответ.Вставить(0), Новый Структура(\"От, ОК\", ё, НЕ Ответ[1].ОК));                            \r\n         Ответ[1].До = ё - 1\r\n      КонецЕсли      \r\n   КонецЦикла;\r\n   Ответ[0].До = Макс(СтрДлина(С1), СтрДлина(С2));\r\n   Возврат Ответ\r\nКонецФункции\r\n\r\n//С дихотомией\r\n\r\nПроцедура РазДва(Ответ, С1, С2, От, До)\r\n   Если От + 2 > До И (Сред(С1, От, 1) = Сред(С2, От, 1)) <> (Сред(С1, До, 1) = Сред(С2, До, 1)) Тогда\r\n      ЗаполнитьЗначенияСвойств(Ответ.Вставить(0), Новый Структура(\"От, ОК\", До, НЕ Ответ[1].ОК));\r\n      Ответ[1].До = От\r\n   ИначеЕсли  От + 1 < До И Сред(С1, От, До - От + 1) <> Сред(С2, От, До - От + 1) Тогда\r\n      РазДва(Ответ, С1, С2, От, Цел((От + До) / 2));\r\n      РазДва(Ответ, С1, С2, Цел((От + До) / 2), До)   \r\n   КонецЕсли\r\nКонецПроцедуры\r\nФункция ТаблицаСравненияСтрок(С1, С2) Экспорт\r\n   Ответ = Новый ТаблицаЗначений;\r\n   Ответ.Колонки.Добавить(\"От\");\r\n   Ответ.Колонки.Добавить(\"До\");\r\n   Ответ.Колонки.Добавить(\"ОК\");\r\n   ЗаполнитьЗначенияСвойств(Ответ.Добавить(), Новый Структура(\"От, ОК\", 1, Сред(С1, 1, 1) = Сред(С2, 1, 1)));\r\n   РазДва(Ответ, С1, С2, 1, Макс(СтрДлина(С1), СтрДлина(С2)));\r\n   Ответ[0].До = Макс(СтрДлина(С1), СтрДлина(С2));\r\n   Возврат Ответ\r\nКонецФункции\n\nФункция ТаблицаСравненияСтрок_(С1, С2) Экспорт\r\n   Ответ = Новый ТаблицаЗначений; //Ответ = НоваяТаблицаЗначений(\"От, До, ОК\");\r\n   Ответ.Колонки.Добавить(\"От\");\r\n   Ответ.Колонки.Добавить(\"До\"); \r\n   Ответ.Колонки.Добавить(\"ОК\");  \r\n   ЗаполнитьЗначенияСвойств(Ответ.Добавить(), Новый Структура(\"От, ОК\", 1, Сред(С1, 1, 1) = Сред(С2, 1, 1)));\r\n   Для ё = 2 По Макс(СтрДлина(С1), СтрДлина(С2)) Цикл\r\n      Если Ответ[0].ОК <> (Сред(С1, ё, 1) = Сред(С2, ё, 1)) Тогда\r\n         ЗаполнитьЗначенияСвойств(Ответ.Вставить(0), Новый Структура(\"От, ОК\", ё, НЕ Ответ[1].ОК));                            \r\n         Ответ[1].До = ё - 1\r\n      КонецЕсли      \r\n   КонецЦикла;\r\n   Ответ[0].До = Макс(СтрДлина(С1), СтрДлина(С2));\r\n   Возврат Ответ\r\nКонецФункции\r\n\r\n//С дихотомией\r\n\r\nПроцедура РазДва(Ответ, С1, С2, От, До)\r\n   Если От + 2 > До И (Сред(С1, От, 1) = Сред(С2, От, 1)) <> (Сред(С1, До, 1) = Сред(С2, До, 1)) Тогда\r\n      ЗаполнитьЗначенияСвойств(Ответ.Вставить(0), Новый Структура(\"От, ОК\", До, НЕ Ответ[1].ОК));\r\n      Ответ[1].До = От\r\n   ИначеЕсли  От + 1 < До И Сред(С1, От, До - От + 1) <> Сред(С2, От, До - От + 1) Тогда\r\n      РазДва(Ответ, С1, С2, От, Цел((От + До) / 2));\r\n      РазДва(Ответ, С1, С2, Цел((От + До) / 2), До)   \r\n   КонецЕсли\r\nКонецПроцедуры\r\nФункция ТаблицаСравненияСтрок(С1, С2) Экспорт\r\n   Ответ = Новый ТаблицаЗначений;\r\n   Ответ.Колонки.Добавить(\"От\");\r\n   Ответ.Колонки.Добавить(\"До\");\r\n   Ответ.Колонки.Добавить(\"ОК\");\r\n   ЗаполнитьЗначенияСвойств(Ответ.Добавить(), Новый Структура(\"От, ОК\", 1, Сред(С1, 1, 1) = Сред(С2, 1, 1)));\r\n   РазДва(Ответ, С1, С2, 1, Макс(СтрДлина(С1), СтрДлина(С2)));\r\n   Ответ[0].До = Макс(СтрДлина(С1), СтрДлина(С2));\r\n   Возврат Ответ\r\nКонецФункции"
  },
  {
    "title": "Формирование синонима переменной из идентификатора",
    "description": "Формирование синонима переменной из идентификатора",
    "code_snippet": "Функция Синонимайзер(Имя, Ответ = \"\", Стэйт = 7, б = \"\") Экспорт\r\n   Для ё = 1 По СтрДлина(Имя) Цикл\r\n      а = Сред(Имя, ё, 1);\r\n      Стэйт = (НРег(а) <> а) * 4 + Цел(Стэйт / 2);\r\n      Ответ = Ответ + ?(Стэйт = 2, НРег(б), ?(ё = 2, ВРег(б), б)) + ?(Стэйт = 4 ИЛИ Стэйт = 5, \" \", \"\");\r\n      б = а\r\n   КонецЦикла;\r\n   Возврат Ответ + б\r\nКонецФункции\n\nФункция Синонимайзер(Имя, Ответ = \"\", Стэйт = 7, б = \"\") Экспорт\r\n   Для ё = 1 По СтрДлина(Имя) Цикл\r\n      а = Сред(Имя, ё, 1);\r\n      Стэйт = (НРег(а) <> а) * 4 + Цел(Стэйт / 2);\r\n      Ответ = Ответ + ?(Стэйт = 2, НРег(б), ?(ё = 2, ВРег(б), б)) + ?(Стэйт = 4 ИЛИ Стэйт = 5, \" \", \"\");\r\n      б = а\r\n   КонецЦикла;\r\n   Возврат Ответ + б\r\nКонецФункции\n\nОрфографическая ошибка в стэйт: стэйт\r\nОрфографическая ошибка в Синонимайзер: Синонимайзер\r\nОрфографическая ошибка в Стэйт (найдено 6): Стэйт"
  },
  {
    "title": "Связывание таблиц значений по ФИФО",
    "description": "Связывание таблиц значений по ФИФО",
    "code_snippet": "Функция СвязываниеПоФИФО(А, Б, ё = 0, ж = 0) Экспорт\r\n    Результат = НовыйТаблицаЗначений(\"Период1, Документ1, Период2, Документ2, Сумма\");\r\n    Пока ё < А.Количество() И ж < Б.Количество() Цикл\r\n        Сумма = Мин(А[ё].Сумма, Б[ж].Сумма);\r\n        ЗаполнитьЗначенияСвойств(Результат.Добавить()\r\n        , Новый Структура(\"Период1, Документ1, Период2, Документ2, Сумма\"\r\n        , А[ё].Период, А[ё].Документ, Б[ж].Период, Б[ж].Документ, Сумма));\r\n        А[ё].Сумма = А[ё].Сумма - Сумма;\r\n        Б[ж].Сумма = Б[ж].Сумма - Сумма;\r\n        ё = ё + (А[ё].Сумма = 0);\r\n        ж = ж + (Б[ж].Сумма = 0)\r\n    КонецЦикла;\r\n    Возврат Результат \r\nКонецФункции\n\nФункция СвязываниеПоФИФО(А, Б, ё = 0, ж = 0) Экспорт\r\n    Результат = НовыйТаблицаЗначений(\"Период1, Документ1, Период2, Документ2, Сумма\");\r\n    Пока ё < А.Количество() И ж < Б.Количество() Цикл\r\n        Сумма = Мин(А[ё].Сумма, Б[ж].Сумма);\r\n        ЗаполнитьЗначенияСвойств(Результат.Добавить()\r\n        , Новый Структура(\"Период1, Документ1, Период2, Документ2, Сумма\"\r\n        , А[ё].Период, А[ё].Документ, Б[ж].Период, Б[ж].Документ, Сумма));\r\n        А[ё].Сумма = А[ё].Сумма - Сумма;\r\n        Б[ж].Сумма = Б[ж].Сумма - Сумма;\r\n        ё = ё + (А[ё].Сумма = 0);\r\n        ж = ж + (Б[ж].Сумма = 0)\r\n    КонецЦикла;\r\n    Возврат Результат \r\nКонецФункции"
  },
  {
    "title": "Остатки на каждый день",
    "description": "Остатки на каждый день",
    "code_snippet": "ВЫБРАТЬ РАЗЛИЧНЫЕ\n    КурсыВалют.Период\nПОМЕСТИТЬ Дни\nИЗ\n    РегистрСведений.КурсыВалют КАК КурсыВалют\nГДЕ\n    КурсыВалют.Период МЕЖДУ &НачалоПериода И &КонецПериода\n;\n\n////////////////////////////////////////////////////////////////////////////////\nВЫБРАТЬ\n    Движения.Номенклатура,\n    ДНИ.Период,\n    СУММА(ВЫБОР\n            КОГДА Движения.Период = &НачалоПериода\n                ТОГДА Движения.КоличествоКонечныйОстаток\n            ИНАЧЕ ВЫБОР\n                    КОГДА Движения.Период < = ДНИ.Период\n                        ТОГДА Движения.КоличествоОборот\n                    ИНАЧЕ 0\n                КОНЕЦ\n        КОНЕЦ) КАК КоличествоКонечныйОстаток\nИЗ\n    Дни КАК ДНИ,\n    РегистрНакопления.ТоварыНаСкладах.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, День, , Номенклатура = &Номенклатура) КАК Движения\n\nСГРУППИРОВАТЬ ПО\n    Движения.Номенклатура,\n    ДНИ.Период"
  },
  {
    "title": "ЗначениеСвойства",
    "description": "ЗначениеСвойства",
    "code_snippet": "ЗначениеСвойства = РегистрыСведений.ЗначенияСвойствОбъектов.Получить(Новый Структура(\"Объект, Свойство\", ОбъектСсылка, ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоНаименованию(ИмяСвойства))).Значение;\n\nЗначениеСвойства = РегистрыСведений.ЗначенияСвойствОбъектов.Получить(Новый Структура(\"Объект, Свойство\", ОбъектСсылка, ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоНаименованию(ИмяСвойства))).Значение;\n\n{1} Переменной ЗначениеСвойства присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в инлайн: инлайн\r\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "Типизация таблицы значений",
    "description": "Типизация таблицы значений",
    "code_snippet": "РезультатТЗ = новый ТаблицаЗначений;\r\nДля Каждого Колонка из ТЗ.Колонки Цикл\r\n\tИмя = Колонка.Имя;\r\n\tМассивТипов = новый Массив(1);\r\n\tМассивТипов[0] = ТипЗнч(ТЗ[0][Имя]);\r\n\tОписатель = новый ОписаниеТипов(МассивТипов);\r\n\tРезультатТЗ.Колонки.Добавить(Имя, Описатель);\r\nКонецЦикла;\r\n\r\nДля каждого Строка из ТЗ Цикл\r\n\tСтрокаРез = РезультатТЗ.Добавить();\r\n\tЗаполнитьЗначенияСвойств(СтрокаРез, Строка);\r\nКонецЦикла;\r\n\r\nТЗ = РезультатТЗ.Скопировать();\n\nРезультатТЗ = новый ТаблицаЗначений;\r\nДля Каждого Колонка из ТЗ.Колонки Цикл\r\n\tИмя = Колонка.Имя;\r\n\tМассивТипов = новый Массив(1);\r\n\tМассивТипов[0] = ТипЗнч(ТЗ[0][Имя]);\r\n\tОписатель = новый ОписаниеТипов(МассивТипов);\r\n\tРезультатТЗ.Колонки.Добавить(Имя, Описатель);\r\nКонецЦикла;\r\n\r\nДля каждого Строка из ТЗ Цикл\r\n\tСтрокаРез = РезультатТЗ.Добавить();\r\n\tЗаполнитьЗначенияСвойств(СтрокаРез, Строка);\r\nКонецЦикла;\r\n\r\nТЗ = РезультатТЗ.Скопировать();\n\n{15} Переменной ТЗ присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Пример раскраски текста форматированной строки",
    "description": "Пример раскраски текста форматированной строки",
    "code_snippet": "Если СокрЛП(ЭлементТекста) = \"=\"\r\n\tИли СокрЛП(ЭлементТекста) = \">\"\r\n\tИли СокрЛП(ЭлементТекста) = \"<\"\r\n\tИли СокрЛП(ЭлементТекста) = \"*\"\r\n\tИли СокрЛП(ЭлементТекста) = \"/\"\r\n\tИли СокрЛП(ЭлементТекста) = \"+\"\r\n\tИли СокрЛП(ЭлементТекста) = \"-\" тогда\r\n\t\r\n\tЭлементТекста = Новый ФорматированнаяСтрока(ЭлементТекста,, WebЦвета.Красный, WebЦвета.Белый);\r\n\t\r\nИначеЕсли Нрег(СокрЛП(ЭлементТекста)) = \"результат\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"база\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"размероклада\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"недельнаяставканорма\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"недельнаяставкафакт\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"отработанодней\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"отработаночасов\" тогда\r\n\t\r\n\tЭлементТекста = Новый ФорматированнаяСтрока(ЭлементТекста,, WebЦвета.Синий, WebЦвета.Белый);\r\n\t\r\nИначе\r\n\tЭлементТекста = Новый ФорматированнаяСтрока(ЭлементТекста,, WebЦвета.Белый, WebЦвета.Черный);\r\nКонецЕсли;\n\nЕсли СокрЛП(ЭлементТекста) = \"=\"\r\n\tИли СокрЛП(ЭлементТекста) = \">\"\r\n\tИли СокрЛП(ЭлементТекста) = \"<\"\r\n\tИли СокрЛП(ЭлементТекста) = \"*\"\r\n\tИли СокрЛП(ЭлементТекста) = \"/\"\r\n\tИли СокрЛП(ЭлементТекста) = \"+\"\r\n\tИли СокрЛП(ЭлементТекста) = \"-\" тогда\r\n\t\r\n\tЭлементТекста = Новый ФорматированнаяСтрока(ЭлементТекста,, WebЦвета.Красный, WebЦвета.Белый);\r\n\t\r\nИначеЕсли Нрег(СокрЛП(ЭлементТекста)) = \"результат\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"база\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"размероклада\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"недельнаяставканорма\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"недельнаяставкафакт\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"отработанодней\"\r\n\tИли нРег(СокрЛП(ЭлементТекста)) = \"отработаночасов\" тогда\r\n\t\r\n\tЭлементТекста = Новый ФорматированнаяСтрока(ЭлементТекста,, WebЦвета.Синий, WebЦвета.Белый);\r\n\t\r\nИначе\r\n\tЭлементТекста = Новый ФорматированнаяСтрока(ЭлементТекста,, WebЦвета.Белый, WebЦвета.Черный);\r\nКонецЕсли;\n\n{22} Переменной ЭлементТекста присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в размероклада: размероклада\r\nОрфографическая ошибка в недельнаяставканорма: недельнаяставканорма\r\nОрфографическая ошибка в недельнаяставкафакт: недельнаяставкафакт\r\nОрфографическая ошибка в отработанодней: отработанодней\r\nОрфографическая ошибка в отработаночасов: отработаночасов"
  },
  {
    "title": "Программная эмуляция нажатий на кнопки клавиатуры",
    "description": "Программная эмуляция нажатий на кнопки клавиатуры",
    "code_snippet": "WSHShell = Новый COMОбъект(\"WScript.Shell\");\r\nWSHShell.SendKeys(\"{UP}\");\n\nWSHShell = Новый COMОбъект(\"WScript.Shell\");\r\nWSHShell.SendKeys(\"{UP}\");"
  },
  {
    "title": "Отладить внешнюю обработку",
    "description": "Отладить внешнюю обработку",
    "code_snippet": "//Общий модуль ДополнительныеОтчетыИОбработки.ПодключитьВнешнююОбработку\r\n\r\nФункция ПодключитьВнешнююОбработку(Ссылка) Экспорт\r\n\r\n        СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр(\"ru = 'Подключение, БезопасныйРежим = \"\"%1\"\".'\"), БезопасныйРежим));\r\n\r\n        //ИмяОбработки = Менеджер.Подключить(АдресВоВременномХранилище, , БезопасныйРежим,\r\n\r\n        //ОбщегоНазначения.ОписаниеЗащитыБезПредупреждений());\r\n\r\n        ИмяОбработки = Менеджер.Создать(\"C:\\1C\\МояОбработка.epf\", Ложь);\r\n\r\n        ИмяОбработки = \"МояОбработка\";\r\n\r\n        Возврат ИмяОбработки;\r\n\r\n       \r\n\r\nКонецФункции\n\n//Общий модуль ДополнительныеОтчетыИОбработки.ПодключитьВнешнююОбработку\r\n\r\nФункция ПодключитьВнешнююОбработку(Ссылка) Экспорт\r\n\r\n        СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр(\"ru = 'Подключение, БезопасныйРежим = \"\"%1\"\".'\"), БезопасныйРежим));\r\n\r\n        //ИмяОбработки = Менеджер.Подключить(АдресВоВременномХранилище, , БезопасныйРежим,\r\n\r\n        //ОбщегоНазначения.ОписаниеЗащитыБезПредупреждений());\r\n\r\n        ИмяОбработки = Менеджер.Создать(\"C:\\1C\\МояОбработка.epf\", Ложь);\r\n\r\n        ИмяОбработки = \"МояОбработка\";\r\n\r\n        Возврат ИмяОбработки;\r\n\r\n       \r\n\r\nКонецФункции\n\n{5} Ожидается идентификатор"
  },
  {
    "title": "Выполнить копирование документа",
    "description": "Выполнить копирование документа",
    "code_snippet": "ИсправлениеДокументовЗарплатаКадры.СкопироватьДокумент(Приемник, Источник, ИсключаемыеСвойства = \"\", ИсключаемыеТабличныеЧасти = \"\", ДанныеЗаполнения = Неопределено) Экспорт;\n\nИсправлениеДокументовЗарплатаКадры.СкопироватьДокумент(Приемник, Источник, ИсключаемыеСвойства = \"\", ИсключаемыеТабличныеЧасти = \"\", ДанныеЗаполнения = Неопределено) Экспорт;\n\n{1} Ожидается идентификатор"
  },
  {
    "title": "Вернуть значения реквизитов объекта",
    "description": "Вернуть значения реквизитов объекта",
    "code_snippet": "ЗначенияРеквизитов = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Данные.ФизическоеЛицо, \"ФИО,Фамилия,Имя,Отчество,УточнениеНаименования\");\r\n\r\nФИО = Новый Структура(\"Фамилия,Имя,Отчество\");\r\n\r\nЗаполнитьЗначенияСвойств(ФИО, ЗначенияРеквизитов);\n\nЗначенияРеквизитов = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Данные.ФизическоеЛицо, \"ФИО,Фамилия,Имя,Отчество,УточнениеНаименования\");\r\n\r\nФИО = Новый Структура(\"Фамилия,Имя,Отчество\");\r\n\r\nЗаполнитьЗначенияСвойств(ФИО, ЗначенияРеквизитов);"
  },
  {
    "title": "Дополнить таблицу значений - приемника данными из таблицы значений - источника",
    "description": "Дополнить таблицу значений - приемника данными из таблицы значений - источника",
    "code_snippet": "ОбщегоНазначенияКлиентСервер.ДополнитьТаблицу(ТаблицаИсточник, ТаблицаПриемник);\n\nОбщегоНазначенияКлиентСервер.ДополнитьТаблицу(ТаблицаИсточник, ТаблицаПриемник);"
  },
  {
    "title": "Дополнить массив МассивПриемник значениями из массива МассивИсточник",
    "description": "Дополнить массив МассивПриемник значениями из массива МассивИсточник",
    "code_snippet": "ОбщегоНазначенияКлиентСервер.ДополнитьМассив(МассивПриемник, МассивИсточник, Истина);\n\nОбщегоНазначенияКлиентСервер.ДополнитьМассив(МассивПриемник, МассивИсточник, Истина);"
  },
  {
    "title": "Преобразовать адрес формата XML контактной информации в структуру старого формата",
    "description": "Преобразовать адрес формата XML контактной информации в структуру старого формата",
    "code_snippet": "СтруктураАдреса = ЗарплатаКадры.СтруктураАдресаИзXML(Адрес,\r\n\r\nПредопределенноеЗначение(\"Справочник.ВидыКонтактнойИнформации.ПочтовыйАдресОрганизации\"));\r\n\r\nАдрес = СтруктураАдреса.Представление;\n\nСтруктураАдреса = ЗарплатаКадры.СтруктураАдресаИзXML(Адрес,\r\n\r\nПредопределенноеЗначение(\"Справочник.ВидыКонтактнойИнформации.ПочтовыйАдресОрганизации\"));\r\n\r\nАдрес = СтруктураАдреса.Представление;\n\n{5} Переменной Адрес присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Преобразовать таблицу значений в массив",
    "description": "Преобразовать таблицу значений в массив",
    "code_snippet": "мсДанных = Новый Массив;\r\n\r\nДля Каждого СтрокаТЗ Из тзДанных Цикл   \r\n\r\n    стСтрокаТаблицы = Новый Структура;\r\n\r\n    Для Каждого ИмяКолонки Из тзДанных.Колонки Цикл\r\n\r\n        стСтрокаТаблицы.Вставить(ИмяКолонки.Имя, СтрокаТЗ[ИмяКолонки.Имя]);\r\n\r\n    КонецЦикла;   \r\n\r\n    мсДанных.Добавить(стСтрокаТаблицы);   \r\n\r\nКонецЦикла;\n\nмсДанных = Новый Массив;\r\n\r\nДля Каждого СтрокаТЗ Из тзДанных Цикл   \r\n\r\n    стСтрокаТаблицы = Новый Структура;\r\n\r\n    Для Каждого ИмяКолонки Из тзДанных.Колонки Цикл\r\n\r\n        стСтрокаТаблицы.Вставить(ИмяКолонки.Имя, СтрокаТЗ[ИмяКолонки.Имя]);\r\n\r\n    КонецЦикла;   \r\n\r\n    мсДанных.Добавить(стСтрокаТаблицы);   \r\n\r\nКонецЦикла;"
  },
  {
    "title": "Программное добавление возможности отбора в динамический список формы",
    "description": "Программное добавление возможности отбора в динамический список формы",
    "code_snippet": "Если Не Пользователи.РолиДоступны(\"ИспользованиеДополнительныхРеквизитов\") Тогда\r\n\r\n        Форма.Список.ТекстЗапроса = Форма.Список.ТекстЗапроса + \"\r\n\r\n        |ГДЕ\r\n\r\n        |       Документ.НужныйРеквизит = ЛОЖЬ\";\r\n\r\nКонецЕсли;\n\nЕсли Не Пользователи.РолиДоступны(\"ИспользованиеДополнительныхРеквизитов\") Тогда\r\n\r\n        Форма.Список.ТекстЗапроса = Форма.Список.ТекстЗапроса + \"\r\n\r\n        |ГДЕ\r\n\r\n        |       Документ.НужныйРеквизит = ЛОЖЬ\";\r\n\r\nКонецЕсли;"
  },
  {
    "title": "Динамическое добавление реквизита на форму из общего модуля",
    "description": "Динамическое добавление реквизита на форму из общего модуля",
    "code_snippet": "ЗарплатаКадрыРасширенный.МногофункциональныеДокументыДобавитьЭлементыФормы(Форма, НСтр(\"ru='Новый'\"), \"ГруппаНовых\", \"Новый\");\r\n\r\nЭлементы.Новый.ПоложениеЗаголовка = ПоложениеЗаголовкаЭлементаФормы.Лево;\r\n\r\nЭлементы.Новый.Доступность = Пользователи.РолиДоступны(\"ДобавлениеНовых\");\n\nЗарплатаКадрыРасширенный.МногофункциональныеДокументыДобавитьЭлементыФормы(Форма, НСтр(\"ru='Новый'\"), \"ГруппаНовых\", \"Новый\");\r\n\r\nЭлементы.Новый.ПоложениеЗаголовка = ПоложениеЗаголовкаЭлементаФормы.Лево;\r\n\r\nЭлементы.Новый.Доступность = Пользователи.РолиДоступны(\"ДобавлениеНовых\");"
  },
  {
    "title": "Создать временную таблицу \"Штатное расписание\"",
    "description": "Создать временную таблицу \"Штатное расписание\"",
    "code_snippet": "ПараметрыТаблицы = КадровыйУчет.ПараметрыПолученияВсехСотрудниковОрганизацийПоСпискуФизическихЛиц();\r\n\r\nПараметрыТаблицы.Организация = СтруктураПараметров.Организация;\r\n\r\nПараметрыТаблицы.НачалоПериода = СтруктураПараметров.Дата;\r\n\r\nПараметрыТаблицы.ОкончаниеПериода = СтруктураПараметров.Дата;\r\n\r\nКадровыйУчет.СоздатьВТСотрудникиОрганизации(МенеджерВТ, Истина, ПараметрыТаблицы, \"ВТСотрудникиПредварительно\");\r\n\r\nЗапрос.Текст =\r\n\r\n        \"ВЫБРАТЬ\r\n\r\n        |       *\r\n\r\n        |ПОМЕСТИТЬ ВТСотрудники\r\n\r\n        |ИЗ\r\n\r\n        |       ВТСотрудникиПредварительно КАК ВТСотрудникиПредварительно\r\n\r\n        |ГДЕ\r\n\r\n        |       ВТСотрудникиПредварительно.ДатаУвольнения = ДАТАВРЕМЯ(1,1,1)\r\n\r\n        |;\r\n\r\n        |УНИЧТОЖИТЬ ВТСотрудникиПредварительно\r\n\r\n        |\";\r\n\r\nЗапрос.Выполнить();\r\n\r\nПараметрыТаблицы = УправлениеШтатнымРасписанием.ПараметрыПостроенияВТШтатноеРасписание(СтруктураПараметров.Дата, СтруктураПараметров.Организация);\r\n\r\nПараметрыТаблицы.ДополнитьОписаниемНачислений = Истина;\r\n\r\nПараметрыТаблицы.ПолноеОписаниеНачислений = Истина;\r\n\r\nПараметрыТаблицы.Вставить(\"ПоказыватьПлановыеПозиции\");\r\n\r\n \r\n\r\nУправлениеШтатнымРасписанием.СоздатьВТШтатноеРасписание(МенеджерВТ, Истина, ПараметрыТаблицы, , \"ВТВыбраныПозицииШР\");\n\nПараметрыТаблицы = КадровыйУчет.ПараметрыПолученияВсехСотрудниковОрганизацийПоСпискуФизическихЛиц();\r\n\r\nПараметрыТаблицы.Организация = СтруктураПараметров.Организация;\r\n\r\nПараметрыТаблицы.НачалоПериода = СтруктураПараметров.Дата;\r\n\r\nПараметрыТаблицы.ОкончаниеПериода = СтруктураПараметров.Дата;\r\n\r\nКадровыйУчет.СоздатьВТСотрудникиОрганизации(МенеджерВТ, Истина, ПараметрыТаблицы, \"ВТСотрудникиПредварительно\");\r\n\r\nЗапрос.Текст =\r\n\r\n        \"ВЫБРАТЬ\r\n\r\n        |       *\r\n\r\n        |ПОМЕСТИТЬ ВТСотрудники\r\n\r\n        |ИЗ\r\n\r\n        |       ВТСотрудникиПредварительно КАК ВТСотрудникиПредварительно\r\n\r\n        |ГДЕ\r\n\r\n        |       ВТСотрудникиПредварительно.ДатаУвольнения = ДАТАВРЕМЯ(1,1,1)\r\n\r\n        |;\r\n\r\n        |УНИЧТОЖИТЬ ВТСотрудникиПредварительно\r\n\r\n        |\";\r\n\r\nЗапрос.Выполнить();\r\n\r\nПараметрыТаблицы = УправлениеШтатнымРасписанием.ПараметрыПостроенияВТШтатноеРасписание(СтруктураПараметров.Дата, СтруктураПараметров.Организация);\r\n\r\nПараметрыТаблицы.ДополнитьОписаниемНачислений = Истина;\r\n\r\nПараметрыТаблицы.ПолноеОписаниеНачислений = Истина;\r\n\r\nПараметрыТаблицы.Вставить(\"ПоказыватьПлановыеПозиции\");\r\n\r\n \r\n\r\nУправлениеШтатнымРасписанием.СоздатьВТШтатноеРасписание(МенеджерВТ, Истина, ПараметрыТаблицы, , \"ВТВыбраныПозицииШР\");"
  },
  {
    "title": "Создать временную таблицу, с данными учета времени и состояний сотрудников",
    "description": "Создать временную таблицу, с данными учета времени и состояний сотрудников",
    "code_snippet": "ПараметрыЗаполнения = УчетРабочегоВремениРасширенный.ПараметрыДляЗапросВТДанныеУчетаВремениИСостоянийСотрудников();\r\n\r\nПараметрыЗаполнения.ИмяВТСотрудники = \"ВТСотрудникиПериоды\";\r\n\r\nПараметрыЗаполнения.ИмяВТРезультат = \"ВТУчетРабочегоВремениПолный\";\r\n\r\nПараметрыЗаполнения.РассчитыватьПлановоеВремя = Истина;\r\n\r\nПараметрыЗаполнения.ДатаАктуальности  = ПериодПланирования;\r\n\r\nПараметрыЗаполнения.ДатаНачала = АнализируемыйГод;\r\n\r\nПараметрыЗаполнения.ДатаОкончания = КонецГода(АнализируемыйГод);\r\n\r\nПараметрыЗаполнения.МесяцДатаНачала = АнализируемыйГод;\r\n\r\nПараметрыЗаполнения.МесяцДатаОкончания = КонецГода(АнализируемыйГод);\r\n\r\nПараметрыЗаполнения.ВыделятьВыходныеВПериодыОтклонений = Ложь;\r\n\r\nУчетРабочегоВремениРасширенный.СоздатьВТДанныеУчетаВремениИСостоянийСотрудников(Запрос.МенеджерВременныхТаблиц, Истина, ПараметрыЗаполнения);\n\nПараметрыЗаполнения = УчетРабочегоВремениРасширенный.ПараметрыДляЗапросВТДанныеУчетаВремениИСостоянийСотрудников();\r\n\r\nПараметрыЗаполнения.ИмяВТСотрудники = \"ВТСотрудникиПериоды\";\r\n\r\nПараметрыЗаполнения.ИмяВТРезультат = \"ВТУчетРабочегоВремениПолный\";\r\n\r\nПараметрыЗаполнения.РассчитыватьПлановоеВремя = Истина;\r\n\r\nПараметрыЗаполнения.ДатаАктуальности  = ПериодПланирования;\r\n\r\nПараметрыЗаполнения.ДатаНачала = АнализируемыйГод;\r\n\r\nПараметрыЗаполнения.ДатаОкончания = КонецГода(АнализируемыйГод);\r\n\r\nПараметрыЗаполнения.МесяцДатаНачала = АнализируемыйГод;\r\n\r\nПараметрыЗаполнения.МесяцДатаОкончания = КонецГода(АнализируемыйГод);\r\n\r\nПараметрыЗаполнения.ВыделятьВыходныеВПериодыОтклонений = Ложь;\r\n\r\nУчетРабочегоВремениРасширенный.СоздатьВТДанныеУчетаВремениИСостоянийСотрудников(Запрос.МенеджерВременныхТаблиц, Истина, ПараметрыЗаполнения);"
  },
  {
    "title": "Выполнить процедуру под полными правами",
    "description": "Выполнить процедуру под полными правами",
    "code_snippet": "УстановитьПривилегированныйРежим(Истина);\r\n\r\nОписательВТ = КадровыйУчетРасширенный.ОписательВременнойТаблицыОтборовДляВТСтажиФизическихЛиц(\"ВТИсходныеДанные\");\r\n\r\nОписательВТ.ИмяПоляВидСтажа = \"ВидСтажа\";\r\n\r\nКадровыйУчетРасширенный.СоздатьВТСтажиФизическихЛиц(Запрос.МенеджерВременныхТаблиц, Ложь, ОписательВТ, \"ВТСтажиФизическихЛиц\");\r\n \r\nУстановитьПривилегированныйРежим(Ложь);\n\nУстановитьПривилегированныйРежим(Истина);\r\n\r\nОписательВТ = КадровыйУчетРасширенный.ОписательВременнойТаблицыОтборовДляВТСтажиФизическихЛиц(\"ВТИсходныеДанные\");\r\n\r\nОписательВТ.ИмяПоляВидСтажа = \"ВидСтажа\";\r\n\r\nКадровыйУчетРасширенный.СоздатьВТСтажиФизическихЛиц(Запрос.МенеджерВременныхТаблиц, Ложь, ОписательВТ, \"ВТСтажиФизическихЛиц\");\r\n \r\nУстановитьПривилегированныйРежим(Ложь);"
  },
  {
    "title": "Узнать СпособОтраженияЗарплатыВБухучете у сотрудника",
    "description": "Узнать СпособОтраженияЗарплатыВБухучете у сотрудника",
    "code_snippet": "ОтражениеЗарплатыВБухучетеРасширенный.СоздатьВТСведенияОБухучетеЗарплатыСотрудников(Запрос.МенеджерВременныхТаблиц, \"ВТСотрудники\", \"Сотрудник,Период\", Организация);\n\nОтражениеЗарплатыВБухучетеРасширенный.СоздатьВТСведенияОБухучетеЗарплатыСотрудников(Запрос.МенеджерВременныхТаблиц, \"ВТСотрудники\", \"Сотрудник,Период\", Организация);"
  },
  {
    "title": "Узнать версию библиотеки стандартных подсистем - БСП",
    "description": "Узнать версию библиотеки стандартных подсистем - БСП",
    "code_snippet": "ОбновлениеИнформационнойБазыБСП.ПриДобавленииПодсистемы(Описание)\r\n\r\nПроцедура ПриДобавленииПодсистемы(Описание) Экспорт\r\n\r\n        Описание.Имя    = \"СтандартныеПодсистемы\";\r\n\r\n        Описание.Версия = \"3.0.3.43\";\r\n\r\n        Описание.ИдентификаторИнтернетПоддержки = \"SSL\";\r\n\r\n        Описание.РежимВыполненияОтложенныхОбработчиков = \"Параллельно\";\r\n\r\n        Описание.ПараллельноеОтложенноеОбновлениеСВерсии = \"2.3.3.0\";\r\n\r\nКонецПроцедуры\n\nОбновлениеИнформационнойБазыБСП.ПриДобавленииПодсистемы(Описание)\r\n\r\nПроцедура ПриДобавленииПодсистемы(Описание) Экспорт\r\n\r\n        Описание.Имя    = \"СтандартныеПодсистемы\";\r\n\r\n        Описание.Версия = \"3.0.3.43\";\r\n\r\n        Описание.ИдентификаторИнтернетПоддержки = \"SSL\";\r\n\r\n        Описание.РежимВыполненияОтложенныхОбработчиков = \"Параллельно\";\r\n\r\n        Описание.ПараллельноеОтложенноеОбновлениеСВерсии = \"2.3.3.0\";\r\n\r\nКонецПроцедуры\n\n{1} Ожидается идентификатор"
  },
  {
    "title": "Подключение внешней обработки/отчета, пример оформления модуля объекта",
    "description": "Подключение внешней обработки/отчета, пример оформления модуля объекта",
    "code_snippet": "#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда\r\n\r\n#Область СлужебныеПроцедурыИФункции\r\n\r\nФункция СведенияОВнешнейОбработке() Экспорт\r\n\r\nПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(\"2.4.4.106\");\r\n\r\nПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка();\r\n\r\n        ПараметрыРегистрации.Версия = \"1.0\";\r\n\r\n        ПараметрыРегистрации.БезопасныйРежим = Истина;\r\n\r\n        ПараметрыРегистрации.Наименование = НСтр(\"ru = 'Добавляемая обработка'\");\r\n\r\n        НоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n\r\n        НоваяКоманда.Представление = НСтр(\"ru = 'Имя команды обработки'\");\r\n\r\n        НоваяКоманда.Идентификатор = \"ИдентификаторКоманды\";\r\n\r\nНоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();\r\n\r\n        НоваяКоманда.ПоказыватьОповещение = Истина;\r\n\r\n        Возврат ПараметрыРегистрации;\r\n\r\nКонецФункции\r\n\r\n#КонецОбласти\r\n\r\n#КонецЕсли\n\n#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда\r\n\r\n#Область СлужебныеПроцедурыИФункции\r\n\r\nФункция СведенияОВнешнейОбработке() Экспорт\r\n\r\nПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке(\"2.4.4.106\");\r\n\r\nПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка();\r\n\r\n        ПараметрыРегистрации.Версия = \"1.0\";\r\n\r\n        ПараметрыРегистрации.БезопасныйРежим = Истина;\r\n\r\n        ПараметрыРегистрации.Наименование = НСтр(\"ru = 'Добавляемая обработка'\");\r\n\r\n        НоваяКоманда = ПараметрыРегистрации.Команды.Добавить();\r\n\r\n        НоваяКоманда.Представление = НСтр(\"ru = 'Имя команды обработки'\");\r\n\r\n        НоваяКоманда.Идентификатор = \"ИдентификаторКоманды\";\r\n\r\nНоваяКоманда.Использование = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();\r\n\r\n        НоваяКоманда.ПоказыватьОповещение = Истина;\r\n\r\n        Возврат ПараметрыРегистрации;\r\n\r\nКонецФункции\r\n\r\n#КонецОбласти\r\n\r\n#КонецЕсли"
  },
  {
    "title": "Возвращает сумму значений в поле [ИмяПоля] всех элементов коллекции",
    "description": "Возвращает сумму значений в поле [ИмяПоля] всех элементов коллекции",
    "code_snippet": "УчетСреднегоЗаработкаКлиентСервер.ИтогиПоПолю(Коллекция, ИмяПоля)\n\nУчетСреднегоЗаработкаКлиентСервер.ИтогиПоПолю(Коллекция, ИмяПоля)"
  },
  {
    "title": "Полный путь до предопределенного значения, включая имя самого значения",
    "description": "Полный путь до предопределенного значения, включая имя самого значения",
    "code_snippet": "ТекущиеДанные.СпособКомпенсацииПереработки = ПредопределенноеЗначение(\"Перечисление.СпособыКомпенсацииПереработки.ПовышеннаяОплата\")\n\nТекущиеДанные.СпособКомпенсацииПереработки = ПредопределенноеЗначение(\"Перечисление.СпособыКомпенсацииПереработки.ПовышеннаяОплата\")"
  },
  {
    "title": "Проверка заполнения на клиенте",
    "description": "Проверка заполнения на клиенте",
    "code_snippet": "Если НЕ ПроверитьЗаполнение() Тогда\r\n\r\n     Возврат;\r\n\r\nКонецЕсли;\n\nЕсли НЕ ПроверитьЗаполнение() Тогда\r\n\r\n     Возврат;\r\n\r\nКонецЕсли;"
  },
  {
    "title": "Кадровые данные физических лиц",
    "description": "Кадровые данные физических лиц",
    "code_snippet": "#Область КадровыеДанныеФизическихЛиц\r\n\r\nКадровыйУчетРасширенный.ЗапросВТКадровыеДанныеСотрудников\r\n\r\n...\r\n\r\n#КонецОбласти\n\n#Область КадровыеДанныеФизическихЛиц\r\n\r\nКадровыйУчетРасширенный.ЗапросВТКадровыеДанныеСотрудников\r\n\r\n...\r\n\r\n#КонецОбласти\n\n{5} Ожидается идентификатор"
  },
  {
    "title": "Массив видов рабочего времени, отражающих норму времени для суммированного учета рабочего времени",
    "description": "Массив видов рабочего времени, отражающих норму времени для суммированного учета рабочего времени",
    "code_snippet": "//Это рабочее время + выходные + время, когда сотрудник отсутствовал по своей вине.\r\n\r\nУчетРабочегоВремениРасширенный.ВидыВремениВЗачетНормыСуммированногоУчета()\n\n//Это рабочее время + выходные + время, когда сотрудник отсутствовал по своей вине.\r\n\r\nУчетРабочегоВремениРасширенный.ВидыВремениВЗачетНормыСуммированногоУчета()"
  },
  {
    "title": "Массив видов рабочего времени, отражающих отработанное время",
    "description": "Массив видов рабочего времени, отражающих отработанное время",
    "code_snippet": "УчетРабочегоВремениРасширенный.ВидыВремениОтработанноеВремяДляСуммированногоУчета()\n\nУчетРабочегоВремениРасширенный.ВидыВремениОтработанноеВремяДляСуммированногоУчета()"
  },
  {
    "title": "Возвращает соответствие имен предопределенных значений по ссылкам на них",
    "description": "Возвращает соответствие имен предопределенных значений по ссылкам на них",
    "code_snippet": "ПредопределенныеЗначения = СтандартныеПодсистемыПовтИсп.СсылкиПоИменамПредопределенных(СПРАВОЧНИК.ВИДЫИСПОЛЬЗОВАНИЯРАБОЧЕГОВРЕМЕНИ);\n\nПредопределенныеЗначения = СтандартныеПодсистемыПовтИсп.СсылкиПоИменамПредопределенных(СПРАВОЧНИК.ВИДЫИСПОЛЬЗОВАНИЯРАБОЧЕГОВРЕМЕНИ);\n\n{1} Переменной ПредопределенныеЗначения присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Начисления",
    "description": "Начисления",
    "code_snippet": "// 1.\r\n\r\nСотрудникиДаты = тзТаблица.Скопировать(, \"Объект, Период\");\r\n\r\nСотрудникиДаты.Колонки.Объект.Имя = \"Сотрудник\";\r\n\r\nТекущиеДанныеОплатыТруда = ПлановыеНачисленияСотрудников.ТекущиеДанныеОплатыТрудаСотрудников(Параметры.Объект.Ссылка, СотрудникиДаты);\r\n\r\n// 2.\r\n\r\nДанныеНачислений = ЗарплатаКадрыРасширенный.ДействующиеНачисленияСотрудников(СотрудникиДаты, Параметры.Объект.Ссылка);\n\n// 1.\r\n\r\nСотрудникиДаты = тзТаблица.Скопировать(, \"Объект, Период\");\r\n\r\nСотрудникиДаты.Колонки.Объект.Имя = \"Сотрудник\";\r\n\r\nТекущиеДанныеОплатыТруда = ПлановыеНачисленияСотрудников.ТекущиеДанныеОплатыТрудаСотрудников(Параметры.Объект.Ссылка, СотрудникиДаты);\r\n\r\n// 2.\r\n\r\nДанныеНачислений = ЗарплатаКадрыРасширенный.ДействующиеНачисленияСотрудников(СотрудникиДаты, Параметры.Объект.Ссылка);\n\n{7} Переменной ТекущиеДанныеОплатыТруда присвоено значение, но оно нигде не используется\r\n{11} Переменной ДанныеНачислений присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Возвращает ссылку на общий модуль по имени",
    "description": "Возвращает ссылку на общий модуль по имени",
    "code_snippet": "Модуль = ОбщегоНазначения.ОбщийМодуль(\"УправленческаяЗарплата\");\n\nМодуль = ОбщегоНазначения.ОбщийМодуль(\"УправленческаяЗарплата\");\n\n{1} Переменной Модуль присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Получает значение реквизита формы",
    "description": "Получает значение реквизита формы",
    "code_snippet": "Таблица = ОбщегоНазначенияКлиентСервер.ПолучитьРеквизитФормыПоПути(ЭтотОбъект, ИмяТаблицы);\n\nТаблица = ОбщегоНазначенияКлиентСервер.ПолучитьРеквизитФормыПоПути(ЭтотОбъект, ИмяТаблицы);\n\n{1} Переменной Таблица присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Проверяет корректность вводимых дат, не проверяет заполненность дат",
    "description": "Проверяет корректность вводимых дат, не проверяет заполненность дат",
    "code_snippet": "ЗарплатаКадры.ПроверитьКорректностьДаты(Ссылка, ДатаНачала, \"Объект.ДатаНачала\", Отказ, НСтр(\"ru='Новая дата начала'\"), , , Ложь);\n\nЗарплатаКадры.ПроверитьКорректностьДаты(Ссылка, ДатаНачала, \"Объект.ДатаНачала\", Отказ, НСтр(\"ru='Новая дата начала'\"), , , Ложь);"
  },
  {
    "title": "Получает ссылку предопределенного элемента по его полному имени",
    "description": "Получает ссылку предопределенного элемента по его полному имени",
    "code_snippet": "// 1.\r\n\r\nОбщегоНазначенияКлиентСервер.ПредопределенныйЭлемент(\"Справочник.ВидыИспользованияРабочегоВремени.РаботаНочныеЧасы\");\r\n\r\n// 2.\r\n\r\nОбщегоНазначения.ПредопределенныйЭлемент(\"Справочник.ВидыИспользованияРабочегоВремени.РабочееВремя\");\n\n// 1.\r\n\r\nОбщегоНазначенияКлиентСервер.ПредопределенныйЭлемент(\"Справочник.ВидыИспользованияРабочегоВремени.РаботаНочныеЧасы\");\r\n\r\n// 2.\r\n\r\nОбщегоНазначения.ПредопределенныйЭлемент(\"Справочник.ВидыИспользованияРабочегоВремени.РабочееВремя\");"
  },
  {
    "title": "Подставляет параметры в строку",
    "description": "Подставляет параметры в строку",
    "code_snippet": "ТекстОшибки = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(ТекстОшибкиШаблон, Выборка.СотрудникНаименование, Формат(Выборка.Дата, \"ДФ='dd.MM.yyyy \"\"г.\"\"'\"), Выборка.ВидВремениНаименование);\n\nТекстОшибки = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(ТекстОшибкиШаблон, Выборка.СотрудникНаименование, Формат(Выборка.Дата, \"ДФ='dd.MM.yyyy \"\"г.\"\"'\"), Выборка.ВидВремениНаименование);\n\n{1} Переменной ТекстОшибки присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Возвращает виды времени сплошной регистрации в массиве",
    "description": "Возвращает виды времени сплошной регистрации в массиве",
    "code_snippet": "УчетРабочегоВремениРасширенный.ВидыВремениСплошнойРегистрации()\n\nУчетРабочегоВремениРасширенный.ВидыВремениСплошнойРегистрации()"
  },
  {
    "title": "Очищает записи наборов из коллекции Движения и проставляет флаг Записывать наборам, по которым документ уже имеет движения",
    "description": "Очищает записи наборов из коллекции Движения и проставляет флаг Записывать наборам, по которым документ уже имеет движения",
    "code_snippet": "ПроведениеСервер.ПодготовитьНаборыЗаписейКРегистрацииДвижений(ЭтотОбъект);\n\nПроведениеСервер.ПодготовитьНаборыЗаписейКРегистрацииДвижений(ЭтотОбъект);"
  },
  {
    "title": "Устанавливает текст заголовка, отображаемого, когда группа свернута",
    "description": "Устанавливает текст заголовка, отображаемого, когда группа свернута",
    "code_snippet": "ЗарплатаКадры.НастроитьОтображениеГруппыПодписей(Элементы.ПодписиГруппа, \"Объект.Руководитель\", \"Объект.ГлавныйБухгалтер\");\n\nЗарплатаКадры.НастроитьОтображениеГруппыПодписей(Элементы.ПодписиГруппа, \"Объект.Руководитель\", \"Объект.ГлавныйБухгалтер\");"
  },
  {
    "title": "Ищет по имени временную таблицу в менеджере",
    "description": "Ищет по имени временную таблицу в менеджере",
    "code_snippet": "ЗарплатаКадры.ВТСуществует(МенеджерВременныхТаблиц, \"ВТПоказателиРасчета\")\n\nЗарплатаКадры.ВТСуществует(МенеджерВременныхТаблиц, \"ВТПоказателиРасчета\")"
  },
  {
    "title": "Создание и инициализация менеджера расчета зарплаты",
    "description": "Создание и инициализация менеджера расчета зарплаты",
    "code_snippet": "МенеджерРасчета = РасчетЗарплатыРасширенный.СоздатьМенеджерРасчета(МесяцНачисления, Организация);\n\nМенеджерРасчета = РасчетЗарплатыРасширенный.СоздатьМенеджерРасчета(МесяцНачисления, Организация);\n\n{1} Переменной МенеджерРасчета присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Проверка реквизита, элемента формы на существование",
    "description": "Проверка реквизита, элемента формы на существование",
    "code_snippet": "// 1.\r\nСтруктураПараметров.Свойство(\"ЗначенияРазовыхПоказателей\", ЗначенияРазовыхПоказателей)\r\n\r\n// 2.\r\nЭлементы.Найти(\"ИсполнителиРабот\")\n\n// 1.\r\nСтруктураПараметров.Свойство(\"ЗначенияРазовыхПоказателей\", ЗначенияРазовыхПоказателей)\r\n\r\n// 2.\r\nЭлементы.Найти(\"ИсполнителиРабот\")"
  },
  {
    "title": "Создает временную таблицу по набору записей",
    "description": "Создает временную таблицу по набору записей",
    "code_snippet": "ЗарплатаКадры.СоздатьВТПоНаборуЗаписей(Запрос.МенеджерВременныхТаблиц, Движения.СведенияОДоходахНДФЛ, Истина, \"ВТПеренесенныеДоходы\");\n\nЗарплатаКадры.СоздатьВТПоНаборуЗаписей(Запрос.МенеджерВременныхТаблиц, Движения.СведенияОДоходахНДФЛ, Истина, \"ВТПеренесенныеДоходы\");"
  },
  {
    "title": "Получить значение реквизита объектов (&НаСервере)",
    "description": "Получить значение реквизита объектов (&НаСервере)",
    "code_snippet": "ФизическиеЛицаПодобранныхСотрудников = ОбщегоНазначения.ЗначениеРеквизитаОбъектов(МассивСотрудников, \"ФизическоеЛицо\");\n\nФизическиеЛицаПодобранныхСотрудников = ОбщегоНазначения.ЗначениеРеквизитаОбъектов(МассивСотрудников, \"ФизическоеЛицо\");\n\n{1} Переменной ФизическиеЛицаПодобранныхСотрудников присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Возвращает полное имя объекта метаданных по переданному значению ссылки",
    "description": "Возвращает полное имя объекта метаданных по переданному значению ссылки",
    "code_snippet": "ИмяТаблицы = ОбщегоНазначения.ИмяТаблицыПоСсылке(Ссылка);\n\nИмяТаблицы = ОбщегоНазначения.ИмяТаблицыПоСсылке(Ссылка);\n\n{1} Переменной ИмяТаблицы присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Получает номер документа для вывода на печать; из номера удаляются префиксы и лидирующие нули",
    "description": "Получает номер документа для вывода на печать; из номера удаляются префиксы и лидирующие нули",
    "code_snippet": "ТабельныйНомер = ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(Сотрудник.Код, Истина, Истина)\n\nТабельныйНомер = ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(Сотрудник.Код, Истина, Истина)\n\n{1} Переменной ТабельныйНомер присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Проверка даты запрета изменения данных",
    "description": "Проверка даты запрета изменения данных",
    "code_snippet": "ДатыЗапретаИзменения.ПроверитьДатыЗапретаИзмененияДанных(Источник, Отказ, ИсточникРегистр = Ложь, Замещение = Истина, Удаление = Ложь)\n\nДатыЗапретаИзменения.ПроверитьДатыЗапретаИзмененияДанных(Источник, Отказ, ИсточникРегистр = Ложь, Замещение = Истина, Удаление = Ложь)"
  },
  {
    "title": "Создание временной таблицы \"КадровыеДанныеСотрудников\"",
    "description": "Создание временной таблицы \"КадровыеДанныеСотрудников\"",
    "code_snippet": "ОписательВТ = КадровыйУчет.ОписательВременныхТаблицДляСоздатьВТКадровыеДанныеСотрудников(Запрос.МенеджерВременныхТаблиц, \"ВТСотрудникиПериоды\");\r\n\r\nКадровыйУчет.СоздатьВТКадровыеДанныеСотрудников(ОписательВТ, Ложь, \"ТекущаяДолжность, ДатаПриема, ДатаУвольнения\");\n\nОписательВТ = КадровыйУчет.ОписательВременныхТаблицДляСоздатьВТКадровыеДанныеСотрудников(Запрос.МенеджерВременныхТаблиц, \"ВТСотрудникиПериоды\");\r\n\r\nКадровыйУчет.СоздатьВТКадровыеДанныеСотрудников(ОписательВТ, Ложь, \"ТекущаяДолжность, ДатаПриема, ДатаУвольнения\");"
  },
  {
    "title": "Значение в массиве",
    "description": "Значение в массиве",
    "code_snippet": "ФизЛица = ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(ФизЛицо);\n\nФизЛица = ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(ФизЛицо);\n\n{1} Переменной ФизЛица присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Открытие дополнительной формы",
    "description": "Открытие дополнительной формы",
    "code_snippet": "СотрудникиКлиент.ОткрытьДополнительнуюФорму(\r\n\r\nСотрудникиКлиентСервер.ОписаниеДополнительнойФормы(\"Справочник.МедицинскиеСтраховыеПолисы.Форма.ФормаПолисыПоСотруднику\"), ЭтотОбъект);\n\nСотрудникиКлиент.ОткрытьДополнительнуюФорму(\r\n\r\nСотрудникиКлиентСервер.ОписаниеДополнительнойФормы(\"Справочник.МедицинскиеСтраховыеПолисы.Форма.ФормаПолисыПоСотруднику\"), ЭтотОбъект);"
  },
  {
    "title": "Возврат значения реквизита объекта через точку",
    "description": "Возврат значения реквизита объекта через точку",
    "code_snippet": "ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Объект.ФизическоеЛицо, \"Наименование\");\n\nОбщегоНазначения.ЗначениеРеквизитаОбъекта(Объект.ФизическоеЛицо, \"Наименование\");"
  },
  {
    "title": "Получение данных из регистра сведений не запросом",
    "description": "Получение данных из регистра сведений не запросом",
    "code_snippet": "ДанныеОРаботнике = РегистрыСведений.РаботникиОрганизаций.СрезПоследних(ТекущаяДата(),Новый Структура(\"Сотрудник\", Сотрудник))\n\nДанныеОРаботнике = РегистрыСведений.РаботникиОрганизаций.СрезПоследних(ТекущаяДата(),Новый Структура(\"Сотрудник\", Сотрудник))\n\n{1} Переменной ДанныеОРаботнике присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Сообщение пользователю из модуля менеджера",
    "description": "Сообщение пользователю из модуля менеджера",
    "code_snippet": "ОбщегоНазначенияКлиентСервер.СообщитьПользователю(\r\n\r\n        СтрШаблон(\r\n\r\n               НСтр(\"ru = 'Код введен в неверном формате. Проведено преобразование из %1 в %2'\"),\r\n\r\n               СтрокаКод,\r\n\r\n               НовыйКод),\r\n\r\n        ,,,     Отказ);\n\nОбщегоНазначенияКлиентСервер.СообщитьПользователю(\r\n\r\n        СтрШаблон(\r\n\r\n               НСтр(\"ru = 'Код введен в неверном формате. Проведено преобразование из %1 в %2'\"),\r\n\r\n               СтрокаКод,\r\n\r\n               НовыйКод),\r\n\r\n        ,,,     Отказ);"
  },
  {
    "title": "Сообщение пользователю из модуля объекта с параметрами",
    "description": "Сообщение пользователю из модуля объекта с параметрами",
    "code_snippet": "ТекстСообщения = СтрШаблон(НСтр(\"ru = 'Текст сообщения'\"), СокрЛП(Код), Выборка.Организация, Выборка.Состояние);\r\n\r\nОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстСообщения,, \"Код\", \"Объект\", Отказ);\n\nТекстСообщения = СтрШаблон(НСтр(\"ru = 'Текст сообщения'\"), СокрЛП(Код), Выборка.Организация, Выборка.Состояние);\r\n\r\nОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстСообщения,, \"Код\", \"Объект\", Отказ);"
  },
  {
    "title": "vanessa-automation",
    "description": "vanessa-automation",
    "code_snippet": ""
  },
  {
    "title": "Получить ВТСотрудникиОрганизации - кадровые данные + дополнительные реквизиты кадровых данных",
    "description": "Получить ВТСотрудникиОрганизации - кадровые данные + дополнительные реквизиты кадровых данных",
    "code_snippet": "ПараметрыПолучения = КадровыйУчет.ПараметрыПолученияСотрудниковОрганизацийПоСпискуФизическихЛиц();\r\n\r\nПараметрыПолучения.Организация = Объект.Организация;\r\n\r\nПараметрыПолучения.НачалоПериода      = Объект.ПериодСуммированногоУчетаНачало;\r\n\r\nПараметрыПолучения.ОкончаниеПериода   = Объект.ПериодСуммированногоУчетаОкончание;\r\n\r\nПараметрыПолучения.КадровыеДанные     = ПараметрыПолучения.КадровыеДанные + \"Вахтовик, ВахтоваяКоманда, ГрафикРаботы\";\r\n\r\nЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\r\n        ПараметрыПолучения.Отборы, \"Вахтовик\", \"=\", Истина);\r\n\r\nЕсли ЗначениеЗаполнено(Объект.ВахтоваяКоманда) Тогда\r\n\r\n        ЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\r\nПараметрыПолучения.Отборы, \"ВахтоваяКоманда\", \"=\", Объект.ВахтоваяКоманда);\r\n\r\nКонецЕсли;\r\n\r\nКадровыйУчет.СоздатьВТСотрудникиОрганизации(Запрос.МенеджерВременныхТаблиц, Истина, ПараметрыПолучения);\n\nПараметрыПолучения = КадровыйУчет.ПараметрыПолученияСотрудниковОрганизацийПоСпискуФизическихЛиц();\r\n\r\nПараметрыПолучения.Организация = Объект.Организация;\r\n\r\nПараметрыПолучения.НачалоПериода      = Объект.ПериодСуммированногоУчетаНачало;\r\n\r\nПараметрыПолучения.ОкончаниеПериода   = Объект.ПериодСуммированногоУчетаОкончание;\r\n\r\nПараметрыПолучения.КадровыеДанные     = ПараметрыПолучения.КадровыеДанные + \"Вахтовик, ВахтоваяКоманда, ГрафикРаботы\";\r\n\r\nЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\r\n        ПараметрыПолучения.Отборы, \"Вахтовик\", \"=\", Истина);\r\n\r\nЕсли ЗначениеЗаполнено(Объект.ВахтоваяКоманда) Тогда\r\n\r\n        ЗарплатаКадрыОбщиеНаборыДанных.ДобавитьВКоллекциюОтбор(\r\n\r\nПараметрыПолучения.Отборы, \"ВахтоваяКоманда\", \"=\", Объект.ВахтоваяКоманда);\r\n\r\nКонецЕсли;\r\n\r\nКадровыйУчет.СоздатьВТСотрудникиОрганизации(Запрос.МенеджерВременныхТаблиц, Истина, ПараметрыПолучения);\n\nОрфографическая ошибка в Вахтовик (найдено 2): Вахтовик"
  },
  {
    "title": "Временная таблица периодического регистра с периодами",
    "description": "Временная таблица периодического регистра с периодами",
    "code_snippet": "ОписаниеФильтраПолученияГрафиков = ЗарплатаКадрыПериодическиеРегистры.ОписаниеФильтраДляСоздатьВТИмяРегистра(\"ВТПериодыЗапросаКадровойИстории\", \"ФизическоеЛицо\", \"ФизическоеЛицо\");\r\n\r\nЗарплатаКадрыПериодическиеРегистры.СоздатьВТИмяРегистраПериоды(\"КадроваяИсторияСотрудников\", МенеджерВременныхТаблиц, Ложь, ОписаниеФильтраПолученияГрафиков);\n\nОписаниеФильтраПолученияГрафиков = ЗарплатаКадрыПериодическиеРегистры.ОписаниеФильтраДляСоздатьВТИмяРегистра(\"ВТПериодыЗапросаКадровойИстории\", \"ФизическоеЛицо\", \"ФизическоеЛицо\");\r\n\r\nЗарплатаКадрыПериодическиеРегистры.СоздатьВТИмяРегистраПериоды(\"КадроваяИсторияСотрудников\", МенеджерВременныхТаблиц, Ложь, ОписаниеФильтраПолученияГрафиков);"
  },
  {
    "title": "Создать временную таблицу периодов с заданной периодичностью",
    "description": "Создать временную таблицу периодов с заданной периодичностью",
    "code_snippet": "ЗарплатаКадрыОбщиеНаборыДанных.СоздатьВТПериоды(Запрос.МенеджерВременныхТаблиц, НачалоПериода, ОкончаниеПериода);\r\n\r\nЗарплатаКадрыОбщиеНаборыДанных.СоздатьВТПериоды(МенеджерВременныхТаблиц, НачалоИнтервала, ОкончаниеИнтервала, Периодичность = \"МЕСЯЦ\", ИмяПоляПериод = \"Период\", ИмяВТ = \"ВТПериоды\", ИспользоватьКонецПериода = Ложь) Экспорт\n\nЗарплатаКадрыОбщиеНаборыДанных.СоздатьВТПериоды(Запрос.МенеджерВременныхТаблиц, НачалоПериода, ОкончаниеПериода);\r\n\r\nЗарплатаКадрыОбщиеНаборыДанных.СоздатьВТПериоды(МенеджерВременныхТаблиц, НачалоИнтервала, ОкончаниеИнтервала, Периодичность = \"МЕСЯЦ\", ИмяПоляПериод = \"Период\", ИмяВТ = \"ВТПериоды\", ИспользоватьКонецПериода = Ложь) Экспорт\n\n{3} Ожидается идентификатор"
  },
  {
    "title": "Удаление значения из массива",
    "description": "Удаление значения из массива",
    "code_snippet": "ОбщегоНазначенияКлиентСервер.УдалитьЗначениеИзМассива(ВидыВремениВЗачетНормыСуммированногоУчета, ОбщегоНазначенияКлиентСервер.ПредопределенныйЭлемент(\"Справочник.ВидыИспользованияРабочегоВремени.НеявкиПоНевыясненнымПричинам\"));\n\nОбщегоНазначенияКлиентСервер.УдалитьЗначениеИзМассива(ВидыВремениВЗачетНормыСуммированногоУчета, ОбщегоНазначенияКлиентСервер.ПредопределенныйЭлемент(\"Справочник.ВидыИспользованияРабочегоВремени.НеявкиПоНевыясненнымПричинам\"));"
  },
  {
    "title": "Сформировать сумму строкой в договор",
    "description": "Сформировать сумму строкой в договор",
    "code_snippet": "ОбластьМакета.Параметры.Сумма  = \"\"+окр(СведенияОДокументе.Сумма) + \" (\" + ЧислоПрописью(СведенияОДокументе.Сумма,\"Л=ru_RU\",\") рубль, ) рубля, ) рублей, м, копейка, копейки, копеек, ж, 2\");\n\nОбластьМакета.Параметры.Сумма  = \"\"+окр(СведенияОДокументе.Сумма) + \" (\" + ЧислоПрописью(СведенияОДокументе.Сумма,\"Л=ru_RU\",\") рубль, ) рубля, ) рублей, м, копейка, копейки, копеек, ж, 2\");"
  },
  {
    "title": "Перейти к началу/концу метода",
    "description": "Скрипт выполняет переход к началу/концу текущей процедуры или функции",
    "code_snippet": ""
  },
  {
    "title": "snippet-transform",
    "description": "Скрипт для работы с шаблонами кода",
    "code_snippet": ""
  },
  {
    "title": "СКД внешние источники данных",
    "description": "СКД внешние источники данных",
    "code_snippet": "Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\r\n\tТЗВывод = ПолучитьТЗДляСКД();\r\n\tСхемаКомпоновкиДанных = ПолучитьМакет(\"ОсновнаяСхемаКомпоновкиДанных\");\r\n\tНастройки = КомпоновщикНастроек.ПолучитьНастройки(); \r\n \r\n\tДанныеРасшифровки = Новый ДанныеРасшифровкиКомпоновкиДанных; \r\n \r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\t\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, Настройки, ДанныеРасшифровки);\t\r\n\t\r\n\tВнешнийНаборДанных = Новый Структура(\"ТЗ\", ТЗВывод); \r\n\tПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных; \r\n\tПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновки, ВнешнийНаборДанных, ДанныеРасшифровки); \r\n\t\r\n\tДокументРезультат.Очистить();\r\n\t\r\n \tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент; \r\n\tПроцессорВывода.УстановитьДокумент(ДокументРезультат); \r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);\r\nКонецПроцедуры\n\nПроцедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)\r\n\tТЗВывод = ПолучитьТЗДляСКД();\r\n\tСхемаКомпоновкиДанных = ПолучитьМакет(\"ОсновнаяСхемаКомпоновкиДанных\");\r\n\tНастройки = КомпоновщикНастроек.ПолучитьНастройки(); \r\n \r\n\tДанныеРасшифровки = Новый ДанныеРасшифровкиКомпоновкиДанных; \r\n \r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\t\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, Настройки, ДанныеРасшифровки);\t\r\n\t\r\n\tВнешнийНаборДанных = Новый Структура(\"ТЗ\", ТЗВывод); \r\n\tПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных; \r\n\tПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновки, ВнешнийНаборДанных, ДанныеРасшифровки); \r\n\t\r\n\tДокументРезультат.Очистить();\r\n\t\r\n \tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент; \r\n\tПроцессорВывода.УстановитьДокумент(ДокументРезультат); \r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);\r\nКонецПроцедуры\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Как получить дату и время создания элемента справочника, документа по ссылке",
    "description": "Как получить дату и время создания элемента справочника, документа по ссылке",
    "code_snippet": "// но по GUID можно определить время и дату\r\nФункция ДатаСозданияСсылки(Ссылка)\r\n    ГУИД = Ссылка.УникальныйИдентификатор();\r\n    Строка16 = Сред(ГУИД, 16, 3) + Сред(ГУИД, 10, 4) + Сред(ГУИД, 1, 8);\r\n    Разрядность = СтрДлина(Строка16);\r\n    ЧислоСек = 0;\r\n    Для Позиция = 1 По Разрядность Цикл\r\n        ЧислоСек = ЧислоСек + Найти(\"123456789abcdef\",Сред(Строка16,Позиция,1))*Pow(16,Разрядность - Позиция);\r\n    КонецЦикла;\r\n    ЧислоСек = ЧислоСек / 10000000;\r\n    Возврат Дата(1582, 10, 15, 04, 00, 00) + ЧислоСек;\r\nКонецФункции\n\n// но по GUID можно определить время и дату\r\nФункция ДатаСозданияСсылки(Ссылка)\r\n    ГУИД = Ссылка.УникальныйИдентификатор();\r\n    Строка16 = Сред(ГУИД, 16, 3) + Сред(ГУИД, 10, 4) + Сред(ГУИД, 1, 8);\r\n    Разрядность = СтрДлина(Строка16);\r\n    ЧислоСек = 0;\r\n    Для Позиция = 1 По Разрядность Цикл\r\n        ЧислоСек = ЧислоСек + Найти(\"123456789abcdef\",Сред(Строка16,Позиция,1))*Pow(16,Разрядность - Позиция);\r\n    КонецЦикла;\r\n    ЧислоСек = ЧислоСек / 10000000;\r\n    Возврат Дата(1582, 10, 15, 04, 00, 00) + ЧислоСек;\r\nКонецФункции"
  },
  {
    "title": "vanessa-automation-single",
    "description": "vanessa-automation-single",
    "code_snippet": ""
  },
  {
    "title": "Набор модифицированных скриптов для взаимодействия с хранилищем",
    "description": "Немного доработал скрипты взаимодействия с хранилищем под себя. Решил поделиться результатом. Авось кому-то пригодится.",
    "code_snippet": ""
  },
  {
    "title": "Генератор случайных чисел для диапазона с дробными и отрицательными числами",
    "description": "Генератор случайных чисел для диапазона с дробными и отрицательными числами",
    "code_snippet": "Функция Генератор(КоличествоСимволовПослеЗапятой = 0, НижняяГраница, ВерхняяГраница )\r\n\t\r\n\t\tМножитель = 1;\r\n\t\t\r\n\t\tПока КоличествоСимволовПослеЗапятой <> 0 Цикл\r\n\t\t\t\r\n\t\t\tКоличествоСимволовПослеЗапятой = КоличествоСимволовПослеЗапятой - 1;\r\n\t\t\t\r\n\t\t\tМножитель = Множитель*10;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tГенератор = Новый ГенераторСлучайныхЧисел();\r\n\t\t\r\n\t\tНижняяГраница = НижняяГраница * Множитель;\r\n\t\tВерхняяГраница = ВерхняяГраница * Множитель;\r\n\t\t\r\n\t\tЕсли НижняяГраница > ВерхняяГраница Тогда\r\n\t\t\t\r\n\t\t\tВозврат Неопределено;\r\n\t\t\r\n\t\tИначеЕсли НижняяГраница < 0 Тогда\r\n\t\t\t\r\n\t\t\tНижняяГраница = 0;\r\n\t\t\tВерхняяГраница = ВерхняяГраница - НижняяГраница;\r\n\t\t\t\r\n\t\t\tРезультатГенератора = Генератор.СлучайноеЧисло(НижняяГраница, ВерхняяГраница)/Множитель - НижняяГраница;\r\n\t\t\t\t\t\t\t\r\n\t\tИначеЕсли НижняяГраница >= 0 Тогда\r\n\t\t\t\r\n\t\t\tРезультатГенератора = Генератор.СлучайноеЧисло(НижняяГраница, ВерхняяГраница)/Множитель;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\tКонецЕсли;\r\n\r\n\t\tВозврат РезультатГенератора ;\r\n\r\nКонецФункции\n\nФункция Генератор(КоличествоСимволовПослеЗапятой = 0, НижняяГраница, ВерхняяГраница )\r\n\t\r\n\t\tМножитель = 1;\r\n\t\t\r\n\t\tПока КоличествоСимволовПослеЗапятой <> 0 Цикл\r\n\t\t\t\r\n\t\t\tКоличествоСимволовПослеЗапятой = КоличествоСимволовПослеЗапятой - 1;\r\n\t\t\t\r\n\t\t\tМножитель = Множитель*10;\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\t\tГенератор = Новый ГенераторСлучайныхЧисел();\r\n\t\t\r\n\t\tНижняяГраница = НижняяГраница * Множитель;\r\n\t\tВерхняяГраница = ВерхняяГраница * Множитель;\r\n\t\t\r\n\t\tЕсли НижняяГраница > ВерхняяГраница Тогда\r\n\t\t\t\r\n\t\t\tВозврат Неопределено;\r\n\t\t\r\n\t\tИначеЕсли НижняяГраница < 0 Тогда\r\n\t\t\t\r\n\t\t\tНижняяГраница = 0;\r\n\t\t\tВерхняяГраница = ВерхняяГраница - НижняяГраница;\r\n\t\t\t\r\n\t\t\tРезультатГенератора = Генератор.СлучайноеЧисло(НижняяГраница, ВерхняяГраница)/Множитель - НижняяГраница;\r\n\t\t\t\t\t\t\t\r\n\t\tИначеЕсли НижняяГраница >= 0 Тогда\r\n\t\t\t\r\n\t\t\tРезультатГенератора = Генератор.СлучайноеЧисло(НижняяГраница, ВерхняяГраница)/Множитель;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\tКонецЕсли;\r\n\r\n\t\tВозврат РезультатГенератора ;\r\n\r\nКонецФункции"
  },
  {
    "title": "gitsync-plugins",
    "description": "Встроенные плагины в gitsync",
    "code_snippet": ""
  },
  {
    "title": "v8rac",
    "description": "Библиотека для работы с консольной утилитой rac",
    "code_snippet": ""
  },
  {
    "title": "v8find",
    "description": "Библиотека для поиска установленных версий платформы 1С",
    "code_snippet": ""
  },
  {
    "title": "1connector",
    "description": "Удобный HTTP-клиент для oscript",
    "code_snippet": ""
  },
  {
    "title": "Автоподключение к хранилищу",
    "description": "Скрипт однократно запрашивает пароль от хранилища и в дальнейшем автоматически подставляет его в окно подключения к хранилищу.",
    "code_snippet": ""
  },
  {
    "title": "sonar-helper",
    "description": "Предоставляет набор утилит, помогающих при работе с SonarQube.",
    "code_snippet": ""
  },
  {
    "title": "crypto",
    "description": "Библиотека `crypto` для шифрования в OScript",
    "code_snippet": ""
  },
  {
    "title": "Захватить/поместить объект в хранилище",
    "description": "Скрипт добавляет возможность захватить или поместить текущий объект в хранилище, с помощью горячих клавиш.",
    "code_snippet": ""
  },
  {
    "title": "Вывод текста функции в подсказке",
    "description": "Вывод текста функции в подсказке",
    "code_snippet": ""
  },
  {
    "title": "Подключение к DBF",
    "description": "Подключение к DBF",
    "code_snippet": "Функция НовоеПодключение2()  //Подключение к DBF\r\n\tТаблица = Новый ТаблицаЗначений();\r\n\r\nConnection = Новый COMОбъект(\"ADODB.Connection\"); // Создание COM-объекта\r\n\tConnection.Open(\"Provider=Microsoft.Jet.OLEDB.4.0;\r\n\t         |Data Source=\" +КаталогФайла +\";\r\n\t         |Extended Properties=DBASE III\");    \r\n    Connection.BeginTrans();    \r\n   // Создание объекта выполнения команды\r\n    Command = Новый COMОбъект(\"ADODB.Command\");\r\n   // Указание активного соединения \r\n    Command.ActiveConnection = Connection;    \r\n   // Определение текста команды\r\n\r\n\tCommand.CommandText = \"SELECT * FROM Calls WHERE DATE between  @DataN AND @DataK\";  //Calls  -название файла DBF\r\n\tДата1 = Формат(НачПериода, \"ДФ=MM.dd.yyyy\");\r\n\tДата2 = Формат(КонПериода, \"ДФ=MM.dd.yyyy\");\r\n\t\r\n    Param1 = Command.CreateParameter(\"@DataN\", 133, 1);\r\n    Command.Parameters.Append(Param1);\r\n    Param1.Value = Дата1;\r\n\t\r\n\tParam2 = Command.CreateParameter(\"@DataK\", 133, 1);\r\n    Command.Parameters.Append(Param2);\r\n    Param2.Value = Дата2;\r\n\r\n   // Определение типа команды\r\n   //Command.CommandType = 4;\r\n   // Создание объекта набора записей\r\n    RecordSet = Новый COMОбъект(\"ADODB.RecordSet\");\r\n    RecordSet = Command.Execute();\r\n\t\r\n\tПока RecordSet.EOF=0 Цикл //Цикл по записям файла DBF\r\n\t        м= Таблица.Добавить();\r\n\t\tм.Дата \t\t\t   \t=  RecordSet.Fields(\"DATE\").Value;\r\n\t\tм.Длительность\t\t=  RecordSet.Fields(\"IDURATION\").Value ;\r\n\t\tм.Время\t           \t=  RecordSet.Fields(\"ITIME\").Value;\r\n\t\tм.СО              \t=  RecordSet.Fields(\"CO\").Value   ;\r\n\t\tм.ВнутрНомер        =  RecordSet.Fields(\"EXTENSION\").Value ;\r\n\t\tм.TrunkГруппа       =  RecordSet.Fields(\"TRUNKGROUP\").Value ;\r\n\t\tм.Transfer         \t=  RecordSet.Fields(\"TRANSFER\").Value   ;\r\n\t\tм.Цена            \t=  RecordSet.Fields(\"PRICE\").Value     ;\r\n\t\tм.Номер           \t=  RecordSet.Fields(\"NUMBER\").Value   ;\r\n\t\tм.Статус           \t=  RecordSet.Fields(\"STATUS\").Value   ;\r\n\t\tм.ВремяДоОтвета     =  RecordSet.Fields(\"RINGBEFORE\").Value ;\r\n\t\tм.CallerID         \t=  RecordSet.Fields(\"CALLERID\").Value  ;\r\n\t    RecordSet.MoveNext(); //Переходим к следующей записи\r\n\tКонецЦикла;\r\n\tRecordSet.Close();\r\n\r\nВозврат Таблица;\t\r\nКонецФункции\n\nФункция НовоеПодключение2()  //Подключение к DBF\r\n\tТаблица = Новый ТаблицаЗначений();\r\n\r\nConnection = Новый COMОбъект(\"ADODB.Connection\"); // Создание COM-объекта\r\n\tConnection.Open(\"Provider=Microsoft.Jet.OLEDB.4.0;\r\n\t         |Data Source=\" +КаталогФайла +\";\r\n\t         |Extended Properties=DBASE III\");    \r\n    Connection.BeginTrans();    \r\n   // Создание объекта выполнения команды\r\n    Command = Новый COMОбъект(\"ADODB.Command\");\r\n   // Указание активного соединения \r\n    Command.ActiveConnection = Connection;    \r\n   // Определение текста команды\r\n\r\n\tCommand.CommandText = \"SELECT * FROM Calls WHERE DATE between  @DataN AND @DataK\";  //Calls  -название файла DBF\r\n\tДата1 = Формат(НачПериода, \"ДФ=MM.dd.yyyy\");\r\n\tДата2 = Формат(КонПериода, \"ДФ=MM.dd.yyyy\");\r\n\t\r\n    Param1 = Command.CreateParameter(\"@DataN\", 133, 1);\r\n    Command.Parameters.Append(Param1);\r\n    Param1.Value = Дата1;\r\n\t\r\n\tParam2 = Command.CreateParameter(\"@DataK\", 133, 1);\r\n    Command.Parameters.Append(Param2);\r\n    Param2.Value = Дата2;\r\n\r\n   // Определение типа команды\r\n   //Command.CommandType = 4;\r\n   // Создание объекта набора записей\r\n    RecordSet = Новый COMОбъект(\"ADODB.RecordSet\");\r\n    RecordSet = Command.Execute();\r\n\t\r\n\tПока RecordSet.EOF=0 Цикл //Цикл по записям файла DBF\r\n\t        м= Таблица.Добавить();\r\n\t\tм.Дата \t\t\t   \t=  RecordSet.Fields(\"DATE\").Value;\r\n\t\tм.Длительность\t\t=  RecordSet.Fields(\"IDURATION\").Value ;\r\n\t\tм.Время\t           \t=  RecordSet.Fields(\"ITIME\").Value;\r\n\t\tм.СО              \t=  RecordSet.Fields(\"CO\").Value   ;\r\n\t\tм.ВнутрНомер        =  RecordSet.Fields(\"EXTENSION\").Value ;\r\n\t\tм.TrunkГруппа       =  RecordSet.Fields(\"TRUNKGROUP\").Value ;\r\n\t\tм.Transfer         \t=  RecordSet.Fields(\"TRANSFER\").Value   ;\r\n\t\tм.Цена            \t=  RecordSet.Fields(\"PRICE\").Value     ;\r\n\t\tм.Номер           \t=  RecordSet.Fields(\"NUMBER\").Value   ;\r\n\t\tм.Статус           \t=  RecordSet.Fields(\"STATUS\").Value   ;\r\n\t\tм.ВремяДоОтвета     =  RecordSet.Fields(\"RINGBEFORE\").Value ;\r\n\t\tм.CallerID         \t=  RecordSet.Fields(\"CALLERID\").Value  ;\r\n\t    RecordSet.MoveNext(); //Переходим к следующей записи\r\n\tКонецЦикла;\r\n\tRecordSet.Close();\r\n\r\nВозврат Таблица;\t\r\nКонецФункции\n\n{30} Переменной RecordSet присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в Param1 (найдено 3): Param\r\nОрфографическая ошибка в Param2 (найдено 3): Param"
  },
  {
    "title": "Объявление переменной из выделенного текста",
    "description": "Объявление переменной из выделенного текста",
    "code_snippet": ""
  },
  {
    "title": "workflow",
    "description": "Данная библиотека предназначена для формирования простых и условых бизнес-процессов выполнения методов в OScript.",
    "code_snippet": ""
  },
  {
    "title": "WinExt",
    "description": "Библиотека взаимодействия с ОС Windows.",
    "code_snippet": ""
  },
  {
    "title": "Обмен через ВЕБ Сервисы 2 часть",
    "description": "Обмен через ВЕБ Сервисы 2 часть",
    "code_snippet": "Процедура КнопкаЗаполнитьТаблицуИзПервойБазыНажатие(Кнопка)\r\n      \r\n\tВСОпределение = Новый WSОпределения(\"127.7.7.7/Obmen/ws/Obmen.1cws?wsdl\", \"admin\", \"pass\"); \r\n//127.7.7.7 - ВашИПАдресГдеОпубликованWebСервис \r\n//admin - пользователь информационной базы с полными правами и пароль -pass\r\n\tВСПрокси = Новый WSПрокси(ВСОпределение, \"127.7.7.7\", \"Obmen\", \"ObmenSoap\");\r\n//127.7.7.7 - URl пространство имен Веб сервиса первой базы, Obmen -наименование \r\n// расширения ,\r\n//ObmenSoap тоже самое Но добавляем Soap к названии ))\r\n\t\r\n\tСклад= Элементы.Склад.Значение; //Элемент формы, выбранное поле - склад\r\n\tВремя=ТекущаяДата();\r\n\t\r\n\tВСПрокси.Пользователь = \"admin\";\r\n\tВСПрокси.Пароль = \"pass\";\r\n\t\r\n\tДанные = ВСПрокси.ОстаткиТоваровТНН(Строка(Склад),Дата(Время));  // подключаемся и получаем данные xml \r\n\t\r\n\tпопытка\r\n\t\r\n\tЧтениеXML               = Новый ЧтениеXML;\r\n\tЧтениеXML.УстановитьСтроку(данные);  //Открываем файл\r\n\tПока ЧтениеXML.Прочитать() Цикл\r\n\t\tЕсли ЧтениеXML.ТипУзла                  = ТипУзлаXML.НачалоЭлемента Тогда \r\n\t\t\tПока ЧтениеXML.ПрочитатьАтрибут() Цикл\r\n\t\t\t\tст = Таб.Добавить();  //Табличная часть на форме \r\n\t\t\t\tст.Номенклатура = Справочники.Номенклатура.НайтиПоНаименованию(ЧтениеXML.ЗначениеАтрибута(\"Номенклатура\"));\r\n\t\t\t\tст.Склад = Справочники.Склады.НайтиПоНаименованию(ЧтениеXML.ЗначениеАтрибута(\"Склад\"));\r\n\t\t\t\tст.КоличествоНачальныйОстаток = ЧтениеXML.ЗначениеАтрибута(\"КоличествоНачальныйОстаток\");\r\n\t\t\t\tст.КоличествоПриход = ЧтениеXML.ЗначениеАтрибута(\"КоличествоПриход\");\r\n\t\t\t\tст.КоличествоРасход = ЧтениеXML.ЗначениеАтрибута(\"КоличествоРасход\");\r\n\t\t\t\tст.КоличествоКонечныйОстаток = ЧтениеXML.ЗначениеАтрибута(\"КоличествоКонечныйОстаток\");\r\n\t\t\t\tпрервать;\t\r\n\t\t\tконеццикла;\r\n\t\tКонецЕсли;\r\n\tконеццикла;\t\r\n\t\r\n\tисключение\r\n\t    сообщить(Данные);\r\n\tКонецПопытки;\r\n\t\r\n\t\r\nконецпроцедуры\n\nПроцедура КнопкаЗаполнитьТаблицуИзПервойБазыНажатие(Кнопка)\r\n      \r\n\tВСОпределение = Новый WSОпределения(\"127.7.7.7/Obmen/ws/Obmen.1cws?wsdl\", \"admin\", \"pass\"); \r\n//127.7.7.7 - ВашИПАдресГдеОпубликованWebСервис \r\n//admin - пользователь информационной базы с полными правами и пароль -pass\r\n\tВСПрокси = Новый WSПрокси(ВСОпределение, \"127.7.7.7\", \"Obmen\", \"ObmenSoap\");\r\n//127.7.7.7 - URl пространство имен Веб сервиса первой базы, Obmen -наименование \r\n// расширения ,\r\n//ObmenSoap тоже самое Но добавляем Soap к названии ))\r\n\t\r\n\tСклад= Элементы.Склад.Значение; //Элемент формы, выбранное поле - склад\r\n\tВремя=ТекущаяДата();\r\n\t\r\n\tВСПрокси.Пользователь = \"admin\";\r\n\tВСПрокси.Пароль = \"pass\";\r\n\t\r\n\tДанные = ВСПрокси.ОстаткиТоваровТНН(Строка(Склад),Дата(Время));  // подключаемся и получаем данные xml \r\n\t\r\n\tпопытка\r\n\t\r\n\tЧтениеXML               = Новый ЧтениеXML;\r\n\tЧтениеXML.УстановитьСтроку(данные);  //Открываем файл\r\n\tПока ЧтениеXML.Прочитать() Цикл\r\n\t\tЕсли ЧтениеXML.ТипУзла                  = ТипУзлаXML.НачалоЭлемента Тогда \r\n\t\t\tПока ЧтениеXML.ПрочитатьАтрибут() Цикл\r\n\t\t\t\tст = Таб.Добавить();  //Табличная часть на форме \r\n\t\t\t\tст.Номенклатура = Справочники.Номенклатура.НайтиПоНаименованию(ЧтениеXML.ЗначениеАтрибута(\"Номенклатура\"));\r\n\t\t\t\tст.Склад = Справочники.Склады.НайтиПоНаименованию(ЧтениеXML.ЗначениеАтрибута(\"Склад\"));\r\n\t\t\t\tст.КоличествоНачальныйОстаток = ЧтениеXML.ЗначениеАтрибута(\"КоличествоНачальныйОстаток\");\r\n\t\t\t\tст.КоличествоПриход = ЧтениеXML.ЗначениеАтрибута(\"КоличествоПриход\");\r\n\t\t\t\tст.КоличествоРасход = ЧтениеXML.ЗначениеАтрибута(\"КоличествоРасход\");\r\n\t\t\t\tст.КоличествоКонечныйОстаток = ЧтениеXML.ЗначениеАтрибута(\"КоличествоКонечныйОстаток\");\r\n\t\t\t\tпрервать;\t\r\n\t\t\tконеццикла;\r\n\t\tКонецЕсли;\r\n\tконеццикла;\t\r\n\t\r\n\tисключение\r\n\t    сообщить(Данные);\r\n\tКонецПопытки;\r\n\t\r\n\t\r\nконецпроцедуры\n\nОрфографическая ошибка в Obmen (найдено 4): Obmen\r\nОрфографическая ошибка в wsdl: wsdl\r\nОрфографическая ошибка в ObmenSoap (найдено 2): Obmen"
  },
  {
    "title": "Обмен через ВЕБ Сервисы 1 часть",
    "description": "Обмен через ВЕБ Сервисы 1 часть",
    "code_snippet": "//1.Создаем web-сервис (заполняем только \"Основные\" и \"Прочее\", пока что ...)\r\n//      - Имя любое(не критично, но желательно на англ.)\r\n//      -URl пространство имен - вводим ip адресс для удобства (пример: 127.7.7.7)\r\n//      -Пакеты XDTO , я еще не совсем разобрался )), поэтому выбираю стандартный \r\n//        (http://v8.1c.ru/8.1/xdto),  особой роли не играет в данном примере.\r\n//        -Имя файла публикации - Любое значение с форматом *.1cws(Пример:  Obmen.1cws)\r\n//2. Создаем Операцию с параметрами (Напоминает стандартную \"Функцию\" с параметрами)\r\n//       Например -Операция \"ОстаткиТоваровНТТ\" \r\n//       тип возвращаемого значение- \"Строка\"- string (http://www.w3.org/2001/XMLSchema)\r\n//3 создаем операции :Время с Типом: DataTime , Склад с Типом: string - пока хватит )\r\n//4 создаем процедуру для операции \"ОстаткиТоваровНТТ\", в свойствах операции и \r\n//  заполним функцию ниже:\r\n//5 в самом конце, обновляем базу и публикуем, готово!\r\n\r\n\r\nФункция ОстаткиТоваровНТТ(Склад, Время)\r\n\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\tЗаписьXML.УстановитьСтроку(\"UTF-8\"); \r\n\tЗаписьXML.ЗаписатьОбъявлениеXML();  // Записываем объявление XML\r\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"ОстаткиТоваров\"); \r\n\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст =\"ВЫБРАТЬ\r\n\t              |\tТоварыНаСкладахОстаткиИОбороты.Номенклатура КАК Номенклатура,\r\n\t              |\tТоварыНаСкладахОстаткиИОбороты.Склад КАК Склад,\r\n\t              |\tСУММА(ТоварыНаСкладахОстаткиИОбороты.КоличествоНачальныйОстаток) КАК КоличествоНачальныйОстаток,\r\n\t              |\tСУММА(ТоварыНаСкладахОстаткиИОбороты.КоличествоПриход) КАК КоличествоПриход,\r\n\t              |\tСУММА(ТоварыНаСкладахОстаткиИОбороты.КоличествоРасход) КАК КоличествоРасход,\r\n\t              |\tСУММА(ТоварыНаСкладахОстаткиИОбороты.КоличествоКонечныйОстаток) КАК КоличествоКонечныйОстаток\r\n\t              |ИЗ\r\n\t              |\tРегистрНакопления.ТоварыНаСкладах.ОстаткиИОбороты(&НачПериод, &КонПериод, Авто, , ) КАК ТоварыНаСкладахОстаткиИОбороты\r\n\t              |ГДЕ\r\n\t              |\tТоварыНаСкладахОстаткиИОбороты.Склад = &Склад\t\t\t\t  \r\n\t\t      |СГРУППИРОВАТЬ ПО\r\n\t              |\tТоварыНаСкладахОстаткиИОбороты.Номенклатура,\r\n\t              |\tТоварыНаСкладахОстаткиИОбороты.Склад,\r\n\t              |\r\n\t              |УПОРЯДОЧИТЬ ПО\r\n\t              |\tНоменклатура УБЫВ\"; \r\n\r\n\tЗапрос.УстановитьПараметр(\"НачПериод\", Дата(НачалоДня(Время)));\r\n\tЗапрос.УстановитьПараметр(\"КонПериод\", Дата(КонецДня(Время)));\r\n\tЗапрос.УстановитьПараметр(\"Склад\", Справочники.Склады.НайтиПоНаименованию(Склад,Истина));  //склад заморозки Москва\r\n\t\r\n\tЕсли запрос.Выполнить().Пустой() тогда\r\n\t\tответ = \"За выбранный период остатков не найдено\";\r\n\t        возврат ответ;\r\n\tКонецЕсли;\r\n\tРезультат = Запрос.Выполнить().Выбрать();\r\n\tпока Результат.Следующий() цикл\r\n\t\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Результат\");\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Склад\", Строка(Результат.Склад));\r\n\t   \tЗаписьXML.ЗаписатьАтрибут(\"КоличествоНачальныйОстаток\", Строка(Результат.КоличествоНачальныйОстаток));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"КоличествоПриход\", Строка(Результат.КоличествоПриход));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Номенклатура\", Строка(Результат.Номенклатура));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"КоличествоРасход\", Строка(Результат.КоличествоРасход));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"КоличествоКонечныйОстаток\", Строка(Результат.КоличествоКонечныйОстаток));\r\n\t\tЗаписьXML.ЗаписатьКонецЭлемента();  \r\n\tконеццикла;\r\n\tЗаписьXML.ЗаписатьКонецЭлемента();\r\n\tданные= ЗаписьXML.Закрыть();\r\n\t\r\n\tВозврат Данные;\r\nконецфункции\r\n// Функция получает остатки из регистра по полученным параметрам (Время и склад),\r\n// формирует XML запись , и отправляет обратно\n\n//1.Создаем web-сервис (заполняем только \"Основные\" и \"Прочее\", пока что ...)\r\n//      - Имя любое(не критично, но желательно на англ.)\r\n//      -URl пространство имен - вводим ip адресс для удобства (пример: 127.7.7.7)\r\n//      -Пакеты XDTO , я еще не совсем разобрался )), поэтому выбираю стандартный \r\n//        (http://v8.1c.ru/8.1/xdto),  особой роли не играет в данном примере.\r\n//        -Имя файла публикации - Любое значение с форматом *.1cws(Пример:  Obmen.1cws)\r\n//2. Создаем Операцию с параметрами (Напоминает стандартную \"Функцию\" с параметрами)\r\n//       Например -Операция \"ОстаткиТоваровНТТ\" \r\n//       тип возвращаемого значение- \"Строка\"- string (http://www.w3.org/2001/XMLSchema)\r\n//3 создаем операции :Время с Типом: DataTime , Склад с Типом: string - пока хватит )\r\n//4 создаем процедуру для операции \"ОстаткиТоваровНТТ\", в свойствах операции и \r\n//  заполним функцию ниже:\r\n//5 в самом конце, обновляем базу и публикуем, готово!\r\n\r\n\r\nФункция ОстаткиТоваровНТТ(Склад, Время)\r\n\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\tЗаписьXML.УстановитьСтроку(\"UTF-8\"); \r\n\tЗаписьXML.ЗаписатьОбъявлениеXML();  // Записываем объявление XML\r\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"ОстаткиТоваров\"); \r\n\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст =\"ВЫБРАТЬ\r\n\t              |\tТоварыНаСкладахОстаткиИОбороты.Номенклатура КАК Номенклатура,\r\n\t              |\tТоварыНаСкладахОстаткиИОбороты.Склад КАК Склад,\r\n\t              |\tСУММА(ТоварыНаСкладахОстаткиИОбороты.КоличествоНачальныйОстаток) КАК КоличествоНачальныйОстаток,\r\n\t              |\tСУММА(ТоварыНаСкладахОстаткиИОбороты.КоличествоПриход) КАК КоличествоПриход,\r\n\t              |\tСУММА(ТоварыНаСкладахОстаткиИОбороты.КоличествоРасход) КАК КоличествоРасход,\r\n\t              |\tСУММА(ТоварыНаСкладахОстаткиИОбороты.КоличествоКонечныйОстаток) КАК КоличествоКонечныйОстаток\r\n\t              |ИЗ\r\n\t              |\tРегистрНакопления.ТоварыНаСкладах.ОстаткиИОбороты(&НачПериод, &КонПериод, Авто, , ) КАК ТоварыНаСкладахОстаткиИОбороты\r\n\t              |ГДЕ\r\n\t              |\tТоварыНаСкладахОстаткиИОбороты.Склад = &Склад\t\t\t\t  \r\n\t\t      |СГРУППИРОВАТЬ ПО\r\n\t              |\tТоварыНаСкладахОстаткиИОбороты.Номенклатура,\r\n\t              |\tТоварыНаСкладахОстаткиИОбороты.Склад,\r\n\t              |\r\n\t              |УПОРЯДОЧИТЬ ПО\r\n\t              |\tНоменклатура УБЫВ\"; \r\n\r\n\tЗапрос.УстановитьПараметр(\"НачПериод\", Дата(НачалоДня(Время)));\r\n\tЗапрос.УстановитьПараметр(\"КонПериод\", Дата(КонецДня(Время)));\r\n\tЗапрос.УстановитьПараметр(\"Склад\", Справочники.Склады.НайтиПоНаименованию(Склад,Истина));  //склад заморозки Москва\r\n\t\r\n\tЕсли запрос.Выполнить().Пустой() тогда\r\n\t\tответ = \"За выбранный период остатков не найдено\";\r\n\t        возврат ответ;\r\n\tКонецЕсли;\r\n\tРезультат = Запрос.Выполнить().Выбрать();\r\n\tпока Результат.Следующий() цикл\r\n\t\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Результат\");\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Склад\", Строка(Результат.Склад));\r\n\t   \tЗаписьXML.ЗаписатьАтрибут(\"КоличествоНачальныйОстаток\", Строка(Результат.КоличествоНачальныйОстаток));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"КоличествоПриход\", Строка(Результат.КоличествоПриход));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Номенклатура\", Строка(Результат.Номенклатура));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"КоличествоРасход\", Строка(Результат.КоличествоРасход));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"КоличествоКонечныйОстаток\", Строка(Результат.КоличествоКонечныйОстаток));\r\n\t\tЗаписьXML.ЗаписатьКонецЭлемента();  \r\n\tконеццикла;\r\n\tЗаписьXML.ЗаписатьКонецЭлемента();\r\n\tданные= ЗаписьXML.Закрыть();\r\n\t\r\n\tВозврат Данные;\r\nконецфункции\r\n// Функция получает остатки из регистра по полученным параметрам (Время и склад),\r\n// формирует XML запись , и отправляет обратно\n\nОрфографическая ошибка в адресс: адресс\r\nОрфографическая ошибка в Obmen: Obmen\n\nЗапрос.УстановитьПараметр(\"Склад\", Справочники.Склады.НайтиПоНаименованию(Ск,Истина));"
  },
  {
    "title": "semaphore",
    "description": "Библиотека для организации \"семафора\" - инструмента ограничения одновременного выполнения участков кода в многопоточной среде.",
    "code_snippet": ""
  },
  {
    "title": "changelog-generate",
    "description": "Генератор changelog.md на OScript",
    "code_snippet": ""
  },
  {
    "title": "entity",
    "description": "Библиотека предназначена для работы с данными БД как с простыми OneScript объектами",
    "code_snippet": ""
  },
  {
    "title": "Оправка Push уведомления",
    "description": "Оправка Push уведомления",
    "code_snippet": "Процедура ОтправитьPushOverУведомление(ТекстСообщения, ЗаголовокСообщения)\r\n\r\n\tСервер = \"api.pushover.net\";\r\n\tАдрес = \"1/messages.json\";\r\n\tTokenKey = \"......\"; //Здесь токен канала\r\n\tUserID = \"......\"; //Здесь ИД пользователя\r\n\r\n\tСоединение = Новый HTTPСоединение(Сервер,,,,Новый ИнтернетПрокси(истина),10, Новый ЗащищенноеСоединениеOpenSSL);\r\n\tСтрокаПараметров = \"?token=%3&user=%4&html=1&message=%1&title=%2\";\r\n\tСтрокаПараметров = СтрЗаменить(СтрокаПараметров, \"%1\", ТекстСообщения);\r\n\tСтрокаПараметров = СтрЗаменить(СтрокаПараметров, \"%2\", ЗаголовокСообщения);\r\n\tСтрокаПараметров = СтрЗаменить(СтрокаПараметров, \"%3\", TokenKey);\r\n\tСтрокаПараметров = СтрЗаменить(СтрокаПараметров, \"%4\", UserID);\r\n\tЗапрос = Новый HTTPЗапрос(Адрес+СтрокаПараметров);\r\n\t\r\n\tПопытка\r\n\t\tОтвет = Соединение.ОтправитьДляОбработки(Запрос);\r\n\tИсключение\r\n\t\tСообщениеПользователю = Новый СообщениеПользователю;\r\n\t\tСообщениеПользователю.Текст  = \"Ошибка запроса к серверу: \"+Ответ.КодСостояния;\r\n\t\tСообщениеПользователю.Сообщить();\r\n\t\tВозврат;\r\n\tКонецПопытки;\t\r\n\t\r\n\tЕсли Ответ.КодСостояния <> 200 Тогда\r\n\t \tСообщениеПользователю = Новый СообщениеПользователю;\r\n\t\tСообщениеПользователю.Текст  = \"Ошибка запроса к серверу: \"+Ответ.КодСостояния;\r\n\t\tСообщениеПользователю.Сообщить();\r\n\t\tВозврат;\r\n\tКонецЕсли; \r\n\r\nКонецПроцедуры // ОтправитьPushУведомление()\n\nПроцедура ОтправитьPushOverУведомление(ТекстСообщения, ЗаголовокСообщения)\r\n\r\n\tСервер = \"api.pushover.net\";\r\n\tАдрес = \"1/messages.json\";\r\n\tTokenKey = \"......\"; //Здесь токен канала\r\n\tUserID = \"......\"; //Здесь ИД пользователя\r\n\r\n\tСоединение = Новый HTTPСоединение(Сервер,,,,Новый ИнтернетПрокси(истина),10, Новый ЗащищенноеСоединениеOpenSSL);\r\n\tСтрокаПараметров = \"?token=%3&user=%4&html=1&message=%1&title=%2\";\r\n\tСтрокаПараметров = СтрЗаменить(СтрокаПараметров, \"%1\", ТекстСообщения);\r\n\tСтрокаПараметров = СтрЗаменить(СтрокаПараметров, \"%2\", ЗаголовокСообщения);\r\n\tСтрокаПараметров = СтрЗаменить(СтрокаПараметров, \"%3\", TokenKey);\r\n\tСтрокаПараметров = СтрЗаменить(СтрокаПараметров, \"%4\", UserID);\r\n\tЗапрос = Новый HTTPЗапрос(Адрес+СтрокаПараметров);\r\n\t\r\n\tПопытка\r\n\t\tОтвет = Соединение.ОтправитьДляОбработки(Запрос);\r\n\tИсключение\r\n\t\tСообщениеПользователю = Новый СообщениеПользователю;\r\n\t\tСообщениеПользователю.Текст  = \"Ошибка запроса к серверу: \"+Ответ.КодСостояния;\r\n\t\tСообщениеПользователю.Сообщить();\r\n\t\tВозврат;\r\n\tКонецПопытки;\t\r\n\t\r\n\tЕсли Ответ.КодСостояния <> 200 Тогда\r\n\t \tСообщениеПользователю = Новый СообщениеПользователю;\r\n\t\tСообщениеПользователю.Текст  = \"Ошибка запроса к серверу: \"+Ответ.КодСостояния;\r\n\t\tСообщениеПользователю.Сообщить();\r\n\t\tВозврат;\r\n\tКонецЕсли; \r\n\r\nКонецПроцедуры // ОтправитьPushУведомление()\n\nОрфографическая ошибка в html: html"
  },
  {
    "title": "telegrambot",
    "description": "Библиотека для взаимодействия с Telegram Bot API",
    "code_snippet": ""
  },
  {
    "title": "Выгрузка Запроса в XML документ, в виде дерева(В Виде иерархии)",
    "description": "Выгрузка Запроса в XML документ, в виде дерева(В Виде иерархии)",
    "code_snippet": "Процедура ЛюбаяСЗапросом()\r\nЗаписьXML = Новый ЗаписьXML;\r\n\tЗаписьXML.ОткрытьФайл(ПутьП,  \"UTF-8\"); //Открываем файл для записи, указываем кодировку\r\n\tЗаписьXML.ЗаписатьОбъявлениеXML();  // Записываем объявление XML\r\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"ОстаткиТоваров\"); // Начало элемента \r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tТоварыНаСкладах.Период КАК Период,\r\n\t\t|\tТоварыНаСкладах.Регистратор КАК Регистратор,\r\n\t\t|\tТоварыНаСкладах.Номенклатура КАК Номенклатура,\r\n\t\t|\tТоварыНаСкладах.Количество КАК Количество\r\n\t\t|ИЗ\r\n\t\t|\tРегистрНакопления.ТоварыНаСкладах КАК ТоварыНаСкладах\r\n\t\t|ГДЕ\r\n\t\t|\tТоварыНаСкладах.Период МЕЖДУ &НачПериод И &КонПериод\r\n\t\t|\tИ ТоварыНаСкладах.Номенклатура В ИЕРАРХИИ(&Номенклатура)\t\t\r\n\t\t|ИТОГИ ПО\r\n\t\t|\t\tРегистратор\";\r\n\r\nРезультат = Запрос.Выполнить();\r\n\tДерево = Результат.Выгрузить(ОбходРезультатаЗапроса.ПоГруппировкамСИерархией);\r\n\tОбойтиУровеньДерева(Дерево.Строки, ЗаписьXML);   //вызов процедуры\r\n\tЗаписьXML.ЗаписатьКонецЭлемента();     \r\n\tЗаписьXML.Закрыть();\r\n\r\nКонецПроцедуры\r\n\r\nПроцедура ОбойтиУровеньДерева(Строки, Запись)   // процедура для записи результата запроса с сохранением иерархии в текущий документ xml\r\n\tДля каждого Строка из Строки Цикл\r\n\t\tЕсли ПустаяСтрока(Строка(Строка.Номенклатура)) Тогда //Итог в запросе по \"Регистратору\"\r\n\t\t\tЗапись.ЗаписатьНачалоЭлемента(\"Уровень\");\r\n\t\t\tЗапись.ЗаписатьАтрибут(\"Период\",          Строка(Строка.Период));\r\n\t\t\tЗапись.ЗаписатьАтрибут(\"Регистратор\", Строка(Строка.Регистратор));\r\n\t   \t\tЗапись.ЗаписатьАтрибут(\"Количество\", Строка(Строка.Количество));\r\n\t\t\tОбойтиУровеньДерева(Строка.Строки, Запись); \r\n\t\t\tЗапись.ЗаписатьКонецЭлемента();  \r\n\t\tИначе\r\n\t\t\tЗапись.ЗаписатьНачалоЭлемента(\"Уровни\");\r\n\t\t\tЗапись.ЗаписатьАтрибут(\"Период\",          Строка(Строка.Период));\r\n\t\t\tЗапись.ЗаписатьАтрибут(\"Регистратор\", Строка(Строка.Регистратор));\r\n\t\t\tЗапись.ЗаписатьАтрибут(\"Номенклатура\", Строка(Строка.Номенклатура));\r\n\t   \t\tЗапись.ЗаписатьАтрибут(\"Количество\", Строка(Строка.Количество));\r\n\t\t\tОбойтиУровеньДерева(Строка.Строки, Запись); \r\n\t\t\tЗапись.ЗаписатьКонецЭлемента();  \r\n\t\tКонецЕсли\r\n\tКонецЦикла; \r\nКонецПроцедуры\n\nПроцедура ЛюбаяСЗапросом()\r\nЗаписьXML = Новый ЗаписьXML;\r\n\tЗаписьXML.ОткрытьФайл(ПутьП,  \"UTF-8\"); //Открываем файл для записи, указываем кодировку\r\n\tЗаписьXML.ЗаписатьОбъявлениеXML();  // Записываем объявление XML\r\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"ОстаткиТоваров\"); // Начало элемента \r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tТоварыНаСкладах.Период КАК Период,\r\n\t\t|\tТоварыНаСкладах.Регистратор КАК Регистратор,\r\n\t\t|\tТоварыНаСкладах.Номенклатура КАК Номенклатура,\r\n\t\t|\tТоварыНаСкладах.Количество КАК Количество\r\n\t\t|ИЗ\r\n\t\t|\tРегистрНакопления.ТоварыНаСкладах КАК ТоварыНаСкладах\r\n\t\t|ГДЕ\r\n\t\t|\tТоварыНаСкладах.Период МЕЖДУ &НачПериод И &КонПериод\r\n\t\t|\tИ ТоварыНаСкладах.Номенклатура В ИЕРАРХИИ(&Номенклатура)\t\t\r\n\t\t|ИТОГИ ПО\r\n\t\t|\t\tРегистратор\";\r\n\r\nРезультат = Запрос.Выполнить();\r\n\tДерево = Результат.Выгрузить(ОбходРезультатаЗапроса.ПоГруппировкамСИерархией);\r\n\tОбойтиУровеньДерева(Дерево.Строки, ЗаписьXML);   //вызов процедуры\r\n\tЗаписьXML.ЗаписатьКонецЭлемента();     \r\n\tЗаписьXML.Закрыть();\r\n\r\nКонецПроцедуры\r\n\r\nПроцедура ОбойтиУровеньДерева(Строки, Запись)   // процедура для записи результата запроса с сохранением иерархии в текущий документ xml\r\n\tДля каждого Строка из Строки Цикл\r\n\t\tЕсли ПустаяСтрока(Строка(Строка.Номенклатура)) Тогда //Итог в запросе по \"Регистратору\"\r\n\t\t\tЗапись.ЗаписатьНачалоЭлемента(\"Уровень\");\r\n\t\t\tЗапись.ЗаписатьАтрибут(\"Период\",          Строка(Строка.Период));\r\n\t\t\tЗапись.ЗаписатьАтрибут(\"Регистратор\", Строка(Строка.Регистратор));\r\n\t   \t\tЗапись.ЗаписатьАтрибут(\"Количество\", Строка(Строка.Количество));\r\n\t\t\tОбойтиУровеньДерева(Строка.Строки, Запись); \r\n\t\t\tЗапись.ЗаписатьКонецЭлемента();  \r\n\t\tИначе\r\n\t\t\tЗапись.ЗаписатьНачалоЭлемента(\"Уровни\");\r\n\t\t\tЗапись.ЗаписатьАтрибут(\"Период\",          Строка(Строка.Период));\r\n\t\t\tЗапись.ЗаписатьАтрибут(\"Регистратор\", Строка(Строка.Регистратор));\r\n\t\t\tЗапись.ЗаписатьАтрибут(\"Номенклатура\", Строка(Строка.Номенклатура));\r\n\t   \t\tЗапись.ЗаписатьАтрибут(\"Количество\", Строка(Строка.Количество));\r\n\t\t\tОбойтиУровеньДерева(Строка.Строки, Запись); \r\n\t\t\tЗапись.ЗаписатьКонецЭлемента();  \r\n\t\tКонецЕсли\r\n\tКонецЦикла; \r\nКонецПроцедуры"
  },
  {
    "title": "Запись документа XML иерархия",
    "description": "Запись документа XML иерархия",
    "code_snippet": "Процедура ВыгрузитьСкладыНажатие(Элемент)\t\t//выгрузка склады\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\tПутьКФайлу = \tКаталогВременныхФайлов()+ \"Склады.xml\";\r\n\tЗаписьXML.ОткрытьФайл(ПутьКФайлу,  \"UTF-8\"); //Открываем файл для записи, указываем кодировку\r\n\tЗаписьXML.ЗаписатьОбъявлениеXML();  // Записываем объявление XML\r\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Склады\"); // Начало элемента \r\n\tВыборка   = Справочники.Склады.ВыбратьИерархически();\r\n\tПока Выборка.Следующий() Цикл  // Начинаем выгружать \r\n\t\tесли  Выборка.ЭтоГруппа = Истина тогда\r\n\t\t\tЕсли Выборка.УровеньВВыборке() = 0 Тогда \r\n\t\t\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Склад\"); // Начало элемента Склад\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Код\",          Строка(Выборка.Код));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Наименование\", Строка(Выборка.Наименование));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Родитель\", Строка(Выборка.Родитель));\r\n\t\t\tЗаписьXML.ЗаписатьКонецЭлемента();\r\n\t\t    Иначеесли Выборка.УровеньВВыборке() = 1 Тогда \r\n\t\t\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Склад1\"); \r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Код1\",          Строка(Выборка.Код));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Наименование1\", Строка(Выборка.Наименование));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Родитель1\", Строка(Выборка.Родитель));\r\n\t\t    ЗаписьXML.ЗаписатьКонецЭлемента();\t\r\n\t\t\tКонецЕсли;\r\n\t\tиначеесли Выборка.ЭтоГруппа = Ложь тогда\r\n\t\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Склад2\");\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Код2\",          Строка(Выборка.Код));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Наименование2\", Строка(Выборка.Наименование));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Родитель2\", Строка(Выборка.Родитель));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Подразделение2\", Строка(Выборка.Подразделение));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"ВидСклада2\", Строка(Выборка.ВидСклада));\r\n\t\tЗаписьXML.ЗаписатьКонецЭлемента(); // Конец элемента Организация\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tЗаписьXML.ЗаписатьКонецЭлемента(); // Конец элемента \r\n\tЗаписьXML.Закрыть();\r\n\r\nКонецПроцедуры\n\nПроцедура ВыгрузитьСкладыНажатие(Элемент)\t\t//выгрузка склады\r\n\tЗаписьXML = Новый ЗаписьXML;\r\n\tПутьКФайлу = \tКаталогВременныхФайлов()+ \"Склады.xml\";\r\n\tЗаписьXML.ОткрытьФайл(ПутьКФайлу,  \"UTF-8\"); //Открываем файл для записи, указываем кодировку\r\n\tЗаписьXML.ЗаписатьОбъявлениеXML();  // Записываем объявление XML\r\n\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Склады\"); // Начало элемента \r\n\tВыборка   = Справочники.Склады.ВыбратьИерархически();\r\n\tПока Выборка.Следующий() Цикл  // Начинаем выгружать \r\n\t\tесли  Выборка.ЭтоГруппа = Истина тогда\r\n\t\t\tЕсли Выборка.УровеньВВыборке() = 0 Тогда \r\n\t\t\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Склад\"); // Начало элемента Склад\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Код\",          Строка(Выборка.Код));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Наименование\", Строка(Выборка.Наименование));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Родитель\", Строка(Выборка.Родитель));\r\n\t\t\tЗаписьXML.ЗаписатьКонецЭлемента();\r\n\t\t    Иначеесли Выборка.УровеньВВыборке() = 1 Тогда \r\n\t\t\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Склад1\"); \r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Код1\",          Строка(Выборка.Код));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Наименование1\", Строка(Выборка.Наименование));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Родитель1\", Строка(Выборка.Родитель));\r\n\t\t    ЗаписьXML.ЗаписатьКонецЭлемента();\t\r\n\t\t\tКонецЕсли;\r\n\t\tиначеесли Выборка.ЭтоГруппа = Ложь тогда\r\n\t\tЗаписьXML.ЗаписатьНачалоЭлемента(\"Склад2\");\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Код2\",          Строка(Выборка.Код));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Наименование2\", Строка(Выборка.Наименование));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Родитель2\", Строка(Выборка.Родитель));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"Подразделение2\", Строка(Выборка.Подразделение));\r\n\t\tЗаписьXML.ЗаписатьАтрибут(\"ВидСклада2\", Строка(Выборка.ВидСклада));\r\n\t\tЗаписьXML.ЗаписатьКонецЭлемента(); // Конец элемента Организация\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tЗаписьXML.ЗаписатьКонецЭлемента(); // Конец элемента \r\n\tЗаписьXML.Закрыть();\r\n\r\nКонецПроцедуры"
  },
  {
    "title": "Отправка электронной почты",
    "description": "Отправка электронной почты",
    "code_snippet": "Профиль = Новый ИнтернетПочтовыйПрофиль;\r\n   Профиль.АдресСервераSMTP = \"\";\r\n   Профиль.ПользовательSMTP = \"\";\r\n   Профиль.ПарольSMTP = \"\";\r\n   Профиль.ИспользоватьSSLSMTP = false;\r\n   Профиль.ПортSMTP = 25; \r\n   Профиль.АутентификацияSMTP = СпособSMTPАутентификации.БезАутентификации;\r\n\r\n   Письмо = Новый ИнтернетПочтовоеСообщение;\r\n   Текст1 = Письмо.Тексты.Добавить(Текст);\r\n   Текст1.ТипТекста = ТипТекстаПочтовогоСообщения.ПростойТекст;\r\n   Письмо.Тема = Тема; \r\n   Письмо.Отправитель = \"\";\r\n   Письмо.ИмяОтправителя = \"Сообщение от 1с\";\r\n   Письмо.Получатели.Добавить(\"\");\r\n   \r\n   Почта = Новый ИнтернетПочта;     \r\n   Попытка\r\n      Почта.Подключиться(Профиль);\r\n      Сообщить(\"Подключено\");\r\n   Исключение\r\n       Сообщить(\"Не удалось подключиться к серверу\");\r\n       Сообщить(ОписаниеОшибки());\r\n   КонецПопытки;\r\n   Попытка\r\n      Почта.Послать(Письмо);\r\n      Сообщить(\"Письмо отправлено\");\r\n   Исключение\r\n       Сообщить(\"Не удалось отправить письмо\");\r\n       Сообщить(ОписаниеОшибки());\r\n   КонецПопытки;\r\n    \r\n   Почта.Отключиться();\r\n   Сообщить(\"Соединение завершено\");\n\nПрофиль = Новый ИнтернетПочтовыйПрофиль;\r\n   Профиль.АдресСервераSMTP = \"\";\r\n   Профиль.ПользовательSMTP = \"\";\r\n   Профиль.ПарольSMTP = \"\";\r\n   Профиль.ИспользоватьSSLSMTP = false;\r\n   Профиль.ПортSMTP = 25; \r\n   Профиль.АутентификацияSMTP = СпособSMTPАутентификации.БезАутентификации;\r\n\r\n   Письмо = Новый ИнтернетПочтовоеСообщение;\r\n   Текст1 = Письмо.Тексты.Добавить(Текст);\r\n   Текст1.ТипТекста = ТипТекстаПочтовогоСообщения.ПростойТекст;\r\n   Письмо.Тема = Тема; \r\n   Письмо.Отправитель = \"\";\r\n   Письмо.ИмяОтправителя = \"Сообщение от 1с\";\r\n   Письмо.Получатели.Добавить(\"\");\r\n   \r\n   Почта = Новый ИнтернетПочта;     \r\n   Попытка\r\n      Почта.Подключиться(Профиль);\r\n      Сообщить(\"Подключено\");\r\n   Исключение\r\n       Сообщить(\"Не удалось подключиться к серверу\");\r\n       Сообщить(ОписаниеОшибки());\r\n   КонецПопытки;\r\n   Попытка\r\n      Почта.Послать(Письмо);\r\n      Сообщить(\"Письмо отправлено\");\r\n   Исключение\r\n       Сообщить(\"Не удалось отправить письмо\");\r\n       Сообщить(ОписаниеОшибки());\r\n   КонецПопытки;\r\n    \r\n   Почта.Отключиться();\r\n   Сообщить(\"Соединение завершено\");\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "datetime",
    "description": "Конвертация даты и времени",
    "code_snippet": ""
  },
  {
    "title": "xml-parser",
    "description": "xml-parser",
    "code_snippet": ""
  },
  {
    "title": "Произношение текста голосом",
    "description": "Произношение текста голосом",
    "code_snippet": "Voice = Новый COMObject(\"SAPI.SpVoice\");\r\nVoice.Speak(\"Привет!\");\n\nVoice = Новый COMObject(\"SAPI.SpVoice\");\r\nVoice.Speak(\"Привет!\");"
  },
  {
    "title": "Задать вопрос",
    "description": "Задать вопрос",
    "code_snippet": "&НаКлиенте\r\nПроцедура ДиалогСВопросом(Команда)\r\n     Оповещение = Новый ОписаниеОповещения(\"ПослеЗакрытияВопроса\", ЭтотОбъект);\t\r\n     ПоказатьВопрос(Оповещение,  \"Текст вопроса\",  \r\n        РежимДиалогаВопрос.ДаНетОтмена,\r\n        0, // таймаут в секундах\r\n        КодВозвратаДиалога.Да, // кнопка по умолчанию\r\n        \"Заголовок\" \r\n    );    \r\nКонецПроцедуры\r\n \r\n&НаКлиенте\r\nПроцедура ПослеЗакрытияВопроса(Результат, Параметры) Экспорт\r\n     Если Результат = КодВозвратаДиалога.Да Тогда\r\n        Сообщить(\"Ответ Да!\");\r\n    КонецЕсли;\t\r\n КонецПроцедуры\n\n&НаКлиенте\r\nПроцедура ДиалогСВопросом(Команда)\r\n     Оповещение = Новый ОписаниеОповещения(\"ПослеЗакрытияВопроса\", ЭтотОбъект);\t\r\n     ПоказатьВопрос(Оповещение,  \"Текст вопроса\",  \r\n        РежимДиалогаВопрос.ДаНетОтмена,\r\n        0, // таймаут в секундах\r\n        КодВозвратаДиалога.Да, // кнопка по умолчанию\r\n        \"Заголовок\" \r\n    );    \r\nКонецПроцедуры\r\n \r\n&НаКлиенте\r\nПроцедура ПослеЗакрытияВопроса(Результат, Параметры) Экспорт\r\n     Если Результат = КодВозвратаДиалога.Да Тогда\r\n        Сообщить(\"Ответ Да!\");\r\n    КонецЕсли;\t\r\n КонецПроцедуры"
  },
  {
    "title": "ClientSSH",
    "description": "SSH клиент для oscript",
    "code_snippet": ""
  },
  {
    "title": "autodocgen",
    "description": "AutodocGen - инструмент генерации документации на основании файлов исходных кодов конфигурации 1С:Предприятие.",
    "code_snippet": ""
  },
  {
    "title": "precommit4onec",
    "description": "Утилита для автоматической обработки исходных файлов конфигурации, внешних отчетов и обработок для платформы 1С:Предприятие при помещении в репозиторий git",
    "code_snippet": ""
  },
  {
    "title": "gitrules",
    "description": "GitRules - версионирование правил обмена 1С с помощью git",
    "code_snippet": ""
  },
  {
    "title": "Шаблоны модулей",
    "description": "Оформление модулей согласно стандартам разработки 1С",
    "code_snippet": ""
  },
  {
    "title": "moskito",
    "description": "Библиотека предназначена для создания моков (mock) и стабов (stub) в OneScript.",
    "code_snippet": ""
  },
  {
    "title": "Преобразование ЧтениеJSON в Соответствие",
    "description": "Преобразование ЧтениеJSON в Соответствие",
    "code_snippet": "&НаСервере\r\nПроцедура ОбработатьJSON(ЧтениеJSON, Результат)\r\n\t\r\n\tИмяСвойства = Неопределено;\r\n\t\r\n\tПока ЧтениеJSON.Прочитать() Цикл\r\n\t\tTипJSON = ЧтениеJSON.ТипТекущегоЗначения;\r\n\t\t\r\n\t\tЕсли TипJSON = ТипЗначенияJSON.НачалоОбъекта \r\n\t\t\tИЛИ TипJSON = ТипЗначенияJSON.НачалоМассива Тогда\r\n\t\t\tНовыйОбъект = ?(TипJSON = ТипЗначенияJSON.НачалоОбъекта, Новый Соответствие, Новый Массив);\r\n\t\t\t\r\n\t\t\tЕсли ТипЗнч(Результат) = Тип(\"Массив\") Тогда\r\n\t\t\t\tРезультат.Добавить(НовыйОбъект);\r\n\t\t\tИначеЕсли ТипЗнч(Результат) = Тип(\"Соответствие\") И ЗначениеЗаполнено(ИмяСвойства) Тогда\r\n\t\t\t\tРезультат.Вставить(ИмяСвойства, НовыйОбъект);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tОбработатьJSON(ЧтениеJSON, НовыйОбъект);\r\n\t\t\t\r\n\t\t\tЕсли Результат = Неопределено Тогда\r\n\t\t\t\tРезультат = НовыйОбъект;\r\n\t\t\tКонецЕсли;\r\n\t\tИначеЕсли TипJSON = ТипЗначенияJSON.ИмяСвойства Тогда\r\n\t\t\tИмяСвойства = ЧтениеJSON.ТекущееЗначение;\r\n\t\tИначеЕсли TипJSON = ТипЗначенияJSON.Число \r\n\t\t\tИЛИ TипJSON = ТипЗначенияJSON.Строка \r\n\t\t\tИЛИ TипJSON = ТипЗначенияJSON.Булево \r\n\t\t\tИЛИ TипJSON = ТипЗначенияJSON.Null Тогда\r\n\t\t\tЕсли ТипЗнч(Результат) = Тип(\"Массив\") Тогда\r\n\t\t\t\tРезультат.Добавить(ЧтениеJSON.ТекущееЗначение);\r\n\t\t\tИначеЕсли ТипЗнч(Результат) = Тип(\"Соответствие\") Тогда\r\n\t\t\t\tРезультат.Вставить(ИмяСвойства, ЧтениеJSON.ТекущееЗначение);\r\n\t\t\tКонецЕсли;\r\n\t\tИначе\r\n\t\t\tВозврат;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ОбработатьJSON(ЧтениеJSON, Результат)\r\n\t\r\n\tИмяСвойства = Неопределено;\r\n\t\r\n\tПока ЧтениеJSON.Прочитать() Цикл\r\n\t\tTипJSON = ЧтениеJSON.ТипТекущегоЗначения;\r\n\t\t\r\n\t\tЕсли TипJSON = ТипЗначенияJSON.НачалоОбъекта \r\n\t\t\tИЛИ TипJSON = ТипЗначенияJSON.НачалоМассива Тогда\r\n\t\t\tНовыйОбъект = ?(TипJSON = ТипЗначенияJSON.НачалоОбъекта, Новый Соответствие, Новый Массив);\r\n\t\t\t\r\n\t\t\tЕсли ТипЗнч(Результат) = Тип(\"Массив\") Тогда\r\n\t\t\t\tРезультат.Добавить(НовыйОбъект);\r\n\t\t\tИначеЕсли ТипЗнч(Результат) = Тип(\"Соответствие\") И ЗначениеЗаполнено(ИмяСвойства) Тогда\r\n\t\t\t\tРезультат.Вставить(ИмяСвойства, НовыйОбъект);\r\n\t\t\tКонецЕсли;\r\n\t\t\t\r\n\t\t\tОбработатьJSON(ЧтениеJSON, НовыйОбъект);\r\n\t\t\t\r\n\t\t\tЕсли Результат = Неопределено Тогда\r\n\t\t\t\tРезультат = НовыйОбъект;\r\n\t\t\tКонецЕсли;\r\n\t\tИначеЕсли TипJSON = ТипЗначенияJSON.ИмяСвойства Тогда\r\n\t\t\tИмяСвойства = ЧтениеJSON.ТекущееЗначение;\r\n\t\tИначеЕсли TипJSON = ТипЗначенияJSON.Число \r\n\t\t\tИЛИ TипJSON = ТипЗначенияJSON.Строка \r\n\t\t\tИЛИ TипJSON = ТипЗначенияJSON.Булево \r\n\t\t\tИЛИ TипJSON = ТипЗначенияJSON.Null Тогда\r\n\t\t\tЕсли ТипЗнч(Результат) = Тип(\"Массив\") Тогда\r\n\t\t\t\tРезультат.Добавить(ЧтениеJSON.ТекущееЗначение);\r\n\t\t\tИначеЕсли ТипЗнч(Результат) = Тип(\"Соответствие\") Тогда\r\n\t\t\t\tРезультат.Вставить(ИмяСвойства, ЧтениеJSON.ТекущееЗначение);\r\n\t\t\tКонецЕсли;\r\n\t\tИначе\r\n\t\t\tВозврат;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "coverage",
    "description": "Библиотека для конвертации результата расчета покрытия тестами в различные форматы",
    "code_snippet": ""
  },
  {
    "title": "TLog",
    "description": "Библиотека для логирования работы скриптов",
    "code_snippet": ""
  },
  {
    "title": "TMail",
    "description": "Библиотека для отправки электронных сообщений.",
    "code_snippet": ""
  },
  {
    "title": "TRun1C",
    "description": "Библиотека для запуска 1С:Предприятие 8 в различных режимах.",
    "code_snippet": ""
  },
  {
    "title": "yaml",
    "description": "Библиотека для языка OScript, для чтения файлов в разметке yaml",
    "code_snippet": ""
  },
  {
    "title": "TMSSQL",
    "description": "Приложение для работы с базами данных на MS SQL Server",
    "code_snippet": ""
  },
  {
    "title": "reflector",
    "description": "Данная библиотека для языка OScript, упрощает работу с встроенным объектом `Рефлектор` и добавляет функциональность работы с интерфейсами",
    "code_snippet": ""
  },
  {
    "title": "irac",
    "description": "Библиотека управления кластером 1С",
    "code_snippet": ""
  },
  {
    "title": "add",
    "description": "Vanessa Automation Driven Development",
    "code_snippet": ""
  },
  {
    "title": "Отбор по таблице значений",
    "description": "Отбор по таблице значений",
    "code_snippet": "СтруктураОтбора = Новый Структура(\"Номенклатура,ХарактеристикаНоменклатуры\", ЗначениеОтбора.Номенклатура, ЗначениеОтбора.ХарактеристикаНоменклатуры);\r\nРезультатОтбора = ТаблицаЗначений.НайтиСтроки(СтруктураОтбора);\r\n//Если РезультатОтбора.Количество() > 0 Тогда\r\n//\tСтрокаОтбора = РезультатОтбора[0];\r\n//КонецЕсли;\r\nДля каждого СтрокаОтбора Из РезультатОтбора Цикл\r\n\t\r\nКонецЦикла;\n\nСтруктураОтбора = Новый Структура(\"Номенклатура,ХарактеристикаНоменклатуры\", ЗначениеОтбора.Номенклатура, ЗначениеОтбора.ХарактеристикаНоменклатуры);\r\nРезультатОтбора = ТаблицаЗначений.НайтиСтроки(СтруктураОтбора);\r\n//Если РезультатОтбора.Количество() > 0 Тогда\r\n//\tСтрокаОтбора = РезультатОтбора[0];\r\n//КонецЕсли;\r\nДля каждого СтрокаОтбора Из РезультатОтбора Цикл\r\n\t\r\nКонецЦикла;"
  },
  {
    "title": "configor",
    "description": "Библиотека для работы с конфигурационными файлами в формате json, yaml",
    "code_snippet": ""
  },
  {
    "title": "rabbitmq",
    "description": "Поддержка RabbitMQ для OneScript",
    "code_snippet": ""
  },
  {
    "title": "verbal-expressions",
    "description": "verbal-expressions - это библиотека для OneScript, помогающая собирать сложные регулярные выражения.",
    "code_snippet": ""
  },
  {
    "title": "markdown",
    "description": "Парсер разметки Markdown для 1Script",
    "code_snippet": ""
  },
  {
    "title": "semver",
    "description": "Библиотека для работы с версиями",
    "code_snippet": ""
  },
  {
    "title": "cli",
    "description": "Command Line Interface для OScript.",
    "code_snippet": ""
  },
  {
    "title": "vanessa-behavior",
    "description": "vanessa-behavior",
    "code_snippet": ""
  },
  {
    "title": "scenex",
    "description": "Выполнение сценариев из файлов JSON.",
    "code_snippet": ""
  },
  {
    "title": "params",
    "description": "Чтение/запись параметров для скриптов OneScript",
    "code_snippet": ""
  },
  {
    "title": "restler",
    "description": "Помощник работы с различными RestAPI",
    "code_snippet": ""
  },
  {
    "title": "cpdb",
    "description": "Набор скриптов oscript для копирования баз данных 1C / MS SQL и развертывания на целевой системе.",
    "code_snippet": ""
  },
  {
    "title": "Чтение файлов Excel в таблицу значений (автоматическое наименование столбцов)",
    "description": "Чтение файлов Excel в таблицу значений (автоматическое наименование столбцов)",
    "code_snippet": "&НаСервере\r\nФункция ПодготовитьТаблицуСДанными(ФайлАдресВХранилище)\r\n\t\r\n\tИмяФайлаСервер = ПолучитьИмяВременногоФайла(\".xlsx\");\r\n\tФайлИмпорта = ПолучитьИзВременногоХранилища(ФайлАдресВХранилище);\r\n\tФайлИмпорта.Записать(ИмяФайлаСервер);\r\n\t\r\n\tТабличныйДокумент = Новый ТабличныйДокумент;\r\n\tПопытка\r\n\t\tТабличныйДокумент.Прочитать(ИмяФайлаСервер, СпособЧтенияЗначенийТабличногоДокумента.Текст);\r\n\tИсключение\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = ОписаниеОшибки();\r\n\t\tСообщение.Сообщить();\r\n\tКонецПопытки;\t\r\n\t\r\n\tПЗ = Новый ПостроительЗапроса;\r\n\tПЗ.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабличныйДокумент.Область());\r\n\tПЗ.ДобавлениеПредставлений = ТипДобавленияПредставлений.НеДобавлять;\r\n\tПЗ.ЗаполнитьНастройки();\r\n\tПЗ.Выполнить();\r\n\t\r\n\tТаблицаПромежуточныхДанных = ПЗ.Результат.Выгрузить();\r\n\t\r\n\tВозврат\tТаблицаПромежуточныхДанных;\r\n\t\r\nКонецФункции\n\n&НаСервере\r\nФункция ПодготовитьТаблицуСДанными(ФайлАдресВХранилище)\r\n\t\r\n\tИмяФайлаСервер = ПолучитьИмяВременногоФайла(\".xlsx\");\r\n\tФайлИмпорта = ПолучитьИзВременногоХранилища(ФайлАдресВХранилище);\r\n\tФайлИмпорта.Записать(ИмяФайлаСервер);\r\n\t\r\n\tТабличныйДокумент = Новый ТабличныйДокумент;\r\n\tПопытка\r\n\t\tТабличныйДокумент.Прочитать(ИмяФайлаСервер, СпособЧтенияЗначенийТабличногоДокумента.Текст);\r\n\tИсключение\r\n\t\tСообщение = Новый СообщениеПользователю;\r\n\t\tСообщение.Текст = ОписаниеОшибки();\r\n\t\tСообщение.Сообщить();\r\n\tКонецПопытки;\t\r\n\t\r\n\tПЗ = Новый ПостроительЗапроса;\r\n\tПЗ.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабличныйДокумент.Область());\r\n\tПЗ.ДобавлениеПредставлений = ТипДобавленияПредставлений.НеДобавлять;\r\n\tПЗ.ЗаполнитьНастройки();\r\n\tПЗ.Выполнить();\r\n\t\r\n\tТаблицаПромежуточныхДанных = ПЗ.Результат.Выгрузить();\r\n\t\r\n\tВозврат\tТаблицаПромежуточныхДанных;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Чтение XML файла",
    "description": "Чтение XML файла",
    "code_snippet": "ЧтениеXML = Новый ЧтениеXML;\r\n\tЧтениеXML.ОткрытьФайл(ИмяФайлаНаСервере);\r\n\tПока ЧтениеXML.Прочитать() Цикл\r\n\t\tЕсли ЧтениеXML.ТипУзла = ТипУзлаXML.НачалоЭлемента Цикл\r\n\t\t\tЕсли ЧтениеXML.Имя = \"Товар\" Тогда // Считываем номенклатуру в XDTO\r\n\t\t\t\tДанныеТовараXML = ФабрикаXDTO.ПрочитатьXML(ЧтениеXML);\r\n\t\t\t\tНоменклатураОбъект = Справочники.Номенклатура.СоздатьОбъект();\r\n\t\t\t\t//  Заполняем реквизиты номенклатруы данными объекта XDTO \r\n\t\t\t\tНоменклатураОбъект.Записать();\r\n\t\t\t\tСообщение = Новый СообщениеПользователю;\r\n\t\t\t\tСообщение.Текст = \"Создана:\" + НоменклатураОбъект.Наименование;\r\n\t\t\t\tСообщение.Сообщить();\r\n\t\t\tИначе\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tЧтениеXML.Закрыть();\n\nЧтениеXML = Новый ЧтениеXML;\r\n\tЧтениеXML.ОткрытьФайл(ИмяФайлаНаСервере);\r\n\tПока ЧтениеXML.Прочитать() Цикл\r\n\t\tЕсли ЧтениеXML.ТипУзла = ТипУзлаXML.НачалоЭлемента Цикл\r\n\t\t\tЕсли ЧтениеXML.Имя = \"Товар\" Тогда // Считываем номенклатуру в XDTO\r\n\t\t\t\tДанныеТовараXML = ФабрикаXDTO.ПрочитатьXML(ЧтениеXML);\r\n\t\t\t\tНоменклатураОбъект = Справочники.Номенклатура.СоздатьОбъект();\r\n\t\t\t\t//  Заполняем реквизиты номенклатруы данными объекта XDTO \r\n\t\t\t\tНоменклатураОбъект.Записать();\r\n\t\t\t\tСообщение = Новый СообщениеПользователю;\r\n\t\t\t\tСообщение.Текст = \"Создана:\" + НоменклатураОбъект.Наименование;\r\n\t\t\t\tСообщение.Сообщить();\r\n\t\t\tИначе\r\n\t\t\t\tЧтениеXML.Прочитать();\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tЧтениеXML.Закрыть();\n\n{4} Ожидается Then\r\nОрфографическая ошибка в номенклатруы: номенклатруы"
  },
  {
    "title": "onescript-extensions",
    "description": "Доп. возможности для OneScript, которые по каким-либо причинам не вошли в движок.",
    "code_snippet": ""
  },
  {
    "title": "v8storage",
    "description": "Библиотека для упрощения работы с Хранилищем 1С из oscript.",
    "code_snippet": ""
  },
  {
    "title": "delegate",
    "description": "Библиотека предназначена для создания и выполнения делегатов/функторов.",
    "code_snippet": ""
  },
  {
    "title": "fluent",
    "description": "Библиотека быстрой обработки коллекций.",
    "code_snippet": ""
  },
  {
    "title": "OneScript-Collections",
    "description": "Компонент по работе с коллекциями .Net",
    "code_snippet": ""
  },
  {
    "title": "ftp",
    "description": "FTP-Клиент для ОдноСкрипта",
    "code_snippet": ""
  },
  {
    "title": "Получение данных динамического списка",
    "description": "Получение данных динамического списка",
    "code_snippet": "Схема = Элементы.Список.ПолучитьИсполняемуюСхемуКомпоновкиДанных();\r\n\tНастройки = Элементы.Список.ПолучитьИсполняемыеНастройкиКомпоновкиДанных();\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(Схема,Настройки,,,Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки);\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\tРезультат = ПроцессорВывода.Вывести(ПроцессорКомпоновки);\n\nСхема = Элементы.Список.ПолучитьИсполняемуюСхемуКомпоновкиДанных();\r\n\tНастройки = Элементы.Список.ПолучитьИсполняемыеНастройкиКомпоновкиДанных();\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(Схема,Настройки,,,Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки);\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\n\tРезультат = ПроцессорВывода.Вывести(ПроцессорКомпоновки);\n\n{8} Переменной Результат присвоено значение, но оно нигде не используется"
  },
  {
    "title": "ReadParams",
    "description": "Чтение параметров из json файла",
    "code_snippet": ""
  },
  {
    "title": "progbar",
    "description": "Консольный прогресс бар для скриптов на OneScript",
    "code_snippet": ""
  },
  {
    "title": "Таблица значений",
    "description": "Таблица значений",
    "code_snippet": "//Создаем таблицу значений\r\n\tТабЗнч = Новый ТаблицаЗначений;\r\n\tТабЗнч.Колонки.Добавить(\"Наименование\");\r\n\tТабЗнч.Колонки.Добавить(\"Значение\");\r\n\t\r\n\t//Заполняем ТЗ\r\n\tДля н=1 По 100 Цикл\r\n\t\t\r\n\t\tСтрокаТЗ = ТабЗнч.Добавить();\r\n\t\tСтрокаТЗ.Наименование = \"Н\"+н;\r\n\t\tСтрокаТЗ.Значение = \"К\"+н;\r\n\t\t\r\n\t\t//Здесь каждый 10-й элемент делаем дубляжом\r\n\t\tЕсли (н%10)=0 Тогда\r\n\t\t\tСтрокаТЗ2 = ТабЗнч.Добавить();\r\n\t\t\tСтрокаТЗ2.Наименование = \"Н\"+н;\r\n\t\t\tСтрокаТЗ2.Значение = \"К\"+н;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t//Перебираем заполненное ТЗ\r\n\tДля й=0 По ТабЗнч.Количество()-1 Цикл\r\n\t\t\r\n\t\t//Не даем провалиться индексу за грани\r\n\t\tЕсли й>ТабЗнч.Количество()-1 Тогда\r\n\t\t\t\r\n\t\t\tПрервать;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//Пропускаем первый элемент\r\n\t\tЕсли й=0 Тогда\r\n\t\t\t\r\n\t\t\tПродолжить;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//Ну и собственно сравниваем значения текущего с предыдущем\r\n\t\tЕсли ТабЗнч[й].Наименование = ТабЗнч[й-1].Наименование Тогда\r\n\t\t\t\r\n\t\t\tТабЗнч[й-1].Значение = ТабЗнч[й-1].Значение + \", \" + ТабЗнч[й].Значение;\r\n\t\t\t\r\n\t\t\tТабЗнч.Удалить(й);\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\n\n//Создаем таблицу значений\r\n\tТабЗнч = Новый ТаблицаЗначений;\r\n\tТабЗнч.Колонки.Добавить(\"Наименование\");\r\n\tТабЗнч.Колонки.Добавить(\"Значение\");\r\n\t\r\n\t//Заполняем ТЗ\r\n\tДля н=1 По 100 Цикл\r\n\t\t\r\n\t\tСтрокаТЗ = ТабЗнч.Добавить();\r\n\t\tСтрокаТЗ.Наименование = \"Н\"+н;\r\n\t\tСтрокаТЗ.Значение = \"К\"+н;\r\n\t\t\r\n\t\t//Здесь каждый 10-й элемент делаем дубляжом\r\n\t\tЕсли (н%10)=0 Тогда\r\n\t\t\tСтрокаТЗ2 = ТабЗнч.Добавить();\r\n\t\t\tСтрокаТЗ2.Наименование = \"Н\"+н;\r\n\t\t\tСтрокаТЗ2.Значение = \"К\"+н;\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t//Перебираем заполненное ТЗ\r\n\tДля й=0 По ТабЗнч.Количество()-1 Цикл\r\n\t\t\r\n\t\t//Не даем провалиться индексу за грани\r\n\t\tЕсли й>ТабЗнч.Количество()-1 Тогда\r\n\t\t\t\r\n\t\t\tПрервать;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//Пропускаем первый элемент\r\n\t\tЕсли й=0 Тогда\r\n\t\t\t\r\n\t\t\tПродолжить;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\t//Ну и собственно сравниваем значения текущего с предыдущем\r\n\t\tЕсли ТабЗнч[й].Наименование = ТабЗнч[й-1].Наименование Тогда\r\n\t\t\t\r\n\t\t\tТабЗнч[й-1].Значение = ТабЗнч[й-1].Значение + \", \" + ТабЗнч[й].Значение;\r\n\t\t\t\r\n\t\t\tТабЗнч.Удалить(й);\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\n\nОрфографическая ошибка в дубляжом: дубляжом"
  },
  {
    "title": "Получить Реквизиты Объекта В Структуру",
    "description": "Получить Реквизиты Объекта В Структуру",
    "code_snippet": "// Возвращает значение или структуру с именами и значениями реквизитов произвольного объекта ссылочного типа\r\n// прочитанные из информационной базы\r\n//\r\n// Параметры:\r\n//  Ссылка - произвольный объект ссылочного типа (справочник, документ, план обмена, ПВХ, задача)\r\n//  СтруктураРеквизитов - Необязательно. Может содержать значения:\r\n//                      строка - имя реквизита объекта.\r\n//                      строка - имена реквизитов, перечисленные через запятую, в формате требований к свойствам структуры.\r\n//                      структура - структура с именами реквизитов.\r\n//\r\n//\r\n// Возвращаемое значение:\r\n//  Структура - если СтруктураРеквизитов имеет тип Структура и заполнен - структура с именами и значениями указанных реквизитов\r\n//  Структура - если СтруктураРеквизитов не указан или не заполнен - структура с именами и значениями всех реквизитов объекта\r\n//  Произвольный - если СтруктураРеквизитов строкового типа - значение данного реквизита\r\n//\r\nФункция ПолучитьРеквизитыОбъекта(Знач Ссылка, Знач СтруктураРеквизитов = Неопределено) Экспорт\r\n\r\n    МетаданныеОбъекта = Ссылка.Метаданные();\r\n    ИмяТаблицы = МетаданныеОбъекта.ПолноеИмя();\r\n\r\n    ЭтоСправочник = Справочники.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка));\r\n    ЭтоПланОбмена = ПланыОбмена.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка));\r\n    ЭтоПВХ = ПланыВидовХарактеристик.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка));\r\n    ЭтоПланВидовРасчета = ПланыВидовРасчета.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка));\r\n    ЭтоДокумент = (Документы.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка)) ИЛИ БизнесПроцессы.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка)));\r\n    ЭтоЗадача = Задачи.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка));\r\n\r\n    ТекстЗапроса = \"ВЫБРАТЬ \";\r\n\r\n    //Формируем список реквизитов объекта для запроса\r\n    Если ТипЗнч(СтруктураРеквизитов) = Тип(\"Строка\") И ЗначениеЗаполнено(СтруктураРеквизитов) Тогда\r\n\r\n        ТекстЗапроса = ТекстЗапроса + СокрЛП(СтруктураРеквизитов);\r\n        //Если передали список реквизитов, инициализируем структуру\r\n        Если Найти(СтруктураРеквизитов, \",\") <> 0 Тогда\r\n            СтруктураРеквизитов = Новый Структура(СтруктураРеквизитов);\r\n        КонецЕсли;\r\n\r\n    ИначеЕсли ТипЗнч(СтруктураРеквизитов) = Тип(\"Структура\") И СтруктураРеквизитов.Количество() > 0 Тогда\r\n\r\n        Для каждого Реквизит Из СтруктураРеквизитов Цикл ТекстЗапроса = ТекстЗапроса + Реквизит.Ключ + \",\"; КонецЦикла;\r\n\r\n        //Отрезаем последнюю запятую\r\n        ТекстЗапроса = Лев(ТекстЗапроса, СтрДлина(ТекстЗапроса) - 1);\r\n\r\n    Иначе\r\n\r\n        //Определяем список реквизитов объектов для подстановки в текст запроса\r\n        СписокРеквизитов = \"\";\r\n        Если ЭтоСправочник ИЛИ ЭтоПланОбмена ИЛИ ЭтоПВХ ИЛИ ЭтоПланВидовРасчета Тогда\r\n            Если МетаданныеОбъекта.ДлинаКода > 0 Тогда\r\n                СписокРеквизитов = \"Код,\";\r\n            КонецЕсли;\r\n            Если МетаданныеОбъекта.ДлинаНаименования > 0 Тогда\r\n                СписокРеквизитов = СписокРеквизитов + \"Наименование,\";\r\n            КонецЕсли;\r\n            Если ЭтоСправочник ИЛИ ЭтоПВХ Тогда\r\n                Если МетаданныеОбъекта.Иерархический Тогда\r\n                    СписокРеквизитов = СписокРеквизитов + \"Родитель,\";\r\n                КонецЕсли;\r\n                Если ЭтоСправочник И (МетаданныеОбъекта.Владельцы.Количество() <> 0) Тогда\r\n                    СписокРеквизитов = СписокРеквизитов + \"Владелец,\";\r\n                КонецЕсли;\r\n            КонецЕсли;\r\n        ИначеЕсли ЭтоДокумент Тогда\r\n            Если МетаданныеОбъекта.ДлинаНомера > 0 Тогда\r\n                СписокРеквизитов = \"Номер,\";\r\n            КонецЕсли;\r\n            СписокРеквизитов =  СписокРеквизитов + \"Дата,\";\r\n        ИначеЕсли ЭтоЗадача Тогда\r\n            Если МетаданныеОбъекта.ДлинаНомера > 0 Тогда\r\n                СписокРеквизитов = \"Номер,\";\r\n            КонецЕсли;\r\n            СписокРеквизитов =  СписокРеквизитов + \"Дата,\";\r\n            Если МетаданныеОбъекта.ДлинаНаименования > 0 Тогда\r\n                СписокРеквизитов = СписокРеквизитов + \"Наименование,\";\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n\r\n        СписокРеквизитов = СписокРеквизитов + \"ПометкаУдаления,\";\r\n\r\n        Для каждого Реквизит Из МетаданныеОбъекта.Реквизиты Цикл СписокРеквизитов = СписокРеквизитов + Реквизит.Имя + \",\"; КонецЦикла;\r\n\r\n        //Отрезаем последнюю запятую\r\n        СписокРеквизитов = Лев(СписокРеквизитов, СтрДлина(СписокРеквизитов) - 1);\r\n        СтруктураРеквизитов = Новый Структура(СписокРеквизитов);\r\n\r\n        ТекстЗапроса = ТекстЗапроса + СписокРеквизитов;\r\n\r\n    КонецЕсли;\r\n\r\n    ТекстЗапроса = ТекстЗапроса + \"\r\n        |ИЗ \" + ИмяТаблицы + \"\r\n        |ГДЕ Ссылка = &Ссылка\";\r\n\r\n    Запрос = Новый Запрос;\r\n    Запрос.Текст = ТекстЗапроса;\r\n    Запрос.УстановитьПараметр(\"Ссылка\", Ссылка);\r\n\r\n    РезультатЗапроса = Запрос.Выполнить();\r\n    Если НЕ РезультатЗапроса.Пустой() Тогда\r\n        Выборка = РезультатЗапроса.Выбрать();\r\n        Если Выборка.Следующий() Тогда\r\n            Если ТипЗнч(СтруктураРеквизитов) = Тип(\"Строка\") И ЗначениеЗаполнено(СтруктураРеквизитов) Тогда\r\n                Возврат Выборка[СтруктураРеквизитов];\r\n            Иначе\r\n                ЗаполнитьЗначенияСвойств(СтруктураРеквизитов, Выборка);\r\n\t\t\t\tСтруктураРеквизитов.Вставить(\"Ссылка\", Ссылка);//++\r\n\t\t\t\tВозврат СтруктураРеквизитов;\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n\r\n    Возврат Неопределено;\r\n\r\nКонецФункции //ПолучитьРеквизитыОбъекта()\n\n// Возвращает значение или структуру с именами и значениями реквизитов произвольного объекта ссылочного типа\r\n// прочитанные из информационной базы\r\n//\r\n// Параметры:\r\n//  Ссылка - произвольный объект ссылочного типа (справочник, документ, план обмена, ПВХ, задача)\r\n//  СтруктураРеквизитов - Необязательно. Может содержать значения:\r\n//                      строка - имя реквизита объекта.\r\n//                      строка - имена реквизитов, перечисленные через запятую, в формате требований к свойствам структуры.\r\n//                      структура - структура с именами реквизитов.\r\n//\r\n//\r\n// Возвращаемое значение:\r\n//  Структура - если СтруктураРеквизитов имеет тип Структура и заполнен - структура с именами и значениями указанных реквизитов\r\n//  Структура - если СтруктураРеквизитов не указан или не заполнен - структура с именами и значениями всех реквизитов объекта\r\n//  Произвольный - если СтруктураРеквизитов строкового типа - значение данного реквизита\r\n//\r\nФункция ПолучитьРеквизитыОбъекта(Знач Ссылка, Знач СтруктураРеквизитов = Неопределено) Экспорт\r\n\r\n    МетаданныеОбъекта = Ссылка.Метаданные();\r\n    ИмяТаблицы = МетаданныеОбъекта.ПолноеИмя();\r\n\r\n    ЭтоСправочник = Справочники.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка));\r\n    ЭтоПланОбмена = ПланыОбмена.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка));\r\n    ЭтоПВХ = ПланыВидовХарактеристик.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка));\r\n    ЭтоПланВидовРасчета = ПланыВидовРасчета.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка));\r\n    ЭтоДокумент = (Документы.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка)) ИЛИ БизнесПроцессы.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка)));\r\n    ЭтоЗадача = Задачи.ТипВсеСсылки().СодержитТип(ТипЗнч(Ссылка));\r\n\r\n    ТекстЗапроса = \"ВЫБРАТЬ \";\r\n\r\n    //Формируем список реквизитов объекта для запроса\r\n    Если ТипЗнч(СтруктураРеквизитов) = Тип(\"Строка\") И ЗначениеЗаполнено(СтруктураРеквизитов) Тогда\r\n\r\n        ТекстЗапроса = ТекстЗапроса + СокрЛП(СтруктураРеквизитов);\r\n        //Если передали список реквизитов, инициализируем структуру\r\n        Если Найти(СтруктураРеквизитов, \",\") <> 0 Тогда\r\n            СтруктураРеквизитов = Новый Структура(СтруктураРеквизитов);\r\n        КонецЕсли;\r\n\r\n    ИначеЕсли ТипЗнч(СтруктураРеквизитов) = Тип(\"Структура\") И СтруктураРеквизитов.Количество() > 0 Тогда\r\n\r\n        Для каждого Реквизит Из СтруктураРеквизитов Цикл ТекстЗапроса = ТекстЗапроса + Реквизит.Ключ + \",\"; КонецЦикла;\r\n\r\n        //Отрезаем последнюю запятую\r\n        ТекстЗапроса = Лев(ТекстЗапроса, СтрДлина(ТекстЗапроса) - 1);\r\n\r\n    Иначе\r\n\r\n        //Определяем список реквизитов объектов для подстановки в текст запроса\r\n        СписокРеквизитов = \"\";\r\n        Если ЭтоСправочник ИЛИ ЭтоПланОбмена ИЛИ ЭтоПВХ ИЛИ ЭтоПланВидовРасчета Тогда\r\n            Если МетаданныеОбъекта.ДлинаКода > 0 Тогда\r\n                СписокРеквизитов = \"Код,\";\r\n            КонецЕсли;\r\n            Если МетаданныеОбъекта.ДлинаНаименования > 0 Тогда\r\n                СписокРеквизитов = СписокРеквизитов + \"Наименование,\";\r\n            КонецЕсли;\r\n            Если ЭтоСправочник ИЛИ ЭтоПВХ Тогда\r\n                Если МетаданныеОбъекта.Иерархический Тогда\r\n                    СписокРеквизитов = СписокРеквизитов + \"Родитель,\";\r\n                КонецЕсли;\r\n                Если ЭтоСправочник И (МетаданныеОбъекта.Владельцы.Количество() <> 0) Тогда\r\n                    СписокРеквизитов = СписокРеквизитов + \"Владелец,\";\r\n                КонецЕсли;\r\n            КонецЕсли;\r\n        ИначеЕсли ЭтоДокумент Тогда\r\n            Если МетаданныеОбъекта.ДлинаНомера > 0 Тогда\r\n                СписокРеквизитов = \"Номер,\";\r\n            КонецЕсли;\r\n            СписокРеквизитов =  СписокРеквизитов + \"Дата,\";\r\n        ИначеЕсли ЭтоЗадача Тогда\r\n            Если МетаданныеОбъекта.ДлинаНомера > 0 Тогда\r\n                СписокРеквизитов = \"Номер,\";\r\n            КонецЕсли;\r\n            СписокРеквизитов =  СписокРеквизитов + \"Дата,\";\r\n            Если МетаданныеОбъекта.ДлинаНаименования > 0 Тогда\r\n                СписокРеквизитов = СписокРеквизитов + \"Наименование,\";\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n\r\n        СписокРеквизитов = СписокРеквизитов + \"ПометкаУдаления,\";\r\n\r\n        Для каждого Реквизит Из МетаданныеОбъекта.Реквизиты Цикл СписокРеквизитов = СписокРеквизитов + Реквизит.Имя + \",\"; КонецЦикла;\r\n\r\n        //Отрезаем последнюю запятую\r\n        СписокРеквизитов = Лев(СписокРеквизитов, СтрДлина(СписокРеквизитов) - 1);\r\n        СтруктураРеквизитов = Новый Структура(СписокРеквизитов);\r\n\r\n        ТекстЗапроса = ТекстЗапроса + СписокРеквизитов;\r\n\r\n    КонецЕсли;\r\n\r\n    ТекстЗапроса = ТекстЗапроса + \"\r\n        |ИЗ \" + ИмяТаблицы + \"\r\n        |ГДЕ Ссылка = &Ссылка\";\r\n\r\n    Запрос = Новый Запрос;\r\n    Запрос.Текст = ТекстЗапроса;\r\n    Запрос.УстановитьПараметр(\"Ссылка\", Ссылка);\r\n\r\n    РезультатЗапроса = Запрос.Выполнить();\r\n    Если НЕ РезультатЗапроса.Пустой() Тогда\r\n        Выборка = РезультатЗапроса.Выбрать();\r\n        Если Выборка.Следующий() Тогда\r\n            Если ТипЗнч(СтруктураРеквизитов) = Тип(\"Строка\") И ЗначениеЗаполнено(СтруктураРеквизитов) Тогда\r\n                Возврат Выборка[СтруктураРеквизитов];\r\n            Иначе\r\n                ЗаполнитьЗначенияСвойств(СтруктураРеквизитов, Выборка);\r\n\t\t\t\tСтруктураРеквизитов.Вставить(\"Ссылка\", Ссылка);//++\r\n\t\t\t\tВозврат СтруктураРеквизитов;\r\n            КонецЕсли;\r\n        КонецЕсли;\r\n    КонецЕсли;\r\n\r\n    Возврат Неопределено;\r\n\r\nКонецФункции //ПолучитьРеквизитыОбъекта()\n\n{17} Высокая цикломатическая сложность: 24"
  },
  {
    "title": "Прибавить к дате день",
    "description": "Прибавить к дате день",
    "code_snippet": "&НаСервереБезКонтекста\r\nФункция ПрибавитьКДатеДень(Дата, КоличествоДней = 1)\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"Дата\", Дата);\r\n\tЗапрос.УстановитьПараметр(\"КоличествоДней\", КоличествоДней);\r\n\tЗапрос.Текст =\r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tДОБАВИТЬКДАТЕ(&Дата, ДЕНЬ, &КоличествоДней) КАК Дата\";\r\n\t\t\r\n\tРезультат = Запрос.Выполнить().Выбрать();\r\n\tРезультат.Следующий();\r\n\tВозврат  Результат.Дата;\r\n\t\r\nКонецФункции\n\n&НаСервереБезКонтекста\r\nФункция ПрибавитьКДатеДень(Дата, КоличествоДней = 1)\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"Дата\", Дата);\r\n\tЗапрос.УстановитьПараметр(\"КоличествоДней\", КоличествоДней);\r\n\tЗапрос.Текст =\r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tДОБАВИТЬКДАТЕ(&Дата, ДЕНЬ, &КоличествоДней) КАК Дата\";\r\n\t\t\r\n\tРезультат = Запрос.Выполнить().Выбрать();\r\n\tРезультат.Следующий();\r\n\tВозврат  Результат.Дата;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "v8unpack",
    "description": "Компонента работы с контейнерами восьмофайлов",
    "code_snippet": ""
  },
  {
    "title": "oscript-app-template",
    "description": "Шаблон-заготовка для консольного приложения на OneScript",
    "code_snippet": ""
  },
  {
    "title": "sql",
    "description": "Работа с SQL базами для 1script",
    "code_snippet": ""
  },
  {
    "title": "vanessa-runner",
    "description": "Автоматизация повседневных операций 1С разработчика",
    "code_snippet": ""
  },
  {
    "title": "Обход иерархии справочника 2",
    "description": "Обход иерархии справочника 2",
    "code_snippet": "Функция ПолучитьВерхнегоРодителяНоменклатуры(мНом)\r\n\t\r\n\tЗапросПодразделения = Новый Запрос; \r\n\t\tЗапросПодразделения.Текст = \r\n\t\t\t\"ВЫБРАТЬ\r\n\t\t\t|   Номенклатура.Ссылка КАК Ссылка\r\n\t\t\t|ИЗ\r\n\t\t\t|    Справочник.Номенклатура КАК Номенклатура\r\n\t\t\t|ГДЕ\r\n\t\t\t|    Номенклатура.Ссылка = &Ссылка\r\n\t\t\t|ИТОГИ ПО\r\n\t\t\t|    Ссылка ТОЛЬКО ИЕРАРХИЯ\";\r\n\t\tЗапросПодразделения.УстановитьПараметр(\"Ссылка\",мНом);\r\n\r\n\t\tВыборка = ЗапросПодразделения.Выполнить().Выбрать();\r\n\t\tМассивРодителей = Новый Массив;\r\n\t\tПока Выборка.Следующий() Цикл \r\n\t\t\t\r\n\t\t\tЕсли Выборка.Ссылка.ЭтоГруппа Тогда\r\n\t\t\t\tМассивРодителей.Добавить(Выборка.Ссылка);\r\n\t\t\tКонецЕсли;\t\r\n\t\tКонецЦикла;\t\r\nВозврат МассивРодителей\n\nФункция ПолучитьВерхнегоРодителяНоменклатуры(мНом)\r\n\t\r\n\tЗапросПодразделения = Новый Запрос; \r\n\t\tЗапросПодразделения.Текст = \r\n\t\t\t\"ВЫБРАТЬ\r\n\t\t\t|   Номенклатура.Ссылка КАК Ссылка\r\n\t\t\t|ИЗ\r\n\t\t\t|    Справочник.Номенклатура КАК Номенклатура\r\n\t\t\t|ГДЕ\r\n\t\t\t|    Номенклатура.Ссылка = &Ссылка\r\n\t\t\t|ИТОГИ ПО\r\n\t\t\t|    Ссылка ТОЛЬКО ИЕРАРХИЯ\";\r\n\t\tЗапросПодразделения.УстановитьПараметр(\"Ссылка\",мНом);\r\n\r\n\t\tВыборка = ЗапросПодразделения.Выполнить().Выбрать();\r\n\t\tМассивРодителей = Новый Массив;\r\n\t\tПока Выборка.Следующий() Цикл \r\n\t\t\t\r\n\t\t\tЕсли Выборка.Ссылка.ЭтоГруппа Тогда\r\n\t\t\t\tМассивРодителей.Добавить(Выборка.Ссылка);\r\n\t\t\tКонецЕсли;\t\r\n\t\tКонецЦикла;\t\r\nВозврат МассивРодителей\n\n{23} Ожидается EndFunction"
  },
  {
    "title": "Заполнение реквизитов формы из ТЧ",
    "description": "Заполнение реквизитов формы из ТЧ",
    "code_snippet": "//обход элементов формы и сравнение с реквизитами табличной части ПараметрыСегментации\t\r\nДля Каждого Стр Из Объект.ПараметрыСегментации Цикл\r\n\t\t\r\n\t\tДля Каждого Элемент Из Элементы Цикл\r\n\t\t\t\r\n\t\t\tЕсли ТипЗнч(Элемент) = Тип(\"ПолеФормы\") Тогда\r\n\t\t\t\t\r\n\t\t\t\tЕсли Элемент.Имя = Стр.ЗаголовокПоля Тогда\r\n\t\t\t\t\t\r\n\t\t\t\t\tУстановитьЗначениеЭлемента(Стр.ЗаголовокПоля,Стр.ЗначениеПоля);\t\t\t\t\t\r\n\t\t\t\t\tЭлемент.ТолькоПросмотр = Истина;\r\n\t\t\t\t\tТекстДействиеЭлемента = ДействиеЭлемента(Стр.ЗаголовокПоля);\r\n\t\t\t\t\tВыполнить(ТекстДействиеЭлемента);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\tИначеЕсли ТипЗнч(Элемент) = Тип(\"ТаблицаФормы\") Тогда\r\n\t\t\t\t\r\n\t\t\t\t//Получаем наименование табличной части из макета\r\n\t\t\t\tПозиция = Найти(Стр.ЗаголовокПоля,\".\");\r\n\t\t\t\tЕсли Позиция <> 0 Тогда\r\n\t\t\t\t\t\r\n\t\t\t\t\tТЧИмя = Лев(Стр.ЗаголовокПоля, Позиция-1);\r\n\t\t\t\t\tЕсли Элемент.Имя = ТЧИмя Тогда\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tЗаголовокПоля = СтрЗаменить(Стр.ЗаголовокПоля,Лев(Стр.ЗаголовокПоля,Позиция),\"\");\r\n\t\t\t\t\t\tУстановитьЗначениеЭлементаТабличнойЧасти(ТЧИмя,ЗаголовокПоля,Стр.ЗначениеПоля);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\t\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЦикла;\r\n\r\n\r\n&НаСервере\r\nПроцедура УстановитьЗначениеЭлемента(ИмяЭлемента,ЗначениеЭлемента)\r\n\t\r\n\tПутьКДаннымЭлемента = ВернутьПутьКДаннымЭлемента(ИмяЭлемента);\r\n\tЕсли Лев(ПутьКДаннымЭлемента,7) = \"Объект.\" Тогда\r\n\t\t\r\n\t\tПутьКДаннымЭлемента = СтрЗаменить(ПутьКДаннымЭлемента,\"Объект.\",\"\");\r\n\t\tОбъект[ПутьКДаннымЭлемента] = ЗначениеЭлемента;\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tЭтаФорма[ПутьКДаннымЭлемента] = ЗначениеЭлемента;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\n\r\n&НаСервере\r\nПроцедура УстановитьЗначениеЭлементаТабличнойЧасти(ТЧИмя,ИмяЭлемента,ЗначениеЭлемента)\r\n\r\n\tПутьКДаннымТЧ = ВернутьПутьКДаннымЭлемента(ТЧИмя);\r\n\r\n\tЕсли Лев(ПутьКДаннымТЧ,7) = \"Объект.\" Тогда\r\n\t\t\r\n\t\tПутьКДаннымТЧ = СтрЗаменить(ПутьКДаннымТЧ,\"Объект.\",\"\");\r\n\t\tЕсли Объект[ПутьКДаннымТЧ].Количество() = 0 Тогда\r\n\t\t\t\r\n\t\t\tСтрокаТЧ = Объект[ПутьКДаннымТЧ].Добавить();\r\n\t\t\tСтрокаТЧ[ИмяЭлемента] = ЗначениеЭлемента;\r\n\t\t\t\r\n\t\tИначе\r\n\t\t\t\r\n\t\t\tСтрокаТЧ = Объект[ПутьКДаннымТЧ].Получить(0);\r\n\t\t\tСтрокаТЧ[ИмяЭлемента] = ЗначениеЭлемента;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tЕсли ЭтаФорма[ПутьКДаннымТЧ].Количество() = 0 Тогда\r\n\t\t\t\r\n\t\t\tСтрокаТЧ = ЭтаФорма[ПутьКДаннымТЧ].Добавить();\r\n\t\t\tСтрокаТЧ[ИмяЭлемента] = ЗначениеЭлемента;\r\n\t\t\t\r\n\t\tИначе\r\n\t\t\t\r\n\t\t\tСтрокаТЧ = ЭтаФорма[ПутьКДаннымТЧ].Получить(0);\r\n\t\t\tСтрокаТЧ[ИмяЭлемента] = ЗначениеЭлемента;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nФункция ВернутьПутьКДаннымЭлемента(ИмяЭлемента)\r\n\r\n\tВозврат Элементы[ИмяЭлемента].ПутьКДанным;\r\n\r\nКонецФункции\n\n//обход элементов формы и сравнение с реквизитами табличной части ПараметрыСегментации\t\r\nДля Каждого Стр Из Объект.ПараметрыСегментации Цикл\r\n\t\t\r\n\t\tДля Каждого Элемент Из Элементы Цикл\r\n\t\t\t\r\n\t\t\tЕсли ТипЗнч(Элемент) = Тип(\"ПолеФормы\") Тогда\r\n\t\t\t\t\r\n\t\t\t\tЕсли Элемент.Имя = Стр.ЗаголовокПоля Тогда\r\n\t\t\t\t\t\r\n\t\t\t\t\tУстановитьЗначениеЭлемента(Стр.ЗаголовокПоля,Стр.ЗначениеПоля);\t\t\t\t\t\r\n\t\t\t\t\tЭлемент.ТолькоПросмотр = Истина;\r\n\t\t\t\t\tТекстДействиеЭлемента = ДействиеЭлемента(Стр.ЗаголовокПоля);\r\n\t\t\t\t\tВыполнить(ТекстДействиеЭлемента);\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\tИначеЕсли ТипЗнч(Элемент) = Тип(\"ТаблицаФормы\") Тогда\r\n\t\t\t\t\r\n\t\t\t\t//Получаем наименование табличной части из макета\r\n\t\t\t\tПозиция = Найти(Стр.ЗаголовокПоля,\".\");\r\n\t\t\t\tЕсли Позиция <> 0 Тогда\r\n\t\t\t\t\t\r\n\t\t\t\t\tТЧИмя = Лев(Стр.ЗаголовокПоля, Позиция-1);\r\n\t\t\t\t\tЕсли Элемент.Имя = ТЧИмя Тогда\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tЗаголовокПоля = СтрЗаменить(Стр.ЗаголовокПоля,Лев(Стр.ЗаголовокПоля,Позиция),\"\");\r\n\t\t\t\t\t\tУстановитьЗначениеЭлементаТабличнойЧасти(ТЧИмя,ЗаголовокПоля,Стр.ЗначениеПоля);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tКонецЕсли;\r\n\t\t\t\t\t\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\t\r\n\t\t\tКонецЕсли;\t\r\n\t\t\t\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЦикла;\r\n\r\n\r\n&НаСервере\r\nПроцедура УстановитьЗначениеЭлемента(ИмяЭлемента,ЗначениеЭлемента)\r\n\t\r\n\tПутьКДаннымЭлемента = ВернутьПутьКДаннымЭлемента(ИмяЭлемента);\r\n\tЕсли Лев(ПутьКДаннымЭлемента,7) = \"Объект.\" Тогда\r\n\t\t\r\n\t\tПутьКДаннымЭлемента = СтрЗаменить(ПутьКДаннымЭлемента,\"Объект.\",\"\");\r\n\t\tОбъект[ПутьКДаннымЭлемента] = ЗначениеЭлемента;\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tЭтаФорма[ПутьКДаннымЭлемента] = ЗначениеЭлемента;\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\r\n\r\n\r\n&НаСервере\r\nПроцедура УстановитьЗначениеЭлементаТабличнойЧасти(ТЧИмя,ИмяЭлемента,ЗначениеЭлемента)\r\n\r\n\tПутьКДаннымТЧ = ВернутьПутьКДаннымЭлемента(ТЧИмя);\r\n\r\n\tЕсли Лев(ПутьКДаннымТЧ,7) = \"Объект.\" Тогда\r\n\t\t\r\n\t\tПутьКДаннымТЧ = СтрЗаменить(ПутьКДаннымТЧ,\"Объект.\",\"\");\r\n\t\tЕсли Объект[ПутьКДаннымТЧ].Количество() = 0 Тогда\r\n\t\t\t\r\n\t\t\tСтрокаТЧ = Объект[ПутьКДаннымТЧ].Добавить();\r\n\t\t\tСтрокаТЧ[ИмяЭлемента] = ЗначениеЭлемента;\r\n\t\t\t\r\n\t\tИначе\r\n\t\t\t\r\n\t\t\tСтрокаТЧ = Объект[ПутьКДаннымТЧ].Получить(0);\r\n\t\t\tСтрокаТЧ[ИмяЭлемента] = ЗначениеЭлемента;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tЕсли ЭтаФорма[ПутьКДаннымТЧ].Количество() = 0 Тогда\r\n\t\t\t\r\n\t\t\tСтрокаТЧ = ЭтаФорма[ПутьКДаннымТЧ].Добавить();\r\n\t\t\tСтрокаТЧ[ИмяЭлемента] = ЗначениеЭлемента;\r\n\t\t\t\r\n\t\tИначе\r\n\t\t\t\r\n\t\t\tСтрокаТЧ = ЭтаФорма[ПутьКДаннымТЧ].Получить(0);\r\n\t\t\tСтрокаТЧ[ИмяЭлемента] = ЗначениеЭлемента;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЕсли;\r\n\r\nКонецПроцедуры\r\n\r\n&НаСервере\r\nФункция ВернутьПутьКДаннымЭлемента(ИмяЭлемента)\r\n\r\n\tВозврат Элементы[ИмяЭлемента].ПутьКДанным;\r\n\r\nКонецФункции\n\n{36} Ожидается идентификатор"
  },
  {
    "title": "oscript-config",
    "description": "Пакет для работы с настройками oscript (содержимое oscript.cfg рядом с oscript.exe или запускаемым скриптом).",
    "code_snippet": ""
  },
  {
    "title": "InternetMail",
    "description": "Работа с почтой в Односкрипте",
    "code_snippet": ""
  },
  {
    "title": "1commands",
    "description": "Библиотека для упрощения работы c запуском различных приложений и командных файлов (cmd, bat, bash, PowerShell и др.) из oscript.",
    "code_snippet": ""
  },
  {
    "title": "os-confluence",
    "description": "Функции взаимодействия с confluence",
    "code_snippet": ""
  },
  {
    "title": "gitrunner",
    "description": "Библиотека для упрощения работы с git из oscript.",
    "code_snippet": ""
  },
  {
    "title": "notify",
    "description": "Описания оповещений",
    "code_snippet": ""
  },
  {
    "title": "1bdd",
    "description": "1bdd - инструмент для выполнения автоматизированных требований/тестов, написанных на обычном, не программном языке.",
    "code_snippet": ""
  },
  {
    "title": "packman",
    "description": "Сей волшебный инструмент позволяет автоматизировать сборку тиражных релизов 1С:Предприятие 8.",
    "code_snippet": ""
  },
  {
    "title": "precommit1c",
    "description": "Набор утилит для автоматической разборки/сборки внешних обработок и отчетов, при помещении (commit) в git",
    "code_snippet": ""
  },
  {
    "title": "gitsync",
    "description": "Синхронизация хранилища 1С с репозиторием git",
    "code_snippet": ""
  },
  {
    "title": "v8runner",
    "description": "Помощник выполнения команд Конфигуратора (v8runner.os)",
    "code_snippet": ""
  },
  {
    "title": "tool1cd",
    "description": "Чтение файловых баз данных 1С с помощью tool1cd",
    "code_snippet": ""
  },
  {
    "title": "tempfiles",
    "description": "Работа с временными файлами",
    "code_snippet": ""
  },
  {
    "title": "messenger",
    "description": "Отправка сообщений адресатам, используя разные транспорты",
    "code_snippet": ""
  },
  {
    "title": "logos",
    "description": "Логирование в стиле log4j",
    "code_snippet": ""
  },
  {
    "title": "asserts",
    "description": "Добавляет в скрипт функционал \"Утверждений\" (assertions).",
    "code_snippet": ""
  },
  {
    "title": "deployka",
    "description": "Развертывание конфигураций 1С на целевой базе 1С.",
    "code_snippet": ""
  },
  {
    "title": "gui",
    "description": "Компонент по созданию форм для 1script",
    "code_snippet": ""
  },
  {
    "title": "1testrunner",
    "description": "Приемочное тестирование",
    "code_snippet": ""
  },
  {
    "title": "oscript-yadisk",
    "description": "Реализация API Яндекс.Диска для 1Script",
    "code_snippet": ""
  },
  {
    "title": "yadisk-uploader",
    "description": "Скрипт на 1Script для загрузки и публикации файлов на Яндекс.Диск",
    "code_snippet": ""
  },
  {
    "title": "parserV8i",
    "description": "Парсинг v8i файла",
    "code_snippet": ""
  },
  {
    "title": "fs",
    "description": "Часто применяемые операции для работы с файловой системой",
    "code_snippet": ""
  },
  {
    "title": "Подключение к Firebird",
    "description": "Подключение к Firebird",
    "code_snippet": "Если ЭлементыФормы.ФайлИмпорта.Значение = \"\" Тогда\r\n\t\tПредупреждение(\"Неуказан файл\");\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\tСтрокаПодключения =  \"Driver=Firebird/InterBase(r) driver;\" ;\r\n\tСтрокаПодключения = СтрокаПодключения + \"Dbname=Localhost:\"+ ЭлементыФормы.ФайлИмпорта.Значение + \";\";\r\n\tСтрокаПодключения = СтрокаПодключения + \"UID=SYSDBA;PWD=masterkey;CHARSET=WIN1251\";\t\t\r\n\t// Подключаемся к базе данных \t\r\n\tConnection = Новый COMОбъект(\"ADODB.Connection\");\r\n\tConnection.ConnectionTimeout = 15; \r\n\tConnection.CursorLocation = 3;\r\n\tConnection.ConnectionString = СтрокаПодключения; \r\n\tConnection.Open();\r\n\tСообщить(\"Соединение успешно уставнолено !!!\");\n\nЕсли ЭлементыФормы.ФайлИмпорта.Значение = \"\" Тогда\r\n\t\tПредупреждение(\"Неуказан файл\");\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\tСтрокаПодключения =  \"Driver=Firebird/InterBase(r) driver;\" ;\r\n\tСтрокаПодключения = СтрокаПодключения + \"Dbname=Localhost:\"+ ЭлементыФормы.ФайлИмпорта.Значение + \";\";\r\n\tСтрокаПодключения = СтрокаПодключения + \"UID=SYSDBA;PWD=masterkey;CHARSET=WIN1251\";\t\t\r\n\t// Подключаемся к базе данных \t\r\n\tConnection = Новый COMОбъект(\"ADODB.Connection\");\r\n\tConnection.ConnectionTimeout = 15; \r\n\tConnection.CursorLocation = 3;\r\n\tConnection.ConnectionString = СтрокаПодключения; \r\n\tConnection.Open();\r\n\tСообщить(\"Соединение успешно уставнолено !!!\");\n\nОрфографическая ошибка в Firebird (найдено 3): Firebird\r\nОрфографическая ошибка в Dbname: Dbname\r\nОрфографическая ошибка в Localhost: Localhost\r\nОрфографическая ошибка в masterkey: masterkey\r\nОрфографическая ошибка в уставнолено: уставнолено"
  },
  {
    "title": "cmdline",
    "description": "Парсер командной строки",
    "code_snippet": ""
  },
  {
    "title": "opm",
    "description": "OneScript Package Manager",
    "code_snippet": ""
  },
  {
    "title": "Количество дублей элементов справочника",
    "description": "Количество дублей элементов справочника",
    "code_snippet": "ВЫБРАТЬ\r\n        Товары.Наименование КАК Наименование,\r\n        КОЛИЧЕСТВО(Товары.Ссылка) КАК КоличествоДублей\r\nИЗ\r\n        Справочник.Товары КАК Товары\r\nСГРУППИРОВАТЬ ПО\r\n        Товары.Наименование\r\nИМЕЮЩИЕ КОЛИЧЕСТВО(Товары.Ссылка) > 1\n\nВЫБРАТЬ\r\n        Товары.Наименование КАК Наименование,\r\n        КОЛИЧЕСТВО(Товары.Ссылка) КАК КоличествоДублей\r\nИЗ\r\n        Справочник.Товары КАК Товары\r\nСГРУППИРОВАТЬ ПО\r\n        Товары.Наименование\r\nИМЕЮЩИЕ КОЛИЧЕСТВО(Товары.Ссылка) > 1\n\n{2} Ожидается идентификатор"
  },
  {
    "title": "Обработка Журнала Регистрации",
    "description": "Обработка Журнала Регистрации",
    "code_snippet": "ПараметрыСоединения = Новый ПараметрыСоединенияВнешнегоИсточникаДанных;\r\nПараметрыСоединения.СтрокаСоединения = \"DRIVER=SQLite3 ODBC Driver;Database=\" + ФайлЖурналаРегистрации + \";BigInt=1;\";\r\nВнешниеИсточникиДанных.ЖурналРегистрации.УстановитьОбщиеПараметрыСоединения(ПараметрыСоединения);\r\nВнешниеИсточникиДанных.ЖурналРегистрации.УстановитьСоединение();\r\n\r\nЗапрос = Новый Запрос();\r\nЗапрос.Текст = \"ВЫБРАТЬ\r\n               |    ЗаписиЖурнала.Код,\r\n               |    ЗаписиЖурнала.Важность,\r\n               |    ЗаписиЖурнала.Дата,\r\n               |    ЗаписиЖурнала.СтатусТранзакции,\r\n               |    ЗаписиЖурнала.ДатаТранзакции,\r\n               |    ЗаписиЖурнала.ИдентификаторТранзакции,\r\n               |    ЗаписиЖурнала.Пользователь,\r\n               |    ЗаписиЖурнала.Пользователь.Код,\r\n               |    ЗаписиЖурнала.Пользователь.Наименование,\r\n               |    ЗаписиЖурнала.Компьютер.Код,\r\n               |    ЗаписиЖурнала.Компьютер.Наименование,\r\n               |    ЗаписиЖурнала.Приложение.Код,\r\n               |    ЗаписиЖурнала.Приложение.Наименование,\r\n               |    ЗаписиЖурнала.Событие.Код,\r\n               |    ЗаписиЖурнала.Событие.Наименование,\r\n               |    ЗаписиЖурнала.Комментарий,\r\n               |    ЗаписиЖурнала.Данные,\r\n               |    ЗаписиЖурнала.ПредставлениеДанных,\r\n               |    ЗаписиЖурнала.РабочийСервер,\r\n               |    ЗаписиЖурнала.РабочийСервер.Код,\r\n               |    ЗаписиЖурнала.РабочийСервер.Наименование,\r\n               |    ЗаписиЖурнала.ОсновнойПорт,\r\n               |    ЗаписиЖурнала.ВспомогательныйПорт\r\n               |ИЗ\r\n               |    ВнешнийИсточникДанных.ЖурналРегистрации.Таблица.ЗаписиЖурнала КАК ЗаписиЖурнала\";\r\n                   \r\nТаблицаДанных = Запрос.Выполнить().Выгрузить();\r\nВнешниеИсточникиДанных.ЖурналРегистрации.РазорватьСоединение();\r\n\r\n//ОбычнаяДата = '00010101000000' + 635453673444260/10000; //03.09.2014 18:55:44\n\nПараметрыСоединения = Новый ПараметрыСоединенияВнешнегоИсточникаДанных;\r\nПараметрыСоединения.СтрокаСоединения = \"DRIVER=SQLite3 ODBC Driver;Database=\" + ФайлЖурналаРегистрации + \";BigInt=1;\";\r\nВнешниеИсточникиДанных.ЖурналРегистрации.УстановитьОбщиеПараметрыСоединения(ПараметрыСоединения);\r\nВнешниеИсточникиДанных.ЖурналРегистрации.УстановитьСоединение();\r\n\r\nЗапрос = Новый Запрос();\r\nЗапрос.Текст = \"ВЫБРАТЬ\r\n               |    ЗаписиЖурнала.Код,\r\n               |    ЗаписиЖурнала.Важность,\r\n               |    ЗаписиЖурнала.Дата,\r\n               |    ЗаписиЖурнала.СтатусТранзакции,\r\n               |    ЗаписиЖурнала.ДатаТранзакции,\r\n               |    ЗаписиЖурнала.ИдентификаторТранзакции,\r\n               |    ЗаписиЖурнала.Пользователь,\r\n               |    ЗаписиЖурнала.Пользователь.Код,\r\n               |    ЗаписиЖурнала.Пользователь.Наименование,\r\n               |    ЗаписиЖурнала.Компьютер.Код,\r\n               |    ЗаписиЖурнала.Компьютер.Наименование,\r\n               |    ЗаписиЖурнала.Приложение.Код,\r\n               |    ЗаписиЖурнала.Приложение.Наименование,\r\n               |    ЗаписиЖурнала.Событие.Код,\r\n               |    ЗаписиЖурнала.Событие.Наименование,\r\n               |    ЗаписиЖурнала.Комментарий,\r\n               |    ЗаписиЖурнала.Данные,\r\n               |    ЗаписиЖурнала.ПредставлениеДанных,\r\n               |    ЗаписиЖурнала.РабочийСервер,\r\n               |    ЗаписиЖурнала.РабочийСервер.Код,\r\n               |    ЗаписиЖурнала.РабочийСервер.Наименование,\r\n               |    ЗаписиЖурнала.ОсновнойПорт,\r\n               |    ЗаписиЖурнала.ВспомогательныйПорт\r\n               |ИЗ\r\n               |    ВнешнийИсточникДанных.ЖурналРегистрации.Таблица.ЗаписиЖурнала КАК ЗаписиЖурнала\";\r\n                   \r\nТаблицаДанных = Запрос.Выполнить().Выгрузить();\r\nВнешниеИсточникиДанных.ЖурналРегистрации.РазорватьСоединение();\r\n\r\n//ОбычнаяДата = '00010101000000' + 635453673444260/10000; //03.09.2014 18:55:44\n\n{34} Переменной ТаблицаДанных присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в sqlite: sqlite"
  },
  {
    "title": "Распределить Сумму Пропорционально Коэффициентам",
    "description": "Распределить Сумму Пропорционально Коэффициентам",
    "code_snippet": "// Выполняет пропорциональное распределение суммы в соответствии\r\n// с заданными коэффициентами распределения.\r\n//\r\n// Параметры:\r\n//  РаспределяемаяСумма - Число - сумма, которую надо распределить;\r\n//  МассивКоэффициентов - Массив - коэффициенты распределения;\r\n//  Точность - Число - точность округления при распределении. Необязателен.\r\n//\r\n// Возвращаемое значение:\r\n//  Массив - массив размерностью равный массиву коэффициентов, содержит\r\n//           суммы в соответствии с весом коэффициента (из массива коэффициентов).\r\n//           В случае если распределить не удалось (сумма = 0, кол-во коэффициентов = 0,\r\n//           или суммарный вес коэффициентов = 0), тогда возвращается значение Неопределено.\r\n//\r\n\r\nФункция РаспределитьСуммуПропорциональноКоэффициентам(Знач РаспределяемаяСумма, Коэффициенты, Знач Точность = 2) Экспорт\r\n\r\n    Если Коэффициенты.Количество() = 0 или Не ЗначениеЗаполнено(РаспределяемаяСумма) Тогда\r\n        Возврат Неопределено;\r\n    КонецЕсли;\r\n    \r\n    ИндексМаксимальногоКоэффициента = 0;\r\n    МаксимальныйКоэффициент = 0;\r\n    РаспределеннаяСумма = 0;\r\n    СуммаКоэффициентов  = 0;   \r\n    Для Индекс = 0 По Коэффициенты.Количество() - 1 Цикл\r\n        Коэффициент = Коэффициенты[Индекс];       \r\n        АбсолютноеЗначениеКоэффициента = ?(Коэффициент > 0, Коэффициент, -Коэффициент);\r\n        Если МаксимальныйКоэффициент < АбсолютноеЗначениеКоэффициента Тогда\r\n            МаксимальныйКоэффициент = АбсолютноеЗначениеКоэффициента;\r\n            ИндексМаксимальногоКоэффициента = Индекс;\r\n        КонецЕсли;\r\n        СуммаКоэффициентов = СуммаКоэффициентов + Коэффициент;\r\n    КонецЦикла;\r\n    Если СуммаКоэффициентов = 0 Тогда\r\n        Возврат Неопределено;\r\n    КонецЕсли;\r\n    Результат = Новый Массив(Коэффициенты.Количество()); \r\n    Для Индекс = 0 По Коэффициенты.Количество() - 1 Цикл\r\n        Результат[Индекс] = Окр(РаспределяемаяСумма * Коэффициенты[Индекс] / СуммаКоэффициентов, Точность, 1);\r\n        РаспределеннаяСумма = РаспределеннаяСумма + Результат[Индекс];\r\n    КонецЦикла; \r\n    // Погрешности округления отнесем на коэффициент с максимальным весом.\r\n    Если Не РаспределеннаяСумма = РаспределяемаяСумма Тогда\r\n        Результат[ИндексМаксимальногоКоэффициента] = Результат[ИндексМаксимальногоКоэффициента] + РаспределяемаяСумма - РаспределеннаяСумма;\r\n    КонецЕсли;    \r\n    Возврат Результат;  \r\nКонецФункции\r\n//в последней строчке делай = общая сумма - уже распределили\n\n// Выполняет пропорциональное распределение суммы в соответствии\r\n// с заданными коэффициентами распределения.\r\n//\r\n// Параметры:\r\n//  РаспределяемаяСумма - Число - сумма, которую надо распределить;\r\n//  МассивКоэффициентов - Массив - коэффициенты распределения;\r\n//  Точность - Число - точность округления при распределении. Необязателен.\r\n//\r\n// Возвращаемое значение:\r\n//  Массив - массив размерностью равный массиву коэффициентов, содержит\r\n//           суммы в соответствии с весом коэффициента (из массива коэффициентов).\r\n//           В случае если распределить не удалось (сумма = 0, кол-во коэффициентов = 0,\r\n//           или суммарный вес коэффициентов = 0), тогда возвращается значение Неопределено.\r\n//\r\n\r\nФункция РаспределитьСуммуПропорциональноКоэффициентам(Знач РаспределяемаяСумма, Коэффициенты, Знач Точность = 2) Экспорт\r\n\r\n    Если Коэффициенты.Количество() = 0 или Не ЗначениеЗаполнено(РаспределяемаяСумма) Тогда\r\n        Возврат Неопределено;\r\n    КонецЕсли;\r\n    \r\n    ИндексМаксимальногоКоэффициента = 0;\r\n    МаксимальныйКоэффициент = 0;\r\n    РаспределеннаяСумма = 0;\r\n    СуммаКоэффициентов  = 0;   \r\n    Для Индекс = 0 По Коэффициенты.Количество() - 1 Цикл\r\n        Коэффициент = Коэффициенты[Индекс];       \r\n        АбсолютноеЗначениеКоэффициента = ?(Коэффициент > 0, Коэффициент, -Коэффициент);\r\n        Если МаксимальныйКоэффициент < АбсолютноеЗначениеКоэффициента Тогда\r\n            МаксимальныйКоэффициент = АбсолютноеЗначениеКоэффициента;\r\n            ИндексМаксимальногоКоэффициента = Индекс;\r\n        КонецЕсли;\r\n        СуммаКоэффициентов = СуммаКоэффициентов + Коэффициент;\r\n    КонецЦикла;\r\n    Если СуммаКоэффициентов = 0 Тогда\r\n        Возврат Неопределено;\r\n    КонецЕсли;\r\n    Результат = Новый Массив(Коэффициенты.Количество()); \r\n    Для Индекс = 0 По Коэффициенты.Количество() - 1 Цикл\r\n        Результат[Индекс] = Окр(РаспределяемаяСумма * Коэффициенты[Индекс] / СуммаКоэффициентов, Точность, 1);\r\n        РаспределеннаяСумма = РаспределеннаяСумма + Результат[Индекс];\r\n    КонецЦикла; \r\n    // Погрешности округления отнесем на коэффициент с максимальным весом.\r\n    Если Не РаспределеннаяСумма = РаспределяемаяСумма Тогда\r\n        Результат[ИндексМаксимальногоКоэффициента] = Результат[ИндексМаксимальногоКоэффициента] + РаспределяемаяСумма - РаспределеннаяСумма;\r\n    КонецЕсли;    \r\n    Возврат Результат;  \r\nКонецФункции\r\n//в последней строчке делай = общая сумма - уже распределили"
  },
  {
    "title": "часть строки",
    "description": "часть строки",
    "code_snippet": "//******************************************************************************\r\n&НаКлиентеНаСервереБезКонтекста\r\nФункция ЧастьСтроки(Знач ИсхСтрока,Разделитель,НомерЧасти) Экспорт\r\n\tИсхСтрока=СтрЗаменить(ИсхСтрока,Разделитель,Символы.ПС);\r\n\tЕсли Строка(НомерЧасти)=\"последняя\" Тогда\r\n\t\tВозврат СтрПолучитьСтроку(ИсхСтрока,СтрЧислоСтрок(ИсхСтрока));\r\n\tИначе\r\n\t\tВозврат СтрПолучитьСтроку(ИсхСтрока,НомерЧасти);\r\n\tКонецЕсли;\r\nКонецФункции\n\n//******************************************************************************\r\n&НаКлиентеНаСервереБезКонтекста\r\nФункция ЧастьСтроки(Знач ИсхСтрока,Разделитель,НомерЧасти) Экспорт\r\n\tИсхСтрока=СтрЗаменить(ИсхСтрока,Разделитель,Символы.ПС);\r\n\tЕсли Строка(НомерЧасти)=\"последняя\" Тогда\r\n\t\tВозврат СтрПолучитьСтроку(ИсхСтрока,СтрЧислоСтрок(ИсхСтрока));\r\n\tИначе\r\n\t\tВозврат СтрПолучитьСтроку(ИсхСтрока,НомерЧасти);\r\n\tКонецЕсли;\r\nКонецФункции\n\nОрфографическая ошибка в подстрокй: подстрокй\r\nОрфографическая ошибка в номеруу: номеруу"
  },
  {
    "title": "Выделенные строки",
    "description": "Выделенные строки",
    "code_snippet": "ВыделенныеСтроки = Элементы.Список.ВыделенныеСтроки; \r\nСумма = 0; \r\nДля Каждого Строка Из ВыделенныеСтроки Цикл \r\n         Сумма = Сумма + Элементы.Список.ДанныеСтроки(Строка).Сумма; \r\nКонецЦикла;\n\nВыделенныеСтроки = Элементы.Список.ВыделенныеСтроки; \r\nСумма = 0; \r\nДля Каждого Строка Из ВыделенныеСтроки Цикл \r\n         Сумма = Сумма + Элементы.Список.ДанныеСтроки(Строка).Сумма; \r\nКонецЦикла;"
  },
  {
    "title": "Соединение и запрос данных из другой базы 1с",
    "description": "Соединение и запрос данных из другой базы 1с",
    "code_snippet": "//Подключение к внешней базе\r\n&НаСервере\r\n Функция ПодключитьВнешнийИсточник(СтрокаСоединения, ОбъектПодключения=\"V82.COMConnector\") \r\n\t Попытка\r\n\t\t Connector = Новый COMОбъект(\"V82.COMConnector\");\r\n\t\t COM = Connector.connect(СтрокаСоединения);\r\n\t\t Возврат COM;\r\n\t Исключение\r\n\t\t  Сообщить(ОписаниеОшибки(), СтатусСообщения.Важное);\r\n\t\t  Возврат Неопределено;\r\n\t КонецПопытки;\r\n\t \r\n КонецФункции\t\r\n\r\n\r\n&НаКлиенте\r\nПроцедура Подключение(Команда)\r\n\tПодключениеСервер();\r\nКонецПроцедуры\r\n\r\n\r\n//Подключение и Выгрузка данных из сторонней базы\r\n&НаСервере\r\nПроцедура ПодключениеСервер()\r\n\t Соединение = ПодключитьВнешнийИсточник(\"Srvr=\"\"ИмяСервера\"\";Ref=\"\"ИмяБазы\"\";Usr=\"\"Пользователь\"\";Pwd=\"\"Пароль\"\";\");\r\n\t Запрос = Соединение.NewObject(\"Запрос\");\r\n\t Запрос.Текст = \"ВЫБРАТЬ\r\n\t\t|\tРеализацияТоваровУслуг.Номер\r\n\t\t|\t\tИЗ\r\n\t\t|\tДокумент.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг\r\n\t\t|\t\tГДЕ\r\n\t\t|\tРеализацияТоваровУслуг.Номер =  &Номер\";\r\n\tЗапрос.УстановитьПараметр(\"Номер\",Номер);\r\n\tРезультатЗапроса = Запрос.Выполнить().Выгрузить(); //Получили COM объект\r\n\tПреобразование = ЗначениеИзСтрокиВнутр(Соединение.ЗначениеВСтрокуВнутр(РезультатЗапроса));  //преобразовали COM объект\r\n\r\n\tДля каждого стр из Преобразование Цикл\r\n\t\tСообщить(стр.номер);\r\n\tКонецЦикла;\r\n\t\t\r\nКонецПроцедуры\n\n//Подключение к внешней базе\r\n&НаСервере\r\n Функция ПодключитьВнешнийИсточник(СтрокаСоединения, ОбъектПодключения=\"V82.COMConnector\") \r\n\t Попытка\r\n\t\t Connector = Новый COMОбъект(\"V82.COMConnector\");\r\n\t\t COM = Connector.connect(СтрокаСоединения);\r\n\t\t Возврат COM;\r\n\t Исключение\r\n\t\t  Сообщить(ОписаниеОшибки(), СтатусСообщения.Важное);\r\n\t\t  Возврат Неопределено;\r\n\t КонецПопытки;\r\n\t \r\n КонецФункции\t\r\n\r\n\r\n&НаКлиенте\r\nПроцедура Подключение(Команда)\r\n\tПодключениеСервер();\r\nКонецПроцедуры\r\n\r\n\r\n//Подключение и Выгрузка данных из сторонней базы\r\n&НаСервере\r\nПроцедура ПодключениеСервер()\r\n\t Соединение = ПодключитьВнешнийИсточник(\"Srvr=\"\"ИмяСервера\"\";Ref=\"\"ИмяБазы\"\";Usr=\"\"Пользователь\"\";Pwd=\"\"Пароль\"\";\");\r\n\t Запрос = Соединение.NewObject(\"Запрос\");\r\n\t Запрос.Текст = \"ВЫБРАТЬ\r\n\t\t|\tРеализацияТоваровУслуг.Номер\r\n\t\t|\t\tИЗ\r\n\t\t|\tДокумент.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг\r\n\t\t|\t\tГДЕ\r\n\t\t|\tРеализацияТоваровУслуг.Номер =  &Номер\";\r\n\tЗапрос.УстановитьПараметр(\"Номер\",Номер);\r\n\tРезультатЗапроса = Запрос.Выполнить().Выгрузить(); //Получили COM объект\r\n\tПреобразование = ЗначениеИзСтрокиВнутр(Соединение.ЗначениеВСтрокуВнутр(РезультатЗапроса));  //преобразовали COM объект\r\n\r\n\tДля каждого стр из Преобразование Цикл\r\n\t\tСообщить(стр.номер);\r\n\tКонецЦикла;\r\n\t\t\r\nКонецПроцедуры"
  },
  {
    "title": "Связанные документы",
    "description": "Связанные документы",
    "code_snippet": "СвязанныеДокументы = КритерииОтбора.СвязанныеДокументы.Найти(ВыбДок);\r\nДля Каждого ТекСвязанныйДокумент из СвязанныеДокументы Цикл\r\nСообщить(ТекСвязанныйДокумент);\r\nКонецЦикла;\n\nСвязанныеДокументы = КритерииОтбора.СвязанныеДокументы.Найти(ВыбДок);\r\nДля Каждого ТекСвязанныйДокумент из СвязанныеДокументы Цикл\r\nСообщить(ТекСвязанныйДокумент);\r\nКонецЦикла;"
  },
  {
    "title": "Демонстрация асинхр. вызова 01",
    "description": "Демонстрация асинхр. вызова 01",
    "code_snippet": "&НаКлиенте\r\nПроцедура ВыполнитьКоманду(Команда)\r\n    ОбратныйВызов = Новый ОписаниеОповещения(\"ПредупреждениеЗавершение\", ЭтотОбъект);\r\n    ПоказатьПредупреждение(ОбратныйВызов, \"Закрытие формы обрабатывается отдельно\");\r\nКонецПроцедуры\r\n&НаКлиенте\r\nПроцедура ПредупреждениеЗавершение(ДополнительныеПараметры) Экспорт\r\n    // какие-то действия\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура ВыполнитьКоманду(Команда)\r\n    ОбратныйВызов = Новый ОписаниеОповещения(\"ПредупреждениеЗавершение\", ЭтотОбъект);\r\n    ПоказатьПредупреждение(ОбратныйВызов, \"Закрытие формы обрабатывается отдельно\");\r\nКонецПроцедуры\r\n&НаКлиенте\r\nПроцедура ПредупреждениеЗавершение(ДополнительныеПараметры) Экспорт\r\n    // какие-то действия\r\nКонецПроцедуры\n\nОрфографическая ошибка в асинхр: асинхр"
  },
  {
    "title": "Ограничение, одним видом документов, запроса из регистра",
    "description": "Ограничение, одним видом документов, запроса из регистра",
    "code_snippet": "\" ВЫБРАТЬ\r\n|\tТоварыОрганизаций.Номенклатура,\r\n|\tТоварыОрганизаций.СерияНоменклатуры,\r\n|\tТоварыОрганизаций.Склад,\r\n|\tТоварыОрганизаций.Количество,\r\n|\tТоварыОрганизаций.Организация,\r\n|\tТоварыОрганизаций.Регистратор\r\n|ИЗ\r\n|\tРегистрНакопления.ТоварыОрганизаций КАК ТоварыОрганизаций\r\n|ГДЕ\r\n|\tТоварыОрганизаций.Регистратор ССЫЛКА Документ.ТребованиеНакладная\";\n\n\" ВЫБРАТЬ\r\n|\tТоварыОрганизаций.Номенклатура,\r\n|\tТоварыОрганизаций.СерияНоменклатуры,\r\n|\tТоварыОрганизаций.Склад,\r\n|\tТоварыОрганизаций.Количество,\r\n|\tТоварыОрганизаций.Организация,\r\n|\tТоварыОрганизаций.Регистратор\r\n|ИЗ\r\n|\tРегистрНакопления.ТоварыОрганизаций КАК ТоварыОрганизаций\r\n|ГДЕ\r\n|\tТоварыОрганизаций.Регистратор ССЫЛКА Документ.ТребованиеНакладная\";\n\n{} Ожидается идентификатор"
  },
  {
    "title": "Получить менеджер объекта по переданной ссылке",
    "description": "Получить менеджер объекта по переданной ссылке",
    "code_snippet": "// Возвращает менеджер объекта по переданной ссылке.\r\n// Не обрабатываются точки маршрутов бизнес-процессов.\r\nФункция МенеджерОбъектаПоСсылке(Ссылка) Экспорт\r\n\t\r\n\tИмяОбъекта = Ссылка.Метаданные().Имя;\r\n\t\r\n\tТипСсылки = ТипЗнч(Ссылка);\r\n\t\r\n\tЕсли Справочники.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат Справочники[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли Документы.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат Документы[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли БизнесПроцессы.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат БизнесПроцессы[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли ПланыВидовХарактеристик.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат ПланыВидовХарактеристик[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли ПланыСчетов.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат ПланыСчетов[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли ПланыВидовРасчета.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат ПланыВидовРасчета[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли Задачи.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат Задачи[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли ПланыОбмена.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат ПланыОбмена[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли Перечисления.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат Перечисления[ИмяОбъекта];\r\n\t\t\r\n\tИначе\t\r\n\t\t\r\n\t\tВозврат НеОпределено;\r\n\t\t\r\n\tКонецЕсли; \r\n\t\r\nКонецФункции\n\n// Возвращает менеджер объекта по переданной ссылке.\r\n// Не обрабатываются точки маршрутов бизнес-процессов.\r\nФункция МенеджерОбъектаПоСсылке(Ссылка) Экспорт\r\n\t\r\n\tИмяОбъекта = Ссылка.Метаданные().Имя;\r\n\t\r\n\tТипСсылки = ТипЗнч(Ссылка);\r\n\t\r\n\tЕсли Справочники.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат Справочники[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли Документы.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат Документы[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли БизнесПроцессы.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат БизнесПроцессы[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли ПланыВидовХарактеристик.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат ПланыВидовХарактеристик[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли ПланыСчетов.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат ПланыСчетов[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли ПланыВидовРасчета.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат ПланыВидовРасчета[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли Задачи.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат Задачи[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли ПланыОбмена.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат ПланыОбмена[ИмяОбъекта];\r\n\t\t\r\n\tИначеЕсли Перечисления.ТипВсеСсылки().СодержитТип(ТипСсылки) Тогда\r\n\t\t\r\n\t\tВозврат Перечисления[ИмяОбъекта];\r\n\t\t\r\n\tИначе\t\r\n\t\t\r\n\t\tВозврат НеОпределено;\r\n\t\t\r\n\tКонецЕсли; \r\n\t\r\nКонецФункции\n\n{3} Высокая цикломатическая сложность: 30"
  },
  {
    "title": "Отправка сообщений от имени бота Telegram",
    "description": "Отправка сообщений от имени бота Telegram",
    "code_snippet": "Перем ТекстСообщения;\r\nchat_id=ЭлементыФормы.СправочникСписок.ТекущиеДанные.chat.id;\r\n//chat_id это идентификатор диалога,\r\n//в переменной хранится id пользователя (объект User) с которым ведётся диалог\r\n//https://core.telegram.org/bots/api#user\r\nВвестиСтроку(ТекстСообщения);\r\nЕсли НЕ ЗначениеЗаполнено(ТекстСообщения) тогда возврат конецесли;\r\n\r\nЗапрос=Новый HTTPЗапрос();\r\nЗапрос.АдресРесурса=Константы.token.Получить()+\"/sendMessage\";\r\nЗапрос.Заголовки=Новый Соответствие();\r\n\r\nСоединение = Новый HTTPСоединение(\"api.telegram.org\",,,,,5,Новый ЗащищенноеСоединениеOpenSSL);\r\nТекстЗапроса=\"\";\r\nТекстЗапроса=ТекстЗапроса+\"&chat_id=\"+Формат(chat_id,\"ЧГ=\");\r\nТекстЗапроса=ТекстЗапроса+\"&text=\"+КодироватьСтроку(ТекстСообщения,СпособКодированияСтроки.КодировкаURL);\r\n//КодироватьСтроку() отсутствует в 8.2 ищите сами как сделать url encode\r\nЗапрос.Заголовки.Вставить(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\nЗапрос.УстановитьТелоИзСтроки(ТекстЗапроса);\r\nОтвет=Соединение.ОтправитьДляОбработки(Запрос);//POST\r\nКодСостояния=Ответ.КодСостояния;\r\nСтрокаОтвета=Ответ.ПолучитьТелоКакСтроку();\r\n\r\nЕсли КодСостояния=200 тогда\r\n\tЧтениеОтвета=Новый ЧтениеJSON;\r\n\tЧтениеОтвета.УстановитьСтроку(СтрокаОтвета);\r\n\tРезультатСтруктура=ПрочитатьJSON(ЧтениеОтвета);\r\n\tЕсли РезультатСтруктура.ok=Истина тогда\r\n\t\tСтруктураMessage=РезультатСтруктура.result;\r\n\t\t//СтруктураMessage это обычная Структура\r\n\t\t//сервер возвращает нам наше сообщение упакованое в объект Message\r\n\t\t//описание объекта Message тут https://core.telegram.org/bots/api#message\r\n\tКонецЕсли;\r\nИначе\r\n\tСообщить(\"КодСостояния \"+КодСостояния);\r\n\tСообщить(СтрокаОтвета);\r\nКонецЕсли;\n\nПерем ТекстСообщения;\r\nchat_id=ЭлементыФормы.СправочникСписок.ТекущиеДанные.chat.id;\r\n//chat_id это идентификатор диалога,\r\n//в переменной хранится id пользователя (объект User) с которым ведётся диалог\r\n//https://core.telegram.org/bots/api#user\r\nВвестиСтроку(ТекстСообщения);\r\nЕсли НЕ ЗначениеЗаполнено(ТекстСообщения) тогда возврат конецесли;\r\n\r\nЗапрос=Новый HTTPЗапрос();\r\nЗапрос.АдресРесурса=Константы.token.Получить()+\"/sendMessage\";\r\nЗапрос.Заголовки=Новый Соответствие();\r\n\r\nСоединение = Новый HTTPСоединение(\"api.telegram.org\",,,,,5,Новый ЗащищенноеСоединениеOpenSSL);\r\nТекстЗапроса=\"\";\r\nТекстЗапроса=ТекстЗапроса+\"&chat_id=\"+Формат(chat_id,\"ЧГ=\");\r\nТекстЗапроса=ТекстЗапроса+\"&text=\"+КодироватьСтроку(ТекстСообщения,СпособКодированияСтроки.КодировкаURL);\r\n//КодироватьСтроку() отсутствует в 8.2 ищите сами как сделать url encode\r\nЗапрос.Заголовки.Вставить(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\nЗапрос.УстановитьТелоИзСтроки(ТекстЗапроса);\r\nОтвет=Соединение.ОтправитьДляОбработки(Запрос);//POST\r\nКодСостояния=Ответ.КодСостояния;\r\nСтрокаОтвета=Ответ.ПолучитьТелоКакСтроку();\r\n\r\nЕсли КодСостояния=200 тогда\r\n\tЧтениеОтвета=Новый ЧтениеJSON;\r\n\tЧтениеОтвета.УстановитьСтроку(СтрокаОтвета);\r\n\tРезультатСтруктура=ПрочитатьJSON(ЧтениеОтвета);\r\n\tЕсли РезультатСтруктура.ok=Истина тогда\r\n\t\tСтруктураMessage=РезультатСтруктура.result;\r\n\t\t//СтруктураMessage это обычная Структура\r\n\t\t//сервер возвращает нам наше сообщение упакованое в объект Message\r\n\t\t//описание объекта Message тут https://core.telegram.org/bots/api#message\r\n\tКонецЕсли;\r\nИначе\r\n\tСообщить(\"КодСостояния \"+КодСостояния);\r\n\tСообщить(СтрокаОтвета);\r\nКонецЕсли;\n\n{29} Переменной СтруктураMessage присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в urlencoded: urlencoded\r\nОрфографическая ошибка в упакованое: упакованое\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Получение сообщений для бота Telegram",
    "description": "Получение сообщений для бота Telegram",
    "code_snippet": "Запрос=Новый HTTPЗапрос();\r\nЗапрос.АдресРесурса=Константы.token.Получить()+\"/getUpdates\";\r\nЗапрос.Заголовки=Новый Соответствие();\r\n\r\nСоединение=Новый HTTPСоединение(\"api.telegram.org\",,,,,5,Новый ЗащищенноеСоединениеOpenSSL);\r\nupdate_id=Константы.update_id.Получить();\r\nЕсли ЗначениеЗаполнено(update_id) тогда\r\n\tТекстЗапроса=\"&offset=\"+Формат(update_id+1,\"ЧГ=\");\r\n\tЗапрос.Заголовки.Вставить(\"Content-Type\",\"application/x-www-form-urlencoded\");\r\n\tЗапрос.УстановитьТелоИзСтроки(ТекстЗапроса);\r\n\tОтвет=Соединение.ОтправитьДляОбработки(Запрос);//POST\r\n\t\r\n\t//то же самое GET-запросом\r\n\t//Запрос.АдресРесурса=Запрос.АдресРесурса+\"?offset=\"+Формат(update_id+1,\"ЧГ=\");\r\n\t//Ответ=Соединение.Получить(Запрос);//GET\r\nИначе\r\n\tОтвет=Соединение.Получить(Запрос);//GET\r\nКонецЕсли;\r\nКодСостояния=Ответ.КодСостояния;\r\nСтрокаОтвета=Ответ.ПолучитьТелоКакСтроку();\r\n\r\nЕсли КодСостояния=200 тогда\r\n\tЧтениеОтвета=Новый ЧтениеJSON;\r\n\tЧтениеОтвета.УстановитьСтроку(СтрокаОтвета);\r\n\tРезультатСтруктура=ПрочитатьJSON(ЧтениеОтвета);\r\n\tЕсли РезультатСтруктура.ok=Истина тогда\r\n\t\tДля сч=1 по РезультатСтруктура.result.Количество() цикл\r\n\t\t\tОбъектUpdate=РезультатСтруктура.result[сч-1];\r\n\t\t\tКонстанты.update_id.Установить(ОбъектUpdate.update_id);\r\n\t\t\tСтруктураMessage=ОбъектUpdate.message;\r\n\t\t\t//СтруктураMessage это обычная Структура\r\n\t\t\t//описание объекта Message тут https://core.telegram.org/bots/api#message\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\nИначе\r\n\tСообщить(\"КодСостояния \"+КодСостояния);\r\n\tСообщить(СтрокаОтвета);\r\nКонецЕсли;\n\nЗапрос=Новый HTTPЗапрос();\r\nЗапрос.АдресРесурса=Константы.token.Получить()+\"/getUpdates\";\r\nЗапрос.Заголовки=Новый Соответствие();\r\n\r\nСоединение=Новый HTTPСоединение(\"api.telegram.org\",,,,,5,Новый ЗащищенноеСоединениеOpenSSL);\r\nupdate_id=Константы.update_id.Получить();\r\nЕсли ЗначениеЗаполнено(update_id) тогда\r\n\tТекстЗапроса=\"&offset=\"+Формат(update_id+1,\"ЧГ=\");\r\n\tЗапрос.Заголовки.Вставить(\"Content-Type\",\"application/x-www-form-urlencoded\");\r\n\tЗапрос.УстановитьТелоИзСтроки(ТекстЗапроса);\r\n\tОтвет=Соединение.ОтправитьДляОбработки(Запрос);//POST\r\n\t\r\n\t//то же самое GET-запросом\r\n\t//Запрос.АдресРесурса=Запрос.АдресРесурса+\"?offset=\"+Формат(update_id+1,\"ЧГ=\");\r\n\t//Ответ=Соединение.Получить(Запрос);//GET\r\nИначе\r\n\tОтвет=Соединение.Получить(Запрос);//GET\r\nКонецЕсли;\r\nКодСостояния=Ответ.КодСостояния;\r\nСтрокаОтвета=Ответ.ПолучитьТелоКакСтроку();\r\n\r\nЕсли КодСостояния=200 тогда\r\n\tЧтениеОтвета=Новый ЧтениеJSON;\r\n\tЧтениеОтвета.УстановитьСтроку(СтрокаОтвета);\r\n\tРезультатСтруктура=ПрочитатьJSON(ЧтениеОтвета);\r\n\tЕсли РезультатСтруктура.ok=Истина тогда\r\n\t\tДля сч=1 по РезультатСтруктура.result.Количество() цикл\r\n\t\t\tОбъектUpdate=РезультатСтруктура.result[сч-1];\r\n\t\t\tКонстанты.update_id.Установить(ОбъектUpdate.update_id);\r\n\t\t\tСтруктураMessage=ОбъектUpdate.message;\r\n\t\t\t//СтруктураMessage это обычная Структура\r\n\t\t\t//описание объекта Message тут https://core.telegram.org/bots/api#message\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\r\nИначе\r\n\tСообщить(\"КодСостояния \"+КодСостояния);\r\n\tСообщить(СтрокаОтвета);\r\nКонецЕсли;\n\nОрфографическая ошибка в urlencoded: urlencoded\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "POST-запрос к HTTP-серверу",
    "description": "POST-запрос к HTTP-серверу",
    "code_snippet": "ЗаписьXML=Новый ЗаписьXML(); \r\nЗаписьXML.УстановитьСтроку(\"UTF-8\");\r\nЗаписьXML.ЗаписатьОбъявлениеXML();\r\nФабрика.ЗаписатьXML(ЗаписьXML, КонтрагентXDTO);//объект XDTO создан и заполнен ранее \r\n\r\nЗаголовки=Новый Соответствие();\r\nЗаголовки.Вставить(\"Content-Type\",\"application/xml\");\r\nЗаголовки.Вставить(\"Accept\",\"application/xml\");\r\n\r\nЗапрос=Новый HTTPЗапрос();\r\nЗапрос.АдресРесурса=\"clients/add\";\r\nЗапрос.Заголовки=Заголовки;\r\nЗапрос.УстановитьТелоИзСтроки(ЗаписьXML.Закрыть());\r\n\r\nСоединение=Новый HTTPСоединение(\"api.yourserver.ru\");//таким образом полный URL запроса http://api.yourserver.ru/clients/add\r\nОтвет=Соединение.ОтправитьДляОбработки(Запрос);\r\nКодСостояния=Ответ.КодСостояния;\r\nСтрокаОтвета=Ответ.ПолучитьТелоКакСтроку();\r\nЕсли КодСостояния=201 тогда\r\n\tЧтениеXML=Новый ЧтениеXML;\r\n\tЧтениеXML.УстановитьСтроку(СтрокаОтвета);\r\n\tПопытка\r\n\t\tСтатусРаботыXDTO=Фабрика.ПрочитатьXML(ЧтениеXML,ФабрикаXDTO.Тип(\"http://api.yourserver.ru/xdto\",\"Status\"));\r\n\tИсключение\r\n\t\tСообщить(СформироватьСообщениеОбОшибке(ИнформацияОбОшибке()));\r\n\t\tПредупреждение(\"Сервер прислал плохие данные!\");\r\n\t\tВозврат;\r\n\tКонецПопытки;\r\n\t//обработка объекта XDTO\r\nИначе\r\n\t//обработка ошибочных кодов\r\nКонецЕсли;\n\nЗаписьXML=Новый ЗаписьXML(); \r\nЗаписьXML.УстановитьСтроку(\"UTF-8\");\r\nЗаписьXML.ЗаписатьОбъявлениеXML();\r\nФабрика.ЗаписатьXML(ЗаписьXML, КонтрагентXDTO);//объект XDTO создан и заполнен ранее \r\n\r\nЗаголовки=Новый Соответствие();\r\nЗаголовки.Вставить(\"Content-Type\",\"application/xml\");\r\nЗаголовки.Вставить(\"Accept\",\"application/xml\");\r\n\r\nЗапрос=Новый HTTPЗапрос();\r\nЗапрос.АдресРесурса=\"clients/add\";\r\nЗапрос.Заголовки=Заголовки;\r\nЗапрос.УстановитьТелоИзСтроки(ЗаписьXML.Закрыть());\r\n\r\nСоединение=Новый HTTPСоединение(\"api.yourserver.ru\");//таким образом полный URL запроса http://api.yourserver.ru/clients/add\r\nОтвет=Соединение.ОтправитьДляОбработки(Запрос);\r\nКодСостояния=Ответ.КодСостояния;\r\nСтрокаОтвета=Ответ.ПолучитьТелоКакСтроку();\r\nЕсли КодСостояния=201 тогда\r\n\tЧтениеXML=Новый ЧтениеXML;\r\n\tЧтениеXML.УстановитьСтроку(СтрокаОтвета);\r\n\tПопытка\r\n\t\tСтатусРаботыXDTO=Фабрика.ПрочитатьXML(ЧтениеXML,ФабрикаXDTO.Тип(\"http://api.yourserver.ru/xdto\",\"Status\"));\r\n\tИсключение\r\n\t\tСообщить(СформироватьСообщениеОбОшибке(ИнформацияОбОшибке()));\r\n\t\tПредупреждение(\"Сервер прислал плохие данные!\");\r\n\t\tВозврат;\r\n\tКонецПопытки;\r\n\t//обработка объекта XDTO\r\nИначе\r\n\t//обработка ошибочных кодов\r\nКонецЕсли;\n\n{23} Переменной СтатусРаботыXDTO присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в yourserver: yourserver\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "GET-запрос к HTTP-серверу",
    "description": "GET-запрос к HTTP-серверу",
    "code_snippet": "Заголовки=Новый Соответствие();\r\nЗаголовки.Вставить(\"Content-Type\",\"application/xml\");\r\nЗаголовки.Вставить(\"Accept\",\"application/xml\");\r\n\r\nЗапрос=Новый HTTPЗапрос();\r\nЗапрос.АдресРесурса=\"clients/list\";\r\nЗапрос.Заголовки=Заголовки;\r\n\r\nСоединение=Новый HTTPСоединение(\"api.yourserver.ru\");//таким образом полный URL запроса http://api.yourserver.ru/clients/list\r\nОтвет=Соединение.Получить(Запрос);\r\nКодСостояния=Ответ.КодСостояния;\r\nСтрокаОтвета=Ответ.ПолучитьТелоКакСтроку();\t\r\n\r\nЕсли КодСостояния=200 тогда\r\n\tЧтениеXML=Новый ЧтениеXML;\r\n\tЧтениеXML.УстановитьСтроку(СтрокаОтвета);\r\n\tПопытка\r\n\t\tКонтрагентыСписокXDTO=ФабрикаXDTO.ПрочитатьXML(ЧтениеXML,ФабрикаXDTO.Тип(\"http://api.yourserver.ru/xdto\",\"ClientList\"));\r\n\tИсключение\r\n\t\tСообщить(СформироватьСообщениеОбОшибке(ИнформацияОбОшибке()));\r\n\t\tПредупреждение(\"Сервер прислал плохие данные!\");\r\n\t\tВозврат;\r\n\tКонецПопытки;\r\n\t//обработка объекта XDTO\t\r\nИначе\r\n\t//обработка ошибочных кодов\r\nКонецЕсли;\n\nЗаголовки=Новый Соответствие();\r\nЗаголовки.Вставить(\"Content-Type\",\"application/xml\");\r\nЗаголовки.Вставить(\"Accept\",\"application/xml\");\r\n\r\nЗапрос=Новый HTTPЗапрос();\r\nЗапрос.АдресРесурса=\"clients/list\";\r\nЗапрос.Заголовки=Заголовки;\r\n\r\nСоединение=Новый HTTPСоединение(\"api.yourserver.ru\");//таким образом полный URL запроса http://api.yourserver.ru/clients/list\r\nОтвет=Соединение.Получить(Запрос);\r\nКодСостояния=Ответ.КодСостояния;\r\nСтрокаОтвета=Ответ.ПолучитьТелоКакСтроку();\t\r\n\r\nЕсли КодСостояния=200 тогда\r\n\tЧтениеXML=Новый ЧтениеXML;\r\n\tЧтениеXML.УстановитьСтроку(СтрокаОтвета);\r\n\tПопытка\r\n\t\tКонтрагентыСписокXDTO=ФабрикаXDTO.ПрочитатьXML(ЧтениеXML,ФабрикаXDTO.Тип(\"http://api.yourserver.ru/xdto\",\"ClientList\"));\r\n\tИсключение\r\n\t\tСообщить(СформироватьСообщениеОбОшибке(ИнформацияОбОшибке()));\r\n\t\tПредупреждение(\"Сервер прислал плохие данные!\");\r\n\t\tВозврат;\r\n\tКонецПопытки;\r\n\t//обработка объекта XDTO\t\r\nИначе\r\n\t//обработка ошибочных кодов\r\nКонецЕсли;\n\n{18} Переменной КонтрагентыСписокXDTO присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в yourserver: yourserver\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно.\n\nНовый HTTPСоединение(<Сервер>, <Порт>, <Пользователь>, <Пароль>, <Прокси>, <Таймаут>, <ЗащищенноеСоединение>, <ИспользоватьАутентификациюОС>)\n\nСоединение = Новый HTTPСоединение(\n                            \"hostname\",,,,,\n                            30 // таймаут в секундах\n                        );"
  },
  {
    "title": "Обрезка сигнатуры BOM",
    "description": "Обрезка сигнатуры BOM",
    "code_snippet": "Процедура ОбрезатьСигнатуру(ИмяФайла) \r\n\t\r\n\t\tСтрока64\t\t= Неопределено;\r\n\t\tДанные \t\t\t= Неопределено;\r\n\t\tДанные \t\t\t= Новый ДвоичныеДанные(ИмяФайла);\r\n\t\tСтрока64\t\t= Base64Строка(Данные);\r\n\t\tСтрока64\t\t= Прав(Строка64,СтрДлина(Строка64)-4);\r\n\t\tДанныеНаЗапись \t= Base64Значение(Строка64);\r\n\t\tДанныеНаЗапись.Записать(ИмяФайла);\r\n\t\r\n\t\r\nКонецПроцедуры\n\nПроцедура ОбрезатьСигнатуру(ИмяФайла) \r\n\t\r\n\t\tСтрока64\t\t= Неопределено;\r\n\t\tДанные \t\t\t= Неопределено;\r\n\t\tДанные \t\t\t= Новый ДвоичныеДанные(ИмяФайла);\r\n\t\tСтрока64\t\t= Base64Строка(Данные);\r\n\t\tСтрока64\t\t= Прав(Строка64,СтрДлина(Строка64)-4);\r\n\t\tДанныеНаЗапись \t= Base64Значение(Строка64);\r\n\t\tДанныеНаЗапись.Записать(ИмяФайла);\r\n\t\r\n\t\r\nКонецПроцедуры\n\n{3} Переменной Строка64 присвоено значение, но оно нигде не используется\r\n{4} Переменной Данные присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Вывод произвольной Таблицы Значений в Табличный Документ",
    "description": "Вывод произвольной Таблицы Значений в Табличный Документ",
    "code_snippet": "Процедура ПоказатьТаблицуЗначений(РезультатТЗ )\r\n\t\t\r\n\tПостроитель = Новый ПостроительОтчета;\r\n\tПостроитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(РезультатТЗ);\r\n\tПостроитель.МакетОформления = ПолучитьМакетОформления(СтандартноеОформление.Асфальт);\r\n\t\r\n\tПостроитель.Выполнить();  \r\n\tПостроитель.ВыводитьЗаголовокОтчета = Истина;\r\n\tПостроитель.ТекстЗаголовка = \"Данные таблицы значений\";\t\r\n\r\n\tДля каждого Колонка Из Построитель.ВыбранныеПоля Цикл\r\n\t   Колонка.Представление = РезультатТЗ.Колонки[Колонка.Имя].Заголовок;\r\n\tКонецЦикла; \r\n\r\n\tМакетТД = Новый ТабличныйДокумент;\r\n\tПостроитель.Вывести(МакетТД);\r\n\tОбластьТД = МакетТД.Область();\r\n\tОбластьТД.ШиринаКолонки = 20;\t\r\n\tМакетТД.ТолькоПросмотр = Истина;\r\n\tМакетТД.ФиксацияСверху = 4;\r\n\tМакетТД.ОтображатьЗаголовки = Истина;\r\n\tМакетТД.Показать();\r\n\t\t\r\nКонецПроцедуры\n\nПроцедура ПоказатьТаблицуЗначений(РезультатТЗ )\r\n\t\t\r\n\tПостроитель = Новый ПостроительОтчета;\r\n\tПостроитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(РезультатТЗ);\r\n\tПостроитель.МакетОформления = ПолучитьМакетОформления(СтандартноеОформление.Асфальт);\r\n\t\r\n\tПостроитель.Выполнить();  \r\n\tПостроитель.ВыводитьЗаголовокОтчета = Истина;\r\n\tПостроитель.ТекстЗаголовка = \"Данные таблицы значений\";\t\r\n\r\n\tДля каждого Колонка Из Построитель.ВыбранныеПоля Цикл\r\n\t   Колонка.Представление = РезультатТЗ.Колонки[Колонка.Имя].Заголовок;\r\n\tКонецЦикла; \r\n\r\n\tМакетТД = Новый ТабличныйДокумент;\r\n\tПостроитель.Вывести(МакетТД);\r\n\tОбластьТД = МакетТД.Область();\r\n\tОбластьТД.ШиринаКолонки = 20;\t\r\n\tМакетТД.ТолькоПросмотр = Истина;\r\n\tМакетТД.ФиксацияСверху = 4;\r\n\tМакетТД.ОтображатьЗаголовки = Истина;\r\n\tМакетТД.Показать();\r\n\t\t\r\nКонецПроцедуры"
  },
  {
    "title": "Обмен данными XDTO (пример)",
    "description": "Обмен данными XDTO (пример)",
    "code_snippet": "&НаКлиенте\r\nПроцедура Выгрузить(Команда)\r\n\t\r\n\tДиалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);\r\n\tДиалог.Заголовок = \"Выберите файл для выгрузки\";\r\n\tДиалог.Фильтр = \"xml |*.xml|\";\t\r\n\tЕсли Диалог.Выбрать() Тогда\r\n\t\tСообщить(Диалог.ПолноеИмяФайла);\t\t\r\n\tИначе\r\n\t\tВозврат;\r\n\tКонецЕсли;\t\r\n\t\r\n\tВыгрузкаXML=ПолучитьXMLФайл(ЭтаФорма.УникальныйИдентификатор);\r\n\t\r\n\tОписание=Новый ОписаниеПередаваемогоФайла(Диалог.ПолноеИмяФайла,ВыгрузкаXML);\r\n\tМассивОписаний=Новый Массив;\r\n\tМассивОписаний.Добавить(Описание);\r\n\tПолучитьФайлы(МассивОписаний,,,Ложь);\r\nКонецПроцедуры\r\n\r\n&НаСервереБезКонтекста\r\nФункция ПолучитьXMLФайл(ГУИДФормы)\r\n\t\r\n\tИмяТемпФайла = ПолучитьИмяВременногоФайла(\"xml\");                                                \r\n\tДанные = Новый ЗаписьXML;\r\n\tДанные.ОткрытьФайл(ИмяТемпФайла);\r\n\tДанные.ЗаписатьОбъявлениеXML();\r\n\tДанные.ЗаписатьНачалоЭлемента(\"Данные\");\r\n\t\r\n\tФабрика = СоздатьФабрикуXDTO(\"D:\\Приемник.xsd\");\r\n\t\r\n\tРаботникиОбъектТип= Фабрика.Тип(\"http://v8.1c.ru/8.1/data/enterprise/current-config\",\"CatalogObject.Работники\");\t\t\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\"ВЫБРАТЬ\r\n\t|\tСотрудники.Ссылка РаботникСсылка,\r\n\t|\tСотрудники.ПометкаУдаления DeletionMark,\r\n\t|\tСотрудники.Родитель РодительСсылка,\r\n\t|\tСотрудники.ЭтоГруппа IsFolder,\r\n\t|\tСотрудники.Код Code,\r\n\t|\tСотрудники.Наименование Description,\r\n\t|\tСотрудники.ДатаРождения ДеньРождения,\r\n\t|\tСотрудники.ПричинаУвольнения ПричинаУвольнения\r\n\t|ИЗ\r\n\t|\tСправочник.Сотрудники КАК Сотрудники\";\r\n\t\r\n\tРезультат = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = Результат.Выбрать();\r\n\t\r\n\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\tРаботникиОбъект = Фабрика.Создать(РаботникиОбъектТип);\t\t\r\n\t\tРаботникиОбъект.Ref = ВыборкаДетальныеЗаписи.РаботникСсылка.УникальныйИдентификатор();\r\n\t\tРаботникиОбъект.Parent = ВыборкаДетальныеЗаписи.РодительСсылка.УникальныйИдентификатор();\r\n\r\n\t\tЕсли ВыборкаДетальныеЗаписи.IsFolder Тогда\r\n\t\t\tЗаполнитьЗначенияСвойств(РаботникиОбъект,ВыборкаДетальныеЗаписи,,\"ДеньРождения,ПричинаУвольнения\");\r\n\t\tИначе\r\n\t\t\tЗаполнитьЗначенияСвойств(РаботникиОбъект,ВыборкаДетальныеЗаписи);\r\n\t\t\tРаботникиОбъект.Автомобиль = Неопределено;\r\n\t\t\tРаботникиОбъект.Должность = новый УникальныйИдентификатор(\"00000000-0000-0000-0000-000000000000\");\r\n            РаботникиОбъект.Комментарий = \"Импорт из исходной базы\";\r\n\t\t\tРаботникиОбъект.Организация = новый УникальныйИдентификатор(\"00000000-0000-0000-0000-000000000000\");\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tФабрика.ЗаписатьXML(Данные,РаботникиОбъект);\r\n\tКонецЦикла;\t\t\r\n\t\r\n\tДанные.ЗаписатьКонецЭлемента();\r\n\tДанные.Закрыть();\r\n\t\r\n\tДвоичное=Новый ДвоичныеДанные(ИмяТемпФайла);\r\n\tАдрес=ПоместитьВоВременноеХранилище(Двоичное,ГУИДФормы);\r\n\tВозврат Адрес;\r\nКонецФункции\r\n\r\n&НаКлиенте\r\nПроцедура Загрузить(Команда)\r\n\t\r\n\tДиалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);\r\n\tДиалог.Заголовок = \"Выберите файл для загрузки\";\r\n\tДиалог.Фильтр = \"xml |*.xml|\"; // картинки\r\n\t\r\n\tЕсли Диалог.Выбрать() Тогда\r\n\t\tСообщить(Диалог.ПолноеИмяФайла);\t\t\r\n\tИначе\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n\tДвоичныеДанные = Новый ДвоичныеДанные(Диалог.ПолноеИмяФайла);\r\n\tГуидФормы = Этаформа.УникальныйИдентификатор;\r\n\tАдрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные,ГуидФормы);\r\n\t\r\n\tЗагрузитьНаСервере(Адрес);\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервереБезКонтекста\r\nПроцедура ЗагрузитьНаСервере(Адрес)\r\n\t\r\n\tТемпФайл = ПолучитьИмяВременногоФайла(\"xml\");\r\n\tДвоичныеДанные = ПолучитьИзВременногоХранилища(Адрес);\r\n\tДвоичныеДанные.Записать(ТемпФайл);\r\n\tДанные = Новый ЧтениеXML;\r\n\tДанные.ОткрытьФайл(ТемпФайл);\r\n\tДанные.Прочитать();\r\n\tДанные.Прочитать();\r\n\t\r\n\tПока СериализаторXDTO.ВозможностьЧтенияXML(Данные) Цикл\r\n\t\tРаботникОбъект = СериализаторXDTO.ПрочитатьXML(Данные);\r\n\t\tРаботникОбъект.ОбменДанными.Загрузка=Истина;\r\n\t\tРаботникОбъект.Записать();\r\n\tКонецЦикла; \r\n\t\r\n\tДанные.Закрыть();\r\n\t\r\nКонецПроцедуры\n\n&НаКлиенте\r\nПроцедура Выгрузить(Команда)\r\n\t\r\n\tДиалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);\r\n\tДиалог.Заголовок = \"Выберите файл для выгрузки\";\r\n\tДиалог.Фильтр = \"xml |*.xml|\";\t\r\n\tЕсли Диалог.Выбрать() Тогда\r\n\t\tСообщить(Диалог.ПолноеИмяФайла);\t\t\r\n\tИначе\r\n\t\tВозврат;\r\n\tКонецЕсли;\t\r\n\t\r\n\tВыгрузкаXML=ПолучитьXMLФайл(ЭтаФорма.УникальныйИдентификатор);\r\n\t\r\n\tОписание=Новый ОписаниеПередаваемогоФайла(Диалог.ПолноеИмяФайла,ВыгрузкаXML);\r\n\tМассивОписаний=Новый Массив;\r\n\tМассивОписаний.Добавить(Описание);\r\n\tПолучитьФайлы(МассивОписаний,,,Ложь);\r\nКонецПроцедуры\r\n\r\n&НаСервереБезКонтекста\r\nФункция ПолучитьXMLФайл(ГУИДФормы)\r\n\t\r\n\tИмяТемпФайла = ПолучитьИмяВременногоФайла(\"xml\");                                                \r\n\tДанные = Новый ЗаписьXML;\r\n\tДанные.ОткрытьФайл(ИмяТемпФайла);\r\n\tДанные.ЗаписатьОбъявлениеXML();\r\n\tДанные.ЗаписатьНачалоЭлемента(\"Данные\");\r\n\t\r\n\tФабрика = СоздатьФабрикуXDTO(\"D:\\Приемник.xsd\");\r\n\t\r\n\tРаботникиОбъектТип= Фабрика.Тип(\"http://v8.1c.ru/8.1/data/enterprise/current-config\",\"CatalogObject.Работники\");\t\t\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\"ВЫБРАТЬ\r\n\t|\tСотрудники.Ссылка РаботникСсылка,\r\n\t|\tСотрудники.ПометкаУдаления DeletionMark,\r\n\t|\tСотрудники.Родитель РодительСсылка,\r\n\t|\tСотрудники.ЭтоГруппа IsFolder,\r\n\t|\tСотрудники.Код Code,\r\n\t|\tСотрудники.Наименование Description,\r\n\t|\tСотрудники.ДатаРождения ДеньРождения,\r\n\t|\tСотрудники.ПричинаУвольнения ПричинаУвольнения\r\n\t|ИЗ\r\n\t|\tСправочник.Сотрудники КАК Сотрудники\";\r\n\t\r\n\tРезультат = Запрос.Выполнить();\r\n\t\r\n\tВыборкаДетальныеЗаписи = Результат.Выбрать();\r\n\t\r\n\tПока ВыборкаДетальныеЗаписи.Следующий() Цикл\r\n\t\tРаботникиОбъект = Фабрика.Создать(РаботникиОбъектТип);\t\t\r\n\t\tРаботникиОбъект.Ref = ВыборкаДетальныеЗаписи.РаботникСсылка.УникальныйИдентификатор();\r\n\t\tРаботникиОбъект.Parent = ВыборкаДетальныеЗаписи.РодительСсылка.УникальныйИдентификатор();\r\n\r\n\t\tЕсли ВыборкаДетальныеЗаписи.IsFolder Тогда\r\n\t\t\tЗаполнитьЗначенияСвойств(РаботникиОбъект,ВыборкаДетальныеЗаписи,,\"ДеньРождения,ПричинаУвольнения\");\r\n\t\tИначе\r\n\t\t\tЗаполнитьЗначенияСвойств(РаботникиОбъект,ВыборкаДетальныеЗаписи);\r\n\t\t\tРаботникиОбъект.Автомобиль = Неопределено;\r\n\t\t\tРаботникиОбъект.Должность = новый УникальныйИдентификатор(\"00000000-0000-0000-0000-000000000000\");\r\n            РаботникиОбъект.Комментарий = \"Импорт из исходной базы\";\r\n\t\t\tРаботникиОбъект.Организация = новый УникальныйИдентификатор(\"00000000-0000-0000-0000-000000000000\");\r\n\t\tКонецЕсли; \r\n\t\t\r\n\t\tФабрика.ЗаписатьXML(Данные,РаботникиОбъект);\r\n\tКонецЦикла;\t\t\r\n\t\r\n\tДанные.ЗаписатьКонецЭлемента();\r\n\tДанные.Закрыть();\r\n\t\r\n\tДвоичное=Новый ДвоичныеДанные(ИмяТемпФайла);\r\n\tАдрес=ПоместитьВоВременноеХранилище(Двоичное,ГУИДФормы);\r\n\tВозврат Адрес;\r\nКонецФункции\r\n\r\n&НаКлиенте\r\nПроцедура Загрузить(Команда)\r\n\t\r\n\tДиалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);\r\n\tДиалог.Заголовок = \"Выберите файл для загрузки\";\r\n\tДиалог.Фильтр = \"xml |*.xml|\"; // картинки\r\n\t\r\n\tЕсли Диалог.Выбрать() Тогда\r\n\t\tСообщить(Диалог.ПолноеИмяФайла);\t\t\r\n\tИначе\r\n\t\tВозврат;\r\n\tКонецЕсли;\r\n\t\r\n\tДвоичныеДанные = Новый ДвоичныеДанные(Диалог.ПолноеИмяФайла);\r\n\tГуидФормы = Этаформа.УникальныйИдентификатор;\r\n\tАдрес = ПоместитьВоВременноеХранилище(ДвоичныеДанные,ГуидФормы);\r\n\t\r\n\tЗагрузитьНаСервере(Адрес);\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаСервереБезКонтекста\r\nПроцедура ЗагрузитьНаСервере(Адрес)\r\n\t\r\n\tТемпФайл = ПолучитьИмяВременногоФайла(\"xml\");\r\n\tДвоичныеДанные = ПолучитьИзВременногоХранилища(Адрес);\r\n\tДвоичныеДанные.Записать(ТемпФайл);\r\n\tДанные = Новый ЧтениеXML;\r\n\tДанные.ОткрытьФайл(ТемпФайл);\r\n\tДанные.Прочитать();\r\n\tДанные.Прочитать();\r\n\t\r\n\tПока СериализаторXDTO.ВозможностьЧтенияXML(Данные) Цикл\r\n\t\tРаботникОбъект = СериализаторXDTO.ПрочитатьXML(Данные);\r\n\t\tРаботникОбъект.ОбменДанными.Загрузка=Истина;\r\n\t\tРаботникОбъект.Записать();\r\n\tКонецЦикла; \r\n\t\r\n\tДанные.Закрыть();\r\n\t\r\nКонецПроцедуры\n\nОрфографическая ошибка в Этаформа: Этаформа\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Открыть отчет с пользовательскими настройками",
    "description": "Открыть отчет с пользовательскими настройками",
    "code_snippet": "Настройки = Новый НастройкиКомпоновкиДанных;\r\n    Элемент = Настройки.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n    Элемент.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"Товар\");\r\n    Элемент.ИдентификаторПользовательскойНастройки = \"Идентификатор\";\r\n    \r\n    ПараметрыФормы = Новый Структура(\"Вариант\", Настройки);\r\n    ОткрытьФорму(\"Отчет.ОстаткиТоваровНаСкладах.Форма\", ПараметрыФормы);\n\nНастройки = Новый НастройкиКомпоновкиДанных;\r\n    Элемент = Настройки.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n    Элемент.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(\"Товар\");\r\n    Элемент.ИдентификаторПользовательскойНастройки = \"Идентификатор\";\r\n    \r\n    ПараметрыФормы = Новый Структура(\"Вариант\", Настройки);\r\n    ОткрытьФорму(\"Отчет.ОстаткиТоваровНаСкладах.Форма\", ПараметрыФормы);"
  },
  {
    "title": "Поиск по ГУИД в COM",
    "description": "Поиск по ГУИД в COM",
    "code_snippet": "Функция НайтиСсылкуНаСправочникПоУИД(СсылкаВБазе, ИмяСправочника, Соединение)\r\n\t\r\n\tЕсли НЕ ЗначениеЗаполнено(СсылкаВБазе) Тогда\r\n\t\tВозврат Соединение.Справочники[ИмяСправочника].ПустаяСсылка();\r\n\tКонецЕсли;\t\r\n\t\r\n\tУИДСтрокой = Строка(СсылкаВБазе.УникальныйИдентификатор());\r\n\tУИД = Соединение.NewObject(\"УникальныйИдентификатор\", УИДСтрокой);\r\n\t\r\n\tСсылкаНаСправочник = Соединение.Справочники[ИмяСправочника].ПолучитьСсылку(УИД);\r\n\tЕсли Соединение.ОбщегоНазначения.СсылкаСуществует(СсылкаНаСправочник) = Ложь тогда\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат СсылкаНаСправочник; \r\n\t\r\nКонецФункции\n\nФункция НайтиСсылкуНаСправочникПоУИД(СсылкаВБазе, ИмяСправочника, Соединение)\r\n\t\r\n\tЕсли НЕ ЗначениеЗаполнено(СсылкаВБазе) Тогда\r\n\t\tВозврат Соединение.Справочники[ИмяСправочника].ПустаяСсылка();\r\n\tКонецЕсли;\t\r\n\t\r\n\tУИДСтрокой = Строка(СсылкаВБазе.УникальныйИдентификатор());\r\n\tУИД = Соединение.NewObject(\"УникальныйИдентификатор\", УИДСтрокой);\r\n\t\r\n\tСсылкаНаСправочник = Соединение.Справочники[ИмяСправочника].ПолучитьСсылку(УИД);\r\n\tЕсли Соединение.ОбщегоНазначения.СсылкаСуществует(СсылкаНаСправочник) = Ложь тогда\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\r\n\t\r\n\tВозврат СсылкаНаСправочник; \r\n\t\r\nКонецФункции"
  },
  {
    "title": "Получить ссылку по типу и гуид",
    "description": "Получить ссылку по типу и гуид",
    "code_snippet": "Тип = Тип(ПоследняяОткрытаяСтрока.ТипЗначенияXML);\r\nУИД = Новый УникальныйИдентификатор(ПоследняяОткрытаяСтрока.ЗначениеXML);\r\nМассив = Новый Массив;\r\nМассив.Добавить(УИД);\r\nЗначение = Новый (Тип, Массив);\n\nТип = Тип(ПоследняяОткрытаяСтрока.ТипЗначенияXML);\r\nУИД = Новый УникальныйИдентификатор(ПоследняяОткрытаяСтрока.ЗначениеXML);\r\nМассив = Новый Массив;\r\nМассив.Добавить(УИД);\r\nЗначение = Новый (Тип, Массив);\n\n{5} Переменной Значение присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в гуид: гуид"
  },
  {
    "title": "Как выбрать наибольшее значение из ТЗ",
    "description": "Как выбрать наибольшее значение из ТЗ",
    "code_snippet": "ИстДанных = Новый ОписаниеИсточникаДанных(ТЗ);\r\nИстДанных.Колонки.Кол.Итог = \"Максимум(Кол)\" ;\r\nПостроительЗапроса = Новый ПостроительЗапроса; \r\nПостроительЗапроса.ИсточникДанных = ИстДанных; \r\nРезультат = ПостроительЗапроса.Результат; // тип РезультатЗапроса     \r\n \r\nТЗРез = Результат.Выгрузить();\r\nМаксКол = ТЗРез[0].Кол;\n\nИстДанных = Новый ОписаниеИсточникаДанных(ТЗ);\r\nИстДанных.Колонки.Кол.Итог = \"Максимум(Кол)\" ;\r\nПостроительЗапроса = Новый ПостроительЗапроса; \r\nПостроительЗапроса.ИсточникДанных = ИстДанных; \r\nРезультат = ПостроительЗапроса.Результат; // тип РезультатЗапроса     \r\n \r\nТЗРез = Результат.Выгрузить();\r\nМаксКол = ТЗРез[0].Кол;\n\n{8} Переменной МаксКол присвоено значение, но оно нигде не используется\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Раскрасить даты календаря",
    "description": "Раскрасить даты календаря",
    "code_snippet": "Процедура ПроизводственныйКалендарьПриВыводеПериода(Элемент, ОформлениеПериода)\r\n\tПопытка \r\n\t\tМассивДат = ПоискДатВРегистреСведениийДатыКурсов ();\r\n\t\tДля Каждого ДатаПериода Из ОформлениеПериода.Даты Цикл\r\n\t\t\tЕсли МассивДат.Найти(ДатаПериода.Дата) <> Неопределено Тогда\r\n\t\t\t\tДатаПериода.ЦветФона = webЦвета.БледноЗеленый;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ДеньНедели(ДатаПериода.Дата)>=6 Тогда\r\n\t\t\t\tДатаПериода.ЦветТекста = webЦвета.Красный; \r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tИсключение\r\n\tКонецПопытки;\r\nКонецПроцедуры\n\nПроцедура ПроизводственныйКалендарьПриВыводеПериода(Элемент, ОформлениеПериода)\r\n\tПопытка \r\n\t\tМассивДат = ПоискДатВРегистреСведениийДатыКурсов ();\r\n\t\tДля Каждого ДатаПериода Из ОформлениеПериода.Даты Цикл\r\n\t\t\tЕсли МассивДат.Найти(ДатаПериода.Дата) <> Неопределено Тогда\r\n\t\t\t\tДатаПериода.ЦветФона = webЦвета.БледноЗеленый;\r\n\t\t\tКонецЕсли;\r\n\t\t\tЕсли ДеньНедели(ДатаПериода.Дата)>=6 Тогда\r\n\t\t\t\tДатаПериода.ЦветТекста = webЦвета.Красный; \r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tИсключение\r\n\tКонецПопытки;\r\nКонецПроцедуры\n\nОрфографическая ошибка в Процкдура: Процкдура\r\nОрфографическая ошибка в ПоискДатВРегистреСведениийДатыКурсов: Сведениий"
  },
  {
    "title": "Программное открытие отчета или обработки из справочника \"ВнешниеОбработки\"",
    "description": "Программное открытие отчета или обработки из справочника \"ВнешниеОбработки\"",
    "code_snippet": "Функция ОткрытьВнешнийОтчет(ИмяОтчета) Экспорт\r\n \r\n    ПутьКВременномуФайлу=КаталогВременныхФайлов()+\r\n\"ВременныйФайл\" + формат(ТекущаяДата(),\"ДФ=ddMMyyyyhhmmss\")+ \".tmp\";\r\n    о = Справочники.ВнешниеОбработки.НайтиПоНаименованию(ИмяОтчета);\r\n    \r\n    Если о=Справочники.ВнешниеОбработки.ПустаяСсылка() Тогда\r\n        Возврат неопределено;    \r\n    КонецЕсли;\r\n    \r\n    Справочники.ВнешниеОбработки.НайтиПоНаименованию(ИмяОтчета).ХранилищеВнешнейОбработки.Получить().Записать(ПутьКВременномуФайлу);\r\n    \r\n    Если о.ВидОбработки = Перечисления.ВидыДополнительныхВнешнихОбработок.Отчет Тогда\r\n        ВнешниеОтчеты.ПолучитьФорму(ПутьКВременномуФайлу).Открыть();\r\n    КонецЕсли;\r\n    \r\n    Если о.ВидОбработки = Перечисления.ВидыДополнительныхВнешнихОбработок.Обработка Тогда\r\n        ВнешниеОбработки.ПолучитьФорму(ПутьКВременномуФайлу).Открыть();\r\n    КонецЕсли;\r\n    \r\n    УдалитьФайлы(ПутьКВременномуФайлу);\r\n    \r\n    Возврат неопределено;    \r\n    \r\nконецфункции\n\nФункция ОткрытьВнешнийОтчет(ИмяОтчета) Экспорт\r\n \r\n    ПутьКВременномуФайлу=КаталогВременныхФайлов()+\r\n\"ВременныйФайл\" + формат(ТекущаяДата(),\"ДФ=ddMMyyyyhhmmss\")+ \".tmp\";\r\n    о = Справочники.ВнешниеОбработки.НайтиПоНаименованию(ИмяОтчета);\r\n    \r\n    Если о=Справочники.ВнешниеОбработки.ПустаяСсылка() Тогда\r\n        Возврат неопределено;    \r\n    КонецЕсли;\r\n    \r\n    Справочники.ВнешниеОбработки.НайтиПоНаименованию(ИмяОтчета).ХранилищеВнешнейОбработки.Получить().Записать(ПутьКВременномуФайлу);\r\n    \r\n    Если о.ВидОбработки = Перечисления.ВидыДополнительныхВнешнихОбработок.Отчет Тогда\r\n        ВнешниеОтчеты.ПолучитьФорму(ПутьКВременномуФайлу).Открыть();\r\n    КонецЕсли;\r\n    \r\n    Если о.ВидОбработки = Перечисления.ВидыДополнительныхВнешнихОбработок.Обработка Тогда\r\n        ВнешниеОбработки.ПолучитьФорму(ПутьКВременномуФайлу).Открыть();\r\n    КонецЕсли;\r\n    \r\n    УдалитьФайлы(ПутьКВременномуФайлу);\r\n    \r\n    Возврат неопределено;    \r\n    \r\nконецфункции"
  },
  {
    "title": "Добавить отбор в списке, в пользовательских настройках",
    "description": "Добавить отбор в списке, в пользовательских настройках",
    "code_snippet": "Процедура УстановитьПользовательскийОтбор(КомпоновщикНастроек, Поле, ВидСравнения, Значение) Экспорт\r\n\t\r\n\t// Сначала найдем выделенный элемент отбора\r\n\tДля каждого ЭлементНастроек из КомпоновщикНастроек.ПользовательскиеНастройки.Элементы Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(ЭлементНастроек) = Тип(\"ЭлементОтбораКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tТекПоле = \"\";\r\n\t\t\tДля каждого ЭлементОтбора из КомпоновщикНастроек.Настройки.Отбор.Элементы Цикл\r\n\t\t\t\t\r\n\t\t\t\tЕсли ЭлементНастроек.ИдентификаторПользовательскойНастройки = ЭлементОтбора.ИдентификаторПользовательскойНастройки Тогда\r\n\t\t\t\t\tТекПоле = ЭлементОтбора.ЛевоеЗначение;\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\tКонецЕсли;\t\r\n\t\t\t\t\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tЕсли Строка(ТекПоле) = Поле Тогда\r\n\t\t\t\tЭлементНастроек.ВидСравнения   = ВидСравнения;\r\n\t\t\t\tЭлементНастроек.ПравоеЗначение = Значение;\r\n\t\t\t\tЭлементНастроек.Использование  = Истина;\r\n\t\t\t\tВозврат;\r\n\t\t\tКонецЕсли;\t\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t// Найдем отбор\r\n\tДля каждого ЭлементНастроек из КомпоновщикНастроек.ПользовательскиеНастройки.Элементы Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(ЭлементНастроек) = Тип(\"ОтборКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tТекОтборП = ТиповыеОтчеты_УправляемыйРежим.УстановитьОтбор(ЭлементНастроек, Поле, ВидСравнения, Значение);\r\n\t\t\tПрервать;\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\nПроцедура УстановитьПользовательскийОтбор(КомпоновщикНастроек, Поле, ВидСравнения, Значение) Экспорт\r\n\t\r\n\t// Сначала найдем выделенный элемент отбора\r\n\tДля каждого ЭлементНастроек из КомпоновщикНастроек.ПользовательскиеНастройки.Элементы Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(ЭлементНастроек) = Тип(\"ЭлементОтбораКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tТекПоле = \"\";\r\n\t\t\tДля каждого ЭлементОтбора из КомпоновщикНастроек.Настройки.Отбор.Элементы Цикл\r\n\t\t\t\t\r\n\t\t\t\tЕсли ЭлементНастроек.ИдентификаторПользовательскойНастройки = ЭлементОтбора.ИдентификаторПользовательскойНастройки Тогда\r\n\t\t\t\t\tТекПоле = ЭлементОтбора.ЛевоеЗначение;\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\tКонецЕсли;\t\r\n\t\t\t\t\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n\t\t\tЕсли Строка(ТекПоле) = Поле Тогда\r\n\t\t\t\tЭлементНастроек.ВидСравнения   = ВидСравнения;\r\n\t\t\t\tЭлементНастроек.ПравоеЗначение = Значение;\r\n\t\t\t\tЭлементНастроек.Использование  = Истина;\r\n\t\t\t\tВозврат;\r\n\t\t\tКонецЕсли;\t\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t// Найдем отбор\r\n\tДля каждого ЭлементНастроек из КомпоновщикНастроек.ПользовательскиеНастройки.Элементы Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(ЭлементНастроек) = Тип(\"ОтборКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tТекОтборП = ТиповыеОтчеты_УправляемыйРежим.УстановитьОтбор(ЭлементНастроек, Поле, ВидСравнения, Значение);\r\n\t\t\tПрервать;\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Последняя строка таблицы на одной странице вместе с подвалом",
    "description": "Последняя строка таблицы на одной странице вместе с подвалом",
    "code_snippet": "//После цикла вывода строк\r\n\r\nТабДок.Область(ТабДок.ВысотаТаблицы, ,ТабДок.ВысотаТаблицы,).ВместеСоСледующим = Истина;\n\n//После цикла вывода строк\r\n\r\nТабДок.Область(ТабДок.ВысотаТаблицы, ,ТабДок.ВысотаТаблицы,).ВместеСоСледующим = Истина;"
  },
  {
    "title": "Удаление строк таблицы по условию",
    "description": "Удаление строк таблицы по условию",
    "code_snippet": "Для Индекс = -ТЗ.Количество()+1 По -1 Цикл\r\n\tСтр =ТЗ.Получить(-Индекс);\r\n\tЕсли Найти(Стр.Имя, \"ПодстрокаПоиска\") > 0 Тогда\r\n\t\tТЗ.Удалить(Стр);\r\n\tКонецЕсли;\r\nКонецЦикла;\n\nДля Индекс = -ТЗ.Количество()+1 По -1 Цикл\r\n\tСтр =ТЗ.Получить(-Индекс);\r\n\tЕсли Найти(Стр.Имя, \"ПодстрокаПоиска\") > 0 Тогда\r\n\t\tТЗ.Удалить(Стр);\r\n\tКонецЕсли;\r\nКонецЦикла;\n\nПараметрыОтбора = Новый Структура;\nПараметрыОтбора.Вставить(ИмяКолонкиПоКоторойБудемИскать, ПодстрокаПоиска);\nМассивСтрокДляУдаления = ТЗ.НайтиСтроки(ПараметрыОтбора);\nДля Каждого СтрокаДляУдаления Из МассивСтрокДляУдаления Цикл\n\tТЗ.Удалить(СтрокаДляУдаления);\nКонецЦикла;"
  },
  {
    "title": "Поиск кириллицы в строке",
    "description": "Поиск кириллицы в строке",
    "code_snippet": "Функция ПоискКириллицы(Текст) Экспорт;\r\nДля i=1040 по 1103 цикл\r\n\tРезультат = Найти (Текст, Символ(i));\r\n\tЕсли Результат>0 Тогда\r\n\t\tВозврат Истина;\r\n\tКонецЕсли; \r\nКонецЦикла;\r\nВозврат Ложь;\r\n\r\nКонецФункции;\n\nФункция ПоискКириллицы(Текст) Экспорт;\r\nДля i=1040 по 1103 цикл\r\n\tРезультат = Найти (Текст, Символ(i));\r\n\tЕсли Результат>0 Тогда\r\n\t\tВозврат Истина;\r\n\tКонецЕсли; \r\nКонецЦикла;\r\nВозврат Ложь;\r\n\r\nКонецФункции;"
  },
  {
    "title": "транслитерация",
    "description": "транслитерация",
    "code_snippet": "Функция ЗаменитьСимволы (Источник,Текст,Замена) Экспорт\r\nРезультат = Текст;\r\nДля Сч = 1 По СтрДлина(Источник) Цикл\r\nРезультат = СтрЗаменить(Результат,Сред(Источник,Сч,1),Сред(Замена,Сч,1));\r\nКонецЦикла;\r\nВозврат Результат;    \r\nКонецФункции \r\n\r\nФункция Транслитерация(Знач Слово) Экспорт\r\nСлово = НРег(Слово);\r\nСлово=СтрЗаменить(Слово,\"ш\",\"sh\");\r\nСлово=СтрЗаменить(Слово,\"щ\",\"shh\");\r\nСлово=СтрЗаменить(Слово,\"ж\",\"zh\");\r\nСлово=СтрЗаменить(Слово,\"ц\",\"ts\");\r\nСлово=СтрЗаменить(Слово,\"ь\",\"'\");\r\nСлово=СтрЗаменить(Слово,\"ъ\", Символ(34)); //двойная кавычка\r\nСлово=СтрЗаменить(Слово,\"ч\",\"ch\");\r\nСлово=СтрЗаменить(Слово,\"её\",\"yeyo\");\r\nСлово=СтрЗаменить(Слово,\"ёе\",\"yoye\");\r\nСлово=СтрЗаменить(Слово,\"я\",\"ya\");\r\nСлово=СтрЗаменить(Слово,\"ю\",\"yu\");\r\nСлово=СтрЗаменить(Слово,\" - \",\"-\");\r\nСлово=СтрЗаменить(Слово,\" -\",\"-\");\r\nСлово=СтрЗаменить(Слово,\"- \",\"-\");\r\nСлово=СтрЗаменить(Слово,\" \",\"-\");\r\nСлово=ЗаменитьСимволы(\"абвгдезийклмнопрстуфыэ\",Слово,\"abvgdezijklmnoprstufye\");\r\nВозврат Слово;\r\nКонецФункции\n\nФункция ЗаменитьСимволы (Источник,Текст,Замена) Экспорт\r\nРезультат = Текст;\r\nДля Сч = 1 По СтрДлина(Источник) Цикл\r\nРезультат = СтрЗаменить(Результат,Сред(Источник,Сч,1),Сред(Замена,Сч,1));\r\nКонецЦикла;\r\nВозврат Результат;    \r\nКонецФункции \r\n\r\nФункция Транслитерация(Знач Слово) Экспорт\r\nСлово = НРег(Слово);\r\nСлово=СтрЗаменить(Слово,\"ш\",\"sh\");\r\nСлово=СтрЗаменить(Слово,\"щ\",\"shh\");\r\nСлово=СтрЗаменить(Слово,\"ж\",\"zh\");\r\nСлово=СтрЗаменить(Слово,\"ц\",\"ts\");\r\nСлово=СтрЗаменить(Слово,\"ь\",\"'\");\r\nСлово=СтрЗаменить(Слово,\"ъ\", Символ(34)); //двойная кавычка\r\nСлово=СтрЗаменить(Слово,\"ч\",\"ch\");\r\nСлово=СтрЗаменить(Слово,\"её\",\"yeyo\");\r\nСлово=СтрЗаменить(Слово,\"ёе\",\"yoye\");\r\nСлово=СтрЗаменить(Слово,\"я\",\"ya\");\r\nСлово=СтрЗаменить(Слово,\"ю\",\"yu\");\r\nСлово=СтрЗаменить(Слово,\" - \",\"-\");\r\nСлово=СтрЗаменить(Слово,\" -\",\"-\");\r\nСлово=СтрЗаменить(Слово,\"- \",\"-\");\r\nСлово=СтрЗаменить(Слово,\" \",\"-\");\r\nСлово=ЗаменитьСимволы(\"абвгдезийклмнопрстуфыэ\",Слово,\"abvgdezijklmnoprstufye\");\r\nВозврат Слово;\r\nКонецФункции\n\nОрфографическая ошибка в yeyo: yeyo\r\nОрфографическая ошибка в yoye: yoye\r\nОрфографическая ошибка в абвгдезийклмнопрстуфыэ: абвгдезийклмнопрстуфыэ\r\nОрфографическая ошибка в abvgdezijklmnoprstufye: abvgdezijklmnoprstufye"
  },
  {
    "title": "Изменение формы справочника в зависимости от папки",
    "description": "Изменение формы справочника в зависимости от папки",
    "code_snippet": "Процедура ОбработкаПолученияФормы(ВидФормы, Параметры, ВыбраннаяФорма, ДополнительнаяИнформация, СтандартнаяОбработка)\r\n\t\r\n\tЕсли ВидФормы = \"ФормаОбъекта\" Тогда\r\n\t\t\r\n\t\tЕсли Параметры.Свойство(\"Ключ\") \r\n\t\t\tИ ОбщегоНазначенияСервер.ВходитВИерархию(Параметры.Ключ, Справочники.Проекты.ИнвестиционныеПроекты) Тогда\r\n\t\t\t\r\n\t\t\tСтандартнаяОбработка = Ложь;\r\n\t\t\tВыбраннаяФорма       = \"ФормаЭлементаУправляемая\";\r\n\t\t\t\r\n\t\tИначеЕсли Параметры.Свойство(\"ЗначенияЗаполнения\")\r\n\t\t\tИ Параметры.ЗначенияЗаполнения.Свойство(\"Родитель\")\r\n\t\t\tИ ОбщегоНазначенияСервер.ВходитВИерархию(Параметры.ЗначенияЗаполнения.Родитель, Справочники.Проекты.ИнвестиционныеПроекты) Тогда\r\n\t\t\t\r\n\t\t\tСтандартнаяОбработка = Ложь;\r\n\t\t\tВыбраннаяФорма       = \"ФормаЭлементаУправляемая\";\r\n\t\t\t\r\n\t\tИначеЕсли Параметры.Свойство(\"ЗначениеКопирования\")\r\n\t\t\tИ ОбщегоНазначенияСервер.ВходитВИерархию(Параметры.ЗначениеКопирования.Родитель, Справочники.Проекты.ИнвестиционныеПроекты) Тогда\r\n\t\t\t\r\n\t\t\tСтандартнаяОбработка = Ложь;\r\n\t\t\tВыбраннаяФорма       = \"ФормаЭлементаУправляемая\";\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры\n\nПроцедура ОбработкаПолученияФормы(ВидФормы, Параметры, ВыбраннаяФорма, ДополнительнаяИнформация, СтандартнаяОбработка)\r\n\t\r\n\tЕсли ВидФормы = \"ФормаОбъекта\" Тогда\r\n\t\t\r\n\t\tЕсли Параметры.Свойство(\"Ключ\") \r\n\t\t\tИ ОбщегоНазначенияСервер.ВходитВИерархию(Параметры.Ключ, Справочники.Проекты.ИнвестиционныеПроекты) Тогда\r\n\t\t\t\r\n\t\t\tСтандартнаяОбработка = Ложь;\r\n\t\t\tВыбраннаяФорма       = \"ФормаЭлементаУправляемая\";\r\n\t\t\t\r\n\t\tИначеЕсли Параметры.Свойство(\"ЗначенияЗаполнения\")\r\n\t\t\tИ Параметры.ЗначенияЗаполнения.Свойство(\"Родитель\")\r\n\t\t\tИ ОбщегоНазначенияСервер.ВходитВИерархию(Параметры.ЗначенияЗаполнения.Родитель, Справочники.Проекты.ИнвестиционныеПроекты) Тогда\r\n\t\t\t\r\n\t\t\tСтандартнаяОбработка = Ложь;\r\n\t\t\tВыбраннаяФорма       = \"ФормаЭлементаУправляемая\";\r\n\t\t\t\r\n\t\tИначеЕсли Параметры.Свойство(\"ЗначениеКопирования\")\r\n\t\t\tИ ОбщегоНазначенияСервер.ВходитВИерархию(Параметры.ЗначениеКопирования.Родитель, Справочники.Проекты.ИнвестиционныеПроекты) Тогда\r\n\t\t\t\r\n\t\t\tСтандартнаяОбработка = Ложь;\r\n\t\t\tВыбраннаяФорма       = \"ФормаЭлементаУправляемая\";\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Дополнительные свойства",
    "description": "Дополнительные свойства",
    "code_snippet": "СвойствоДляИзменения = ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоНаименованию(\"НаименованиеСвойства\");\r\nЕсли не Свойство.Пустая() Тогда\r\n    Отбор = Новый Структура;\r\n    Отбор.Вставить(\"Объект\", ОбъектСсылка);\r\n    Отбор.Вставить(\"Свойство\", СвойствоДляИзменения);\r\n    СвойствоДляИзменения = РегистрыСведений.ЗначенияСвойствОбъектов.Получить(Отбор).Значение;\r\n    СвойствоДляИзменения = Истина;\r\nКонецЕсли;\n\nСвойствоДляИзменения = ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоНаименованию(\"НаименованиеСвойства\");\r\nЕсли не Свойство.Пустая() Тогда\r\n    Отбор = Новый Структура;\r\n    Отбор.Вставить(\"Объект\", ОбъектСсылка);\r\n    Отбор.Вставить(\"Свойство\", СвойствоДляИзменения);\r\n    СвойствоДляИзменения = РегистрыСведений.ЗначенияСвойствОбъектов.Получить(Отбор).Значение;\r\n    СвойствоДляИзменения = Истина;\r\nКонецЕсли;\n\n{6} Переменной СвойствоДляИзменения присвоено значение, но оно нигде не используется\r\n{7} Переменной СвойствоДляИзменения присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Создать отбор в скд",
    "description": "Создать отбор в скд",
    "code_snippet": "//очистка тек. отбора\r\nКомпоновщикНастроек.Настройки.Отбор.Элементы.Очистить();\r\n\r\nНовыйЭлементОтбора = КомпоновщикНастроек.Настройки.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\nНовыйЭлементОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных(\"Контрагент.ОсновнойМенеджерПокупателя\");\r\nНовыйЭлементОтбора.Использование  = Истина;\r\nНовыйЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.Равно;\r\nНовыйЭлементОтбора.ПравоеЗначение = глЗначениеПеременной(\"глТекущийПользователь\");\r\n\r\n//очистим таб поле\r\nЭлементыФормы.Результат.Очистить();\r\n//перекомпонуем результат\r\nСкомпоноватьРезультат(ЭлементыФормы.Результат, ДанныеРасшифровки);\n\n//очистка тек. отбора\r\nКомпоновщикНастроек.Настройки.Отбор.Элементы.Очистить();\r\n\r\nНовыйЭлементОтбора = КомпоновщикНастроек.Настройки.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\nНовыйЭлементОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных(\"Контрагент.ОсновнойМенеджерПокупателя\");\r\nНовыйЭлементОтбора.Использование  = Истина;\r\nНовыйЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.Равно;\r\nНовыйЭлементОтбора.ПравоеЗначение = глЗначениеПеременной(\"глТекущийПользователь\");\r\n\r\n//очистим таб поле\r\nЭлементыФормы.Результат.Очистить();\r\n//перекомпонуем результат\r\nСкомпоноватьРезультат(ЭлементыФормы.Результат, ДанныеРасшифровки);\n\nОрфографическая ошибка в перекомпонуем: перекомпонуем"
  },
  {
    "title": "Запрос с нумерацией строк",
    "description": "Запрос с нумерацией строк",
    "code_snippet": "ВЫБРАТЬ\r\n\t                 |\tШтрихкодыНоменклатуры.Штрихкод,\r\n\t                 |\tШтрихкодыНоменклатуры.Номенклатура,\r\n\t                 |\tШтрихкодыНоменклатуры.Характеристика,\r\n\t                 |\tШтрихкодыНоменклатуры.Упаковка\r\n\t                 |ПОМЕСТИТЬ Нач\r\n\t                 |ИЗ\r\n\t                 |\tРегистрСведений.ШтрихкодыНоменклатуры КАК ШтрихкодыНоменклатуры\r\n\t                 |;\r\n\t                 |\r\n\t                 |////////////////////////////////////////////////////////////////////////////////\r\n\t                 |ВЫБРАТЬ\r\n\t                 |\tНач.Штрихкод,\r\n\t                 |\tКОЛИЧЕСТВО(Нач1.Штрихкод) КАК ПорядковыйНомер\r\n\t                 |ИЗ\r\n\t                 |\tНач КАК Нач\r\n\t                 |\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Нач КАК Нач1\r\n\t                 |\t\tПО Нач.Штрихкод >= Нач1.Штрихкод\r\n\t                 |\r\n\t                 |СГРУППИРОВАТЬ ПО\r\n\t                 |\tНач.Штрихкод\r\n\t                 |\r\n\t                 |УПОРЯДОЧИТЬ ПО\r\n\t                 |\tПорядковыйНомер\n\nВЫБРАТЬ\r\n\t                 |\tШтрихкодыНоменклатуры.Штрихкод,\r\n\t                 |\tШтрихкодыНоменклатуры.Номенклатура,\r\n\t                 |\tШтрихкодыНоменклатуры.Характеристика,\r\n\t                 |\tШтрихкодыНоменклатуры.Упаковка\r\n\t                 |ПОМЕСТИТЬ Нач\r\n\t                 |ИЗ\r\n\t                 |\tРегистрСведений.ШтрихкодыНоменклатуры КАК ШтрихкодыНоменклатуры\r\n\t                 |;\r\n\t                 |\r\n\t                 |////////////////////////////////////////////////////////////////////////////////\r\n\t                 |ВЫБРАТЬ\r\n\t                 |\tНач.Штрихкод,\r\n\t                 |\tКОЛИЧЕСТВО(Нач1.Штрихкод) КАК ПорядковыйНомер\r\n\t                 |ИЗ\r\n\t                 |\tНач КАК Нач\r\n\t                 |\t\tВНУТРЕННЕЕ СОЕДИНЕНИЕ Нач КАК Нач1\r\n\t                 |\t\tПО Нач.Штрихкод >= Нач1.Штрихкод\r\n\t                 |\r\n\t                 |СГРУППИРОВАТЬ ПО\r\n\t                 |\tНач.Штрихкод\r\n\t                 |\r\n\t                 |УПОРЯДОЧИТЬ ПО\r\n\t                 |\tПорядковыйНомер\n\n{} Ожидается идентификатор\r\nОрфографическая ошибка в ШтрихкодыНоменклатуры (найдено 6): Штрихкоды"
  },
  {
    "title": "Значение из буфера обмена",
    "description": "Значение из буфера обмена",
    "code_snippet": "Функция ПолучитьТекстИзБуфераОбмена() Экспорт\r\n  #Если Клиент Тогда\r\n    Объект = Новый COMОбъект(\"htmlfile\");\r\n    Возврат Объект.ParentWindow.ClipboardData.Getdata(\"Text\");\r\n  #КонецЕсли\r\nКонецФункции\n\nФункция ПолучитьТекстИзБуфераОбмена() Экспорт\r\n  #Если Клиент Тогда\r\n    Объект = Новый COMОбъект(\"htmlfile\");\r\n    Возврат Объект.ParentWindow.ClipboardData.Getdata(\"Text\");\r\n  #КонецЕсли\r\nКонецФункции\n\nОрфографическая ошибка в htmlfile: htmlfile\r\nОрфографическая ошибка в Getdata: Getdata"
  },
  {
    "title": "Средневзвешенный курс валюты за указанный период",
    "description": "Средневзвешенный курс валюты за указанный период",
    "code_snippet": "////////////////////////////////////////////////////////////////////////////////\r\n//\r\n// Функция ПолучитьСреднийКурсВалюты\r\n//\r\n// Описание: Возвращает средневзвешенный курс за период\r\n//\r\n//\r\n// Параметры (название, тип, дифференцированное значение)\r\n//\r\n// Возвращаемое значение: \r\n//\r\nФункция ПолучитьСреднийКурсВалюты(НачПериода, КонПериода, Валюта) Экспорт\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"НачалоПериода\", НачПериода);\r\n\tЗапрос.УстановитьПараметр(\"КонецПериода\", КонПериода);\r\n\tЗапрос.УстановитьПараметр(\"Валюта\", Валюта);\r\n\tЗапрос.Текст = \"ВЫБРАТЬ\r\n\t               |\tЕСТЬNULL(ВЫРАЗИТЬ(СУММА(ВложенныйЗапрос.Курс) / КОЛИЧЕСТВО(ВложенныйЗапрос.Период) КАК ЧИСЛО(15, 4)), 0) КАК СреднийКурс\r\n\t               |ИЗ\r\n\t               |\t(ВЫБРАТЬ\r\n\t               |\t\tВложенныйЗапрос.Период КАК Период,\r\n\t               |\t\tКурсыВалют.Курс КАК Курс\r\n\t               |\tИЗ\r\n\t               |\t\t(ВЫБРАТЬ\r\n\t               |\t\t\tМАКСИМУМ(КурсыВалют.Период) КАК ПериодКурса,\r\n\t               |\t\t\tВложенныйЗапрос.Период КАК Период\r\n\t               |\t\tИЗ\r\n\t               |\t\t\t(ВЫБРАТЬ\r\n\t               |\t\t\t\tДОБАВИТЬКДАТЕ(&НачалоПериода, ДЕНЬ, aa.a * 1000 + bb.b * 100 + cc.c * 10 + dd.d) КАК Период\r\n\t               |\t\t\tИЗ\r\n\t               |\t\t\t\t(ВЫБРАТЬ\r\n\t               |\t\t\t\t\t0 КАК a\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t1\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t2\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t3\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t4\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t5\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t6\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t7\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t8\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t9) КАК aa\r\n\t               |\t\t\t\t\tПОЛНОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t0 КАК b\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t1\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t2\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t3\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t4\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t5\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t6\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t7\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t8\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t9) КАК bb\r\n\t               |\t\t\t\t\tПО (ИСТИНА)\r\n\t               |\t\t\t\t\tПОЛНОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t0 КАК c\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t1\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t2\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t3\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t4\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t5\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t6\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t7\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t8\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t9) КАК cc\r\n\t               |\t\t\t\t\tПО (ИСТИНА)\r\n\t               |\t\t\t\t\tПОЛНОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t0 КАК d\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t1\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t2\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t3\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t4\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t5\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t6\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t7\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t8\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t9) КАК dd\r\n\t               |\t\t\t\t\tПО (ИСТИНА)\r\n\t               |\t\t\tГДЕ\r\n\t               |\t\t\t\taa.a * 1000 + bb.b * 100 + cc.c * 10 + dd.d <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ)) КАК ВложенныйЗапрос\r\n\t               |\t\t\t\tЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют КАК КурсыВалют\r\n\t               |\t\t\t\tПО КурсыВалют.Период <= ВложенныйЗапрос.Период\r\n\t               |\t\t\t\t\tИ (КурсыВалют.Валюта = &Валюта)\r\n\t               |\t\t\r\n\t               |\t\tСГРУППИРОВАТЬ ПО\r\n\t               |\t\t\tВложенныйЗапрос.Период) КАК ВложенныйЗапрос\r\n\t               |\t\t\tЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют КАК КурсыВалют\r\n\t               |\t\t\tПО ВложенныйЗапрос.ПериодКурса = КурсыВалют.Период\r\n\t               |\t\t\t\tИ (КурсыВалют.Валюта = &Валюта)) КАК ВложенныйЗапрос\";\r\n\tРезультат = Запрос.Выполнить();\r\n\tЕсли Результат.Пустой() Тогда\r\n\t\tВозврат 0;\r\n\tИначе\r\n\t\tВыборка = Результат.Выбрать();\r\n\t\tВыборка.Следующий();\r\n\t\tВозврат Выборка.СреднийКурс ;\t\t\r\n\tКонецЕсли; \r\n    \r\nКонецФункции //ПолучитьСреднийКурсВалюты\n\n////////////////////////////////////////////////////////////////////////////////\r\n//\r\n// Функция ПолучитьСреднийКурсВалюты\r\n//\r\n// Описание: Возвращает средневзвешенный курс за период\r\n//\r\n//\r\n// Параметры (название, тип, дифференцированное значение)\r\n//\r\n// Возвращаемое значение: \r\n//\r\nФункция ПолучитьСреднийКурсВалюты(НачПериода, КонПериода, Валюта) Экспорт\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.УстановитьПараметр(\"НачалоПериода\", НачПериода);\r\n\tЗапрос.УстановитьПараметр(\"КонецПериода\", КонПериода);\r\n\tЗапрос.УстановитьПараметр(\"Валюта\", Валюта);\r\n\tЗапрос.Текст = \"ВЫБРАТЬ\r\n\t               |\tЕСТЬNULL(ВЫРАЗИТЬ(СУММА(ВложенныйЗапрос.Курс) / КОЛИЧЕСТВО(ВложенныйЗапрос.Период) КАК ЧИСЛО(15, 4)), 0) КАК СреднийКурс\r\n\t               |ИЗ\r\n\t               |\t(ВЫБРАТЬ\r\n\t               |\t\tВложенныйЗапрос.Период КАК Период,\r\n\t               |\t\tКурсыВалют.Курс КАК Курс\r\n\t               |\tИЗ\r\n\t               |\t\t(ВЫБРАТЬ\r\n\t               |\t\t\tМАКСИМУМ(КурсыВалют.Период) КАК ПериодКурса,\r\n\t               |\t\t\tВложенныйЗапрос.Период КАК Период\r\n\t               |\t\tИЗ\r\n\t               |\t\t\t(ВЫБРАТЬ\r\n\t               |\t\t\t\tДОБАВИТЬКДАТЕ(&НачалоПериода, ДЕНЬ, aa.a * 1000 + bb.b * 100 + cc.c * 10 + dd.d) КАК Период\r\n\t               |\t\t\tИЗ\r\n\t               |\t\t\t\t(ВЫБРАТЬ\r\n\t               |\t\t\t\t\t0 КАК a\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t1\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t2\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t3\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t4\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t5\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t6\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t7\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t8\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\r\n\t               |\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t9) КАК aa\r\n\t               |\t\t\t\t\tПОЛНОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t0 КАК b\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t1\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t2\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t3\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t4\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t5\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t6\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t7\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t8\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t9) КАК bb\r\n\t               |\t\t\t\t\tПО (ИСТИНА)\r\n\t               |\t\t\t\t\tПОЛНОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t0 КАК c\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t1\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t2\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t3\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t4\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t5\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t6\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t7\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t8\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t9) КАК cc\r\n\t               |\t\t\t\t\tПО (ИСТИНА)\r\n\t               |\t\t\t\t\tПОЛНОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t0 КАК d\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t1\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t2\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t3\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t4\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t5\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t6\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t7\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t8\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tОБЪЕДИНИТЬ\r\n\t               |\t\t\t\t\t\r\n\t               |\t\t\t\t\tВЫБРАТЬ\r\n\t               |\t\t\t\t\t\t9) КАК dd\r\n\t               |\t\t\t\t\tПО (ИСТИНА)\r\n\t               |\t\t\tГДЕ\r\n\t               |\t\t\t\taa.a * 1000 + bb.b * 100 + cc.c * 10 + dd.d <= РАЗНОСТЬДАТ(&НачалоПериода, &КонецПериода, ДЕНЬ)) КАК ВложенныйЗапрос\r\n\t               |\t\t\t\tЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют КАК КурсыВалют\r\n\t               |\t\t\t\tПО КурсыВалют.Период <= ВложенныйЗапрос.Период\r\n\t               |\t\t\t\t\tИ (КурсыВалют.Валюта = &Валюта)\r\n\t               |\t\t\r\n\t               |\t\tСГРУППИРОВАТЬ ПО\r\n\t               |\t\t\tВложенныйЗапрос.Период) КАК ВложенныйЗапрос\r\n\t               |\t\t\tЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют КАК КурсыВалют\r\n\t               |\t\t\tПО ВложенныйЗапрос.ПериодКурса = КурсыВалют.Период\r\n\t               |\t\t\t\tИ (КурсыВалют.Валюта = &Валюта)) КАК ВложенныйЗапрос\";\r\n\tРезультат = Запрос.Выполнить();\r\n\tЕсли Результат.Пустой() Тогда\r\n\t\tВозврат 0;\r\n\tИначе\r\n\t\tВыборка = Результат.Выбрать();\r\n\t\tВыборка.Следующий();\r\n\t\tВозврат Выборка.СреднийКурс ;\t\t\r\n\tКонецЕсли; \r\n    \r\nКонецФункции //ПолучитьСреднийКурсВалюты"
  },
  {
    "title": "Запрет выгрузки в КД по  дате запрета редактирования",
    "description": "Запрет выгрузки в КД по  дате запрета редактирования",
    "code_snippet": "// Выгружаем документы только по списку организаций.\r\nМетаданныеОбъекта = Метаданные.НайтиПоТипу(ТипЗнч(Источник));\r\nЕсли МетаданныеОбъекта <> Неопределено\r\n\tИ Метаданные.Документы.Содержит(МетаданныеОбъекта) Тогда\r\n\t\r\n\tЕсли МетаданныеОбъекта.Реквизиты.Найти(\"Организация\") <> Неопределено Тогда\t \r\n\t\t\r\n\t\tДатаЗапретаРедактирования = Параметры.ДатыЗапретаРедактирования[Источник.Организация.Код];\r\n\t\tЕсли ЗначениеЗаполнено(ДатаЗапретаРедактирования) Тогда\r\n\t\t\t\r\n\t\t\tЕсли Источник.Дата <= ДатаЗапретаРедактирования Тогда\r\n\t\t\t\tНеЗамещатьОбъектПриЗагрузке = Истина;\r\n\t\t\t\tТолькоПолучитьУзелСсылки    = Истина;\r\n\t\t\tКонецЕсли;\t\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецЕсли;\n\n// Выгружаем документы только по списку организаций.\r\nМетаданныеОбъекта = Метаданные.НайтиПоТипу(ТипЗнч(Источник));\r\nЕсли МетаданныеОбъекта <> Неопределено\r\n\tИ Метаданные.Документы.Содержит(МетаданныеОбъекта) Тогда\r\n\t\r\n\tЕсли МетаданныеОбъекта.Реквизиты.Найти(\"Организация\") <> Неопределено Тогда\t \r\n\t\t\r\n\t\tДатаЗапретаРедактирования = Параметры.ДатыЗапретаРедактирования[Источник.Организация.Код];\r\n\t\tЕсли ЗначениеЗаполнено(ДатаЗапретаРедактирования) Тогда\r\n\t\t\t\r\n\t\t\tЕсли Источник.Дата <= ДатаЗапретаРедактирования Тогда\r\n\t\t\t\tНеЗамещатьОбъектПриЗагрузке = Истина;\r\n\t\t\t\tТолькоПолучитьУзелСсылки    = Истина;\r\n\t\t\tКонецЕсли;\t\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЕсли;\r\n\t\r\nКонецЕсли;\n\n{12} Переменной НеЗамещатьОбъектПриЗагрузке присвоено значение, но оно нигде не используется\r\n{13} Переменной ТолькоПолучитьУзелСсылки присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Значение полей в расшифровке СКД",
    "description": "Значение полей в расшифровке СКД",
    "code_snippet": "&НаСервереБезКонтекста \r\nФункция ПолучитьЗначениеПоляРасшифровкиНаСервере(ИдентификаторРасшифровки, АдресДанныхРасшифровки)\r\n\t\r\n    ДанныеРасшифровки = ПолучитьИзВременногоХранилища(АдресДанныхРасшифровки);\r\n\tЭлементРасшифровки = ДанныеРасшифровки.Элементы[ИдентификаторРасшифровки];\r\n\t\r\n\tМассивРодителей = Новый Массив;\r\n\tМассивРодителей.Добавить(ЭлементРасшифровки.ПолучитьПоля());\r\n\t\r\n\tРодители = ЭлементРасшифровки.ПолучитьРодителей();\r\n\tЗаполнитьМассивРодителей(МассивРодителей, Родители);\r\n\t\r\n\tРезультат = Новый Соответствие;\r\n\tДля Счетчик = 1 по МассивРодителей.Количество() Цикл \r\n\t\t\r\n\t\t// Обойдем в обратном порядке, чтобы поставить условия в порядке группировок\t\t\t\r\n\t\tПоляКомпоновки = МассивРодителей[МассивРодителей.Количество() - Счетчик];\r\n\t\tДля каждого ПолеКомпоновки из ПоляКомпоновки Цикл\r\n\t\t\t\r\n\t\t\t//Если ПолеКомпоновки.Иерархия Тогда\r\n\t\t\t//\tПродолжить;\r\n\t\t\t//КонецЕсли;\t\r\n\t\t\t\r\n\t\t\tРезультат.Вставить(ПолеКомпоновки.Поле, ПолеКомпоновки.Значение);\r\n\t\t\t\r\n\t\tКонецЦикла;\t\r\n\t\t\r\n\tКонецЦикла;\t\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\r\n\r\n&НаСервереБезКонтекста \r\nПроцедура ЗаполнитьМассивРодителей(МассивРодителей, Родители)\r\n\t\r\n\tДля каждого Родитель из Родители Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(Родитель) = Тип(\"ЭлементРасшифровкиКомпоновкиДанныхПоля\") Тогда\r\n\t\t\tМассивРодителей.Добавить(Родитель.ПолучитьПоля());\r\n\t\t\t\r\n\t\tИначеЕсли ТипЗнч(Родитель) = Тип(\"ЭлементРасшифровкиКомпоновкиДанныхГруппировка\") Тогда\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\t\tРодители = Родитель.ПолучитьРодителей();\r\n\t\tЕсли Родители.Количество() > 0 Тогда\r\n\t\t\tЗаполнитьМассивРодителей(МассивРодителей, Родители);\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\t\r\n\r\nКонецПроцедуры\n\n&НаСервереБезКонтекста \r\nФункция ПолучитьЗначениеПоляРасшифровкиНаСервере(ИдентификаторРасшифровки, АдресДанныхРасшифровки)\r\n\t\r\n    ДанныеРасшифровки = ПолучитьИзВременногоХранилища(АдресДанныхРасшифровки);\r\n\tЭлементРасшифровки = ДанныеРасшифровки.Элементы[ИдентификаторРасшифровки];\r\n\t\r\n\tМассивРодителей = Новый Массив;\r\n\tМассивРодителей.Добавить(ЭлементРасшифровки.ПолучитьПоля());\r\n\t\r\n\tРодители = ЭлементРасшифровки.ПолучитьРодителей();\r\n\tЗаполнитьМассивРодителей(МассивРодителей, Родители);\r\n\t\r\n\tРезультат = Новый Соответствие;\r\n\tДля Счетчик = 1 по МассивРодителей.Количество() Цикл \r\n\t\t\r\n\t\t// Обойдем в обратном порядке, чтобы поставить условия в порядке группировок\t\t\t\r\n\t\tПоляКомпоновки = МассивРодителей[МассивРодителей.Количество() - Счетчик];\r\n\t\tДля каждого ПолеКомпоновки из ПоляКомпоновки Цикл\r\n\t\t\t\r\n\t\t\t//Если ПолеКомпоновки.Иерархия Тогда\r\n\t\t\t//\tПродолжить;\r\n\t\t\t//КонецЕсли;\t\r\n\t\t\t\r\n\t\t\tРезультат.Вставить(ПолеКомпоновки.Поле, ПолеКомпоновки.Значение);\r\n\t\t\t\r\n\t\tКонецЦикла;\t\r\n\t\t\r\n\tКонецЦикла;\t\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции\r\n\r\n&НаСервереБезКонтекста \r\nПроцедура ЗаполнитьМассивРодителей(МассивРодителей, Родители)\r\n\t\r\n\tДля каждого Родитель из Родители Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(Родитель) = Тип(\"ЭлементРасшифровкиКомпоновкиДанныхПоля\") Тогда\r\n\t\t\tМассивРодителей.Добавить(Родитель.ПолучитьПоля());\r\n\t\t\t\r\n\t\tИначеЕсли ТипЗнч(Родитель) = Тип(\"ЭлементРасшифровкиКомпоновкиДанныхГруппировка\") Тогда\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\t\tРодители = Родитель.ПолучитьРодителей();\r\n\t\tЕсли Родители.Количество() > 0 Тогда\r\n\t\t\tЗаполнитьМассивРодителей(МассивРодителей, Родители);\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\t\r\n\r\nКонецПроцедуры\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Запись в Журнал",
    "description": "Запись в Журнал",
    "code_snippet": "ИнформацияОбОшибке = ИнформацияОбОшибке();\r\nТекстСообщения = НСтр(\"ru = 'Ошибка при регистрации компоненты comcntr.'\") + Символы.ПС;\r\nДобавитьСообщениеДляЖурналаРегистрации(НСтр(\"ru = 'Регистрация компоненты comcntr'\"), \"Ошибка\", \r\nТекстСообщения + ПодробноеПредставлениеОшибки(ИнформацияОбОшибке));\r\nОбщегоНазначения.ЗаписатьСобытияВЖурналРегистрации(СообщенияДляЖурналаРегистрации);\r\nПредупреждение(ТекстСообщения + НСтр(\"ru = 'Подробн ости см. в Журнале регистрации.'\"));\n\nИнформацияОбОшибке = ИнформацияОбОшибке();\r\nТекстСообщения = НСтр(\"ru = 'Ошибка при регистрации компоненты comcntr.'\") + Символы.ПС;\r\nДобавитьСообщениеДляЖурналаРегистрации(НСтр(\"ru = 'Регистрация компоненты comcntr'\"), \"Ошибка\", \r\nТекстСообщения + ПодробноеПредставлениеОшибки(ИнформацияОбОшибке));\r\nОбщегоНазначения.ЗаписатьСобытияВЖурналРегистрации(СообщенияДляЖурналаРегистрации);\r\nПредупреждение(ТекстСообщения + НСтр(\"ru = 'Подробн ости см. в Журнале регистрации.'\"));\n\nОрфографическая ошибка в comcntr (найдено 2): comcntr\r\nОрфографическая ошибка в Подробн: Подробн"
  },
  {
    "title": "Установка границы",
    "description": "Установка границы",
    "code_snippet": "ПоследовательностьДляРегистрации = Последовательности.РасчетыПоПриобретениюОрганизации;\r\nПоследовательностьДляРегистрации.УстановитьГраницу(Новый МоментВремени(НачалоМесяца(НаДату)),Новый Структура(\"Организация\",Организация));\r\nПоследовательностьДляРегистрации = Последовательности.РасчетыПоРеализацииОрганизации;\r\nПоследовательностьДляРегистрации.УстановитьГраницу(Новый МоментВремени(НачалоМесяца(НаДату)),Новый Структура(\"Организация\",Организация));\n\nПоследовательностьДляРегистрации = Последовательности.РасчетыПоПриобретениюОрганизации;\r\nПоследовательностьДляРегистрации.УстановитьГраницу(Новый МоментВремени(НачалоМесяца(НаДату)),Новый Структура(\"Организация\",Организация));\r\nПоследовательностьДляРегистрации = Последовательности.РасчетыПоРеализацииОрганизации;\r\nПоследовательностьДляРегистрации.УстановитьГраницу(Новый МоментВремени(НачалоМесяца(НаДату)),Новый Структура(\"Организация\",Организация));\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Структура подчиненности",
    "description": "Структура подчиненности",
    "code_snippet": "Функция ПолучитьРодительскиеДокументы(ДокументСсылка, СписокСвязанныхДокументов = Неопределено, мУжеВСписке = Неопределено) Экспорт\r\n\tЕсли СписокСвязанныхДокументов = Неопределено Тогда\r\n\t\tСписокСвязанныхДокументов = Новый СписокЗначений;\r\n\tКонецЕсли;\r\n\tЕсли мУжеВСписке = Неопределено Тогда\r\n\t\tмУжеВСписке = Новый Соответствие;\r\n\tКонецЕсли;\r\n\tМетаданныеДокумента = ДокументСсылка.Метаданные();\r\n\tСписокРеквизитов = Новый СписокЗначений;\r\n\tДля Каждого Реквизит ИЗ МетаданныеДокумента.Реквизиты Цикл\r\n\t\tТипыРеквизита = Реквизит.Тип.Типы();\r\n\t\tДля Каждого ТекущийТип ИЗ ТипыРеквизита Цикл\r\n\t\t\tМетаданныеРеквизита = Метаданные.НайтиПоТипу(ТекущийТип);\r\n\t\t\tЕсли МетаданныеРеквизита<>Неопределено И Метаданные.Документы.Содержит(МетаданныеРеквизита)\r\n\t\t\t\tИ ПравоДоступа(\"Чтение\", МетаданныеРеквизита) Тогда\r\n\t\t\t\tПопытка\r\n\t\t\t\t\tЗначениеРеквизита = ДокументСсылка[Реквизит.Имя];\r\n\t\t\t\tИсключение\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\tКонецПопытки;\r\n\t\t\t\tЕСли ЗначениеРеквизита<>Неопределено И НЕ ЗначениеРеквизита.Пустая() И ТипЗнч(ЗначениеРеквизита) = ТекущийТип\r\n\t\t\t\t\tИ мУжеВСписке[ЗначениеРеквизита] = Неопределено И СписокРеквизитов.НайтиПоЗначению(ДокументСсылка[Реквизит.Имя]) = Неопределено Тогда\r\n\t\t\t\t\tПопытка\r\n\t\t\t\t\t\tСписокРеквизитов.Добавить(ЗначениеРеквизита,Формат(ЗначениеРеквизита.Дата,\"ДФ=yyyyMMddЧЧММсс\"));\r\n\t\t\t\t\tИсключение\r\n\t\t\t\t\t\tОтладкаТекстОшибки = ОписаниеОшибки();\r\n\t\t\t\t\tКонецПопытки;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tКонецЦикла;\r\n\tДля Каждого ТЧ Из МетаданныеДокумента.ТабличныеЧасти Цикл\r\n\t\tСтрРеквизитов = \"\";\r\n\t\tПопытка\r\n\t\t\tСодержимоеТЧ = ДокументСсылка[ТЧ.Имя].Выгрузить();\r\n\t\tИсключение\r\n\t\t\tПрервать;\r\n\t\tКонецПопытки;\r\n\t\tДля Каждого Реквизит ИЗ ТЧ.Реквизиты Цикл\r\n\t\t\tТипыРеквизита = Реквизит.Тип.Типы();\r\n\t\t\tДля Каждого ТекущийТип ИЗ ТипыРеквизита Цикл\r\n\t\t\t\tМетаданныеРеквизита = Метаданные.НайтиПоТипу(ТекущийТип);\r\n\t\t\t\tЕсли МетаданныеРеквизита<>Неопределено И Метаданные.Документы.Содержит(МетаданныеРеквизита)\r\n\t\t\t\t\tИ ПравоДоступа(\"Чтение\", МетаданныеРеквизита) Тогда\r\n\t\t\t\t\tСтрРеквизитов = СтрРеквизитов + ?(СтрРеквизитов = \"\", \"\", \", \") + Реквизит.Имя;\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЦикла;\r\n\t\tСодержимоеТЧ.Свернуть(СтрРеквизитов);\r\n\t\tДля Каждого КолонкаТЧ ИЗ СодержимоеТЧ.Колонки Цикл\r\n\t\t\tДля Каждого СтрокаТЧ ИЗ СодержимоеТЧ Цикл\r\n\t\t\t\tПопытка\r\n\t\t\t\t\tЗначениеРеквизита = СтрокаТЧ[КолонкаТЧ.Имя];\r\n\t\t\t\tИсключение\r\n\t\t\t\t\tПродолжить;\r\n\t\t\t\tКонецПопытки;\r\n\t\t\t\tМетаданныеЗначения = Метаданные.НайтиПоТипу(ТипЗнч(ЗначениеРеквизита));\r\n\t\t\t\tЕсли МетаданныеЗначения = Неопределено Тогда\r\n\t\t\t\t\t// базовый тип\r\n\t\t\t\t\tПродолжить;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\tЕСли ЗначениеРеквизита<>Неопределено И НЕ ЗначениеРеквизита.Пустая()\r\n\t\t\t\t\tИ Метаданные.Документы.Содержит(МетаданныеЗначения)\r\n\t\t\t\t\tИ мУжеВСписке[ЗначениеРеквизита] = Неопределено Тогда\r\n\t\t\t\t\tЕсли СписокРеквизитов.НайтиПоЗначению(ЗначениеРеквизита) = Неопределено Тогда\r\n\t\t\t\t\t\tПопытка\r\n\t\t\t\t\t\t\tСписокРеквизитов.Добавить(ЗначениеРеквизита,Формат(ЗначениеРеквизита.Дата,\"ДФ=yyyyMMddЧЧММсс\"));\r\n\t\t\t\t\t\tИсключение\r\n\t\t\t\t\t\t\tОтладкаТекстОшибки = ОписаниеОшибки();\r\n\t\t\t\t\t\tКонецПопытки;\r\n\t\t\t\t\tКонецЕсли;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЦикла;\r\n\tКонецЦикла;\r\n\tмУжеВСписке.Вставить(ДокументСсылка, Истина);\r\n\tДля Каждого СтрСЗ Из СписокРеквизитов Цикл\r\n\t\tСписокСвязанныхДокументов = ПолучитьРодительскиеДокументы(СтрСЗ.Значение, СписокСвязанныхДокументов, мУжеВСписке);\r\n\tКонецЦикла;\r\n\tЗапрос = Новый Запрос(\"ВЫБРАТЬ РАЗРЕШЕННЫЕ Ссылка\r\n\t| ИЗ Документ.\"+МетаданныеДокумента.Имя + \" ГДЕ Ссылка = &Ссылка\");\r\n\tЗапрос.УстановитьПараметр(\"Ссылка\", ДокументСсылка);\r\n\tВыборка = Запрос.Выполнить().Выбрать();\r\n\tЕСли Выборка.Следующий() Тогда\r\n\t\tСписокСвязанныхДокументов.Добавить(Выборка.Ссылка);\r\n\tИначе\r\n\t\tСписокСвязанныхДокументов.Добавить(ДокументСсылка);\r\n\tКонецЕсли;\r\n\tВозврат СписокСвязанныхДокументов;\r\nКонецФункции\r\nФункция ПолучитьПодчиненныеДокументы(ДокументСсылка, СписокСвязанныхДокументов = Неопределено, мУжеВСписке = Неопределено) Экспорт\r\n\tЕсли СписокСвязанныхДокументов = Неопределено Тогда\r\n\t\tСписокСвязанныхДокументов = Новый СписокЗначений;\r\n\tКонецЕсли;\r\n\tЕсли мУжеВСписке = Неопределено Тогда\r\n\t\tмУжеВСписке = Новый Соответствие;\r\n\tКонецЕсли;\r\n\tТаблица = ПолныеПрава.ПолучитьВыборкуПоКритериюОтбора(\"СвязанныеДокументы\", ДокументСсылка);\r\n\tКэшПоТипамДокументов = Новый Соответствие;\r\n\tДля Каждого СтрокаТаблицы ИЗ Таблица Цикл\r\n\t\tМетаданныеДокумента = СтрокаТаблицы.Ссылка.Метаданные();\r\n\t\tЕсли Не ПравоДоступа(\"Чтение\", МетаданныеДокумента) Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\tИмяДокумента = МетаданныеДокумента.Имя;\r\n\t\tСинонимДокумента = МетаданныеДокумента.Синоним;\r\n\t\tСтруктураТипа = КэшПоТипамДокументов[ИмяДокумента];\r\n\t\tЕсли СтруктураТипа = Неопределено Тогда\r\n\t\t\tСтруктураТипа = Новый Структура(\"Синоним, МассивСсылок\", СинонимДокумента, Новый Массив);\r\n\t\t\tКэшПоТипамДокументов.Вставить(ИмяДокумента, СтруктураТипа);\r\n\t\tКонецЕсли;\r\n\t\tСтруктураТипа.МассивСсылок.Добавить(СтрокаТаблицы.Ссылка);\r\n\tКонецЦикла;\r\n\tЕСли КэшПоТипамДокументов.Количество() = 0 Тогда\r\n\t\tВозврат СписокСвязанныхДокументов;\r\n\tКонецЕсли;\r\n\tТекстЗапросаНачало = \"ВЫБРАТЬ РАЗРЕШЕННЫЕ * ИЗ (\";\r\n\tТекстЗапросаКонец = \") КАК ПодчиненныеДокументы \";\r\n\tЗапрос = Новый Запрос;\r\n\tДля Каждого КлючИЗначение ИЗ КэшПоТипамДокументов Цикл\r\n\t\tЗапрос.Текст = Запрос.Текст + ?(Запрос.Текст = \"\", \"\r\n\t\t|ВЫБРАТЬ \", \"\r\n\t\t|ОБЪЕДИНИТЬ ВСЕ\r\n\t\t|ВЫБРАТЬ\") + \"\r\n\t\t|Ссылка\r\n\t\t|ИЗ Документ.\" + КлючИЗначение.Ключ + \"\r\n\t\t|ГДЕ Ссылка В (&\" + КлючИЗначение.Ключ + \")\";\r\n\t\tЗапрос.УстановитьПараметр(КлючИЗначение.Ключ, КлючИЗначение.Значение.МассивСсылок);\r\n\tКонецЦикла;\r\n\tЗапрос.Текст = ТекстЗапросаНачало + Запрос.Текст + ТекстЗапросаКонец;\r\n\tВыборка = Запрос.Выполнить().Выбрать();\r\n\tПока Выборка.Следующий() Цикл\r\n\t\tЕсли мУжеВСписке[Выборка.Ссылка] = Неопределено Тогда\r\n\t\t\tСписокСвязанныхДокументов.Добавить(Выборка.Ссылка);\r\n\t\t\tмУжеВСписке.Вставить(Выборка.Ссылка, Истина);\r\n\t\t\tСписокСвязанныхДокументов = ПолучитьПодчиненныеДокументы(Выборка.Ссылка, СписокСвязанныхДокументов, мУжеВСписке);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tВозврат СписокСвязанныхДокументов;\r\nКонецФункции\n\nФункция ПолучитьРодительскиеДокументы(ДокументСсылка, СписокСвязанныхДокументов = Неопределено, мУжеВСписке = Неопределено) Экспорт\r\n\tЕсли СписокСвязанныхДокументов = Неопределено Тогда\r\n\t\tСписокСвязанныхДокументов = Новый СписокЗначений;\r\n\tКонецЕсли;\r\n\tЕсли мУжеВСписке = Неопределено Тогда\r\n\t\tмУжеВСписке = Новый Соответствие;\r\n\tКонецЕсли;\r\n\tМетаданныеДокумента = ДокументСсылка.Метаданные();\r\n\tСписокРеквизитов = Новый СписокЗначений;\r\n\tДля Каждого Реквизит ИЗ МетаданныеДокумента.Реквизиты Цикл\r\n\t\tТипыРеквизита = Реквизит.Тип.Типы();\r\n\t\tДля Каждого ТекущийТип ИЗ ТипыРеквизита Цикл\r\n\t\t\tМетаданныеРеквизита = Метаданные.НайтиПоТипу(ТекущийТип);\r\n\t\t\tЕсли МетаданныеРеквизита<>Неопределено И Метаданные.Документы.Содержит(МетаданныеРеквизита)\r\n\t\t\t\tИ ПравоДоступа(\"Чтение\", МетаданныеРеквизита) Тогда\r\n\t\t\t\tПопытка\r\n\t\t\t\t\tЗначениеРеквизита = ДокументСсылка[Реквизит.Имя];\r\n\t\t\t\tИсключение\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\tКонецПопытки;\r\n\t\t\t\tЕСли ЗначениеРеквизита<>Неопределено И НЕ ЗначениеРеквизита.Пустая() И ТипЗнч(ЗначениеРеквизита) = ТекущийТип\r\n\t\t\t\t\tИ мУжеВСписке[ЗначениеРеквизита] = Неопределено И СписокРеквизитов.НайтиПоЗначению(ДокументСсылка[Реквизит.Имя]) = Неопределено Тогда\r\n\t\t\t\t\tПопытка\r\n\t\t\t\t\t\tСписокРеквизитов.Добавить(ЗначениеРеквизита,Формат(ЗначениеРеквизита.Дата,\"ДФ=yyyyMMddЧЧММсс\"));\r\n\t\t\t\t\tИсключение\r\n\t\t\t\t\t\tОтладкаТекстОшибки = ОписаниеОшибки();\r\n\t\t\t\t\tКонецПопытки;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЕсли;\r\n\t\tКонецЦикла;\r\n\tКонецЦикла;\r\n\tДля Каждого ТЧ Из МетаданныеДокумента.ТабличныеЧасти Цикл\r\n\t\tСтрРеквизитов = \"\";\r\n\t\tПопытка\r\n\t\t\tСодержимоеТЧ = ДокументСсылка[ТЧ.Имя].Выгрузить();\r\n\t\tИсключение\r\n\t\t\tПрервать;\r\n\t\tКонецПопытки;\r\n\t\tДля Каждого Реквизит ИЗ ТЧ.Реквизиты Цикл\r\n\t\t\tТипыРеквизита = Реквизит.Тип.Типы();\r\n\t\t\tДля Каждого ТекущийТип ИЗ ТипыРеквизита Цикл\r\n\t\t\t\tМетаданныеРеквизита = Метаданные.НайтиПоТипу(ТекущийТип);\r\n\t\t\t\tЕсли МетаданныеРеквизита<>Неопределено И Метаданные.Документы.Содержит(МетаданныеРеквизита)\r\n\t\t\t\t\tИ ПравоДоступа(\"Чтение\", МетаданныеРеквизита) Тогда\r\n\t\t\t\t\tСтрРеквизитов = СтрРеквизитов + ?(СтрРеквизитов = \"\", \"\", \", \") + Реквизит.Имя;\r\n\t\t\t\t\tПрервать;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЦикла;\r\n\t\tСодержимоеТЧ.Свернуть(СтрРеквизитов);\r\n\t\tДля Каждого КолонкаТЧ ИЗ СодержимоеТЧ.Колонки Цикл\r\n\t\t\tДля Каждого СтрокаТЧ ИЗ СодержимоеТЧ Цикл\r\n\t\t\t\tПопытка\r\n\t\t\t\t\tЗначениеРеквизита = СтрокаТЧ[КолонкаТЧ.Имя];\r\n\t\t\t\tИсключение\r\n\t\t\t\t\tПродолжить;\r\n\t\t\t\tКонецПопытки;\r\n\t\t\t\tМетаданныеЗначения = Метаданные.НайтиПоТипу(ТипЗнч(ЗначениеРеквизита));\r\n\t\t\t\tЕсли МетаданныеЗначения = Неопределено Тогда\r\n\t\t\t\t\t// базовый тип\r\n\t\t\t\t\tПродолжить;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\t\tЕСли ЗначениеРеквизита<>Неопределено И НЕ ЗначениеРеквизита.Пустая()\r\n\t\t\t\t\tИ Метаданные.Документы.Содержит(МетаданныеЗначения)\r\n\t\t\t\t\tИ мУжеВСписке[ЗначениеРеквизита] = Неопределено Тогда\r\n\t\t\t\t\tЕсли СписокРеквизитов.НайтиПоЗначению(ЗначениеРеквизита) = Неопределено Тогда\r\n\t\t\t\t\t\tПопытка\r\n\t\t\t\t\t\t\tСписокРеквизитов.Добавить(ЗначениеРеквизита,Формат(ЗначениеРеквизита.Дата,\"ДФ=yyyyMMddЧЧММсс\"));\r\n\t\t\t\t\t\tИсключение\r\n\t\t\t\t\t\t\tОтладкаТекстОшибки = ОписаниеОшибки();\r\n\t\t\t\t\t\tКонецПопытки;\r\n\t\t\t\t\tКонецЕсли;\r\n\t\t\t\tКонецЕсли;\r\n\t\t\tКонецЦикла;\r\n\t\tКонецЦикла;\r\n\tКонецЦикла;\r\n\tмУжеВСписке.Вставить(ДокументСсылка, Истина);\r\n\tДля Каждого СтрСЗ Из СписокРеквизитов Цикл\r\n\t\tСписокСвязанныхДокументов = ПолучитьРодительскиеДокументы(СтрСЗ.Значение, СписокСвязанныхДокументов, мУжеВСписке);\r\n\tКонецЦикла;\r\n\tЗапрос = Новый Запрос(\"ВЫБРАТЬ РАЗРЕШЕННЫЕ Ссылка\r\n\t| ИЗ Документ.\"+МетаданныеДокумента.Имя + \" ГДЕ Ссылка = &Ссылка\");\r\n\tЗапрос.УстановитьПараметр(\"Ссылка\", ДокументСсылка);\r\n\tВыборка = Запрос.Выполнить().Выбрать();\r\n\tЕСли Выборка.Следующий() Тогда\r\n\t\tСписокСвязанныхДокументов.Добавить(Выборка.Ссылка);\r\n\tИначе\r\n\t\tСписокСвязанныхДокументов.Добавить(ДокументСсылка);\r\n\tКонецЕсли;\r\n\tВозврат СписокСвязанныхДокументов;\r\nКонецФункции\r\nФункция ПолучитьПодчиненныеДокументы(ДокументСсылка, СписокСвязанныхДокументов = Неопределено, мУжеВСписке = Неопределено) Экспорт\r\n\tЕсли СписокСвязанныхДокументов = Неопределено Тогда\r\n\t\tСписокСвязанныхДокументов = Новый СписокЗначений;\r\n\tКонецЕсли;\r\n\tЕсли мУжеВСписке = Неопределено Тогда\r\n\t\tмУжеВСписке = Новый Соответствие;\r\n\tКонецЕсли;\r\n\tТаблица = ПолныеПрава.ПолучитьВыборкуПоКритериюОтбора(\"СвязанныеДокументы\", ДокументСсылка);\r\n\tКэшПоТипамДокументов = Новый Соответствие;\r\n\tДля Каждого СтрокаТаблицы ИЗ Таблица Цикл\r\n\t\tМетаданныеДокумента = СтрокаТаблицы.Ссылка.Метаданные();\r\n\t\tЕсли Не ПравоДоступа(\"Чтение\", МетаданныеДокумента) Тогда\r\n\t\t\tПродолжить;\r\n\t\tКонецЕсли;\r\n\t\tИмяДокумента = МетаданныеДокумента.Имя;\r\n\t\tСинонимДокумента = МетаданныеДокумента.Синоним;\r\n\t\tСтруктураТипа = КэшПоТипамДокументов[ИмяДокумента];\r\n\t\tЕсли СтруктураТипа = Неопределено Тогда\r\n\t\t\tСтруктураТипа = Новый Структура(\"Синоним, МассивСсылок\", СинонимДокумента, Новый Массив);\r\n\t\t\tКэшПоТипамДокументов.Вставить(ИмяДокумента, СтруктураТипа);\r\n\t\tКонецЕсли;\r\n\t\tСтруктураТипа.МассивСсылок.Добавить(СтрокаТаблицы.Ссылка);\r\n\tКонецЦикла;\r\n\tЕСли КэшПоТипамДокументов.Количество() = 0 Тогда\r\n\t\tВозврат СписокСвязанныхДокументов;\r\n\tКонецЕсли;\r\n\tТекстЗапросаНачало = \"ВЫБРАТЬ РАЗРЕШЕННЫЕ * ИЗ (\";\r\n\tТекстЗапросаКонец = \") КАК ПодчиненныеДокументы \";\r\n\tЗапрос = Новый Запрос;\r\n\tДля Каждого КлючИЗначение ИЗ КэшПоТипамДокументов Цикл\r\n\t\tЗапрос.Текст = Запрос.Текст + ?(Запрос.Текст = \"\", \"\r\n\t\t|ВЫБРАТЬ \", \"\r\n\t\t|ОБЪЕДИНИТЬ ВСЕ\r\n\t\t|ВЫБРАТЬ\") + \"\r\n\t\t|Ссылка\r\n\t\t|ИЗ Документ.\" + КлючИЗначение.Ключ + \"\r\n\t\t|ГДЕ Ссылка В (&\" + КлючИЗначение.Ключ + \")\";\r\n\t\tЗапрос.УстановитьПараметр(КлючИЗначение.Ключ, КлючИЗначение.Значение.МассивСсылок);\r\n\tКонецЦикла;\r\n\tЗапрос.Текст = ТекстЗапросаНачало + Запрос.Текст + ТекстЗапросаКонец;\r\n\tВыборка = Запрос.Выполнить().Выбрать();\r\n\tПока Выборка.Следующий() Цикл\r\n\t\tЕсли мУжеВСписке[Выборка.Ссылка] = Неопределено Тогда\r\n\t\t\tСписокСвязанныхДокументов.Добавить(Выборка.Ссылка);\r\n\t\t\tмУжеВСписке.Вставить(Выборка.Ссылка, Истина);\r\n\t\t\tСписокСвязанныхДокументов = ПолучитьПодчиненныеДокументы(Выборка.Ссылка, СписокСвязанныхДокументов, мУжеВСписке);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tВозврат СписокСвязанныхДокументов;\r\nКонецФункции"
  },
  {
    "title": "Программное создание схемы СКД",
    "description": "Программное создание схемы СКД",
    "code_snippet": "Функция СоздатьСхемуКомпоновки() Экспорт\r\n\t\r\n\tСхемаСКД = Новый СхемаКомпоновкиДанных;\r\n\tИсточникДанных = СхемаСКД.ИсточникиДанных.Добавить();\r\n\tИсточникДанных.Имя                = \"ИсточникДанных\";\r\n\tИсточникДанных.ТипИсточникаДанных = \"local\";\r\n\t\r\n\tНаборДанных = СхемаСКД.НаборыДанных.Добавить(Тип(\"НаборДанныхОбъектСхемыКомпоновкиДанных\"));\r\n\tНаборДанных.Имя        = \"Данные\";\r\n\tНаборДанных.ИмяОбъекта = \"Данные\";\r\n\tНаборДанных.ИсточникДанных = \"ИсточникДанных\";\r\n\t\r\n\tНастройки   = СхемаСКД.НастройкиПоУмолчанию;\r\n\t\r\n\tГруппировка = Настройки.Структура.Добавить(Тип(\"ГруппировкаКомпоновкиДанных\"));\r\n\tГруппировка.Выбор.Элементы.Добавить(Тип(\"АвтоВыбранноеПолеКомпоновкиДанных\"));\r\n\t\r\n\tПараметр = СхемаСКД.Параметры.Добавить();\r\n\tПараметр.Имя         = \"Период\";\r\n\tПараметр.ТипЗначения = Новый ОписаниеТипов(\"СтандартныйПериод\");\r\n\t\r\n\tДля каждого СтрокаТЗ из Поля Цикл\r\n\t\t\r\n\t\tТипЗначения = ЗначениеИзСтрокиВнутр(СтрокаТЗ.ТипЗначения);\r\n\t\t\r\n\t\tЕсли СтрокаТЗ.Ресурс Тогда\r\n\t\t\t\r\n\t\t\tПоле = НаборДанных.Поля.Добавить(Тип(\"ПолеНабораДанныхСхемыКомпоновкиДанных\"));\r\n\t\t\tПоле.Поле        = СтрокаТЗ.Имя + \"Тек\";\r\n\t\t\tПоле.ТипЗначения = ТипЗначения;\r\n\t\t\tПоле.Заголовок   = Представление(СтрокаТЗ) + \" (тек)\";\r\n\t\t\tПоле.ПутьКДанным = СтрокаТЗ.Имя + \"Тек\";\r\n\t\t\t\r\n\t\t\tПоле = НаборДанных.Поля.Добавить(Тип(\"ПолеНабораДанныхСхемыКомпоновкиДанных\"));\r\n\t\t\tПоле.Поле        = СтрокаТЗ.Имя + \"Др\";\r\n\t\t\tПоле.ТипЗначения = ТипЗначения;\r\n\t\t\tПоле.Заголовок   = Представление(СтрокаТЗ) + \" (др)\";\r\n\t\t\tПоле.ПутьКДанным = СтрокаТЗ.Имя + \"Др\";\r\n\t\t\t\r\n\t\t\tВычисляемоеПоле = СхемаСКД.ВычисляемыеПоля.Добавить();\r\n\t\t\tВычисляемоеПоле.ПутьКДанным = \"Разница\" + СтрокаТЗ.Имя;\r\n\t\t\tВычисляемоеПоле.Выражение   = \"ЕстьNULL(\" + СтрокаТЗ.Имя + \"Тек, 0) - ЕстьNULL(\" + СтрокаТЗ.Имя + \"Др, 0)\";\r\n\t\t\tВычисляемоеПоле.ТипЗначения = ТипЗначения;\r\n\t\t\tВычисляемоеПоле.Заголовок   = \"Разница (\" + Представление(СтрокаТЗ) + \")\";\r\n\t\t\t\r\n\t\t\tПолеИтога = СхемаСКД.ПоляИтога.Добавить();\r\n\t\t\tПолеИтога.ПутьКДанным = СтрокаТЗ.Имя + \"Тек\";\r\n\t\t\tПолеИтога.Выражение   = \"Сумма(\" + СтрокаТЗ.Имя + \"Тек)\";\r\n\t\t\t\r\n\t\t\tПолеИтога = СхемаСКД.ПоляИтога.Добавить();\r\n\t\t\tПолеИтога.ПутьКДанным = СтрокаТЗ.Имя + \"Др\";\r\n\t\t\tПолеИтога.Выражение   = \"Сумма(\" + СтрокаТЗ.Имя + \"Др)\";\r\n\t\t\t\r\n\t\t\tПолеИтога = СхемаСКД.ПоляИтога.Добавить();\r\n\t\t\tПолеИтога.ПутьКДанным = \"Разница\" + СтрокаТЗ.Имя;\r\n\t\t\tПолеИтога.Выражение   = \"Сумма(Разница\" + СтрокаТЗ.Имя + \")\";\r\n\t\t\t\r\n\t\t\tГруппа = Настройки.Выбор.Элементы.Добавить(Тип(\"ГруппаВыбранныхПолейКомпоновкиДанных\"));\r\n\t\t\tГруппа.Расположение  = РасположениеПоляКомпоновкиДанных.Горизонтально;\r\n\t\t\tГруппа.Заголовок     = Представление(СтрокаТЗ);\r\n\t\t\tГруппа.Использование = Истина;\r\n\t\t\t\r\n\t\t\tВыбранноеПоле = Группа.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\t\tВыбранноеПоле.Поле          = Новый ПолеКомпоновкиДанных(СтрокаТЗ.Имя + \"Тек\");\r\n\t\t\tВыбранноеПоле.Заголовок     = \"Текущая\";\r\n\t\t\tВыбранноеПоле.Использование = Истина;\r\n\t\t\t\r\n\t\t\tВыбранноеПоле = Группа.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\t\tВыбранноеПоле.Поле          = Новый ПолеКомпоновкиДанных(СтрокаТЗ.Имя + \"Др\");\r\n\t\t\tВыбранноеПоле.Заголовок     = \"Другая\";\r\n\t\t\tВыбранноеПоле.Использование = Истина;\r\n\t\t\t\r\n\t\t\tЭлементОформления = Настройки.УсловноеОформление.Элементы.Добавить();\r\n\t\t\tЭлементОформления.Использование = Истина;\r\n\t\t\tУстановитьОформления(ЭлементОформления.Оформление);\r\n\t\t\t\r\n\t\t\tЭлементОтбора = ЭлементОформления.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n\t\t\tЭлементОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных(\"Разница\" + СтрокаТЗ.Имя);\r\n\t\t\tЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.НеРавно;\r\n\t\t\tЭлементОтбора.ПравоеЗначение = 0;\r\n\t\t\tЭлементОтбора.Использование  = Истина;\r\n\t\t\t\r\n\t\t\tПолеОформления = ЭлементОформления.Поля.Элементы.Добавить();\r\n\t\t\tПолеОформления.Использование = Истина;\r\n\t\t\tПолеОформления.Поле          = Новый ПолеКомпоновкиДанных(СтрокаТЗ.Имя + \"Тек\");\r\n\t\t\t\r\n\t\t\tПолеОформления = ЭлементОформления.Поля.Элементы.Добавить();\r\n\t\t\tПолеОформления.Использование = Истина;\r\n\t\t\tПолеОформления.Поле          = Новый ПолеКомпоновкиДанных(СтрокаТЗ.Имя + \"Др\");\r\n\t\t\t\r\n\t\tИначе\t\r\n\t\t\t\r\n\t\t\tПоле = НаборДанных.Поля.Добавить(Тип(\"ПолеНабораДанныхСхемыКомпоновкиДанных\"));\r\n\t\t\tПоле.Поле        = СтрокаТЗ.Имя;\r\n\t\t\tПоле.Заголовок   = Представление(СтрокаТЗ);\r\n\t\t\tПоле.ПутьКДанным = СтрокаТЗ.Имя;\r\n\t\t\tПоле.ТипЗначения = ТипЗначения;\r\n\t\t\t\r\n\t\t\tВыбранноеПоле = Настройки.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\t\tВыбранноеПоле.Поле          = Новый ПолеКомпоновкиДанных(СтрокаТЗ.Имя);\r\n\t\t\tВыбранноеПоле.Использование = Истина;\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\t\r\n\t\r\n\tВозврат СхемаСКД;\r\n\t\r\nКонецФункции\n\nФункция СоздатьСхемуКомпоновки() Экспорт\r\n\t\r\n\tСхемаСКД = Новый СхемаКомпоновкиДанных;\r\n\tИсточникДанных = СхемаСКД.ИсточникиДанных.Добавить();\r\n\tИсточникДанных.Имя                = \"ИсточникДанных\";\r\n\tИсточникДанных.ТипИсточникаДанных = \"local\";\r\n\t\r\n\tНаборДанных = СхемаСКД.НаборыДанных.Добавить(Тип(\"НаборДанныхОбъектСхемыКомпоновкиДанных\"));\r\n\tНаборДанных.Имя        = \"Данные\";\r\n\tНаборДанных.ИмяОбъекта = \"Данные\";\r\n\tНаборДанных.ИсточникДанных = \"ИсточникДанных\";\r\n\t\r\n\tНастройки   = СхемаСКД.НастройкиПоУмолчанию;\r\n\t\r\n\tГруппировка = Настройки.Структура.Добавить(Тип(\"ГруппировкаКомпоновкиДанных\"));\r\n\tГруппировка.Выбор.Элементы.Добавить(Тип(\"АвтоВыбранноеПолеКомпоновкиДанных\"));\r\n\t\r\n\tПараметр = СхемаСКД.Параметры.Добавить();\r\n\tПараметр.Имя         = \"Период\";\r\n\tПараметр.ТипЗначения = Новый ОписаниеТипов(\"СтандартныйПериод\");\r\n\t\r\n\tДля каждого СтрокаТЗ из Поля Цикл\r\n\t\t\r\n\t\tТипЗначения = ЗначениеИзСтрокиВнутр(СтрокаТЗ.ТипЗначения);\r\n\t\t\r\n\t\tЕсли СтрокаТЗ.Ресурс Тогда\r\n\t\t\t\r\n\t\t\tПоле = НаборДанных.Поля.Добавить(Тип(\"ПолеНабораДанныхСхемыКомпоновкиДанных\"));\r\n\t\t\tПоле.Поле        = СтрокаТЗ.Имя + \"Тек\";\r\n\t\t\tПоле.ТипЗначения = ТипЗначения;\r\n\t\t\tПоле.Заголовок   = Представление(СтрокаТЗ) + \" (тек)\";\r\n\t\t\tПоле.ПутьКДанным = СтрокаТЗ.Имя + \"Тек\";\r\n\t\t\t\r\n\t\t\tПоле = НаборДанных.Поля.Добавить(Тип(\"ПолеНабораДанныхСхемыКомпоновкиДанных\"));\r\n\t\t\tПоле.Поле        = СтрокаТЗ.Имя + \"Др\";\r\n\t\t\tПоле.ТипЗначения = ТипЗначения;\r\n\t\t\tПоле.Заголовок   = Представление(СтрокаТЗ) + \" (др)\";\r\n\t\t\tПоле.ПутьКДанным = СтрокаТЗ.Имя + \"Др\";\r\n\t\t\t\r\n\t\t\tВычисляемоеПоле = СхемаСКД.ВычисляемыеПоля.Добавить();\r\n\t\t\tВычисляемоеПоле.ПутьКДанным = \"Разница\" + СтрокаТЗ.Имя;\r\n\t\t\tВычисляемоеПоле.Выражение   = \"ЕстьNULL(\" + СтрокаТЗ.Имя + \"Тек, 0) - ЕстьNULL(\" + СтрокаТЗ.Имя + \"Др, 0)\";\r\n\t\t\tВычисляемоеПоле.ТипЗначения = ТипЗначения;\r\n\t\t\tВычисляемоеПоле.Заголовок   = \"Разница (\" + Представление(СтрокаТЗ) + \")\";\r\n\t\t\t\r\n\t\t\tПолеИтога = СхемаСКД.ПоляИтога.Добавить();\r\n\t\t\tПолеИтога.ПутьКДанным = СтрокаТЗ.Имя + \"Тек\";\r\n\t\t\tПолеИтога.Выражение   = \"Сумма(\" + СтрокаТЗ.Имя + \"Тек)\";\r\n\t\t\t\r\n\t\t\tПолеИтога = СхемаСКД.ПоляИтога.Добавить();\r\n\t\t\tПолеИтога.ПутьКДанным = СтрокаТЗ.Имя + \"Др\";\r\n\t\t\tПолеИтога.Выражение   = \"Сумма(\" + СтрокаТЗ.Имя + \"Др)\";\r\n\t\t\t\r\n\t\t\tПолеИтога = СхемаСКД.ПоляИтога.Добавить();\r\n\t\t\tПолеИтога.ПутьКДанным = \"Разница\" + СтрокаТЗ.Имя;\r\n\t\t\tПолеИтога.Выражение   = \"Сумма(Разница\" + СтрокаТЗ.Имя + \")\";\r\n\t\t\t\r\n\t\t\tГруппа = Настройки.Выбор.Элементы.Добавить(Тип(\"ГруппаВыбранныхПолейКомпоновкиДанных\"));\r\n\t\t\tГруппа.Расположение  = РасположениеПоляКомпоновкиДанных.Горизонтально;\r\n\t\t\tГруппа.Заголовок     = Представление(СтрокаТЗ);\r\n\t\t\tГруппа.Использование = Истина;\r\n\t\t\t\r\n\t\t\tВыбранноеПоле = Группа.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\t\tВыбранноеПоле.Поле          = Новый ПолеКомпоновкиДанных(СтрокаТЗ.Имя + \"Тек\");\r\n\t\t\tВыбранноеПоле.Заголовок     = \"Текущая\";\r\n\t\t\tВыбранноеПоле.Использование = Истина;\r\n\t\t\t\r\n\t\t\tВыбранноеПоле = Группа.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\t\tВыбранноеПоле.Поле          = Новый ПолеКомпоновкиДанных(СтрокаТЗ.Имя + \"Др\");\r\n\t\t\tВыбранноеПоле.Заголовок     = \"Другая\";\r\n\t\t\tВыбранноеПоле.Использование = Истина;\r\n\t\t\t\r\n\t\t\tЭлементОформления = Настройки.УсловноеОформление.Элементы.Добавить();\r\n\t\t\tЭлементОформления.Использование = Истина;\r\n\t\t\tУстановитьОформления(ЭлементОформления.Оформление);\r\n\t\t\t\r\n\t\t\tЭлементОтбора = ЭлементОформления.Отбор.Элементы.Добавить(Тип(\"ЭлементОтбораКомпоновкиДанных\"));\r\n\t\t\tЭлементОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных(\"Разница\" + СтрокаТЗ.Имя);\r\n\t\t\tЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.НеРавно;\r\n\t\t\tЭлементОтбора.ПравоеЗначение = 0;\r\n\t\t\tЭлементОтбора.Использование  = Истина;\r\n\t\t\t\r\n\t\t\tПолеОформления = ЭлементОформления.Поля.Элементы.Добавить();\r\n\t\t\tПолеОформления.Использование = Истина;\r\n\t\t\tПолеОформления.Поле          = Новый ПолеКомпоновкиДанных(СтрокаТЗ.Имя + \"Тек\");\r\n\t\t\t\r\n\t\t\tПолеОформления = ЭлементОформления.Поля.Элементы.Добавить();\r\n\t\t\tПолеОформления.Использование = Истина;\r\n\t\t\tПолеОформления.Поле          = Новый ПолеКомпоновкиДанных(СтрокаТЗ.Имя + \"Др\");\r\n\t\t\t\r\n\t\tИначе\t\r\n\t\t\t\r\n\t\t\tПоле = НаборДанных.Поля.Добавить(Тип(\"ПолеНабораДанныхСхемыКомпоновкиДанных\"));\r\n\t\t\tПоле.Поле        = СтрокаТЗ.Имя;\r\n\t\t\tПоле.Заголовок   = Представление(СтрокаТЗ);\r\n\t\t\tПоле.ПутьКДанным = СтрокаТЗ.Имя;\r\n\t\t\tПоле.ТипЗначения = ТипЗначения;\r\n\t\t\t\r\n\t\t\tВыбранноеПоле = Настройки.Выбор.Элементы.Добавить(Тип(\"ВыбранноеПолеКомпоновкиДанных\"));\r\n\t\t\tВыбранноеПоле.Поле          = Новый ПолеКомпоновкиДанных(СтрокаТЗ.Имя);\r\n\t\t\tВыбранноеПоле.Использование = Истина;\r\n\t\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\t\r\n\t\r\n\tВозврат СхемаСКД;\r\n\t\r\nКонецФункции"
  },
  {
    "title": "Проверка существание ссылки в базе",
    "description": "Проверка существание ссылки в базе",
    "code_snippet": "Функция СсылкаСуществует(ЛюбаяСсылка) Экспорт\r\n\t\r\n\tТекстЗапроса = \"\r\n\t|ВЫБРАТЬ\r\n\t|\tСсылка КАК Ссылка\r\n\t|ИЗ\r\n\t|\t[ИмяТаблицы]\r\n\t|ГДЕ\r\n\t|\tСсылка = &Ссылка\r\n\t|\";\r\n\t\r\n\tТекстЗапроса = СтрЗаменить(ТекстЗапроса, \"[ИмяТаблицы]\", ЛюбаяСсылка.Метаданные().ПолноеИмя());\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = ТекстЗапроса;\r\n\tЗапрос.УстановитьПараметр(\"Ссылка\", ЛюбаяСсылка);\r\n\t\r\n\tУстановитьПривилегированныйРежим(Истина);\r\n\t\r\n\tВозврат НЕ Запрос.Выполнить().Пустой();\r\n\t\r\nКонецФункции\n\nФункция СсылкаСуществует(ЛюбаяСсылка) Экспорт\r\n\t\r\n\tТекстЗапроса = \"\r\n\t|ВЫБРАТЬ\r\n\t|\tСсылка КАК Ссылка\r\n\t|ИЗ\r\n\t|\t[ИмяТаблицы]\r\n\t|ГДЕ\r\n\t|\tСсылка = &Ссылка\r\n\t|\";\r\n\t\r\n\tТекстЗапроса = СтрЗаменить(ТекстЗапроса, \"[ИмяТаблицы]\", ЛюбаяСсылка.Метаданные().ПолноеИмя());\r\n\t\r\n\tЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = ТекстЗапроса;\r\n\tЗапрос.УстановитьПараметр(\"Ссылка\", ЛюбаяСсылка);\r\n\t\r\n\tУстановитьПривилегированныйРежим(Истина);\r\n\t\r\n\tВозврат НЕ Запрос.Выполнить().Пустой();\r\n\t\r\nКонецФункции\n\nОрфографическая ошибка в существание: существание"
  },
  {
    "title": "Изменение событий в отборе СКД",
    "description": "Изменение событий в отборе СКД",
    "code_snippet": "ЭлементыФормы.Отбор.Колонки.ПравоеЗначениеДляКраткогоОтображенияЭлемента.ЭлементУправления.УстановитьДействие(\"НачалоВыбора\", Новый Действие(\"ОтборНачалоВыбора\"));\r\n\r\nПроцедура ОтборНачалоВыбора(Элемент, СтандартнаяОбработка)\r\n\t\r\n\tТекущиеДанные = ЭлементыФормы.Отбор.ТекущиеДанные;\r\n\tЕсли Строка(ТекущиеДанные.ЛевоеЗначение) = \"Родитель\" Тогда\r\n\t\t\r\n\t\tСтандартнаяОбработка = Ложь;\r\n\t\tФорма = Справочники.Номенклатура.ПолучитьФормуВыбораГруппы(, Элемент);\r\n\t\tФорма.Открыть();\r\n\t\t\r\n\tКонецЕсли;\t\r\n\t\r\nКонецПроцедуры\n\nЭлементыФормы.Отбор.Колонки.ПравоеЗначениеДляКраткогоОтображенияЭлемента.ЭлементУправления.УстановитьДействие(\"НачалоВыбора\", Новый Действие(\"ОтборНачалоВыбора\"));\r\n\r\nПроцедура ОтборНачалоВыбора(Элемент, СтандартнаяОбработка)\r\n\t\r\n\tТекущиеДанные = ЭлементыФормы.Отбор.ТекущиеДанные;\r\n\tЕсли Строка(ТекущиеДанные.ЛевоеЗначение) = \"Родитель\" Тогда\r\n\t\t\r\n\t\tСтандартнаяОбработка = Ложь;\r\n\t\tФорма = Справочники.Номенклатура.ПолучитьФормуВыбораГруппы(, Элемент);\r\n\t\tФорма.Открыть();\r\n\t\t\r\n\tКонецЕсли;\t\r\n\t\r\nКонецПроцедуры\n\n{1} Ожидается идентификатор"
  },
  {
    "title": "Запрос через COM из .NET",
    "description": "Запрос через COM из .NET",
    "code_snippet": "class Program\r\n    {\r\n        static void Main(string[] args)\r\n        {\r\n            var v8comConnector = Type.GetTypeFromProgID(\"V83.ComConnector\");\r\n            var v8 = Activator.CreateInstance(v8comConnector);\r\n            Object[] arguments = { @\"File=\"\"C:\\Users\\user\\Documents\\InfoBase2\\\"\";\" };\r\n            var x = v8comConnector.InvokeMember(\"Connect\", BindingFlags.Public | BindingFlags.InvokeMethod | BindingFlags.Static, null, v8, arguments);\r\n            var query = InvokeObjectMethod(v8, x, \"NewObject\", new Object[] { \"Запрос\" });\r\n            SetObjectProperty(v8, query, \"Текст\", new Object[] { \"ВЫБРАТЬ Справочник1.Наименование ИЗ Справочник.Справочник1 КАК Справочник1\" });\r\n            var result = InvokeObjectMethod(v8, query, \"Выполнить\", new Object[] { });\r\n            var selection = InvokeObjectMethod(v8, result, \"Выбрать\", new Object[] { });\r\n            while ((bool)InvokeObjectMethod(v8, selection, \"Следующий\", new Object[] { }))\r\n            {\r\n                var name = GetObjectProperty(v8, selection, \"Наименование\");\r\n                Console.WriteLine(\"Наименование: \" + name);\r\n            }\r\n        }\r\n\r\n        public static object GetObjectProperty(object v8, object refObject, string propertyName)\r\n        {\r\n            return v8.GetType().InvokeMember(propertyName, BindingFlags.GetProperty, null, refObject, null);\r\n        }\r\n\r\n        public static object SetObjectProperty(object v8, object refObject, string propertyName, Object[] value)\r\n        {\r\n            return v8.GetType().InvokeMember(propertyName, BindingFlags.SetProperty, null, refObject, value);\r\n        }\r\n\r\n        public static object InvokeObjectMethod(object v8, object refObject, string methodName, Object[] parameters)\r\n        {\r\n            return v8.GetType().InvokeMember(methodName, BindingFlags.Public | BindingFlags.InvokeMethod | BindingFlags.Static, null, refObject, parameters);\r\n        }\r\n    }\n\nclass Program\r\n    {\r\n        static void Main(string[] args)\r\n        {\r\n            var v8comConnector = Type.GetTypeFromProgID(\"V83.ComConnector\");\r\n            var v8 = Activator.CreateInstance(v8comConnector);\r\n            Object[] arguments = { @\"File=\"\"C:\\Users\\user\\Documents\\InfoBase2\\\"\";\" };\r\n            var x = v8comConnector.InvokeMember(\"Connect\", BindingFlags.Public | BindingFlags.InvokeMethod | BindingFlags.Static, null, v8, arguments);\r\n            var query = InvokeObjectMethod(v8, x, \"NewObject\", new Object[] { \"Запрос\" });\r\n            SetObjectProperty(v8, query, \"Текст\", new Object[] { \"ВЫБРАТЬ Справочник1.Наименование ИЗ Справочник.Справочник1 КАК Справочник1\" });\r\n            var result = InvokeObjectMethod(v8, query, \"Выполнить\", new Object[] { });\r\n            var selection = InvokeObjectMethod(v8, result, \"Выбрать\", new Object[] { });\r\n            while ((bool)InvokeObjectMethod(v8, selection, \"Следующий\", new Object[] { }))\r\n            {\r\n                var name = GetObjectProperty(v8, selection, \"Наименование\");\r\n                Console.WriteLine(\"Наименование: \" + name);\r\n            }\r\n        }\r\n\r\n        public static object GetObjectProperty(object v8, object refObject, string propertyName)\r\n        {\r\n            return v8.GetType().InvokeMember(propertyName, BindingFlags.GetProperty, null, refObject, null);\r\n        }\r\n\r\n        public static object SetObjectProperty(object v8, object refObject, string propertyName, Object[] value)\r\n        {\r\n            return v8.GetType().InvokeMember(propertyName, BindingFlags.SetProperty, null, refObject, value);\r\n        }\r\n\r\n        public static object InvokeObjectMethod(object v8, object refObject, string methodName, Object[] parameters)\r\n        {\r\n            return v8.GetType().InvokeMember(methodName, BindingFlags.Public | BindingFlags.InvokeMethod | BindingFlags.Static, null, refObject, parameters);\r\n        }\r\n    }\n\nДлина не может быть меньше нуля.\r\nИмя параметра: length\r\nОрфографическая ошибка в args: args\r\nОрфографическая ошибка в bool: bool"
  },
  {
    "title": "Блокировка",
    "description": "Блокировка",
    "code_snippet": "БлокировкаДанных = Новый БлокировкаДанных;\r\nЭлементБлокировки = БлокировкаДанных.Добавить(\"РегистрНакопления.Стоимость\");\r\nЭлементБлокировки.ИсточникДанных = РезультатЗапроса;\r\nЭлементБлокировки.ИспользоватьИзИсточникаДанных(\"Номенклатура\",\"Номенклатура\");\r\nЭлементБлокировки.Режим = РежимБлокировкиДанных.Исключительный;\r\nБлокировкаДанных.Заблокировать();\n\nБлокировкаДанных = Новый БлокировкаДанных;\r\nЭлементБлокировки = БлокировкаДанных.Добавить(\"РегистрНакопления.Стоимость\");\r\nЭлементБлокировки.ИсточникДанных = РезультатЗапроса;\r\nЭлементБлокировки.ИспользоватьИзИсточникаДанных(\"Номенклатура\",\"Номенклатура\");\r\nЭлементБлокировки.Режим = РежимБлокировкиДанных.Исключительный;\r\nБлокировкаДанных.Заблокировать();\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "глТекущийПользователь",
    "description": "глТекущийПользователь",
    "code_snippet": "Организация = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной(\"глТекущийПользователь\"), \"ОсновнаяОрганизация\");\r\nПодразделениеОрганизации = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной(\"глТекущийПользователь\"), \"ОсновноеПодразделениеОрганизации\");\r\nЦФО = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной(\"глТекущийПользователь\"), \"ОсновноеПодразделение\");\n\nОрганизация = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной(\"глТекущийПользователь\"), \"ОсновнаяОрганизация\");\r\nПодразделениеОрганизации = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной(\"глТекущийПользователь\"), \"ОсновноеПодразделениеОрганизации\");\r\nЦФО = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной(\"глТекущийПользователь\"), \"ОсновноеПодразделение\");\n\n{1} Переменной Организация присвоено значение, но оно нигде не используется\r\n{2} Переменной ПодразделениеОрганизации присвоено значение, но оно нигде не используется\r\n{3} Переменной ЦФО присвоено значение, но оно нигде не используется\r\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное.\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Проверка запроса на пустоту",
    "description": "Проверка запроса на пустоту",
    "code_snippet": "Запрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tЕдиницыИзмерения.Коэффициент\r\n\t\t|ИЗ\r\n\t\t|\tСправочник.ЕдиницыИзмерения КАК ЕдиницыИзмерения\r\n\t\t|ГДЕ\r\n\t\t|\tЕдиницыИзмерения.Ссылка = &Ссылка\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"Ссылка\", ЕдИзм);\r\n\t\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tЕсли РезультатЗапроса.Пустой() Тогда\r\n\t\tВозврат 0;\r\n\tКонецЕсли;\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать(); ВыборкаДетальныеЗаписи.Следующий();\r\n\tВозврат ВыборкаДетальныеЗаписи.Коэффициент;\n\nЗапрос = Новый Запрос;\r\n\tЗапрос.Текст = \r\n\t\t\"ВЫБРАТЬ\r\n\t\t|\tЕдиницыИзмерения.Коэффициент\r\n\t\t|ИЗ\r\n\t\t|\tСправочник.ЕдиницыИзмерения КАК ЕдиницыИзмерения\r\n\t\t|ГДЕ\r\n\t\t|\tЕдиницыИзмерения.Ссылка = &Ссылка\";\r\n\t\r\n\tЗапрос.УстановитьПараметр(\"Ссылка\", ЕдИзм);\r\n\t\t\r\n\tРезультатЗапроса = Запрос.Выполнить();\r\n\t\r\n\tЕсли РезультатЗапроса.Пустой() Тогда\r\n\t\tВозврат 0;\r\n\tКонецЕсли;\r\n\tВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать(); ВыборкаДетальныеЗаписи.Следующий();\r\n\tВозврат ВыборкаДетальныеЗаписи.Коэффициент;\n\nОрфографическая ошибка в пустату: пустату"
  },
  {
    "title": "Чтение файла XML в объект XDTO по схеме *.xsd",
    "description": "Чтение файла XML в объект XDTO по схеме *.xsd",
    "code_snippet": "ЧтениеXML = Новый ЧтениеXML();\r\nЧтениеXML.ОткрытьФайл(ИмяФайла);\r\n\r\nФабрика = СоздатьФабрикуXDTO(ИмяФайлаСхемы); //*.xsd\r\nОбъектXDTO = Фабрика.ПрочитатьXML(ЧтениеXML);\r\n\r\nЧтениеXML.Закрыть();\n\nЧтениеXML = Новый ЧтениеXML();\r\nЧтениеXML.ОткрытьФайл(ИмяФайла);\r\n\r\nФабрика = СоздатьФабрикуXDTO(ИмяФайлаСхемы); //*.xsd\r\nОбъектXDTO = Фабрика.ПрочитатьXML(ЧтениеXML);\r\n\r\nЧтениеXML.Закрыть();\n\n{5} Переменной ОбъектXDTO присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Диалог выбора файла",
    "description": "Диалог выбора файла",
    "code_snippet": "Режим = РежимДиалогаВыбораФайла.Открытие; \r\n    ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(Режим); \r\n    ДиалогОткрытияФайла.ПолноеИмяФайла = \"\"; \r\n    Фильтр = \"Текст(*.txt)|*.txt\"; \r\n    ДиалогОткрытияФайла.Фильтр = Фильтр; \r\n    ДиалогОткрытияФайла.МножественныйВыбор = Ложь; \r\n    ДиалогОткрытияФайла.Заголовок = \"Выберите файл\"; \r\n\r\n    Если ДиалогОткрытияФайла.Выбрать() Тогда \r\n        ПутьКФайлу = ДиалогОткрытияФайла.ПолноеИмяФайла; \r\n    КонецЕсли;\n\nРежим = РежимДиалогаВыбораФайла.Открытие; \r\n    ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(Режим); \r\n    ДиалогОткрытияФайла.ПолноеИмяФайла = \"\"; \r\n    Фильтр = \"Текст(*.txt)|*.txt\"; \r\n    ДиалогОткрытияФайла.Фильтр = Фильтр; \r\n    ДиалогОткрытияФайла.МножественныйВыбор = Ложь; \r\n    ДиалогОткрытияФайла.Заголовок = \"Выберите файл\"; \r\n\r\n    Если ДиалогОткрытияФайла.Выбрать() Тогда \r\n        ПутьКФайлу = ДиалогОткрытияФайла.ПолноеИмяФайла; \r\n    КонецЕсли;\n\n{10} Переменной ПутьКФайлу присвоено значение, но оно нигде не используется"
  },
  {
    "title": "Перенести отбор СКД",
    "description": "Перенести отбор СКД",
    "code_snippet": "Процедура ПеренестиОтбор(ОтборПриемник, ОтборИсточник)\r\n\t\r\n\tДля каждого ЭлементИсточник Из ОтборИсточник.Элементы Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(ЭлементИсточник) = Тип(\"ЭлементОтбораКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tЕсли ТипЗнч(ЭлементИсточник.ЛевоеЗначение) = Тип(\"ПолеКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\t\tЕсли ОтборПриемник.ДоступныеПоляОтбора.НайтиПоле(ЭлементИсточник.ЛевоеЗначение) = Неопределено Тогда\r\n\t\t\t\t\tПродолжить;\r\n\t\t\t\tКонецЕсли;\t\r\n\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\t\tЭлементПриемник = ОтборПриемник.Элементы.Добавить(ТипЗнч(ЭлементИсточник));\r\n\t\tЗаполнитьЗначенияСвойств(ЭлементПриемник, ЭлементИсточник);\r\n\t\t\r\n\t\tЕсли ТипЗнч(ЭлементИсточник) = Тип(\"ГруппаЭлементовОтбораКомпоновкиДанных\") Тогда\r\n\t\t\tПеренестиОтбор(ЭлементПриемник, ЭлементИсточник);\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\t\r\n\t\r\nКонецПроцедуры\n\nПроцедура ПеренестиОтбор(ОтборПриемник, ОтборИсточник)\r\n\t\r\n\tДля каждого ЭлементИсточник Из ОтборИсточник.Элементы Цикл\r\n\t\t\r\n\t\tЕсли ТипЗнч(ЭлементИсточник) = Тип(\"ЭлементОтбораКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\tЕсли ТипЗнч(ЭлементИсточник.ЛевоеЗначение) = Тип(\"ПолеКомпоновкиДанных\") Тогда\r\n\t\t\t\r\n\t\t\t\tЕсли ОтборПриемник.ДоступныеПоляОтбора.НайтиПоле(ЭлементИсточник.ЛевоеЗначение) = Неопределено Тогда\r\n\t\t\t\t\tПродолжить;\r\n\t\t\t\tКонецЕсли;\t\r\n\t\t\t\r\n\t\t\tКонецЕсли;\r\n\t\t\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\t\tЭлементПриемник = ОтборПриемник.Элементы.Добавить(ТипЗнч(ЭлементИсточник));\r\n\t\tЗаполнитьЗначенияСвойств(ЭлементПриемник, ЭлементИсточник);\r\n\t\t\r\n\t\tЕсли ТипЗнч(ЭлементИсточник) = Тип(\"ГруппаЭлементовОтбораКомпоновкиДанных\") Тогда\r\n\t\t\tПеренестиОтбор(ЭлементПриемник, ЭлементИсточник);\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\t\r\n\t\r\nКонецПроцедуры\n\nПроцедура ПеренестиОтбор(ОтборПриемник, ОтборИсточник, ДоступныеПоляОтбораПриемника)\n    \n    Для каждого ЭлементИсточник Из ОтборИсточник.Элементы Цикл\n        \n        Если ТипЗнч(ЭлементИсточник) = Тип(\"ЭлементОтбораКомпоновкиДанных\") Тогда\n            \n            Если ТипЗнч(ЭлементИсточник.ЛевоеЗначение) = Тип(\"ПолеКомпоновкиДанных\") Тогда\n            \n                Если ДоступныеПоляОтбораПриемника.НайтиПоле(ЭлементИсточник.ЛевоеЗначение) = Неопределено Тогда\n                    Продолжить;\n                КонецЕсли;    \n            \n            КонецЕсли;\n        \n        КонецЕсли;    \n        \n        ЭлементПриемник = ОтборПриемник.Элементы.Добавить(ТипЗнч(ЭлементИсточник));\n        ЗаполнитьЗначенияСвойств(ЭлементПриемник, ЭлементИсточник);\n        \n        Если ТипЗнч(ЭлементИсточник) = Тип(\"ГруппаЭлементовОтбораКомпоновкиДанных\") Тогда\n            ПеренестиОтбор(ЭлементПриемник, ЭлементИсточник, ДоступныеПоляОтбораПриемника);\n        КонецЕсли;    \n        \n    КонецЦикла;    \n    \nКонецПроцедуры"
  },
  {
    "title": "Дата создания ссылки",
    "description": "Дата создания ссылки",
    "code_snippet": "Функция ДатаСозданияСсылки(Ссылка) Экспорт\r\n\t\r\n\tЕсли НЕ ЗначениеЗаполнено(Ссылка) Тогда\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\t\r\n\t\t\r\n\tМомент = Дата(1, 1, 1);\r\n\tПопытка\r\n\t\t\r\n        УИ = Строка(Ссылка.УникальныйИдентификатор());\r\n        УИ = ВРег(СтрЗаменить(УИ,\"-\",\"\"));\r\n\t\t\r\n\t\tЕсли Сред(УИ, 13, 1) = \"1\" Тогда\r\n\t\t\t\r\n            Значение16 = ВРег(Сред(УИ, 14, 3) + Сред(УИ, 9, 4) + Сред(УИ, 1, 8));\r\n            Цифры16    = \"123456789ABCDEF\";\r\n            Значение10 = 0;\r\n            Длина16    = СтрДлина(Значение16);\r\n\t\t\t\r\n\t\t\tДля Ном = 1 По Длина16 Цикл\r\n                Значение10 = Значение10 + Pow(16, Длина16-Ном)*Найти(Цифры16, Сред(Значение16, Ном, 1));\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n            Значение10 = Значение10/10000000;\r\n            Момент     = Дата(1582, 10, 15, 3, 0, 0) + Значение10;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n    Исключение\r\n    КонецПопытки;\r\n\t\r\n\tВозврат Момент;\r\n\t\t\r\nКонецФункции\n\nФункция ДатаСозданияСсылки(Ссылка) Экспорт\r\n\t\r\n\tЕсли НЕ ЗначениеЗаполнено(Ссылка) Тогда\r\n\t\tВозврат Неопределено;\r\n\tКонецЕсли;\t\r\n\t\t\r\n\tМомент = Дата(1, 1, 1);\r\n\tПопытка\r\n\t\t\r\n        УИ = Строка(Ссылка.УникальныйИдентификатор());\r\n        УИ = ВРег(СтрЗаменить(УИ,\"-\",\"\"));\r\n\t\t\r\n\t\tЕсли Сред(УИ, 13, 1) = \"1\" Тогда\r\n\t\t\t\r\n            Значение16 = ВРег(Сред(УИ, 14, 3) + Сред(УИ, 9, 4) + Сред(УИ, 1, 8));\r\n            Цифры16    = \"123456789ABCDEF\";\r\n            Значение10 = 0;\r\n            Длина16    = СтрДлина(Значение16);\r\n\t\t\t\r\n\t\t\tДля Ном = 1 По Длина16 Цикл\r\n                Значение10 = Значение10 + Pow(16, Длина16-Ном)*Найти(Цифры16, Сред(Значение16, Ном, 1));\r\n\t\t\tКонецЦикла;\r\n\t\t\t\r\n            Значение10 = Значение10/10000000;\r\n            Момент     = Дата(1582, 10, 15, 3, 0, 0) + Значение10;\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n    Исключение\r\n    КонецПопытки;\r\n\t\r\n\tВозврат Момент;\r\n\t\t\r\nКонецФункции"
  },
  {
    "title": "Кнопки управления группировками",
    "description": "Кнопки управления группировками",
    "code_snippet": "Процедура СгенерироватьКнопкиУправленияГруппировкой(ЭлементТабПоле, Панель)\r\n\r\n//\tЭлементТабПоле = ЭлементыФормы.ТабДопИнформация;\r\n\t\r\n    НачалоВерх = ЭлементТабПоле.Верх + 3; // Привязка к верхнему левому углу ПоляТабличногоДокумента\r\n    НачалоЛево = ЭлементТабПоле.Лево + 3; // Привязка к верхнему левому углу ПоляТабличногоДокумента\r\n\r\n\tИмя = ЭлементТабПоле.Имя;\r\n\t\r\n    ШагКнопок      \t\t= 13;\r\n    ПрефиксИмениКн \t\t= \"КнГрГор_\" + Имя + \"_\";\r\n\tПрефиксИмениКнВерт \t= \"КнГрВерт_\" + Имя + \"_\";\r\n\r\n    // Удалить старые кнопки\r\n    Сч = 0;\r\n    Пока Сч < ЭлементыФормы.Количество() Цикл\r\n        ТекЭлемент = ЭлементыФормы.Получить(Сч);\r\n\t\tЕсли (Найти(ТекЭлемент.Имя, ПрефиксИмениКн) > 0) ИЛИ\r\n\t\t\t (Найти(ТекЭлемент.Имя, ПрефиксИмениКнВерт) > 0) Тогда\r\n            ЭлементыФормы.Удалить(ТекЭлемент);\r\n        Иначе\r\n            Сч = Сч + 1;\r\n        КонецЕсли;\r\n    КонецЦикла;\r\n\r\n    // Добавть новые кнопки по количеству группировок\r\n    КоличествоГруппировок = ЭлементТабПоле.КоличествоУровнейГруппировокСтрок();\r\n    Для Сч = 1 По КоличествоГруппировок Цикл\r\n        НоваяКнопка = ЭлементыФормы.Добавить(Тип(\"Кнопка\"), ПрефиксИмениКн + Сч, , Панель);\r\n        НоваяКнопка.Верх      = НачалоВерх;\r\n        НоваяКнопка.Лево      = НачалоЛево + (ШагКнопок * (Сч - 1));\r\n        НоваяКнопка.Высота    = 11;\r\n        НоваяКнопка.Ширина    = 11;\r\n        НоваяКнопка.Шрифт     = Новый Шрифт(\"Шрифт диалогов и меню\", 6);\r\n        НоваяКнопка.Заголовок = \"\" + Сч;\r\n        НоваяКнопка.УстановитьДействие(\"Нажатие\", Новый Действие(\"СвернутьДоУровня\"));\r\n\tКонецЦикла;\r\n\t\r\n\tНачалоЛево = НачалоЛево + Сч * ШагКнопок + 3;\r\n\t// Добавть новые кнопки по количеству группировок\r\n    КоличествоГруппировок = ЭлементТабПоле.КоличествоУровнейГруппировокКолонок();\r\n    Для Сч = 1 По КоличествоГруппировок Цикл\r\n        НоваяКнопка = ЭлементыФормы.Добавить(Тип(\"Кнопка\"), ПрефиксИмениКнВерт + Сч, , Панель);\r\n        НоваяКнопка.Верх      = НачалоВерх + (ШагКнопок * (Сч - 1));\r\n        НоваяКнопка.Лево      = НачалоЛево;\r\n        НоваяКнопка.Высота    = 11;\r\n        НоваяКнопка.Ширина    = 11;\r\n        НоваяКнопка.Шрифт     = Новый Шрифт(\"Шрифт диалогов и меню\", 6);\r\n        НоваяКнопка.Заголовок = \"\" + Сч;\r\n        НоваяКнопка.УстановитьДействие(\"Нажатие\", Новый Действие(\"СвернутьДоУровняКолонки\"));\r\n    КонецЦикла;\r\n\r\nКонецПроцедуры //СгенерироватьКнопкиУправленияГруппировкой()\r\n\r\nПроцедура СвернутьДоУровня(Элемент)\r\n\r\n    Уровень = Число(Элемент.Заголовок); // здесь записан нужный уровень\r\n\t\r\n\tИмя = СтрЗаменить(Элемент.Имя, \"_\", Символы.ПС);\r\n\tИмя = СтрПолучитьСтроку(Имя, 2);\r\n\t\r\n    ЭлементыФормы[Имя].ПоказатьУровеньГруппировокСтрок(Уровень - 1);\r\n\r\nКонецПроцедуры //СвернутьДоУровня()\r\n\r\nПроцедура СвернутьДоУровняКолонки(Элемент)\r\n\r\n    Уровень = Число(Элемент.Заголовок); // здесь записан нужный уровень\r\n\t\r\n\tИмя = СтрЗаменить(Элемент.Имя, \"_\", Символы.ПС);\r\n\tИмя = СтрПолучитьСтроку(Имя, 2);\r\n\t\r\n    ЭлементыФормы[Имя].ПоказатьУровеньГруппировокКолонок(Уровень - 1);\r\n\r\nКонецПроцедуры //СвернутьДоУровня()\n\nПроцедура СгенерироватьКнопкиУправленияГруппировкой(ЭлементТабПоле, Панель)\r\n\r\n//\tЭлементТабПоле = ЭлементыФормы.ТабДопИнформация;\r\n\t\r\n    НачалоВерх = ЭлементТабПоле.Верх + 3; // Привязка к верхнему левому углу ПоляТабличногоДокумента\r\n    НачалоЛево = ЭлементТабПоле.Лево + 3; // Привязка к верхнему левому углу ПоляТабличногоДокумента\r\n\r\n\tИмя = ЭлементТабПоле.Имя;\r\n\t\r\n    ШагКнопок      \t\t= 13;\r\n    ПрефиксИмениКн \t\t= \"КнГрГор_\" + Имя + \"_\";\r\n\tПрефиксИмениКнВерт \t= \"КнГрВерт_\" + Имя + \"_\";\r\n\r\n    // Удалить старые кнопки\r\n    Сч = 0;\r\n    Пока Сч < ЭлементыФормы.Количество() Цикл\r\n        ТекЭлемент = ЭлементыФормы.Получить(Сч);\r\n\t\tЕсли (Найти(ТекЭлемент.Имя, ПрефиксИмениКн) > 0) ИЛИ\r\n\t\t\t (Найти(ТекЭлемент.Имя, ПрефиксИмениКнВерт) > 0) Тогда\r\n            ЭлементыФормы.Удалить(ТекЭлемент);\r\n        Иначе\r\n            Сч = Сч + 1;\r\n        КонецЕсли;\r\n    КонецЦикла;\r\n\r\n    // Добавть новые кнопки по количеству группировок\r\n    КоличествоГруппировок = ЭлементТабПоле.КоличествоУровнейГруппировокСтрок();\r\n    Для Сч = 1 По КоличествоГруппировок Цикл\r\n        НоваяКнопка = ЭлементыФормы.Добавить(Тип(\"Кнопка\"), ПрефиксИмениКн + Сч, , Панель);\r\n        НоваяКнопка.Верх      = НачалоВерх;\r\n        НоваяКнопка.Лево      = НачалоЛево + (ШагКнопок * (Сч - 1));\r\n        НоваяКнопка.Высота    = 11;\r\n        НоваяКнопка.Ширина    = 11;\r\n        НоваяКнопка.Шрифт     = Новый Шрифт(\"Шрифт диалогов и меню\", 6);\r\n        НоваяКнопка.Заголовок = \"\" + Сч;\r\n        НоваяКнопка.УстановитьДействие(\"Нажатие\", Новый Действие(\"СвернутьДоУровня\"));\r\n\tКонецЦикла;\r\n\t\r\n\tНачалоЛево = НачалоЛево + Сч * ШагКнопок + 3;\r\n\t// Добавть новые кнопки по количеству группировок\r\n    КоличествоГруппировок = ЭлементТабПоле.КоличествоУровнейГруппировокКолонок();\r\n    Для Сч = 1 По КоличествоГруппировок Цикл\r\n        НоваяКнопка = ЭлементыФормы.Добавить(Тип(\"Кнопка\"), ПрефиксИмениКнВерт + Сч, , Панель);\r\n        НоваяКнопка.Верх      = НачалоВерх + (ШагКнопок * (Сч - 1));\r\n        НоваяКнопка.Лево      = НачалоЛево;\r\n        НоваяКнопка.Высота    = 11;\r\n        НоваяКнопка.Ширина    = 11;\r\n        НоваяКнопка.Шрифт     = Новый Шрифт(\"Шрифт диалогов и меню\", 6);\r\n        НоваяКнопка.Заголовок = \"\" + Сч;\r\n        НоваяКнопка.УстановитьДействие(\"Нажатие\", Новый Действие(\"СвернутьДоУровняКолонки\"));\r\n    КонецЦикла;\r\n\r\nКонецПроцедуры //СгенерироватьКнопкиУправленияГруппировкой()\r\n\r\nПроцедура СвернутьДоУровня(Элемент)\r\n\r\n    Уровень = Число(Элемент.Заголовок); // здесь записан нужный уровень\r\n\t\r\n\tИмя = СтрЗаменить(Элемент.Имя, \"_\", Символы.ПС);\r\n\tИмя = СтрПолучитьСтроку(Имя, 2);\r\n\t\r\n    ЭлементыФормы[Имя].ПоказатьУровеньГруппировокСтрок(Уровень - 1);\r\n\r\nКонецПроцедуры //СвернутьДоУровня()\r\n\r\nПроцедура СвернутьДоУровняКолонки(Элемент)\r\n\r\n    Уровень = Число(Элемент.Заголовок); // здесь записан нужный уровень\r\n\t\r\n\tИмя = СтрЗаменить(Элемент.Имя, \"_\", Символы.ПС);\r\n\tИмя = СтрПолучитьСтроку(Имя, 2);\r\n\t\r\n    ЭлементыФормы[Имя].ПоказатьУровеньГруппировокКолонок(Уровень - 1);\r\n\r\nКонецПроцедуры //СвернутьДоУровня()\n\nОрфографическая ошибка в Добавть (найдено 2): Добавть"
  },
  {
    "title": "Очистка регистра сведений",
    "description": "Очистка регистра сведений",
    "code_snippet": "НаборЗаписей = РегистрыСведений.НазваниеМоегоРегистра.СоздатьНаборЗаписей(); \r\n//если нужно, например, очистить по одному конкретному измерению, то раскоментируем строчку,\r\n//меняем измерение:\r\n//НаборЗаписей.Отбор.Организация.Установить(УдаляемаяОрганизация); \r\nНаборЗаписей.Записать();\n\nНаборЗаписей = РегистрыСведений.НазваниеМоегоРегистра.СоздатьНаборЗаписей(); \r\n//если нужно, например, очистить по одному конкретному измерению, то раскоментируем строчку,\r\n//меняем измерение:\r\n//НаборЗаписей.Отбор.Организация.Установить(УдаляемаяОрганизация); \r\nНаборЗаписей.Записать();\n\nОрфографическая ошибка в раскоментируем: раскоментируем"
  },
  {
    "title": "Отправка Интернет Почты",
    "description": "Отправка Интернет Почты",
    "code_snippet": "//Прежде всего нам понадобится smtp-сервер для отправки писем. Параметры сервера записываем в переменную с типом  ИнтернетПочтовыйПрофиль.\r\n\r\nПараметрыПочты = новый ИнтернетПочтовыйПрофиль;\r\nПараметрыПочты.АдресСервераSMTP = \"smtp.server.com\";\r\nПараметрыПочты.АутентификацияSMTP = СпособSMTPАутентификации.ПоУмолчанию;\r\nПараметрыПочты.ПользовательSMTP = \"user\";\r\nПараметрыПочты.ПарольSMTP=\"pass\";\r\n\r\n//После этого создаем само письмо. Необходимо задать имена и адреса отправителя и получателя, тему письма, текст. Можно добавить вложения.\r\n\r\nПисьмо=новый ИнтернетПочтовоеСообщение;\r\nПисьмо.Тема=\"Уведомление о задолженности\";\r\nПисьмо.ИмяОтправителя=\"ООО Рога и копыта\";\r\nПисьмо.Отправитель=\"bill@roga.ru\";\r\nПисьмо.Получатели.Добавить(\"director@firma.ru\");\r\nПисьмо.Тексты.Добавить(\"Текст письма\");\r\nПисьмо.Вложения.Добавить(\"адрес файла вложения на жестком диске\");\r\n\r\n//И в конце концов отправляем сформированное письмо.\r\n\r\nПодключение=новый ИнтернетПочта;\r\nПопытка\r\nПодключение.Подключиться(ПараметрыПочты);\r\nПодключение.Послать(Письмо);\r\nСообщить (\"Письмо отправлено успешно.\");\r\nИсключение\r\nСообщить (\"Письмо не отправлено.\" + ОписаниеОшибки());\r\nКонецПопытки;\n\n//Прежде всего нам понадобится smtp-сервер для отправки писем. Параметры сервера записываем в переменную с типом  ИнтернетПочтовыйПрофиль.\r\n\r\nПараметрыПочты = новый ИнтернетПочтовыйПрофиль;\r\nПараметрыПочты.АдресСервераSMTP = \"smtp.server.com\";\r\nПараметрыПочты.АутентификацияSMTP = СпособSMTPАутентификации.ПоУмолчанию;\r\nПараметрыПочты.ПользовательSMTP = \"user\";\r\nПараметрыПочты.ПарольSMTP=\"pass\";\r\n\r\n//После этого создаем само письмо. Необходимо задать имена и адреса отправителя и получателя, тему письма, текст. Можно добавить вложения.\r\n\r\nПисьмо=новый ИнтернетПочтовоеСообщение;\r\nПисьмо.Тема=\"Уведомление о задолженности\";\r\nПисьмо.ИмяОтправителя=\"ООО Рога и копыта\";\r\nПисьмо.Отправитель=\"bill@roga.ru\";\r\nПисьмо.Получатели.Добавить(\"director@firma.ru\");\r\nПисьмо.Тексты.Добавить(\"Текст письма\");\r\nПисьмо.Вложения.Добавить(\"адрес файла вложения на жестком диске\");\r\n\r\n//И в конце концов отправляем сформированное письмо.\r\n\r\nПодключение=новый ИнтернетПочта;\r\nПопытка\r\nПодключение.Подключиться(ПараметрыПочты);\r\nПодключение.Послать(Письмо);\r\nСообщить (\"Письмо отправлено успешно.\");\r\nИсключение\r\nСообщить (\"Письмо не отправлено.\" + ОписаниеОшибки());\r\nКонецПопытки;\n\nОрфографическая ошибка в smtp (найдено 2): smtp\r\nОрфографическая ошибка в roga: roga\r\nОрфографическая ошибка в firma: firma"
  },
  {
    "title": "Разложить строку в массив",
    "description": "Разложить строку в массив",
    "code_snippet": "Функция РазложитьСтрокуВМассивПодстрок(Знач Стр, Разделитель = \",\") Экспорт\r\n\tМассивСтрок = Новый Массив();\r\n\tЕсли Разделитель = \" \" Тогда\r\n\t\tСтр = СокрЛП(Стр);\r\n\t\tПока 1 = 1 Цикл\r\n\t\t\tПоз = Найти(Стр, Разделитель);\r\n\t\t\tЕсли Поз = 0 Тогда\r\n\t\t\t\tМассивСтрок.Добавить(Стр);\r\n\t\t\t\tВозврат МассивСтрок;\r\n\t\t\tКонецЕсли;\r\n\t\t\tМассивСтрок.Добавить(Лев(Стр, Поз - 1));\r\n\t\t\tСтр = СокрЛ(Сред(Стр, Поз));\r\n\t\tКонецЦикла;\r\n\tИначе\r\n\t\tДлинаРазделителя = СтрДлина(Разделитель);\r\n\t\tПока 1 = 1 Цикл\r\n\t\t\tПоз = Найти(Стр,Разделитель);\r\n\t\t\tЕсли Поз = 0 Тогда\r\n\t\t\t\tМассивСтрок.Добавить(Стр);\r\n\t\t\t\tВозврат МассивСтрок;\r\n\t\t\tКонецЕсли;\r\n\t\t\tМассивСтрок.Добавить(Лев(Стр, Поз - 1));\r\n\t\t\tСтр = Сред(Стр, Поз + ДлинаРазделителя);\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\t\r\nКонецФункции\n\nФункция РазложитьСтрокуВМассивПодстрок(Знач Стр, Разделитель = \",\") Экспорт\r\n\tМассивСтрок = Новый Массив();\r\n\tЕсли Разделитель = \" \" Тогда\r\n\t\tСтр = СокрЛП(Стр);\r\n\t\tПока 1 = 1 Цикл\r\n\t\t\tПоз = Найти(Стр, Разделитель);\r\n\t\t\tЕсли Поз = 0 Тогда\r\n\t\t\t\tМассивСтрок.Добавить(Стр);\r\n\t\t\t\tВозврат МассивСтрок;\r\n\t\t\tКонецЕсли;\r\n\t\t\tМассивСтрок.Добавить(Лев(Стр, Поз - 1));\r\n\t\t\tСтр = СокрЛ(Сред(Стр, Поз));\r\n\t\tКонецЦикла;\r\n\tИначе\r\n\t\tДлинаРазделителя = СтрДлина(Разделитель);\r\n\t\tПока 1 = 1 Цикл\r\n\t\t\tПоз = Найти(Стр,Разделитель);\r\n\t\t\tЕсли Поз = 0 Тогда\r\n\t\t\t\tМассивСтрок.Добавить(Стр);\r\n\t\t\t\tВозврат МассивСтрок;\r\n\t\t\tКонецЕсли;\r\n\t\t\tМассивСтрок.Добавить(Лев(Стр, Поз - 1));\r\n\t\t\tСтр = Сред(Стр, Поз + ДлинаРазделителя);\r\n\t\tКонецЦикла;\r\n\tКонецЕсли;\t\r\nКонецФункции\n\n{1} Не все части функции возвращают значение"
  },
  {
    "title": "Поиск в таблице значений неуникальных значений",
    "description": "Поиск в таблице значений неуникальных значений",
    "code_snippet": "Отбор = Новый Структура;\r\nОтбор.Вставить(\"Цвет\", \"Зелёный\");\r\nСтроки = Таб.НайтиСтроки(Отбор);\r\nДля Каждого Стр Из Строки Цикл\r\n    Сообщить(Стр.Фрукт); // Яблоко Киви\r\nКонецЦикла;\n\nОтбор = Новый Структура;\r\nОтбор.Вставить(\"Цвет\", \"Зелёный\");\r\nСтроки = Таб.НайтиСтроки(Отбор);\r\nДля Каждого Стр Из Строки Цикл\r\n    Сообщить(Стр.Фрукт); // Яблоко Киви\r\nКонецЦикла;"
  },
  {
    "title": "Загрузка из excel, xls",
    "description": "Загрузка из excel, xls",
    "code_snippet": "////1\r\nПроцедура Загрузить();\r\n                                \r\n    Попытка\r\n        Excel = Новый COMОбъект(\"Excel.Application\");\r\n        Excel.displayalerts = 0;\r\n        Excel.WorkBooks.Open(КаталогДБФ);\r\n        Состояние(\"Обработка файла Microsoft Excel...\");\r\n        ExcelЛист = Excel.Sheets(1);\r\n    Исключение \r\n        Сообщить(\"Ошибка. Возможно неверно указан номер листа книги Excel.\");\r\n        Excel.WorkBooks.Close(); Excel = 0;\r\n        Возврат;\r\n    КонецПопытки;  \r\n    \r\n    ТЗ = ПрочитатьЛистExcel(, ExcelЛист,,,,6);\r\n    \r\n    Excel.WorkBooks.Close();\r\n    Excel = 0;          \r\n    \r\nКонецПроцедуры;  \r\n\r\n\r\nФункция ПрочитатьЛистExcel(ТЗ = Неопределено, ЛистЭксель = Неопределено, НомерПервойСтроки = 1, НомерПервойКолонки = 1, ВсегоСтрок = 0, ВсегоКолонок = 0) Экспорт\r\n    \r\n    Если ЛистЭксель = Неопределено Тогда\r\n        ЛистЭксель = ПолучитьCOMОбъект(,\"Excel.Application\");\r\n    КонецЕсли;\r\n    Если ВсегоСтрок = 0 Тогда\r\n        ВсегоСтрок = ЛистЭксель.Cells.SpecialCells(11).Row;\r\n    КонецЕсли;\r\n    Если ВсегоКолонок = 0 Тогда\r\n        ВсегоКолонок = ЛистЭксель.Cells.SpecialCells(11).Column;\r\n    КонецЕсли;\r\n    Если ТЗ = Неопределено Тогда\r\n        ТЗ =  Новый ТаблицаЗначений;\r\n        Для Счетчик = 1 По ВсегоКолонок Цикл\r\n            ТЗ.Колонки.Добавить(\"Колонка\"+Счетчик, Новый ОписаниеТипов(\"Строка\"));\r\n        КонецЦикла;\r\n    КонецЕсли;\r\n    Для Счетчик = НомерПервойСтроки По ВсегоСтрок Цикл\r\n        НоваяСтрока = ТЗ.Добавить();\r\n    КонецЦикла;\r\n    \r\n    Область = ЛистЭксель.Range(ЛистЭксель.Cells(НомерПервойСтроки,НомерПервойКолонки), ЛистЭксель.Cells(ВсегоСтрок,ВсегоКолонок));\r\n    Данные = Область.Value.Выгрузить();\r\n    \r\n    Для Счетчик = 0 По ВсегоКолонок-1 Цикл\r\n        ТЗ.ЗагрузитьКолонку(Данные[Счетчик], Счетчик);\r\n    КонецЦикла;\r\n    ЛистЭксель = Неопределено;\r\n    Возврат ТЗ;\r\nКонецФункции   \r\n\r\n////2\n\n////1\r\nПроцедура Загрузить();\r\n                                \r\n    Попытка\r\n        Excel = Новый COMОбъект(\"Excel.Application\");\r\n        Excel.displayalerts = 0;\r\n        Excel.WorkBooks.Open(КаталогДБФ);\r\n        Состояние(\"Обработка файла Microsoft Excel...\");\r\n        ExcelЛист = Excel.Sheets(1);\r\n    Исключение \r\n        Сообщить(\"Ошибка. Возможно неверно указан номер листа книги Excel.\");\r\n        Excel.WorkBooks.Close(); Excel = 0;\r\n        Возврат;\r\n    КонецПопытки;  \r\n    \r\n    ТЗ = ПрочитатьЛистExcel(, ExcelЛист,,,,6);\r\n    \r\n    Excel.WorkBooks.Close();\r\n    Excel = 0;          \r\n    \r\nКонецПроцедуры;  \r\n\r\n\r\nФункция ПрочитатьЛистExcel(ТЗ = Неопределено, ЛистЭксель = Неопределено, НомерПервойСтроки = 1, НомерПервойКолонки = 1, ВсегоСтрок = 0, ВсегоКолонок = 0) Экспорт\r\n    \r\n    Если ЛистЭксель = Неопределено Тогда\r\n        ЛистЭксель = ПолучитьCOMОбъект(,\"Excel.Application\");\r\n    КонецЕсли;\r\n    Если ВсегоСтрок = 0 Тогда\r\n        ВсегоСтрок = ЛистЭксель.Cells.SpecialCells(11).Row;\r\n    КонецЕсли;\r\n    Если ВсегоКолонок = 0 Тогда\r\n        ВсегоКолонок = ЛистЭксель.Cells.SpecialCells(11).Column;\r\n    КонецЕсли;\r\n    Если ТЗ = Неопределено Тогда\r\n        ТЗ =  Новый ТаблицаЗначений;\r\n        Для Счетчик = 1 По ВсегоКолонок Цикл\r\n            ТЗ.Колонки.Добавить(\"Колонка\"+Счетчик, Новый ОписаниеТипов(\"Строка\"));\r\n        КонецЦикла;\r\n    КонецЕсли;\r\n    Для Счетчик = НомерПервойСтроки По ВсегоСтрок Цикл\r\n        НоваяСтрока = ТЗ.Добавить();\r\n    КонецЦикла;\r\n    \r\n    Область = ЛистЭксель.Range(ЛистЭксель.Cells(НомерПервойСтроки,НомерПервойКолонки), ЛистЭксель.Cells(ВсегоСтрок,ВсегоКолонок));\r\n    Данные = Область.Value.Выгрузить();\r\n    \r\n    Для Счетчик = 0 По ВсегоКолонок-1 Цикл\r\n        ТЗ.ЗагрузитьКолонку(Данные[Счетчик], Счетчик);\r\n    КонецЦикла;\r\n    ЛистЭксель = Неопределено;\r\n    Возврат ТЗ;\r\nКонецФункции   \r\n\r\n////2\n\n{22} Ожидается идентификатор\r\n{17} Переменной ТЗ присвоено значение, но оно нигде не используется\r\n{20} Переменной Excel присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в displayalerts: displayalerts\r\nОрфографическая ошибка в ЛистЭксель (найдено 9): Эксель"
  },
  {
    "title": "Программное проведение документа",
    "description": "Программное проведение документа",
    "code_snippet": "&НаСервере\r\nПроцедура ОпубликоватьНаСервере()\r\n\tЭО = ДанныеФормыВЗначение(Объект, Тип(\"ДокументОбъект.Заявка\"));\r\n\t\r\n\tЭО.Записать(РежимЗаписиДокумента.Проведение);\r\n\t\r\n\tЗначениеВДанныеФормы(ЭО, Объект);\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура Опубликовать(Команда)\r\n\t\r\n\tОпубликоватьНаСервере();\r\n\t\r\n\tЭтаФорма.Закрыть(); \r\n\t\r\n\tОбновитьИнтерфейс();\r\n\t\r\nКонецПроцедуры\n\n&НаСервере\r\nПроцедура ОпубликоватьНаСервере()\r\n\tЭО = ДанныеФормыВЗначение(Объект, Тип(\"ДокументОбъект.Заявка\"));\r\n\t\r\n\tЭО.Записать(РежимЗаписиДокумента.Проведение);\r\n\t\r\n\tЗначениеВДанныеФормы(ЭО, Объект);\r\n\t\r\nКонецПроцедуры\r\n\r\n&НаКлиенте\r\nПроцедура Опубликовать(Команда)\r\n\t\r\n\tОпубликоватьНаСервере();\r\n\t\r\n\tЭтаФорма.Закрыть(); \r\n\t\r\n\tОбновитьИнтерфейс();\r\n\t\r\nКонецПроцедуры"
  },
  {
    "title": "Чтение файла XML в объект XDTO",
    "description": "Чтение файла XML в объект XDTO",
    "code_snippet": "ЧтениеXML = Новый ЧтениеXML;\r\nЧтениеXML.ОткрытьФайл(ИмяФайла);\r\n\t\r\nОбъектXDTO = ФабрикаXDTO.ПрочитатьXML(ЧтениеXML);\r\n\t\r\nЧтениеXML.Закрыть();\n\nЧтениеXML = Новый ЧтениеXML;\r\nЧтениеXML.ОткрытьФайл(ИмяФайла);\r\n\t\r\nОбъектXDTO = ФабрикаXDTO.ПрочитатьXML(ЧтениеXML);\r\n\t\r\nЧтениеXML.Закрыть();\n\n{4} Переменной ОбъектXDTO присвоено значение, но оно нигде не используется\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Вывод данных СКД в таблицу значений (дерево)",
    "description": "Вывод данных СКД в таблицу значений (дерево)",
    "code_snippet": "КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\nМакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, КомпоновщикНастроек.ПолучитьНастройки(), , , Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\t\r\nПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;\r\nПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновкиДанных);\r\n\t\r\nПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\nТаблица = ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных, Истина);\n\nКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\nМакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, КомпоновщикНастроек.ПолучитьНастройки(), , , Тип(\"ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений\"));\r\n\t\r\nПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;\r\nПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновкиДанных);\r\n\t\r\nПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;\r\nТаблица = ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных, Истина);\n\n{8} Переменной Таблица присвоено значение, но оно нигде не используется\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Вывод данных СКД в табличный документ",
    "description": "Вывод данных СКД в табличный документ",
    "code_snippet": "ВнешниеНаборыДанных = Новый Структура;\r\n\t\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, КомпоновщикНастроек.ПолучитьНастройки(), ДанныеРасшифровки);\r\n\t\t\r\n\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки, ВнешниеНаборыДанных, ДанныеРасшифровки, Истина);\r\n\t\t\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n\tПроцессорВывода.УстановитьДокумент(ДокументРезультат);\r\n\t\t\r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновки, Истина);\n\nВнешниеНаборыДанных = Новый Структура;\r\n\t\r\n\tКомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\tМакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, КомпоновщикНастроек.ПолучитьНастройки(), ДанныеРасшифровки);\r\n\t\t\r\n\tПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновки.Инициализировать(МакетКомпоновки, ВнешниеНаборыДанных, ДанныеРасшифровки, Истина);\r\n\t\t\r\n\tПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n\tПроцессорВывода.УстановитьДокумент(ДокументРезультат);\r\n\t\t\r\n\tПроцессорВывода.Вывести(ПроцессорКомпоновки, Истина);\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Инициализация компоновщика настроек, упр формы",
    "description": "Инициализация компоновщика настроек, упр формы",
    "code_snippet": "ОбработкаОбъект = РеквизитФормыВЗначение(\"Объект\");\r\nСхемаСКД = ОбработкаОбъект.ПолучитьМакет(\"СхемаСКД\");\r\n\t\r\nАдресСхемы = ПоместитьВоВременноеХранилище(СхемаСКД, УникальныйИдентификатор);\r\nИсточникДоступныхНастроек = Новый ИсточникДоступныхНастроекКомпоновкиДанных(АдресСхемы);\r\n\t\r\nКомпоновщикНастроек.Инициализировать(ИсточникДоступныхНастроек);\r\nКомпоновщикНастроек.ЗагрузитьНастройки(СхемаСКД.НастройкиПоУмолчанию);\n\nОбработкаОбъект = РеквизитФормыВЗначение(\"Объект\");\r\nСхемаСКД = ОбработкаОбъект.ПолучитьМакет(\"СхемаСКД\");\r\n\t\r\nАдресСхемы = ПоместитьВоВременноеХранилище(СхемаСКД, УникальныйИдентификатор);\r\nИсточникДоступныхНастроек = Новый ИсточникДоступныхНастроекКомпоновкиДанных(АдресСхемы);\r\n\t\r\nКомпоновщикНастроек.Инициализировать(ИсточникДоступныхНастроек);\r\nКомпоновщикНастроек.ЗагрузитьНастройки(СхемаСКД.НастройкиПоУмолчанию);"
  },
  {
    "title": "Инициализация компоновщика настроек",
    "description": "Инициализация компоновщика настроек",
    "code_snippet": "СхемаСКД = ПолучитьМакет(\"СхемаСКД\");\r\nКомпоновщикНастроек.Инициализировать(Новый ИсточникДоступныхНастроекКомпоновкиДанных(СхемаСКД));\r\nКомпоновщикНастроек.ЗагрузитьНастройки(СхемаСКД.НастройкиПоУмолчанию);\n\nСхемаСКД = ПолучитьМакет(\"СхемаСКД\");\r\nКомпоновщикНастроек.Инициализировать(Новый ИсточникДоступныхНастроекКомпоновкиДанных(СхемаСКД));\r\nКомпоновщикНастроек.ЗагрузитьНастройки(СхемаСКД.НастройкиПоУмолчанию);"
  },
  {
    "title": "Обработка проводок по дереву",
    "description": "Обработка проводок по дереву",
    "code_snippet": "Дерево  = мРезультатЗапроса.Выгрузить(ОбходРезультатаЗапроса.ПоГруппировкам);\r\nКолво   = Дерево.Строки.Количество();\r\nСчетчик = 0;\r\nДля каждого Строка1 Из Дерево.Строки Цикл\r\n\t\r\n\tСчетчик = Счетчик + 1;\r\n\tОбработкаПрерыванияПользователя();\r\n\tСостояние(Строка(Счетчик) + \" из \" + Строка(Колво) + \" \" + Строка(Строка1.Регистратор));\r\n\t\r\n\tНаборЗаписей = РегистрыБухгалтерии.Хозрасчетный.СоздатьНаборЗаписей();\r\n\tНаборЗаписей.Отбор.Регистратор.Установить(Строка1.Регистратор);\r\n\tНаборЗаписей.Прочитать();\r\n\t\r\n\tДля каждого Строка2 Из Строка1.Строки Цикл\r\n\t\t\r\n\t\tЗапись = НаборЗаписей[Строка2.НомерСтроки - 1];\r\n\t\t\r\n\t\tЕсли Строка2.ДтКт = \"Дт\" Тогда\r\n\t\tИначе\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\t\r\n\t\r\n\tНаборЗаписей.ОбменДанными.Загрузка = Истина;\r\n\tНаборЗаписей.Записать();\r\n\t\r\nКонецЦикла;\n\nДерево  = мРезультатЗапроса.Выгрузить(ОбходРезультатаЗапроса.ПоГруппировкам);\r\nКолво   = Дерево.Строки.Количество();\r\nСчетчик = 0;\r\nДля каждого Строка1 Из Дерево.Строки Цикл\r\n\t\r\n\tСчетчик = Счетчик + 1;\r\n\tОбработкаПрерыванияПользователя();\r\n\tСостояние(Строка(Счетчик) + \" из \" + Строка(Колво) + \" \" + Строка(Строка1.Регистратор));\r\n\t\r\n\tНаборЗаписей = РегистрыБухгалтерии.Хозрасчетный.СоздатьНаборЗаписей();\r\n\tНаборЗаписей.Отбор.Регистратор.Установить(Строка1.Регистратор);\r\n\tНаборЗаписей.Прочитать();\r\n\t\r\n\tДля каждого Строка2 Из Строка1.Строки Цикл\r\n\t\t\r\n\t\tЗапись = НаборЗаписей[Строка2.НомерСтроки - 1];\r\n\t\t\r\n\t\tЕсли Строка2.ДтКт = \"Дт\" Тогда\r\n\t\tИначе\r\n\t\tКонецЕсли;\t\r\n\t\t\r\n\tКонецЦикла;\t\r\n\t\r\n\tНаборЗаписей.ОбменДанными.Загрузка = Истина;\r\n\tНаборЗаписей.Записать();\r\n\t\r\nКонецЦикла;\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Пересчет строки товаров",
    "description": "Пересчет строки товаров",
    "code_snippet": "СтруктураПересчетаСуммы = ОбработкаТабличнойЧастиКлиентСервер.ПолучитьСтруктуруПересчетаСуммыНДСВСтрокеТЧ(Источник);\r\n\t\r\nСтруктураДействий = Новый Структура;\r\nСтруктураДействий.Вставить(\"ПересчитатьКоличествоЕдиниц\");\r\nСтруктураДействий.Вставить(\"ПересчитатьСуммуНДС\", СтруктураПересчетаСуммы);\r\nСтруктураДействий.Вставить(\"ПересчитатьСуммуСНДС\", СтруктураПересчетаСуммы);\r\nСтруктураДействий.Вставить(\"ПересчитатьСумму\");\r\n\t\r\nКэшированныеЗначения = Неопределено;\r\n\t\t\r\nОбработкаТабличнойЧастиСервер.ОбработатьСтрокуТЧ(СтрокаТЧ, СтруктураДействий, КэшированныеЗначения);\n\nСтруктураПересчетаСуммы = ОбработкаТабличнойЧастиКлиентСервер.ПолучитьСтруктуруПересчетаСуммыНДСВСтрокеТЧ(Источник);\r\n\t\r\nСтруктураДействий = Новый Структура;\r\nСтруктураДействий.Вставить(\"ПересчитатьКоличествоЕдиниц\");\r\nСтруктураДействий.Вставить(\"ПересчитатьСуммуНДС\", СтруктураПересчетаСуммы);\r\nСтруктураДействий.Вставить(\"ПересчитатьСуммуСНДС\", СтруктураПересчетаСуммы);\r\nСтруктураДействий.Вставить(\"ПересчитатьСумму\");\r\n\t\r\nКэшированныеЗначения = Неопределено;\r\n\t\t\r\nОбработкаТабличнойЧастиСервер.ОбработатьСтрокуТЧ(СтрокаТЧ, СтруктураДействий, КэшированныеЗначения);"
  },
  {
    "title": "Раскраска строки табличной части документа (обычные формы) по условию",
    "description": "Раскраска строки табличной части документа (обычные формы) по условию",
    "code_snippet": "Процедура выбДокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)\r\n\tЕсли (ДанныеСтроки.п=\"-\")или(данныеСтроки.у = \"+\") тогда\r\n\t\tОформлениеСтроки.ЦветФона = Новый Цвет(204,255,204);\r\n\tконецЕсли;\r\nКонецПроцедуры\n\nПроцедура выбДокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)\r\n\tЕсли (ДанныеСтроки.п=\"-\")или(данныеСтроки.у = \"+\") тогда\r\n\t\tОформлениеСтроки.ЦветФона = Новый Цвет(204,255,204);\r\n\tконецЕсли;\r\nКонецПроцедуры"
  },
  {
    "title": "пересчет реквизита табличной части обычной формы",
    "description": "пересчет реквизита табличной части обычной формы",
    "code_snippet": "Процедура Пересчет()\r\n\tСтрокаТабличнойЧасти = ЭлементыФормы.Товар.ТекущиеДанные;\r\n\tРекв = ЭлементыФормы.Товар.ТекущаяКолонка.Данные;\r\n\tЕсли Рекв = \"Номенклатура\" Тогда\r\n\t\tЦенаТ = ПолучитьЦену(СтрокаТабличнойЧасти.Номенклатура);\r\n\t\tСтрокаТабличнойЧасти.Цена = ЦенаТ;\r\n\t\tСтрокаТабличнойЧасти.Количество = 1;\r\n\t\tСтрокаТабличнойЧасти.Сумма = СтрокаТабличнойЧасти.Цена*СтрокаТабличнойЧасти.Количество;\r\n\tИначеЕсли Рекв = \"Количество\" Тогда\t\r\n\t\tСтрокаТабличнойЧасти.Сумма = СтрокаТабличнойЧасти.Цена*СтрокаТабличнойЧасти.Количество;\r\n\tИначеЕсли Рекв = \"Цена\" Тогда\r\n\t\tСтрокаТабличнойЧасти.Сумма = СтрокаТабличнойЧасти.Цена*СтрокаТабличнойЧасти.Количество;\r\n\tИначеЕсли Рекв = \"Сумма\" Тогда\t\r\n\t\tСтрокаТабличнойЧасти.Цена = СтрокаТабличнойЧасти.Сумма/?(СтрокаТабличнойЧасти.Количество=0,1,СтрокаТабличнойЧасти.Количество);\r\n\tКонецЕсли;\t\r\nКонецПроцедуры\n\nПроцедура Пересчет()\r\n\tСтрокаТабличнойЧасти = ЭлементыФормы.Товар.ТекущиеДанные;\r\n\tРекв = ЭлементыФормы.Товар.ТекущаяКолонка.Данные;\r\n\tЕсли Рекв = \"Номенклатура\" Тогда\r\n\t\tЦенаТ = ПолучитьЦену(СтрокаТабличнойЧасти.Номенклатура);\r\n\t\tСтрокаТабличнойЧасти.Цена = ЦенаТ;\r\n\t\tСтрокаТабличнойЧасти.Количество = 1;\r\n\t\tСтрокаТабличнойЧасти.Сумма = СтрокаТабличнойЧасти.Цена*СтрокаТабличнойЧасти.Количество;\r\n\tИначеЕсли Рекв = \"Количество\" Тогда\t\r\n\t\tСтрокаТабличнойЧасти.Сумма = СтрокаТабличнойЧасти.Цена*СтрокаТабличнойЧасти.Количество;\r\n\tИначеЕсли Рекв = \"Цена\" Тогда\r\n\t\tСтрокаТабличнойЧасти.Сумма = СтрокаТабличнойЧасти.Цена*СтрокаТабличнойЧасти.Количество;\r\n\tИначеЕсли Рекв = \"Сумма\" Тогда\t\r\n\t\tСтрокаТабличнойЧасти.Цена = СтрокаТабличнойЧасти.Сумма/?(СтрокаТабличнойЧасти.Количество=0,1,СтрокаТабличнойЧасти.Количество);\r\n\tКонецЕсли;\t\r\nКонецПроцедуры\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Заполнение табличного документа",
    "description": "Заполнение табличного документа",
    "code_snippet": "Макет \t= ПолучитьМакет(\"макет\");\r\nА1 \t\t= Макет.ПолучитьОбласть(\"А1\");\r\nА2 \t\t= Макет.ПолучитьОбласть(\"А2\");\r\nтабДок.Вывести(А1,1);\r\nдля ее = 0 по рез.Количество()-1 цикл\r\n\tА2.Параметры.Заполнить(рез[ее]);\r\n\tТабДок.Вывести(А2,2,\"импортер\",истина);\r\nконецЦикла;\r\nтабДок.ЗакончитьАвтогруппировкуСтрок();\r\nтабДок.Показать();\n\nМакет \t= ПолучитьМакет(\"макет\");\r\nА1 \t\t= Макет.ПолучитьОбласть(\"А1\");\r\nА2 \t\t= Макет.ПолучитьОбласть(\"А2\");\r\nтабДок.Вывести(А1,1);\r\nдля ее = 0 по рез.Количество()-1 цикл\r\n\tА2.Параметры.Заполнить(рез[ее]);\r\n\tТабДок.Вывести(А2,2,\"импортер\",истина);\r\nконецЦикла;\r\nтабДок.ЗакончитьАвтогруппировкуСтрок();\r\nтабДок.Показать();"
  },
  {
    "title": "Чтение XML через DOM",
    "description": "Чтение XML через DOM",
    "code_snippet": "функция читаемХМЛ2014(путь,атр) экспорт\r\n\tх \t\t= новый массив;\r\n\ty \t\t= новый массив;\r\n\tмДОМ \t= новый ПостроительDOM;\r\n\t\r\n\tзаявка = новый таблицаЗначений;\r\n\tзаявка.Колонки.Добавить(\"номерДок\");\r\n\tзаявка.Колонки.Добавить(\"клиент\");\r\n\tзаявка.Колонки.Добавить(\"адрес\");\r\n\tзаявка.Колонки.Добавить(\"товар\");\r\n\tзаявка.Колонки.Добавить(\"кодТовара\");\r\n\tзаявка.Колонки.Добавить(\"количество\");\r\n\tзаявка.Колонки.Добавить(\"цена\");\r\n\tзаявка.Колонки.Добавить(\"сумма\");\r\n\t\r\n\tчтение \t= Новый ЧтениеXML ;\r\n\tчтение.ОткрытьФайл(сокрЛП(путь));\r\n\tмДокументДОМ = мДОМ.Прочитать(чтение);\r\n\tчтение.Закрыть();\r\n\tномерДок = \"\";\r\n\tклиент   = \"\";\r\n\tадрес    = \"\";\r\n\t_documents =  мДокументДОМ.ПолучитьЭлементыПоИмени(\"documents\");\r\n\tдля каждого а1 из _documents цикл\r\n\t\t_preorder = а1.ПолучитьЭлементыПоИмени(\"preorder\");\r\n\t\tдля каждого а2 из _preorder цикл\r\n\t\t\t_ттн = а2.дочерниеУзлы;\r\n\t\t\tдля каждого а21 из _ттн цикл\r\n\t\t\t\tесли (а21.имяУзла = \"innercode\") тогда\r\n\t\t\t\t\tномерДок =а21.ТекстовоеСодержимое;\r\n\t\t\t\tконецЕсли; \r\n\t\t\t\tесли (а21.имяУзла = \"buypointjuridicalname\") тогда\r\n\t\t\t\t\tклиент   = а21.ТекстовоеСодержимое;\r\n\t\t\t\tконецЕсли;\r\n\t\t\t\tесли (а21.имяУзла = \"buypointaddress\") тогда\r\n\t\t\t\t\tадрес    = а21.ТекстовоеСодержимое;\r\n\t\t\t\tконецЕсли;\r\n\t\t\tконецЦикла;\r\n\t\t\t_item = а2.ПолучитьЭлементыПоИмени(\"item\");\r\n\t\t\tдля каждого а3 из _item цикл\r\n\t\t\t\t_товар  = а3.ДочерниеУзлы;\r\n\t\t\t\tхх = заявка.Добавить();\r\n\t\t\t\tхх.номерДок = номерДок;\r\n\t\t\t\tхх.клиент   = клиент;\r\n\t\t\t\tхх.адрес    = адрес;\r\n\t\t\t\tдля каждого а4 из _товар цикл\r\n\t\t\t\t\tесли  (а4.имяУзла = \"SKUname\") тогда\r\n\t\t\t\t\t\tхх.товар = а4.ТекстовоеСодержимое;\r\n\t\t\t\t\tконецЕсли;\r\n\t\t\t\t\tесли (а4.имяУзла = \"SKUcode\")тогда \r\n\t\t\t\t\t\tхх.кодТовара = а4.ТекстовоеСодержимое;\r\n\t\t\t\t\tконецЕсли;\r\n\t\t\t\t\tесли (а4.имяУзла = \"quantity\")тогда \r\n\t\t\t\t\t\tхх.количество = а4.ТекстовоеСодержимое;\r\n\t\t\t\t\tконецЕсли;\r\n\t\t\t\t\tесли (а4.имяУзла = \"priceDiscount\")  тогда\r\n\t\t\t\t\t\tхх.цена = а4.ТекстовоеСодержимое;\r\n\t\t\t\t\tконецЕсли;\r\n\t\t\t\t\tесли (а4.имяУзла = \"amount\")  тогда\r\n\t\t\t\t\t\tхх.сумма = а4.ТекстовоеСодержимое;\r\n\t\t\t\t\tконецЕсли;\r\n\t\t\t\tконецЦикла;\r\n\t\t\tконецЦикла;\r\n\t\tконецЦикла;\r\n\tконецЦикла;\r\n\t\r\n\t\r\n\t//мРазыменовательПИ = мДокументДОМ.СоздатьРазыменовательПИ(мДокументДОМ);\r\n\t//мЗапрос\t\t= \"/documents/preorders/preorder/body/item/*\";\r\n\t//мХПуть\t\t= мДокументДОМ.СоздатьВыражениеXPath(мЗапрос,мРазыменовательПИ);\r\n\t//мРезультат\t= мХПуть.Вычислить(мДокументДОМ);\r\n\t//мРодитель\t= мРезультат.ПолучитьСледующий();\r\n\t//пока мРодитель <> неопределено цикл\r\n\t//\t//если  мРодитель.ИмяЭлемента = \"body\" тогда\r\n\t//\t//\t  \r\n\t//\t//\t\r\n\t//\t//\tсообщить(\"\");\r\n\t//\t//\tмРодитель=мРезультат.ПолучитьСледующий();\r\n\t//\t//\tпродолжить;\r\n\t//\t//конецЕсли;\t \r\n\t//\tх.Добавить( мРодитель.ИмяЭлемента+\" \"+мРодитель.ТекстовоеСодержимое);\r\n\t//\tсообщить(мРодитель.ИмяЭлемента+\" \"+мРодитель.ТекстовоеСодержимое);\r\n\t//\tмРодитель=мРезультат.ПолучитьСледующий();\r\n\t//конецЦикла;\r\n\t\r\n\tвозврат заявка;\r\nконецФункции  //функция читаемХМЛ2014(путь)\n\nфункция читаемХМЛ2014(путь,атр) экспорт\r\n\tх \t\t= новый массив;\r\n\ty \t\t= новый массив;\r\n\tмДОМ \t= новый ПостроительDOM;\r\n\t\r\n\tзаявка = новый таблицаЗначений;\r\n\tзаявка.Колонки.Добавить(\"номерДок\");\r\n\tзаявка.Колонки.Добавить(\"клиент\");\r\n\tзаявка.Колонки.Добавить(\"адрес\");\r\n\tзаявка.Колонки.Добавить(\"товар\");\r\n\tзаявка.Колонки.Добавить(\"кодТовара\");\r\n\tзаявка.Колонки.Добавить(\"количество\");\r\n\tзаявка.Колонки.Добавить(\"цена\");\r\n\tзаявка.Колонки.Добавить(\"сумма\");\r\n\t\r\n\tчтение \t= Новый ЧтениеXML ;\r\n\tчтение.ОткрытьФайл(сокрЛП(путь));\r\n\tмДокументДОМ = мДОМ.Прочитать(чтение);\r\n\tчтение.Закрыть();\r\n\tномерДок = \"\";\r\n\tклиент   = \"\";\r\n\tадрес    = \"\";\r\n\t_documents =  мДокументДОМ.ПолучитьЭлементыПоИмени(\"documents\");\r\n\tдля каждого а1 из _documents цикл\r\n\t\t_preorder = а1.ПолучитьЭлементыПоИмени(\"preorder\");\r\n\t\tдля каждого а2 из _preorder цикл\r\n\t\t\t_ттн = а2.дочерниеУзлы;\r\n\t\t\tдля каждого а21 из _ттн цикл\r\n\t\t\t\tесли (а21.имяУзла = \"innercode\") тогда\r\n\t\t\t\t\tномерДок =а21.ТекстовоеСодержимое;\r\n\t\t\t\tконецЕсли; \r\n\t\t\t\tесли (а21.имяУзла = \"buypointjuridicalname\") тогда\r\n\t\t\t\t\tклиент   = а21.ТекстовоеСодержимое;\r\n\t\t\t\tконецЕсли;\r\n\t\t\t\tесли (а21.имяУзла = \"buypointaddress\") тогда\r\n\t\t\t\t\tадрес    = а21.ТекстовоеСодержимое;\r\n\t\t\t\tконецЕсли;\r\n\t\t\tконецЦикла;\r\n\t\t\t_item = а2.ПолучитьЭлементыПоИмени(\"item\");\r\n\t\t\tдля каждого а3 из _item цикл\r\n\t\t\t\t_товар  = а3.ДочерниеУзлы;\r\n\t\t\t\tхх = заявка.Добавить();\r\n\t\t\t\tхх.номерДок = номерДок;\r\n\t\t\t\tхх.клиент   = клиент;\r\n\t\t\t\tхх.адрес    = адрес;\r\n\t\t\t\tдля каждого а4 из _товар цикл\r\n\t\t\t\t\tесли  (а4.имяУзла = \"SKUname\") тогда\r\n\t\t\t\t\t\tхх.товар = а4.ТекстовоеСодержимое;\r\n\t\t\t\t\tконецЕсли;\r\n\t\t\t\t\tесли (а4.имяУзла = \"SKUcode\")тогда \r\n\t\t\t\t\t\tхх.кодТовара = а4.ТекстовоеСодержимое;\r\n\t\t\t\t\tконецЕсли;\r\n\t\t\t\t\tесли (а4.имяУзла = \"quantity\")тогда \r\n\t\t\t\t\t\tхх.количество = а4.ТекстовоеСодержимое;\r\n\t\t\t\t\tконецЕсли;\r\n\t\t\t\t\tесли (а4.имяУзла = \"priceDiscount\")  тогда\r\n\t\t\t\t\t\tхх.цена = а4.ТекстовоеСодержимое;\r\n\t\t\t\t\tконецЕсли;\r\n\t\t\t\t\tесли (а4.имяУзла = \"amount\")  тогда\r\n\t\t\t\t\t\tхх.сумма = а4.ТекстовоеСодержимое;\r\n\t\t\t\t\tконецЕсли;\r\n\t\t\t\tконецЦикла;\r\n\t\t\tконецЦикла;\r\n\t\tконецЦикла;\r\n\tконецЦикла;\r\n\t\r\n\t\r\n\t//мРазыменовательПИ = мДокументДОМ.СоздатьРазыменовательПИ(мДокументДОМ);\r\n\t//мЗапрос\t\t= \"/documents/preorders/preorder/body/item/*\";\r\n\t//мХПуть\t\t= мДокументДОМ.СоздатьВыражениеXPath(мЗапрос,мРазыменовательПИ);\r\n\t//мРезультат\t= мХПуть.Вычислить(мДокументДОМ);\r\n\t//мРодитель\t= мРезультат.ПолучитьСледующий();\r\n\t//пока мРодитель <> неопределено цикл\r\n\t//\t//если  мРодитель.ИмяЭлемента = \"body\" тогда\r\n\t//\t//\t  \r\n\t//\t//\t\r\n\t//\t//\tсообщить(\"\");\r\n\t//\t//\tмРодитель=мРезультат.ПолучитьСледующий();\r\n\t//\t//\tпродолжить;\r\n\t//\t//конецЕсли;\t \r\n\t//\tх.Добавить( мРодитель.ИмяЭлемента+\" \"+мРодитель.ТекстовоеСодержимое);\r\n\t//\tсообщить(мРодитель.ИмяЭлемента+\" \"+мРодитель.ТекстовоеСодержимое);\r\n\t//\tмРодитель=мРезультат.ПолучитьСледующий();\r\n\t//конецЦикла;\r\n\t\r\n\tвозврат заявка;\r\nконецФункции  //функция читаемХМЛ2014(путь)\n\n{2} Переменной х присвоено значение, но оно нигде не используется\r\n{3} Переменной y присвоено значение, но оно нигде не используется\r\nОрфографическая ошибка в innercode: innercode\r\nОрфографическая ошибка в buypointjuridicalname: buypointjuridicalname\r\nОрфографическая ошибка в buypointaddress: buypointaddress\r\nОрфографическая ошибка в мРазыменовательПИ (найдено 2): Разыменователь\r\nОрфографическая ошибка в СоздатьРазыменовательПИ: Разыменователь\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Обработка подбора в управляемой форме",
    "description": "Обработка подбора в управляемой форме",
    "code_snippet": "&НаКлиенте //часто стоит указать &наСервере\r\nПроцедура выбратьТовар(Команда)\r\n\t ст = новый структура;\r\n\t ст.Вставить(\"товар\", элементы.списокПодбора.текущиеДанные.товар);\r\n\t ст.Вставить(\"цена\"\t, элементы.списокПодбора.текущиеДанные.цена);\r\n\t //этаФорма.результат = ПоместитьВоВременноеХранилище(ст);\r\n\t этаФорма.ВладелецФормы.адресПодбора = ст;\r\n\t этаФорма.ВладелецФормы.выполнитьПодбор();\r\n\t этаФорма.Закрыть();\r\nКонецПроцедуры //Процедура выбратьТовар(Команда)\r\n\r\n&НаКлиенте\r\nпроцедура выполнитьПодбор() Экспорт\r\n\tст \t\t\t\t\t= этаФорма.адресПодбора;\r\n\tадресПодбора \t\t= неопределено;\r\n\tхх \t\t\t\t\t= объект.товар.Добавить();\r\n\tхх.номенклатура \t= ст.товар;\r\n\tхх.ценаВход \t\t= ст.цена;\r\n\tхх.цена \t\t\t= ст.цена;\r\n\tхх.количество \t\t= 1;\r\n\tхх.сумма \t\t\t= хх.количество*хх.цена;\t\r\nконецПроцедуры\n\n&НаКлиенте //часто стоит указать &наСервере\r\nПроцедура выбратьТовар(Команда)\r\n\t ст = новый структура;\r\n\t ст.Вставить(\"товар\", элементы.списокПодбора.текущиеДанные.товар);\r\n\t ст.Вставить(\"цена\"\t, элементы.списокПодбора.текущиеДанные.цена);\r\n\t //этаФорма.результат = ПоместитьВоВременноеХранилище(ст);\r\n\t этаФорма.ВладелецФормы.адресПодбора = ст;\r\n\t этаФорма.ВладелецФормы.выполнитьПодбор();\r\n\t этаФорма.Закрыть();\r\nКонецПроцедуры //Процедура выбратьТовар(Команда)\r\n\r\n&НаКлиенте\r\nпроцедура выполнитьПодбор() Экспорт\r\n\tст \t\t\t\t\t= этаФорма.адресПодбора;\r\n\tадресПодбора \t\t= неопределено;\r\n\tхх \t\t\t\t\t= объект.товар.Добавить();\r\n\tхх.номенклатура \t= ст.товар;\r\n\tхх.ценаВход \t\t= ст.цена;\r\n\tхх.цена \t\t\t= ст.цена;\r\n\tхх.количество \t\t= 1;\r\n\tхх.сумма \t\t\t= хх.количество*хх.цена;\t\r\nконецПроцедуры\n\n{15} Переменной адресПодбора присвоено значение, но оно нигде не используется\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Вызов формы подбора в управляемой форме",
    "description": "Вызов формы подбора в управляемой форме",
    "code_snippet": "П = Новый Структура;\r\n\tФормаВыбора = ПолучитьФорму(\"Документ.расходТовара.Форма.подбор\",П,этаФорма);\r\n\tФормаВыбора.Открыть();\n\nП = Новый Структура;\r\n\tФормаВыбора = ПолучитьФорму(\"Документ.расходТовара.Форма.подбор\",П,этаФорма);\r\n\tФормаВыбора.Открыть();"
  },
  {
    "title": "Вызов шаблона в управляемой форме",
    "description": "Вызов шаблона в управляемой форме",
    "code_snippet": "схемаКомпоновкиДанных \t\t= РеквизитФормыВЗначение(\"Объект\").ПолучитьМакет(\"имяОтчета\");\n\nсхемаКомпоновкиДанных \t\t= РеквизитФормыВЗначение(\"Объект\").ПолучитьМакет(\"имяОтчета\");\n\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Вернуть СКД (источник данных таблица значений)",
    "description": "Вернуть СКД (источник данных таблица значений)",
    "code_snippet": "функция вернутьКомпоновку(СхемаКомпоновкиДанных,ВнешниеНаборыДанных)\r\n\tНастройки \t\t\t\t\t= СхемаКомпоновкиДанных.НастройкиПоУмолчанию;\r\n\tКомпоновщикМакета \t\t\t= Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\tМакетКомпоновки \t\t\t= КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных,Настройки);\r\n\tПроцессорКомпоновкиДанных \t= Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновки,ВнешниеНаборыДанных);\r\n\tТабДок \t\t\t\t\t\t= Новый ТабличныйДокумент; //этаФорма.птд1\r\n\tПроцессорВывода \t\t\t= Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n\tПроцессорВывода.УстановитьДокумент(ТабДок);\r\n\tПроцессорВывода.НачатьВывод();\r\n\tПока Истина Цикл\r\n\t\tЭлементРезультата = ПроцессорКомпоновкиДанных.Следующий();\r\n\t\tЕсли ЭлементРезультата = Неопределено Тогда\r\n\t\t\tПрервать;\r\n\t\tИначе\r\n\t\t\tПроцессорВывода.ВывестиЭлемент(ЭлементРезультата);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tПроцессорВывода.ЗакончитьВывод();\r\n\t//Результат.ПоказатьУровеньГруппировокСтрок(0)\r\n\t\r\n\tТабДок.ОтображатьСетку \t\t= Ложь;\r\n\tТабДок.ОтображатьЗаголовки \t= Ложь;\r\n\tТабДок.ТолькоПросмотр \t\t= Истина;\r\n\tтабДок.ПоказатьУровеньГруппировокСтрок(0);\r\n\tвозврат ТабДок;\r\nконецФункции  //функция вернутьКомпоновку(СхемаКомпоновкиДанных,ВнешниеНаборыДанных,квартал1 = \"ХХ\",год1 = \"ХХХХ\",квартал2 = \"ХХ\",год2 = \"ХХХХ\")\r\n\r\n//************исполенение***************\r\nРез \t\t\t= Запрос.Выполнить().Выгрузить();\r\n\t  СхемаКомпоновкиДанных \t\t= обработкаОбъект.ЭтотОбъект.ПолучитьМакет(\"форма6и7кратко\");\r\n\tВнешниеНаборыДанных \t\t= Новый Структура;\r\n\tВнешниеНаборыДанных.Вставить(\"рез\",Рез);\r\n\tвернутьКомпоновку(СхемаКомпоновкиДанных,ВнешниеНаборыДанных).показать();\n\nфункция вернутьКомпоновку(СхемаКомпоновкиДанных,ВнешниеНаборыДанных)\r\n\tНастройки \t\t\t\t\t= СхемаКомпоновкиДанных.НастройкиПоУмолчанию;\r\n\tКомпоновщикМакета \t\t\t= Новый КомпоновщикМакетаКомпоновкиДанных;\r\n\tМакетКомпоновки \t\t\t= КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных,Настройки);\r\n\tПроцессорКомпоновкиДанных \t= Новый ПроцессорКомпоновкиДанных;\r\n\tПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновки,ВнешниеНаборыДанных);\r\n\tТабДок \t\t\t\t\t\t= Новый ТабличныйДокумент; //этаФорма.птд1\r\n\tПроцессорВывода \t\t\t= Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;\r\n\tПроцессорВывода.УстановитьДокумент(ТабДок);\r\n\tПроцессорВывода.НачатьВывод();\r\n\tПока Истина Цикл\r\n\t\tЭлементРезультата = ПроцессорКомпоновкиДанных.Следующий();\r\n\t\tЕсли ЭлементРезультата = Неопределено Тогда\r\n\t\t\tПрервать;\r\n\t\tИначе\r\n\t\t\tПроцессорВывода.ВывестиЭлемент(ЭлементРезультата);\r\n\t\tКонецЕсли;\r\n\tКонецЦикла;\r\n\tПроцессорВывода.ЗакончитьВывод();\r\n\t//Результат.ПоказатьУровеньГруппировокСтрок(0)\r\n\t\r\n\tТабДок.ОтображатьСетку \t\t= Ложь;\r\n\tТабДок.ОтображатьЗаголовки \t= Ложь;\r\n\tТабДок.ТолькоПросмотр \t\t= Истина;\r\n\tтабДок.ПоказатьУровеньГруппировокСтрок(0);\r\n\tвозврат ТабДок;\r\nконецФункции  //функция вернутьКомпоновку(СхемаКомпоновкиДанных,ВнешниеНаборыДанных,квартал1 = \"ХХ\",год1 = \"ХХХХ\",квартал2 = \"ХХ\",год2 = \"ХХХХ\")\r\n\r\n//************исполенение***************\r\nРез \t\t\t= Запрос.Выполнить().Выгрузить();\r\n\t  СхемаКомпоновкиДанных \t\t= обработкаОбъект.ЭтотОбъект.ПолучитьМакет(\"форма6и7кратко\");\r\n\tВнешниеНаборыДанных \t\t= Новый Структура;\r\n\tВнешниеНаборыДанных.Вставить(\"рез\",Рез);\r\n\tвернутьКомпоновку(СхемаКомпоновкиДанных,ВнешниеНаборыДанных).показать();\n\nОрфографическая ошибка в исполенение: исполенение"
  },
  {
    "title": "описание числа (15.2) в таблице значений",
    "description": "описание числа (15.2) в таблице значений",
    "code_snippet": "Новый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(15, 2))\n\nНовый ОписаниеТипов(\"Число\", Новый КвалификаторыЧисла(15, 2))\n\n{} Ожидается идентификатор\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "описание даты в таблице значений",
    "description": "описание даты в таблице значений",
    "code_snippet": "Новый ОписаниеТипов (\"Дата\", , , Новый КвалификаторыДаты(ЧастиДаты.Дата))\n\nНовый ОписаниеТипов (\"Дата\", , , Новый КвалификаторыДаты(ЧастиДаты.Дата))\n\n{} Ожидается идентификатор\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "Описание строки в таблице значений",
    "description": "Описание строки в таблице значений",
    "code_snippet": "ст90\t= новый описаниеТипов(\"строка\",,Новый КвалификаторыСтроки(90));\n\nст90\t= новый описаниеТипов(\"строка\",,Новый КвалификаторыСтроки(90));\n\n{1} Переменной ст90 присвоено значение, но оно нигде не используется\r\nОписание дублирует название. Удалите описание, если информации в заголовке достаточно."
  },
  {
    "title": "ПрочитатьXMLВТаблицу",
    "description": "ПрочитатьXMLВТаблицу",
    "code_snippet": "// Преобразует текст формата XML в таблицу значений,\r\n// при этом колонки таблицы формируются на основе описания в XML.\r\n//\r\n// Параметры:\r\n//  ТекстXML     - текст в формате XML.\r\n//\r\n// Схема XML:\r\n//<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n//<xs:schema attributeFormDefault=\"unqualified\" elementFormDefault=\"qualified\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\r\n//  <xs:element name=\"Items\">\r\n//\t<xs:complexType>\r\n//\t  <xs:sequence>\r\n//\t\t<xs:element maxOccurs=\"unbounded\" name=\"Item\">\r\n//\t\t  <xs:complexType>\r\n//\t\t\t<xs:attribute name=\"Code\" type=\"xs:integer\" use=\"required\" />\r\n//\t\t\t<xs:attribute name=\"Name\" type=\"xs:string\" use=\"required\" />\r\n//\t\t\t<xs:attribute name=\"Socr\" type=\"xs:string\" use=\"required\" />\r\n//\t\t\t<xs:attribute name=\"Index\" type=\"xs:string\" use=\"required\" />\r\n//\t\t  </xs:complexType>\r\n//\t\t</xs:element>\r\n//\t  </xs:sequence>\r\n//\t  <xs:attribute name=\"Description\" type=\"xs:string\" use=\"required\" />\r\n//\t  <xs:attribute name=\"Columns\" type=\"xs:string\" use=\"required\" />\r\n//\t</xs:complexType>\r\n//  </xs:element>\r\n//</xs:schema>\r\n//\r\n// Примеры XML-файлов см. в демонстрационной конфигурации.\r\n// \r\n// Пример использования:\r\n//   КлассификаторТаблица = ПрочитатьXMLВТаблицу(РегистрыСведений.АдресныйКлассификатор.\r\n//       ПолучитьМакет(\"КлассификаторАдресныхОбъектовРоссии\").ПолучитьТекст());\r\n//\r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений.\r\n//\r\nФункция ПрочитатьXMLВТаблицу(ТекстXML) Экспорт\r\n\t\r\n\tЧтение = Новый ЧтениеXML;\r\n\tЧтение.УстановитьСтроку(ТекстXML);\r\n\t\r\n\t// Прочитаем первый узел и проверим его\r\n\tЕсли Не Чтение.Прочитать() Тогда\r\n\t\tВызватьИсключение(\"Пустой XML\");\r\n\tИначеЕсли Чтение.Имя <> \"Items\" Тогда\r\n\t\tВызватьИсключение(\"Ошибка в структуре XML\");\r\n\tКонецЕсли;\r\n\t\r\n\t// Получим описание таблицы и создадим ее\r\n\tИмяТаблицы = Чтение.ПолучитьАтрибут(\"Description\");\r\n\tИменаКолонок = СтрЗаменить(Чтение.ПолучитьАтрибут(\"Columns\"), \",\", Символы.ПС);\r\n\tКолонок = СтрЧислоСтрок(ИменаКолонок);\r\n\t\r\n\tТаблицаЗначений = Новый ТаблицаЗначений;\r\n\tДля Сч = 1 По Колонок Цикл\r\n\t\tТаблицаЗначений.Колонки.Добавить(СтрПолучитьСтроку(ИменаКолонок, Сч), Новый ОписаниеТипов(\"Строка\"));\r\n\tКонецЦикла;\r\n\t\r\n\t// Заполним значения в таблице\r\n\tПока Чтение.Прочитать() Цикл\r\n\t\t\r\n\t\tЕсли Чтение.ТипУзла <> ТипУзлаXML.НачалоЭлемента Тогда\r\n\t\t\tПродолжить;\r\n\t\tИначеЕсли Чтение.Имя <> \"Item\" Тогда\r\n\t\t\tВызватьИсключение(\"Ошибка в структуре XML\");\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tновСтр = ТаблицаЗначений.Добавить();\r\n\t\tДля Сч = 1 По Колонок Цикл\r\n\t\t\tИмяКолонки = СтрПолучитьСтроку(ИменаКолонок, Сч);\r\n\t\t\tновСтр[Сч-1] = Чтение.ПолучитьАтрибут(ИмяКолонки);\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t// Заполним результат\r\n\tРезультат = Новый Структура;\r\n\tРезультат.Вставить(\"ИмяТаблицы\", ИмяТаблицы);\r\n\tРезультат.Вставить(\"Данные\", ТаблицаЗначений);\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции // ПрочитатьXMLВТаблицу()\n\n// Преобразует текст формата XML в таблицу значений,\r\n// при этом колонки таблицы формируются на основе описания в XML.\r\n//\r\n// Параметры:\r\n//  ТекстXML     - текст в формате XML.\r\n//\r\n// Схема XML:\r\n//<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n//<xs:schema attributeFormDefault=\"unqualified\" elementFormDefault=\"qualified\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\r\n//  <xs:element name=\"Items\">\r\n//\t<xs:complexType>\r\n//\t  <xs:sequence>\r\n//\t\t<xs:element maxOccurs=\"unbounded\" name=\"Item\">\r\n//\t\t  <xs:complexType>\r\n//\t\t\t<xs:attribute name=\"Code\" type=\"xs:integer\" use=\"required\" />\r\n//\t\t\t<xs:attribute name=\"Name\" type=\"xs:string\" use=\"required\" />\r\n//\t\t\t<xs:attribute name=\"Socr\" type=\"xs:string\" use=\"required\" />\r\n//\t\t\t<xs:attribute name=\"Index\" type=\"xs:string\" use=\"required\" />\r\n//\t\t  </xs:complexType>\r\n//\t\t</xs:element>\r\n//\t  </xs:sequence>\r\n//\t  <xs:attribute name=\"Description\" type=\"xs:string\" use=\"required\" />\r\n//\t  <xs:attribute name=\"Columns\" type=\"xs:string\" use=\"required\" />\r\n//\t</xs:complexType>\r\n//  </xs:element>\r\n//</xs:schema>\r\n//\r\n// Примеры XML-файлов см. в демонстрационной конфигурации.\r\n// \r\n// Пример использования:\r\n//   КлассификаторТаблица = ПрочитатьXMLВТаблицу(РегистрыСведений.АдресныйКлассификатор.\r\n//       ПолучитьМакет(\"КлассификаторАдресныхОбъектовРоссии\").ПолучитьТекст());\r\n//\r\n// Возвращаемое значение:\r\n//  ТаблицаЗначений.\r\n//\r\nФункция ПрочитатьXMLВТаблицу(ТекстXML) Экспорт\r\n\t\r\n\tЧтение = Новый ЧтениеXML;\r\n\tЧтение.УстановитьСтроку(ТекстXML);\r\n\t\r\n\t// Прочитаем первый узел и проверим его\r\n\tЕсли Не Чтение.Прочитать() Тогда\r\n\t\tВызватьИсключение(\"Пустой XML\");\r\n\tИначеЕсли Чтение.Имя <> \"Items\" Тогда\r\n\t\tВызватьИсключение(\"Ошибка в структуре XML\");\r\n\tКонецЕсли;\r\n\t\r\n\t// Получим описание таблицы и создадим ее\r\n\tИмяТаблицы = Чтение.ПолучитьАтрибут(\"Description\");\r\n\tИменаКолонок = СтрЗаменить(Чтение.ПолучитьАтрибут(\"Columns\"), \",\", Символы.ПС);\r\n\tКолонок = СтрЧислоСтрок(ИменаКолонок);\r\n\t\r\n\tТаблицаЗначений = Новый ТаблицаЗначений;\r\n\tДля Сч = 1 По Колонок Цикл\r\n\t\tТаблицаЗначений.Колонки.Добавить(СтрПолучитьСтроку(ИменаКолонок, Сч), Новый ОписаниеТипов(\"Строка\"));\r\n\tКонецЦикла;\r\n\t\r\n\t// Заполним значения в таблице\r\n\tПока Чтение.Прочитать() Цикл\r\n\t\t\r\n\t\tЕсли Чтение.ТипУзла <> ТипУзлаXML.НачалоЭлемента Тогда\r\n\t\t\tПродолжить;\r\n\t\tИначеЕсли Чтение.Имя <> \"Item\" Тогда\r\n\t\t\tВызватьИсключение(\"Ошибка в структуре XML\");\r\n\t\tКонецЕсли;\r\n\t\t\r\n\t\tновСтр = ТаблицаЗначений.Добавить();\r\n\t\tДля Сч = 1 По Колонок Цикл\r\n\t\t\tИмяКолонки = СтрПолучитьСтроку(ИменаКолонок, Сч);\r\n\t\t\tновСтр[Сч-1] = Чтение.ПолучитьАтрибут(ИмяКолонки);\r\n\t\tКонецЦикла;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\n\t// Заполним результат\r\n\tРезультат = Новый Структура;\r\n\tРезультат.Вставить(\"ИмяТаблицы\", ИмяТаблицы);\r\n\tРезультат.Вставить(\"Данные\", ТаблицаЗначений);\r\n\t\r\n\tВозврат Результат;\r\n\t\r\nКонецФункции // ПрочитатьXMLВТаблицу()\n\nОрфографическая ошибка в xmlns: xmlns\r\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "ЗаполнитьМассивУникальнымиЗначениями",
    "description": "ЗаполнитьМассивУникальнымиЗначениями",
    "code_snippet": "// Заполняет массив-приемник уникальными значениями из массива-источника.\r\n// Если элемент в массиве-приемнике уже существует, то добавления нового элемента не происходит.\r\n//\r\n// Параметры:\r\n//  МассивПриемник – Массив – массив, который заполняется уникальными значениями\r\n//  МассивИсточник – Массив – массив, из которого подбираются элементы в массив-приемник.\r\n// \r\nПроцедура ЗаполнитьМассивУникальнымиЗначениями(МассивПриемник, МассивИсточник) Экспорт\r\n\t\r\n\tДля Каждого Элемент Из МассивИсточник Цикл\r\n\t\t\r\n\t\tЕсли МассивПриемник.Найти(Элемент) = Неопределено Тогда\r\n\t\t\t\r\n\t\t\tМассивПриемник.Добавить(Элемент);\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\n// Заполняет массив-приемник уникальными значениями из массива-источника.\r\n// Если элемент в массиве-приемнике уже существует, то добавления нового элемента не происходит.\r\n//\r\n// Параметры:\r\n//  МассивПриемник – Массив – массив, который заполняется уникальными значениями\r\n//  МассивИсточник – Массив – массив, из которого подбираются элементы в массив-приемник.\r\n// \r\nПроцедура ЗаполнитьМассивУникальнымиЗначениями(МассивПриемник, МассивИсточник) Экспорт\r\n\t\r\n\tДля Каждого Элемент Из МассивИсточник Цикл\r\n\t\t\r\n\t\tЕсли МассивПриемник.Найти(Элемент) = Неопределено Тогда\r\n\t\t\t\r\n\t\t\tМассивПриемник.Добавить(Элемент);\r\n\t\t\t\r\n\t\tКонецЕсли;\r\n\t\t\r\n\tКонецЦикла;\r\n\t\r\nКонецПроцедуры\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "ДобавитьИтераторТаблице",
    "description": "ДобавитьИтераторТаблице",
    "code_snippet": "// Добавляет колонку в таблицу значений. Заполняет колонку переданным значением\r\n//\r\n// Параметры:\r\n//  Таблица           - ТаблицаЗначений - таблица значений для добавления колонки\r\n//  ЗначениеИтератора - Произвольный - значение, которым будет заполнено новое поле таблицы\r\n//  ИмяПоляИтератора  - Строка - имя добавляемого поля\r\n// \r\nПроцедура ДобавитьИтераторТаблице(Таблица, ЗначениеИтератора, ИмяПоляИтератора) Экспорт\r\n\t\r\n\tТаблица.Колонки.Добавить(ИмяПоляИтератора);\r\n\t\r\n\tТаблица.ЗаполнитьЗначения(ЗначениеИтератора, ИмяПоляИтератора);\r\n\t\r\nКонецПроцедуры\n\n// Добавляет колонку в таблицу значений. Заполняет колонку переданным значением\r\n//\r\n// Параметры:\r\n//  Таблица           - ТаблицаЗначений - таблица значений для добавления колонки\r\n//  ЗначениеИтератора - Произвольный - значение, которым будет заполнено новое поле таблицы\r\n//  ИмяПоляИтератора  - Строка - имя добавляемого поля\r\n// \r\nПроцедура ДобавитьИтераторТаблице(Таблица, ЗначениеИтератора, ИмяПоляИтератора) Экспорт\r\n\t\r\n\tТаблица.Колонки.Добавить(ИмяПоляИтератора);\r\n\t\r\n\tТаблица.ЗаполнитьЗначения(ЗначениеИтератора, ИмяПоляИтератора);\r\n\t\r\nКонецПроцедуры\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "ТаблицаЗначенийВМассив",
    "description": "ТаблицаЗначенийВМассив",
    "code_snippet": "//\tПреобразует таблицу значений в массив.\r\n//\tМожет использоваться для передачи на клиента данных, полученных\r\n//\tна сервере в виде таблицы значений в том случае, если таблица\r\n//\tзначений содержит только такие значения, которые могут  быть переданы на клиента\r\n//\r\n//\tПолученный массив содержит структуры, каждая из которых повторяет\r\n//\tструктуру колонок таблицы значений.\r\n//\r\n//\tНе рекомендуется использовать для преобразования таблиц значений\r\n//\tс большим количеством строк.\r\n//\r\n//\tПараметры: ТаблицаЗначений\r\n//\tВозвращаемое значение: Массив\r\n//\r\nФункция ТаблицаЗначенийВМассив(ТаблицаЗначений) Экспорт\r\n\t\r\n\tМассив = Новый Массив();\r\n\tСтруктураСтрокой = \"\";\r\n\tНужнаЗапятая = Ложь;\r\n\tДля Каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tЕсли НужнаЗапятая Тогда\r\n\t\t\tСтруктураСтрокой = СтруктураСтрокой + \",\";\r\n\t\tКонецЕсли;\r\n\t\tСтруктураСтрокой = СтруктураСтрокой + Колонка.Имя;\r\n\t\tНужнаЗапятая = Истина;\r\n\tКонецЦикла;\r\n\tДля Каждого Строка Из ТаблицаЗначений Цикл\r\n\t\tНоваяСтрока = Новый Структура(СтруктураСтрокой);\r\n\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, Строка);\r\n\t\tМассив.Добавить(НоваяСтрока);\r\n\tКонецЦикла;\r\n\tВозврат Массив;\r\n\r\nКонецФункции\n\n//\tПреобразует таблицу значений в массив.\r\n//\tМожет использоваться для передачи на клиента данных, полученных\r\n//\tна сервере в виде таблицы значений в том случае, если таблица\r\n//\tзначений содержит только такие значения, которые могут  быть переданы на клиента\r\n//\r\n//\tПолученный массив содержит структуры, каждая из которых повторяет\r\n//\tструктуру колонок таблицы значений.\r\n//\r\n//\tНе рекомендуется использовать для преобразования таблиц значений\r\n//\tс большим количеством строк.\r\n//\r\n//\tПараметры: ТаблицаЗначений\r\n//\tВозвращаемое значение: Массив\r\n//\r\nФункция ТаблицаЗначенийВМассив(ТаблицаЗначений) Экспорт\r\n\t\r\n\tМассив = Новый Массив();\r\n\tСтруктураСтрокой = \"\";\r\n\tНужнаЗапятая = Ложь;\r\n\tДля Каждого Колонка Из ТаблицаЗначений.Колонки Цикл\r\n\t\tЕсли НужнаЗапятая Тогда\r\n\t\t\tСтруктураСтрокой = СтруктураСтрокой + \",\";\r\n\t\tКонецЕсли;\r\n\t\tСтруктураСтрокой = СтруктураСтрокой + Колонка.Имя;\r\n\t\tНужнаЗапятая = Истина;\r\n\tКонецЦикла;\r\n\tДля Каждого Строка Из ТаблицаЗначений Цикл\r\n\t\tНоваяСтрока = Новый Структура(СтруктураСтрокой);\r\n\t\tЗаполнитьЗначенияСвойств(НоваяСтрока, Строка);\r\n\t\tМассив.Добавить(НоваяСтрока);\r\n\tКонецЦикла;\r\n\tВозврат Массив;\r\n\r\nКонецФункции\n\nЗаголовок публикации состоит из слитных слов. Разделите их пробелами, если это не общепринятое название и не имя собственное."
  },
  {
    "title": "Получить дату файла",
    "description": "Получить дату файла",
    "code_snippet": "// Функция определяет дату последней модификации существующего файла на диске\r\n// Параметры\r\n//  ИмяФайла  – Строка, содержащая полный путь к файла на диске.\r\n//\r\n// Возвращаемое значение:\r\n//   Дата – Дата последней модификации файла\r\n//\r\nФункция ПолучитьДатуФайла(Знач ИмяФайла) Экспорт\r\n\t\r\n\tФайл = Новый Файл(ИмяФайла);\r\n\tВозврат Файл.ПолучитьВремяИзменения();\r\n\t \r\nКонецФункции\n\n// Функция определяет дату последней модификации существующего файла на диске\r\n// Параметры\r\n//  ИмяФайла  – Строка, содержащая полный путь к файла на диске.\r\n//\r\n// Возвращаемое значение:\r\n//   Дата – Дата последней модификации файла\r\n//\r\nФункция ПолучитьДатуФайла(Знач ИмяФайла) Экспорт\r\n\t\r\n\tФайл = Новый Файл(ИмяФайла);\r\n\tВозврат Файл.ПолучитьВремяИзменения();\r\n\t \r\nКонецФункции"
  },
  {
    "title": "Получить имя файла",
    "description": "Получить имя файла",
    "code_snippet": "// Составляет полное имя файла из имени каталога и имени файла.\r\n//\r\n// Параметры\r\n//  ИмяКаталога  – Строка, содержащая путь к каталогу файла на диске.\r\n//  ИмяФайла     – Строка, содержащая имя файла, без имени каталога.\r\n//\r\n// Возвращаемое значение:\r\n//   Строка – полное имя файла с учетом каталога.\r\n//\r\nФункция ПолучитьИмяФайла(ИмяКаталога, ИмяФайла) Экспорт\r\n\r\n\tЕсли Не ПустаяСтрока(ИмяФайла) Тогда\r\n\t\t\r\n\t\tВозврат ИмяКаталога   ?(Прав(ИмяКаталога, 1) = \"\\\", \"\", \"\\\")   ИмяФайла;\t\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tВозврат ИмяКаталога;\r\n\t\t\r\n\tКонецЕсли;\r\n\r\nКонецФункции // ПолучитьИмяФайла()\n\n// Составляет полное имя файла из имени каталога и имени файла.\r\n//\r\n// Параметры\r\n//  ИмяКаталога  – Строка, содержащая путь к каталогу файла на диске.\r\n//  ИмяФайла     – Строка, содержащая имя файла, без имени каталога.\r\n//\r\n// Возвращаемое значение:\r\n//   Строка – полное имя файла с учетом каталога.\r\n//\r\nФункция ПолучитьИмяФайла(ИмяКаталога, ИмяФайла) Экспорт\r\n\r\n\tЕсли Не ПустаяСтрока(ИмяФайла) Тогда\r\n\t\t\r\n\t\tВозврат ИмяКаталога   ?(Прав(ИмяКаталога, 1) = \"\\\", \"\", \"\\\")   ИмяФайла;\t\r\n\t\t\r\n\tИначе\r\n\t\t\r\n\t\tВозврат ИмяКаталога;\r\n\t\t\r\n\tКонецЕсли;\r\n\r\nКонецФункции // ПолучитьИмяФайла()\n\n{14} Ожидается идентификатор\r\n{14} Обнаружен недостижимый участок кода"
  }
]